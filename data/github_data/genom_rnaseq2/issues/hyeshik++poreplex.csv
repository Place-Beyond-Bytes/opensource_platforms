id,title,state,created_at,updated_at,closed_at,body,user,url
MDU6SXNzdWUzMzg0NzkwNzc=,ERROR: Unhandled exception KeyError: 'read_id'Task exception was never retrieved,CLOSED,2018-07-05T08:41:58Z,2018-07-10T03:15:21Z,2018-07-10T03:15:20Z,"Hi Hyeshik,

I was trying to execute the command as below and there was error. 

```
poreplex -i ./fast5 -o ./output --trim-adapter --barcoding --keep-unsplit --fast5

Poreplex version 0.1 by Hyeshik Chang <hyeshik@snu.ac.kr>
- Cuts nanopore direct RNA sequencing data into bite-size pieces for RNA Biology

== Analysis settings ======================================
 * Input:       ./fast5
 * Output:      ./output
 * Processes:   1
 * Presets:     rna-r941.cfg
 * Basecall on-the-fly:         No (use previous analyses)
 * Trim 3' adapter:             Yes
 * Filter concatenated read:    No
 * Separate by barcode:         Yes
 * Real-time alignment:         No
 * FASTQ in output:             Yes
 * FAST5 in output:             Yes
 * Basecall table in output:    No
===========================================================

==> Processing FAST5 files
ERROR: Unhandled exception KeyError: 'read_id'Task exception was never retrieved                                                            | Elapsed: 0:00:00 ETA:  --:--:--
future: <Task finished coro=<ProcessingSession.run_process_batch() done, defined at /mnt/projects/kokep/kokep/devel/miniconda3/lib/python3.6/site-packages/poreplex/pipeline.py:207> exception=CancelledError()>
concurrent.futures._base.CancelledError
| 100% of 13868 |############################################################################################################################| Elapsed: 0:00:00 Time: 0:00:00

==> Terminated.
```

I wonder how this error could be fixed. Thank you.",EPKok,https://github.com/hyeshik/poreplex/issues/1
MDU6SXNzdWUzMzg4NDAxMzM=,Custom barcodes,CLOSED,2018-07-06T07:51:29Z,2018-07-06T08:23:47Z,2018-07-06T08:23:47Z,"if i use custom barcodes, do I need to re-train the program?

Thanks. 

Huanlee",Huanle,https://github.com/hyeshik/poreplex/issues/2
MDU6SXNzdWUzNDc5MDc5NzY=,File could not be opened due to unknown error,CLOSED,2018-08-06T12:44:23Z,2018-10-09T14:33:25Z,2018-10-09T06:59:15Z,"Hi Hyeshik,

I was trying to execute the command as below, however there was an unknown error.
```
moltox@moltox-desktop[moltox] poreplex -i /media/moltox/data2/Ilias/MinIon/Basecalled_OK/comtransV1/fast5 -o /media/moltox/data2/Ilias/MinIon/Basecalled_OK/comtransV1/Basecalled_adaptersremoved  --trim-adapter --keep-unsplit --fastq 

Poreplex version 0.1 by Hyeshik Chang <hyeshik@snu.ac.kr>
- Cuts nanopore direct RNA sequencing data into bite-size pieces for RNA Biology

Output directory /media/moltox/data2/Ilias/MinIon/Basecalled_OK/comtransV1/Basecalled_adaptersremoved is not empty. Clear it? (y/N) y

== Analysis settings ======================================
 * Input:    /media/moltox/data2/Ilias/MinIon/Basecalled_OK/comtransV1/fast5
 * Output:    /media/moltox/data2/Ilias/MinIon/Basecalled_OK/comtransV1/Basecalled_adaptersremoved
 * Processes:    1
 * Presets:    rna-r941.cfg
 * Basecall on-the-fly:        No (use previous analyses)
 * Trim 3' adapter:        Yes
 * Filter concatenated read:    No
 * Separate by barcode:        No
 * Real-time alignment:        No
 * FASTQ in output:        Yes
 * FAST5 in output:        No    
 * Basecall table in output:    No
===========================================================

==> Processing FAST5 files
| 100% of 134804 |##############################| Elapsed: 0:07:44 Time: 0:07:44

==> Finished.
== Result Summary ==
 * Successfully processed:    0
 * Possibly artifact:        0
 * Processing failed:        0
 * Failed to open:        134804
    - File could not be opened due to unknown error:    134804

```

Then I noticed, I still used version 0.1, so I figured this might explain the error.
I tried to update the package, using the following command, however the update remains unsuccesful. 
`pip3 install git+https://github.com/hyeshik/poreplex.git
`
I wonder how this error could be fixed. Thank you.",ilisem,https://github.com/hyeshik/poreplex/issues/3
MDU6SXNzdWUzNDc5NjMyMjM=,Error,CLOSED,2018-08-06T15:06:17Z,2018-08-06T23:53:57Z,2018-08-06T23:53:57Z,,teshomeb,https://github.com/hyeshik/poreplex/issues/4
MDU6SXNzdWUzNDg3MTQ0NTY=,Barcodes,CLOSED,2018-08-08T12:58:00Z,2018-08-16T05:25:17Z,2018-08-16T05:25:17Z,"Is it possible to add more barcodes other than the four DNA barcodes listed. For example, oxford nanopre RTA 
>BC5_OligoA
/5Phos/GGCTTCTTCTTGCTCTTAGGTAGTAGGTTC
>BC5_OligoB
GAGGCGAGCGGTCAATTTTCCTAAGAGCAAGAAGAAGCCTTTTTTTTTT",teshomeb,https://github.com/hyeshik/poreplex/issues/5
MDU6SXNzdWUzNTAxMTc4NDg=,Extremely short sequences passing after adapter trimming,CLOSED,2018-08-13T17:15:43Z,2018-10-09T06:59:14Z,2018-10-09T06:59:14Z,"Hello,
Looking through my data after adapter trimming I've noticed that some of the passing sequences are extremely short (some as short as 4 bp). I'm wondering if there's a means of setting a minimum sequence length that gets to pass. I can write something up myself if not, but I thought it was worth bringing up here in case it wasn't a known issue. ",NatPRoach,https://github.com/hyeshik/poreplex/issues/6
MDU6SXNzdWUzNTcwOTI2MzE=,Poreplex stops with KeyError,CLOSED,2018-09-05T07:06:16Z,2018-10-10T11:42:15Z,2018-10-10T09:56:51Z,"Processing a small batch of fast5s worked, however the full dataset (240k reads) errored out after some time:

2018-09-04 17:54:43,927 Starting poreplex version 0.1
2018-09-04 17:54:43,927 Command line: /home/ya86gul/python/Python_3.6.1/bin/poreplex -i reads -o output --trim-adapter --barcoding --basecall --parallel 10 --fastq --align combined.mmi --dump-basecalled-events --dashboard --contig-aliases ids_to_names.csv
2018-09-04 17:54:43,927 == Analysis settings ======================================
2018-09-04 17:54:43,927  * Input: reads 
2018-09-04 17:54:43,927  * Output: output
2018-09-04 17:54:43,927  * Processes: 10
2018-09-04 17:54:43,927  * Presets: rna-r941.cfg
2018-09-04 17:54:43,927  * Basecall on-the-fly:	 Yes (albacore 2.3.1)
2018-09-04 17:54:43,927  * Trim 3' adapter:	 Yes
2018-09-04 17:54:43,927  * Filter concatenated read: Yes
2018-09-04 17:54:43,927  * Separate by barcode:	 Yes
2018-09-04 17:54:43,927  * Real-time alignment:	 Yes
2018-09-04 17:54:43,927  * FASTQ in output:	 Yes
2018-09-04 17:54:43,927  * FAST5 in output:	 No 
2018-09-04 17:54:43,927  * Basecall table in output: Yes
2018-09-04 17:54:43,927 ===========================================================
2018-09-04 17:54:43,927 
2018-09-04 18:10:18,614 Unhandled exception KeyError: 'read_id'
2018-09-04 18:10:18,643 Traceback (most recent call last):
2018-09-04 18:10:18,643   File ""/home/ya86gul/python/Python_3.6.1/lib/python3.6/site-packages/poreplex/pipeline.py"", line 95, in process_batch
2018-09-04 18:10:18,643     if res['read_id'] in barcode_assg:
2018-09-04 18:10:18,643 KeyError: 'read_id'
2018-09-04 18:10:18,808 Finished.

Any idea?",RaverJay,https://github.com/hyeshik/poreplex/issues/7
MDU6SXNzdWUzNjUyODYxNDc=,BlockingIOError,CLOSED,2018-10-01T02:06:00Z,2018-10-09T14:31:25Z,2018-10-09T14:31:09Z,"Hi, I got an error message when running Poreplex, and it looks like poreplex did not work but  just stayed in the 0% stage. The version of Albacore I used is 2.3.3 and Python version is 3.6. How do I solve this problem?

Poreplex version 0.1 by Hyeshik Chang <hyeshik@snu.ac.kr>
- Cuts nanopore direct RNA sequencing data into bite-size pieces for RNA Biology

WARNING: Dashboard is turned off because it is not informative without sequence alignments.

== Analysis settings ======================================
 * Input:	Fast5	
 * Output:	Fastq
 * Processes:	4
 * Presets:	rna-r941.cfg
 * Basecall on-the-fly:		Yes (albacore 2.3.3)
 * Trim 3' adapter:		No
 * Filter concatenated read:	Yes
 * Separate by barcode:		No
 * Real-time alignment:		No
 * FASTQ in output:		Yes
 * FAST5 in output:		No	
 * Basecall table in output:	No
===========================================================

==> Processing FAST5 files
/home/godkin/.local/lib/python3.6/site-packages/poreplex/basecall_albacore.py:83: FutureWarning: from_items is deprecated. Please use DataFrame.from_dict(dict(items), ...) instead. DataFrame.from_dict(OrderedDict(items)) may be used to preserve the key order.
  for field in field_names])
/home/godkin/.local/lib/python3.6/site-packages/poreplex/basecall_albacore.py:83: FutureWarning: from_items is deprecated. Please use DataFrame.from_dict(dict(items), ...) instead. DataFrame.from_dict(OrderedDict(items)) may be used to preserve the key order.
  for field in field_names])
/home/godkin/.local/lib/python3.6/site-packages/poreplex/basecall_albacore.py:83: FutureWarning: from_items is deprecated. Please use DataFrame.from_dict(dict(items), ...) instead. DataFrame.from_dict(OrderedDict(items)) may be used to preserve the key order.
  for field in field_names])
/home/godkin/.local/lib/python3.6/site-packages/poreplex/basecall_albacore.py:83: FutureWarning: from_items is deprecated. Please use DataFrame.from_dict(dict(items), ...) instead. DataFrame.from_dict(OrderedDict(items)) may be used to preserve the key order.
  for field in field_names])
Exception in thread Thread-1:                                                                                                               | Elapsed: 0:00:03 ETA:  --:--:--
Traceback (most recent call last):
  File ""/usr/lib/python3.6/threading.py"", line 916, in _bootstrap_inner
    self.run()
  File ""/usr/lib/python3.6/threading.py"", line 864, in run
    self._target(*self._args, **self._kwargs)
  File ""/usr/lib/python3.6/concurrent/futures/process.py"", line 295, in _queue_management_worker
    shutdown_worker()
  File ""/usr/lib/python3.6/concurrent/futures/process.py"", line 253, in shutdown_worker
    call_queue.put_nowait(None)
  File ""/usr/lib/python3.6/multiprocessing/queues.py"", line 129, in put_nowait
    return self.put(obj, False)
  File ""/usr/lib/python3.6/multiprocessing/queues.py"", line 83, in put
    raise Full
queue.Full

Exception ignored when trying to write to the signal wakeup fd:
BlockingIOError: [Errno 11] Resource temporarily unavailable
Exception ignored when trying to write to the signal wakeup fd:
BlockingIOError: [Errno 11] Resource temporarily unavailable
Exception ignored when trying to write to the signal wakeup fd:                                                                             | Elapsed: 0:00:04 ETA:  --:--:--
BlockingIOError: [Errno 11] Resource temporarily unavailable
0% of 71315 |                                                                                                    | Elapsed: 0:03:17 ETA:  --:-",godkin1211,https://github.com/hyeshik/poreplex/issues/8
MDU6SXNzdWUzNjU1NzYzMzE=,Poreplex not detected basecalled Fast5 files and fails,CLOSED,2018-10-01T18:01:56Z,2018-10-01T18:06:00Z,2018-10-01T18:04:10Z,"Hi I am running the following on my MiniKNOW (albacore) fast5 files from a direct RNA seq run but Poreplex errors out:
poreplex -i . -o /prod/Nanopore_Seq_Data/20181001_Sept17_18_2018_Trimmed_Fastq/ --trim-adapter --keep-unsplit -p 38

It states no basecalled files are found... but these are basecalled fast5 files - direct output from my MinION run. Here is the log file:

2018-10-01 13:51:53,768 Starting poreplex version 0.1
2018-10-01 13:51:53,768 Command line: /home/sdunaj/.local/bin/poreplex -i . -o /prod/Nanopore_Seq_Data/20181001_Sept17_18_2018_Trimmed_Fastq/ --trim-adapter --keep-unsplit -p 38 --b
asecall
2018-10-01 13:51:53,768 == Analysis settings ======================================
2018-10-01 13:51:53,768  * Input: .
2018-10-01 13:51:53,769  * Output: /prod/Nanopore_Seq_Data/20181001_Sept17_18_2018_Trimmed_Fastq/
2018-10-01 13:51:53,769  * Processes: 38
2018-10-01 13:51:53,769  * Presets: rna-r941.cfg
2018-10-01 13:51:53,769  * Basecall on-the-fly:  Yes (albacore 2.3.3)
2018-10-01 13:51:53,769  * Trim 3' adapter:      Yes
2018-10-01 13:51:53,769  * Filter concatenated read: No
2018-10-01 13:51:53,769  * Separate by barcode:  No
2018-10-01 13:51:53,769  * Real-time alignment:  No
2018-10-01 13:51:53,769  * FASTQ in output:      Yes
2018-10-01 13:51:53,769  * FAST5 in output:      No
2018-10-01 13:51:53,769  * Basecall table in output: No
2018-10-01 13:51:53,769 ===========================================================
2018-10-01 13:51:53,769
2018-10-01 13:53:55,750 Finished.

Thank you!",SaraJeanne08,https://github.com/hyeshik/poreplex/issues/9
MDU6SXNzdWUzNjU1Nzc5ODQ=,Poreplex does not detect basecalled fast5 files,CLOSED,2018-10-01T18:06:41Z,2018-10-04T02:19:05Z,2018-10-04T02:18:31Z,"Hi I am running the following on my MiniKNOW (albacore) fast5 files from a direct RNA seq run but Poreplex errors out:
poreplex -i . -o /prod/Nanopore_Seq_Data/20181001_Sept17_18_2018_Trimmed_Fastq/ --trim-adapter --keep-unsplit -p 38

It states no basecalled files are found... but these are basecalled fast5 files - direct output from my MinION run. Here is the log file:

2018-10-01 13:51:53,768 Starting poreplex version 0.1
2018-10-01 13:51:53,768 Command line: /home/sdunaj/.local/bin/poreplex -i . -o /prod/Nanopore_Seq_Data/20181001_Sept17_18_2018_Trimmed_Fastq/ --trim-adapter --keep-unsplit -p 38 --b
asecall
2018-10-01 13:51:53,768 == Analysis settings ======================================
2018-10-01 13:51:53,768  * Input: .
2018-10-01 13:51:53,769  * Output: /prod/Nanopore_Seq_Data/20181001_Sept17_18_2018_Trimmed_Fastq/
2018-10-01 13:51:53,769  * Processes: 38
2018-10-01 13:51:53,769  * Presets: rna-r941.cfg
2018-10-01 13:51:53,769  * Basecall on-the-fly:  Yes (albacore 2.3.3)
2018-10-01 13:51:53,769  * Trim 3' adapter:      Yes
2018-10-01 13:51:53,769  * Filter concatenated read: No
2018-10-01 13:51:53,769  * Separate by barcode:  No
2018-10-01 13:51:53,769  * Real-time alignment:  No
2018-10-01 13:51:53,769  * FASTQ in output:      Yes
2018-10-01 13:51:53,769  * FAST5 in output:      No
2018-10-01 13:51:53,769  * Basecall table in output: No
2018-10-01 13:51:53,769 ===========================================================
2018-10-01 13:51:53,769
2018-10-01 13:53:55,750 Finished.

Thank you!",SaraJeanne08,https://github.com/hyeshik/poreplex/issues/10
MDU6SXNzdWUzNjg5OTQ5MDM=,Does the Pseudo-fusion filter discard chimeric reads completely?,OPEN,2018-10-11T07:51:53Z,2018-10-12T08:17:28Z,,"Hey,

see title.

Also, is it not feasible to split the read und process/keep both fused reads?

Cheers",RaverJay,https://github.com/hyeshik/poreplex/issues/11
MDU6SXNzdWUzNzU0MTIzMzY=,Documentation for training,CLOSED,2018-10-30T10:15:34Z,2020-03-07T15:06:05Z,2020-03-07T15:06:05Z,"It is great that poreplex has the pipeline for barcoding model training included. However a minimal documentation on how to do the training would be really helpful.

Regards,
Botond",bsipos,https://github.com/hyeshik/poreplex/issues/12
MDU6SXNzdWUzODY2MDU4NjY=,squiggle scaling?,CLOSED,2018-12-02T22:09:28Z,2018-12-04T10:52:22Z,2018-12-03T01:28:07Z,"@hyeshik ,

it seems the dumped adapter squiggles have been re-scaled by poreplex?

Raw: 
![image](https://user-images.githubusercontent.com/909201/49345588-30876e80-f687-11e8-85eb-652f391cc101.png)

Poreplex:
![image](https://user-images.githubusercontent.com/909201/49345591-38471300-f687-11e8-90d7-52587a67fd1f.png)

Can you please tell me the formula for the conversion?
Also, is this necessary?

Thanks a lot",Huanle,https://github.com/hyeshik/poreplex/issues/13
MDU6SXNzdWU0MDU0NzEzNzg=,fast5 file is not open.,OPEN,2019-01-31T22:36:17Z,2019-02-27T18:43:20Z,,"I'm getting this error (see below).  I used ont_fast5_api to demultiplex the multi-fast5s and then ran poreplex on those fast5s.  Any input would be helpful.  Thank you.

2019-01-31 14:21:01,777 Command line: /usr/local/projdata/8520/projects/PANGENOME/localenv/anaconda/envs/ONTIll/bin/poreplex -i ./demultiplex_fast5/ -o ./demultiplex_fast5/Poreplex --trim-adapter --barcoding --basecall --parallel 40 --live
2019-01-31 14:21:01,777 == Analysis settings ======================================
2019-01-31 14:21:01,777  * Input: ./demultiplex_fast5/ (live, 60 sec delay)
2019-01-31 14:21:01,777  * Output: ./demultiplex_fast5/Poreplex
2019-01-31 14:21:01,777  * Processes: 40
2019-01-31 14:21:01,777  * Presets: rna-r941.cfg
2019-01-31 14:21:01,777  * Basecall on-the-fly:  Yes (albacore 2.3.3)
2019-01-31 14:21:01,777  * Trim 3' adapter:      Yes
2019-01-31 14:21:01,777  * Filter concatenated read: No
2019-01-31 14:21:01,778  * Separate by barcode:  Yes
2019-01-31 14:21:01,778  * Real-time alignment:  No
2019-01-31 14:21:01,778  * FASTQ in output:      Yes
2019-01-31 14:21:01,778  * FAST5 in output:      No
2019-01-31 14:21:01,778  * Basecall table in output: No
2019-01-31 14:21:01,778 ===========================================================
2019-01-31 14:21:01,778
2019-01-31 14:24:21,105 [signal_analyzer.py:96] (37/cfe32c71-be0b-448f-bf2e-aa5099d51cfe.fast5) Unhandled exception OSError: Fast5 file is not open: ./demultiplex_fast5/37/cfe32c71-be0b-448f-bf2e-aa5099d51cfe.fast5
Traceback (most recent call last):
  File ""/usr/local/projdata/8520/projects/PANGENOME/localenv/anaconda/envs/ONTIll/lib/python3.6/site-packages/poreplex/signal_analyzer.py"", line 96, in process
    npread = prepare_loading(f5file)
  File ""/usr/local/projdata/8520/projects/PANGENOME/localenv/anaconda/envs/ONTIll/lib/python3.6/site-packages/poreplex/signal_loader.py"", line 79, in prepare_loading
    npread = NanoporeRead(filename, self.fast5prefix)
  File ""/usr/local/projdata/8520/projects/PANGENOME/localenv/anaconda/envs/ONTIll/lib/python3.6/site-packages/poreplex/signal_loader.py"", line 124, in __init__
    self.load()
  File ""/usr/local/projdata/8520/projects/PANGENOME/localenv/anaconda/envs/ONTIll/lib/python3.6/site-packages/poreplex/signal_loader.py"", line 205, in load
    self.channel_info = fast5.get_channel_info()
  File ""/usr/local/projdata/8520/projects/PANGENOME/localenv/anaconda/envs/ONTIll/lib/python3.6/site-packages/ont_fast5_api/fast5_file.py"", line 126, in get_channel_info
    self.assert_open()
  File ""/usr/local/projdata/8520/projects/PANGENOME/localenv/anaconda/envs/ONTIll/lib/python3.6/site-packages/ont_fast5_api/fast5_file.py"", line 57, in assert_open
    raise IOError(""Fast5 file is not open: {}"".format(self.filename))
OSError: Fast5 file is not open: ./demultiplex_fast5/37/cfe32c71-be0b-448f-bf2e-aa5099d51cfe.fast5

",bradabramson,https://github.com/hyeshik/poreplex/issues/14
MDU6SXNzdWU0MTIxMjY4Njg=,how to get polya length in nts?,CLOSED,2019-02-19T21:13:27Z,2019-11-15T09:24:22Z,2019-02-27T02:15:20Z,"Hi Hyeshik,
How to convert polya squiggles into length measured in nucleotides? 
polya squiggle length / full squiggle length (duration)  * sequence length ?
What is polya_dwell in the summary file? Time taken to sequence polyA?
Thanks a lot.
",Huanle,https://github.com/hyeshik/poreplex/issues/15
MDU6SXNzdWU0MjA0OTE4NTY=,No albacore basecall data found when running in basecalling mode,OPEN,2019-03-13T13:12:22Z,2019-05-08T01:47:30Z,,"Hello,
I'm a little confused about some of the info in the poreplex log file. I'm running poreplex with the --basecall flag, but in the log file I'm getting a line in the ""processing failed"" section that reads 
`- No albacore basecall data found: 135938`
If theres no basecall data found shouldn't poreplex be basecalling them?",NatPRoach,https://github.com/hyeshik/poreplex/issues/16
MDU6SXNzdWU0MjgyMTI5MjI=,signal_analyzer.py error,OPEN,2019-04-02T12:59:37Z,2019-05-08T11:01:12Z,,"Hi, 
I'm running poreplex in a linux machine using the following command:
poreplex -i /home3/Data/Nanopore/DIRECT_RNA/run_250319_Wt/fast5_pass/
 -o /home/epicardi/Nanopore/pass --trim-adapter --parallel 20 --align /home/epicardi/minimap2index/mm10.mmi --fastq

For each running process I'm getting:

2019-04-02 13:48:03,498 [signal_analyzer.py:114] (FAK29499_e03ca1e3175e68134af1625d2dc20000581e13e5_0.fast5#94610be8-25e4-4a12-980b-2376634ebfe7) Unha
ndled exception KeyError: ""Can't open attribute (can't locate attribute: 'num_events_template')""
Traceback (most recent call last):
  File ""/home/epicardi/bin/miniconda2/envs/py3/lib/python3.6/site-packages/poreplex/signal_analyzer.py"", line 114, in process
    siganal.process()
  File ""/home/epicardi/bin/miniconda2/envs/py3/lib/python3.6/site-packages/poreplex/signal_analyzer.py"", line 259, in process
    events = self.load_events()
  File ""/home/epicardi/bin/miniconda2/envs/py3/lib/python3.6/site-packages/poreplex/signal_analyzer.py"", line 315, in load_events
    events = self.npread.load_fast5_events()
  File ""/home/epicardi/bin/miniconda2/envs/py3/lib/python3.6/site-packages/poreplex/signal_loader.py"", line 265, in load_fast5_events
    bcall = self.fast5.get_basecall()
  File ""/home/epicardi/bin/miniconda2/envs/py3/lib/python3.6/site-packages/poreplex/fast5_file.py"", line 142, in get_basecall
    summary['num_events'] = int(segattrs['num_events_template'])
  File ""h5py/_objects.pyx"", line 54, in h5py._objects.with_phil.wrapper
  File ""h5py/_objects.pyx"", line 55, in h5py._objects.with_phil.wrapper
  File ""/home/epicardi/bin/miniconda2/envs/py3/lib/python3.6/site-packages/h5py/_hl/attrs.py"", line 60, in __getitem__
    attr = h5a.open(self._id, self._e(name))
  File ""h5py/_objects.pyx"", line 54, in h5py._objects.with_phil.wrapper
  File ""h5py/_objects.pyx"", line 55, in h5py._objects.with_phil.wrapper
  File ""h5py/h5a.pyx"", line 77, in h5py.h5a.open
KeyError: ""Can't open attribute (can't locate attribute: 'num_events_template')""

How can I fix this issue?

Many thanks,
Ernesto",ernestopicardi,https://github.com/hyeshik/poreplex/issues/17
MDU6SXNzdWU0Mzk1MDc4NzY=,Guppy,OPEN,2019-05-02T09:49:44Z,2019-05-08T01:39:01Z,,"Hi! 

Thanks for nice tool, we are using it now extensively. Can we expect integraton with latest albacore? And if so at what timeframe? Or is it possible to use it already? By latest albacore I mean the guppy algorithm for basecalling.

Best,
Kornel",JokingHero,https://github.com/hyeshik/poreplex/issues/18
MDU6SXNzdWU0NDI2NTYyMDI=,error when barcoding and fast5 flags used,OPEN,2019-05-10T10:45:26Z,2019-05-10T10:45:26Z,,"Hi,
Use of --barcoding and --fast5 give error. Here is the command and the error. 
Thanks
poreplex -i INPUT -o OUTPUT --barcoding --trim-adapter --basecall --parallel 5 --fast5 

Poreplex version 0.4.1 by Hyeshik Chang <hyeshik@snu.ac.kr>
- Cuts nanopore direct RNA sequencing data into bite-size pieces for RNA Biology

== Analysis settings ======================================
 * Input:	INPUT	
 * Output:	OUTPUT
 * Processes:	5
 * Presets:	rna-r941.cfg
 * Basecall on-the-fly:		Yes (albacore 2.3.1)
 * Trim 3' adapter:		Yes
 * Filter concatenated read:	No
 * Separate by barcode:		Yes
 * Real-time alignment:		No
 * FASTQ in output:		Yes
 * FAST5 in output:		Yes	
 * Basecall table in output:	No
===========================================================

==> Processing FAST5 files
ERROR: Unhandled error [Errno 2] No such file or directory: '~/fast5/pass/BC3/FAK84611_6b938d7e6efe081830fee799484ebdfbbf1725f6_3.fast5'Task exception was never retrieved
future: <Task finished coro=<ProcessingSession.run_process_batch() done, defined at ~/lib/python3.5/site-packages/poreplex/pipeline.py:183> exception=CancelledError()>
concurrent.futures._base.CancelledError
| 100% of 665704 |################################| Elapsed: 0:00:19 Time: 0:00:19

==> Terminated.",teshomeb,https://github.com/hyeshik/poreplex/issues/19
MDU6SXNzdWU0NjAyMTU2OTk=,Installation dependency,OPEN,2019-06-25T05:24:45Z,2019-06-25T05:24:45Z,,"Hello,

It seems that numpy is needed for setting up installation with pip, otherwise the pip installer complains with:

```
  Cache entry deserialization failed, entry ignored
  Using cached https://files.pythonhosted.org/packages/ce/41/99b51880c9d9835218978008cf75851f2257f9fe0271e5d76c96b17fe501/poreplex-0.4.tar.gz
    Complete output from command python setup.py egg_info:
    Traceback (most recent call last):
      File ""<string>"", line 1, in <module>
      File ""/tmp/pip-build-POhzuX/poreplex/setup.py"", line 26, in <module>
        import numpy
    ImportError: No module named numpy
    

```",mmiladi,https://github.com/hyeshik/poreplex/issues/20
MDU6SXNzdWU1MjExNjgzNDM=,ERROR that can't be interpreted ,OPEN,2019-11-11T20:24:01Z,2019-11-12T01:05:36Z,,"`==> Processing FAST5 files
ERROR: Unhandled exception KeyError: 'read_id'Task exception was never retrieved` 
I coudln't find  **read_id** nor **ERROR:** in the repository.   
How should I proceed? Or is it a bug?

THanks

",aerijman,https://github.com/hyeshik/poreplex/issues/21
MDU6SXNzdWU1MzIxNDA3NjI=,Error: Unknown entries in loss dictionary:,OPEN,2019-12-03T17:19:40Z,2020-06-26T23:27:40Z,,"Hi,
I tried to run poreplex on a minION run using the follwing command to basecall and demultiplex barcodes from direct RNA sequencing:
` poreplex -i 20191122_1000_MN24929_FAL01495_e9928ec8/fast5/ -o poreplex_demultiplex --barcoding  --fast5 --basecall --parallel 20`


This results in an error:
```
== Analysis settings ======================================
 * Input:	fast5/20191122_1000_MN24929_FAL01495_e9928ec8/fast5/	
 * Output:	poreplex_demultiplex
 * Processes:	20
 * Presets:	rna-r941.cfg
 * Basecall on-the-fly:		Yes (albacore 2.3.4)
 * Trim 3' adapter:		No
 * Filter concatenated read:	No
 * Separate by barcode:		Yes
 * Real-time alignment:		No
 * FASTQ in output:		Yes
 * FAST5 in output:		Yes
 * Basecall table in output:	No
===========================================================

==> Processing FAST5 files
ERROR: [signal_analyzer.py:48] Unhandled exception ValueError: Unknown entries in loss dictionary: ['config', 'class_name']. Only expected following keys: ['dense_2']Task exception was never retrieved
future: <Task finished coro=<ProcessingSession.run_process_batch() done, defined at /home/graf/.local/lib/python3.6/site-packages/poreplex/pipeline.py:193> exception=CancelledError()>
concurrent.futures._base.CancelledError
```
Is there anything I need to do to get around that error? 

First I tried the Fast5 files basecalled with Guppy with the same result. So I thought running the internal albacore basecalling will help, but unfortunately no luck!
Could you give me a hint what to do to solve that issue?

Thank you in advance for your help
Best Alex",axgraf,https://github.com/hyeshik/poreplex/issues/22
MDU6SXNzdWU1NzIyODM4NDc=,"KeyError: ""Can't open attribute",OPEN,2020-02-27T18:51:18Z,2021-04-09T14:26:39Z,,"Hi,

I just tried demultiplexing a run with the following command:

`poreplex -i fast5_pass -o demultiplexed --trim-adapter --barcoding --fast5`

Which failed due to an unknown error according to the output:

`==== Result Summary ====
                                                  BC1   BC2   BC3   BC4   undetermined 
Processing failed                                 
 - File could not be opened due to unknown error   8554 30492   819 33735 22579 
 - Signal is too short                                0     0     0     0   318 
 - Signal scaling QC failed                           0     0     0     0     3`

Looking at the log files, the following error is coming up for each read:

`2020-02-27 18:20:43,004 [signal_analyzer.py:114] (FAL30205_pass_2b4b39c4_108.fast5#0076af39-aa83-4ff6-8a27-ef145447359b) Unhandled exception KeyError: ""Can't open attribute (can't locate attribute: 'num_events_template')""
Traceback (most recent call last):
  File ""/Users/yan/opt/miniconda3/lib/python3.7/site-packages/poreplex/signal_analyzer.py"", line 114, in process
    siganal.process()
  File ""/Users/yan/opt/miniconda3/lib/python3.7/site-packages/poreplex/signal_analyzer.py"", line 259, in process
    events = self.load_events()
  File ""/Users/yan/opt/miniconda3/lib/python3.7/site-packages/poreplex/signal_analyzer.py"", line 315, in load_events
    events = self.npread.load_fast5_events()
  File ""/Users/yan/opt/miniconda3/lib/python3.7/site-packages/poreplex/signal_loader.py"", line 265, in load_fast5_events
    bcall = self.fast5.get_basecall()
  File ""/Users/yan/opt/miniconda3/lib/python3.7/site-packages/poreplex/fast5_file.py"", line 142, in get_basecall
    summary['num_events'] = int(segattrs['num_events_template'])
  File ""h5py/_objects.pyx"", line 54, in h5py._objects.with_phil.wrapper
  File ""h5py/_objects.pyx"", line 55, in h5py._objects.with_phil.wrapper
  File ""/Users/yan/opt/miniconda3/lib/python3.7/site-packages/h5py/_hl/attrs.py"", line 60, in __getitem__
    attr = h5a.open(self._id, self._e(name))
  File ""h5py/_objects.pyx"", line 54, in h5py._objects.with_phil.wrapper
  File ""h5py/_objects.pyx"", line 55, in h5py._objects.with_phil.wrapper
  File ""h5py/h5a.pyx"", line 77, in h5py.h5a.open
KeyError: ""Can't open attribute (can't locate attribute: 'num_events_template')""`

Any ideas on what went wrong or have oxford changed the fast5 file structure and broke poreplex because of it?",690645258,https://github.com/hyeshik/poreplex/issues/23
MDU6SXNzdWU2MjQwMDM5MDc=,"poreplex 0.5, FileNotFoundError: template_median69pA.model does not exist",OPEN,2020-05-25T02:22:22Z,2020-05-27T08:19:48Z,,"Hi,
I've installed poreplex 0.5 using:
`git clone https://github.com/hyeshik/poreplex.git`
`cd poreplex`
`python3 setup.py install`

I am using Ubuntu 20.04 terminal on Windows, python3.8.2

Trying to run the command:
`poreplex --polya -i path/to/fast5_albacore_basecalled/ -o path/to/output`
I got:
`ERROR: [signal_analyzer.py:48] Unhandled exception FileNotFoundError: [Errno 2] File /usr/local/lib/python3.8/dist-packages/poreplex-0.5-py3.8-linux-x86_64.egg/poreplex/kmer_models/r9.4_180mv_70bps_5mer_RNA/template_median69pA.model does not exist: '/usr/local/lib/python3.8/dist-packages/poreplex-0.5-py3.8-linux-x86_64.egg/poreplex/kmer_models/r9.4_180mv_70bps_5mer_RNA/template_median69pA.model'Exception in thread QueueManagerThread:                                     Traceback (most recent call last):                                                                                                                                                                                                             File ""/usr/lib/python3.8/threading.py"", line 932, in _bootstrap_inner                                                                                                                                                                          self.run()                                                                                                                                                                                                                                 File ""/usr/lib/python3.8/threading.py"", line 870, in run                                                                                                                                                                                       self._target(*self._args, **self._kwargs)                                                                                                                                                                                                  File ""/usr/lib/python3.8/concurrent/futures/process.py"", line 394, in _queue_management_worker                                                                                                                                                 work_item.future.set_exception(bpe)                                                                                                                                                                                                        File ""/usr/lib/python3.8/concurrent/futures/_base.py"", line 539, in set_exception                                                                                                                                                              raise InvalidStateError('{}: {!r}'.format(self._state, self))                                                                                                                                                                            concurrent.futures._base.InvalidStateError: CANCELLED: <Future at 0x7f51ffca8d00 state=cancelled>                                                                                                                                            Traceback (most recent call last):                                                                                                                                                                                                             File ""/usr/local/bin/poreplex"", line 11, in <module>                                                                                                                                                                                           load_entry_point('poreplex==0.5', 'console_scripts', 'poreplex')()                                                                                                                                                                         File ""/usr/local/lib/python3.8/dist-packages/poreplex-0.5-py3.8-linux-x86_64.egg/poreplex/commandline.py"", line 410, in __main__                                                                                                               main(args)                                                                                                                                                                                                                                 File ""/usr/local/lib/python3.8/dist-packages/poreplex-0.5-py3.8-linux-x86_64.egg/poreplex/commandline.py"", line 314, in main                                                                                                                   procresult = ProcessingSession.run(config, logger)                                                                                                                                                                                         File ""/usr/local/lib/python3.8/dist-packages/poreplex-0.5-py3.8-linux-x86_64.egg/poreplex/pipeline.py"", line 563, in run                                                                                                                       sess.loop.run_until_complete(task)                                                                                                                                                                                                         File ""/usr/lib/python3.8/asyncio/base_events.py"", line 616, in run_until_complete                                                                                                                                                              return future.result()                                                                                                                                                                                                                   asyncio.exceptions.CancelledError `

I tried to install the package conventionally by `pip3 install poreplex` and via source code from the last release, but the same error produced.

I also tried to locate [kmer_models](https://github.com/nanoporetech/kmer_models/tree/87dec20850a6cb87c9067b5c3f4518b24c459ba8) downloaded from the repository in the /usr/local/lib/python3.8/dist-packages/poreplex-0.5-py3.8-linux-x86_64.egg/poreplex/
I renamed the folder directly to kmer_models, but still the same error produced.

I was also going to try it with python 3.6 (`pip3.6 install poreplex-0.5-cp36-cp36m-manylinux1_x86_64.whl`), however, pomegranate package needed for poreplex cannot be installed with the python 3.6.

What might be wrong? Could you help, please?

Also, it is noted that poreplex can internally call the basecaller core routines of albacore, but as soon as I know albacore doesn't support the current version of kit-flowcell combination for DRS (e.g. FLO-MIN106 flowcell + SQK-RNA002 kit cannot be analyzed by albacore according to [official documentation](https://denbi-nanopore-training-course.readthedocs.io/en/stable/basecalling/basecalling.html)). Could it impact the quality of analysis when we use --basecall with data obtained from not compatible kit+flowcell combination? And I have found only the albacore package for the  python3.6 or older. Assuming poreplex can only be installed on python3.8 (because of pomegranate), will the --basecall work?

Thank you in advance!",taras2706,https://github.com/hyeshik/poreplex/issues/24
MDU6SXNzdWU2NDMwNTU4NDI=,Unhandled exception AttributeError: 'list' object has no attribute 'items'Task exception was never retrieved,OPEN,2020-06-22T13:05:52Z,2020-07-16T16:05:34Z,,"2020-06-22 20:41:02,717 == Analysis settings ======================================
2020-06-22 20:41:02,717  * Input: /mnt/raid62/BetaCoV/RawData/20200620/20200620_0916_MN27328_FAM92901_ea10d670/fast5_pass/
2020-06-22 20:41:02,717  * Output: /mnt/raid62/BetaCoV/Person/tangchao/analysis/DrictRNA/Poreplex/output
2020-06-22 20:41:02,717  * Processes: 2
2020-06-22 20:41:02,717  * Presets: rna-r941.cfg
2020-06-22 20:41:02,717  * Basecall on-the-fly:  No (use previous analyses)
2020-06-22 20:41:02,717  * Trim 3' adapter:      Yes
2020-06-22 20:41:02,717  * Filter concatenated read: No
2020-06-22 20:41:02,717  * Separate by barcode:  Yes
2020-06-22 20:41:02,717  * Real-time alignment:  No
2020-06-22 20:41:02,717  * FASTQ in output:      Yes
2020-06-22 20:41:02,717  * FAST5 in output:      Yes
2020-06-22 20:41:02,717  * Basecall table in output: No
2020-06-22 20:41:02,717 ===========================================================
2020-06-22 20:41:02,717
2020-06-22 20:48:57,596 [signal_analyzer.py:48] Unhandled exception AttributeError: 'list' object has no attribute 'items'
2020-06-22 20:48:57,596 Traceback (most recent call last):
2020-06-22 20:48:57,596   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/poreplex/signal_analyzer.py"", line 48, in process_batch
2020-06-22 20:48:57,597     with SignalAnalyzer(config, batchid) as analyzer:
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/poreplex/signal_analyzer.py"", line 72, in __init__
2020-06-22 20:48:57,597     WorkerPersistenceStorage(config).retrieve_objects(self)
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/poreplex/worker_persistence.py"", line 48, in retrieve_objects
2020-06-22 20:48:57,597     storage = self.init_persistence_objects(self.config)
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/poreplex/worker_persistence.py"", line 83, in init_persistence_objects
2020-06-22 20:48:57,597     storage['loader'] = SignalLoader(config['signal_processing'], config['inputdir'])
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/poreplex/signal_loader.py"", line 41, in __init__
2020-06-22 20:48:57,597     self.scaler_model, self.scaler_cfg = self.load_scaler_model()
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/poreplex/signal_loader.py"", line 75, in load_scaler_model
2020-06-22 20:48:57,597     return keras.models.load_model(model_file), scaler_cfg
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/saving/save.py"", line 180, in load_model
2020-06-22 20:48:57,597     return hdf5_format.load_model_from_hdf5(filepath, custom_objects, compile)
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/saving/hdf5_format.py"", line 178, in load_model_from_hdf5
2020-06-22 20:48:57,597     custom_objects=custom_objects)
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/saving/model_config.py"", line 55, in model_from_config
2020-06-22 20:48:57,597     return deserialize(config, custom_objects=custom_objects)
2020-06-22 20:48:57,597   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/layers/serialization.py"", line 174, in deserialize
2020-06-22 20:48:57,598     printable_module_name='layer')
2020-06-22 20:48:57,598   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/utils/generic_utils.py"", line 338, in deserialize_keras_object
2020-06-22 20:48:57,598     config, module_objects, custom_objects, printable_module_name)
2020-06-22 20:48:57,598   File ""/home/tangchao/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/utils/generic_utils.py"", line 300, in class_and_config_for_serialized_keras_object
2020-06-22 20:48:57,598     for key, item in cls_config.items():
2020-06-22 20:48:57,598 AttributeError: 'list' object has no attribute 'items'
2020-06-22 20:48:58,899 Finished.
",ChaoTang-SCU,https://github.com/hyeshik/poreplex/issues/25
MDU6SXNzdWU3MTU2ODI3MDY=,"Unhandled exception KeyError: ""Unable to open object (object 'Analyses' doesn't exist)""",OPEN,2020-10-06T13:31:39Z,2020-10-06T13:31:39Z,,"Hello, 
I got the following error: 
Unhandled exception KeyError: ""Unable to open object (object 'Analyses' doesn't exist)""

2020-10-06 16:07:12,361 Starting poreplex version 0.4.1
2020-10-06 16:07:12,361 Command line: /apps/RH7U2/gnu/python/3.5.2/bin/poreplex -i /home/labs/schwartzlab/amitblum/nanopre_rawdata/L821_4_BCs1_4/L821_BC1_4/BCs1_4/20200923_1453_MN34379_FAO02325_d4e35397/fast5/ -o /home/labs/schwartzlab/amitblum/nanopre_rawdata/L821_4_BCs1_4/fastq/ --barcoding --parallel 20
2020-10-06 16:07:12,361 == Analysis settings ======================================
2020-10-06 16:07:12,361  * Input: /home/labs/schwartzlab/amitblum/nanopre_rawdata/L821_4_BCs1_4/L821_BC1_4/BCs1_4/20200923_1453_MN34379_FAO02325_d4e35397/fast5/ 
2020-10-06 16:07:12,361  * Output: /home/labs/schwartzlab/amitblum/nanopre_rawdata/L821_4_BCs1_4/fastq/
2020-10-06 16:07:12,361  * Processes: 20
2020-10-06 16:07:12,361  * Presets: rna-r941.cfg
2020-10-06 16:07:12,361  * Basecall on-the-fly:	 No (use previous analyses)
2020-10-06 16:07:12,361  * Trim 3' adapter:	 No
2020-10-06 16:07:12,361  * Filter concatenated read: No
2020-10-06 16:07:12,361  * Separate by barcode:	 Yes
2020-10-06 16:07:12,361  * Real-time alignment:	 No
2020-10-06 16:07:12,362  * FASTQ in output:	 Yes
2020-10-06 16:07:12,362  * FAST5 in output:	 No 
2020-10-06 16:07:12,362  * Basecall table in output: No
2020-10-06 16:07:12,362 ===========================================================
2020-10-06 16:07:12,362 
2020-10-06 16:24:33,811 [signal_analyzer.py:114] (FAO02325_50a12c2b_180.fast5#da6b9bc1-5f79-4689-bc43-d616855215b8) Unhandled exception KeyError: ""Unable to open object (object 'Analyses' doesn't exist)""

Do you have any suggestion how to solve it?

Thanks
Amit",amitblum,https://github.com/hyeshik/poreplex/issues/26
MDU6SXNzdWU3MjEzODE3NDY=,train new set of BArcodes,OPEN,2020-10-14T11:35:52Z,2020-10-14T11:35:52Z,,"hello,
 Do you have instruction for training new set of barcodes?
Thanks
Amit",amitblum,https://github.com/hyeshik/poreplex/issues/27
MDU6SXNzdWU4NTAwMzAyMDI=,Illegal instruction --barcoding,OPEN,2021-04-05T02:48:19Z,2021-04-05T06:49:39Z,,"I have version 0.5 of poreplex installed both on a work server (linux) and on my own Mac. I am unable to get either of them working.

If I run poreplex on the sever (python 3.7.2), when I try to use the `--barcoding` option I get the following error:

`Illegal instruction     (core dumped)`

In this case the log file is basically empty (apart from the 'Analysis settings' section). If I run it without the `--barcoding` option it seemingly starts to run, but the progress bar remains stuck on 0% for however long I run it. 

On my Mac (python 3.8) if I run it with the `--barcoding` option, I get the following error:

`ERROR: [signal_analyzer.py:48] Unhandled exception NotImplementedError: Cannot convert a symbolic Tensor (bidirectional_2/forward_lstm_1/strided_slice:0) to a numpy array. This error may indicate that you're trying to pass a Tensor to a NumPy call, which is not supportedException in thread QueueManagerThread`

I have uploaded the log file for this run in case it is informative.

[poreplex.log](https://github.com/hyeshik/poreplex/files/6256040/poreplex.log.txt)

Ideally I want to be running this on the linux server as that is where we do most of my work, so if you have any ideas of how to get it working with `--barcoding` that would be great!
",matthew-valentine,https://github.com/hyeshik/poreplex/issues/28
I_kwDOCEiwqs5AKGxe,Support for Guppy v5.0.11,OPEN,2021-12-10T03:39:15Z,2021-12-10T03:39:15Z,,"Hi @hyeshik 
First of all thank you for a great tool.
It seems that it hasn't been updated in a while, so maybe it would be possible to add support for .fast5 files basecalled using Guppy v5.0.11? Albacore is not that easily accessible right now, so support for guppy would be great!

My main issue is that using Poreplex is only able to assign barcodes in 50% of total reads, so there is huge loss of data.
In particular, I used BC1 and BC2, but after Poreplex, I get 25% BC1, 25% BC2 and 50% undetermined. I assume this is because Poreplex was taught using .fast5 files basecalled with Albacore and not Guppy.

Thank you!
Rytis Stakaitis",Stakaitis,https://github.com/hyeshik/poreplex/issues/29
