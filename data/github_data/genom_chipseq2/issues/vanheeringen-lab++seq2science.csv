id,title,state,created_at,updated_at,closed_at,body,user,url
MDU6SXNzdWU0NzMyNzA3MTY=,Rule map_auto fails when tmp files are present,CLOSED,2019-03-18T09:14:39Z,2019-07-30T07:59:13Z,2019-07-30T07:59:13Z,"If the bwa mapping gets interrupted, the sort process leaves `*tmp.*.bam` files. Either sort needs to be updated, or these files need to be deleted before a run starts.",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/32
MDU6SXNzdWU0NzI3Njc3NjE=,base pair shift,CLOSED,2019-06-20T09:45:07Z,2020-03-15T17:59:10Z,2020-03-15T17:59:10Z,"We could add for completeness base pair shift
https://www.biostars.org/p/187204/#187206",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/22
MDU6SXNzdWU0NzI3Njg3NDM=,multiqc bug,CLOSED,2019-07-20T15:16:58Z,2019-07-31T13:16:34Z,2019-07-31T13:16:34Z,"If the multiqc output files already exist (for instance, from a previous test run), then it will automatically create files with a `_1` suffix. However, this means the workflow will fail as the ""correct"" files according to snakemake are not generated. ",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/23
MDU6SXNzdWU0NzI3NjY3MjQ=,The dedup bam file should be indexed,CLOSED,2019-07-23T11:09:13Z,2019-07-29T12:25:16Z,2019-07-29T12:25:16Z,"*  `samtools index` can be run on the bam file that is generate by the `rule mark_duplicates`
",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/21
MDU6SXNzdWU0NzE2NjU1OTM=,"Some wrappers barely do anything, replace them by oneliners?",CLOSED,2019-07-23T12:23:06Z,2019-07-29T12:27:35Z,2019-07-29T12:27:35Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/1
MDU6SXNzdWU0NzE2NjY0NDc=,RNA-seq,CLOSED,2019-07-23T12:24:56Z,2019-11-20T15:02:40Z,2019-11-20T15:02:39Z,Get started!,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/2
MDU6SXNzdWU0NzE2NjY2ODc=,CHiP-seq,CLOSED,2019-07-23T12:25:26Z,2020-03-15T17:58:36Z,2020-03-15T17:58:36Z,Get started!,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/3
MDU6SXNzdWU0NzE2NjcwMjc=,ATAC-seq,CLOSED,2019-07-23T12:26:06Z,2019-08-23T14:15:29Z,2019-08-23T14:15:29Z,Move https://github.com/vanheeringen-lab/atac-seq to snakemake-workflows!,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/4
MDU6SXNzdWU0NzE2NzEzMzM=,Add benchmark to each rule,CLOSED,2019-07-23T12:35:41Z,2019-07-30T08:57:03Z,2019-07-30T08:57:03Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/5
MDU6SXNzdWU0NzE2NzE1OTY=,Proper documentation,CLOSED,2019-07-23T12:36:15Z,2019-08-23T14:15:41Z,2019-08-23T14:15:41Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/6
MDU6SXNzdWU0NzE2NzIxMzE=,Add resources (e.g. mem usage) to each rule,CLOSED,2019-07-23T12:37:19Z,2020-01-21T10:43:53Z,2020-01-21T10:43:52Z,"Based on bechmark results?
https://github.com/vanheeringen-lab/snakemake-workflows/issues/5",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/7
MDU6SXNzdWU0NzE2ODA3Njk=,Make threads scale automatically for cluster with no shared nodes (e.g. cartesius),CLOSED,2019-07-23T12:55:44Z,2019-09-26T14:31:15Z,2019-09-26T14:31:15Z,Rules using a variable amount of threads should max this out if run on e.g. cartesius.,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/8
MDU6SXNzdWU0NzE2ODE2MTU=,Submit multiple rules together that are not multithreaded for cluster with no shared nodes (e.g. cartesius),CLOSED,2019-07-23T12:57:28Z,2019-09-26T14:31:14Z,2019-09-26T14:31:14Z,related: https://github.com/vanheeringen-lab/snakemake-workflows/issues/8 https://github.com/vanheeringen-lab/snakemake-workflows/issues/7,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/9
MDU6SXNzdWU0NzE3MjM5OTE=,"Snakemake validate only sets defaults when column is missing, not when values are missing..",CLOSED,2019-07-23T14:16:25Z,2019-07-25T09:51:36Z,2019-07-25T09:51:35Z,Ideally it would also defaults when the value is missing,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/10
MDU6SXNzdWU0NzE3MjUxMTI=,validate configuration files,CLOSED,2019-07-23T14:18:20Z,2019-07-25T13:33:00Z,2019-07-25T13:33:00Z,Will scale better with many workflows,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/11
MDU6SXNzdWU0NzE4NzA0NjQ=,Dynamic ascp,CLOSED,2019-07-23T18:51:27Z,2019-07-29T14:33:57Z,2019-07-29T14:33:57Z,"An elegant way of incorporating the installation of ascp:
https://github.com/vanheeringen-lab/snakemake-workflows/blob/54f7e5aaca2f410d120a8a1fcace7a4d18797102/rules/get_fastq.smk#L1-L16

Currently the ascp path and the key are hardcoded. 

options:
- install ascp manually, and make sure the hard-coded paths are correct (current situation)
- install ascp manually, do a lookup
  - lookup once per rule
  - lookup once per workflow (e.g. in onstart)
- install ascp through a rule, so the hardcoded paths are enforced",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/12
MDU6SXNzdWU0NzIxMjc4NTI=,Alignment (splot dumped files),CLOSED,2019-07-24T07:40:20Z,2019-07-24T08:15:56Z,2019-07-24T08:13:21Z,Get it working,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/13
MDU6SXNzdWU0NzIxMzAzNzg=,Better 'examples' in samples.tsv,CLOSED,2019-07-24T07:46:55Z,2019-09-11T14:25:30Z,2019-09-11T14:25:30Z,As small as possible reference genomes & samples. This will make testing easier/faster.,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/14
MDU6SXNzdWU0NzIxNDE0MjA=,Alignment for split dumped files,CLOSED,2019-07-24T08:13:50Z,2019-07-29T12:26:54Z,2019-07-29T12:26:54Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/15
MDU6SXNzdWU0NzIxNzUxMTY=,"Split based on PE or SE, remove splitsplot architecture",CLOSED,2019-07-24T09:26:45Z,2019-07-25T09:08:19Z,2019-07-25T09:08:19Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/16
MDU6SXNzdWU0NzIzMTk1MzE=,Pipeline fails on samples with restricted access,CLOSED,2019-07-24T14:34:38Z,2019-08-30T12:00:00Z,2019-08-30T11:59:12Z,"See for instance GSM1127077, which links to https://www.ncbi.nlm.nih.gov/sra?term=SRX1157701. This is only accessible via dbGap (which we should not bother supporting at the moment).",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/17
MDU6SXNzdWU0NzI3Mjc4MTc=,replace hardcoded folder names by variables,CLOSED,2019-07-25T08:17:23Z,2019-07-25T15:02:28Z,2019-07-25T14:48:53Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/18
MDU6SXNzdWU0NzI3OTE5ODM=,Call peaks,CLOSED,2019-07-25T10:37:47Z,2019-07-26T07:58:09Z,2019-07-26T07:58:09Z,Get started!,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/24
MDU6SXNzdWU0NzI4NTkxMTg=,Implement samtools sorter,CLOSED,2019-07-25T13:14:45Z,2019-07-29T12:25:49Z,2019-07-29T12:25:49Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/26
MDU6SXNzdWU0NzMyMjkyOTg=,SRA downloading improvements,CLOSED,2019-07-26T07:59:54Z,2019-07-29T12:46:34Z,2019-07-29T12:44:50Z,"https://github.com/vanheeringen-lab/snakemake-workflows/blob/7946b5b6bd36dd8e07ccd810b29a1d7a6d7d2bca/rules/get_fastq.smk#L2

* In this rule, it might be worth adding a few extra checks and print/echo statements for logging purposes. If this rule fails it is almost always not clear why and at which point it fails. 
* Maybe add a retry for `esearch` or `equery` if these tools fail due to a timeout?
",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/30
MDU6SXNzdWU0NzMyNTI2NzQ=,"Keep logs in workflow, it now migrates to subworkflows",CLOSED,2019-07-26T08:58:40Z,2019-07-29T14:07:29Z,2019-07-29T14:07:29Z,"When no log specified, it gets auto set:
https://github.com/vanheeringen-lab/snakemake-workflows/blob/a58efbeb0cf5d7b92e669029a280f2c924d83709/schemas/config.schema.yaml#L27-L30",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/31
MDU6SXNzdWU0NzM2MjYyMTA=,Change subworkflow architecture into include architecture?,CLOSED,2019-07-27T10:48:04Z,2019-07-29T14:07:21Z,2019-07-29T14:07:21Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/33
MDU6SXNzdWU0NzM2MjY5MTk=,Config files are not inherited,CLOSED,2019-07-27T10:58:13Z,2019-07-29T14:07:05Z,2019-07-29T14:07:05Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/34
MDU6SXNzdWU0NzQxMTkxMjM=,Have the pipeline work on local files (not downloaded),CLOSED,2019-07-29T15:34:47Z,2019-07-31T13:13:38Z,2019-07-31T13:13:38Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/39
MDU6SXNzdWU0NzQ0NjcxOTA=,Quality metric collection,CLOSED,2019-07-30T09:13:11Z,2019-07-31T13:14:34Z,2019-07-31T13:14:34Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/44
MDU6SXNzdWU0NzQ1NzY4Njc=,rename does not work on mb07,CLOSED,2019-07-30T13:12:24Z,2019-07-30T14:25:43Z,2019-07-30T14:25:43Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/49
MDU6SXNzdWU0NzQ2MjM3ODE=,docstrings for each rule,CLOSED,2019-07-30T14:36:03Z,2019-08-19T12:08:13Z,2019-08-19T12:08:13Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/51
MDU6SXNzdWU0NzQ2MjkzNDM=,Implement automatic trackhub,CLOSED,2019-07-30T14:45:37Z,2019-08-15T07:50:33Z,2019-08-15T07:50:33Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/52
MDU6SXNzdWU0NzQ2Mjk3MzQ=,Implement working multiqc,CLOSED,2019-07-30T14:46:15Z,2019-07-31T13:13:38Z,2019-07-31T13:13:38Z,Fix bug at the same time: #23 ,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/53
MDU6SXNzdWU0NzQ2NDkwODU=,Implement multiple aligners,CLOSED,2019-07-30T15:19:50Z,2019-08-05T16:04:02Z,2019-08-05T16:04:02Z,"- **star**
- **hisat2**",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/54
MDU6SXNzdWU0NzUwMzYwNzY=,Allow for replicates in peak calling,CLOSED,2019-07-31T09:30:35Z,2019-08-18T12:49:03Z,2019-08-18T12:49:03Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/55
MDU6SXNzdWU0NzU1ODc2ODk=,Implement --consider_already_trimmed in trim_galore,CLOSED,2019-08-01T09:55:45Z,2019-08-01T20:20:40Z,2019-08-01T20:20:30Z,"wait for a new release, see https://github.com/FelixKrueger/TrimGalore/issues/64",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/60
MDU6SXNzdWU0NzYwODA0OTE=,MACS2: remove RNEXT flag for peak calling,CLOSED,2019-08-02T09:15:10Z,2019-08-25T17:35:18Z,2019-08-25T17:35:18Z,"MACS2 throws away half of the reads when using BAM mode. When using BAMPE the reads get 'interpolated' in between, which we do not want for ATAC-seq.

Ideally align with paired end data, but for peak calling remove the information that the reads are paired end? RNEXT flag in bam",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/64
MDU6SXNzdWU0NzYxNzM1OTM=,MACS2 combine replicates more than two replicates,CLOSED,2019-08-02T13:13:57Z,2019-08-08T14:57:52Z,2019-08-08T14:57:45Z,"Currently only supported for 2 replicates, maybe PR?",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/65
MDU6SXNzdWU0NzYxNzM5MTE=,IDR for more than 2 replicates,CLOSED,2019-08-02T13:14:39Z,2019-08-18T12:48:36Z,2019-08-18T12:48:36Z,Only support for two replicates. Take a look at ENCODE pipeline how they fix it,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/66
MDU6SXNzdWU0NzcwMDc1OTc=,HMMRATAC,CLOSED,2019-08-05T18:54:47Z,2019-08-18T12:48:11Z,2019-08-18T12:48:11Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/70
MDU6SXNzdWU0NzcwMDk0MTU=,Split rules + environments into more logical groups,CLOSED,2019-08-05T18:59:23Z,2019-08-06T14:35:09Z,2019-08-06T14:35:09Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/71
MDU6SXNzdWU0Nzc4OTgxMTA=,in cluster environment every rule re-does the PE&SE lookup,CLOSED,2019-08-07T12:28:01Z,2019-08-09T09:52:49Z,2019-08-09T09:52:49Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/73
MDU6SXNzdWU0NzgzMzQyNTY=,sra2fastq_PE dumping goes wrong if lowercase exists in result_dir,CLOSED,2019-08-08T08:50:42Z,2019-08-08T14:55:30Z,2019-08-08T14:55:30Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/78
MDU6SXNzdWU0Nzg0NzgzMzM=,GSMs can contain multiple SRRs,CLOSED,2019-08-08T13:39:56Z,2020-05-07T13:42:24Z,2020-05-07T13:42:24Z,"example: [GSM352203](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM352203)
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/80
MDU6SXNzdWU0Nzg0Nzk3ODE=,Implement Salmon aligner,CLOSED,2019-08-08T13:42:28Z,2019-08-22T15:45:46Z,2019-08-22T15:45:46Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/81
MDU6SXNzdWU0Nzg1MjY1ODA=,Implement automated tests with travis,CLOSED,2019-08-08T15:01:24Z,2019-08-21T12:36:53Z,2019-08-21T12:36:53Z,#14 related,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/84
MDU6SXNzdWU0Nzg1Mzc3OTQ=,"When working with local files, print better error messages when these can not be found",CLOSED,2019-08-08T15:21:04Z,2019-08-09T11:38:31Z,2019-08-09T11:38:31Z,"Local files can not be found since they might not be in result_dir, or fastq_dir, or their fqsuffix and/or fqext is wrong. The error 
```
Checking if samples are single-end or paired-end...
CalledProcessError in line 59 of /home/sande/Dropbox/Studie/PhD/snakemake-workflows/rules/configuration.smk:
Command 'esearch -api_key ba36a74749126e0d9558b7e19967417c3407 -db sra -query GSM12345555555 | efetch -api_key ba36a74749126e0d9558b7e19967417c3407 | grep -Po ""(?<=<LIBRARY_LAYOUT><)[^/><]*""' returned non-zero exit status 1.
  File ""/home/sande/Dropbox/Studie/PhD/snakemake-workflows/workflows/atac_seq/Snakefile"", line 11, in <module>
  File ""/home/sande/Dropbox/Studie/PhD/snakemake-workflows/rules/configuration.smk"", line 78, in <module>
  File ""/home/sande/Dropbox/Studie/PhD/snakemake-workflows/rules/configuration.smk"", line 78, in <dictcomp>
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.7/multiprocessing/pool.py"", line 657, in get
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
  File ""/home/sande/Dropbox/Studie/PhD/snakemake-workflows/rules/configuration.smk"", line 59, in get_layout
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.7/subprocess.py"", line 395, in check_output
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.7/subprocess.py"", line 487, in run
```
is completely uninformative",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/85
MDU6SXNzdWU0Nzk2NTIyMDk=,Incremental configurations,CLOSED,2019-08-12T13:40:59Z,2019-08-16T15:02:43Z,2019-08-16T15:02:43Z,Might be confusing to see all the parameters that do not apply. Maybe config.schema.yaml per workflow,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/91
MDU6SXNzdWU0ODEwNTI2ODg=,"Ternary operators as output seem to be allowed, remove PE & SE rules?",CLOSED,2019-08-15T08:40:15Z,2019-08-15T12:34:49Z,2019-08-15T12:34:49Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/93
MDU6SXNzdWU0ODIyNzExMzI=,Implement STAR aligner,CLOSED,2019-08-19T12:01:57Z,2019-08-27T13:31:11Z,2019-08-27T13:31:11Z,"requires annotation.gtf, which should be accessible via Genomepy",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/98
MDU6SXNzdWU0ODI3NTMyNjY=,IDR for HMMRATAC,CLOSED,2019-08-20T09:38:56Z,2019-11-20T10:04:40Z,2019-11-20T10:04:40Z,https://github.com/LiuLabUB/HMMRATAC/issues/20,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/99
MDU6SXNzdWU0ODI4MTUxOTc=,Multiple replicates finish up,CLOSED,2019-08-20T11:54:38Z,2019-08-23T13:40:44Z,2019-08-23T13:40:44Z,"* frips on combined peaks
* configuration
* testing
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/100
MDU6SXNzdWU0ODM4NjM3NTc=,replicates merging,CLOSED,2019-08-22T09:04:16Z,2019-08-23T13:40:22Z,2019-08-23T13:40:21Z,just merge fastq instead of fisher/idr ,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/106
MDU6SXNzdWU0ODM5NDk4MjE=,Trim galore! causes rule ambiguity,CLOSED,2019-08-22T11:57:08Z,2019-08-23T12:09:36Z,2019-08-23T12:09:36Z,"Seems like a bug in snakemake as a rule order is given. However, this issue may be fixable as the error message reveals `rule trim_galore_SE` is adding _pass_1 to the wildcard:
```
AmbiguousRuleException:
Rules trim_galore_PE and trim_galore_SE are ambiguous for the file /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_1_trimmed.fastq.gz.
Consider starting rule output with a unique prefix, constrain your wildcards, or use the ruleorder directive.
Wildcards:
        trim_galore_PE: sample=GSM2837484
        trim_galore_SE: sample=GSM2837484_pass_1
Expected input files:
        trim_galore_PE: /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_1.fastq.gz /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_2.fastq.gz
        trim_galore_SE: /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_1.fastq.gz
Expected output files:
        trim_galore_PE: /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_1_trimmed.fastq.gz /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_2_trimmed.fastq.gz /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_1.fastq.gz_trimming_report.txt /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_2.fastq.gz_trimming_report.txt
        trim_galore_SE: /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_1_trimmed.fastq.gz /home/siebrenf/git/snakemake-workflows/workflows/alignment/FASTQ/GSM2837484_pass_1.fastq.gz_trimming_report.txt
```
this may be resolved by using a wildcard constraint",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/108
MDU6SXNzdWU0ODM5NjY0MTU=,Genomepy stops if no genes are found,CLOSED,2019-08-22T12:32:34Z,2019-08-26T11:48:19Z,2019-08-26T11:48:19Z,"Bl71nemr annotation apparently contains no genes. This error message is returned via genomepy, but not in snakemake. Update logging system, try to find a fix.

```
Downloading annotation...
WARNING: annotation from NCBI contains no genes, skipping.
```",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/110
MDU6SXNzdWU0ODQwODM3NjY=,More sensible tests,CLOSED,2019-08-22T16:01:21Z,2019-08-23T12:16:28Z,2019-08-23T12:16:28Z,"Wider range of configurations and samples (SE, PE, etc.)",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/114
MDU6SXNzdWU0ODQ5NDQ5MzA=,FR: Only download annotation when required (e.g. rna-seq),CLOSED,2019-08-25T15:40:24Z,2019-08-26T11:48:47Z,2019-08-26T11:48:47Z,"**Is your feature request related to a problem? Please describe.**
We don't have to download annotations when its not required.

**Describe the solution you'd like**
Preferably the workflow resolves internally whether or not the annotation needs to be downloaded. 
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/117
MDU6SXNzdWU0ODU2NzY2Nzg=,FR: Implement stale bot,CLOSED,2019-08-27T08:55:10Z,2019-08-28T18:55:08Z,2019-08-28T18:55:08Z,"**Is your feature request related to a problem? Please describe.**
Those pesky stale issues! Lets get stale https://github.com/marketplace/stale

**Describe the solution you'd like**
A stale bot. 
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/120
MDU6SXNzdWU0ODU2Nzg1NTI=,FR: Implement WIP bot,CLOSED,2019-08-27T08:58:48Z,2019-08-27T11:16:58Z,2019-08-27T11:16:57Z,"**Is your feature request related to a problem? Please describe.**
After review and new commits, it can be unclear whether or not the PR is work in progress, or whether it is done. We need WIP bot! https://github.com/settings/installations/1673576

**Describe the solution you'd like**
A WIP bot :taco: 
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/121
MDU6SXNzdWU0ODY3ODE4MTA=,FR: Snakemake remote files,CLOSED,2019-08-29T07:16:25Z,2019-08-29T08:04:56Z,2019-08-29T08:04:56Z,"**Is your feature request related to a problem? Please describe.**
Take a look at: https://snakemake.readthedocs.io/en/stable/snakefiles/remote_files.html#genbank-ncbi-entrez . Maybe we can download through here? It says it supports all the NCBI entrez databases, so also sra! 
requirements:
- should support ascp
- no new edge cases
- maintainable
- ....?",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/127
MDU6SXNzdWU0ODc1MDM2NTU=,FR: parallel_downloads hardcoded resource,CLOSED,2019-08-30T14:08:20Z,2019-09-01T10:32:41Z,2019-09-01T10:32:41Z,"**Is your feature request related to a problem? Please describe.**
Confusing for new users, and practically NEVER more than one.

**Describe the solution you'd like**
Hardcode the resource (I don't know if we can though...)
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/129
MDU6SXNzdWU0ODc4MDk5OTE=,FR: Improve tests by swtiching from travis -> Jenkins,CLOSED,2019-08-31T20:45:59Z,2019-09-11T17:24:46Z,2019-09-11T17:24:46Z,"**Is your feature request related to a problem? Please describe.**
Currently only the DAG is tested, whilst ideally we would run each rule whether it works as expected.

**Describe the solution you'd like**
Travis has incredibly slow computers. We can move to for instance Amazon cloud, or host Jenkins ourselves.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/130
MDU6SXNzdWU0ODc4NjgyOTE=,FR: Implement GitFlow architecture,CLOSED,2019-09-01T10:25:45Z,2019-09-01T10:43:18Z,2019-09-01T10:43:18Z,"**Is your feature request related to a problem? Please describe.**
Current architecture needs update if we will add releases.

**Describe the solution you'd like**
[GitFlow](https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow) seems fine :smile: 
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/132
MDU6SXNzdWU0ODc4ODYyNzc=,FR: Investigate feasability for version bot,CLOSED,2019-09-01T13:27:30Z,2019-12-13T11:06:25Z,2019-12-13T11:06:25Z,"**Is your feature request related to a problem? Please describe.**
We want to keep our environments updated for all rules, however checking this manually is a pain in the butt.

**Describe the solution you'd like**
See if an existing bot can be used. Otherwise could be fun/useful to implement one ourselves.

**Links**
https://github-bot-tutorial.readthedocs.io/en/latest/",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/133
MDU6SXNzdWU0ODk4NTgxNjU=,FR: Allow for multiple aligners at once,CLOSED,2019-09-05T16:04:05Z,2019-11-14T13:31:28Z,2019-11-14T13:31:28Z,"**Is your feature request related to a problem? Please describe.**
The current tests take a long time, since it is checking one by one if each aligner works. Which is 'fine', however a long period of this time the index is being made for the aligner, and we are just waiting and not computing.

**Describe the solution you'd like**
Implement the same strategy as with the peak callers, in that we can specify multiple. This way the long waiting period for indexing can be quite some shorter.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/142
MDU6SXNzdWU0OTA5NjI3NjA=,Q: Efficient nr of threads for alignment,CLOSED,2019-09-09T08:47:21Z,2019-12-02T11:16:27Z,2019-12-02T11:16:26Z,"**Question**
I just set the nr of threads for alignment to 20 + 4 for sorting, since that's half of the threads I have. Is this a good nr? How much are the diminishing returns? Perhaps 10 + 2 is better?
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/147
MDU6SXNzdWU0OTE1MTc1NTQ=,BUG: Not properly sorted output for macs2,CLOSED,2019-09-10T08:10:47Z,2019-09-11T15:13:12Z,2019-09-11T15:13:12Z,"**Describe the bug**
`/home/sande/snakemake-workflows/workflows/atac_seq/macs2/GSM2837495-danRer7.tmp.narrowPeak is not case-sensitive sorted at line 165730.  Please use ""sort -k1,1 -k2,2n"" with LC_COLLATE=C,  or bedSort and try again.
`

**To Reproduce**
Run the atac seq pipeline",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/148
MDU6SXNzdWU0OTE1MjA2NTU=,BUG: Quality control peak calling ,CLOSED,2019-09-10T08:17:45Z,2019-09-11T15:02:58Z,2019-09-11T15:02:58Z,"**Describe the bug**
Where are my frips etc.? Why is there a snakemake row?

**To Reproduce**
Just run atac seq

**Screenshots**
![image](https://user-images.githubusercontent.com/15323399/64596315-f5ebf880-d3b3-11e9-90b9-8a4c91917165.png)

",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/149
MDU6SXNzdWU0OTIwNTUwMjc=,BUG: KeyError: 'condition' when merge combine_replicates is set but no condition in samples.tsv,CLOSED,2019-09-11T07:02:39Z,2019-09-11T17:24:32Z,2019-09-11T17:24:32Z,"**Describe the bug**
See title

**To Reproduce**
See title",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/150
MDU6SXNzdWU0OTIyNTUxOTA=,BUG: GSM2837507 hangs during trimming,CLOSED,2019-09-11T13:56:53Z,2019-10-14T08:08:56Z,2019-10-14T08:08:55Z,"**Describe the bug**
GSM2837507 hangs in rule trim_galore_PE. Log says it starts, but then keeps hanging and does not use more than one 100% cpu, even though multiple specified....",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/153
MDU6SXNzdWU0OTQ3MzIxNzI=,BUG: picard + salmon + samtools: SAM validation error due to unmapped reads,CLOSED,2019-09-17T16:38:56Z,2019-12-03T12:59:45Z,2019-12-03T12:59:45Z,"**Describe the bug**
Salmon pipes to `samtools view`, which pipes to the sorter of choice. Picard then marks duplicates, but throws the following error:

> Exception in thread ""main"" htsjdk.samtools.SAMFormatException: SAM validation error: ERROR: Record 110, Read name NS500173:496:H52JJBGXB:3:22506:6852:2808, Not primary alignment flag should not be set for unmapped read.

**Dirty solution**
Unmapped reads [could be discarded beforehand](https://www.biostars.org/p/56246/), as these are pseudobams.",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/166
MDU6SXNzdWU0OTYyMTE4NjI=,FR: cleanup snakefiles,CLOSED,2019-09-20T08:12:41Z,2019-09-23T15:35:28Z,2019-09-23T15:35:28Z,"**Is your feature request related to a problem? Please describe.**
https://github.com/vanheeringen-lab/snakemake-workflows/blob/5c7a186c7d190d5048465315e1b6a645848021b9/workflows/alignment/Snakefile#L7-L14

Maybe this can go away",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/168
MDU6SXNzdWU0OTYyMTIyNjY=,BUG: Jenkins does not skip tests when it should?!,CLOSED,2019-09-20T08:13:40Z,2019-09-23T15:35:25Z,2019-09-23T15:35:25Z,"
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/169
MDU6SXNzdWU0OTYyMTI5NDg=,BUG: Jenkins does not report failure when DAG fails,CLOSED,2019-09-20T08:15:25Z,2019-09-23T15:35:22Z,2019-09-23T15:35:22Z,"**Describe the bug**
http://ocimum.science.ru.nl/jenkins/blue/organizations/jenkins/Snakemake-Workflows/detail/develop/14/pipeline/22",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/170
MDU6SXNzdWU0OTYyNTY1MTg=,BUG: outdated multiqc sample name parsing,CLOSED,2019-09-20T09:48:19Z,2019-09-24T13:04:07Z,2019-09-24T13:04:07Z,"**Describe the bug**
MultiQC sample name parsing doesn't handle assembly-sample names. Was inconsistent as well.",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/171
MDU6SXNzdWU0OTYyNTgxMzg=,FR: Multi-genome assembly hubs,CLOSED,2019-09-20T09:51:44Z,2020-02-18T10:36:12Z,2020-02-18T10:36:11Z,"daler/Trackhub can create a hub, does not create additional files.
Gaius-Augustus/MakeHub can create an assembly hub, but only for one genome.",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/172
MDU6SXNzdWU0OTc2NDQ0MDk=,"BUG: error in ...rules/configuration.smk"", line 276",CLOSED,2019-09-24T12:03:49Z,2019-09-24T12:35:49Z,2019-09-24T12:35:49Z,"**Describe the bug**
bugs often point to configuration.smk and `add_default_resources` instead of the actual rule where the workflow fails. Specifically to the line `return func(*args, **kwargs)` 

**Expected behavior**
for snakemake to point to the file and line where the failure originates from.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/174
MDU6SXNzdWU0OTgxNzc4MzA=,FR: test dataset,CLOSED,2019-09-25T09:55:13Z,2019-11-04T16:24:46Z,2019-11-04T16:24:46Z,"I'd like to add a genome-, annotation-, size- and index file containing the first 100.000 or so nt of chromosomes 1 & 2. Together with several tiny fastq files, both paired- and single-ended, stranded and non-stranded, with (sythethic) features for replicate merging and DE contrast design.

This would speed up Jenkins tests (as files only need to be downloaded for the download test), and allows for more robust testing.

Improved testing would allow us to implement the conda version-upgrading bot",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/177
MDU6SXNzdWU0OTgyNDUxMTE=,BUG: txi.R script changes sample names (solution: set check.names=F),CLOSED,2019-09-25T12:11:43Z,2019-12-13T13:06:50Z,2019-12-13T13:06:49Z,"**Describe the bug**
sample names in the counts table do not correspond to input sample names. They are likely altered because their are syntactically incorrect. Might be fixed by going over all dataframe creating/coercing operations and adding `check.names=F`

**To Reproduce**
run the rna-seq pipeline with salmon and samples containing a '-' in the name.

**Expected behavior**
either that these names are rejected by default, to kept identical in the R script.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/178
MDU6SXNzdWU0OTgzODUyNjM=,FR: counts matrices from all aligners,CLOSED,2019-09-25T16:10:09Z,2019-12-03T12:57:24Z,2019-12-03T12:57:24Z,"**Is your feature request related to a problem? Please describe.**
Only STAR and Salmon (with Ensembl genomes) can currently output count matrices

**Describe the solution you'd like**
Use featureCounts (and/or HTseq-count and/or bedtools multicov) to generate gene count matrices from BAM files. 

This can be applied to all aligners at once. Furthermore, this output could be used in the multiQC.

**(optional) Additional context**
The process is described [here](https://galaxyproject.github.io/training-material/topics/transcriptomics/tutorials/rna-seq-reads-to-counts/tutorial.html#counting) for hisat2.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/179
MDU6SXNzdWU1MDA3Mjk1NjY=,FR: Union of peaks,CLOSED,2019-10-01T08:01:56Z,2019-12-03T09:58:37Z,2019-12-03T09:58:37Z,"**Describe the solution you'd like**
Currently we support merging fastq's and calling peaks on that, or 'merging' replicates with idr or fisher's method. It is also common to merge peaks by taking their union. We should support this.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/180
MDU6SXNzdWU1MDA3MzIxMjc=,FR: Support bedtools multicov for 'count tables',CLOSED,2019-10-01T08:07:30Z,2019-10-15T13:54:15Z,2019-10-15T13:54:15Z,"**Describe the solution you'd like**
Output a multicov bed/table with the difference between conditions",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/181
MDU6SXNzdWU1MDIxNjI4MzQ=,FR: Implement fluff,CLOSED,2019-10-03T16:15:12Z,2019-10-29T15:04:11Z,2019-10-29T15:04:11Z,"**Describe the solution you'd like**
Pretty figure output with fluff
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/182
MDU6SXNzdWU1MDQ1MTM3ODA=,BUG: Sometimes only one replicate exists ,CLOSED,2019-10-09T09:05:00Z,2019-10-09T13:20:12Z,2019-10-09T13:20:11Z,"**Describe the bug**
`When specifying conditions every condition needs at least two ...`

",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/183
MDU6SXNzdWU1MDc4MDM4NTA=,FR: Separate rules for merging technical and biological replicates,CLOSED,2019-10-16T11:57:21Z,2020-03-12T10:22:36Z,2020-03-12T10:22:35Z,"**Describe the solution you'd like**
Technical replicates can often be merged, while biological replicates need to be evaluated for batch effects. 

I think we want to give the user the option to name the column in samples.tsv, and reference that name in config.yaml. One option for both technical and biological replicates, and a secondary option of merging method.

Technical replicates could all be merged by concatenation (for now), and no default column name is needed. 
For biological replicates, the default column name could be 'condition' (although I think this is rather vague and would prefer 'replicates'). 
This way the user can merge technical and biological replicates by only this column in sampltes.tsv

**(optional) Additional context**
I'm currently changing the merge_replicate rule to all workflows.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/186
MDU6SXNzdWU1MTcyNTA2MzY=,BUG: Difference between macs2 and genrich pileup,CLOSED,2019-11-04T16:06:54Z,2019-11-20T10:04:12Z,2019-11-20T10:04:12Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/190
MDU6SXNzdWU1MTcyNTEwMDU=,FR: Blacklist,CLOSED,2019-11-04T16:07:32Z,2020-03-15T17:59:26Z,2020-03-15T17:59:26Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/191
MDU6SXNzdWU1MTcyNjAwMTM=,FR: wildcard fqext with constraints,CLOSED,2019-11-04T16:22:30Z,2019-11-29T11:05:18Z,2019-11-29T11:05:17Z,"**Is your feature request related to a problem? Please describe.**
selecting R1/pass1 is annoying. 

**Describe the solution you'd like**
Let's try to make it a wildcard with constraints from a list (containing these two as defaults), and allow users to set others.

**(optional) Additional context**
In config.smk, the any_given and global wildcard constraints give us a setup to do this.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/192
MDU6SXNzdWU1MTc2MTAzMzg=,FR: Multicov does not work for queryname sorted files (e.g. genrich),CLOSED,2019-11-05T08:10:26Z,2019-11-14T13:25:31Z,2019-11-14T13:25:31Z,"**Describe the bug**
We can not make a samtools index for queryname sorted files. This is bad, we should maybe always sort as well on coordinate?",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/193
MDU6SXNzdWU1MTc4MDUzMjE=,BUG: configuration prints complete cache,CLOSED,2019-11-05T14:25:24Z,2019-11-19T17:50:06Z,2019-11-19T17:50:06Z,"**Describe the bug**
The cofiguration print at the start prints the complete cache, not only the samples in samples.tsv",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/194
MDU6SXNzdWU1Mjg4NzMyOTg=,FR: expose config options,CLOSED,2019-11-26T17:33:22Z,2020-02-24T10:17:22Z,2020-02-24T10:17:22Z,"Filling in the `config.yaml` requires you to have all schemas next to you to know what options there are, and even then you need to figure out what to enter.

It's tedious, but adding a list of available options/examples in the schemas with `enum` will give users an idea of the available options.

We discussed this, so I know `cookiecutter` won't *cut* it __ba dum tsss__, but a helper tool would be ideal. It could likely use the `enum` option to give hint anyway...


",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/207
MDU6SXNzdWU1Mjg4NzUxNjk=,FR: Bam to normalized bigwig,CLOSED,2019-11-26T17:36:56Z,2019-12-13T13:06:49Z,2019-12-13T13:06:49Z,"**Is your feature request related to a problem? Please describe.**
There is no option to normalize bigwigs

**Describe the solution you'd like**
Add a config option to normalize bigwigs (default=None)

**(optional) Additional context**
[link](https://deeptools.readthedocs.io/en/develop/content/tools/bamCoverage.html#Read%20coverage%20normalization%20options)
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/208
MDU6SXNzdWU1MzAzMzUwNzk=,BUG: rna-seq > trackhub,CLOSED,2019-11-29T12:59:59Z,2019-12-13T13:06:49Z,2019-12-13T13:06:49Z,"**Describe the bug**
`'InputFiles' object has no attribute 'twobits'`

**To Reproduce**
run the rna-seq pipeline
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/209
MDU6SXNzdWU1MzIwNTk2MTQ=,update tximeta,CLOSED,2019-12-03T15:18:59Z,2020-03-18T13:00:58Z,2020-03-18T13:00:58Z,"Tximeta is at version 1.4.0 on conda. 

Until a newer version (>1.4.4) is added, quantification with salmon is not possible.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/212
MDU6SXNzdWU1MzM1MzU3NTU=,FR: Quality Trimming,CLOSED,2019-12-05T19:02:21Z,2020-03-15T17:59:38Z,2020-03-15T17:59:38Z,"**Is your feature request related to a problem? Please describe.**
Reads that map poorly should be removed! :angry: 

**Describe the solution you'd like**
No more bad reads! 

See for instance:
https://www.biostars.org/p/106900/",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/213
MDU6SXNzdWU1MzM1NDQwMTE=,FR: Rename samples based on descriptive info,CLOSED,2019-12-05T19:19:49Z,2020-03-15T17:59:51Z,2020-03-15T17:59:51Z,"**Is your feature request related to a problem? Please describe.**
The MultiQC report and Trackhub are horrible to interpret, since the samples are named SRR12345677 etc. 

**Describe the solution you'd like**
In the samples.tsv add another column with descriptive name. Should be quite straightworfward to implement with https://multiqc.info/docs/#bulk-sample-renaming and since the trackhub is Python.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/214
MDU6SXNzdWU1MzgyNTg2MDE=,BUG/FR: Data wrongly notated as single/paired-end,OPEN,2019-12-16T08:25:54Z,2020-09-23T06:48:59Z,,"See for instance:
- https://www.ncbi.nlm.nih.gov/sra?term=SRX5376909
- https://www.ncbi.nlm.nih.gov/sra/?term=GSM3607580
![image](https://user-images.githubusercontent.com/15323399/70889949-1abfbf80-1fe4-11ea-8bd0-c2ad72436ad1.png)

The pipeline very much does not like this. I emailed the author to update the layout, however to avoid future problems we could first try to parse the trace page, and if that doesn't work we use the supplied layout?
https://trace.ncbi.nlm.nih.gov/Traces/sra/?run=SRR8577639",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/228
MDU6SXNzdWU1MzkxODQ4NTI=,BUG: bad tests,CLOSED,2019-12-17T16:42:55Z,2020-04-03T14:19:19Z,2020-04-03T14:19:19Z,"@siebrenf 
Since we cannot get the tests to work how we want, and this is annoying with the conda bot. 

I propose I turn off the bot for now and just make some toy data and we run every test always. Probably makes the tests faster as well. Once this works the bot can be turned on again.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/240
MDU6SXNzdWU1NDU3MTUxODI=,BUG: Bad SRRs,CLOSED,2020-01-06T13:02:09Z,2020-01-28T18:52:35Z,2020-01-28T18:52:35Z,"**Describe the bug**
SRR2778061-SRR2778064 give weird errors when trying to dump them.

Would be nice if supported :smile: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/241
MDU6SXNzdWU1NTY0MDEzMzg=,Q: duplicates to bigwig,CLOSED,2020-01-28T18:54:07Z,2020-03-05T13:12:01Z,2020-03-04T13:40:35Z,"**Question**
Are duplicates visible in the trackhub? I am guessing not from peak callers, since they are made from bedgraph and you specify to keep duplicates or not. Not sure with RNA-seq. Note to self to check this :smile: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/243
MDU6SXNzdWU1NjI0ODk4OTI=,FR: Add ATACSeqQC,CLOSED,2020-02-10T11:11:25Z,2020-03-19T15:19:28Z,2020-03-19T15:19:26Z,"**Is your feature request related to a problem? Please describe.**
https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-1929-3
They say to use ATACSeqQC :)",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/244
MDU6SXNzdWU1NjYxNjg2NTk=,BUG: id2sra stuck on Cartesius,CLOSED,2020-02-17T09:32:34Z,2020-02-25T09:42:02Z,2020-02-25T09:42:02Z,"**Describe the bug**
On Cartesius:
`srun -p normal -t 5-00:00:00 snakemake --use-conda -j 24`

Then id2sra hangs indefinitely with log:
> starting lookup of the sample in the sra database:
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/249
MDU6SXNzdWU1NjY3OTQ5NjU=,FR: Jenkins improvements,CLOSED,2020-02-18T10:29:08Z,2020-04-07T12:14:02Z,2020-04-07T12:14:02Z,"**Is your feature request related to a problem? Please describe.**
Jenkins is janky. 1) Test skipping logic is currently taken out (#169), and 2) further parallelization of DAG testing is not possible due to the limit on NCBI calls.

**Describe the solution you'd like**
1) Every run, we need to check whether a list of files has changed since the last time a specific stage has completed successfully. This might be in [this plugin](https://plugins.jenkins.io/changes-since-last-success/). Relevant SO posts: [1](https://stackoverflow.com/questions/38084806/how-to-get-the-changes-since-the-last-successful-build-in-jenkins-pipeline), [2](https://devops.stackexchange.com/questions/2310/get-all-change-logs-of-since-last-successful-build-in-jenkins-pipeline).
2) As Maarten described in #250: Add a mutex lock around layouts.p
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/251
MDU6SXNzdWU1Njk3MDU4NDY=,configuration.smk,CLOSED,2020-02-24T08:34:00Z,2020-02-24T09:24:33Z,2020-02-24T08:44:09Z,"I just updated the pipeline, however when running it I ran into a issue with the configuration.smk file:

AttributeError in line 355 of /home/jsmits/snakemake-workflows/rules/configuration.smk:
'NoneType' object has no attribute 'update'
  File ""/home/jsmits/snakemake-workflows/workflows/rna_seq/Snakefile"", line 11, in <module>
  File ""/home/jsmits/snakemake-workflows/rules/configuration.smk"", line 355, in <module>

My first guess is that I should update my snakemake-workflows conda environment, since it doesn't know the .update command from the config file. Did the snakemake-workflows.yaml file get updated?

I'm running an update command right now, and will let you guys know if this fixes the issue.

Gr Jos.
",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/253
MDU6SXNzdWU1NzA1NDUyOTM=,Trackhub stuff,CLOSED,2020-02-25T12:46:34Z,2020-03-12T10:04:46Z,2020-03-12T10:04:46Z,"When running the RNAseq pipeline with my own fastq files and genome, the trackhub rule crashes:

```
rule trackhub:
    input: <TBD>
    output: /home/jsmits/Epithelial_fate_KC_LSC/RNA/trackhub
    log: /home/jsmits/Epithelial_fate_KC_LSC/RNA/log/trackhub/trackhub.log
    jobid: 4
    benchmark: /home/jsmits/Epithelial_fate_KC_LSC/RNA/benchmark/trackhub/trackhub.benchmark.txt
```

It seems to fail to generate the proper input, and therefore crashes a little time later:

```
INFO:snakemake.logging:[Tue Feb 25 12:08:57 2020]
Error in rule trackhub:
ERROR:snakemake.logging:Error in rule trackhub:
    jobid: 0
ERROR:snakemake.logging:    jobid: 0
    output: /home/jsmits/Epithelial_fate_KC_LSC/RNA/trackhub
ERROR:snakemake.logging:    output: /home/jsmits/Epithelial_fate_KC_LSC/RNA/trackhub
    log: /home/jsmits/Epithelial_fate_KC_LSC/RNA/log/trackhub/trackhub.log (check log file(s) for error message)
ERROR:snakemake.logging:    log: /home/jsmits/Epithelial_fate_KC_LSC/RNA/log/trackhub/trackhub.log (check log file(s) for error message)
```

```
ERROR:snakemake.logging:
RuleException:
AttributeError in line 501 of /home/jsmits/snakemake-workflows/rules/trackhub.smk:
'InputFiles' object has no attribute 'twobits'
  File ""/home/jsmits/snakemake-workflows/rules/trackhub.smk"", line 501, in __rule_trackhub
  File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/concurrent/futures/thread.py"", line 56, in run
ERROR:snakemake.logging:RuleException:
AttributeError in line 501 of /home/jsmits/snakemake-workflows/rules/trackhub.smk:
'InputFiles' object has no attribute 'twobits'
  File ""/home/jsmits/snakemake-workflows/rules/trackhub.smk"", line 501, in __rule_trackhub
  File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/concurrent/futures/thread.py"", line 56, in run
Exiting because a job execution failed. Look above for error message
ERROR:snakemake.logging:Exiting because a job execution failed. Look above for error message
```",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/256
MDU6SXNzdWU1NzIxMDg5MDg=,BUG: Better error when samples.tsv is malformed,CLOSED,2020-02-27T14:07:07Z,2020-03-05T16:16:02Z,2020-03-05T15:46:40Z,"Now it's difficult for beginner users, and I've seen it happen many timtes.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/260
MDU6SXNzdWU1NzI3NDEyNjQ=,FR:mutex lock around layouts.p,CLOSED,2020-02-28T13:00:24Z,2020-03-11T19:30:27Z,2020-03-11T19:30:27Z,If I want to start my snakemakes on the slurm cluster I do NOT want them to all read and write the layouts.p file at the same time :),Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/264
MDU6SXNzdWU1Nzk1MTEyNDE=,FR: remove common variants,CLOSED,2020-03-11T19:56:24Z,2020-11-04T08:48:56Z,2020-11-04T08:48:56Z,"In the human genome there are common variants which people want to have removed 9/10 times before alingment, me too.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/271
MDU6SXNzdWU1ODAwNDIyMTc=,FR: Code linting,CLOSED,2020-03-12T16:00:20Z,2020-03-25T10:06:05Z,2020-03-25T10:06:05Z,"WE NEED THIS
https://github.com/snakemake/snakemake/pull/276",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/273
MDU6SXNzdWU1ODI2MDA4ODg=,FR: Improve docs,CLOSED,2020-03-16T21:10:22Z,2020-07-11T09:49:42Z,2020-07-11T09:49:42Z,Lots of changes have been added and lots are in develop. We should make sure the docs are up to date.,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/277
MDU6SXNzdWU1ODY5NTYyMTU=,FR: Broad and Narrow peak calling in Chip-seq workflow,CLOSED,2020-03-24T13:23:02Z,2020-03-29T09:34:20Z,2020-03-29T09:34:20Z,"I'm going to try out the Chipseq workflow (#flock yea super cool!), since it suports the descriptive_name, which is ideal since I'm downloading some data. However most of the called peaks I think I can toss, since the MACS2 options for broad and Narrow peakcalling will need to be differend.

It would be cool if we could include a type of peak collumn in the sample file, with the options 'broad' or 'narrow', which you could specify in the config file. 
Not sure if it is possible or yet what the exect options of MACS2 are in those curcomstances. But just an idea I dont want to forget.


Gr Jos
",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/284
MDU6SXNzdWU1ODcwMDc3NDg=,BUG: chipseq DAG generation,CLOSED,2020-03-24T14:37:08Z,2020-03-24T15:17:50Z,2020-03-24T15:17:50Z,"I'm on the develop branch trying to run the chipseq pipeline:
my sample file contains: 
sample	assembly	descriptive_name
Chipseq_DOM_H3K4me3	GRCh38.p13	DOM_H3K4me3

However it fails at the DAG generation due to:
""
Checking if samples are single-end or paired-end...
Done!


CONFIGURATION VARIABLES:
samples                : samples.tsv
result_dir             : /home/jsmits/Epithelial_fate_KC_LSC/Chipseq
genome_dir             : /home/jsmits/tools
email                  : Jsmits@science.ru.nl
peak_caller            : {'macs2': '--keep-dup 1 --buffer-size 10000'}
biological_replicates  : fisher
technical_replicates   : merge
remove_blacklist       : True
min_mapping_quality    : 30
aligner                : bwa
rule_dir               : /home/jsmits/snakemake-workflows/rules
log_dir                : /home/jsmits/Epithelial_fate_KC_LSC/Chipseq/log
benchmark_dir          : /home/jsmits/Epithelial_fate_KC_LSC/Chipseq/benchmark
fqext1                 : R1
fqext2                 : R2
fqsuffix               : fastq
sra_dir                : /home/jsmits/Epithelial_fate_KC_LSC/Chipseq/sra
fastq_dir              : /home/jsmits/Epithelial_fate_KC_LSC/Chipseq/fastq
split                  : --split-files --skip-technical --dumpbase --readids --clip --read-filter pass --defline-seq '@$ac.$si.$sg/$ri' --defline-qual '+'
splot                  : --split-spot  --skip-technical --dumpbase --readids --clip --read-filter pass --defline-seq '@$ac.$si.$sg/$ri' --defline-qual '+'
trimmed_dir            : /home/jsmits/Epithelial_fate_KC_LSC/Chipseq/fastq_trimmed
qc_dir                 : /home/jsmits/Epithelial_fate_KC_LSC/Chipseq/qc
dedup_dir              : /home/jsmits/Epithelial_fate_KC_LSC/Chipseq/dedup
trim_galore            : --quality 10 --length 20 --consider_already_trimmed 10
samtools_index         :
markduplicates         : REMOVE_DUPLICATES=false -Xms4G -Xmx6G MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=999
tn5_shift              : False
remove_mito            : False
macs2_keep_mates       : False
create_trackhub        : True
deeptools              : --samFlagExclude 1024
filter_bam_by_strand   : True
fqext                  : ['R1', 'R2']
index                  : -a bwtsw
align                  : -M
layout                 : {'Chipseq_DOM_H3K4me3': 'PAIRED'}



Building DAG of jobs...
MissingInputException in line 26 of /home/jsmits/snakemake-workflows/workflows/chip_seq/Snakefile:
Missing input files for rule call_peaks_all:
/home/jsmits/Epithelial_fate_KC_LSC/Chipseq/count_table/macs2/count_table_GRCh38.p13.samtools-coordinate.bed""


I'm guessing there is a mistake somwhere linking the output of the mapping to the rull all? However up untill now I didnt find it yet. I pulled the latest version and updated my snakemake-workflows env.

Gr Jos
",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/285
MDU6SXNzdWU1ODc1NTg2OTc=,BUG: weird conda/server behaviour?,CLOSED,2020-03-25T09:27:43Z,2020-04-23T11:34:53Z,2020-03-25T09:56:59Z,"I'm not sure why, it could be a server related issue. But after switching to the develop version and updating the snakemake-workflows env, i got  the next error multiple times when trying to making the gimme.yaml environment for the chipseq workflow:

_> CondaVerificationError: The package for scipy located at /home/jsmits/anaconda3/envs/snakemake-workflows/pkgs/scipy-1.4.1-py36h921218d_0
> appears to be corrupted. The path 'lib/python3.6/site-packages/scipy/__pycache__/__init__.cpython-36.pyc'
> specified in the package manifest cannot be found.
... etc
>_ 

Since something looked corrupted I removed the snakemake-workflow env and regenerated it fresh and new from the develop .yml file. However when I then tried to run it I ran into a differend error at exactly the same step: 



_> CreateCondaEnvironmentException:
> Could not create conda environment from /home/jsmits/snakemake-workflows/rules/../envs/gimme.yaml:
> Collecting package metadata (repodata.json): ...working... failed

> # >>>>>>>>>>>>>>>>>>>>>> ERROR REPORT <<<<<<<<<<<<<<<<<<<<<<
> 
>     Traceback (most recent call last):
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/gateways/disk/update.py"", line 107, in touch
>         mkdir_p_sudo_safe(dirpath)
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/gateways/disk/__init__.py"", line 84, in mkdir_p_sudo_safe
>         os.mkdir(path)
>     FileExistsError: [Errno 17] File exists: '/home/jsmits/anaconda3/envs/snakemake-workflows/pkgs'
> 
>     During handling of the above exception, another exception occurred:
> 
>     Traceback (most recent call last):
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/core/subdir_data.py"", line 189, in _load
>         mtime = getmtime(self.cache_path_json)
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/core/subdir_data.py"", line 157, in cache_path_json
>         return self.cache_path_base + '.json'
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/core/subdir_data.py"", line 148, in cache_path_base
>         create_cache_dir(),
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/core/subdir_data.py"", line 649, in create_cache_dir
>         cache_dir = join(PackageCacheData.first_writable(context.pkgs_dirs).pkgs_dir, 'cache')
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/core/package_cache_data.py"", line 160, in first_writable
>         created = create_package_cache_directory(package_cache.pkgs_dir)
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/gateways/disk/create.py"", line 435, in create_package_cache_directory
>         touch(join(pkgs_dir, PACKAGE_CACHE_MAGIC_FILE), mkdir=True, sudo_safe=sudo_safe)
>       File ""/home/jsmits/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/conda/gateways/disk/update.py"", line 125, in touch
>         raise NotWritableError(path, e.errno, caused_by=e)
>     conda.exceptions.NotWritableError: The current user does not have write permissions to a required path.
>       path: /home/jsmits/anaconda3/envs/snakemake-workflows/pkgs/urls.txt
>       uid: 14752
>       gid: 14752
> 
>     If you feel that permissions on this path are set incorrectly, you can manually
>     change them by executing
> 
>       $ sudo chown 14752:14752 /home/jsmits/anaconda3/envs/snakemake-workflows/pkgs/urls.txt
> 
>     In general, it's not advisable to use 'sudo conda'.
> 
>     During handling of the above exception, another exception occurred:
>     etc..._



Which was very weird, i tried multiple things, and eventually updating the version of python in the environment seemed to have worked

_

> The following packages will be UPDATED:
> 
>   python                pkgs/main::python-3.6.10-h191fe78_1 --> conda-forge::python-3.6.10-h9d8adfe_1009_cpython
>   readline               pkgs/main::readline-7.0-h7b6447c_5 --> conda-forge::readline-8.0-hf8c457e_0
> 
> The following packages will be SUPERSEDED by a higher-priority channel:
> 
>   ncurses                 pkgs/main::ncurses-6.2-he6710b0_0 --> conda-forge::ncurses-6.1-hf484d3e_1002_

_

Now it succesfully generated all conda environments and is running the pipeline. However I'm not sure if it is a weird server flockup or if the updating of python really did something and that is the thing that fixed it. Instead of forgetting this while somebody else might run into it, I thought I'd make it an isue so you guys also know if something similar pops up with somebody else.

If an issue is not the right place for this kind of thing or not needed, just let me know!

Gr Jos",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/288
MDU6SXNzdWU1ODc2NDUzMDc=,FR: background for peak calling,CLOSED,2020-03-25T11:59:12Z,2020-04-03T10:00:33Z,2020-04-03T10:00:33Z,"It is common to add background to correct for local accessibility etc, mac2 and genrich (maybe hmmratac? idk) allow for this. 

Definetly sth we should support. ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/289
MDU6SXNzdWU1ODk1NjkyNjM=,BUG: descriptive_names don't autofill,CLOSED,2020-03-28T12:36:34Z,2020-03-31T13:39:01Z,2020-03-31T13:39:01Z,"**Describe the bug**
If only some samples have descriptive names, the config will throw an error

**Solution**
Similar to replicate and condition columns, fill in the sample names if the content is NA.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/292
MDU6SXNzdWU1ODk1NzEyMjY=,BUG: blacklist not found,CLOSED,2020-03-28T12:49:11Z,2020-03-31T10:10:14Z,2020-03-31T10:10:14Z,"**Describe the bug**
This might be snakemake unable to chain this many files(?), but the blacklist is still not found...

**To Reproduce**
In branch develop, run the atac-seq workflow with default params.

**Screenshots**
```
[Sat Mar 28 13:46:34 2020]
rule alignmentsieve:
    input: /mnt/passer/bank/experiments/2020-04/xt_dr_atacseq_snakemake/bwa/xenTro9-stage16_repl2.samtools-coordinate-unsieved.bam, /mnt/passer/bank/experiments/2020-04/xt_dr_atacseq_snakemake/bwa/xenTro9-stage16_repl2.samtools-coordinate-unsieved.bam.bai, /mnt/passer/bank/genomes/xenTro9/xenTro9.customblacklist.bed
    output: /mnt/passer/bank/experiments/2020-04/xt_dr_atacseq_snakemake/bwa/xenTro9-stage16_repl2.samtools-coordinate-sieved.bam
    log: /mnt/passer/bank/experiments/2020-04/xt_dr_atacseq_snakemake/log/alignmentsieve/xenTro9-stage16_repl2.log
    jobid: 988
    benchmark: /mnt/passer/bank/experiments/2020-04/xt_dr_atacseq_snakemake/benchmark/alignmentsieve/xenTro9-stage16_repl2.benchmark.txt
    wildcards: assembly=xenTro9, sample=stage16_repl2

InputFunctionException in line 349 of /home/siebrenf/git/snakemake-workflows/rules/alignment.smk:
FileNotFoundError: [Errno 2] No such file or directory: '/mnt/passer/bank/genomes/xenTro9/xenTro9.customblacklist.bed'
Wildcards:
assembly=xenTro9
sample=stage16_repl2

```
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/293
MDU6SXNzdWU1OTA5Nzc1OTg=,BUG: temp(fastq_trimmed) and merge_replicates,CLOSED,2020-03-31T10:18:01Z,2020-04-03T17:07:28Z,2020-04-03T17:07:28Z,"**Describe the bug**
fastq_trimmed output is currently temp(), so is deleted after merge_replicates is finished. Merge_replicates symlinks files if the number of samples in a ""replicate"" is 1. 
All symlinks end up dead.

**Solution**
instead of symlinking, the rule could move the input to output.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/297
MDU6SXNzdWU1OTI0MDI2NTc=, rule alignmentsieve I/O bottleneck?,CLOSED,2020-04-02T06:57:55Z,2020-04-05T15:18:34Z,2020-04-05T15:18:34Z,"I noticed when running multiple alignmentsieve rules, that the per thread usage would drop down to neglectable CPU usgage. The pipeline didnt really seem to make any progress.

If i ran Rita's: 'usage' script, it would give an warning to emidiately stop heavy Input/Ouptut intensive workloads. Is it possible that with multiple alignmentsieve rules the IO of the server is bottlenecked?

Its furthermore weird, that if i start a pipline with only 4 cores (-j 4), many more processes are started (see th atac snakemake processes in the bellow attached screenshots)
<img width=""1938"" alt=""multiple cores"" src=""https://user-images.githubusercontent.com/47240368/78219496-ec48f000-74bf-11ea-9911-5f55121a0624.png"">

I dont know a lot about I/O but if I remember correctly it is one of the few things that can properly mess up the server witouth raising any warnings. 
  

Gr Jos",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/303
MDU6SXNzdWU1OTc3MzAzNTI=,BUG: FileNotFoundError,CLOSED,2020-04-10T06:53:57Z,2020-04-20T15:33:15Z,2020-04-20T15:33:00Z,"Last night I got this error, and it doesn't matter whether or not I execute the workflow on `moldev` or locally.

```
Traceback (most recent call last):
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/__init__.py"", line 647, in snakemake
    keepincomplete=keep_incomplete,
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/workflow.py"", line 894, in execute
    success = scheduler.schedule()
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/scheduler.py"", line 360, in schedule
    run = self.job_selector(needrun)
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/scheduler.py"", line 504, in job_selector
    c = list(map(self.job_reward, jobs))  # job rewards
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/scheduler.py"", line 588, in job_reward
    temp_size = self.dag.temp_size(job)
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/dag.py"", line 548, in temp_size
    return sum(f.size for f in self.temp_input(job))
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/dag.py"", line 548, in <genexpr>
    return sum(f.size for f in self.temp_input(job))
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/io.py"", line 139, in wrapper
    return func(self, *args, **kwargs)
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/io.py"", line 154, in wrapper
    return func(self, *args, **kwargs)
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/io.py"", line 350, in size
    return self.size_local
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/io.py"", line 355, in size_local
    self.check_broken_symlink()
  File ""/home/sande/anaconda3/envs/snakemake-workflows/lib/python3.6/site-packages/snakemake/io.py"", line 360, in check_broken_symlink
    if not self.exists_local and os.lstat(self.file):
: [Errno 2] No such file or directory: '/mnt/ocimum/vol/new_atac/fastq_trimmed/Xt_stage34_rep2_R1_trimmed.fastq.gz'
```

I am not sure if this is a problem caused by us, or a problem of SnakeMake.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/309
MDU6SXNzdWU2MDUzNTY4NTc=,BUG: pls do not overwrite user-specified ram,CLOSED,2020-04-23T08:51:30Z,2020-04-29T07:06:20Z,2020-04-29T07:06:20Z,"```
WARNING: The specified ram (999 gb) surpasses the local machine's RAM (62 gb)
Building DAG of jobs...
Using shell: /bin/bash
Provided cluster nodes: 350
Provided resources: parallel_downloads=3, deeptools_limit=16, R_scripts=1, mem_gb=62
```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/315
MDU6SXNzdWU2MDczNjQyMTA=,FR/BUG: Remove samtools sort intermediate files when rule is cancelled,CLOSED,2020-04-27T08:57:06Z,2020-05-07T14:49:32Z,2020-05-07T14:49:32Z,"**Is your feature request related to a problem? Please describe.**
When cancelling the pipeline prematurely or when it crashes, intermediate samtools sort files can remain when mapping. These files block the re-running of the pipeline, and need manual :vomiting_face: removal.

**Describe the solution you'd like**
Add a trap to remove these files
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/317
MDU6SXNzdWU2MDgyMDAwMDA=,FR: Add FAQ section in docs,CLOSED,2020-04-28T10:20:25Z,2020-05-02T09:56:27Z,2020-05-02T09:56:27Z,self-explanatory,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/318
MDU6SXNzdWU2MTA3MTgwNzU=,BUG: IDR doesn't work,CLOSED,2020-05-01T12:02:35Z,2020-05-07T17:25:01Z,2020-05-07T17:25:01Z,"**Describe the bug**
result_dir is recognized as a wildcard

![image](https://user-images.githubusercontent.com/15323399/80804081-63070500-8bb4-11ea-939a-12176782fd0d.png)

",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/319
MDU6SXNzdWU2MTA3NTg4NzI=,BUG: (public) samples mixed with single-end and paired-end data,CLOSED,2020-05-01T13:46:02Z,2020-09-23T06:47:28Z,2020-09-23T06:47:27Z,"**Describe the bug**
https://www.ncbi.nlm.nih.gov/sra/?term=GSM2156963 and https://www.ncbi.nlm.nih.gov/sra?term=SRX1424709 are a mix of single-end and paired-end runs. This now crashes.

**Expected behavior**
Not really sure. Ideally the pipeline either gracefully notifies the user of the issue, or somehow manages to combine these two datatypes.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/321
MDU6SXNzdWU2MTExNDM2NTE=,FR: LC_COLLATE warning,CLOSED,2020-05-02T09:13:31Z,2020-05-12T13:01:24Z,2020-05-12T13:01:24Z,"**Is your feature request related to a problem? Please describe.**
When people have the wrong LC_COLLATE settings, click in genomepy complains and some other tools also become unhappy. I do not think changing the current environment for users is a very nice thing to do, so we probably should just give a warning and let the workflow end, with a command that the user can do it themselves. This way it is their own responsibility.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/322
MDU6SXNzdWU2MTExOTU5Nzc=,FR: Replace interactive correlation plot with static dendrogram ,CLOSED,2020-05-02T13:56:24Z,2020-12-02T13:06:46Z,2020-12-02T13:06:46Z,"**Is your feature request related to a problem? Please describe.**
It's nice that the correlation plot is interactive, but the dendrogram and row/column ordering is much more important.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/323
MDU6SXNzdWU2MTMxMjY2MjU=,FR: Finalize scATAC,CLOSED,2020-05-06T08:02:52Z,2020-05-31T19:18:43Z,2020-05-31T19:18:43Z,"TODO:
* annotation
* incorporate treps",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/326
MDU6SXNzdWU2MTM4MzUwMzE=,FR: Check samples.tsv with PandasSchema,CLOSED,2020-05-07T07:25:15Z,2020-08-26T14:06:15Z,2020-08-26T14:06:15Z,"**Is your feature request related to a problem? Please describe.**
See https://github.com/TMiguelT/PandasSchema. Never used it before, but the example seems really nice! Would be much easier to debug a faulty samples.tsv.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/328
MDU6SXNzdWU2MjA4MjU5NjY=,BUG: blacklist missing when using own genome ,CLOSED,2020-05-19T09:31:14Z,2020-06-09T12:08:12Z,2020-06-09T12:08:12Z,"**Describe the bug**
Reported by @qxuchn:
```
Error in rule setup_blacklist:
    jobid: 0
    output: /scratch/qxu/genomes/hg38/hg38.customblacklist.bed
RuleException:
FileNotFoundError in line 334 of /scratch/qxu/projects/snakemake-workflows/rules/alignment.smk:
[Errno 2] No such file or directory: '/scratch/qxu/genomes/hg38/hg38.blacklist.bed.gz'
  File ""/scratch/qxu/projects/snakemake-workflows/rules/alignment.smk"", line 334, in __rule_setup_blacklist
  File ""/vol/mbconda/qxu/miniconda3/envs/snakemake-workflows/lib/python3.6/gzip.py"", line 163, in __init__
  File ""/vol/mbconda/qxu/miniconda3/envs/snakemake-workflows/lib/python3.6/concurrent/futures/thread.py"", line 56, in run
Exiting because a job execution failed. Look above for error message
```

**To Reproduce**
@qxuchn could you paste your samples.tsv and config.yaml?

",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/332
MDU6SXNzdWU2MjM2MDM1OTg=,FR: support bwa mem2,CLOSED,2020-05-23T07:46:45Z,2020-07-16T09:58:32Z,2020-07-16T09:58:32Z,Quite self-explanatory. Should be much faster -> much cooler.,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/333
MDU6SXNzdWU2MjQxNDcwMjI=,FR: In between workflow caching,CLOSED,2020-05-25T08:48:32Z,2020-08-10T18:28:11Z,2020-08-10T18:28:11Z,"Something to take a look at:
https://snakemake.readthedocs.io/en/stable/executing/caching.html

Would be great for genomes and indices. ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/334
MDU6SXNzdWU2MjU0Nzc3MDA=,FR: samples.tsv and config.yaml in multiqc report,CLOSED,2020-05-27T08:11:35Z,2020-06-09T12:09:36Z,2020-06-09T12:09:23Z,"Now that html is working properly for multiqc this is something to think about again.
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/340
MDU6SXNzdWU2MjU1ODMwNDI=,FR: Dont generate logs on dryrun,CLOSED,2020-05-27T10:41:36Z,2020-06-09T12:08:11Z,2020-06-09T12:08:11Z,"We copy the samples.tsv and config.yaml to the log folder when a workflow starts. However, this also happens in a dryrun, which it should not.",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/341
MDU6SXNzdWU2MjU3MTI5MTI=,FR: Support rerunning,CLOSED,2020-05-27T13:48:57Z,2021-03-03T16:17:16Z,2021-03-03T16:17:16Z,"Maybe this should even be the default behaviour?
https://snakemake.readthedocs.io/en/stable/project_info/faq.html#snakemake-does-not-trigger-re-runs-if-i-add-additional-input-files-what-can-i-do",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/342
MDU6SXNzdWU2MjYzMzQwNDU=,FR: bam stats before and after quality filtering,CLOSED,2020-05-28T08:48:36Z,2020-06-10T15:40:47Z,2020-06-10T15:40:47Z,"Just like we do with fastqc before and after trimming, I am often curious of the effect of the filtering.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/343
MDU6SXNzdWU2MjY0NTAyNDY=,FR: test data for ATAC,CLOSED,2020-05-28T11:56:59Z,2023-05-02T18:17:34Z,2023-05-02T18:17:34Z,"I've been placing this at the bottom of my TODO list for waaaaay too long now. After migration is done this should be a top priority.

@siebrenf you'll be happy with this :)",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/345
MDU6SXNzdWU2MjcxNTYwNTM=,BUG: Edge-case: starting with downstream file,CLOSED,2020-05-29T10:09:52Z,2020-06-02T12:47:04Z,2020-06-02T12:47:04Z,"**Describe the bug**
starting a workflow without fastqs, but with downstream files still causes the `FileLock(layout_cachefile_lock)` to complain.
Adding the fastq files and rerunning shows they are not needed in the DAG.

**To Reproduce**
files can be found in the dag_test branch.
This *should* work:
```
touch Jenkins/dag_fastqs/S1_1_R1.fastq.gz
touch Jenkins/dag_fastqs/S1_1_R2.fastq.gz
touch Jenkins_results/dedup/assembly2-S1_2.samtools-coordinate.bam

# adding these makes it work:
#touch Jenkins/dag_fastqs/S1_2_R1.fastq.gz
#touch Jenkins/dag_fastqs/S1_2_R2.fastq.gz

snakemake -n -j 10 --quiet -s workflows/alignment/Snakefile --directory workflows/alignment --configfile Jenkins/alignment/default_config.yaml --config samples=../../Jenkins/alignment/assemblies.tsv
```

**Expected behavior**
Ignore the samples if the downstream files are present
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/347
MDU6SXNzdWU2MjcxNjA4MjQ=,BUG: Edge-case: messed up samples.tsv ,CLOSED,2020-05-29T10:18:16Z,2020-06-12T14:44:34Z,2020-06-12T14:44:34Z,"**Describe the bug**
A mistake in your input samples.tsv can cause the layout file to remember a file as paired- or single-ended while it should be the other. This can cause errors with debug info like `cant find SE sample...` or `missing input for renamePE`. 

**Solution**
in `genomepy` Simon used a cache that times out after 7 days. If we use a 1 or 2 day cache system, the issue solves itself :)
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/348
MDU6SXNzdWU2MjcyMjI1MjI=,BUG: Descriptive names cannot be in treps,CLOSED,2020-05-29T12:09:02Z,2020-06-09T13:46:53Z,2020-06-09T13:46:53Z,"**Describe the bug**
Treps is the dataframe for technical replicates. An essential step is that the dataframe collapses all replicates to their unique names. Descriptive names are unique per sample, preventing this collapse.
This causes issues when merging replicates and making a trackhub.

**To Reproduce**
```
CORES=12
WF=alignment
snakemake -n -j $CORES --quiet -s workflows/$WF/Snakefile --directory workflows/$WF --configfile Jenkins/$WF/default_config.yaml --config samples=../../Jenkins/alignment/complex_samples.tsv technical_replicates=merge create_trackhub=True
```

**Solution**
remove column descriptive names from treps",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/349
MDU6SXNzdWU2Mjc3MTcyNzc=,FR: sample filters in multiqc report,CLOSED,2020-05-30T12:03:34Z,2020-06-09T12:08:11Z,2020-06-09T12:08:11Z,"My PR to add sample-filters has been released to MultiQC :tada: ! Cool buttons to add:
* only_R1
* only_R2
* only_treps
* only_breps
* only_samples

https://twitter.com/tallphil/status/1266677128445206528",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/350
MDU6SXNzdWU2Mjg0Nzg4MDY=,BUG: scATAC-seq workflow does not create a trackhub,CLOSED,2020-06-01T14:25:01Z,2020-06-09T12:08:11Z,2020-06-09T12:08:11Z,"not even with the config option set to True

```
WF=scATAC_seq
snakemake -n -j 12 -s workflows/$WF/Snakefile --directory workflows/$WF --configfile Jenkins/alignment/default_config.yaml --config create_trackhub=True
```
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/351
MDU6SXNzdWU2MjkxNzI5NzA=,BUG: RNA-seq - quantifies all samples per assembly,CLOSED,2020-06-02T12:44:01Z,2020-06-09T12:08:12Z,2020-06-09T12:08:12Z,,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/354
MDU6SXNzdWU2MjkxNzM0NDM=,BUG: RNA-seq - decoy aware salmon indexing does not work,CLOSED,2020-06-02T12:44:50Z,2020-06-10T13:37:59Z,2020-06-10T13:37:59Z,,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/355
MDU6SXNzdWU2MjkxNzQzMjI=,BUG: RNA-seq - trackhub breaks when using multiple assemblies or replicates,CLOSED,2020-06-02T12:46:10Z,2020-06-09T12:08:12Z,2020-06-09T12:08:12Z,faulty internal s2s logic,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/356
MDU6SXNzdWU2MjkxOTc3MDQ=,FR: combine_peaks -> coverage_table,CLOSED,2020-06-02T13:20:23Z,2020-06-30T16:07:30Z,2020-06-30T16:07:30Z,"More ""structured"" approach for count table.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/357
MDU6SXNzdWU2Mjk5MDE2NjM=,FR: configfiles are always supplemented,CLOSED,2020-06-03T11:02:03Z,2020-06-05T13:26:41Z,2020-06-05T13:26:41Z,"**Describe the bug**
We currently load in `config.yaml` in every Snakefile (line 2). 

This means that a config added over the command line will always be supplemented by the config in the workflow directory. 
- This can cause issues if the latter has flags the former doesn't. 
- ~~Furthermore, I get an error certain vague cases: `AttributeError in [...]Snakefile: 'str' object has no attribute 'get'`~~

In the seq2science setting, the first point is the big issue: if we allow users to specify a config.yaml, it must not be supplemented by whatever is the workflow directory.

**Solution**
For each Snakefile, change

```
# complement the configuration
configfile: ""config.yaml""

```
into
```
# complement the configuration if not provided over command line
if not workflow.overwrite_configfiles:
    configfile: ""config.yaml""
```

this still allows the user to add flags via `--config`.",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/358
MDU6SXNzdWU2MzA3Nzc0NDg=,BUG: only options in the user-supplied config are unpacked by the config.smk,CLOSED,2020-06-04T12:25:55Z,2020-06-05T13:26:23Z,2020-06-05T13:26:23Z,"**Describe the bug**
In the configuration we unpack dict-in-dict structures in the config, but only those from the user config(s)? options supplied over the command line are thereby not unpacked.

see configuration_generic.smk > everything to do with `user_config`
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/362
MDU6SXNzdWU2MzA3NzkxMzY=,BUG: scATAC breaks after seq2science transition: KeyError snaptools_opt,CLOSED,2020-06-04T12:28:39Z,2020-06-09T12:08:11Z,2020-06-09T12:08:11Z,,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/363
MDU6SXNzdWU2MzA3ODAyMTI=,BUG: bwa-mem breaks after seq2science transition: broken pipe,CLOSED,2020-06-04T12:30:23Z,2020-06-04T16:36:50Z,2020-06-04T16:36:50Z,"it was renamed, so I assume receivers use the old name somewhere",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/364
MDU6SXNzdWU2MzA3ODA2NjY=,BUG: macs2callpeaks breaks after seq2science transition,CLOSED,2020-06-04T12:31:09Z,2020-06-09T11:13:23Z,2020-06-09T11:13:23Z,log file was empty. error does not yield any information,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/365
MDU6SXNzdWU2MzA3ODE0NTM=,FR: scATAC test samples,CLOSED,2020-06-04T12:32:24Z,2023-05-02T18:17:37Z,2023-05-02T18:17:37Z,"@JGASmits, could you provide a (set of) minimal sample(s) that can be used for testing?",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/366
MDU6SXNzdWU2MzA5OTY1Mzk=,FR: remove get_annotation,CLOSED,2020-06-04T16:57:37Z,2020-06-09T13:46:25Z,2020-06-09T13:46:25Z,Its no longer needed with genomepy 0.8,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/370
MDU6SXNzdWU2MzE3MTQxMDE=,FR: If statement around more rules / more strict wildcard regex,CLOSED,2020-06-05T16:02:09Z,2020-10-14T07:06:01Z,2020-10-14T07:06:01Z,"**Is your feature request related to a problem? Please describe.**
Creating a DAG for ""many"" samples (200+) takes quite some time. In the case of single-cell stuff this becomes really significant. If in the future checkpoints work properly, this will increase even further. 

I am not sure if we can benchmark which rules make it complicated for snakemake, but encompassing the ones we do not use in if statements should already help. Furthermore having more strict wildcards for some rules / wildcards might help as well. Lastly we could take a look at some rules that are very free in their wildcards (see: fastqc), and see if being more strict there helps.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/377
MDU6SXNzdWU2MzE3MTczMDE=,FR: no more mixing of f-string and shell commands,CLOSED,2020-06-05T16:06:52Z,2020-06-29T11:12:40Z,2020-06-29T11:12:40Z,"**Is your feature request related to a problem? Please describe.**
Apparently this is not necessary, and we can get rid of quite some curly braces!",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/378
MDU6SXNzdWU2MzE3NTgyNTY=,nvm,CLOSED,2020-06-05T17:00:06Z,2020-06-05T17:09:55Z,2020-06-05T17:08:23Z,"**Describe the bug**
~~the [snakemake api](https://snakemake.readthedocs.io/en/latest/api_reference/snakemake.html) also requires lists and dicts to be accepted.~~

~~For testing purposes, I need `config={until:[""get_genome""]}` to work (I assume its a list of strings).~~",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/379
MDU6SXNzdWU2MzcxMzMzMzI=,FR: refactor bam_stranded_bigwig for a single output,CLOSED,2020-06-11T15:49:38Z,2020-08-04T08:40:07Z,2020-08-04T08:40:07Z,"Extremely minor(!!!), but slighly cleaner.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/390
MDU6SXNzdWU2MzcyMTQxMzc=,BUG: I don't have 12 cores :-(,CLOSED,2020-06-11T17:51:59Z,2020-06-17T07:40:24Z,2020-06-17T07:40:24Z,"**Describe the bug**

```
 seq2science run atac_seq --cores 4
Traceback (most recent call last):
  File ""/home/simon/anaconda3/envs/seq2science/bin/seq2science"", line 283, in <module>
    main()
  File ""/home/simon/anaconda3/envs/seq2science/bin/seq2science"", line 47, in main
    _run(args, base_dir, workflows_dir, config_path)
  File ""/home/simon/anaconda3/envs/seq2science/bin/seq2science"", line 213, in _run
    raise ValueError(""Please specify at least 12 cores."")
ValueError: Please specify at least 12 cores.
```


**To Reproduce**

```
seq2science run atac_seq --cores 4
```
**Expected behavior**

Run with less cores, but slower.",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/391
MDU6SXNzdWU2MzcyMTYwMjg=,BUG: creation of samtools environment fails,CLOSED,2020-06-11T17:55:33Z,2020-06-17T07:52:00Z,2020-06-17T07:52:00Z,"**Describe the bug**

```
Creating conda environment /home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/../envs/samtools.yaml...
Downloading and installing remote packages.
CreateCondaEnvironmentException:
Could not create conda environment from /home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/../envs/samtools.yaml:
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... failed

UnsatisfiableError: The following specifications were found to be incompatible with each other:

  - bioconda::samtools=1.10


Note that strict channel priority may have removed packages required for satisfiability.


  File ""/home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/snakemake/deployment/conda.py"", line 342, in create
```

I have no clue why? I do have `channel_priority: strict` enabled in the conda config though.",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/392
MDU6SXNzdWU2MzcyMzUwOTQ=,BUG: [put title here] FileNotFoundError in seq2science/rules/configuration_generic.smk,CLOSED,2020-06-11T18:31:35Z,2020-06-17T07:40:23Z,2020-06-17T07:40:23Z,"**Describe the bug**

```
FileNotFoundError in line 254 of /home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/configuration_generic.smk:
[Errno 2] No such file or directory: '/home/simon/.config/snakemake/layouts.p.lock'
  File ""/home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/workflows/atac_seq/Snakefile"", line 4, in <module>
  File ""/home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/configuration_generic.smk"", line 254, in <module>FileNotFoundError in line 254 of /home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/configuration_generic.smk:
[Errno 2] No such file or directory: '/home/simon/.config/snakemake/layouts.p.lock'
  File ""/home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/workflows/atac_seq/Snakefile"", line 4, in <module>
  File ""/home/simon/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/configuration_generic.smk"", line 254, in <module>
```

Not sure if this is really serious.",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/393
MDU6SXNzdWU2Mzc0ODM0MTI=,BUG: annotation file,CLOSED,2020-06-12T04:55:55Z,2020-06-12T16:46:15Z,2020-06-12T16:46:15Z,"**Describe the bug**

```
        # unzip annotation if downloaded, warn if required but empty
        if [ -f /mnt/c/Users/simon/Documents/prj/test_seq2science/genomes/bosTau9/bosTau9.annotation.gtf.gz ]; then
            gunzip /mnt/c/Users/simon/Documents/prj/test_seq2science/genomes/bosTau9/bosTau9.annotation.gtf.gz >> /mnt/c/Users/simon/Documents/prj/test_seq2science/results/log/get_genome/bosTau9.genome.log 2>&1
        elif echo /mnt/c/Users/simon/Documents/prj/test_seq2science/genomes/bosTau9/bosTau9.fa /mnt/c/Users/simon/Documents/prj/test_seq2science/genomes/bosTau9/bosTau9.fa.fai /mnt/c/Users/simon/Documents/prj/test_seq2science/genomes/bosTau9/bosTau9.fa.sizes /mnt/c/Users/simon/Documents/prj/test_seq2science/genomes/bosTau9/bosTau9.gaps.bed | grep -q annotation.gtf; then
            echo '
Annotation for bosTau9 contains no genes. Select a different assembly or provide an annotation file manually.

' > /mnt/c/Users/simon/Documents/prj/test_seq2science/results/log/get_genome/bosTau9.genome.log
            exit 1
        fi

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
```

The pipeline fails as there is no annotation file. However, there is:

```
 $ ls  /mnt/c/Users/simon/Documents/prj/test_seq2science/genomes/bosTau9/
README.txt  bosTau9.annotation.bed.gz  bosTau9.annotation.gtf
```

And the `atac_seq` pipeline should be able to run without gene annotation?",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/394
MDU6SXNzdWU2Mzc0OTkzOTI=,BUG: --unlock doesn't work,CLOSED,2020-06-12T05:41:30Z,2020-06-12T16:55:22Z,2020-06-12T16:55:22Z,"**Describe the bug**

```
$ seq2science run atac_seq --cores 12 --unlock
```

```
Building DAG of jobs...
Error: Directory cannot be locked. Please make sure that no other Snakemake process is trying to create the same files in the following directory:
/mnt/c/Users/simon/Documents/prj/test_seq2science
If you are sure that no other instances of snakemake are running on this directory, the remaining lock was likely caused by a kill signal or a power loss. It can be removed with the --unlock argument.
```

Maybe I use the  `--unlock` argument in the wrong way?",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/395
MDU6SXNzdWU2Mzc1MDAxMzM=,FR: option for --keep-going,CLOSED,2020-06-12T05:43:16Z,2020-06-12T16:54:36Z,2020-06-12T16:54:36Z,"**Is your feature request related to a problem? Please describe.**

When a single task fails, the pipeline will stop. Normally with snakemake you can provide a `--keep-going` argument. There is the option to supply additional snakemake argument, but only in the `KEY=VAL` format.

**Describe the solution you'd like**

A way to specify `--keep-going`.",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/396
MDU6SXNzdWU2Mzc1NTc5NzY=,Q: track hubs and UCSC genomes,CLOSED,2020-06-12T07:48:42Z,2020-06-17T07:51:37Z,2020-06-17T07:51:37Z,"If I'm correct, `seq2science` generates files for a track hub, even if the genome comes from UCSC. However, if a genome is on UCSC, all the files will already be there. In that case you can just use the UCSC browser right? This would even be preferred as UCSC will contain loads of additional tracks and information.",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/398
MDU6SXNzdWU2Mzg2MDU2Nzg=,samtools sort,CLOSED,2020-06-15T07:15:15Z,2020-06-17T07:40:24Z,2020-06-17T07:40:24Z,"https://github.com/vanheeringen-lab/seq2science/blob/cf045b357f8d41b40d1579603bebffd51fba3152/seq2science/rules/alignment.smk#L302

Have you tried / benchmarked setting larger memory for `samtools sort` (`-m 4G`)? With the defautl settings `samtools sort` generates *many* small files for sorting. I think this can slow down the process. An alternative is also `sambamba` which seems to sort faster (at least, the last time I looked at it).",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/404
MDU6SXNzdWU2Mzg4NTI3NzI=,BUG: Pipeline failed due to temporary files still being present.,CLOSED,2020-06-15T13:26:17Z,2020-06-17T07:40:24Z,2020-06-17T07:40:24Z,"**Describe the bug**

Pipeline failed due to temporary files still being present.

```
$ cat results/log/samtools_presort/bosTau9-8-cell_rep1.log
[E::hts_open_format] Failed to open file ""/data/test_seq2science/results/bwa-mem/bosTau9-8-cell_rep1.tmp.0000.bam"" : File exists
samtools sort: failed to create temporary file ""/data/test_seq2science/results/bwa-mem/bosTau9-8-cell_rep1.tmp.0000.bam"": File exists
```

",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/405
MDU6SXNzdWU2NDkwNDE5NjI=,BUG: Crash while installing packages,CLOSED,2020-07-01T14:46:14Z,2020-07-01T15:57:48Z,2020-07-01T15:36:05Z,"**Describe the bug**
The pipeline crashes while downloading and installing packages:

Could not create conda environment from /home/hneikes/anaconda3/envs/seq2science/lib/python3.6/site-packages/seq2science/rules/../envs/edger.yaml:
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... failed

ResolvePackageNotFound:
  - r::r-base=4.0.1
",HNeikes,https://github.com/vanheeringen-lab/seq2science/issues/420
MDU6SXNzdWU2NTQ3Nzg1OTg=,run alignment before download samples in chip-seq workflow with control,CLOSED,2020-07-10T13:21:32Z,2020-07-15T11:40:56Z,2020-07-15T11:40:56Z,"**Describe the bug**
It do alignment before download sample, and got 'missing input file error'.
```
Building DAG of jobs...
MissingInputException in line 93 of /vol/mbconda/qxu/miniconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/alignment.smk:
Missing input files for rule bwa_mem:
/scratch/qxu/projects/xnetwork/chipseq/foxh1/results/fastq_trimmed/merged/GSM2263598_trimmed.fastq.gz
```
**To Reproduce**
The **samples.tsv** file:
```
sample	assembly	replicate	descriptive_name	control
SRR4011697	xt10.0	st8_Foxh1	st8_Foxh1_rep1	GSM2263598
SRR4011696	xt10.0	st8_Foxh1	st8_Foxh1_rep2	GSM2263598
SRR4011699	xt10.0	st9_Foxh1	st9_Foxh1_rep1	GSM2263600
SRR4011698	xt10.0	st9_Foxh1	st9_Foxh1_rep2	GSM2263600
SRR4011709	xt10.0	st10.25_Foxh1	st10.25_Foxh1_rep1	GSM1298094
GSM1298090	xt10.0	st10.5_Foxh1	st10.5_Foxh1_rep1	GSM1298094
GSM1298091	xt10.0	st10.5_Foxh1	st10.5_Foxh1_rep2	GSM1298094
```
The **config** file:
```
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
genome_dir: /scratch/qxu/genomes/  # where to look for or download the genomes
# fastq_dir: (default is inside result_dir) # where to look for or download the fastqs


# contact info for multiqc report and trackhub
email: qxuchn@gmail.com

# peak caller
peak_caller:
  macs2:
      --keep-dup 1 --buffer-size 10000 --broad

# how to handle replicates
biological_replicates: fisher  # change to ""keep"" to not combine them
technical_replicates: keep    # change to ""keep"" to not combine them

# filtering after alignment
remove_blacklist: True
min_mapping_quality: 30
only_primary_align: True

# use 'our' default parameters
aligner: bwa-mem

# or specify which aligner to use with the option to specify own parameters
# aligner:
#   bwa-mem:
#     index:  # parameters for indexing
#       '-a bwtsw'
#     align:  # parameters for alignment
#       ''
```",bioqxu,https://github.com/vanheeringen-lab/seq2science/issues/425
MDU6SXNzdWU2NjQzNDU2Mzk=,BUG: Indexing of Spur_5.0 assembly fails ,OPEN,2020-07-23T09:59:44Z,2020-08-03T13:48:39Z,,"**Describe the bug**
When making an index for assembly Spur_5.0 rule [trackhub_index](https://github.com/vanheeringen-lab/seq2science/blob/5c2f117f600ae6e335b36dd3523822fcd46423ac/seq2science/rules/trackhub.smk#L163) fails:
`NC_001453.1 is not found in chromosome sizes file`

**To Reproduce**
I ran the atac-seq pipeline with many samples, but I guess this should be enough to reproduce:

```
sample              assembly
GSM2546188   Spur_5.0
``` 

**Expected behavior**
No failure! Is this a genomepy+annotation thingy? Or is it on our side?
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/436
MDU6SXNzdWU2NjQzNDgxMTA=,BUG: combine peaks not working with numeric chromosome names,CLOSED,2020-07-23T10:03:59Z,2020-11-04T07:42:21Z,2020-11-04T07:42:21Z,"**Describe the bug**
Combine peaks not working with numeric chromosome names. I already fixed it on the gimmemotifs side, but until a new release, this is a reminder to change the version of gimmemotifs.

Also the log of combine peaks goes to a file called bedtools_slop. Should be changed :)",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/437
MDU6SXNzdWU2NjQ0NjE3NDk=,BUG: chip_seq multiqc failed job,CLOSED,2020-07-23T13:11:46Z,2020-08-06T08:15:09Z,2020-08-06T08:15:09Z,"**Describe the bug**
Ran the seq2science chip_seq workflow. Workflow ran perfectly until it reached 106 out of 108 steps (98%), after which it threw an error while generating the multiqc report. The pipeline then terminated. Results folder contains all output files except multiqc report [so only minor inconvenience]. Enclosed please find multiqc log file. 

[multiqc_GRCm38.p6.log](https://github.com/vanheeringen-lab/seq2science/files/4966043/multiqc_GRCm38.p6.log)

Error message:
[Thu Jul 23 03:59:53 2020]
Error in rule multiqc:
    jobid: 2
    output: /home/dzijlmans/ChIP-seq/Kundu/results/qc/multiqc_GRCm38.p6.html, /home/dzijlmans/ChIP-seq/Kundu/results/qc/multiqc_GRCm38.p6_data
    log: /home/dzijlmans/ChIP-seq/Kundu/results/log/multiqc_GRCm38.p6.log (check log file(s) for error message)
    conda-env: /home/dzijlmans/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/.snakemake/e9b3e820
    shell:

        multiqc /home/dzijlmans/ChIP-seq/Kundu/results/bwa-mem/GRCm38.p6-GSM2393580.samtools-coordinate-unsieved.bam.mtnucratiomtnuc.json /home/dzijlmans/ChIP-seq/Kund38.p6-GSM2393580.samtools-coordinate.samtools_stats.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/samtools_stats/bwa-mem/GRCm38.p6-GSM2393592.samtools-coordinate.samtoundu/results/qc/macs2/GRCm38.p6-GSM2393592_featureCounts.txt.summary /home/dzijlmans/ChIP-seq/Kundu/results/bwa-mem/GRCm38.p6-GSM2393592.samtools-coordinate-unsieved.bChIP-seq/Kundu/results/qc/fastqc/GSM2393592_fastqc.zip /home/dzijlmans/ChIP-seq/Kundu/results/bwa-mem/GRCm38.p6-GSM2393579.samtools-coordinate-unsieved.bam.mtnucratiom/results/qc/markdup/GRCm38.p6-GSM2393580.samtools-coordinate.metrics.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/samtools_stats/final_bam/GRCm38.p6-GSM2393592.samtoozijlmans/ChIP-seq/Kundu/results/qc/macs2/GRCm38.p6-GSM2393584_featureCounts.txt.summary /home/dzijlmans/ChIP-seq/Kundu/results/qc/samtools_stats/final_bam/GRCm38.p6-GSats.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/samplesconfig_mqc.html /home/dzijlmans/ChIP-seq/Kundu/results/qc/trimming/GSM2393579.fastq.gz_trimming_report.txt /horimming/GSM2393580.fastq.gz_trimming_report.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/plotCorrelation/GRCm38.p6.tsv /home/dzijlmans/ChIP-seq/Kundu/results/qc/trimmtxt /home/dzijlmans/ChIP-seq/Kundu/results/qc/samtools_stats/final_bam/GRCm38.p6-GSM2393593.samtools-coordinate.samtools_stats.txt /home/dzijlmans/ChIP-seq/Kundu/resule/dzijlmans/ChIP-seq/Kundu/results/qc/fastqc/GSM2393584_fastqc.zip /home/dzijlmans/ChIP-seq/Kundu/results/qc/plotPCA/GRCm38.p6.tsv /home/dzijlmans/ChIP-seq/Kundu/resulip /home/dzijlmans/ChIP-seq/Kundu/results/qc/plotProfile/GRCm38.p6-macs2.tsv /home/dzijlmans/ChIP-seq/Kundu/results/macs2/GRCm38.p6-GSM2393592_peaks.xls /home/dzijlman-GSM2393593_peaks.xls /home/dzijlmans/ChIP-seq/Kundu/results/qc/markdup/GRCm38.p6-GSM2393584.samtools-coordinate.metrics.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/me/dzijlmans/ChIP-seq/Kundu/results/qc/macs2/GRCm38.p6-GSM2393593_featureCounts.txt.summary /home/dzijlmans/ChIP-seq/Kundu/results/qc/fastqc/GSM2393593_trimmed_fastqc.ts/qc/markdup/GRCm38.p6-GSM2393579.samtools-coordinate.metrics.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/trimming/GSM2393593.fastq.gz_trimming_report.txt /home/dziGSM2393593_fastqc.zip /home/dzijlmans/ChIP-seq/Kundu/results/qc/samtools_stats/bwa-mem/GRCm38.p6-GSM2393584.samtools-coordinate.samtools_stats.txt /home/dzijlmans/ChIP2393584.samtools-coordinate-unsieved.bam.mtnucratiomtnuc.json /home/dzijlmans/ChIP-seq/Kundu/results/qc/markdup/GRCm38.p6-GSM2393593.samtools-coordinate.metrics.txt /hsamtools_stats/final_bam/GRCm38.p6-GSM2393579.samtools-coordinate.samtools_stats.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/fastqc/GSM2393580_fastqc.zip /home/dzijlstats/final_bam/GRCm38.p6-GSM2393580.samtools-coordinate.samtools_stats.txt /home/dzijlmans/ChIP-seq/Kundu/results/macs2/GRCm38.p6-GSM2393579_peaks.xls /home/dzijlmans3579_fastqc.zip /home/dzijlmans/ChIP-seq/Kundu/results/qc/macs2/GRCm38.p6-GSM2393580_featureCounts.txt.summary /home/dzijlmans/ChIP-seq/Kundu/results/qc/markdup/GRCm38cs.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/fastqc/GSM2393579_trimmed_fastqc.zip /home/dzijlmans/ChIP-seq/Kundu/results/bwa-mem/GRCm38.p6-GSM2393593.samtools-coor /home/dzijlmans/ChIP-seq/Kundu/results/qc/trimming/GSM2393592.fastq.gz_trimming_report.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/samtools_stats/bwa-mem/GRCm38.p6-stats.txt /home/dzijlmans/ChIP-seq/Kundu/results/qc/samtools_stats/bwa-mem/GRCm38.p6-GSM2393593.samtools-coordinate.samtools_stats.txt /home/dzijlmans/ChIP-seq/Kundu/rxls /home/dzijlmans/ChIP-seq/Kundu/results/macs2/GRCm38.p6-GSM2393584_peaks.xls /home/dzijlmans/ChIP-seq/Kundu/results/qc/macs2/GRCm38.p6-GSM2393579_featureCounts.txt.esults/qc/fastqc/GSM2393584_trimmed_fastqc.zip -o /home/dzijlmans/ChIP-seq/Kundu/results/qc/ -n multiqc_GRCm38.p6.html         --config /home/dzijlmans/ChIP-seq/Kundu/                                          --config /home/dzijlmans/ChIP-seq/Kundu/results/qc/header_info.yaml                                                          q/Kundu/results/qc/sample_names_GRCm38.p6.tsv                                                --sample-filters /home/dzijlmans/ChIP-seq/Kundu/results/qc/sample_filters_                 --cl_config ""extra_fn_clean_exts: [                                                    {'pattern': ^.*GRCm38.p6-, 'type': 'regex'},                    'regex'},                          ]"" > /home/dzijlmans/ChIP-seq/Kundu/results/log/multiqc_GRCm38.p6.log 2>&1

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job multiqc since they might be corrupted:
/home/dzijlmans/ChIP-seq/Kundu/results/qc/multiqc_GRCm38.p6.html, /home/dzijlmans/ChIP-seq/Kundu/results/qc/multiqc_GRCm38.p6_data
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/dzijlmans/ChIP-seq/Kundu/.snakemake/log/2020-07-23T002330.613210.snakemake.log




**To Reproduce**

**config.yaml**
samples: samples.tsv

result_dir: ./results  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes


email: d.zijlmans@science.ru.nl

create_trackhub: True

peak_caller:
  macs2:
      --keep-dup 1 --buffer-size 10000

biological_replicates: fisher  # change to ""keep"" to not combine them
technical_replicates: merge    # change to ""keep"" to not combine them

remove_blacklist: True
min_mapping_quality: 30
only_primary_align: True

**samples.tsv**

sample	assembly	descriptive_name
GSM2393579	GRCm38.p6	ring1b
GSM2393580	GRCm38.p6	phc1
GSM2393584	GRCm38.p6	ezh2
GSM2393592	GRCm38.p6	input1
GSM2393593	GRCm38.p6	input2


**Expected behavior**

**Screenshots**
",dzijlmans,https://github.com/vanheeringen-lab/seq2science/issues/439
MDU6SXNzdWU2NzE4MzQ0NzY=,FR: switch to pysradb (investigate feasibility) for checking layout,CLOSED,2020-08-03T06:39:04Z,2020-09-23T06:45:39Z,2020-09-23T06:45:39Z,"**Is your feature request related to a problem? Please describe.**
I dont want to wait for the lookup of sample layouts anymore!

**Describe the solution you'd like**
Seems like pysradb has the option to check for sample layout. Might be nice to switch :)
https://github.com/saketkc/pysradb
https://saket-choudhary.me/pysradb/python-api-usage.html#use-case-1-fetch-the-metadata-table-sra-runtable

No clue how well this works though.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/445
MDU6SXNzdWU2NzI4NjAzNjY=,BUG: download-fastq - Look-up SRA fails for certain GSM accessions,CLOSED,2020-08-04T14:59:38Z,2020-08-10T12:59:23Z,2020-08-10T12:59:23Z,"**Describe the bug**

Example sample GSM3832542 does contain a SRA file, which can be found with a SRX-accession. Download-fastq workflow somehow fails to find this SRA file. 

**Screenshots**

```
ValueError in line 324 of /vol/mbconda/snabel/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/configuration_generic.smk:
The command to lookup sample GSM3832542 online failed!
Are you sure this sample exists..? Downloading samples with restricted access is currently not supported. We advise you to download the sample manually, and continue the pipeline from there on.

```",Rebecza,https://github.com/vanheeringen-lab/seq2science/issues/448
MDU6SXNzdWU2NzMzNTc4Mjk=,FR: Include ERCC spike-ins in scRNA-seq index build,CLOSED,2020-08-05T08:29:51Z,2020-08-26T14:06:00Z,2020-08-26T14:06:00Z,"**Missing feature**
Our samples are mostly processed with the use of ERCC spike-in RNA mix (https://www.thermofisher.com/order/catalog/product/4456740#/4456740), if mapped, these can be used downstream for QC and normalization purposes.  

**Solution**
Consider adding the ERCC to the genome and annotation file before building the reference within the workflow, since this mix is generally used in our lab. ",Rebecza,https://github.com/vanheeringen-lab/seq2science/issues/450
MDU6SXNzdWU2NzQ4MzMzMDQ=,BUG: Error in rule trim_galore_PE rna-seq pipeline,CLOSED,2020-08-07T07:50:57Z,2020-09-11T12:27:16Z,2020-09-11T12:27:16Z,"**Describe the bug**
Running the rna-seq pipeline throws an error. 

[2020-08-07T093329.002444.snakemake.log](https://github.com/vanheeringen-lab/seq2science/files/5039975/2020-08-07T093329.002444.snakemake.log)



**To Reproduce**
***config.yaml***
```
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results_full  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes
fastq_dir: ./fastq_raw  # where to look for or download the fastqs


# contact info for multiqc report and trackhub
email: d.zijlmans@science.ru.nl

# produce a UCSC trackhub?
create_trackhub: True

# how to handle replicates
technical_replicates: merge    # change to ""keep"" to not combine them

# which quantifier to use
quantifier: htseq

# or specify which quantifier to use with the option to specify own parameters
#quantifier:
#  salmon:
#    quantifier_index: '-k 31'
#    quantify: '--seqBias --gcBias --validateMappings --recoverOrphans'
#    decoy_aware_index: False  # salmon only. Requires ~65 GB RAM for GRCh38


##### aligner and filter options are not used for the gene counts matrix if the quantifier is Salmon

# which aligner to use
aligner: star

# filtering after alignment
remove_blacklist: True
min_mapping_quality: 255  # (only keep uniquely mapped reads from STAR alignments)
only_primary_align: True


##### differential gene expression analysis (optional) #####

# specify contrasts to perform analysis
diffexp:
  deseq2:
    DE_params:
      multiple_testing_procedure: BH  # options: BH/IHW
      alpha_value: 0.05
      shrinkage_estimator: apeglm
    contrasts:
      - 'conditions_all_control'

#differential exon usage
dexseq: True
```
***samples.tsv***
```
# for help with filling out the samples.tsv:
# https://vanheeringen-lab.github.io/seq2science/content/workflows/rna_seq.html#filling-out-the-samples-tsv
# also make sure that you use tab as a delimiter
sample	assembly	descriptive_name	conditions
external-DZ-RNA1-R1WT-1-18363	GRCm38.p6	WT_1	control
external-DZ-RNA2-R1WT-2-18362	GRCm38.p6	WT_2	control
external-DZ-RNA3-R1WT-3-18361	GRCm38.p6	WT_3	control
external-DZ-RNA4-R1WT-4-18360	GRCm38.p6	WT_4	control
external-DZ-RNA5-EED226-1-18359	GRCm38.p6	EED226_1	treatmentA
external-DZ-RNA6-EED226-2-18358	GRCm38.p6	EED226_2	treatmentA
external-DZ-RNA7-EED226-3-18357	GRCm38.p6	EED226_3	treatmentA
external-DZ-RNA8-EED226-4-18356	GRCm38.p6	EED226_4	treatmentA
external-DZ-RNA9-siEZH2-1-18355	GRCm38.p6	siEZH2_1	treatmentB
external-DZ-RNA10-siEZH2-2-18354	GRCm38.p6	siEZH2_2	treatmentB
external-DZ-RNA11-siEZH2-3-18353	GRCm38.p6	siEZH2_3	treatmentB
external-DZ-RNA12-siEZH2-4-18352	GRCm38.p6	siEZH2_4	treatmentB
external-DZ-RNA13-siSFRS2-1-18351	GRCm38.p6	siSFRS2_1	treatmentC
external-DZ-RNA14-siSFRS2-2-18350	GRCm38.p6	siSFRS2_2	treatmentC
external-DZ-RNA15-siSFRS2-3-18349	GRCm38.p6	siSFRS2_3	treatmentC
external-DZ-RNA16-siSFRS2-4-18348	GRCm38.p6	siSFRS2_4	treatmentC
```


**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

",dzijlmans,https://github.com/vanheeringen-lab/seq2science/issues/456
MDU6SXNzdWU2NzQ4MzUzNTg=,BUG: star_align error rna-seq pipeline,CLOSED,2020-08-07T07:54:51Z,2020-09-11T12:27:17Z,2020-09-11T12:27:17Z,"**Describe the bug**
When I ran the pipeline yesterday, the analysis was at 156 of 203 steps (77% done), then it ran checkpoint strandedness_report and updated the htseq_count an ddexseq_count jobs, after which it went back to step 157 of 287 (55% done). It then threw an error (""KeyError: star_align) and finished prematurely (though it does not send this email and it apears the pipeline finished normally.

```
Activating conda environment: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/00ae4980
Activating conda environment: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/2f020311
[Thu Aug  6 18:46:16 2020]
Finished job 178.
156 of 203 steps (77%) done

[Thu Aug  6 18:46:16 2020]
checkpoint strandedness_report:
    input: /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA14-siSFRS2-2-18350.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA12-siEZH2-4-18352.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA7-EED226-3-18357.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA3-R1WT-3-18361.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA1-R1WT-1-18363.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA6-EED226-2-18358.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA15-siSFRS2-3-18349.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA10-siEZH2-2-18354.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA4-R1WT-4-18360.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA9-siEZH2-1-18355.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA16-siSFRS2-4-18348.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA13-siSFRS2-1-18351.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA5-EED226-1-18359.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA2-R1WT-2-18362.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA8-EED226-4-18356.strandedness.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/GRCm38.p6-external-DZ-RNA11-siEZH2-3-18353.strandedness.txt
    output: /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/inferred_strandedness.tsv
    jobid: 224
Downstream jobs will be updated after completion.

Job counts:
        count   jobs
        1       strandedness_report
        1
Updating job 9 (htseq_count).
Updating job 10 (htseq_count).
Updating job 11 (htseq_count).
Updating job 12 (htseq_count).
Updating job 13 (htseq_count).
Updating job 14 (htseq_count).
Updating job 15 (htseq_count).
Updating job 16 (htseq_count).
Updating job 17 (htseq_count).
Updating job 18 (htseq_count).
Updating job 19 (htseq_count).
Updating job 20 (htseq_count).
Updating job 21 (htseq_count).
Updating job 22 (htseq_count).
Updating job 23 (htseq_count).
Updating job 24 (htseq_count).
Updating job 208 (dexseq_count).
Updating job 209 (dexseq_count).
Updating job 210 (dexseq_count).
Updating job 211 (dexseq_count).
Updating job 212 (dexseq_count).
Updating job 213 (dexseq_count).
Updating job 214 (dexseq_count).
Updating job 215 (dexseq_count).
Updating job 216 (dexseq_count).
Updating job 217 (dexseq_count).
Updating job 218 (dexseq_count).
Updating job 219 (dexseq_count).
Updating job 220 (dexseq_count).
Updating job 221 (dexseq_count).
Updating job 222 (dexseq_count).
Updating job 223 (dexseq_count).
Updating job 8 (trackhub).
[Thu Aug  6 18:46:58 2020]
Finished job 224.
157 of 287 steps (55%) done

[Thu Aug  6 18:46:59 2020]
rule htseq_count:
    input: /home/dzijlmans/RNA-seq/DZ024/results/final_bam/GRCm38.p6-external-DZ-RNA12-siEZH2-4-18352.samtools-coordinate.bam, /home/dzijlmans/RNA-seq/DZ024/genomes/GRCm38.p6/GRCm38.p6.annotation.gtf, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/inferred_strandedness.tsv
    output: /home/dzijlmans/RNA-seq/DZ024/results/gene_counts/GRCm38.p6-external-DZ-RNA12-siEZH2-4-18352.counts.tsv
    log: /home/dzijlmans/RNA-seq/DZ024/results/log/counts_matrix/GRCm38.p6-external-DZ-RNA12-siEZH2-4-18352.counts.log
    jobid: 307
    wildcards: assembly=GRCm38.p6, sample=external-DZ-RNA12-siEZH2-4-18352


[Thu Aug  6 18:46:59 2020]
rule trim_galore_PE:
    input: /home/dzijlmans/RNA-seq/DZ024/fastq_raw/external-DZ-RNA12-siEZH2-4-18352_R1.fastq.gz, /home/dzijlmans/RNA-seq/DZ024/fastq_raw/external-DZ-RNA12-siEZH2-4-18352_R2.fastq.gz
    output: /home/dzijlmans/RNA-seq/DZ024/results/fastq_trimmed/external-DZ-RNA12-siEZH2-4-18352_R1_trimmed.fastq.gz, /home/dzijlmans/RNA-seq/DZ024/results/fastq_trimmed/external-DZ-RNA12-siEZH2-4-18352_R2_trimmed.fastq.gz, /home/dzijlmans/RNA-seq/DZ024/results/qc/trimming/external-DZ-RNA12-siEZH2-4-18352_R1.fastq.gz_trimming_report.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/trimming/external-DZ-RNA12-siEZH2-4-18352_R2.fastq.gz_trimming_report.txt
    log: /home/dzijlmans/RNA-seq/DZ024/results/log/trim_galore_PE/external-DZ-RNA12-siEZH2-4-18352.log
    jobid: 146
    benchmark: /home/dzijlmans/RNA-seq/DZ024/results/benchmark/trim_galore_PE/external-DZ-RNA12-siEZH2-4-18352.benchmark.txt
    wildcards: sample=external-DZ-RNA12-siEZH2-4-18352
    threads: 6


[Thu Aug  6 18:46:59 2020]
rule htseq_count:
    input: /home/dzijlmans/RNA-seq/DZ024/results/final_bam/GRCm38.p6-external-DZ-RNA9-siEZH2-1-18355.samtools-coordinate.bam, /home/dzijlmans/RNA-seq/DZ024/genomes/GRCm38.p6/GRCm38.p6.annotation.gtf, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/inferred_strandedness.tsv
    output: /home/dzijlmans/RNA-seq/DZ024/results/gene_counts/GRCm38.p6-external-DZ-RNA9-siEZH2-1-18355.counts.tsv
    log: /home/dzijlmans/RNA-seq/DZ024/results/log/counts_matrix/GRCm38.p6-external-DZ-RNA9-siEZH2-1-18355.counts.log
    jobid: 304
    wildcards: assembly=GRCm38.p6, sample=external-DZ-RNA9-siEZH2-1-18355


[Thu Aug  6 18:46:59 2020]
rule trim_galore_PE:
    input: /home/dzijlmans/RNA-seq/DZ024/fastq_raw/external-DZ-RNA10-siEZH2-2-18354_R1.fastq.gz, /home/dzijlmans/RNA-seq/DZ024/fastq_raw/external-DZ-RNA10-siEZH2-2-18354_R2.fastq.gz
    output: /home/dzijlmans/RNA-seq/DZ024/results/fastq_trimmed/external-DZ-RNA10-siEZH2-2-18354_R1_trimmed.fastq.gz, /home/dzijlmans/RNA-seq/DZ024/results/fastq_trimmed/external-DZ-RNA10-siEZH2-2-18354_R2_trimmed.fastq.gz, /home/dzijlmans/RNA-seq/DZ024/results/qc/trimming/external-DZ-RNA10-siEZH2-2-18354_R1.fastq.gz_trimming_report.txt, /home/dzijlmans/RNA-seq/DZ024/results/qc/trimming/external-DZ-RNA10-siEZH2-2-18354_R2.fastq.gz_trimming_report.txt
    log: /home/dzijlmans/RNA-seq/DZ024/results/log/trim_galore_PE/external-DZ-RNA10-siEZH2-2-18354.log
    jobid: 88
    benchmark: /home/dzijlmans/RNA-seq/DZ024/results/benchmark/trim_galore_PE/external-DZ-RNA10-siEZH2-2-18354.benchmark.txt
    wildcards: sample=external-DZ-RNA10-siEZH2-2-18354
    threads: 6

Activating conda environment: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/2f020311
Activating conda environment: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/a1e5d68e
Activating conda environment: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/a1e5d68e
Activating conda environment: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/2f020311
[Thu Aug  6 18:48:55 2020]
Finished job 109.
158 of 287 steps (55%) done

[Thu Aug  6 18:48:55 2020]
rule htseq_count:
    input: /home/dzijlmans/RNA-seq/DZ024/results/final_bam/GRCm38.p6-external-DZ-RNA10-siEZH2-2-18354.samtools-coordinate.bam, /home/dzijlmans/RNA-seq/DZ024/genomes/GRCm38.p6/GRCm38.p6.annotation.gtf, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/inferred_strandedness.tsv
    output: /home/dzijlmans/RNA-seq/DZ024/results/gene_counts/GRCm38.p6-external-DZ-RNA10-siEZH2-2-18354.counts.tsv
    log: /home/dzijlmans/RNA-seq/DZ024/results/log/counts_matrix/GRCm38.p6-external-DZ-RNA10-siEZH2-2-18354.counts.log
    jobid: 305
    wildcards: assembly=GRCm38.p6, sample=external-DZ-RNA10-siEZH2-2-18354

Activating conda environment: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/2f020311
[Thu Aug  6 18:49:57 2020]
Finished job 180.
159 of 287 steps (55%) done

[Thu Aug  6 18:49:57 2020]
rule htseq_count:
    input: /home/dzijlmans/RNA-seq/DZ024/results/final_bam/GRCm38.p6-external-DZ-RNA11-siEZH2-3-18353.samtools-coordinate.bam, /home/dzijlmans/RNA-seq/DZ024/genomes/GRCm38.p6/GRCm38.p6.annotation.gtf, /home/dzijlmans/RNA-seq/DZ024/results/qc/strandedness/inferred_strandedness.tsv
    output: /home/dzijlmans/RNA-seq/DZ024/results/gene_counts/GRCm38.p6-external-DZ-RNA11-siEZH2-3-18353.counts.tsv
    log: /home/dzijlmans/RNA-seq/DZ024/results/log/counts_matrix/GRCm38.p6-external-DZ-RNA11-siEZH2-3-18353.counts.log
    jobid: 306
    wildcards: assembly=GRCm38.p6, sample=external-DZ-RNA11-siEZH2-3-18353

Activating conda environment: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/2f020311
[Thu Aug  6 20:40:53 2020]
Finished job 88.
160 of 287 steps (56%) done
Traceback (most recent call last):
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/__init__.py"", line 703, in snakemake
    keepincomplete=keep_incomplete,
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/workflow.py"", line 953, in execute
    success = scheduler.schedule()
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/scheduler.py"", line 394, in schedule
    run = self.job_selector(needrun)
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/scheduler.py"", line 541, in job_selector
    c = list(map(self.job_reward, jobs))  # job rewards
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/scheduler.py"", line 634, in job_reward
    return (job.priority, temp_size, input_size)
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/jobs.py"", line 1025, in priority
    return self.dag.priority(self)
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/dag.py"", line 383, in priority
    return self._priority[job]
KeyError: star_align
[Thu Aug  6 20:41:41 2020]
Finished job 146.
161 of 287 steps (56%) done
[Thu Aug  6 23:27:50 2020]
Finished job 250.
162 of 287 steps (56%) done
[Fri Aug  7 00:07:50 2020]
Finished job 305.
163 of 287 steps (57%) done
[Fri Aug  7 00:11:52 2020]
Finished job 304.
164 of 287 steps (57%) done
[Fri Aug  7 00:13:52 2020]
Finished job 306.
165 of 287 steps (57%) done
[Fri Aug  7 00:17:27 2020]
Finished job 307.
166 of 287 steps (58%) done
```


**To Reproduce**
Please include your **config.yaml**

```
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes
fastq_dir: ./fastq_raw  # where to look for or download the fastqs


# contact info for multiqc report and trackhub
email: d.zijlmans@science.ru.nl

# produce a UCSC trackhub?
create_trackhub: True

# how to handle replicates
technical_replicates: merge    # change to ""keep"" to not combine them

# which quantifier to use
quantifier: htseq

# or specify which quantifier to use with the option to specify own parameters
#quantifier:
#  salmon:
#    quantifier_index: '-k 31'
#    quantify: '--seqBias --gcBias --validateMappings --recoverOrphans'
#    decoy_aware_index: False  # salmon only. Requires ~65 GB RAM for GRCh38


##### aligner and filter options are not used for the gene counts matrix if the quantifier is Salmon

# which aligner to use
aligner: star

# filtering after alignment
remove_blacklist: True
min_mapping_quality: 255  # (only keep uniquely mapped reads from STAR alignments)
only_primary_align: True

##### differential gene expression analysis (optional) #####

# specify contrasts to perform analysis
diffexp:
  deseq2:
    DE_params:
      multiple_testing_procedure: BH  # options: BH/IHW
      alpha_value: 0.05
      shrinkage_estimator: apeglm
    contrasts:
      - 'conditions_all_control'

#differential exon usage
dexseq: True
```

***samples.tsv***
```
sample	assembly	descriptive_name	conditions
external-DZ-RNA1-R1WT-1-18363	GRCm38.p6	WT_1	control
external-DZ-RNA2-R1WT-2-18362	GRCm38.p6	WT_2	control
external-DZ-RNA3-R1WT-3-18361	GRCm38.p6	WT_3	control
external-DZ-RNA4-R1WT-4-18360	GRCm38.p6	WT_4	control
external-DZ-RNA5-EED226-1-18359	GRCm38.p6	EED226_1	treatmentA
external-DZ-RNA6-EED226-2-18358	GRCm38.p6	EED226_2	treatmentA
external-DZ-RNA7-EED226-3-18357	GRCm38.p6	EED226_3	treatmentA
external-DZ-RNA8-EED226-4-18356	GRCm38.p6	EED226_4	treatmentA
external-DZ-RNA9-siEZH2-1-18355	GRCm38.p6	siEZH2_1	treatmentB
external-DZ-RNA10-siEZH2-2-18354	GRCm38.p6	siEZH2_2	treatmentB
external-DZ-RNA11-siEZH2-3-18353	GRCm38.p6	siEZH2_3	treatmentB
external-DZ-RNA12-siEZH2-4-18352	GRCm38.p6	siEZH2_4	treatmentB
external-DZ-RNA13-siSFRS2-1-18351	GRCm38.p6	siSFRS2_1	treatmentC
external-DZ-RNA14-siSFRS2-2-18350	GRCm38.p6	siSFRS2_2	treatmentC
external-DZ-RNA15-siSFRS2-3-18349	GRCm38.p6	siSFRS2_3	treatmentC
external-DZ-RNA16-siSFRS2-4-18348	GRCm38.p6	siSFRS2_4	treatmentC
```


**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.
",dzijlmans,https://github.com/vanheeringen-lab/seq2science/issues/457
MDU6SXNzdWU2NzQ5ODEyNDc=,BUG: profile parsed incorrectly,CLOSED,2020-08-07T12:25:17Z,2020-08-17T14:22:50Z,2020-08-17T14:22:50Z,"**Describe the bug**
Now it parsed wrongly:
`config                 : ['email=M.vanderSande@science.ru.nl', 'ascp_path=$HOME/.aspera/connect/bin/ascp', 'ascp_key=$HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh']`
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/460
MDU6SXNzdWU2NzU2ODE0OTQ=,BUG: seq2science clean does not actually remove old environments,CLOSED,2020-08-09T11:14:34Z,2020-08-09T14:46:23Z,2020-08-09T14:46:23Z,"**Describe the bug**
As a nice bonus of seq2science, we install our environments ""inside"" our conda environment. This means we only have to install environments once, and we do not have to do this at the start of each separate run. However this directory does NOT get cleaned when invoking `seq2science clean`! ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/463
MDU6SXNzdWU2NzU3MTE4NTY=,FR: fasterq-dump,CLOSED,2020-08-09T14:43:05Z,2020-08-26T14:05:51Z,2020-08-26T14:05:51Z,"**Is your feature request related to a problem? Please describe.**
https://twitter.com/biobenkj/status/1065311783630635009

Seems to be much faster than parallel-fastq-dump (4 times)!  Should be easy to implement :smile: 

https://github.com/ncbi/sra-tools/wiki/HowTo:-fasterq-dump",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/464
MDU6SXNzdWU2ODA5OTQwMjU=,FR: order of tracks the same as samples.tsv in trackhub,CLOSED,2020-08-18T12:15:29Z,2020-11-04T07:42:26Z,2020-11-04T07:42:26Z,"**Is your feature request related to a problem? Please describe.**
No clue how the order currently is decided, but would be nice if it follows this order. I nicely sorted my samples file, but every time I open the hub I have to slide all the tracks :(",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/471
MDU6SXNzdWU2ODE3NDM3NTQ=,FR: Add to awesome bioinformatics,CLOSED,2020-08-19T10:50:06Z,2021-02-18T20:29:57Z,2021-02-18T20:29:57Z,"**Is your feature request related to a problem? Please describe.**
https://github.com/danielecook/Awesome-Bioinformatics#pipelines

Once published & more users we should definitely try to get in the pipelines section for some extra attention :)",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/472
MDU6SXNzdWU2ODMzNTAzNzc=,FR: clustering.svg into multiqc report,CLOSED,2020-08-21T07:05:54Z,2020-09-01T19:57:23Z,2020-09-01T19:57:23Z,"**Is your feature request related to a problem? Please describe.**
The rna-seq workflow generates a clustering plot (pca?). Would be cool to add it to the multiqc report.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/475
MDU6SXNzdWU2ODM0MDM3NjI=,BUG: duplicate descriptive names across assemblies,OPEN,2020-08-21T08:47:44Z,2020-09-23T06:45:52Z,,"**Describe the bug**```

```
sample assembly descriptive_name
gsm123 hg38 mytissue
gsm321 hg39 mytissue
```

This should be fine, however raises an error.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/477
MDU6SXNzdWU2ODYzNTEyMjA=,BUG: dags not made for report,CLOSED,2020-08-26T14:07:37Z,2020-09-01T12:39:04Z,2020-09-01T12:39:04Z,"**Describe the bug**
See https://vanheeringen-lab.github.io/seq2science/content/workflows/rna_seq.html

When I try to create them I get for instance:
```
Building DAG of jobs...
MissingInputException in line 143 of /home/maarten/Desktop/seq2science/seq2science/rules/get_genome.smk:
Missing input files for rule unzip_file:
/home/maarten/Desktop/seq2science/seq2science/workflows/atac_seq/results/macs2/Bl71nemr-adult_summits.bed.gz
```
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/481
MDU6SXNzdWU2ODc5MjQ3MDc=,BUG: conditions for macs2 peak calling,CLOSED,2020-08-28T09:00:57Z,2020-09-01T12:39:03Z,2020-09-01T12:39:03Z,"**Describe the bug**
The current version does not work for narrowpeak_summit for macs2 and conditions. This is because Snakemake's ruleorder seems bugged?

We should split this rule into two version, one with macs2 as peak-caller, and the samples can only be the breps of multiple treps....

https://github.com/vanheeringen-lab/seq2science/blob/master/seq2science/rules/peak_counts.smk#L40-LL57

This is quite ugly, but I have no idea how else we can solve it",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/482
MDU6SXNzdWU2ODc5NDk1Mzg=,BUG: no .fa.sizes made,CLOSED,2020-08-28T09:42:29Z,2020-09-01T19:57:20Z,2020-09-01T19:57:20Z,"**Describe the bug**
Something weird going on with trackhub index
```
(base) sande@cn45:/scratch/sande/mouse/genomes/GRCm39$ cat /scratch/sande/mouse/results/log/trackhub/GRCm39.index.log
AY172335.1 is not found in chromosome sizes file
(base) sande@cn45:/scratch/sande/mouse/genomes/GRCm39$ cat /scratch/sande/mouse/genomes/GRCm39/GRCm39.fa.sizes 
(base) sande@cn45:/scratch/sande/mouse/genomes/GRCm39$ 
```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/484
MDU6SXNzdWU2ODg0OTgwNjg=,FR: accept google spreadsheet as input,CLOSED,2020-08-29T09:31:21Z,2020-09-23T06:45:29Z,2020-09-23T06:45:29Z,It would be so nice just to pass a url,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/487
MDU6SXNzdWU3MDA4NjQwMjg=,BUG: add specific versions back to chipseeker,CLOSED,2020-09-14T07:47:53Z,2023-05-02T18:22:17Z,2023-05-02T18:22:17Z,"**Describe the bug**
Somehow specific version broke the environment installation. However it really shouldnt.

Check back in a while (maybe with new snakemake version) to see if it works again.

(also update explain.smk)",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/506
MDU6SXNzdWU3MDA4ODY0ODk=,BUG: snakemakeoptions parsing,CLOSED,2020-09-14T08:22:21Z,2020-10-12T09:28:05Z,2020-10-12T09:28:05Z,"**Describe the bug**
seq2science run atac-seq --snakemakeOptions cluster=""sbatch dsadas dsadsada dsadsa dasdsa"" should work
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/507
MDU6SXNzdWU3MDA4ODk3MDM=,BUG: profile parsing goes wrong,CLOSED,2020-09-14T08:27:08Z,2020-10-12T09:28:01Z,2020-10-12T09:28:01Z,"**Describe the bug**
```
seq2science run download-fastq -j 150 --keep-going  --profile ocimum --dryrun
Traceback (most recent call last):
  File ""/home/sande/anaconda3/envs/seq2science/bin/seq2science"", line 8, in <module>
    main()
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/cli.py"", line 46, in main
    _run(args, base_dir, workflows_dir, config_path)
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/cli.py"", line 263, in _run
    add_profile_args(profile_file, parsed_args)
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/cli.py"", line 224, in add_profile_args
    for k2, v2 in profile[k].items():
AttributeError: 'list' object has no attribute 'items'
```

```
# execution
cores: 48
resources:
  - parallel_downloads=3
  - mem_gb=64
config:
  - email=M.vanderSande@science.ru.nl
  - ascp_path=$HOME/.aspera/connect/bin/ascp
  - ascp_key=$HOME/.aspera/connect/etc/asperaweb_id_dsa.openssh
keep-going: True


# environment
use-conda: True
use-singularity: False
```



**To Reproduce**
Please include your **config.yaml**, your **samples.tsv**, and the complete/relevant **output**.

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/508
MDU6SXNzdWU3MDI1NjIxMzA=,BUG: multiqc with many samples,CLOSED,2020-09-16T08:23:15Z,2020-11-04T07:43:11Z,2020-11-04T07:43:11Z,"**Describe the bug**
I am not sure how responsive the html will be with many samples, but s2s really shouldn't crash! If we move all qc stuff in a folder per assembly, it should work. However, this will also add qc from previous runs. Do/should we care?",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/513
MDU6SXNzdWU3MDQzMzc5NDQ=,BUG: error edgeR_normalization,CLOSED,2020-09-18T12:24:57Z,2020-11-04T07:43:17Z,2020-11-04T07:43:17Z,"

**Describe the bug**
```
[Fri Sep 18 13:52:16 2020]
Error in rule edgeR_normalization:
    jobid: 284
    output: /home/dzijlmans/ChIP-seq/DZ023/results_resonicated_200917_complete/count_table/macs2/GRCm38.p6_upperquartile.tsv
    log: /home/dzijlmans/ChIP-seq/DZ023/results_resonicated_200917_complete/log/edgeR_normalization/GRCm38.p6-macs2-upperquartile.log (check log file(s) for error message)
    conda-env: /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/ee92d238

RuleException:
CalledProcessError in line 249 of /home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/rules/peak_counts.smk:
Command 'source /home/dzijlmans/anaconda3/envs/seq2science2/bin/activate '/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/.snakemake/ee92d238'; set -euo pipefail;  Rscript --vanilla /home/dzijlmans/ChIP-seq/DZ023/.snakemake/scripts/tmpi74ro7gu.edger_norm.R' returned non-zero exit status 1.
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/executors/__init__.py"", line 2135, in run_wrapper
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/seq2science/rules/peak_counts.smk"", line 249, in __rule_edgeR_normalization
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/executors/__init__.py"", line 529, in _callback
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/concurrent/futures/thread.py"", line 57, in run
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/executors/__init__.py"", line 515, in cached_or_run
  File ""/home/dzijlmans/anaconda3/envs/seq2science2/lib/python3.7/site-packages/snakemake/executors/__init__.py"", line 2201, in run_wrapper

```

**To Reproduce**

*config.yaml*
```
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results_resonicated_200917_complete  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes
fastq_dir: ./fastq_raw/DZ023_resonicated # where to look for or download the fastqs


# contact info for multiqc report and trackhub
email: d.zijlmans@science.ru.nl

# produce a UCSC trackhub?
create_trackhub: True

# peak caller
peak_caller:
  macs2:
      --keep-dup 1 --buffer-size 10000

# how to handle replicates
biological_replicates: fisher  # change to ""keep"" to not combine them
technical_replicates: merge    # change to ""keep"" to not combine them

# filtering after alignment
remove_blacklist: True
min_mapping_quality: 30
only_primary_align: True

# use 'our' default parameters
aligner: bwa-mem

# or specify which aligner to use with the option to specify own parameters
# aligner:
#   bwa-mem:
#     index:  # parameters for indexing
#       '-a bwtsw'
#     align:  # parameters for alignment
#       ''

```

*samples.tsv*
```
# for help with filling out the samples.tsv:
# https://vanheeringen-lab.github.io/seq2science/content/workflows/chip_seq.html#filling-out-the-samples-tsv
# also make sure that you use tab as a delimiter
sample	assembly	descriptive_name
external-024-DZ-10input-18594	GRCm38.p6	input_R1wt
external-024-DZ-Ezh2-1-18615	GRCm38.p6	Ezh2_1_R1wt
external-024-DZ-Ezh2-2-18589	GRCm38.p6	Ezh2_2_R1wt
external-024-DZ-Gpatch1-1-18614	GRCm38.p6	Gpatch1_1_R1wt
external-024-DZ-Gpatch1-2-18613	GRCm38.p6	Gpatch1_2_R1wt
external-024-DZ-Gpatch4-1-18612	GRCm38.p6	Gpatch4_1_R1wt
external-024-DZ-Gpatch4-2-18611	GRCm38.p6	Gpatch4_2_R1wt
external-024-DZ-H3K27me3-1-18588	GRCm38.p6	H3K27me3_1_R1wt
external-024-DZ-H3K27me3-2-18587	GRCm38.p6	H3K27me3_2_R1wt
external-024-DZ-Sall1-1-18586	GRCm38.p6	Sall1_1_R1wt
external-024-DZ-Sall1-2-18585	GRCm38.p6	Sall1_2_R1wt
external-024-DZ-Sall4-1-18584	GRCm38.p6	Sall4_1_R1wt
external-024-DZ-Sall4-2-18583	GRCm38.p6	Sall4_2_R1wt
external-024-DZ-Zfp62-1-18610	GRCm38.p6	Zfp62_1_R1wt
external-024-DZ-Zfp62-2-18609	GRCm38.p6	Zfp62_2_R1wt
```

*log file*

[GRCm38.p6-macs2-upperquartile.log](https://github.com/vanheeringen-lab/seq2science/files/5245419/GRCm38.p6-macs2-upperquartile.log)

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.
",dzijlmans,https://github.com/vanheeringen-lab/seq2science/issues/515
MDU6SXNzdWU3MTM3NjUwOTc=,FR: rework trackhubs,CLOSED,2020-10-02T16:53:48Z,2020-11-04T07:43:24Z,2020-11-04T07:43:24Z,"there's a new system, but the current implementation is clunky as well. Adding a grouping allows for group collapsing (quicker).

see [here](http://mbdata.science.ru.nl/ghe/.trackhub/hg38/trackDb.txt) for an improved trackDb.txt

full text:
```
track hg38
compositeTrack on
shortLabel hg38
longLabel s2s: hg38 trackhub
type bigWig
priority 50
visibility dense

        track rPBMCmTA
        parent hg38 on
        bigDataUrl rPBMCmTA.bigWig
        shortLabel rPBMCmTA
        longLabel rPBMCmTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 5
        visibility dense
                
        track rPBMCpTA
        parent hg38 on
        bigDataUrl rPBMCpTA.bigWig
        shortLabel rPBMCpTA
        longLabel rPBMCpTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 7
        visibility dense
        
        track rP1mTA
        parent hg38 on
        bigDataUrl rP1mTA.bigWig
        shortLabel rP1mTA
        longLabel rP1mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 9
        visibility dense
        
        track rP1pTA
        parent hg38 on
        bigDataUrl rP1pTA.bigWig
        shortLabel rP1pTA
        longLabel rP1pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 11
        visibility dense
        
        track rP2mTA
        parent hg38 on
        bigDataUrl rP2mTA.bigWig
        shortLabel rP2mTA
        longLabel rP2mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 13
        visibility dense
        
        track rP2pTA
        parent hg38 on
        bigDataUrl rP2pTA.bigWig
        shortLabel rP2pTA
        longLabel rP2pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 15
        visibility dense
        
        track rP3mTA
        parent hg38 on
        bigDataUrl rP3mTA.bigWig
        shortLabel rP3mTA
        longLabel rP3mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 17
        visibility dense
        
        track rP3pTA
        parent hg38 on
        bigDataUrl rP3pTA.bigWig
        shortLabel rP3pTA
        longLabel rP3pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 19
        visibility dense
        
        track rP4mTA
        parent hg38 on
        bigDataUrl rP4mTA.bigWig
        shortLabel rP4mTA
        longLabel rP4mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 21
        visibility dense
        
        track rP4pTA
        parent hg38 on
        bigDataUrl rP4pTA.bigWig
        shortLabel rP4pTA
        longLabel rP4pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 23
        visibility dense
        
        track rP5mTA
        parent hg38 on
        bigDataUrl rP5mTA.bigWig
        shortLabel rP5mTA
        longLabel rP5mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 25
        visibility dense
        
        track rP5pTA
        parent hg38 on
        bigDataUrl rP5pTA.bigWig
        shortLabel rP5pTA
        longLabel rP5pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 27
        visibility dense
        
        track sPBMCmTA
        parent hg38 on
        bigDataUrl sPBMCmTA.bigWig
        shortLabel sPBMCmTA
        longLabel sPBMCmTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 29
        visibility dense
        
        track sPBMCpTA
        parent hg38 on
        bigDataUrl sPBMCpTA.bigWig
        shortLabel sPBMCpTA
        longLabel sPBMCpTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 31
        visibility dense
        
        track sP1mTA
        parent hg38 on
        bigDataUrl sP1mTA.bigWig
        shortLabel sP1mTA
        longLabel sP1mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 33
        visibility dense
        
        track sP1pTA
        parent hg38 on
        bigDataUrl sP1pTA.bigWig
        shortLabel sP1pTA
        longLabel sP1pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 35
        visibility dense
        
        track sP2mTA
        parent hg38 on
        bigDataUrl sP2mTA.bigWig
        shortLabel sP2mTA
        longLabel sP2mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 37
        visibility dense
        
        track sP2pTA
        parent hg38 on
        bigDataUrl sP2pTA.bigWig
        shortLabel sP2pTA
        longLabel sP2pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 39
        visibility dense
        
        track sP3mTA
        parent hg38 on
        bigDataUrl sP3mTA.bigWig
        shortLabel sP3mTA
        longLabel sP3mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 41
        visibility dense
        
        track sP3pTA
        parent hg38 on
        bigDataUrl sP3pTA.bigWig
        shortLabel sP3pTA
        longLabel sP3pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 43
        visibility dense
        
        track sP4mTA
        parent hg38 on
        bigDataUrl sP4mTA.bigWig
        shortLabel sP4mTA
        longLabel sP4mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 45
        visibility dense
        
        track sP4pTA
        parent hg38 on
        bigDataUrl sP4pTA.bigWig
        shortLabel sP4pTA
        longLabel sP4pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 47
        visibility dense
        
        track sP5mTA
        parent hg38 on
        bigDataUrl sP5mTA.bigWig
        shortLabel sP5mTA
        longLabel sP5mTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 49
        visibility dense
        
        track sP5pTA
        parent hg38 on
        bigDataUrl sP5pTA.bigWig
        shortLabel sP5pTA
        longLabel sP5pTA
        type bigWig
        autoScale on
        color 0,0,0
        maxHeightPixels 100:32:8
        priority 51
        visibility dense

```
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/522
MDU6SXNzdWU3MTc1OTcxNjQ=,BUG: atac-seq workflow crashes on mixed single/paired,CLOSED,2020-10-08T19:15:50Z,2020-11-04T07:43:27Z,2020-11-04T07:43:27Z,"**Describe the bug**

```
layout:                : {'GSM2902634': 'PAIRED', 'GSM3732618': 'SINGLE', 'HEK293': 'PAIRED'}



Building DAG of jobs...
MissingInputException in line 86 of /vol/mbconda/heeringen/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/merge_replicates.smk:
Missing input files for rule merge_replicates:
/scratch/heeringen/tes/results/fastq_trimmed/GSM3732618_R1_trimmed.fastq.gz
```

Crash, probably because samples that are specified as replicates are SINGLE and PAIRED. 


**To Reproduce**

samples.tsv

```
sample  descriptive_name        replicate       assembly
GSM2902634      HEK293_ATAC_low_depth_bio2_tech2        HEK293  hg38
GSM3732618      siCtrl_ATACseq  HEK293  hg38
```

**Expected behavior**

A warning, that tells you which samples would give problems.
",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/525
MDU6SXNzdWU3MTc1OTg1OTM=,BUG: 'layout' not found,CLOSED,2020-10-08T19:18:15Z,2020-11-04T07:43:31Z,2020-11-04T07:43:31Z,"**Describe the bug**

```
Checking if samples are available online...
This can take some time.
Done!


KeyError in line 382 of /vol/mbconda/heeringen/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/configuration_generic.smk:
'layout'
  File ""/vol/mbconda/heeringen/envs/seq2science/lib/python3.8/site-packages/seq2science/workflows/atac_seq/Snakefile"", line 4, in <module>
  File ""/vol/mbconda/heeringen/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/configuration.smk"", line 1, in <module>
  File ""/vol/mbconda/heeringen/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/configuration_generic.smk"", line 382, in <module>
```

**To Reproduce**

samples.tsv

```
sample  descriptive_name        replicate       assembly
GSM3215609      GM12878 bulk NT1 Rep1   GM12878 hg38
GSM3215610      GM12878 bulk NT1 Rep2   GM12878 hg38
GSM3215611      GM12878 bulk NT1 Rep3   GM12878 hg38
```

**Expected behavior**

In order of preference: a normal run,  a warning. ",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/526
MDU6SXNzdWU3MTc2MDA2MDA=,FR: colors! for tracks!,CLOSED,2020-10-08T19:21:28Z,2020-11-04T07:43:34Z,2020-11-04T07:43:34Z,"**Is your feature request related to a problem? Please describe.**

I am frustrated with a lack of colors in the track hub.

**Describe the solution you'd like**

An optional column in the sample sheet that determines track color? An additional track hub config? ",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/527
MDU6SXNzdWU3MjcxNTUxMTI=,BUG: ABI solid not supported,CLOSED,2020-10-22T08:10:53Z,2021-05-20T08:30:07Z,2021-05-20T08:30:07Z,"**Describe the bug**
ABI solid sequencing does not play well with most aligners. 

Perhaps an error/warning would be nice",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/533
MDU6SXNzdWU3MzA0MzE0MzM=,"BUG: complement blacklist fails, .fa.sizes empty",CLOSED,2020-10-27T13:03:25Z,2020-11-04T07:43:49Z,2020-11-04T07:43:49Z,"**Describe the bug**
Reported by Branco (hg38), but now I (GRCg6a) have it as well. 

The .fa.sizes file is empty... :thinking: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/534
MDU6SXNzdWU3MzA0MzQxNDA=,BUG: online samples but none exists of GSM,CLOSED,2020-10-27T13:06:58Z,2020-11-04T07:41:46Z,2020-11-04T07:41:46Z,"**Describe the bug**
When using online samples but none of the samples is a GSM the pipeline complains and explodes",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/535
MDU6SXNzdWU3MzA0MzU5NjY=,BUG: python38 warning: ,CLOSED,2020-10-27T13:09:10Z,2020-11-04T07:41:46Z,2020-11-04T07:41:46Z,"**Describe the bug**
```
/vol/mbconda/sande/envs/seq2science/lib/python3.8/site-packages/seq2science/workflows/rna_seq/Snakefile:38: SyntaxWarning: ""is not"" with a literal. Did you mean ""!=""?
```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/536
MDU6SXNzdWU3MzA0NDM1NTA=,BUG: can not copy sample sheet when its an url,CLOSED,2020-10-27T13:18:56Z,2023-05-02T18:17:51Z,2023-05-02T18:17:51Z,"**Describe the bug**
At the onstart it tries to be copied, but its an url.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/537
MDU6SXNzdWU3MzE3NjQxMTk=,BUG: sample clustering image no letters,CLOSED,2020-10-28T20:22:52Z,2020-11-04T07:43:52Z,2020-11-04T07:43:52Z,"**Describe the bug**
A clear and concise description of what the bug is. Please add the (full) error message.
![image](https://user-images.githubusercontent.com/15323399/97492361-b7245380-1963-11eb-9e1d-474d048909a6.png)
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/543
MDU6SXNzdWU3MzIxMjc3NjM=,FR: Order of samples in MultiQC same as in samples,OPEN,2020-10-29T08:57:59Z,2020-10-30T16:03:03Z,,"**Is your feature request related to a problem? Please describe.**
The current semi-random ordering is ugly, and might hide obvious patterns.
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/544
MDU6SXNzdWU3MzM0NTQ2Mzg=,FR: Investigate unit tests,CLOSED,2020-10-30T19:23:45Z,2020-11-13T16:35:06Z,2020-11-13T16:35:06Z,"**Is your feature request related to a problem? Please describe.**
https://snakemake.readthedocs.io/en/stable/snakefiles/testing.html",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/545
MDU6SXNzdWU3MzM0NTY0Mzk=,FR: snakemake 5.27,CLOSED,2020-10-30T19:26:36Z,2021-03-04T10:16:20Z,2021-03-04T10:16:20Z,"**Is your feature request related to a problem? Please describe.**
Should bring DAG generation improvements! Currently generating a DAG can take quite some time. Once every while we should check if our issues are being resolved with newer versions.
https://snakemake.readthedocs.io/en/stable/project_info/history.html#changed
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/546
MDU6SXNzdWU3MzUzMzI5MjM=,FR: Add read group to single-cell bams,CLOSED,2020-11-03T13:46:44Z,2022-04-16T14:32:38Z,2022-04-16T14:32:38Z,"**Is your feature request related to a problem? Please describe.**
Not sure how big the effect is. But our current approach (and everyone else's) is to mark duplicates on the whole bam. However we should take the information along that reads come from different groups. Should be fine/easy to do with pysam (just slow).

https://www.biostars.org/p/43897/#43905
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/549
MDU6SXNzdWU3MzU1NDYyMTc=,BUG: pysradb API rate exceeded,CLOSED,2020-11-03T18:30:19Z,2021-02-15T08:04:54Z,2021-02-15T08:04:23Z,"**Describe the bug**
https://github.com/vanheeringen-lab/seq2science/pull/550#issuecomment-721250179

**Fix**
https://github.com/vanheeringen-lab/seq2science/pull/550#issuecomment-721289955


",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/552
MDU6SXNzdWU3MzYxNDY0MDA=,BUG: trackhub 0.2.4 installed by docs,CLOSED,2020-11-04T14:10:57Z,2020-11-05T09:58:36Z,2020-11-05T09:58:36Z,"**Describe the bug**
A clear and concise description of what the bug is. Please add the (full) error message.

**To Reproduce**
Please include your **config.yaml**, your **samples.tsv**, and the complete/relevant **output**.

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/556
MDU6SXNzdWU3Mzc3NzgwMjE=,FR: support multiple scRNA-seq platforms ,CLOSED,2020-11-06T13:59:12Z,2020-11-18T13:39:05Z,2020-11-18T13:39:04Z,"**Is your feature request related to a problem? Please describe.**
The current implementation of the scrna_seq workflow supports the celseq protocol exclusively. Additional platforms can be supported by setting the corresponding UMI/barcode/read ordering via the `-x ` argument in `kb-python count`. 

**Describe the solution you'd like**
- Add additional kallistobus example settings to scrna_seq `config.yaml`
- Dynamically infer the Fastq file for trimming in `get_kallistobus_reads` from `count` parameter.  This should render the `protocol `parameter obsolete. 


",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/560
MDU6SXNzdWU3Mzc4MDU0NDY=,FR:  Jupyer notebook for scRNA-seq post-processing,CLOSED,2020-11-06T14:32:43Z,2021-05-10T13:45:04Z,2021-05-10T13:45:04Z,"**Is your feature request related to a problem? Please describe.** 
Enhancement

**Describe the solution you'd like**
- Generate a Jupyter Notebook with basic Seurat/Scanpy routines to further analyze scRNA-seq count tables. This should be helpful to get started with some post-processing (qc, normalization etc.).

",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/561
MDU6SXNzdWU3Mzc4ODU2OTg=,"Q: Does trimming remove very bad reads, or does it somehow mask them?",CLOSED,2020-11-06T16:22:37Z,2020-11-28T11:18:49Z,2020-11-28T11:18:49Z,"**Question**
When trimming paired end reads with cutadapt/trimgalore the pairs are trimmed independently. And scRNA-seq trims only the reads (not barcodes). If reads are ever removed, this would mean that the pairs get out of sync, and that would be very bad!!

Two ways to check:
- make a mini fastq ourselves, with horrendous reads. Check if the trimmed fastq is the same length
- trim on a big ""real"" fastq, check if the trimmed fastq is the same length as untrimmed

To check length of .gz files:

```
zcat [myfile] | wc -l
```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/562
MDU6SXNzdWU3NDI1ODc0NjY=,FR: Differential peaks,CLOSED,2020-11-13T16:33:41Z,2021-03-03T16:17:37Z,2021-03-03T16:17:37Z,"**Is your feature request related to a problem? Please describe.**
RNA-seq has DEseq2. Would be really nice if we re-use parts of that to use in either diffbind or DEseq2 itself.
https://support.bioconductor.org/p/132840/

If/when/once this is supported, it allows for immediate fluff heatmap and gimme maelstrom runs. Making the ATAC/ChIP pipelines truely end-to-end.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/566
MDU6SXNzdWU3NDM4NzA4MjI=,FR: use cache dir instead of ~/.config/cache or something,CLOSED,2020-11-16T14:16:17Z,2020-12-01T12:49:56Z,2020-12-01T12:49:56Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/567
MDU6SXNzdWU3NDQyMTAyNTQ=,"BUG: Value 191.0,0.0,0.0 failed RGB validation; Example value(s): '128,0,255'",CLOSED,2020-11-16T21:38:41Z,2020-11-17T17:10:59Z,2020-11-17T17:10:59Z,"I don't believe I have any colors specified in the samples or config.

```
Error in rule trackhub:
    jobid: 0
    output: /vol/test_vick/results/trackhub
    log: /vol/test_vick/results/log/trackhub/trackhub.log (check log file(s) for error message)

RuleException:
ValidationError in line 668 of /home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/trackhub.smk:
Value 191.0,0.0,0.0 failed RGB validation; Example value(s): '128,0,255'
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/snakemake/executors/__init__.py"", line 2163, in run_wrapper
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/trackhub.smk"", line 668, in __rule_trackhub
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/upload.py"", line 215, in upload_hub
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/base.py"", line 135, in render
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/base.py"", line 135, in render
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/base.py"", line 135, in render
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/base.py"", line 131, in render
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/trackdb.py"", line 117, in _render
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/trackdb.py"", line 106, in __str__
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/track.py"", line 580, in __str__
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/track.py"", line 641, in __str__
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/track.py"", line 386, in __str__
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/validate.py"", line 136, in validate
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/trackhub/validate.py"", line 58, in __call__
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/snakemake/executors/__init__.py"", line 529, in _callback
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/concurrent/futures/thread.py"", line 57, in run
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/snakemake/executors/__init__.py"", line 515, in cached_or_run
  File ""/home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/snakemake/executors/__init__.py"", line 2201, in run_wrapper
Exiting because a job execution failed. Look above for error message
```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/569
MDU6SXNzdWU3NDUzNzIxMDM=,FR: Better ChIP-seq bigWigs,CLOSED,2020-11-18T06:26:42Z,2020-11-18T09:59:38Z,2020-11-18T09:59:38Z,"**Is your feature request related to a problem? Please describe.**

Running bamCoverage with default settings will generate suboptimal bigWigs.

**Describe the solution you'd like**

* Estimate ChIP-seq fragment size (https://github.com/kundajelab/phantompeakqualtools, maybe there is a better option now).
* Use that fragment size with the `--extendReads, -e` of `bamCoverage`.

**(optional) Additional context**

The bigWigs for ChIP will be much improved!

![image](https://user-images.githubusercontent.com/281252/99493373-65258b00-296f-11eb-99b8-4319743d26b9.png)

",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/571
MDU6SXNzdWU3NDU1MTU3NTQ=,FR: pls explain,CLOSED,2020-11-18T10:04:57Z,2021-01-28T09:31:57Z,2021-01-28T09:31:57Z,"@JGASmits https://vanheeringen-lab.github.io/seq2science/content/schemas.html#single-cell-atac

I noticed the description still had to be done, you can change it here :innocent: 
https://github.com/vanheeringen-lab/seq2science/blob/master/seq2science/schemas/config/scatac.schema.yaml",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/572
MDU6SXNzdWU3NDU1NzQ5NTM=,FR: trim down base env,CLOSED,2020-11-18T11:24:19Z,2020-12-01T12:50:19Z,2020-12-01T12:50:18Z,"**Is your feature request related to a problem? Please describe.**
We could/should clean up our base env by moving the run directives to scripts.

- [ ] rule trackhub, package(s): trackhub, biopython, matplotlib
- [ ] rule multiqc_samplesconfig, package(s): pretty_html_table
- [ ] rule keep_mates, package(s): pysam",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/574
MDU6SXNzdWU3NDYzNDQxODQ=,FR: check size or shasum of downloaded fastq,CLOSED,2020-11-19T08:04:28Z,2020-12-01T12:51:36Z,2020-12-01T12:51:36Z,"**Is your feature request related to a problem? Please describe.**
Currently ENA is down and empty files are being sent. We should check if the file we get is not empty, and/or that the shasum corresponds.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/578
MDU6SXNzdWU3NDY0NTA2MTM=,BUG: onehot peaks missing column names,CLOSED,2020-11-19T10:31:47Z,2021-10-28T12:19:04Z,2021-10-28T12:19:04Z,"**Describe the bug**
Summits and thus combinedpeaks (with slop), are taken from breps.

We then make a onehot encoding of whether a sample contains those peaks, based on overlap of the breps narrowpeak and the combinedpeaks. Somehow this results in rows with all zeroes, and unless I understand incorrectly, this should not be possible.

It might be possible that somehow overlap disappears with slop in very narrow / broad peaks? :thinking: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/580
MDU6SXNzdWU3NDg3NTgxMjI=,BUG: GRCh38.p13.customblacklist_complement,CLOSED,2020-11-23T12:24:18Z,2020-11-23T15:00:03Z,2020-11-23T15:00:03Z,"**Describe the bug**

He doesnt seem to find the correct blacklist file.
/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/Epi_fate_specifiers/genomes/GRCh38.p13/GRCh38.p13.customblacklist_complement.bed

> Traceback (most recent call last):
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/__init__.py"", line 699, in snakemake
>     keepincomplete=keep_incomplete,
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/workflow.py"", line 937, in execute
>     success = scheduler.schedule()
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/scheduler.py"", line 394, in schedule
>     run = self.job_selector(needrun)
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/scheduler.py"", line 541, in job_selector
>     c = list(map(self.job_reward, jobs))  # job rewards
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/scheduler.py"", line 623, in job_reward
>     temp_size = self.dag.temp_size(job)
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/dag.py"", line 556, in temp_size
>     return sum(f.size for f in self.temp_input(job))
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/dag.py"", line 556, in <genexpr>
>     return sum(f.size for f in self.temp_input(job))
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/io.py"", line 139, in wrapper
>     return func(self, *args, **kwargs)
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/io.py"", line 154, in wrapper
>     return func(self, *args, **kwargs)
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/io.py"", line 350, in size
>     return self.size_local
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/io.py"", line 355, in size_local
>     self.check_broken_symlink()
>   File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.7/site-packages/snakemake/io.py"", line 360, in check_broken_symlink
>     if not self.exists_local and os.lstat(self.file):
> FileNotFoundError: [Errno 2] No such file or directory: '/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/Epi_fate_specifiers/genomes/GRCh38.p13/GRCh38.p13.customblacklist_complement.bed'
> 

I've looked into GRCh38.p13, and there is a blacklist file however this is called:
""GRCh38.p13.blacklist.bed""

I've copied this and renamed it to Ch38.p13.customblacklist_complement.bed, and am running it now to see if this solves it.

My sample file is located at: /ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/Epi_fate_specifiers/RNAseq/samples.tsv

and my config file at:
/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/Epi_fate_specifiers/RNAseq/config.yaml



Greetings :)",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/584
MDU6SXNzdWU3NTEwOTM2ODk=,BUG: duplicate rows in count table,CLOSED,2020-11-25T20:18:08Z,2020-12-01T12:51:56Z,2020-12-01T12:51:56Z,"**Describe the bug**
```
Warning message:
package edgeR was built under R version 3.6.2 
```

**To Reproduce**
I ran the atac-seq pipeline with default settings",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/587
MDU6SXNzdWU3NTE0NDE5MDM=,FR: RNA-seq RSeQC,CLOSED,2020-11-26T09:43:29Z,2023-05-02T18:18:16Z,2023-05-02T18:18:16Z,"**Is your feature request related to a problem? Please describe.**
Unnecessary, but might be nice if someone has the time

http://rseqc.sourceforge.net/

Seems to be integratable with multiqc, and adds awesome stuff like juntions to UCSC genome browser. Not sure if its supported by trackhub
![image](https://user-images.githubusercontent.com/15323399/100334465-1d88aa00-2fd4-11eb-92e2-b4495ec9a826.png)
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/588
MDU6SXNzdWU3NTE1MTIyOTE=,BUG: chipseeker does not work without descriptive names,CLOSED,2020-11-26T11:23:11Z,2021-03-04T08:07:14Z,2021-03-04T08:07:14Z,"**Describe the bug**
See title. If the descriptive names are not in the samples file, an empty string gets passed to the chipseeker script which then is split on spaces and this explodes :fire: :bomb: . 

I think this can be easilty fixed here by checking if the descriptive names actually is longer than zero, and if not, use the name of the file (ideally some smaller portion, eg. between the assembly name and the `_peaks.narrowPeak` part:
https://github.com/vanheeringen-lab/seq2science/blob/master/seq2science/scripts/chipseeker.R#L37-L40

Can I pass this to you @JGASmits? :innocent: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/589
MDU6SXNzdWU3NTIwNjI5NjI=,FR: rRNA removal,CLOSED,2020-11-27T08:09:57Z,2022-04-16T14:32:39Z,2022-04-16T14:32:39Z,"**Is your feature request related to a problem? Please describe.**
@tilschaef told me about filtering out rRNA for RNA-seq, and this seems like a sane thing to do. Multiple tools exist that do this. These generally require a rRNA database to work. I don't think we can somehow extract this info from the gtf file @siebrenf ? ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/590
MDU6SXNzdWU3NTI2NTYxODA=,FR: (Better) cluster support,CLOSED,2020-11-28T11:17:34Z,2020-11-30T13:24:03Z,2020-11-30T13:24:03Z,"# can't properly do sbatch
I want to do

`seq2science run atac-seq --snakemakeOptions cluster=""sbatch -p normal -t 9""`

But then our parser complains that there is a space in between :(

# when using a cluster, you use nodes, not cores

add nodes option to cli, or make nodes == cores

# not registred when a job fails of is canceled

I think a solution for this is in the slurm profile of snakemake/snakemake-profiles

# make cartesius and cn45 / moldev profile

Since we now have a partition on cn45, and once mb07 is there. We can add it as a profile --> double the fun! :sunglasses: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/592
MDU6SXNzdWU3NTMzMjk4NzA=,BUG: [scRNA: Trimming inconsistencies ],CLOSED,2020-11-30T09:55:36Z,2020-12-08T14:06:07Z,2020-12-08T14:06:07Z,"**Describe the bug**
Trimming of scRNA reads before running kallisto bustools does not produce expected results. Since we only trim the fastq that contains the reads, the number of total reads after trimming can vary between R1/R2.  

**To Reproduce**
The current implementation of the seq2science scRNA workflow can not reproduce the results from the [10xv3 pbmc notebook](https://colab.research.google.com/github/pachterlab/kallistobustools/blob/master/notebooks/kb_analysis_0_python.ipynb#scrollTo=bEN8ifXwEbki). This becomes especially apparent in the PCA plot which displays no cluster structure but appears random.

**Expected behavior**
The count tables produces by the scRNA workflow should yield comparable results to the 10xv3 pbmc notebook.  

**Possible solution**
Add a fastq matching rule after trimming to correct for differing read numbers between R1 and R2. This could be archived with (fastq-pair)[https://github.com/linsalrob/fastq-pair] 
",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/593
MDU6SXNzdWU3NTU5OTE4MTA=,BUG: column names in samples.tsv,CLOSED,2020-12-03T08:46:09Z,2021-03-03T16:16:36Z,2021-03-03T16:16:36Z,"**Describe the bug**

Not really a bug, but something that I think should be fixed. Currently the `replicate` columns in `samples.tsv` describes *technical replicates*, while the `condition` columns describes *biological replicates*. If I understand the docs correctly. I think this naming should be improved. My hunch is that most people will expect a replicate to be a biological replicate. You can also see this for replicates on GEO. These are pretty much always **biological** replicates, that you would not expect to be merged. The term `condition` is used when a sample is treated, a gene is knocked-out etc. So, I think this is confusing. Could we not be explicit and name these columns `technical_replicate` and `biological_replicate`? All `samples.tsv` examples in the docs (which are great btw), should contain some biological replicate examples, and not an example of just technical replicates.",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/597
MDU6SXNzdWU3NTk0MzcyMTU=,FR: trackhub permission,CLOSED,2020-12-08T13:15:56Z,2020-12-11T10:05:23Z,2020-12-11T10:05:23Z,The trackhub file that comes out of the trackhub rule somehow has weird permissions by default.,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/601
MDU6SXNzdWU3NjA0NDM4NDY=,BUG: NotADirectoryError,CLOSED,2020-12-09T15:46:43Z,2021-10-04T10:14:04Z,2021-10-04T10:14:04Z,"Can't really say how this happened (student), but I am putting this one here for the sake that we are aware of it.

![image](https://user-images.githubusercontent.com/15323399/101651997-f901e880-3a3d-11eb-8355-45de9c98f5a8.png)
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/604
MDU6SXNzdWU3NjA0NTIxNDY=,FR: check for duplicate yaml keys,CLOSED,2020-12-09T15:56:51Z,2022-01-24T19:13:34Z,2022-01-24T19:13:34Z,"**Is your feature request related to a problem? Please describe.**
Some people (@JGASmits kuch kuch) put multiple of the same keys in the `config.yaml`. QOL fix to add a check for this.
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/605
MDU6SXNzdWU3NjA2MTY2OTA=,FR: separate configs for quantification and alignment,CLOSED,2020-12-09T19:40:45Z,2021-03-04T10:09:57Z,2021-03-04T10:09:57Z,"**Is your feature request related to a problem? Please describe.**
When not using an aligner (only a quantifier), e.g. salmon or kallistobus, the aligner and bam sorting are still printed as the config. This is confusing, and should not happen.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/606
MDU6SXNzdWU3NjEzNDc2Mjg=,BUG: Unknown provider,CLOSED,2020-12-10T15:38:59Z,2020-12-11T10:05:12Z,2020-12-11T10:05:12Z,"**Describe the bug**
This is caused on the genomepy side, what we should do is catch these errors and print something that makes sense for the user.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/609
MDU6SXNzdWU3NjIwODIwMjI=,BUG: Missing required 'bigDataUrl' setting in hub http://ocimum.science.ru.nl/trackhub_rna/RNA-seq_trackhub.hub.txt genome hub_63620_UCB_Xtro_10.0 track reversestrandreads,CLOSED,2020-12-11T08:42:59Z,2020-12-18T21:05:17Z,2020-12-18T21:05:17Z,"**Describe the bug**
I can't visualize my RNA trackhub :sob: 

It's here: http://ocimum.science.ru.nl/trackhub_rna/",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/611
MDU6SXNzdWU3NjY0MzA3MzE=,FR: scRNA tests,CLOSED,2020-12-14T13:23:01Z,2021-07-11T19:10:44Z,2021-07-11T19:10:44Z,"DAG tests are a *must*, preferably also ""real"" tests. 

Semi-related to #345 #366",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/614
MDU6SXNzdWU3Njk4ODgyODk=,Q: How to set-up custom genome indexes (with the scRNA-seq pipeline)?,CLOSED,2020-12-17T11:17:02Z,2020-12-18T21:05:06Z,2020-12-18T21:05:06Z,"**Question**
Trying to generate a genome with custom additions 1. unsure where to place the settings for this in the config.yaml and 2. custom additions are not getting incorporated, not sure where to look for troubleshooting? 
**Subquestion:** Is the custom addition also possible with multiple files? (e.g. If I seperate 2 .fa/.gtf files with spaces?)

**What have I tried**
- The pipeline overall seems to run really nice! :) The problem starts with adding the custom .fa/.gtf files.
- See below my .config.yaml, I tried placing the `custom_genome_extension:`, `custom_annotation_extension:`, `custom_assembly_suffix:`, also right below the `fastq_dir:`-setting, although then the program is in trouble to locate my fastq files. Therefore, I now put it right before the `ref:`-settings, where the index-settings are stored.
- The picture below does show that the settings are saved.
- My output genome files don't seem to incorporate the additions (ERCC and reporter genes). This might also still be a Kallisto | Bustools related issue (although the genome-additions are set-up in such a way, that in an isolated KB-workflow these files worked with building the index!).
- I tried with and without setting the `custom_assembly_suffix:`.
- The pipeline is able to run normally, I cannot trace back any of my added genes in my genome files (e.g. GRCh38_t2g.txt, listing all the genes included in the index)

My config.yaml:
```
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes
fastq_dir: ../data/CMdiff_mon-EB-EHT_d4-26_all # where to look for fastqs

# contact info for multiqc report and trackhub
email: r.snabel@science.ru.nl

# how to handle replicates
technical_replicates: merge

# scRNA options
# seq2science does currently not support scrna-seq platforms that generate more than two fastq files, such as 10xv1.
quantifier:
  kallistobus:
    ## Quantification example ##
    #count: '-x 0,8,16:0,0,8:1,0,0 --h5ad --verbose'
    #count: '-x 10XV3 --h5ad --verbose'

    ## Velocity example ##
    custom_genome_extension: ./genome_addons/ERCC92_reporter.fa
    custom_annotation_extension: ./genome_addons/ERCC92_reporter_biotype.gtf
    custom_assembly_suffix: ""_ERCC_reporter""

    ref: '--workflow lamanno'
    count: '-x 0,8,16:0,0,8:1,0,0 --h5ad --verbose --workflow lamanno'
    #count: '-x 0,8,16:0,0,8:1,0,0 --h5ad --verbose --workflow lamanno'
    #count: '-x 10XV3 --verbose --h5ad --workflow lamanno'

barcodefile: ""../1col_barcode_384.tab""
```
Output after running: 
![afbeelding](https://user-images.githubusercontent.com/56538023/102479759-99b85f80-405f-11eb-94b3-b3dab2c0db71.png)
",Rebecza,https://github.com/vanheeringen-lab/seq2science/issues/617
MDU6SXNzdWU3NzA3NjQ3MTU=,FR: better estimation memory usage of rules,CLOSED,2020-12-18T10:19:06Z,2021-09-21T21:20:50Z,2021-09-21T21:20:50Z,"**Is your feature request related to a problem? Please describe.**
Slurm on cn45 kills a process if it uses more memory than requested, that's bad!

**Describe the solution you'd like**
Better memory description per rule. We should map which rules are problematic first.
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/619
MDU6SXNzdWU3ODUxNDY4Mjk=,BUG: setuptool v50.3.1,CLOSED,2021-01-13T14:22:18Z,2021-01-26T17:13:39Z,2021-01-26T17:13:39Z,"**Describe the bug**
```
CreateCondaEnvironmentException:
Could not create conda environment from /vol/mbconda/dzijlmans/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/../envs/macs2.yaml:
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... failed

ResolvePackageNotFound:
  - anaconda::setuptools=v50.3.1
```

seems 50.3.1 is not on conda, and the version is written without the ""v"".

**To Reproduce**
Run ChIP-seq
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/622
MDU6SXNzdWU3ODUzMDA3MDc=,FR: chip-R,OPEN,2021-01-13T17:33:33Z,2021-01-13T17:33:33Z,,"**Is your feature request related to a problem? Please describe.**
Another way to combine peaks. Still have to check if it works fine, just putting it here for myself ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/624
MDU6SXNzdWU3ODY3Njg2OTk=,BUG: [chip-seq: error combine_peaks],CLOSED,2021-01-15T10:05:12Z,2021-01-20T06:56:40Z,2021-01-20T06:56:40Z,"**Describe the bug**

Pipeline worked wonderfully up until the combining of called peaks


```
Error in rule combine_peaks:
    jobid: 94
    output: /scratch/dzijlmans/DZ034/results/macs2/GRCm39_combinedsummits.bed
    log: /scratch/dzijlmans/DZ034/results/log/combine_peaks/GRCm39-macs2.log (check log file(s) for error message)
    conda-env: /vol/mbconda/dzijlmans/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/eb131cbd
    shell:

        combine_peaks -i /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-EmT-cl2-H2K27me3-1-Z16_S8_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-EmT-cl2-H2K27me3-2-Z17_S16_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-EmT-cl2-HA-1-Z14_S6_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-EmT-cl2-HA-2-Z15_S7_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-EmT-cl2-input-Z18_S11_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-Ezh2-1-Z01_S1_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-Ezh2-2-Z03_S2_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-H2K27me3-2-Z05_S12_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-HA-1-Z06_S3_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-HA-2-Z07_S13_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-Input-Z13_S10_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-Sall1-1-Z08_S4_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-Sall1-2-Z09_S14_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-Sall4-1-Z11_S15_summits.bed /scratch/dzijlmans/DZ034/results/macs2/GRCm39-DZ-R1WT-Sall4-2-Z12_S5_summits.bed -g /scratch/dzijlmans/DZ034/genomes/GRCm39/GRCm39.fa.sizes         --window 200 > /scratch/dzijlmans/DZ034/results/macs2/GRCm39_combinedsummits.bed 2> /scratch/dzijlmans/DZ034/results/log/combine_peaks/GRCm39-macs2.log

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job combine_peaks since they might be corrupted:
/scratch/dzijlmans/DZ034/results/macs2/GRCm39_combinedsummits.bed

```

**To Reproduce**
**config.yaml**
```
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes
fastq_dir: ./fastq  # where to look for or download the fastqs


# contact info for multiqc report and trackhub
email: d.zijlmans@science.ru.nl

# produce a UCSC trackhub?
create_trackhub: True

# how to handle replicates
biological_replicates: fisher  # change to ""keep"" to not combine them
technical_replicates: merge    # change to ""keep"" to not combine them

# which trimmer to use
trimmer: fastp

# which aligner to use
aligner: bwa-mem

# filtering after alignment
remove_blacklist: True
min_mapping_quality: 30
only_primary_align: True

# peak caller
peak_caller:
  macs2:
      --keep-dup 1 --buffer-size 10000
```


**samples.tsv**
```
# for help with filling out the samples.tsv:
# https://vanheeringen-lab.github.io/seq2science/content/workflows/chip_seq.html#filling-out-the-samples-tsv
# also make sure that you use tab as a delimiter
sample	assembly	descriptive_name
DZ-EmT-cl2-H2K27me3-1-Z16_S8	GRCm39	EmT-cl2-k27me3-1
DZ-EmT-cl2-H2K27me3-2-Z17_S16	GRCm39	EmT-cl2-k27me3-2
DZ-EmT-cl2-HA-1-Z14_S6	GRCm39	EmT-cl2-ha-1
DZ-EmT-cl2-HA-2-Z15_S7	GRCm39	EmT-cl2-ha-2
DZ-EmT-cl2-input-Z18_S11	GRCm39	EmT-cl2-input
DZ-R1WT-Ezh2-1-Z01_S1	GRCm39	R1WT-ezh2-1
DZ-R1WT-Ezh2-2-Z03_S2	GRCm39	R1WT-ezh2-2
DZ-R1WT-H2K27me3-2-Z05_S12	GRCm39	R1WT-k27me3-2
DZ-R1WT-HA-1-Z06_S3	GRCm39	R1WT-ha-1
DZ-R1WT-HA-2-Z07_S13	GRCm39	R1WT-ha-2
DZ-R1WT-Input-Z13_S10	GRCm39	R1WT-input
DZ-R1WT-Sall1-1-Z08_S4	GRCm39	R1WT-sall1-1
DZ-R1WT-Sall1-2-Z09_S14	GRCm39	R1WT-sall1-2
DZ-R1WT-Sall4-1-Z11_S15	GRCm39	R1WT-sall4-1
DZ-R1WT-Sall4-2-Z12_S5	GRCm39	R1WT-sall4-2
```


**log file**
```
2021-01-13 22:29:58,526 - INFO - No config found.
2021-01-13 22:29:58,526 - INFO - Creating new config.
2021-01-13 22:29:58,534 - INFO - Using included version of MDmodule.
2021-01-13 22:30:03,338 - INFO - Using system version of MEME.
2021-01-13 22:30:10,529 - INFO - Using system version of MEMEW.
2021-01-13 22:30:19,496 - INFO - Using system version of DREME.
2021-01-13 22:30:23,925 - INFO - Using system version of Weeder.
2021-01-13 22:30:27,552 - INFO - Using system version of GADEM.
2021-01-13 22:30:27,553 - INFO - Using included version of MotifSampler.
2021-01-13 22:30:31,208 - INFO - Using system version of Trawler.
2021-01-13 22:30:31,209 - INFO - Using included version of Improbizer.
2021-01-13 22:30:31,209 - INFO - Using included version of BioProspector.
2021-01-13 22:30:31,209 - INFO - Using included version of Posmo.
2021-01-13 22:30:31,210 - INFO - Using included version of ChIPMunk.
2021-01-13 22:30:31,210 - INFO - Using included version of AMD.
2021-01-13 22:30:31,210 - INFO - Using included version of HMS.
2021-01-13 22:30:34,906 - INFO - Using system version of Homer.
2021-01-13 22:30:38,629 - INFO - Using system version of XXmotif.
2021-01-13 22:30:42,224 - INFO - Using system version of ProSampler.
2021-01-13 22:30:42,224 - WARNING - Yamda not in config
2021-01-13 22:30:45,815 - INFO - Using system version of DiNAMO.
2021-01-13 22:30:53,364 - WARNING - RPMCMC not found. To include it you will have to install it.
2021-01-13 22:30:53,378 - INFO - Configuration file: /home/dzijlmans/.config/gimmemotifs/gimmemotifs.cfg
Traceback (most recent call last):
  File ""/vol/mbconda/dzijlmans/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/eb131cbd/bin/combine_peaks"", line 9, in <module>
    from gimmemotifs import __version__
  File ""/vol/mbconda/dzijlmans/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/eb131cbd/lib/python3.8/site-packages/gimmemotifs/__init__.py"", line 61, in <module>
    from . import denovo      # noqa: F401
  File ""/vol/mbconda/dzijlmans/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/eb131cbd/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 52, in <module>
    from gimmemotifs.report import create_denovo_motif_report
  File ""/vol/mbconda/dzijlmans/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/eb131cbd/lib/python3.8/site-packages/gimmemotifs/report.py"", line 19, in <module>
    from pandas.core.indexing import _non_reducing_slice
ImportError: cannot import name '_non_reducing_slice' from 'pandas.core.indexing' (/vol/mbconda/dzijlmans/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/eb131cbd/lib/python3.8/site-packages/pandas/core/indexing.py)
```

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.
",dzijlmans,https://github.com/vanheeringen-lab/seq2science/issues/625
MDU6SXNzdWU3OTU4MzY2Mjc=,`InputFunctionException in line 262 of /seq2science/lib/python3.8/site-packages/seq2science/rules/quantification.smk:,CLOSED,2021-01-28T09:39:07Z,2021-03-03T16:15:51Z,2021-03-03T16:15:51Z,"**Describe the bug**
If I run s2s (rnaseq pipeline), everything works.
However if I then add new samples to the sample.csv file, and try to rerun the workflow (to map the newly added samples), s2s rnaseq crashes:

`InputFunctionException in line 262 of /vol/mbconda/jsmits/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/quantification.smk:
IndexError: index 0 is out of bounds for axis 0 with size 0
Wildcards:
assembly=GRCh38.p13
sample=GSM438361
  File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 111, in run_jobs
  File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 402, in run
  File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 203, in _run
  File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 131, in _run
  File ""/vol/mbconda/jsmits/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 137, in printjob`

However if i rerun the pipeline with all the samples (so remove all the previously generated output), it runs withouth a problem.
This happend 2x with exactly the same error, both times I added new samples tot he sample file which caused it to crash (but run when rerunning everything).

Right now I'm running s2s with the new samples. Once this is finished ill try to generate a 2 sample sample file that can reproduce this error. This is not needed to be fixed soon, but i put this here for if somebody else encounters this. :)",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/633
MDU6SXNzdWU4MTMzMzg3NjM=,BUG: Error when running rna-seq if dataset contains multiple conditions with biological replicates,CLOSED,2021-02-22T09:57:49Z,2021-03-03T16:15:45Z,2021-03-03T16:15:45Z,"**Describe the bug**
When running seq2science rna-seq on a dataset consisting of two conditions each with two biological replicates, towards the end I get an error. The samples.tsv file contains the columns sample, assembly and descriptive_name. When I split up the dataset and ran seq2science separately per condition, it ran without any error.

``` 
Error in rule blind_clustering:
    jobid: 28
    output: /scratch/thirsa/mouse_data/rna/GSE65322/results_GSE65322/qc/clustering/GRCm38.p6-Sample_clustering_mqc.png
    log: /scratch/thirsa/mouse_data/rna/GSE65322/results_GSE65322/log/deseq2/GRCm38.p6-clustering.log (check log file(s) for error message)
    conda-env: /mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/16132cbc

RuleException:
CalledProcessError in line 92 of /mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/DGE_analysis.smk:
Command 'source /mbshome/tbrethouwer/miniconda3/envs/seq2science/bin/activate '/mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/16132cbc'; set -euo pipefail;  Rscript --vanilla /scratch/thirsa/mouse_data/rna/GSE65322/.snakemake/scripts/tmpfq41gllh.deseq2_clustering.R' returned non-zero exit status 1.
  File ""/mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 2114, in run_wrapper
  File ""/mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/DGE_analysis.smk"", line 92, in __rule_blind_clustering
  File ""/mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 529, in _callback
  File ""/mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/concurrent/futures/thread.py"", line 57, in run
  File ""/mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 515, in cached_or_run
  File ""/mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/snakemake/executors/__init__.py"", line 2199, in run_wrapper
```

The log file gives this as error:
``` 
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  unable to load shared object '/mbshome/tbrethouwer/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/16132cbc/lib/R/library/pdftools/libs/pdftools.so':
  libiconv.so.2: cannot open shared object file: No such file or directory
Calls: :: ... getNamespace -> loadNamespace -> library.dynam -> dyn.load
Execution halted
```
And this is the config file:
```
# tab-separated file of the samples
samples: samples_GSE78761.tsv

# pipeline file locations
result_dir: ./results_GSE78761  # where to store results
genome_dir: /scratch/thirsa/mouse_data/genomes/  # where to look for or download the genomes
# fastq_dir: ./results/fastq  # where to look for or download the fastqs


# contact info for multiqc report and trackhub
#email:

# produce a UCSC trackhub?
create_trackhub: True

#which provider to use
provider: Ensembl

# how to handle replicates
technical_replicates: keep    # change to ""keep"" to not combine them

# which trimmer to use
trimmer: fastp

# which quantifier to use
quantifier: htseq  # or salmon or featurecounts

##### aligner and filter options are not used for the gene counts matrix if the quantifier is Salmon

# which aligner to use
aligner: hisat2

# filtering after alignment
remove_blacklist: True
min_mapping_quality: 30  # (only keep uniquely mapped reads from STAR alignments)
only_primary_align: True

##### differential gene expression analysis (optional) #####

#deseq2:
#  multiple_testing_procedure: BH
#  alpha_value: 0.1
#  shrinkage_estimator: apeglm

#contrasts:
#  - 'stage_2_1'
#  - 'stage_all_1'
```",tbret,https://github.com/vanheeringen-lab/seq2science/issues/644
MDU6SXNzdWU4MTQzMzk4OTE=,config and column names differ for replicate(s),CLOSED,2021-02-23T10:43:33Z,2021-07-08T12:40:58Z,2021-07-08T12:40:58Z,"@siebrenf this is stupid :see_no_evil: , should we make everything with or without S?

_Originally posted by @Maarten-vd-Sande in https://github.com/vanheeringen-lab/seq2science/issues/643#issuecomment-784008222_

this was referring to technical/biological_replicate (the column names) and technical/biological_replicate**s** (he config options).",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/649
MDU6SXNzdWU4MTY0NTE0ODQ=,FR: RNA-seq read duplicates,CLOSED,2021-02-25T13:46:10Z,2021-03-03T16:15:28Z,2021-03-03T16:15:28Z,"Seems the general consensus is _not_ to delete duplicate reads, as they are _generally_ due to normal expression differences.

sources:
[paper](https://www.nature.com/articles/srep25533)
[biostars](https://www.biostars.org/p/55648/)
[internetz](https://dnatech.genomecenter.ucdavis.edu/faqs/should-i-remove-pcr-duplicates-from-my-rna-seq-data/)

However, PCR duplicates _can_ still be a problem. It might be nice to identify the estimated ratio of technical:biological duplicates, which `dupRadar` could maybe do, and which we could add as custom module to the RNA-seq MULTIQC.

sources:
[dupRadar](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5073875/)
[must be added as custom module](https://github.com/ewels/MultiQC/issues/305)",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/650
MDU6SXNzdWU4MTkwNTQ1Mzc=,"BUG: can't download SRR6246000, SRR6245997, and SRR6245998",CLOSED,2021-03-01T16:49:36Z,2021-03-02T10:21:05Z,2021-03-02T10:21:05Z,"**Describe the bug**
When I download these files they get downloaded, but on the wrong path (one folder down). Not sure if specific to my computer or in general

@siebrenf could you try if downloading these samples works for you?

Potential fixes:

* upgrade prefetch
* If statement if they get downloaded on strange location
* Maybe this always happens, but we now download almost everything from ENA so we just don't realize?",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/653
MDU6SXNzdWU4MTkxODM0MjE=,BUG: `seq2science -r` doesn't output reason without `--skip-rerun`,CLOSED,2021-03-01T19:34:50Z,2021-03-03T16:15:20Z,2021-03-03T16:15:20Z,,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/654
MDU6SXNzdWU4MjQ1NDE0MTQ=,BUG: MGSCv37 assembly causes error,CLOSED,2021-03-08T13:07:58Z,2021-08-18T11:47:32Z,2021-08-18T11:47:32Z,"**Describe the bug**

```
ValueError in line 234 of /home/sande/anaconda3/envs/seq2science/lib/python3.7/site-packages/seq2science/rules/configuration_generic.smk:
unknown url type: 'na/na_genomic.gff.gz'
```

**To Reproduce**
chip-seq pipeline with `MGSCv37` assembly
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/659
MDU6SXNzdWU4MjU5NTQwMDg=,FR: fastq naming convention,CLOSED,2021-03-09T13:45:36Z,2021-04-01T16:34:48Z,2021-04-01T16:34:48Z,"**Is your feature request related to a problem? Please describe.**
Fastq files are currently made with a ""new"" extension: https://support.illumina.com/help/BaseSpace_OLH_009008/Content/Source/Informatics/BS/NamingConvention_FASTQ-files-swBS.htm ending with 001

Should we change our fqext settings? Or should we auto-detect this somehow? :thinking: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/660
MDU6SXNzdWU4MzE2NTg3MTU=,FR: markduplicates and primary align defaults,CLOSED,2021-03-15T10:19:36Z,2021-04-01T16:12:46Z,2021-04-01T16:12:46Z,"> repetitive reads (multi-mappers) should **not** be removed from the BAM. If that happens, that should change in the pipeline.
> While in general we discard them (for TF ChIP-seq) there are ways to use them, as is the case in Stefan's project.
> So they should be present in the final BAM (though marked as multi-mapper)
> This is for the BAMs though. Default setting for bigWigs should be to remove both multimappers as well as duplicates.
> The primary alignment (picked at random) will not have flag 256 set, but will have a mapq of 0

Easy enough to revert this (we changed to remove duplicates by default in 0.3.0). Not sure how we can circumvent the `mapq` problem (in that filtering for mapq seems nice)",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/664
MDU6SXNzdWU4MzM1ODc3OTQ=,BUG: edgeR normalization,CLOSED,2021-03-17T09:46:39Z,2021-04-01T16:11:55Z,2021-04-01T16:11:55Z,"**Describe the bug**
My seq2science chip-seq pipeline keeps crushing during edgeR normalization, with error messages during different kinds of normalization steps.

**config.yaml:**
```# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
genome_dir: /ceph/rimlsfnwi/data/molbio/vermeulen/hneikes/databases/genomes  # where to look for or download the genomes
fastq_dir: /scratch/hneikes/oc2/fastq/


# contact info for multiqc report and trackhub
email: h.neikes@science.ru.nl

# produce a UCSC trackhub?
create_trackhub: True

# how to handle replicates
biological_replicates: fisher  # change to ""keep"" to not combine them
technical_replicates: merge    # change to ""keep"" to not combine them

fqext1: R1_001
fqext2: R2_001

# which trimmer to use
trimmer: fastp

# which aligner to use
aligner: bwa-mem

# filtering after alignment
remove_blacklist: True
min_mapping_quality: 30
only_primary_align: True

# peak caller
peak_caller:
  macs2:
      --keep-dup 1 --buffer-size 10000
```

[mm10-macs2-TMM.log](https://github.com/vanheeringen-lab/seq2science/files/6155140/mm10-macs2-TMM.log)
[mm10-macs2-upperquartile.log](https://github.com/vanheeringen-lab/seq2science/files/6155141/mm10-macs2-upperquartile.log)
[mm10-macs2-RLE.log](https://github.com/vanheeringen-lab/seq2science/files/6155142/mm10-macs2-RLE.log)",HNeikes,https://github.com/vanheeringen-lab/seq2science/issues/666
MDU6SXNzdWU4MzM2NTQ4NzE=,FR: update docs on how to put trackhub on genome browser (which url to use),CLOSED,2021-03-17T11:05:15Z,2021-03-22T19:04:36Z,2021-03-22T18:16:59Z,see title,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/667
MDU6SXNzdWU4Mzc5NjkwNTk=,test download from SRA and ENA separately,CLOSED,2021-03-22T17:50:23Z,2022-04-16T14:32:40Z,2022-04-16T14:32:40Z,"Nice, but also not nice. ENA was down couple days, so that is annoying. However if something gets broken in ena downloading we won't realize

_Originally posted by @Maarten-vd-Sande in https://github.com/vanheeringen-lab/seq2science/pull/661#discussion_r598523126_",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/671
MDU6SXNzdWU4Mzg1NDIzNjU=,BUG: RNA-seq always wants to re-run,CLOSED,2021-03-23T09:50:58Z,2021-10-26T06:39:49Z,2021-10-26T06:39:49Z,"**Describe the bug**
I believe it is related to the `strandedness_report`. Not sure what is causing it though, it gets forced. So either the input changes (should we sort it?), or the treps are not evaluated properly. The treps params is stored as a string of the dataframe, which is bad anyways, because it skips a lot in the middle. Perhaps storing the treps param as a hash of the dataframe would work better. 

https://pandas.pydata.org/docs/reference/api/pandas.util.hash_pandas_object.html

It seemed to work before, so not sure why/how. Would be really bad if it is related to it being a `checkpoint`! :scream: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/672
MDU6SXNzdWU4NDA2ODM4MDE=,FR: version number in log,CLOSED,2021-03-25T08:22:59Z,2021-04-01T16:12:26Z,2021-04-01T16:12:26Z,"Print the version of seq2science either at the beginning or end of the run, otherwise some people get confused with what they did

kuch kuch :roll_eyes: @Rebecza ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/673
MDU6SXNzdWU4NTQ1ODUwMzI=,Q: [Problem to run any workflow because of libssl.so.1.0.0],CLOSED,2021-04-09T14:36:51Z,2021-04-13T07:45:49Z,2021-04-13T07:45:49Z,"**Question**
Hi
First of all thank you for your work, it's impressive and I am quite impatient to try it out. Unfortunately so far I have not been able to run it on the cluster (slurm) computer of my institute with the test datasets that are included in your software. I believe that the rna-seq workflow works on my own laptop but I had to stop it due to the memory consumption. 

**What have I tried**

So what I have tried so far was to install `seq2science` via conda.

On the cluster computer, I initiated the workflow for atac-seq, rna-seq and chip-seq. I will show only the config and samples files for chip-seq.
I used `seq2science init chip-seq` and it generated the config.yaml : 
```
# for help with filling out the samples.tsv:
# https://vanheeringen-lab.github.io/seq2science/content/workflows/chip_seq.html#filling-out-the-samples-tsv
# also make sure that you use tab as a delimiter
sample  assembly        descriptive_name
GSM4404624      GRCh38.p13      HEL_cell
```
and the samples.tsv: 

```
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes
# fastq_dir: ./results/fastq  # where to look for or download the fastqs


# contact info for multiqc report and trackhub
email: yourmail@here.com

# produce a UCSC trackhub?
create_trackhub: True

# how to handle replicates
biological_replicates: fisher  # change to ""keep"" to not combine them
technical_replicates: merge    # change to ""keep"" to not combine them

# which trimmer to use
trimmer: fastp

# which aligner to use
aligner: bwa-mem2

# filtering after alignment
remove_blacklist: True
min_mapping_quality: 30
only_primary_align: True

# peak caller
peak_caller:
  macs2:
      --keep-dup 1 --buffer-size 10000
```

Then I ran the workflow with `seq2science run chip-seq --cores 16`. I used for now an interactive session on our slurm since I am still testing the pipeline. 

**output**.

Here is the full output I got:

```
               ____  ____   __
              / ___)(  __) /  \
              \___ \ ) _) (  O )
              (____/(____) \__\)
                     ____
                    (___ \
                     / __/
                    (____)
   ____   ___   __   ____  __ _   ___  ____
  / ___) / __) (  ) (  __)(  ( \ / __)(  __)
  \___ \( (__   )(   ) _) /    /( (__  ) _)
  (____/ \___) (__) (____)\_)__) \___)(____)

docs: https://vanheeringen-lab.github.io/seq2science

No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
No validator found for JSON Schema version identifier 'http://json-schema.org/draft-06/schema#'
Defaulting to validator for JSON Schema version 'http://json-schema.org/draft-04/schema#'
Note that schema file may not be validated correctly.
Checking if samples are available online...
This can take some time.
Done!


CONFIGURATION VARIABLES:
samples                : /exports/humgen/jihed/seq2science/samples.tsv
benchmark_dir          : /exports/humgen/jihed/seq2science/results/benchmark
bigwig_dir             : /exports/humgen/jihed/seq2science/results/bigwigs
fastq_dir              : /exports/humgen/jihed/seq2science/results/fastq
final_bam_dir          : /exports/humgen/jihed/seq2science/results/final_bam
genome_dir             : /exports/humgen/jihed/seq2science/genomes
log_dir                : /exports/humgen/jihed/seq2science/results/log
qc_dir                 : /exports/humgen/jihed/seq2science/results/qc
result_dir             : /exports/humgen/jihed/seq2science/results
rule_dir               : /exports/humgen/jihed/miniconda3/lib/python3.6/site-packages/seq2science/rules
sra_dir                : /exports/humgen/jihed/seq2science/results/sra
trimmed_dir            : /exports/humgen/jihed/seq2science/results/fastq_trimmed
align                  : -M
aligner                : bwa-mem2
cores                  : 16
create_qc_report       : True
create_trackhub        : True
deeptools_flags        : --normalizeUsing BPM
deeptools_multibamsummary: --distanceBetweenBins 9000 --binSize 1000
deeptools_plotcorrelation: --colorMap RdYlBu_r --plotNumbers
deeptools_qc           : True
fqext                  : ['R1', 'R2']
fqsuffix               : fastq
logbase                : 2
markduplicates         : REMOVE_DUPLICATES=true -Xms4G -Xmx6G MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=999
min_mapping_quality    : 30
only_primary_align     : True
peak_caller            : {'macs2': '--keep-dup 1 --buffer-size 10000'}
peak_windowsize        : 100
remove_blacklist       : True
slop                   : 100
trimmer                : fastp
layout:                : {'GSM4404624': 'PAIRED'}



Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 16
Rules claiming more threads will be scaled down.
Provided resources: parallel_downloads=3, deeptools_limit=16, R_scripts=1, mem_gb=378
Job counts:
	count	jobs
	1	bedgraph_bigwig
	1	bedtools_slop
	1	bwa_mem2
	1	bwa_mem2_index
	1	call_peaks_all
	1	chipseeker
	1	combine_peaks
	1	combine_qc_files
	1	complement_blacklist
	1	computeMatrix
	1	coverage_table
	3	edgeR_normalization
	1	featureCounts
	1	get_genome_annotation
	1	insert_size_metrics
	4	log_normalization
	1	macs2_callpeak
	1	mark_duplicates
	4	mean_center
	1	mt_nuc_ratio_calculator
	1	multiqc
	1	onehot_peaks
	1	peak_bigpeak
	1	plotFingerprint
	1	plotProfile
	1	quantile_normalization
	1	samtools_index
	1	samtools_presort
	2	samtools_stats
	1	sieve_bam
	1	trackhub
	1	unzip_annotation
	41

[Fri Apr  9 16:15:56 2021]
rule get_genome_annotation:
    input: /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.fa
    output: /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.annotation.gtf.gz, /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.annotation.bed.gz
    log: /exports/humgen/jihed/seq2science/results/log/get_annotation/GRCh38.p13.genome.log
    jobid: 42
    benchmark: /exports/humgen/jihed/seq2science/results/benchmark/get_annotation/GRCh38.p13.genome.benchmark.txt
    wildcards: raw_assembly=GRCh38.p13
    priority: 1
    resources: parallel_downloads=1

[Fri Apr  9 16:15:56 2021]
rule complement_blacklist:
    input: /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.customblacklist.bed, /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.fa.sizes
    output: /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.customblacklist_complement.bed
    log: /exports/humgen/jihed/seq2science/results/log/complement_blacklist/GRCh38.p13.log
    jobid: 47
    benchmark: /exports/humgen/jihed/seq2science/results/benchmark/complement_blacklist/GRCh38.p13.benchmark.txt
    wildcards: assembly=GRCh38.p13


[Fri Apr  9 16:15:56 2021]
rule bwa_mem2_index:
    input: /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.fa
    output: /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/index/bwa-mem2/
    log: /exports/humgen/jihed/seq2science/results/log/bwa-mem2_index/GRCh38.p13.log
    jobid: 51
    benchmark: /exports/humgen/jihed/seq2science/results/benchmark/bwa-mem2_index/GRCh38.p13.benchmark.txt
    wildcards: assembly=GRCh38.p13
    priority: 1
    resources: mem_gb=100

gtfToGenePred: error while loading shared libraries: libssl.so.1.0.0: cannot open shared object file: No such file or directory
Waiting at most 3 seconds for missing files.
MissingOutputException in line 30 of /exports/humgen/jihed/miniconda3/lib/python3.6/site-packages/seq2science/rules/get_genome.smk:
Job completed successfully, but some output files are missing. Missing files after 3 seconds:
/exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.annotation.gtf.gz
/exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.annotation.bed.gz
This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait.
  File ""/exports/humgen/jihed/miniconda3/lib/python3.6/site-packages/snakemake/executors/__init__.py"", line 544, in handle_job_success
  File ""/exports/humgen/jihed/miniconda3/lib/python3.6/site-packages/snakemake/executors/__init__.py"", line 231, in handle_job_success
Activating conda environment: /exports/humgen/jihed/miniconda3/lib/python3.6/site-packages/seq2science/.snakemake/8b855f2b
Activating conda environment: /exports/humgen/jihed/miniconda3/lib/python3.6/site-packages/seq2science/.snakemake/c85c1fdf
Removing temporary output file /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.customblacklist.bed.
[Fri Apr  9 16:16:22 2021]
Finished job 47.
1 of 41 steps (2%) done
/usr/bin/bash: line 1: 177755 Killed                  bwa-mem2 index -p /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/index/bwa-mem2/GRCh38.p13 /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.fa > /exports/humgen/jihed/seq2science/results/log/bwa-mem2_index/GRCh38.p13.log 2>&1
[Fri Apr  9 16:20:01 2021]
Error in rule bwa_mem2_index:
    jobid: 51
    output: /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/index/bwa-mem2/
    log: /exports/humgen/jihed/seq2science/results/log/bwa-mem2_index/GRCh38.p13.log (check log file(s) for error message)
    conda-env: /exports/humgen/jihed/miniconda3/lib/python3.6/site-packages/seq2science/.snakemake/c85c1fdf
    shell:

            bwa-mem2 index -p /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/index/bwa-mem2/GRCh38.p13 /exports/humgen/jihed/seq2science/genomes/GRCh38.p13/GRCh38.p13.fa > /exports/humgen/jihed/seq2science/results/log/bwa-mem2_index/GRCh38.p13.log 2>&1

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job bwa_mem2_index since they might be corrupted:
/exports/humgen/jihed/seq2science/genomes/GRCh38.p13/index/bwa-mem2/
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message



  __    __    __  ____  ____  _
 /  \  /  \  /  \(  _ \/ ___)/ \
(  O )(  O )(  O )) __/\___ \\_/
 \__/  \__/  \__/(__)  (____/(_)


One or more rules did not finish as expected!


Please take a look at the log files of the failed rule(s), and our Frequently Asked Questions:
https://vanheeringen-lab.github.io/seq2science/content/faq.html

If that does not help you, don't be afraid to reach out to us.
The easiest way would be to make an issue on our github page:
https://github.com/vanheeringen-lab/seq2science/issues


Complete log: /exports/humgen/jihed/seq2science/.snakemake/log/2021-04-09T161550.097805.snakemake.log
```

Note that this is a second run of the workflow after getting the same error message. I followed your advices and rerun:

```
Downloading annotation from Ensembl.
Target URL: ftp://ftp.ensembl.org/pub/release-103/gtf/homo_sapiens/Homo_sapiens.GRCh38.103.gtf.gz...

Could not download annotation for GRCh38.p13 from Ensembl
If you think the annotation should be there, please file a bug report at:
https://github.com/vanheeringen-lab/genomepy/issues


Something went wrong while downloading the genome (see error message above). When this happens it is almost always because we had troubles connecting to theservers hosting the genome assemblies. Usually this is resolved by just running seq2scienceagain, either immediately or in a couple hours.

If the problem persists you could try running `seq2science clean` and see if that resolves the issue
```
and I also tried the `seq2science clean` and it didn't help. I think the problem is here:

`gtfToGenePred: error while loading shared libraries: libssl.so.1.0.0: cannot open shared object file: No such file or directory`

And it probably comes from our slurm computer but I have no idea how to fix it. If you have any idea how to get it to work it would be super nice!

Thanks! 

Jihed",JihedC,https://github.com/vanheeringen-lab/seq2science/issues/680
MDU6SXNzdWU4NTY3NDMxOTA=,BUG: Workflow not running ,OPEN,2021-04-13T08:54:04Z,2021-04-21T12:13:31Z,,"Hi,

I have been trying to run the chip-seq workflow of seq2science. It starts but stops when 7% of the jobs are done.
```
seq2science --version
seq2science: v0.5.1
```

**To Reproduce**
Please include your **config.yaml**, your **samples.tsv**, and the complete/relevant **output**.

Both `config.yaml` and `samples.tsv` were generated from `seq2science init chip-seq`
- config.yaml: 
```
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes
# fastq_dir: ./results/fastq  # where to look for or download the fastqs


# contact info for multiqc report and trackhub
email: yourmail@here.com

# produce a UCSC trackhub?
create_trackhub: true

# how to handle replicates
biological_replicates: fisher  # change to ""keep"" to not combine them
technical_replicates: merge    # change to ""keep"" to not combine them

# which trimmer to use
trimmer: fastp

# which aligner to use
aligner: bwa-mem2

# filtering after alignment
remove_blacklist: true
min_mapping_quality: 30
only_primary_align: true

# peak caller
peak_caller:
  macs2:
      --keep-dup 1 --buffer-size 10000

## differential gene expression analysis
#contrasts:
#  - 'descriptive_name_all_HEL'
```

- samples.tsv : 

```
# for help with filling out the samples.tsv:
# https://vanheeringen-lab.github.io/seq2science/content/workflows/chip_seq.html#filling-out-the-samples-tsv
# also make sure that you use tab as a delimiter
sample  assembly        descriptive_name
GSM4404624      hg38    HEL
```

I get several error messages, I include the complete log file:
[seq2science.2021-04-13T103059.065792.log](https://github.com/vanheeringen-lab/seq2science/files/6302389/seq2science.2021-04-13T103059.065792.log)


The log file in `seq2science/results/log/bwa-mem2_index/hg38.log`:
```
Looking to launch executable ""/exports/humgen/jihed/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/7fa92a1c/bin/bwa-mem2.avx"", simd = .avx
Launching executable ""/exports/humgen/jihed/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/7fa92a1c/bin/bwa-mem2.avx""
[bwa_index] Pack FASTA... 18.78 sec
* Entering FMI_search
init ticks = 204386466299
ref seq len = 6199501436
binary seq ticks = 136647971146
```

Those are the files I got in the genome folder:

```
(seq2science) jchouaref@res-hpc-exe028:/exports/humgen/jihed/seq2science/genomes/hg38$ tree
.
 hg38.annotation.bed.gz
 hg38.annotation.gtf.gz
 hg38.fa
 hg38.fa.fai
 hg38.fa.sizes
 hg38.gaps.bed
 index
 README.txt
 tmpevip0jtt

```

Do you think the problem comes from there?
",JihedC,https://github.com/vanheeringen-lab/seq2science/issues/681
MDU6SXNzdWU4NTgyMTE4Mzk=,BUG: Warning: the following output files of rule get_genome_support_files were not present when the DAG was created:,CLOSED,2021-04-14T19:47:40Z,2021-05-27T12:06:43Z,2021-05-27T12:06:43Z,"**Describe the bug**
Seems like genomepy automatically makes the .fa.sizes file? @siebrenf is this likely? I can test somewhere these days with the --until flag",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/682
MDU6SXNzdWU4NjM2MDg2NjE=,FR: markdups on pre-sieve,CLOSED,2021-04-21T08:52:34Z,2021-10-04T10:13:50Z,2021-10-04T10:13:50Z,"**Is your feature request related to a problem? Please describe.**

Samtools stats reports, among many other things, the number of duplicates for a sample. However when duplicates have not been marked, this will be reported as **no duplicates**. Better to mark duplicates on the pre-sieve, so both samtools stats have the proper number of duplicates. This is especially relevant when removing duplicate reads
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/686
MDU6SXNzdWU4NjU5NzkxOTI=,BUG: Complete log file is incomplete,OPEN,2021-04-23T10:29:02Z,2021-05-18T10:50:10Z,,"**Describe the bug**
The (more detailed) errors thrown by the pipeline are not documented in the complete log files generated at the end of the run.

I want to trace back what the cause of the errors was, in the complete logger produced at the end. For instance, the detailed description of the rule that fails or the detailed statements in the raised `CalledProcessError` exception, these can not be found back. 

**Screenshots**
An example of my error:

![afbeelding](https://user-images.githubusercontent.com/56538023/115857061-87936700-a42d-11eb-97e0-ffa13e8d1296.png)


And this is the only information that can be found in the complete log `seq2science.2021-04-22T120203.500592.log`:

![afbeelding](https://user-images.githubusercontent.com/56538023/115857951-a6dec400-a42e-11eb-9d08-47cbd93d6b55.png)
",Rebecza,https://github.com/vanheeringen-lab/seq2science/issues/688
MDU6SXNzdWU4ODk5ODQ4NjU=,BUG: {allsizes} as empty file in working dir,CLOSED,2021-05-12T11:25:50Z,2021-06-21T12:50:49Z,2021-06-21T12:50:49Z,"**Describe the bug**
Seems to be a side-effect fo the size filtering",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/696
MDU6SXNzdWU4OTQxODk0OTQ=,FR: KITE workflow ,CLOSED,2021-05-18T09:43:27Z,2021-06-18T09:46:20Z,2021-06-18T09:46:20Z,"**Is your feature request related to a problem? Please describe.**
Add support for feature barcode extraction with [KITE](https://github.com/pachterlab/kite) to process scRNA datatsets that contain additional features, such as antibody barcodes. 

**Describe the solution you'd like**
Slight variation of the kb-count workflow by first creating a mismatch fasta and t2g for antibody features before starting the kb workflow. Essentially, reads are mapped  simultaneously against the mismatch index and genome index to obtain transcript/antibody counts. 
",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/697
MDU6SXNzdWU4OTQyNTAxNTY=,FR: add explanation to rna-seq clustering,CLOSED,2021-05-18T10:55:23Z,2021-06-21T10:31:10Z,2021-06-21T10:31:10Z,"**Is your feature request related to a problem? Please describe.**
![image](https://user-images.githubusercontent.com/15323399/118639210-eef7c900-b7d7-11eb-8179-e9cc224119a6.png)

```
log_counts <- varianceStabilizingTransformation(dds, blind = TRUE)
sampleDistMatrix <- as.matrix(dist(t(assay(log_counts))))
```

> dds contains the counts, which are then transformed.
> Next, a distance matrix is computed with dist https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/dist

Explanation in layman's terms should be added :point_up: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/698
MDU6SXNzdWU4OTQyNjAwMDc=,FR: more RNA-seq clusterings,CLOSED,2021-05-18T11:07:35Z,2021-09-17T10:53:02Z,2021-09-17T10:53:02Z,"Pearsson, Spearman. Good time to review the clustering code as well.
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/699
MDU6SXNzdWU4OTY0NjI5NDY=,FR: Improving seq2science explain,CLOSED,2021-05-20T08:15:31Z,2021-07-08T12:39:37Z,2021-07-08T12:39:37Z,"First of all, the `seq2science explain` option is awesome.  Saves a lot of time writing the methods section, really appreciated!

I do have some suggestions for improvement (ATAC-seq workflow):
* Change the writing style to be consistent: *we aligned* versus *were aligned*. Passive style is OK for methods, change everything to consistently use passive style.
* Change `with options ''` to `with default options`.\
* `And finally we made a count table from the conensus [...]` -> `Finally, a count table was made from the consensus [...]`
* Change http://broadinstitute.github.io/picard to paper reference
* `with 'config[slop]' ` -> change to value from the config.",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/701
MDU6SXNzdWU5MDcyMjcyMDQ=,BUG: kb count failing but s2s does not register,CLOSED,2021-05-31T08:19:20Z,2021-06-21T10:51:31Z,2021-06-21T10:51:31Z,"**Describe the bug**
kallistobus count fails, but does not give an error code. @Rebecza has logs of this. @Rebecza proposed to check if in the logfile some keyword is present, and if so, fail/succeed based on that. Should be easy to implement. Another option would be to actually fix kb-python, but that is more involved, and will only work once they release that fix.
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/707
MDU6SXNzdWU5MDgwOTkyODM=,BUG: get_workflow seems bugged,CLOSED,2021-06-01T09:31:34Z,2021-07-05T09:22:36Z,2021-07-05T09:22:36Z,"**Describe the bug**
It definitely does not always give back the workflow.... :thinking: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/709
MDU6SXNzdWU5MDk2MzE2NzU=,BUG: '-j' is not in list,CLOSED,2021-06-02T15:35:45Z,2021-10-01T11:59:07Z,2021-10-01T11:59:07Z,"**Describe the bug**
running a workflow with a `profile` causes an error in this line:
`cores_index = cli_call.index(""--cores"" if ""--cores"" in cli_call else ""-j"")`

**Screenshots**
![image](https://user-images.githubusercontent.com/48289046/120509459-cfac8e80-c3c8-11eb-8e5c-a893d3a957a4.png)
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/711
MDU6SXNzdWU5MDk2NzE3ODE=,FR: auto-formatting,CLOSED,2021-06-02T16:21:28Z,2023-05-02T18:18:36Z,2023-05-02T18:18:36Z,"**what**
Would we like to implement a pre-commit hook/test step which performs formatting?

**how**
Snakemake's own version of `black`,  `snakefmt`, is working in most cases.
By running it on 1 file at a time, cryptic errors are slightly more clear.

example with a line-length of 122 (arbitrary, but we've used it because of pycharm)
```
mamba install snakefmt

for file in seq2science/rules/*; do 
  snakefmt -l 122 $file
done
```
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/712
MDU6SXNzdWU5MTAzNzcwMDI=,FR: better DESeq2 plotCorrelation colors,CLOSED,2021-06-03T10:59:42Z,2021-10-28T12:18:41Z,2021-10-28T12:18:41Z,"to correspond to the deepTools plotCorrelations a bit more:
- scale correlation scores between 0 and 1
- divergent color scale between blue and red (respectively)
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/715
MDU6SXNzdWU5MTEyMDMwODA=,BUG: deeptools & deseq2 heatmaps are not recognized by schema,CLOSED,2021-06-04T07:18:26Z,2021-06-04T07:51:26Z,2021-06-04T07:51:26Z,"**Describe the bug**

https://user-images.githubusercontent.com/15323399/120761579-a2b9c200-c515-11eb-846b-258d8fb69d4d.mp4

No explanation and the order is wrong, should be at the bottom.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/717
MDU6SXNzdWU5MTM0NTIyNTk=,BUG: unwanted # character in config.yaml,CLOSED,2021-06-07T11:34:34Z,2021-06-08T07:49:22Z,2021-06-08T07:49:22Z,"I ran an rna-seq workflow and found that my samples.tsv got overwritten and seq2science didn't use the fastq files that I had provided it with. I found out the config.yaml file generated after running seq2sience init rna-seq conatined a '#' character in the line specifying the fasq_dir. Removing this # seems to fix the issue, but maybe others have the same issue. 

![screenshot_seq2science](https://user-images.githubusercontent.com/85492803/121009754-d3f3f580-c794-11eb-9d4f-7f1a5d194957.PNG)

",Roel-Wester,https://github.com/vanheeringen-lab/seq2science/issues/718
MDU6SXNzdWU5MTU5MzQyMzM=,FR: jigv in addition to trackhub (no public sharing required!),CLOSED,2021-06-09T08:26:23Z,2022-01-14T10:38:56Z,2022-01-14T10:38:56Z,"**Is your feature request related to a problem? Please describe.**
Trackhub is awesome, and should stay. However I came across jigv, and seems nice for not having to put stuff web-accessible. You just end up with a html file

https://github.com/igvteam/igv-reports
and
https://github.com/brentp/jigv

Example: https://brentp.github.io/jigv/dn.html",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/719
MDU6SXNzdWU5MjEzMzUyMjU=,FR: DESeq2 docs,CLOSED,2021-06-15T12:18:18Z,2022-01-24T16:20:29Z,2022-01-24T16:20:29Z,"### add to docs
how to get the path to standalone script:

1. activate the seq2science conda environment
2. `which seq2science`
3. `../../lib/python3.*/site-packages/seq2science/scripts/deseq/deseq.R`

### if possible
Maybe add command `deseq2science` that links there to the startup scripts (or add this script to the conda bin if possible)
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/721
MDU6SXNzdWU5MjU1MjkzMDY=,FR: chromap support,CLOSED,2021-06-20T06:13:56Z,2022-04-16T14:32:37Z,2022-04-16T14:32:37Z,"**Is your feature request related to a problem? Please describe.**

https://github.com/haowenz/chromap

Should be a super fast aligner!",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/723
MDU6SXNzdWU5MzU1NjgwMzA=,"FR: MA plot, maybe PCA plot, of deseq into QC report",CLOSED,2021-07-02T09:00:55Z,2021-10-28T12:18:35Z,2021-10-28T12:18:35Z,"**Is your feature request related to a problem? Please describe.**
These figures are awesome, and can be missed easily currently. Nice(r) to add the to the report",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/730
MDU6SXNzdWU5NDYzNDYyMjA=,BUG: Kb-python segmentation fault,CLOSED,2021-07-16T14:29:17Z,2021-07-20T09:19:26Z,2021-07-20T09:03:35Z,"**Describe the bug**
Since updating kb-python to version 0.26+ in the newest release of s2s there seem to be multiple occurences of segmentation errors when building the kb index for velocity or quantification analyses. This does not seems to affect the kite workflow. As a result,  the scRNA workflow terminates after 2 min and leaves an empty index directory (Credits to @JGASmits for the info).

From the log file:
`ngs_tools.gtf.Segment.SegmentError: Invalid segment [68899:68899`

Potential solution:

Downgrading kb-python to 0.25.1 yields the expected results or switch to Ensembl annotation.  



**To Reproduce**
```
quantifier:
  kallistobus:
    ref: ''--workflow lamanno""
    count: '-x 1,8,16:1,0,8:0,0,0 --verbose --loom --workflow lamanno'
```

**Expected behavior**
The index should build properly.",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/735
MDU6SXNzdWU5NTg4MjYyMDY=,FR: merge technical replica's scRNAseq pipeline,CLOSED,2021-08-03T07:40:53Z,2021-08-10T12:15:50Z,2021-08-10T12:15:50Z,"It would be nice to be able to merge fastqs of technical replica's in the scRNAseq pipeline similar to how the bulk pipelines support this. Right now this isnt working yet, if i inc. a column with 'technical replica'  it complains that the values in it should be unique.
No hurry though, CAT on the fastqs and inputting those in s2s seems to work fine! 

",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/736
MDU6SXNzdWU5NjY2NTQwMjQ=,BUG: hide buttons not being made even though treps exist,CLOSED,2021-08-11T12:51:10Z,2021-10-28T12:18:26Z,2021-10-28T12:18:26Z,"**Describe the bug**
Why did we put this if statement?
https://github.com/vanheeringen-lab/seq2science/blob/master/seq2science/rules/qc.smk#L733",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/743
MDU6SXNzdWU5NzU2MTUyNTM=,FR: Merged Seurat object after kb,CLOSED,2021-08-20T13:32:05Z,2021-11-22T15:36:27Z,2021-11-22T15:36:27Z,"**Is your feature request related to a problem? Please describe.**
To get people started on scRNA post-processing in R, it might help to have a merged counts Seurat object for all samples ""out of the box"" available in .rds format.  On top of that, it would be great to have the option to add sample-wise meta data via the samples.tsv table.

**Describe the solution you'd like**
The data loading is already partially implemented in the scRNA rmd. The meta-data definition could happen similar to DEG analysis minus the need to define a contrast.  

",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/745
I_kwDOC7SCuM48zeIj,"FR: Make it easy to work with your ""own"" assembly",CLOSED,2021-10-07T14:40:25Z,2022-02-10T15:18:00Z,2021-11-19T14:20:51Z,"**Is your feature request related to a problem? Please describe.**
It is now difficult / nearly impossible to load your own. Should we add a command, `s2s load genome` or whatever? We should experiment a bit with this",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/758
I_kwDOC7SCuM49B7vo,BUG: InputFunctionException in line 669 of trackhub,CLOSED,2021-10-12T14:50:45Z,2021-10-14T10:59:09Z,2021-10-14T10:59:09Z,"**Describe the bug**
When using technical replicates with rna-seq the strandedness inference seems bugged. It goes wrong on this line:
https://github.com/vanheeringen-lab/seq2science/blob/master/seq2science/rules/trackhub.smk#L299

```
InputFunctionException in line 669 of /home/sande/Desktop/seq2science/seq2science/rules/trackhub.smk:
KeyError: 0
Wildcards:
```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/759
I_kwDOC7SCuM49dVD9,FR: multiple inputs,CLOSED,2021-10-20T08:00:48Z,2023-05-02T18:18:46Z,2023-05-02T18:18:46Z,"**Is your feature request related to a problem? Please describe.**
If I have multiple inputs I can not add that! :sob: Each sample can have only 1 input. I could merge them as trep or whateever, but I don't want peak calling to be done on that (since that fails). Not sure what is a pretty solution for that.. :thinking: 
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/763
I_kwDOC7SCuM49dXBe,FR: maintenance,CLOSED,2021-10-20T08:09:40Z,2022-05-11T08:40:25Z,2022-05-11T08:40:25Z,"**Is your feature request related to a problem? Please describe.**
Reminder to self. 

- [ ] Documentation is sloppy with what is under samples.tsv and what is under config.yaml (e.g. keep). 
- [x] The slop parameter should be added to the config
- [x] How to interpret qc report should be updated\
- [x] Example QC report would be cewl!
- [x] Blacklist filename depends on params, otherwise you can't run e.g. rna-seq and atac-seq in parallel
- [x] get rid of the tracebacks? Just pop an error, no one cares for the traceback most of the time (configurable?)",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/764
I_kwDOC7SCuM490_N2,BUG: Chip-seq workflow is not running,CLOSED,2021-10-27T11:24:56Z,2021-11-09T08:16:51Z,2021-11-09T08:16:51Z,"Hi,

I have been trying to run the chip-seq workflow of seq2science. I am having trouble with mark_duplicates.

```r
seq2science --version
seq2science: v0.5.6
```

**To Reproduce**
Please include your **config.yaml**, your **samples.tsv**, and the complete/relevant **output**.

**config.yaml**
```r
# tab-separated file of the samples
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
genome_dir: ./genomes  # where to look for or download the genomes
fastq_dir: /data1/home/joao/chip_seq/  # where to look for or download the fastqs


# contact info for multiqc report and trackhub
email: yourmail@here.com

# produce a UCSC trackhub?
create_trackhub: true

# how to handle replicates
biological_replicates: fisher  # change to ""keep"" to not combine them
technical_replicates: merge    # change to ""keep"" to not combine them

# which trimmer to use
trimmer: fastp

# which aligner to use
aligner: bwa-mem2

# filtering after alignment
remove_blacklist: true
min_mapping_quality: 30
only_primary_align: true
remove_dups: true

# peak caller
peak_caller:
  macs2:
      --buffer-size 10000
#  genrich:
#      -y -q 0.05

## differential peak analysis
#contrasts:
#  - 'descriptive_name_all_HEL'
```

**samples.tsv**
```r
# for help with filling out the samples.tsv:
# https://vanheeringen-lab.github.io/seq2science/content/workflows/chip_seq.html#filling-out-the-samples-tsv
# also make sure that you use tab as a delimiter
sample   assembly        descriptive_name
U343HOXB2       GRCh38.p13      U343HOXB2
```

**Error Messages**

- log file
[GRCh38.p13-U343HOXB2.log](https://github.com/vanheeringen-lab/seq2science/files/7425613/GRCh38.p13-U343HOXB2.log)

- terminal output
[seq2science.2021-10-26T220457.241748.log](https://github.com/vanheeringen-lab/seq2science/files/7425649/seq2science.2021-10-26T220457.241748.log)

The log file said that there is **no space left on device** but I still have space in my server.

I hope you could help me!",XimenezJP,https://github.com/vanheeringen-lab/seq2science/issues/766
I_kwDOC7SCuM492HgK,BUG: Chip-seq workflow failing at Determining assembly providers,CLOSED,2021-10-27T16:02:09Z,2021-10-28T10:39:56Z,2021-10-28T08:46:50Z,"**Describe the bug**
The pipeline stops with a Database error when Determining assembly providers.

**To Reproduce**
Please include your **config.yaml**, your **samples.tsv**, and the complete/relevant **output**.
[config.yaml](https://github.com/vanheeringen-lab/seq2science/files/7427591/config.yaml.txt)

[samples.tsv](https://github.com/vanheeringen-lab/seq2science/files/7427595/samples.tsv.txt)

This is the log of the workflow, which contains the full error.
[seq2science.2021-10-27T173216.776923.log](https://github.com/vanheeringen-lab/seq2science/files/7427598/seq2science.2021-10-27T173216.776923.log)


**Expected behavior**
The pipeline should run without problems (if I didn't mistake something in the config.yaml /samples.tsv).

Thanks a lot for this amazin tool
",alexgilgal,https://github.com/vanheeringen-lab/seq2science/issues/767
I_kwDOC7SCuM4_LPVB,BUG: Broken assembly stats for custom reference (kb kite),CLOSED,2021-11-22T09:36:31Z,2021-11-22T15:36:06Z,2021-11-22T15:36:06Z,"**Describe the bug**
When running the kb with `--workflow kite` seq2science exits with the following key error:

```
InputFunctionException in line 618 of /vol/mbconda/tschaefers/envs/s2s/lib/python3.8/site-packages/seq2science/rules/qc.smk:
KeyError: 'fb'
Wildcards:
assembly=fb
```

**Expected behavior**
kb uses a custom set of reference transcripts, Antibody barcodes, to build the index which cannot be retrieved via Genomepy. I suspected it goes wrong in `assembly_stats_input`. The genome path for kite should be `{genome_dir}/{assembly}/index/kallistobus/kite/{assembly}.fa and there is no "".fai"" index.
",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/774
I_kwDOC7SCuM4_T8Jq,FR: IncompleteFilesException,CLOSED,2021-11-24T09:29:02Z,2022-05-30T13:00:48Z,2022-05-30T13:00:48Z,"**Is your feature request related to a problem? Please describe.**
![image](https://user-images.githubusercontent.com/15323399/143211215-eb5b42eb-6cb2-4a47-8f15-69dbd4782593.png)

We should catch the exception and make it seq2science :smile: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/777
I_kwDOC7SCuM4_jLGx,BUG: Seq2science is not creating conda environments (scRNA workflow),CLOSED,2021-11-29T15:36:22Z,2021-12-03T12:57:38Z,2021-12-03T12:57:38Z,"**Describe the bug**
This concerns the development branch. I have been testing the scRNA workflow on a couple of datasets and it appears that the workflow gets stuck on creating the conda environment for Multiqc. Can anyone reproduce that behavior for different workflows?  Dryruns work as expected. 

Could it be related to the newest Snakemake version?

`Building DAG of jobs...
Done. Now starting the real run.
Building DAG of jobs...
Creating conda environment /vol/mbconda/tschaefers/envs/s2s/lib/python3.8/site-packages/seq2science/rules/../envs/multiqc.yaml...
Downloading and installing remote packages.
`",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/784
I_kwDOC7SCuM4_u30O,FR: R `samples` read from samples.to_string in params instead of parse in R,CLOSED,2021-12-02T08:15:04Z,2023-05-02T18:19:02Z,2023-05-02T18:19:02Z,"**Is your feature request related to a problem? Please describe.**
Might be a more sustainable way of doing these things

I guess in a sense related to #537, and should fix that

Related : #788",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/790
I_kwDOC7SCuM5AB90K,FR: scRNA quality score per plate well,CLOSED,2021-12-08T10:34:11Z,2022-09-20T09:21:52Z,2022-09-20T09:21:52Z,from meeting,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/799
I_kwDOC7SCuM5AB-Ab,FR: scRNA UMAP (in MULTIQC),CLOSED,2021-12-08T10:35:00Z,2022-09-20T09:22:43Z,2022-09-20T09:22:43Z,"after
- cell cycle normalization
- simple quality filter
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/800
I_kwDOC7SCuM5AB-IK,FR: scRNA with 3 FASTAs,CLOSED,2021-12-08T10:35:31Z,2022-09-20T09:24:07Z,2022-09-20T09:24:07Z,,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/801
I_kwDOC7SCuM5AMX7T,FR: scRNA doublet detection,CLOSED,2021-12-10T15:50:24Z,2022-09-20T09:22:34Z,2022-09-20T09:22:34Z,"**Is your feature request related to a problem? Please describe.**
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/803
I_kwDOC7SCuM5CLlfa,BUG: config provider not respected,CLOSED,2022-01-21T10:55:52Z,2022-01-31T20:06:06Z,2022-01-31T20:06:06Z,"**Describe the bug**
https://vanheeringen-lab.github.io/seq2science/content/schemas.html#provider

doesn't do anything
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/813
I_kwDOC7SCuM5EXq71,BUG: inconsequential CLI changes prompt reruns,CLOSED,2022-02-22T15:31:30Z,2022-11-23T12:53:29Z,2022-11-23T12:53:29Z,"**Describe the bug**
Changing the number of cores should not prompt reruns.

I'll add other options to the list if I find them.

",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/823
I_kwDOC7SCuM5FE8FN,FR: report read length in MultiQC report,CLOSED,2022-03-03T21:38:08Z,2023-05-02T18:19:07Z,2023-05-02T18:19:07Z,"Mean read length before/after trimming, perhaps even distribution of read lengths. Read lengths are actually supported by fastp, but somehow not built-into multiqc. I think fastqc does have them. Should be an easy PR to MultiQC",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/826
I_kwDOC7SCuM5GjmgF,FR: flake8,OPEN,2022-03-28T17:11:30Z,2022-04-27T14:21:50Z,,"I dont think we're still using the tool, but if we are, we could implement it into the pyproject.toml with [this wrapper](https://dev.to/bowmanjd/using-flake8-and-pyproject-toml-with-flakehell-1cn1).
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/833
I_kwDOC7SCuM5GjsJI,FR: update pyproject.toml,OPEN,2022-03-28T17:31:30Z,2022-07-10T09:08:59Z,,"pip pyproject.toml and setuptools dont work nicely together [yet](https://stackoverflow.com/questions/71517365/pyproject-toml-wont-find-project-name-with-setuptools-python-m-build-format).

I tried to make it work, but `entry points` and `packages` aren't implemented/documented properly yet. Here's what I got so far. So at least I didn't waste my afternoon too much.

btw, use `validate-pyproject` to check the file.
```toml
[project]
name = ""seq2science""
version = ""0.7.2""
description = ""seq2science: easy pre-processing of ngs data.""
readme = ""README.md""
requires-python = "">3.6""
license = {file = ""LICENSE""}
authors = [
    {name=""Maarten van der Sande"", email=""M.vanderSande@science.ru.nl""},
    {name=""Siebren Frlich"", email=""siebrenf@science.ru.nl""}
]
keywords = [
    ""bioinformatics"",
    ""RNA-seq"",
    ""ATAC-seq"",
    ""ChIP-seq"",
    ""scRNA-seq"",
    ""scATAC-seq"",
    ""snakemake"",
]
classifiers = [
    ""Development Status :: 5 - Production/Stable"",
    ""Intended Audience :: Developers"",
    ""Intended Audience :: Science/Research"",
    ""License :: OSI Approved :: MIT License"",
    ""Operating System :: POSIX :: Linux"",
    ""Operating System :: MacOS :: MacOS X"",
    ""Programming Language :: Python"",
    ""Programming Language :: Python :: 3"",
    ""Topic :: Scientific/Engineering :: Bio-Informatics""]

packages = [""seq2science""]
package_data = ""{'seq2science':['envs/*', 'imgs/*', 'rules/*', 'schemas/*', 'schemas/*/*', 'scripts/*', 'scripts/**/*', 'workflows/*/*']}""
include_package_data = true

[project.urls]
documentation = ""https://vanheeringen-lab.github.io/seq2science""
repository = ""https://github.com/vanheeringen-lab/seq2science""
changelog = ""https://github.com/vanheeringen-lab/seq2science/blob/master/CHANGELOG.md""

[project.scripts]
seq2science = ""bin/seq2science""
deseq2science = ""bin/deseq2science""

[build-system]
requires = [""setuptools==59.4.0"", ""wheel"", ""toml""]
build-backend = ""setuptools.build_meta""

# flake8 does not support pyproject.toml (yet?!)
# [flake8] ...
```",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/834
I_kwDOC7SCuM5GnQth,check that the assembly is from Ensembl,CLOSED,2022-03-29T11:10:33Z,2023-05-02T18:20:13Z,2023-05-02T18:20:13Z,"There should be an input requirement for that the assembly is from ensembl. An input function should be able to do this right?

_Originally posted by @Maarten-vd-Sande in https://github.com/vanheeringen-lab/seq2science/pull/835#discussion_r837283713_

This could and should indeed be checked in the configuration step. Would save some stress later in the workflow.",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/836
I_kwDOC7SCuM5GnRTI,incorporate single cell DESeq2?,OPEN,2022-03-29T11:12:30Z,2022-04-27T14:21:47Z,,"Only thing worth discussing here is whether it makes sense the cluster ID is in the samples.tsv or if that should be a separate file. Idk what's easier from the user point of view. And what would be easier in the future _if_ we add this to the single cell RNA-seq workflow

_Originally posted by @Maarten-vd-Sande in https://github.com/vanheeringen-lab/seq2science/pull/830#pullrequestreview-924357606_",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/837
I_kwDOC7SCuM5HGm7O,SCTK workflow - MultiQC integration,CLOSED,2022-04-05T10:04:33Z,2022-09-20T09:15:22Z,2022-09-20T09:15:22Z,"Looks good! Based on the number of files it got a bit cleaner too :D


I googled for SCTK and MultiQC, and noticed that the SCTK authors refer to MultiQC in their paper... but don't offer integration out of the box :( 
However, some of these plots could maybe be integrated (if you feel like it, now or later). 

Examples on how to add the images to the MultiQC:

1. The MultiQC needs PNGs. PDF2PNG conversion can be done with [this R function](https://github.com/vanheeringen-lab/seq2science/blob/1ab16b258d29159970edcba3235b89ffc840d880/seq2science/scripts/deseq2/utils.R#L260).
2. PNGs are palced in the QC folder, like in this [s2s rule output](https://github.com/vanheeringen-lab/seq2science/blob/1ab16b258d29159970edcba3235b89ffc840d880/seq2science/rules/deseq2.smk#L40).
3. And the MultiQC can be [told to expect them](https://github.com/vanheeringen-lab/seq2science/blob/1ab16b258d29159970edcba3235b89ffc840d880/seq2science/rules/qc.smk#L659).
4. [Final integration step](https://github.com/vanheeringen-lab/seq2science/blob/1ab16b258d29159970edcba3235b89ffc840d880/seq2science/schemas/multiqc_config.yaml#L193) with some of Maarten's magic!

_Originally posted by @siebrenf in https://github.com/vanheeringen-lab/seq2science/pull/839#pullrequestreview-930284685_",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/840
I_kwDOC7SCuM5HoJGK,Q: should we clean up all the installed environments after a succesful run?,CLOSED,2022-04-12T11:29:21Z,2023-05-02T18:20:46Z,2023-05-02T18:20:46Z,"**Question**

Seq2science installs a couple GBs of conda envs after a run. Should we uninstall those by default on a succesful run? Could be a flag that can be turned on/off?

@siebrenf and @tilschaef what do you think?",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/843
I_kwDOC7SCuM5HtW4R,FR: dont rename samples,CLOSED,2022-04-13T09:58:19Z,2022-05-11T09:01:41Z,2022-05-11T09:01:41Z,use the [input function](https://github.com/vanheeringen-lab/seq2science/blob/7dd53f5a790188693780704c3b2540073aac7042/seq2science/rules/get_fastq.smk#L251) in the trimmer directly,siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/846
I_kwDOC7SCuM5HtbIW,FR: get mitochondrial genes from genomepy for SCTK,OPEN,2022-04-13T10:13:36Z,2022-07-10T09:08:56Z,,"```python
import genomepy

def mito_genes(annotation_path):
    ann = genomepy.annotation(annotation_path)
    gtf = ann.named_gtf
    
    # very quick, very dirty way to find the name for the mitochondrion.
    # could also try to read this from the assembly report, but that's also not perfect. 
    mt = gtf[gtf[""seqname""].str.contains(""chrM"", case=False, regex=False)][""seqname""].unique()
    if len(mt) != 1:
        mt = gtf[gtf[""seqname""].str.contains(""MT"", case=False, regex=False)][""seqname""].unique()
    if len(mt) != 1:
        mt = gtf[gtf[""seqname""].str.contains(""mito"", case=False, regex=False)][""seqname""].unique()
    if len(mt) != 1:
        mt = gtf[gtf[""seqname""].str.contains(""m"", case=False, regex=False)][""seqname""].unique()
    if len(mt) != 1:
        print(""we tried..."")
        return {}
    
    genes = set(gtf[gtf[""seqname""] == mt[0]].index)
    return genes
```",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/847
I_kwDOC7SCuM5IFjM4,BUG: Pytxi cannot checkout branch,CLOSED,2022-04-20T09:23:18Z,2022-05-11T09:01:21Z,2022-05-11T09:01:21Z,"**Describe the bug**
Seems pytxi tries to checkout a tagged commit during installation.  Is that part still necessary?
```
failed
Pip subprocess error:
  Running command git clone --filter=blob:none --quiet https://github.com/vanheeringen-lab/pytxi.git /scratch/jroubroeks/tmp/I3tJ/pip-req-build-wr4pc4tu
  WARNING: Did not find branch or tag '3522d3f', assuming revision or ref.
  Running command git checkout -q 3522d3f
  error: subprocess-exited-with-error
  
   Getting requirements to build wheel did not run successfully.
   exit code: 1
  > [83 lines of output]
      /scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/_distutils/dist.py:275: UserWarning: Unknown distribution option: 'authors'
        warnings.warn(msg)
      /scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/config/pyprojecttoml.py:102: _ExperimentalProjectMetadata: Support for project metadata in `pyproject.toml` is still experimental and may be removed (or change) in future releases.
        warnings.warn(msg, _ExperimentalProjectMetadata)
      configuration error: `project.license` must be valid exactly by one definition (2 matches found):
      
          - keys:
              'file': {type: string}
            required: ['file']
          - keys:
              'text': {type: string}
            required: ['text']
      
      DESCRIPTION:
          `Project license <https://www.python.org/dev/peps/pep-0621/#license>`_.
      
      GIVEN VALUE:
          ""MIT""
      
      OFFENDING RULE: 'oneOf'
      
      DEFINITION:
          {
              ""oneOf"": [
                  {
                      ""properties"": {
                          ""file"": {
                              ""type"": ""string"",
                              ""$$description"": [
                                  ""Relative path to the file (UTF-8) which contains the license for the"",
                                  ""project.""
                              ]
                          }
                      },
                      ""required"": [
                          ""file""
                      ]
                  },
                  {
                      ""properties"": {
                          ""text"": {
                              ""type"": ""string"",
                              ""$$description"": [
                                  ""The license of the project whose meaning is that of the"",
                                  ""`License field from the core metadata"",
                                  ""<https://packaging.python.org/specifications/core-metadata/#license>`_.""
                              ]
                          }
                      },
                      ""required"": [
                          ""text""
                      ]
                  }
              ]
          }
      Traceback (most recent call last):
        File ""/vol/mbconda/jroubroeks/anaconda3/envs/S2S/lib/python3.8/site-packages/seq2science/.snakemake/4c7e32e0/lib/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py"", line 363, in <module>
          main()
        File ""/vol/mbconda/jroubroeks/anaconda3/envs/S2S/lib/python3.8/site-packages/seq2science/.snakemake/4c7e32e0/lib/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py"", line 345, in main
          json_out['return_val'] = hook(**hook_input['kwargs'])
        File ""/vol/mbconda/jroubroeks/anaconda3/envs/S2S/lib/python3.8/site-packages/seq2science/.snakemake/4c7e32e0/lib/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py"", line 130, in get_requires_for_build_wheel
          return hook(config_settings)
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/build_meta.py"", line 177, in get_requires_for_build_wheel
          return self._get_build_requires(
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/build_meta.py"", line 159, in _get_build_requires
          self.run_setup()
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/build_meta.py"", line 174, in run_setup
          exec(compile(code, __file__, 'exec'), locals())
        File ""setup.py"", line 25, in <module>
          setup(**project)
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/__init__.py"", line 87, in setup
          return distutils.core.setup(**attrs)
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/_distutils/core.py"", line 122, in setup
          dist.parse_config_files()
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/dist.py"", line 854, in parse_config_files
          pyprojecttoml.apply_configuration(self, filename, ignore_option_errors)
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/config/pyprojecttoml.py"", line 54, in apply_configuration
          config = read_configuration(filepath, True, ignore_option_errors, dist)
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/config/pyprojecttoml.py"", line 120, in read_configuration
          validate(subset, filepath)
        File ""/scratch/jroubroeks/tmp/I3tJ/pip-build-env-lefp3hi_/overlay/lib/python3.9/site-packages/setuptools/config/pyprojecttoml.py"", line 43, in validate
          raise error from None
      ValueError: invalid pyproject.toml config: `project.license`
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
error: subprocess-exited-with-error

 Getting requirements to build wheel did not run successfully.
 exit code: 1
> See above for output.

note: This error originates from a subprocess, and is likely not a problem with pip.


CondaEnvException: Pip failed

d libprotobuf                          (00m:00s)               3 MB      3 MB/s
Finished pip                                  (00m:00s)               2 MB      2 MB/s
Finished ucsc-genepredtobed                   (00m:00s)             131 KB    142 KB/s
Finished python                               (00m:00s)              27 MB     29 MB/s
Finished genomepy                             (00m:00s)              66 KB     67 KB/s
Finished setuptools                           (00m:00s)               1 MB      1 MB/s
Finished pysocks                              (00m:00s)              28 KB     28 KB/s
Finished brotlipy                             (00m:00s)             342 KB    343 KB/s
Finished biopython                            (00m:00s)               3 MB      3 MB/s
Finished charset-normalizer                   (00m:00s)              35 KB     33 KB/s

  File ""/vol/mbconda/jroubroeks/anaconda3/envs/S2S/lib/python3.8/site-packages/snakemake/deployment/conda.py"", line 333, in create
```
",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/851
I_kwDOC7SCuM5IdMh9,FR: subsample to lowest,CLOSED,2022-04-26T08:43:07Z,2023-05-02T18:20:50Z,2023-05-02T18:20:50Z,"**Is your feature request related to a problem? Please describe.**

before we couldn't subsample to the lowest read depth since checkpoints didn't work. Now seems like it's possible. Could be quite nice :smile: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/853
I_kwDOC7SCuM5I_Nht,"error: ""The number of labels does not match the number of bam files.""",CLOSED,2022-05-03T19:36:49Z,2022-05-11T08:40:05Z,2022-05-11T08:40:05Z,"Two rules are currently failing: `multiBamSummary` and `plotFingerprint`, which both return the same error: ""The number of labels does not match the number of bam files.""
**This error also occurs on the develop branch**, and is likely involved with the sheer amount on input files (246).

_Originally posted by @siebrenf in https://github.com/vanheeringen-lab/seq2science/issues/838#issuecomment-1116485073_",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/860
I_kwDOC7SCuM5JjmS7,BUG: GRCh38.p13 with ERCC spike-in error (0.9.1),CLOSED,2022-05-12T14:26:55Z,2022-05-30T13:03:33Z,2022-05-30T13:03:33Z,"after updating to s2s 0.9.1 (or 0.9.0, same behaviour there), when running the scrna-seq with a costum extension added to the genome, e s2s crashes when making the DAG.

`
KeyError in line 26 of /vol/mbconda/jsmits/seq2science/lib/python3.8/site-packages/seq2science/workflows/scrna_seq/Snakefile:
'GRCh38.p13'
  File ""/vol/mbconda/jsmits/seq2science/lib/python3.8/site-packages/seq2science/workflows/scrna_seq/Snakefile"", line 26, in <module>
  File ""/vol/mbconda/jsmits/seq2science/lib/python3.8/site-packages/seq2science/workflows/scrna_seq/Snakefile"", line 26, in <listcomp>
`
If i remove the added extension from the config it does start to make the DAG.:

Removing the genome/ genome with extension or running s2s clean  doesnt fix the issue.

Location where i run s2s:
~/moldevbio/zhou/jsmits/scRNAseq_iPSC_iLSCs
",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/863
I_kwDOC7SCuM5K0nRL,"""velo_assay"" variable missing from scrna-prepocess when running lamanno ",CLOSED,2022-06-01T08:08:34Z,2022-09-21T10:03:27Z,2022-09-21T10:03:26Z,"When i run scrnaseq with preprocessing enabled on a velo workflow:

```

quantifier:
  kallistobus:
    ## Velocity example ##
    ref: '--workflow lamanno'
    count: '-x 1,8,16:1,0,8:0,0,0 --verbose --workflow lamanno --loom'

sc_preprocess:
   export_sce_objects: False
   run_sctk_qc: True
   sctk_data_type: cell
   use_alt_expr: True
   alt_exp_name: ""ERCC_spikein""
   alt_exp_reg: ""ERCC-*""
   sctk_mito_set: human-ensembl
   sctk_detect_mito: True
   sctk_detect_cell: False
   sctk_cell_calling: Knee

custom_annotation_extension: /ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/scRNAseq_iPSC_iLSCs/genomes/spike_in/ERC_92_name_biotype_ext.gtf
custom_genome_extension: /ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/scRNAseq_iPSC_iLSCs/genomes/spike_in/ERCC92_v2.fa
custom_assembly_suffix: ""ERCCreporter""
barcodefile: ""/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/scRNAseq/1col_barcode_384.tab""

```


It crashes due toe the ""velo_assay"" variable being empty:
(pre-processing log:)
```
replicates       <- ""FALSE""
iscite           <- ""FALSE""
isvelo           <- ""TRUE""
iskite           <- ""FALSE""
velo_assay       <- """"
use_alt_expr     <- ""FALSE""
alt_exp_name     <- """"
alt_exp_reg      <- """"
export_formats   <- """"

Wed Jun  1 09:47:31 2022 .. Preparing cell matrix from kallistobus (velocity) output!
Error in if (velo_assay == ""spliced"") { : argument is of length zero
Execution halted

```

It crashes therefore in the read_kb_counts.R script where it tries to read the velo_assay variable using:

velo_assay <- snakemake@config$sc_preprocess$velo_assay

However instead of 'spliced' or 'unspliced' it returns a """" wich causes it to crash.

I tried to look into how to fix it (i was hoping for a small PR), but the snakemake paramters are a bit of black magic to me still so i dont know where to begin. ",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/875
I_kwDOC7SCuM5LXJAs,BUG: trackhub index fails on BraLan3,CLOSED,2022-06-08T08:05:11Z,2022-06-17T12:26:18Z,2022-06-17T12:26:18Z,"**Describe the bug**

```
Error in rule trackhub_index:
    jobid: 859
    output: /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp, /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3named.gp, /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp.bed, /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/annotation.bigBed, /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/info.txt, /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/indexinfo.txt, /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/annotation.ix, /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/annotation.ixx
    log: /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/results/log/trackhub/BraLan3.index.log (check log file(s) for error message)
    conda-env: /vol/mbconda/sande/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/6ec35434c7cd8a3252c5ccc9515ee1fe
    shell:
        
            # generate annotation files
            gtfToGenePred -allErrors -ignoreGroupsWithoutExons -geneNameAsName2 -genePredExt /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.annotation.gtf /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp -infoOut=/ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/info.txt >> /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/results/log/trackhub/BraLan3.index.log 2>&1
    
            # check if gtf has gene_names > if l!=0, use gene_name, else transcript_id
            l=$(head -n 100 /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.annotation.gtf | (grep gene_name || true) | wc -l)
    
            # switch columns 1 (transcript_id) and 12 (gene_name)
            awk -v len=$l 'BEGIN { FS = ""	"" }; { if(len!=""0"") { t = $1; $1 = $12; $12 = t; print; } else { print; } }' /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp > /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3named.gp
    
            # remove lines with missing headers        
            grep -v ""^ "" /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3named.gp > /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp
    
            genePredToBed /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp.bed >> /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/results/log/trackhub/BraLan3.index.log 2>&1
    
            bedSort /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp.bed /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp.bed >> /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/results/log/trackhub/BraLan3.index.log 2>&1
    
            bedToBigBed -extraIndex=name /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.gp.bed /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/BraLan3.fa.sizes /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/annotation.bigBed >> /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/results/log/trackhub/BraLan3.index.log 2>&1
    
            # generate searchable indexes (by 1: transcriptID, 2: geneId, 8: proteinID, 9: geneName, 10: transcriptName)
            grep -v ""^#"" /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/info.txt | awk -v len=$l 'BEGIN { FS = ""	"" } ; { if(len!=""0"") {print $9, $1, $2, $8, $9, $10} else {print $1, $1, $2, $8, $9, $10} }' > /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/indexinfo.txt
    
            ixIxx /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/indexinfo.txt /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/annotation.ix /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/genomes/BraLan3/annotation.ixx >> /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/results/log/trackhub/BraLan3.index.log 2>&1
            
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 2170989

Error executing rule trackhub_index on cluster (jobid: 859, external: 2170989, jobscript: /ceph/rimlsfnwi/data/moldevbio/heeringen/sande/hourglass_atac/.snakemake/tmp.osialjk6/seq2science-859-trackhub_index). For error details see the cluster log and the log files of the involved rule(s).
```

Where the logfile outputs:

```
Error: exonFrames field is being added, but I found a gene (CAH1262852.1_6) with CDS but no valid frames.  This can happen if program is invoked with -genePredExt but no valid frames are given in the file.  If the 8th field of GFF/GTF file is always a placeholder, then don't use -genePredExt.
1 errors
```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/879
I_kwDOC7SCuM5LcViv,BUG: prefetch sometimes downloads .sralite files instead .sra,CLOSED,2022-06-09T07:33:33Z,2022-07-27T19:09:18Z,2022-07-27T19:09:18Z,"Should be fixed with a mv + glob, but quite annoying :sweat_smile: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/881
I_kwDOC7SCuM5MHczx,BUG: softmask_track_1 gets stuck,CLOSED,2022-06-20T14:31:08Z,2022-11-22T10:38:05Z,2022-11-22T10:38:04Z,"**Describe the bug**
Jenkins sometimes gets stuck on rule softmask_track_1 [rule](https://github.com/vanheeringen-lab/seq2science/blob/5c13d49417ccd76cde90aace2279effdf4928726/seq2science/rules/trackhub.smk#L128). 

http://ocimum.science.ru.nl/jenkins/blue/organizations/jenkins/seq2science/detail/PR-884/1/pipeline/
http://ocimum.science.ru.nl/jenkins/blue/organizations/jenkins/seq2science/detail/develop/250/pipeline/
http://ocimum.science.ru.nl/jenkins/blue/organizations/jenkins/seq2science/detail/develop/148/pipeline/97

**possible solutions?**
- end the rule with `pool.join()`
- add a timeout + retry
- switch from imap to async
",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/886
I_kwDOC7SCuM5MLfIL,BUG: database disk image is malformed,CLOSED,2022-06-21T08:21:18Z,2022-07-27T19:09:12Z,2022-07-27T19:09:12Z,"

```
DatabaseError in line 26 of /vol/mbconda/sande/seq2science/lib/python3.8/site-packages/seq2science/rules/../rules/configuration_generic.smk:
database disk image is malformed
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/seq2science/workflows/rna_seq/Snakefile"", line 4, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/seq2science/workflows/rna_seq/../../rules/configuration.smk"", line 10, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/seq2science/rules/../rules/configuration_generic.smk"", line 26, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/seq2science/__init__.py"", line 1, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/seq2science/util.py"", line 20, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/genomepy/__init__.py"", line 10, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/genomepy/annotation/__init__.py"", line 11, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/genomepy/annotation/mygene.py"", line 10, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/genomepy/caching.py"", line 19, in <module>
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/diskcache/core.py"", line 499, in __init__
  File ""/vol/mbconda/sande/seq2science/lib/python3.8/site-packages/diskcache/core.py"", line 666, in _execute_with_retry

```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/887
I_kwDOC7SCuM5MgvEq,BUG: barcode concatination scATAC,CLOSED,2022-06-24T11:45:28Z,2022-07-05T12:03:05Z,2022-06-27T09:45:48Z,"**Describe the bug**
When running s2s scATAC 0.9.2, the scATAC workflow doesnt correctly register the single cell barcodes. The resulting snap object thinks all reads are all from the same cell. 

**To Reproduce**
run scATAC, within the resulting sample-genome.snap.qc file:

Total number of unique barcodes:             1
TN - Total number of fragments:              12673129
UM - Total number of uniquely mapped:        12673129
SE - Total number of single ends:            68096
SA - Total number of secondary alignments:   0
PE - Total number of paired ends:            12605033
PP - Total number of proper paired:          12591166
PL - Total number of proper frag len:        12591166
US - Total number of usable fragments:       12591166
UQ - Total number of unique fragments:       12591014
CM - Total number of chrM fragments:         0


**Expected behavior**
Total number of unique barcodes should be more than 1. This was not a problem in v0.4.2 (wich is the last time i ran it completely)

Total number of unique barcodes:             203
TN - Total number of fragments:              23291720
UM - Total number of uniquely mapped:        23291720
SE - Total number of single ends:            283049
SA - Total number of secondary alignments:   0
PE - Total number of paired ends:            23008671
PP - Total number of proper paired:          22672582
PL - Total number of proper frag len:        22672582
US - Total number of usable fragments:       22672582
UQ - Total number of unique fragments:       22671984
CM - Total number of chrM fragments:         0

Up until then as far as I can find in the changelog the only alterations which might play a role:

[v0.5.1]  ""scATAC can properly use SE fastqs""
[v0.5.3]""biological_replicate"" and ""technical_replicate"" renamed to *""_replicates"" (matches between samples.tsv & config.yaml)
[v0.93] ""fixed custom assembly extensions (e.g. ERCC spike-ins) for scATAC-seq and scRNA-seq""

Potentially the replication renaming might cause some problems? Since in the scATAC workflow all replica's are different cells wich are concatinated in the snap-object. But perhaps since 0.4.2 this is shifted to a different step?

I'm currently re-running my data on 0.4.2 to see if this indeed fixes the problem for my own data. I'll send a message here once I'm sure, but my gut feeling is something with the SE fastq or the new replica names might have changed things?

Gr Jos
",JGASmits,https://github.com/vanheeringen-lab/seq2science/issues/889
I_kwDOC7SCuM5RQyve,BUG: sc post-processing currently not functional,CLOSED,2022-09-06T14:13:59Z,2022-09-20T13:11:55Z,2022-09-20T13:11:55Z,"**Describe the bug**
The single cell post processing workflow is currently broken. There seems to be some upstream issues with downloading a conda package dependency for `sctk` . Here is the error message:


```
Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... 

done
ERROR conda.core.link:_execute(699): An error occurred while installing package 'bioconda::bioconductor-gsvadata-1.30.0-r41hdfd78af_0'.
Rolling back transaction: ...working... done
class: LinkError
message:
post-link script failed for package bioconda::bioconductor-gsvadata-1.30.0-r41hdfd78af_0
location of failed script: /vol/mbconda/npelzers/seq2science-dev/lib/python3.8/site-packages/seq2science/.snakemake/88f5c1705417105ed5629ae5d5f830c8/bin/.bioconductor-gsvadata-post-link.sh
==> script messages <==
<None>
==> script output <==
stdout: /vol/mbconda/npelzers/seq2science-dev/lib/python3.8/site-packages/seq2science/.snakemake/88f5c1705417105ed5629ae5d5f830c8/share/bioconductor-gsvadata-1.30.0-0/GSVAdata_1.30.0.tar.gz: FAILED
/vol/mbconda/npelzers/seq2science-dev/lib/python3.8/site-packages/seq2science/.snakemake/88f5c1705417105ed5629ae5d5f830c8/share/bioconductor-gsvadata-1.30.0-0/GSVAdata_1.30.0.tar.gz: FAILED
/vol/mbconda/npelzers/seq2science-dev/lib/python3.8/site-packages/seq2science/.snakemake/88f5c1705417105ed5629ae5d5f830c8/share/bioconductor-gsvadata-1.30.0-0/GSVAdata_1.30.0.tar.gz: FAILED
ERROR: post-link.sh was unable to download any of the following URLs with the md5sum 5e57342f9738c89e9233117985ce82f9:
https://bioconductor.org/packages/3.14/data/experiment/src/contrib/GSVAdata_1.30.0.tar.gz
https://bioarchive.galaxyproject.org/GSVAdata_1.30.0.tar.gz
https://depot.galaxyproject.org/software/bioconductor-gsvadata/bioconductor-gsvadata_1.30.0_src_all.tar.gz

stderr:   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   409  100   409    0     0   3028      0 --:--:-- --:--:-- --:--:--  3029
100   409  100   409    0     0   3027      0 --:--:-- --:--:-- --:--:--  3007
md5sum: WARNING: 1 computed checksum did NOT match
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   153  100   153    0     0    197      0 --:--:-- --:--:-- --:--:--   197
md5sum: WARNING: 1 computed checksum did NOT match
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   153  100   153    0     0    232      0 --:--:-- --:--:-- --:--:--   232
md5sum: WARNING: 1 computed checksum did NOT match

return code: 1
```
The error also occurs when installing the `sctk` conda package manually. 

",tilschaef,https://github.com/vanheeringen-lab/seq2science/issues/894
I_kwDOC7SCuM5TW21P,UnboundLocalError: local variable 'kmer_size' referenced before assignment,CLOSED,2022-10-05T23:26:42Z,2022-10-26T10:15:21Z,2022-10-26T10:15:21Z,"Hi,

Thanks for building this great tool!
I'm trying to map some published data and I get the following error:

localrules directive specifies rules that are not present in the Snakefile:
        combine_qc_files

Building DAG of jobs...
InputFunctionException in line 158 of /home/ic2690/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/peak_calling.smk:

Error:
  UnboundLocalError: local variable 'kmer_size' referenced before assignment

Wildcards:
  assembly=galGal6
  sample=GSM3580697

Traceback:
  File ""/home/ic2690/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/peak_calling.smk"", line 154, in get_genome_size
  File ""/home/ic2690/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/rules/../rules/configuration_workflows.smk"", line 205, in get_read_length


Any guidance?",ivanferrreira,https://github.com/vanheeringen-lab/seq2science/issues/900
I_kwDOC7SCuM5T4qqC,BUG: Bigwig files not transferred to trackhub folder,CLOSED,2022-10-13T08:22:41Z,2023-05-02T18:21:06Z,2023-05-02T18:21:05Z,"After a succesful rna-seq workflow run, a trackhub is generated, but not all bigwig files are located in the `/results/trackhub/hg38/` folder. I have encountered this issue after running four different analyses. As far as I can see, no errors are raised in the log files, and all bigwig files are present in the `/results/bigwigs/` folder. This issue seems to only apply to `reverse.bigwig` files, but not _all_ `reverse.bigwig` files are missing.

Running `seq2science run rna-seq` a second time seems to fix the issue.


",jroubroeks,https://github.com/vanheeringen-lab/seq2science/issues/902
I_kwDOC7SCuM5UPMCZ,BUG: plotfingerprint has no configurable options,CLOSED,2022-10-18T13:50:01Z,2023-05-02T18:21:09Z,2023-05-02T18:21:09Z,,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/905
I_kwDOC7SCuM5VDuYQ,BUG: [The new version of `matplotlib` will lead to some bugs in some rules.],CLOSED,2022-10-28T10:19:50Z,2022-10-28T10:22:19Z,2022-10-28T10:22:19Z,"**Describe the bug**
In the `atac-seq` run, I saw that `upset_plot_peaks` and `plotHeatmap_peak` had errors, which can be solved by downgrading the `matplotlib` from `3.6` to `v3.5`.
",bioqxu,https://github.com/vanheeringen-lab/seq2science/issues/907
I_kwDOC7SCuM5Wmk-K,FR: cleanup for manuscript,OPEN,2022-11-17T08:52:23Z,2023-11-16T09:02:12Z,,"- [x] samples & config cleanup
  - [ ] download
  - [ ] alignment
  - [ ] rna
  - [ ] atac
  - [ ] chip
  - [ ] scrna
    - [ ] why kallistobus options inside quotes?
  - [ ] scatac 
- [x] example multiqc per workflow
- [ ] example trackhub 
- [ ] single cell rna-seq dag should have some of its export functions available?
- [x] documentation cleanup
  - [ ] download
  - [ ] alignment
  - [ ] rna
  - [ ] atac
  - [ ] chip
  - [ ] scrna
    - [ ] DAG is too oversimplified?
  - [ ] scatac 
- [x] update snakemake (rerunning  )
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/915
I_kwDOC7SCuM5XHOrQ,FR: python/scanpy interoperability for single cell?,CLOSED,2022-11-23T10:50:49Z,2023-05-02T18:21:24Z,2023-05-02T18:21:24Z,https://satijalab.org/seurat/archive/v2.4/conversion_vignette.html,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/921
I_kwDOC7SCuM5XH87d,FR: single cell auto detection if droplet or cell based barcodes?,CLOSED,2022-11-23T12:48:47Z,2023-05-02T18:21:27Z,2023-05-02T18:21:27Z,Could be done based on chemistry?,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/922
I_kwDOC7SCuM5XH-Ax,"BUG: qc_scRNA rules dont use params, so rerunning doesn't work",OPEN,2022-11-23T12:51:59Z,2022-11-23T12:51:59Z,,see title,Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/923
I_kwDOC7SCuM5XMoaB,FR: single cell RNA filtering,OPEN,2022-11-24T08:09:48Z,2022-11-24T08:09:48Z,,"Filtering would give much more sensible resutls/figures later on

https://camplab.net/sctk/v2.7.1/articles/01_import_and_qc_tutorial.html#filtering",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/924
I_kwDOC7SCuM5YVTI5,Issue with Chip-seq pipeline: jobid: 27: one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!,CLOSED,2022-12-07T13:50:39Z,2023-01-17T13:14:17Z,2023-01-03T13:33:26Z,"**Question**
Hi There, I am trying to test out the chip-set pipeline using a single sample of paired end data but the workflow keeps failing at a specific point with the following error:

Activating conda environment: ../opt/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/6824310427e127c1e8fdddc2f1df8a12
/bin/bash: line 1: shuf: command not found
[Wed Dec  7 15:20:57 2022]
Error in rule random_subset_peaks:
    jobid: 27
    output: /Users/jerolen/my_project2/results/qc/computeMatrix_peak/GRCh38-macs2_N20000.bed
    conda-env: /Users/jerolen/opt/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/6824310427e127c1e8fdddc2f1df8a12
    shell:
        
        shuf -n 20000 /Users/jerolen/my_project2/results/macs2/GRCh38_combinedsummits.bed | bedtools slop -i stdin -g /Users/jerolen/my_project2/genomes/GRCh38/GRCh38.fa.sizes -b 1000 > /Users/jerolen/my_project2/results/qc/computeMatrix_peak/GRCh38-macs2_N20000.bed
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)



**What have I tried**
I have tried changing the alignment tool from bwa to hisat2 with no luck. Any advice would be greatly appreciated as I am completely out of depth on the coding side of things.  config.yaml, samples.tsv and export of terminal attached. Thank you. 

[config-yaml.txt](https://github.com/vanheeringen-lab/seq2science/files/10176584/config-yaml.txt)
[samples.txt](https://github.com/vanheeringen-lab/seq2science/files/10176614/samples.txt)
[Terminal Saved Output-Jerolen-Seq2SCience-chipseq.txt](https://github.com/vanheeringen-lab/seq2science/files/10176624/Terminal.Saved.Output-Jerolen-Seq2SCience-chipseq.txt)
",Jerolen,https://github.com/vanheeringen-lab/seq2science/issues/939
I_kwDOC7SCuM5ZbYkd,Q: Stuck with initialisation of a workflow (atac-seq),CLOSED,2022-12-16T14:46:15Z,2023-05-02T18:22:01Z,2023-05-02T18:22:00Z,"**Question**
We are trying to analyze atacseq data from 36 samples. As a trial I wanted to test if this workflow would work on f.e. the first four samples. of which the first three are biological repeats. I can start the workflow, but I simply don't understand the error I get...

**What have I tried**
Here you can find the config and samples file (I had to convert them to .txt to be able to upload it here. I also screenshotted the folder structure. Thanks in advance!!! 

<img width=""1038"" alt=""Screenshot 2022-12-16 at 15 45 13"" src=""https://user-images.githubusercontent.com/120733874/208123307-cbb6a3b8-9a33-4ab6-a638-545a9ee2416d.png"">

[seq2science.2022-12-16T153021.745497.log](https://github.com/vanheeringen-lab/seq2science/files/10246652/seq2science.2022-12-16T153021.745497.log)
[samples.txt](https://github.com/vanheeringen-lab/seq2science/files/10246674/samples.txt)



[config.txt](https://github.com/vanheeringen-lab/seq2science/files/10246662/config.txt)
s://github.com/vanheeringen-lab/seq2science/files/10246660/samples.txt)
",WouterVGKULEUVEN,https://github.com/vanheeringen-lab/seq2science/issues/941
I_kwDOC7SCuM5aA_KR,BUG: Problem with the Initiation,CLOSED,2022-12-24T23:28:37Z,2023-02-27T15:51:06Z,2023-02-27T15:51:05Z,"**Describe the bug**
I have tried to initiate the rna-seq analysis but I am getting the following error message:

Traceback (most recent call last):
  File ""/data1/home/joao/miniconda3/envs/seq2science/bin/seq2science"", line 6, in <module>
    from seq2science.cli import seq2science_main
  File ""/data1/home/joao/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/__init__.py"", line 1, in <module>
    from . import util
  File ""/data1/home/joao/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/util.py"", line 21, in <module>
    import genomepy
  File ""/data1/home/joao/miniconda3/envs/seq2science/lib/python3.8/site-packages/genomepy/__init__.py"", line 10, in <module>
    from genomepy.annotation import Annotation, query_mygene
  File ""/data1/home/joao/miniconda3/envs/seq2science/lib/python3.8/site-packages/genomepy/annotation/__init__.py"", line 11, in <module>
    from genomepy.annotation.mygene import _map_genes, query_mygene
  File ""/data1/home/joao/miniconda3/envs/seq2science/lib/python3.8/site-packages/genomepy/annotation/mygene.py"", line 10, in <module>
    from genomepy.caching import cache_exp_short, disk_cache
  File ""/data1/home/joao/miniconda3/envs/seq2science/lib/python3.8/site-packages/genomepy/caching.py"", line 19, in <module>
    disk_cache = Cache(directory=genomepy_cache_dir)
  File ""/data1/home/joao/miniconda3/envs/seq2science/lib/python3.8/site-packages/diskcache/core.py"", line 478, in __init__
    self.reset(key, value, update=False)
  File ""/data1/home/joao/miniconda3/envs/seq2science/lib/python3.8/site-packages/diskcache/core.py"", line 2433, in reset
    ((old_value,),) = sql(
sqlite3.OperationalError: database is locked

I also tried seq2science clean and got the same error message!
",XimenezJP,https://github.com/vanheeringen-lab/seq2science/issues/942
I_kwDOC7SCuM5hFqYS,FR: Use temporary directories for sra and temporary fastq files,OPEN,2023-03-17T08:04:07Z,2023-03-22T09:40:02Z,,"Useful pipeline you have here ;)

**Is your feature request related to a problem? Please describe.**

When working on an NFS-mounted systsem, it seems like downloading sra and converting to fastq files is taking longer than needed or expected. In addition, IO becomes very slow on that NFS system to the point that it's noticable in other applications and while working on the command-line. My (lightly tested) hunch is that this happens when SRA files are converted to FASTQ as, this means reading and writing to disk with potentially many parallel processes. Most likely, you will not want to keep the SRA files anyway. 

**Describe the solution you'd like**

I think this could be solved by using `$TMPDIR` with the snakemake `tmpdir` resource and/or [shadow rules](https://snakemake.readthedocs.io/en/stable/snakefiles/rules.html#shadow-rules). However, you may have already tried this, and refrained from implementing due to other issues that occur. 

*If* this would be relevant, it would maybe also make sense to couple the SRA and the FASTQ rules, so that the SRA file is only used internal to the rule, and can be kept on the temporary fileystem and be deleted when the rule successfully finishes. Downside is that you may have duplicated code, as the SRA download would be copied. On the other hand, this could also be implemented in a bash script, which then could be re-used. 

Would this be worth considering (I'd be happy to supply a PR)? ",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/961
I_kwDOC7SCuM5hFtY8,BUG: Incorrect SRA files (RNA-seq),CLOSED,2023-03-17T08:14:03Z,2023-03-22T14:20:17Z,2023-03-22T14:20:17Z,"**Describe the bug**

Some SRA files are incorrect (either due to submitter not supplying correct files, or SRA not having correct annotation). For example, this file:
[SRR18972600](https://trace.ncbi.nlm.nih.gov/Traces/?view=run_browser&acc=SRR18972600&display=metadata) (GSM6077643). This marked as PE, but `fastq-dump` only gets one fastq file.

**To Reproduce**

RNA-seq workflow, with the following `samples.tsv`:

```
sample  assembly
GSM6077643     GRCh38
```

**Expected behavior**
I don't know! Either an informative error message (i.e. two fastq files should be there, there's only one, this can be checked) or the file being treated as single-end. The second option may not be correct, and I assume this may also be hard to implement. I would guess an error message would already be good, because the error is not easily identifiable from the log, but only when you manually repeat the steps.

One thing I noticed that these are not sequenced with Illumina, but with DNBSEQ-G400. 

Low priority bug I would say, but something to be aware of.

",simonvh,https://github.com/vanheeringen-lab/seq2science/issues/962
I_kwDOC7SCuM5jTSGA,BUG: [scATAC-seq successful run but bam file and snap object are missing cell barcodes],CLOSED,2023-04-13T08:52:21Z,2023-04-13T09:19:10Z,2023-04-13T09:19:09Z,"**Describe the bug**
Hi, I have used the scATAC-seq pipeline with sci-ATAC-seq input data. Although the run was indicated to be successful, the final bam file is missing cell barcodes and we think that makes the snap object contain 0 barcodes as well.

**Expected behavior**
We expected the final bam file to have cell barcodes and the snap object to at least contain cell barcodes. The pipeline should indicate that something goes wrong if this is the case.

**Screenshots**
Bam file compared to a bam file generated by Cellranger from 10X. The top bamfile is the bamfile where no cell barcodes can be observed.
![no_cell_barcode](https://user-images.githubusercontent.com/130648255/231705610-47f8ef40-5406-452b-8ee9-9492e52817fd.PNG)

**Snapatac QC file**
```
Total number of unique barcodes:             0
TN - Total number of fragments:              0
UM - Total number of uniquely mapped:        0
SE - Total number of single ends:            0
SA - Total number of secondary alignments:   0
PE - Total number of paired ends:            0
PP - Total number of proper paired:          0
PL - Total number of proper frag len:        0
US - Total number of usable fragments:       0
UQ - Total number of unique fragments:       0
CM - Total number of chrM fragments:         0
```

**Seq2science log file**

```
             ____  ____   __              
            / ___)(  __) /  \             
            \___ \ ) _) (  O )            
            (____/(____) \__\)            
                   ____                   
                  (___ \                  
                   / __/                  
                  (____)                  
   ____   ___  __  ____  __ _   ___  ____ 
  / ___) / __)(  )(  __)(  ( \ / __)(  __)
  \___ \( (__  )(  ) _) /    /( (__  ) _) 
  (____/ \___)(__)(____)\_)__) \___)(____)

workflow: scatac-seq
version:  0.9.7
docs:     https://vanheeringen-lab.github.io/seq2science


Checking if seq2science was run already, if something in the configuration was changed, and if so, if seq2science needs to re-run any jobs.
Checking if samples are available online... This can take some time.
Done!


| config variable              | value                                                                                                   |
|:-----------------------------|:--------------------------------------------------------------------------------------------------------|
| samples                      | /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/rna_seq_dev_cornea/seq2science_config/samples_atac.tsv |
| fastq_dir                    | /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/fastq                                 |
| final_bam_dir                | /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam                 |
| genome_dir                   | /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/genomes                               |
| log_dir                      | /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log                       |
| qc_dir                       | /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc                        |
| aligner                      | bwa-mem2                                                                                                |
| bam_sort_order               | coordinate                                                                                              |
| bam_sorter                   | samtools                                                                                                |
| bin_opt                      | --bin-size-list 5000 --verbose=True                                                                     |
| cores                        | 8                                                                                                       |
| create_qc_report             | True                                                                                                    |
| deeptools_computematrix_gene | --beforeRegionStartLength 3000 --regionBodyLength 5000 --afterRegionStartLength 3000                    |
| deeptools_multibamsummary    | --distanceBetweenBins 9000 --binSize 1000                                                               |
| deeptools_plotcorrelation    | --colorMap RdYlBu_r --plotNumbers                                                                       |
| deeptools_qc                 | True                                                                                                    |
| fqext                        | ['R1', 'R2']                                                                                            |
| fqsuffix                     | fastq                                                                                                   |
| markduplicates               | -Xms4G -Xmx6G MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=999                                                    |
| snaptools_opt                | --min-flen=0 --max-flen=1000 --keep-single=FALSE --keep-secondary=FALSE --overwrite=True --min-cov=100  |
|                              | --verbose=True                                                                                          |
| trimmer                      | fastp                                                                                                   |
| layout                       | sample       layout                                                                                     |
|                              | -----------  --------                                                                                   |
|                              | SRR11692131  PAIRED                                                                                     |



Building DAG of jobs...
Done. Now starting the real run.
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 8
Rules claiming more threads will be scaled down.
Provided resources: parallel_downloads=3, genomepy_downloads=1, deeptools_limit=16, R_scripts=1, mem_gb=1007
Singularity containers: ignored
Job stats:
job                        count    min threads    max threads
-----------------------  -------  -------------  -------------
bwa_mem2                       1              7              7
create_SNAP_object             1              4              4
create_bins_SNAP_object        1              1              1
insert_size_metrics            1              1              1
mark_duplicates                1              1              1
mt_nuc_ratio_calculator        1              1              1
multiqc                        1              1              1
multiqc_explain                1              1              1
plotFingerprint                1              8              8
sambamba_sort                  1              2              2
samtools_index                 1              1              1
samtools_presort               1              1              1
samtools_stats                 1              1              1
seq2science                    1              1              1
total                         14              1              8

Select jobs to execute...
[Mon Apr  3 11:23:19 2023]

group job c306b865-e71f-4a86-b583-48eddc8b7f8e (jobs in lexicogr. order):

    [Mon Apr  3 11:23:19 2023]
    rule bwa_mem2:
        input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/fastq_trimmed/SRR11692131_R1_trimmed.fastq.gz, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/fastq_trimmed/SRR11692131_R2_trimmed.fastq.gz, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/genomes/hg38/index/bwa-mem2
        output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/bwa-mem2/hg38-SRR11692131.samtools-coordinate.pipe (pipe)
        log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/bwa-mem2_align/hg38-SRR11692131.log
        jobid: 7
        benchmark: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/benchmark/bwa-mem2_align/hg38-SRR11692131.benchmark.txt
        wildcards: assembly=hg38, sample=SRR11692131
        threads: 7
        resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp, mem_gb=40


    [Mon Apr  3 11:23:19 2023]
    rule samtools_presort:
        input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/bwa-mem2/hg38-SRR11692131.samtools-coordinate.pipe
        output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/bwa-mem2/hg38-SRR11692131.samtools-coordinate-unsieved.bam
        log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/samtools_presort/hg38-SRR11692131.log
        jobid: 6
        benchmark: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/benchmark/samtools_presort/hg38-SRR11692131.benchmark.txt
        wildcards: assembly=hg38, sample=SRR11692131
        resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp, mem_gb=2

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/dc86c926309679daf0585ef4a495f01b_
Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/c3593d0fd24408183d1c9249cd3edfee_
[Mon Apr  3 19:07:56 2023]
Finished job 7.
[Mon Apr  3 19:07:57 2023]
Finished job 6.
2 of 14 steps (14%) done
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/fastq_trimmed/SRR11692131_R1_trimmed.fastq.gz.
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/fastq_trimmed/SRR11692131_R2_trimmed.fastq.gz.
Select jobs to execute...

[Mon Apr  3 19:07:59 2023]
rule multiqc_explain:
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/workflow_explanation_mqc.html
    jobid: 16
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp

[Mon Apr  3 19:07:59 2023]
rule mt_nuc_ratio_calculator:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/bwa-mem2/hg38-SRR11692131.samtools-coordinate-unsieved.bam, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/genomes/hg38/hg38.fa.sizes
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/bwa-mem2/hg38-SRR11692131.samtools-coordinate-unsieved.bam.mtnucratiomtnuc.json
    jobid: 17
    wildcards: assembly=hg38, sample=SRR11692131
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp, time=0-06:00:00

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/374337caf0c2b050871552b86176b450_

[Mon Apr  3 19:07:59 2023]
rule mark_duplicates:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/bwa-mem2/hg38-SRR11692131.samtools-coordinate-unsieved.bam
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/markdup/hg38-SRR11692131.samtools-coordinate.metrics.txt
    log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/mark_duplicates/hg38-SRR11692131.log
    jobid: 5
    benchmark: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/benchmark/mark_duplicates/hg38-SRR11692131.benchmark.txt
    wildcards: assembly=hg38, sample=SRR11692131
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp, mem_gb=8

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/c0a9d5bbf8360710f9ca026e5856f5a1_
[Mon Apr  3 19:08:14 2023]
Finished job 16.
3 of 14 steps (21%) done
[Mon Apr  3 19:25:19 2023]
Finished job 17.
4 of 14 steps (29%) done
[Mon Apr  3 21:36:33 2023]
Finished job 5.
5 of 14 steps (36%) done
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/bwa-mem2/hg38-SRR11692131.samtools-coordinate-unsieved.bam.
Select jobs to execute...

[Mon Apr  3 21:36:35 2023]
rule insert_size_metrics:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/InsertSizeMetrics/hg38-SRR11692131.tsv, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/InsertSizeMetrics/hg38-SRR11692131.pdf
    log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/InsertSizeMetrics/hg38-SRR11692131.log
    jobid: 23
    wildcards: assembly=hg38, sample=SRR11692131
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp, time=0-06:00:00


[Mon Apr  3 21:36:35 2023]
rule samtools_index:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam.bai
    jobid: 22
    wildcards: filepath=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate, b=b
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp
Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/c0a9d5bbf8360710f9ca026e5856f5a1_

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/c3593d0fd24408183d1c9249cd3edfee_

[Mon Apr  3 21:36:35 2023]
rule sambamba_sort:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.sambamba-queryname.bam
    log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/sambamba_sort/hg38-SRR11692131-sambamba_queryname.log
    jobid: 27
    benchmark: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/benchmark/sambamba_sort/hg38-SRR11692131-queryname.benchmark.txt
    wildcards: assembly=hg38, sample=SRR11692131, sorting=queryname
    threads: 2
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp, mem_gb=2

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/46d6a73b6b45bee69b97c3332ae61586_

[Mon Apr  3 21:36:35 2023]
rule samtools_stats:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/samtools_stats/bwa-mem2/hg38-SRR11692131.samtools-coordinate.samtools_stats.txt
    log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/samtools_stats/bwa-mem2/hg38-SRR11692131-samtools-coordinate.log
    jobid: 15
    wildcards: directory=bwa-mem2, assembly=hg38, sample=SRR11692131, sorter=samtools, sorting=coordinate
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp, time=0-06:00:00

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/c3593d0fd24408183d1c9249cd3edfee_
[Mon Apr  3 21:40:48 2023]
Finished job 22.
6 of 14 steps (43%) done
Select jobs to execute...
[Mon Apr  3 21:53:13 2023]
Finished job 15.
7 of 14 steps (50%) done
[Mon Apr  3 21:55:28 2023]
Finished job 23.
8 of 14 steps (57%) done
[Mon Apr  3 23:24:51 2023]
Finished job 27.
9 of 14 steps (64%) done

[Mon Apr  3 23:24:51 2023]
rule create_SNAP_object:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.sambamba-queryname.bam, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/genomes/hg38/hg38.fa.sizes
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/snap/hg38-SRR11692131.snap
    log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/create_SNAP_object/hg38-SRR11692131.log
    jobid: 26
    benchmark: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/benchmark/create_SNAP_object/hg38-SRR11692131.benchmark.txt
    wildcards: assembly=hg38, sample=SRR11692131
    threads: 4
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/ec22a2dac18fa0c37eacd4cb5690aa3e_
[Tue Apr  4 01:46:08 2023]
Finished job 26.
10 of 14 steps (71%) done
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.sambamba-queryname.bam.
Select jobs to execute...

[Tue Apr  4 01:46:08 2023]
rule plotFingerprint:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam.bai
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/plotFingerprint/hg38.tsv
    log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/plotFingerprint/hg38.log
    jobid: 21
    benchmark: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/benchmark/plotFingerprint/hg38.benchmark.txt
    wildcards: assembly=hg38
    threads: 8
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp, mem_gb=5

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/7fe602773e842c979f2b6238a3f2e7b2_
[Tue Apr  4 01:49:23 2023]
Finished job 21.
11 of 14 steps (79%) done
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/final_bam/hg38-SRR11692131.samtools-coordinate.bam.bai.
Select jobs to execute...

[Tue Apr  4 01:49:23 2023]
rule create_bins_SNAP_object:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/snap/hg38-SRR11692131.snap
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/snap/hg38-SRR11692131.binned.snap
    log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/create_bins_SNAP_object/hg38-SRR11692131.log
    jobid: 25
    benchmark: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/benchmark/create_SNAP_object/hg38-SRR11692131.benchmark.txt
    wildcards: assembly=hg38, sample=SRR11692131
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/ec22a2dac18fa0c37eacd4cb5690aa3e_

[Tue Apr  4 01:49:23 2023]
rule multiqc:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/header_info.yaml, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/sample_names_hg38.tsv, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/schema.yaml, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/markdup/hg38-SRR11692131.samtools-coordinate.metrics.txt, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/samtools_stats/bwa-mem2/hg38-SRR11692131.samtools-coordinate.samtools_stats.txt, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/workflow_explanation_mqc.html, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/bwa-mem2/hg38-SRR11692131.samtools-coordinate-unsieved.bam.mtnucratiomtnuc.json, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/assembly_hg38_stats_mqc.html, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/trimming/SRR11692131.fastp.json, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/plotFingerprint/hg38.tsv, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/InsertSizeMetrics/hg38-SRR11692131.tsv, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/samplesconfig_mqc.html
    output: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/multiqc_hg38.html, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/multiqc_hg38_data
    log: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/log/multiqc_hg38.log
    jobid: 1
    wildcards: assembly=hg38
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp

Activating conda environment: ../../../../../../../../vol/mbconda/imarais/miniconda3/envs/seq2science/lib/python3.8/site-packages/seq2science/.snakemake/bba3f90abab18df10069e3707ec475ee_
[Tue Apr  4 01:49:31 2023]
Finished job 25.
12 of 14 steps (86%) done
[Tue Apr  4 01:49:38 2023]
Finished job 1.
13 of 14 steps (93%) done
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/header_info.yaml.
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/sample_names_hg38.tsv.
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/schema.yaml.
Removing temporary output /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/samplesconfig_mqc.html.
Select jobs to execute...

[Tue Apr  4 01:49:38 2023]
localrule seq2science:
    input: /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/multiqc_hg38.html, /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/snap/hg38-SRR11692131.binned.snap
    jobid: 0
    resources: tmpdir=/ceph/rimlsfnwi/data/moldevbio/zhou/imarais/tmp

[Tue Apr  4 01:49:38 2023]
Finished job 0.
14 of 14 steps (100%) done
Complete log: seq2science.2023-04-03T112313.216455.log

      _
       
       (   )  --  Nice, a succesful run! Check out the docs for help with the results:
        >       https://vanheeringen-lab.github.io/seq2science/content/workflows/scatac_seq.html.
       /        Make sure to check out the QC report, it can be found at
        //    /ceph/rimlsfnwi/data/moldevbio/zhou/imarais/data/atac_seq_dev_eye/SRR11692131/qc/multiqc_hg38.html.
         _  
       //            
        //|            
       ((            
       ||
       |   )
       | |) /
         )L
       (_
```
",inesmarais,https://github.com/vanheeringen-lab/seq2science/issues/976
I_kwDOC7SCuM5jTkDg,FR: don't crash when no differential genes are found,CLOSED,2023-04-13T09:37:47Z,2023-09-15T10:09:57Z,2023-09-15T10:09:56Z,"See title. Should be fine if nothing is differential!

The MA, PCA, and volcano figures don't get made, so seq2science stops. Perhaps empty figures as an alternative? :thinking: ",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/977
I_kwDOC7SCuM5nnOoa,BUG: latest numpy version and IDR inconsistency,CLOSED,2023-06-02T14:45:40Z,2023-08-01T15:07:31Z,2023-08-01T15:07:31Z,"Hi,

First time trying this pipeline and it works very well! I had one minor setback and I was not sure under which category I should post it (I think Bug report is the best-suited?)

I was running seq2science atac-seq with two samples of two biological replicates each, using IDR to merge them, and I got this error in the log of IDR:

```
/mnt/sda/alberto/programs/miniconda3/envs/seq2science_venv/lib/python3.10/site-packages/seq2science/.snakemake/c90ff8cbd1e27eafcd9b38725c49c49c_/bin/idr --samples /mnt/sda/alberto/projects/smed_cisreg/outputs/bulk_atac/gehrke_2019/results/macs2/Smed-sample1_peaks.narrowPeak /mnt/sda/alberto/projects/smed_cisreg/outputs/bulk_atac/gehrke_2019/results/macs2/Smed-sample2_peaks.narrowPeak --output-file /mnt/sda/alberto/projects/smed_cisreg/outputs/bulk_atac/gehrke_2019/results/macs2/Smed-tail_0h_peaks.tmp.narrowPeak
Traceback (most recent call last):
  File ""/mnt/sda/alberto/programs/miniconda3/envs/seq2science_venv/lib/python3.10/site-packages/seq2science/.snakemake/c90ff8cbd1e27eafcd9b38725c49c49c_/bin/idr"", line 10, in <module>
    idr.idr.main()
  File ""/mnt/sda/alberto/programs/miniconda3/envs/seq2science_venv/lib/python3.10/site-packages/seq2science/.snakemake/c90ff8cbd1e27eafcd9b38725c49c49c_/lib/python3.10/site-packages/idr/idr.py"", line 846, in main
    r1, r2 = build_rank_vectors(merged_peaks)
  File ""/mnt/sda/alberto/programs/miniconda3/envs/seq2science_venv/lib/python3.10/site-packages/seq2science/.snakemake/c90ff8cbd1e27eafcd9b38725c49c49c_/lib/python3.10/site-packages/idr/idr.py"", line 299, in build_rank_vectors
    return ( numpy.array(rank1, dtype=numpy.int),
  File ""/mnt/sda/alberto/programs/miniconda3/envs/seq2science_venv/lib/python3.10/site-packages/seq2science/.snakemake/c90ff8cbd1e27eafcd9b38725c49c49c_/lib/python3.10/site-packages/numpy/__init__.py"", line 305, in __getattr__
    raise AttributeError(__former_attrs__[attr])
AttributeError: module 'numpy' has no attribute 'int'.
`np.int` was a deprecated alias for the builtin `int`. To avoid this error in existing code, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
The aliases was originally deprecated in NumPy 1.20; for more details and guidance see the original release note at:
    https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations. Did you mean: 'inf'?
```

I went to the `idr.py` script and found the offending line. I manually replaced any reference to `np.int` for `int` and it seems to be working well. I know this is related to IDR (they have an issue here https://github.com/nboley/idr/issues/64 ) where they suggest working with a previous version of numpy. I just wanted to notify this in case there is something that could be done on your end, like keeping numpy on a previous version until this is fixed (although I do not know how this would interfere with the rest of your code...) . Otherwise it works great! looking forward to give it an in-depth try with our samples in the future :)

Keep up the good work! Thanks!

Alberto",apposada,https://github.com/vanheeringen-lab/seq2science/issues/995
I_kwDOC7SCuM53JCJf,BUG: download_fastq report error,CLOSED,2023-11-17T11:11:14Z,2023-11-19T11:44:17Z,2023-11-19T11:44:17Z,"**Describe the bug**
I saw your publication yesterday and now I am trying your tool now. I met the first error with the work flow of download-fastq

**To Reproduce**
(1) My ""samples.tsv"" is very simple, and only contains the following lines:

# for help with filling out the samples.tsv:
# https://vanheeringen-lab.github.io/seq2science/content/workflows/download_fastq.html#filling-out-the-samples-tsv
# also make sure that you use tab as a delimiter
sample
SRR8984523

(2) My ""config.yaml"" has the following lines:

# tab-separated file
samples: samples.tsv

# pipeline file locations
result_dir: ./results  # where to store results
# fastq_dir: (default is inside result_dir) # where to download the fastqs

fqsuffix: fastq
fqext1: R1
fqext2: R2

(3)  This is the command that I run the workflow

seq2science run download-fastq  --cores 4

**Expected behavior**
During the process of executing this workflow, I checked that there was a file being generated in the result folder and then size kept growing.  At the end of the procedure,  the file was automatically deleted and error was reported. 
 
**Screenshots**
If applicable, add screenshots to help explain your problem.  I have attached the log file as the attachment 
[seq2science.2023-11-16T223515.101184.log](https://github.com/vanheeringen-lab/seq2science/files/13390909/seq2science.2023-11-16T223515.101184.log)

",bioinfolabmu,https://github.com/vanheeringen-lab/seq2science/issues/1016
I_kwDOC7SCuM533yjw,BUG: [config.yaml error],OPEN,2023-11-26T16:48:22Z,2023-11-29T09:39:24Z,,"**Describe the bug**
My raw pair-end FASTQ data has the name like this 

Sample1_Treat2_Replicate1_1.fq.gz
Sample1_Treat2_Replicate1_2.fq.gz

In my configuration file, I have the following entries:

fqsuffix: fq
fqext1: _1
fqext2: _2

Consequently, the program was looking for file named Sample1_Treat2_Replicate1__1.fq.gz  (# two underscore symbol, instead of one)
Then, I modified the configuration file as 

fqsuffix: fq
fqext1: 1
fqext2: 2

Next, I got this error.

Error validating config file.
ValidationError: 1 is not of type 'string'

Failed validating 'type' in schema['properties']['fqext1']:
    OrderedDict([('description',
                  'filename suffix when handling paired-end data, '
                  'describing the forward read'),
                 ('default', 'R1'),
                 ('type', 'string')])

On instance['fqext1']:
    1


",bioinfolabmu,https://github.com/vanheeringen-lab/seq2science/issues/1018
I_kwDOC7SCuM54LIzl,Combining STAR and Salmon,OPEN,2023-11-29T09:39:57Z,2023-12-11T08:26:27Z,,"              When I run my own data for alignment with Star, I encountered a bug.  I am debugging now to see what happens.  I noticed that Salmon as the quantifier tool, is not affected at all.   It generates its own data.  This means that Salmon is using his own alignment tool to finish the quantification itself.  My next question is that, after I fixed the bug of running star,  how can I connect the start alignment results to feed salmon for qunatification?

_Originally posted by @bioinfolabmu in https://github.com/vanheeringen-lab/seq2science/issues/1018#issuecomment-1829909916_
            ",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/1019
I_kwDOC7SCuM54LQFr,STAR 2-pass alignment,OPEN,2023-11-29T09:56:52Z,2023-11-29T10:08:38Z,,"              I remembered that I read somewhere, you do not support 2-pass start alignemnt yet.  What is your recommendation if we want to do the two passes, and then come back to Seq2science again?

_Originally posted by @bioinfolabmu in https://github.com/vanheeringen-lab/seq2science/issues/1018#issuecomment-1829941131_
            ",siebrenf,https://github.com/vanheeringen-lab/seq2science/issues/1020
I_kwDOC7SCuM54p_Xz,Q: [Comparative RNA-Seq analysis],OPEN,2023-12-04T16:36:54Z,2023-12-05T09:53:33Z,,"**Question**
We are comparing different aligners and quantifiers to see their impacts on the same RNA-Seq raw data.  Of course, it took long time to run one run.  My guess is that we do not have to re-run the every step in the RNA-seq pipeline, but only re-run a few step that we want to compare. 

For example, I want to use different qualtifier (Salmon versus htseq).  

**What have I tried**
I have finished running the pipeline and htseq, and I have not start the downstream differential analysis.  Now, I want to modify the config.yaml file to use salmon as the quantifier.  My question is that both quantifier results should be saved in my results folder.  They are not conflicting to each other, right?  Then, next step, is to bring back the differential analysis part of pipeline to finish the salmon-based DEG results and htseq-based results.  

My questions is that all these results can be saved in the same ""results"" folder and let config.yaml to tell which one quantifier to use for DEG analysis. right.  Or, I should run entirely pipeline again seperately?

Thank you for your attention and help. 
",bioinfolabmu,https://github.com/vanheeringen-lab/seq2science/issues/1021
I_kwDOC7SCuM55Ogyc,Q: [DEG analysis contrast],OPEN,2023-12-09T13:17:48Z,2023-12-11T08:44:33Z,,"**Question**
From your document, it seems that you can only use one factor to do the contrast in differential gene expression analysis.
What if we need to combine two factors?

**What have I tried**

In my ""samples.tsv"", I have two different developmental stages. Each stage has three different treatments.  Each treatment has 3 biological samples.  

I know that I can do:

contrasts:
  - stages_4_5
  - treatments_Control_Treatment1

How about contrasts:  (stages 4 treatement 1) vs (stages 5 treatment 1)  or different combination of both factors?

stages | treatments

4 | Control
4 | Control
4 | Control
4 | Treatment1
4 | Treatment1
4 | Treatment1
4 | Treatment2
4 | Treatment2
4 | Treatment2
4 | Treatment3
4 | Treatment3
4 | Treatment3
5 | Control
5 | Control
5 | Control
5 | Treatment1
5 | Treatment1
5 | Treatment1
5 | Treatment2
5 | Treatment2
5 | Treatment2
5 | Treatment3
5 | Treatment3
5 | Treatment3

Thank you for your attention
",bioinfolabmu,https://github.com/vanheeringen-lab/seq2science/issues/1022
I_kwDOC7SCuM59C1M8,BUG: chipseeker is broken (again),CLOSED,2024-01-24T10:03:13Z,2024-02-06T10:02:26Z,2024-02-06T10:02:26Z,"```
Error: package or namespace load failed for ChIPseeker in loadNamespace(j <- i[[1L]], c(lib.loc, .libPaths()), versionCheck = vI[[j]]):
 namespace igraph 1.4.2 is being loaded, but >= 1.5.0 is required
Execution halted
```",Maarten-vd-Sande,https://github.com/vanheeringen-lab/seq2science/issues/1023
I_kwDOC7SCuM6AsMiG,FR: [DEG by Salmon],OPEN,2024-02-28T14:14:37Z,2024-02-28T14:14:37Z,,"**Is your feature request related to a problem? Please describe.**
When I run seq2science with Salmon as the quantifier for differential gene expression analysis, I got the result where the gene names such as FGF2 with its counts among all samples.  Unfortunately, many genomes have a lot of genes only have gene id (ENSGALG00000011835) with no gene name.  These entries will be discarded by current default setting of salmon with seq2science. 

**Describe the solution you'd like**
Can we use gene_id so that we will not miss any count data?

**(optional) Additional context**
Another possible way to do it is use ""ENSGALG00000011835|FGF2"" for entry with both gene Id and name, and ""ENSGALG00000011835"" for entry only have gene id.

Your help will be highly appreciated
",bioinfolabmu,https://github.com/vanheeringen-lab/seq2science/issues/1026
I_kwDOC7SCuM6VmUcD,BUG: Authentication plugin 'mysql_native_password' cannot be loaded,OPEN,2024-09-06T08:35:06Z,2024-09-21T10:29:17Z,,"I try to run the RNA-seq pipeline, but got this message:

```
Seq2science has trouble querying the assembly providers. Try again in a bit.
To see the error stack trace run seq2science with --debug.
```

Rerun with debug last output:

```
2059 (HY000): Authentication plugin 'mysql_native_password' cannot be loaded: /usr/lib/mysql/plugin/mysql_native_password.so: cannot open shared object file: No such file or directory
```

Do we need to update mysql? 

Best regards Leif",Leif78,https://github.com/vanheeringen-lab/seq2science/issues/1027
I_kwDOC7SCuM6jdQyN,BUG: Cyclic dependency on rule samtools_sort,OPEN,2024-12-16T13:10:09Z,2024-12-17T16:55:10Z,,"**Describe the bug**
I am getting an error from seq2science alignment pipeline

snakemake.exceptions.CyclicGraphException: Cyclic dependency on rule samtools_sort.

CyclicGraphException in rule samtools_sort in file /work/project/oob-biom/bsbii-tools/conda/envs/seq2science/lib/python3.10/site-packages/seq2science/rules/bam_cleaning.smk, line 206:
Cyclic dependency on rule samtools_sort.

**To Reproduce**
seq2science run alignment  --cores 12


Here are my ziped config and samle files :

[config.zip](https://github.com/user-attachments/files/18150384/config.zip)
[samples.zip](https://github.com/user-attachments/files/18150399/samples.zip)

Not sure if it's a bug or I misconfigured something.

Thanks !",VDaric,https://github.com/vanheeringen-lab/seq2science/issues/1028
