id,title,state,created_at,updated_at,closed_at,body,user,url
I_kwDOJx9SaM5tZXlF,update DiffBind rule to work,CLOSED,2023-08-03T16:21:39Z,2023-08-03T16:41:37Z,2023-08-03T16:22:50Z,Completed with [487945f](https://github.com/OpenOmics/chrom-seek/commit/487945fd2804c60cf73101d9845fc6d9c2e69482) and [de0906b](https://github.com/OpenOmics/chrom-seek/commit/de0906bafadfe46d0d4cf58f4d3944bb2c0e6273) commits,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/2
I_kwDOJx9SaM5tZcTv,update UROPA rule to work for cfChIP assay: basic functional cfChIP pipeline,CLOSED,2023-08-03T16:35:25Z,2023-08-04T15:28:49Z,2023-08-04T15:28:49Z,This is step completes basic functional pipeline for cfChIP. ,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/3
I_kwDOJx9SaM5tfcw1,test out bulk ChIP-seq assay part of the pipeline,CLOSED,2023-08-04T15:31:15Z,2023-08-09T16:01:58Z,2023-08-09T16:01:58Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/4
I_kwDOJx9SaM5tfdlw,comment/document pipeline rules,OPEN,2023-08-04T15:33:51Z,2023-08-04T15:33:51Z,,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/5
I_kwDOJx9SaM5tfd1a,add genrich to ATAC assay,CLOSED,2023-08-04T15:34:38Z,2023-08-09T15:59:35Z,2023-08-09T15:59:35Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/6
I_kwDOJx9SaM5t40YB,test ChIP-seq assay with mm10 references,CLOSED,2023-08-09T16:17:00Z,2023-08-15T14:20:51Z,2023-08-15T14:20:51Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/7
I_kwDOJx9SaM5t40aC,test ChIP-seq assay with hg38 references,CLOSED,2023-08-09T16:17:05Z,2023-08-10T20:47:40Z,2023-08-10T20:47:40Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/8
I_kwDOJx9SaM5uFSrQ,Script to build new reference files,OPEN,2023-08-11T14:00:33Z,2023-08-11T14:00:45Z,,"It would be awesome if we had a script to automate the process of building reference files for different/new organisms, something where we could give it a minimal set of inputs (such as a genomic fasta file, annotation, and an optional blacklist, etc.) and it would handle the rest.
",skchronicles,https://github.com/OpenOmics/chrom-seek/issues/9
I_kwDOJx9SaM5uFTGc,Write script for new genome reference builds,CLOSED,2023-08-11T14:01:43Z,2023-08-11T14:03:34Z,2023-08-11T14:03:34Z,,tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/10
I_kwDOJx9SaM5uFVTn,Build docker image for pipeline,OPEN,2023-08-11T14:07:40Z,2023-08-11T14:08:05Z,,"At the current moment, the pipeline is using environment modules. We need to build docker images for all the software dependencies of the pipeline.
```[tasklist]
### Tasks
```
",skchronicles,https://github.com/OpenOmics/chrom-seek/issues/11
I_kwDOJx9SaM5uXvb-,set up pipeline to work with RheMac10 references,CLOSED,2023-08-15T16:00:03Z,2023-08-17T15:55:18Z,2023-08-17T15:55:18Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/12
I_kwDOJx9SaM5ulXnd,add other peakcallers: macsBroad and sicer,CLOSED,2023-08-17T16:02:58Z,2023-08-23T15:51:19Z,2023-08-23T15:51:19Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/13
I_kwDOJx9SaM5vAEGH,Add Homer_motif rule,OPEN,2023-08-22T22:29:18Z,2024-12-09T17:55:49Z,,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/14
I_kwDOJx9SaM5vAENO,add FRiP rule,CLOSED,2023-08-22T22:29:52Z,2023-08-30T19:13:59Z,2023-08-30T19:13:58Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/15
I_kwDOJx9SaM5vAEpw,add a few extra cfChIP rules,CLOSED,2023-08-22T22:32:06Z,2023-09-11T21:28:04Z,2023-09-11T21:28:03Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/16
I_kwDOJx9SaM5yNcWN,Adjust pipeline to work with single-end sequencing data for ChIP,CLOSED,2023-09-27T18:42:11Z,2023-11-07T15:39:55Z,2023-11-07T15:39:55Z,,asyakhl,https://github.com/OpenOmics/chrom-seek/issues/17
I_kwDOJx9SaM5y1NlN,Peak calling with samples lacking input controls,CLOSED,2023-10-04T16:06:54Z,2023-11-10T17:13:26Z,2023-11-10T17:13:25Z,Sicer kills the dry-run when there are samples lacking input controls.,tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/18
I_kwDOJx9SaM5zqZU_, ppqt rule needs improved fix,CLOSED,2023-10-12T17:46:56Z,2023-11-07T15:42:28Z,2023-11-07T15:42:28Z,"Currently using this code as a fix for ppqt rule to run the chrom-seek pipeline, but need to find a more straightforward solution.
```python
 if paired_end:
    extensionsPPQT={""sorted"": ""bam"", ""Q5DD"":""bam""}
else:
    extensionsPPQT= {""sorted"": ""bam"", ""tagAlign"": ""gz"", ""Q5DD"": ""tagAlign.gz""}
``` ",asyakhl,https://github.com/OpenOmics/chrom-seek/issues/19
I_kwDOJx9SaM5z86vE,Empty test files,CLOSED,2023-10-16T14:28:17Z,2023-11-14T15:35:40Z,2023-11-13T23:29:04Z,"Hi,

I'm trying to test the pipeline using the test files but all files on https://github.com/OpenOmics/chrom-seek/tree/main/.tests are empty except the the peakcall.tsv and the contrasts.tsv. Can you have some working test files in the github?

Best",prc992,https://github.com/OpenOmics/chrom-seek/issues/20
I_kwDOJx9SaM50fQBG,SICER2 does not support rheMac10 out of the box,OPEN,2023-10-20T13:56:48Z,2023-10-20T14:02:15Z,,"SICER2 has information pertaining to genome chromosome lengths hard-coded in the following file:
https://github.com/zanglab/SICER2/blob/master/sicer/lib/GenomeData.py

To add support for a new reference genome, a user must do the following:
![image](https://github.com/OpenOmics/chrom-seek/assets/18038345/b01b52c1-14c0-4c33-9264-89e98d3d209e)

I emailed the author of SICER2 asking if it would be possible to implement any of the suggestions [here](https://github.com/zanglab/SICER2/issues/23). It is worth also noting, if one were to make these changes, one should also update the `dtype` set for `chr`. At the current moment, it is set to `U6` or a unicode string of length 6, which may not be long enough in some edge-cases (could cause a string to get truncated and cause collisions). 

For the time being, we will turn off sicer2 when the reference genome is rheMac10; however, we should explore other solutions if the author cannot implement this on their side:
 - Fork and add functionality described in issue 23
 - Fork, update `sicer/lib/GenomeData.py` with rheMac10 information and build docker image

",skchronicles,https://github.com/OpenOmics/chrom-seek/issues/21
I_kwDOJx9SaM59jWiG,Missing R package due to singularity sharing filesystems from host,CLOSED,2024-01-29T21:01:47Z,2024-02-27T20:46:50Z,2024-02-27T20:45:37Z,"## About

The following issue was discovered while running [`run_spp.R from ppqt`](https://github.com/kundajelab/phantompeakqualtools.git):
![image](https://github.com/OpenOmics/chrom-seek/assets/18038345/3dea7206-a436-4ea6-a7e3-242dbf8f17fe)

The error indicates that the R package, caTools, was missing from the docker image. Initially, I could not reproduce this behavior, and from my side, it appeared that caTools was installed:
```bash
$ module purge
$ ml singularity
$ singularity exec -B $PWD /data/OpenOmics/SIFs/ppqt_v0.2.0.sif Rscript -e 'library(caTools); sessionInfo()'

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] caTools_1.18.2

loaded via a namespace (and not attached):
[1] compiler_4.1.2 bitops_1.0-7  
```

After more debugging, it appeared that I could reproduce the error if I `module load R` before running singularity:
```bash
$ module purge
$ module load R
$ ml singularity
$ singularity exec -B $PWD /data/OpenOmics/SIFs/ppqt_v0.2.0.sif Rscript -e 'library(caTools); sessionInfo()'

Error in library(caTools) : there is no package called ‘caTools’
Execution halted
```

It appears the following environment variable, `R_LIBS_SITE`, is exported when R is module loaded into a user's $PATH. If that environment variable is set, that will update what .libPaths R internally uses to find R packages. This can cause issues with how the R installation within the docker image finds/loads packages.

The following can be used to fix the problem.
```bash
$ module purge
$ module load R
$ ml singularity
$ R_LIBS_SITE='' singularity exec -B $PWD /data/OpenOmics/SIFs/ppqt_v0.2.0.sif Rscript -e 'library(caTools); sessionInfo()'
...
```

However, it would be better to run singularity with the `--containall, -C option`. This would prevent this problem in the future and other issues that can occur from sharing filesystems and env variables with the host.
",skchronicles,https://github.com/OpenOmics/chrom-seek/issues/28
I_kwDOJx9SaM59r3YF,Update behavior --peakcall parser and validation,OPEN,2024-01-30T19:57:25Z,2024-01-30T19:57:31Z,,"## About

Make the following changes to how the `--peakcall PEAKCALL` file is parsed and validated: 
1. Update the names of the following columns:
    a. ""ChIP"" becomes ""Sample""
    b. ""Input"" becomes ""InputControl""
2. InputControl becomes an optional column.
    a. Only ""Sample"" and ""Group"" should be required
3. Documentation on the CLI and wiki should be updated to include the changes and made to encompass both ATAC and ChIP",skchronicles,https://github.com/OpenOmics/chrom-seek/issues/29
I_kwDOJx9SaM6BUFuc,DiffBind block,CLOSED,2024-03-05T15:29:13Z,2024-10-28T18:23:51Z,2024-10-28T18:23:51Z,DiffBind with blocking currently errors out. This causes both DiffBind block and regular DiffBind to fail within the pipeline. Error seems to be that the csv file being used does not contain the blocking information.,tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/31
I_kwDOJx9SaM6BV-V6,Add rerun triggers to run sub command,OPEN,2024-03-05T19:46:26Z,2024-03-05T19:46:31Z,,"### Add `--rerun-trigger` to run sub command

This adds a mechanism to control how snakemake decides what rules to re-run. By default, this option is set to the following: `['mtime', 'params', 'input', 'software-env', 'code']` which can cause upstream rules to re-run unexpectedly. 

Add something to the docs stating if this occurs, then this should be set to `--rerun-trigger mtime`. This allows for the user to decide how/why rules are re-run.


",skchronicles,https://github.com/OpenOmics/chrom-seek/issues/32
I_kwDOJx9SaM6BWB1-,Additional functionality for cfChIP,CLOSED,2024-03-05T19:56:14Z,2024-09-17T13:20:09Z,2024-09-17T13:20:09Z,"The new features to be added to the cfChIP assay include:

1. Run a DiffBind R script on all ""ChIP"" samples to:
      - Identify consensus peaks, produce bed file
      - Get normalized  counts per sample
      - Get UMAP coordinates based upon this information
2. Annotate consensus peaks with uropa
3. Run Amos's specialized differential RMD
4. If only one group per sample and all samples have a group, create UMAP plot
  ",tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/33
I_kwDOJx9SaM6Bmydz,Add FRIP heatmap plot,CLOSED,2024-03-07T17:52:50Z,2024-10-28T18:24:47Z,2024-10-28T18:24:46Z,"[FRIP_plot.txt](https://github.com/OpenOmics/chrom-seek/files/14528132/FRIP_plot.txt)

Incorporate Subrata's code into the pipeline",tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/34
I_kwDOJx9SaM6HjHob,ATAC ppqt,CLOSED,2024-05-01T20:18:22Z,2024-09-17T13:19:32Z,2024-09-17T13:19:32Z,"For ATAC part,

ppqt can fail causing a lot of downstream issues which can lead to bigwigs not being made. If this not necessary for bigwig formation, this should be removed.

Paul",schaughencyp,https://github.com/OpenOmics/chrom-seek/issues/39
I_kwDOJx9SaM6HjJX6,ATAC Conditional Rules,CLOSED,2024-05-01T20:24:12Z,2024-09-17T13:17:55Z,2024-09-17T13:17:55Z,"For ATAC,

The following can be considered to probably be conditional when running the pipeline:

1. Between macs2 and Genrich- Genrich should be default, macs2 should be conditional
2. Between edgeR and deseq2 in the Diffbind rules - Deseq2 should be default, edgeR should be conditional.
3. Motif analysis (MEME/Homer? rules) could probably be conditional for ATAC.
4. Between genes, prot, protsec, protTSS - I think only prot needs to run by default. This should be a selection as the number of total jobs is ballooning in certain circumstances.

These are suggestions not demands,

Paul

",schaughencyp,https://github.com/OpenOmics/chrom-seek/issues/40
I_kwDOJx9SaM6Tc8KY,split DiffBind and DiffBind block into two separate runs so Diffbind block errors don't make the DiffBind results disappear,CLOSED,2024-08-19T17:24:09Z,2024-10-28T18:26:21Z,2024-10-28T18:26:21Z,,rroutsong,https://github.com/OpenOmics/chrom-seek/issues/43
I_kwDOJx9SaM6W3jvF,ppqt related issues,OPEN,2024-09-17T13:17:41Z,2024-12-09T16:47:39Z,,"ppqt fails under a variety of conditions, relating to the underlying data.

This currently breaks:
1. macs peak calling
2. bigwig creation
3. multiQC reporting
(potentially more)

We need to:
1. Let multiQC still run even when ppqt errors out.
2. Have the ppqt rule's .txt output still be created with just the number 200 inside.
3. (Optional) Make ppqt a required input only for SE samples for macs (narrow and broad) and bigwig creation.
",tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/46
I_kwDOJx9SaM6aWy7I,Updating format of the sample sheet,OPEN,2024-10-15T19:23:10Z,2024-10-18T18:06:30Z,,"# About

Let's rename the `Input` column to `Input_Control` and make it an optional column (for ATAC-seq). The name `Input` for ChIP samples could causes some confusion for users who are not experienced with ChIP-seq. We will also need to update any references in the docs/help command to reflect these changes.",skchronicles,https://github.com/OpenOmics/chrom-seek/issues/47
I_kwDOJx9SaM6a27d1,Workaround in case raw fastqs are gone and new contrasts are needed.,OPEN,2024-10-18T17:55:51Z,2024-10-18T17:55:51Z,,"Goal: to make it possible to run new contrasts without using the chrom-seek run command (so as to avoid needing the raw fastqs)

Plan:
Have a script that takes in the current config.json, a new peakcall file, and a new contrast file and produce an updated config.json so that a user can just run the kickoff script without involving the chrom-seek run command",tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/48
I_kwDOJx9SaM6geo7F,Merge DiffBind and Uropa outputs with the attached functions,OPEN,2024-11-25T21:56:47Z,2024-12-09T16:47:31Z,,"```r
prepDiffBind <- function(DiffBindFile) {
  inDiffBindData <- read.delim(DiffBindFile)
  DiffBindData <- inDiffBindData[order(inDiffBindData$seqnames,inDiffBindData$start),]
  DiffBindData$peak_id <- paste0(""Peak"",1:nrow(DiffBindData))
  return(DiffBindData)
}

loadAndMerge <- function(DiffBindFile, UropaFile) {
  DiffBindData <- prepDiffBind(DiffBindFile)
  UropaData <- read.delim(UropaFile)
  MergedData <- merge(DiffBindData,UropaData)

  #which(MergedData$end != MergedData$peak_end)
  #names(MergedData)
  #[1] ""peak_id""           ""seqnames""          ""start""             ""end""              
  #[5] ""width""             ""strand""            ""Conc""              ""Conc_D5pos4""      
  #[9] ""Conc_D5neg4""       ""Fold""              ""p.value""           ""FDR""              
  #[13] ""Called1""           ""Called2""           ""peak_chr""          ""peak_start""       
  #[17] ""peak_end""          ""peak_score""        ""peak_strand""       ""feature""          
  #[21] ""feat_start""        ""feat_end""          ""feat_strand""       ""feat_anchor""      
  #[25] ""distance""          ""relative_location"" ""feat_ovl_peak""     ""peak_ovl_feat""    
  #[29] ""gene_id""           ""gene_name""         ""gene_type""         ""name""

  MergedData2 <- MergedData[order(MergedData$FDR,decreasing = F),
                            c(2:5,1,8:10,12,21:26,29:32)]
  return(MergedData2)
}

FilterMerged <- function(MergedData2,FDRcutoff=0.05,FoldCutoff=0) {
  MergedDataFDR <- MergedData2[which(MergedData2$FDR < FDRcutoff),]
  MergedDataFiltered <- MergedDataFDR[which((MergedDataFDR$Fold > FoldCutoff) | 
                                            (MergedDataFDR$Fold) < -(FoldCutoff)),]
  return(MergedDataFiltered)
}

``` ",tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/55
I_kwDOJx9SaM6iNvxJ,bug fix: cannot complete one run where some samples have input controls and some don't,OPEN,2024-12-05T21:55:13Z,2024-12-09T17:02:57Z,,"Rule ""inputnorm"" errors out in the dry-run when some samples have input controls and some don't",tovahmarkowitz,https://github.com/OpenOmics/chrom-seek/issues/56
