id,title,state,created_at,updated_at,closed_at,body,user,url
MDU6SXNzdWUyNjkyMTg3ODY=,Attach seqlengths to mapToTranscripts() return value,CLOSED,2017-10-27T19:59:05Z,2018-02-04T23:33:29Z,2018-02-04T23:33:29Z,"The result of `mapToTranscripts()` treats the transcripts as the sequences. We know the lengths of the transcripts, but these are not carried over into the result. We should probably do that. I would be happy to help review this change, if desired.
",lawremi,https://github.com/Bioconductor/GenomicFeatures/issues/1
MDU6SXNzdWUyNzU2NzQ4Nzk=,"extractTranscriptSeqs, needs extra check",CLOSED,2017-11-21T11:19:37Z,2019-10-22T09:37:29Z,2019-10-22T09:37:29Z,"I spent 5 hours debugging extractTranscriptSeqs for faFile, GRangesList

When the GTF file and the fasta file have different naming on chromosomes, like chr1 in fasta vs 1 in gtf(which is the case for zebrafish genome danRer10), this error occurs:

```
extractTranscriptSeqs(faFile(""./danRer10.fa""),grl)

Error in (function (classes, fdef, mtable)  : 
  unable to find an inherited method for function ‘scanFa’ for signature ‘""FaFile"", ""character""’
```

This error told me very little, so I went into source code for some hours and the suddenly realized the chromsome naming differed.

Is it possible to make a test on this, that if no seqnames match, it should stop, and give propper error, if it exists it did not catch this example at least.
",Roleren,https://github.com/Bioconductor/GenomicFeatures/issues/2
MDU6SXNzdWUyNzk3NzUzMDE=,'names' attribute [211] must be the same length as the vector [209],CLOSED,2017-12-06T14:36:54Z,2017-12-08T23:47:23Z,2017-12-08T23:47:23Z,"hg19.refseq.db<-GenomicFeatures::makeTxDbFromUCSC(genome=""hg19"", table=""refGene"")
Error in names(trackIds) <- sub(""^ "", """", sapply(nodes, xmlValue)) : 
  'names' attribute [211] must be the same length as the vector [209]

Any idea on how to go about solving this? Is this a common issue? 
I'm running R 3.4.3 and tried reinstalling the package in addition to R, from scratch.  The issue still remains.",jamesdalg,https://github.com/Bioconductor/GenomicFeatures/issues/3
MDU6SXNzdWUyODM0MDU4NTE=,GenomicFeatures fails to install on CentOS 7.4 w MariaDB,CLOSED,2017-12-19T23:48:03Z,2017-12-20T02:02:33Z,2017-12-20T02:02:32Z,"See [this issue][1], originally opened on VariantAnnotation.

[1]: https://github.com/Bioconductor/VariantAnnotation/issues/1",mtmorgan,https://github.com/Bioconductor/GenomicFeatures/issues/4
MDU6SXNzdWUzMTc3NTcwODE=,"coverageByTranscript, seqlevels",CLOSED,2018-04-25T19:10:52Z,2019-10-22T05:13:44Z,2018-05-09T13:41:05Z,"We used this function extensivly in our package: https://github.com/JokingHero/ORFik

And found some scary behaviors of the seqlevels:
In our packages we made our own coverageByTranscript, which in ORFik is called 
coverageByWindow

In our version we use data.table syntax, so in this gist, we swapped this for base functions, but they are slow, 
i.g. aggregate etc, that should be swapped out. 

A list of fixes we did for consistent behavior is here:
https://gist.github.com/JokingHero/3eb1d69c7fe1adbebc2c1cabc48d8ecb

Let me know what you think.
Thank you. ",Roleren,https://github.com/Bioconductor/GenomicFeatures/issues/6
MDU6SXNzdWUzMzUxNDkzNjM=,"the ""phase"" metadata column must contain 0, 1, or 2, for all the CDS features",CLOSED,2018-06-24T04:12:05Z,2018-08-14T14:53:41Z,2018-08-14T14:53:41Z,"When use makeTxdbFromGff(), I met this issue.But I check my gtf file,there is no problem with the 8th col. It contains only 0,1,2 for all CDS features.Could you please tell me what's the problem?
Regards，
Alex",AlexWanghaoming,https://github.com/Bioconductor/GenomicFeatures/issues/7
MDU6SXNzdWUzMzY1ODAyNjc=,How does GenomicFeature calculate 3'UTR?,CLOSED,2018-06-28T11:22:56Z,2018-06-29T02:27:16Z,2018-06-29T02:27:16Z,"Hi, I download gencode V19 gtf file from [gencode ](https://www.gencodegenes.org/releases/19.html) 
(Comprehensive gene annotation, CHG region) then I load it into R with GenomicFeature using this:
`gencode_v19 = makeTxDbFromGFF(gtfFile,
                    format = 'gtf',
                    dataSource = 'gencode',
                    organism = 'Homo sapiens',
                    chrominfo = chromInfo)`
I extract 5'UTR and 3'UTR using fiveUTRsByTranscript() and threeUTRsByTranscript() like this:
`utr5 = fiveUTRsByTranscript(gencode_v19,use.names=TRUE)`
But the UTR I get is  slightly different from UTR annotation in gencode v19 gtf file. It seems that GenomicFeatures doesn't regard stop codon  as part of 3'UTR. Here is an example: ENST00000370584. Is this right ? If it's right, where should I change in raw codes to include stop codon when calculate 3'UTR ? 
Also total UTR regions (the sum of 5'UTR and 3'UTR) generated by GenomicFeatures is only 280400 while total UTR regions in gtf file is 284573. I use the following steps to count UTR regions generated by GenomicFeatures. Let's regard utr5 and utr3 as the result of fiveUTRsByTranscript() and threeUTRsByTranscript() respectively. Then I transform utr5 and utr3 to dataframe with as.data.frame() and use nrow() to count UTR regions. I count UTR regions in gencode gtf files simply using `awk '$3~/UTR/{print}' gencode.v19.gtf | wc -l `. I think this two number should be the same but apparently they are not. So why is there small difference ?
Thank you very much for helping me !",lss1227,https://github.com/Bioconductor/GenomicFeatures/issues/8
MDU6SXNzdWUzNTA0NjU0OTY=,"Make cdsBy(txdb, by=""tx"") return the CDS phase",OPEN,2018-08-14T14:55:08Z,2018-08-14T14:55:08Z,,See https://support.bioconductor.org/p/101245/,hpages,https://github.com/Bioconductor/GenomicFeatures/issues/9
MDU6SXNzdWUzNjE2ODQ0MTY=,pmapFromTranscripts strange behaviour,OPEN,2018-09-19T10:36:07Z,2019-02-08T12:00:57Z,,"There is some strange behavour on how it handles names in the transcripts:
Sorry for bad test data, made this quickly:

tx is a GRangesList of 100.000 transcripts:
ranges is 600.000 ORFs on the transcripts as IRanges
orfs$index is the index for each orf which transcript it came from

See how the time is different:
1. Without names:

```
grl <- tx 
names(grl) <- NULL
system.time(pmapFromTranscripts(x = ranges, transcripts = grl[orfs$index]))
   user  system elapsed 
 19.661   1.701  21.355 

```
2. With names:

```
grl <- tx
system.time(pmapFromTranscripts(x = ranges, transcripts = grl[orfs$index]))
   user  system elapsed 
 74.474   3.616  78.071 
```

3. Without names, and set them afterwards, so result is same as 2. 
```
names(grl) <- NULL
system.time({genomic <- pmapFromTranscripts(x = ranges, transcripts = grl[orfs$index]);
                     names(genomic) <- names(tx)[orfs$index] })
   user  system elapsed 
 19.963   1.634  21.591 
```

So this means that 2. is almost 4 times slower, while we could have done  3 , which is as fast a 1. 

Is this intentional ?

sessionInfo()
R version 3.5.0 (2018-04-23)
Platform: x86_64-redhat-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C              
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats4    parallel  stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] GenomicFeatures_1.33.2   GenomicRanges_1.33.13    IRanges_2.15.17            
     
...",Roleren,https://github.com/Bioconductor/GenomicFeatures/issues/10
MDU6SXNzdWUzNzE5ODk2OTk=,makeTxDbFromEnsembl() is broken,CLOSED,2018-10-19T14:46:56Z,2019-03-15T17:47:26Z,2019-03-15T17:47:26Z,"```
library(GenomicFeatures)
txdb <- makeTxDbFromEnsembl()
# Fetch transcripts and genes from Ensembl ... OK
# Fetch exons and CDS from Ensembl ... OK
# Fetch chromosome names and lengths from Ensembl ...Error in .fetch_Ensembl_chrominfo(dbconn, # seq_region_ids = seq_region_ids,  : 
#   identical(colnames(seq_region), joined_columns) is not TRUE
```
```
> sessionInfo()
R version 3.5.1 (2018-07-02)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 16.04.5 LTS

Matrix products: default
BLAS: /home/hpages/R/R-3.5.1/lib/libRblas.so
LAPACK: /home/hpages/R/R-3.5.1/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats4    parallel  stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
[1] GenomicFeatures_1.32.3 AnnotationDbi_1.42.1   Biobase_2.40.0        
[4] GenomicRanges_1.32.7   GenomeInfoDb_1.16.0    IRanges_2.14.12       
[7] S4Vectors_0.18.3       BiocGenerics_0.26.0   

loaded via a namespace (and not attached):
 [1] Rcpp_0.12.19                compiler_3.5.1             
 [3] XVector_0.20.0              prettyunits_1.0.2          
 [5] bitops_1.0-6                tools_3.5.1                
 [7] progress_1.2.0              zlibbioc_1.26.0            
 [9] biomaRt_2.36.1              digest_0.6.18              
[11] bit_1.1-14                  lattice_0.20-35            
[13] RSQLite_2.1.1               memoise_1.1.0              
[15] pkgconfig_2.0.2             rlang_0.2.2                
[17] Matrix_1.2-14               DelayedArray_0.6.6         
[19] DBI_1.0.0                   GenomeInfoDbData_1.1.0     
[21] RMariaDB_1.0.6              rtracklayer_1.40.6         
[23] stringr_1.3.1               httr_1.3.1                 
[25] Biostrings_2.48.0           hms_0.4.2                  
[27] grid_3.5.1                  bit64_0.9-7                
[29] R6_2.3.0                    XML_3.98-1.16              
[31] BiocParallel_1.14.2         blob_1.1.1                 
[33] magrittr_1.5                matrixStats_0.54.0         
[35] Rsamtools_1.32.3            GenomicAlignments_1.16.0   
[37] SummarizedExperiment_1.10.1 assertthat_0.2.0           
[39] stringi_1.2.4               RCurl_1.95-4.11            
[41] crayon_1.3.4               
```",hpages,https://github.com/Bioconductor/GenomicFeatures/issues/11
MDU6SXNzdWUzNzc3MzEwMTA=,extractTranscriptSeqs fails reconstructing transcripts on minus strand,CLOSED,2018-11-06T08:01:56Z,2018-11-07T17:22:26Z,2018-11-07T17:22:26Z,"When working on my favourite genome, I have noticed that extractTranscriptSeqs assembles cds in wrong order, when trying to reconstruct transcripts located on tthe minus strand. 

In order to demonstrate this issue, I have a test script developed on random coordinates on chr2 of the Human genome.

`#load libraries
library(""GenomicFeatures"")
library(""Biostrings"")
library(""BSgenome.Hsapiens.UCSC.hg19"")
#load genome
genome <- BSgenome.Hsapiens.UCSC.hg19
#build GRanges object: let's say there are 2 genes (named match), the first with just one 'exon' (match_part), 
#and the second with 3 exons, two of which are overlapping. 
( gr <- GRanges(Rle(rep(""chr2"", 6)),
              IRanges(start=c(11874,11874,14874,14874,15374,15674), end=c(12874,12874,15874,15474,15574,15874)),
              Rle(strand(c(""-"")), c(6)),
              type=c(""match"",""match_part"",""match"",""match_part"",""match_part"",""match_part""),
              target=c(""A"",""A"",""B"",""B"",""B"",""B""),
              parentFix=c(""a-A"",""a-A"",""b-B"",""b-B"",""b-B"",""b-B"")
    ))

#Select MATCHES, create GRangesList object, run merge -- non expecting any merge --, 
#extract the genomic sequence based on Iranges
( gr.m <- gr[gr$type == ""match""] )
( gr.m.grl = split(gr.m, as.factor(gr.m$parentFix)) )
( mergers.m.minus <- IRanges::reduce(gr.m.grl, with.revmap=TRUE) )
( cds.m.minus <- extractTranscriptSeqs(genome, mergers.m.minus) )
#Select MATCH_PARTS, create GRangesList object, run merge -- expecting overlap between feature 1 and 2 --, 
#extract the genomic sequence based on Iranges
( gr.mp <- gr[gr$type == ""match_part""] )
( gr.mp.grl = split(gr.mp, as.factor(gr.mp$parentFix)) )
( mergers.mp.minus <- IRanges::reduce(gr.mp.grl, with.revmap=TRUE) )
( cds.mp.minus <- extractTranscriptSeqs(genome, mergers.mp.minus) )
#COMMENT ON THE RESULT: The first transcript (one cds) has been correctly extracted, while the cds' of the second transcript have been mounted in the wrong order. 
#To fix this issue the following line helps: sort coordiantes in decreasing order.
( cds.mp.minus <- extractTranscriptSeqs(genome, sort(mergers.mp.minus,decreasing=T)) )
`
As stated in documentation:
[..] For a transcript located on the minus strand, the exons will typically (but not necessarily) be ordered by descending position on the reference genome. 

...but it's not working at the moment.

",sghignone,https://github.com/Bioconductor/GenomicFeatures/issues/12
MDU6SXNzdWU0MDIxNzExOTE=,makeTxDbFromGFF not working with GFF3File object,CLOSED,2019-01-23T10:30:32Z,2019-01-25T19:59:20Z,2019-01-25T19:59:19Z,"This does not work:

```
gff <- GFF3File(""sacCer3.gff"")
makeTxDbFromGFF(gff)
```

This works
```
gff <- GFF3File(""sacCer3.gff"")
makeTxDbFromGFF(path(gff))
```
[sacCer3.zip](https://github.com/Bioconductor/GenomicFeatures/files/2786763/sacCer3.zip)

```
> sessionInfo()
R version 3.5.2 (2018-12-20)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows >= 8 x64 (build 9200)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252    LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                    LC_TIME=German_Germany.1252    

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] Rsamtools_1.34.0            Biostrings_2.50.2           XVector_0.22.0              RPFTools_0.0.1              SummarizedExperiment_1.12.0 DelayedArray_0.8.0         
 [7] BiocParallel_1.16.5         matrixStats_0.54.0          GenomicFeatures_1.34.1      AnnotationDbi_1.44.0        Biobase_2.42.0              rtracklayer_1.42.1         
[13] GenomicRanges_1.34.0        GenomeInfoDb_1.18.1         IRanges_2.16.0              S4Vectors_0.20.1            BiocGenerics_0.28.0        

loaded via a namespace (and not attached):
  [1] assertive.base_0.0-7       colorspace_1.3-2           colorRamps_2.3             ggridges_0.5.1             htmlTable_1.13             base64enc_0.1-3           
  [7] rstudioapi_0.8             assertive.sets_0.0-3       ggrepel_0.8.0              bit64_0.9-7                assertive.data.uk_0.0-2    codetools_0.2-16          
 [13] splines_3.5.2              geneplotter_1.60.0         knitr_1.21                 SuppDists_1.1-9.4          Formula_1.2-3              assertive_0.3-5           
 [19] assertive.data.us_0.0-2    rJava_0.9-10               annotate_1.60.0            cluster_2.0.7-1            GO.db_3.7.0                graph_1.60.0              
 [25] compiler_3.5.2             httr_1.4.0                 backports_1.1.3            GOstats_2.48.0             assertthat_0.2.0           Matrix_1.2-15             
 [31] lazyeval_0.2.1             cli_1.0.1                  htmltools_0.3.6            acepack_1.4.1              prettyunits_1.0.2          tools_3.5.2               
 [37] bindrcpp_0.2.2             gtable_0.2.0               glue_1.3.0                 GenomeInfoDbData_1.2.0     Category_2.48.0            reshape2_1.4.3            
 [43] dplyr_0.7.8                Rcpp_1.0.0                 xtail_1.1.5                gdata_2.18.0               assertive.files_0.0-2      assertive.datetimes_0.0-2 
 [49] assertive.models_0.0-2     xfun_0.4                   stringr_1.3.1              gtools_3.8.1               XML_3.98-1.16              zlibbioc_1.28.0           
 [55] scales_1.0.0               hms_0.4.2                  RBGL_1.58.1                RColorBrewer_1.1-2         assertive.matrices_0.0-2   assertive.strings_0.0-3   
 [61] yaml_2.2.0                 memoise_1.1.0              RDAVIDWebService_1.20.0    gridExtra_2.3              ggplot2_3.1.0              UpSetR_1.3.3              
 [67] rpart_4.1-13               biomaRt_2.38.0             latticeExtra_0.6-28        stringi_1.2.4              RSQLite_2.1.1              genefilter_1.64.0         
 [73] checkmate_1.8.5            caTools_1.17.1.1           rlang_0.3.0.1              pkgconfig_2.0.2            bitops_1.0-6               lattice_0.20-38           
 [79] assertive.data_0.0-3       purrr_0.2.5                bindr_0.1.1                htmlwidgets_1.3            GenomicAlignments_1.18.1   assertive.properties_0.0-4
 [85] bit_1.1-14                 tidyselect_0.2.5           GSEABase_1.44.0            assertive.code_0.0-3       AnnotationForge_1.24.0     plyr_1.8.4                
 [91] magrittr_1.5               DESeq2_1.22.2              R6_2.3.0                   Hmisc_4.1-1                gplots_3.0.1               DBI_1.0.0                 
 [97] withr_2.1.2                foreign_0.8-71             pillar_1.3.1               assertive.numbers_0.0-2    nnet_7.3-12                survival_2.43-3           
[103] RCurl_1.95-4.11            tibble_1.4.2               crayon_1.3.4               assertive.types_0.0-3      KernSmooth_2.23-15         kSamples_1.2-8            
[109] progress_1.2.0             locfit_1.5-9.1             grid_3.5.2                 data.table_1.11.8          blob_1.1.1                 Rgraphviz_2.26.0          
[115] digest_0.6.18              xtable_1.8-3               munsell_0.5.0              assertive.reflection_0.0-4 sessioninfo_1.1.1      
```",FelixErnst,https://github.com/Bioconductor/GenomicFeatures/issues/13
MDU6SXNzdWU0MDMzOTk1Nzg=,Question: error in makeTxDbFromUCSC,CLOSED,2019-01-26T03:18:33Z,2019-01-28T06:04:00Z,2019-01-28T04:58:50Z,"Hi GenomicFeatures support,

I am a phD student at the University of Tokyo, using GenomicFeatures for ChIPSeeker. 

After I run
txdb=makeTxDbFromUCSC(genome=""hg19"",tablename=""refGene"")

I got this error.

Download the refGene table ... OK
Download the hgFixed.refLink table ... OK
Extract the 'transcripts' data frame ... OK
Extract the 'splicings' data frame ... OK
Download and preprocess the 'chrominfo' data frame ... OK
Prepare the 'metadata' data frame ... OK
**Make the TxDb object ... Error in .check_foreign_key(transcripts_tx_chrom, NA, ""transcripts$tx_chrom"",  : 
  all the values in 'transcripts$tx_chrom' must be present in 'chrominfo$chrom'**

**I consider the problem is that refGene version was upgraded last November,however, GenomicFeatures haven't done corresponding changes to the new refGene release.** 

**Genomefeatures** ""x"" ""1"" ""chr1"" ""2"" ""chr1gl000191random"" ""3"" ""chr1gl000192random"" ""4"" ""chr10"" ""5"" ""chr11"" ""6"" ""chr11gl000202random"" ""7"" ""chr12"" ""8"" ""chr13"" ""9"" ""chr14"" ""10"" ""chr15"" ""11"" ""chr16"" ""12"" ""chr17"" ""13"" ""chr17ctg5hap1"" ""14"" ""chr17gl000203random"" ""15"" ""chr17gl000204random"" ""16"" ""chr17gl000205random"" ""17"" ""chr17gl000206random"" ""18"" ""chr18"" ""19"" ""chr18gl000207random"" ""20"" ""chr19"" ""21"" ""chr19gl000208random"" ""22"" ""chr19gl000209random"" ""23"" ""chr2"" ""24"" ""chr20"" ""25"" ""chr21"" ""26"" ""chr21gl000210random"" ""27"" ""chr22"" ""28"" ""chr3"" ""29"" ""chr4"" ""30"" ""chr4ctg9hap1"" ""31"" ""chr4gl000193random"" ""32"" ""chr4gl000194random"" ""33"" ""chr5"" ""34"" ""chr6"" ""35"" ""chr6apdhap1"" ""36"" ""chr6coxhap2"" ""37"" ""chr6dbbhap3"" ""38"" ""chr6mannhap4"" ""39"" ""chr6mcfhap5"" ""40"" ""chr6qblhap6"" ""41"" ""chr6sstohap7"" ""42"" ""chr7"" ""43"" ""chr7gl000195random"" ""44"" ""chr8"" ""45"" ""chr8gl000196random"" ""46"" ""chr8gl000197random"" ""47"" ""chr9"" ""48"" ""chr9gl000198random"" ""49"" ""chr9gl000199random"" ""50"" ""chr9gl000200random"" ""51"" ""chr9gl000201random"" ""52"" ""chrM"" ""53"" ""chrUngl000211"" ""54"" ""chrUngl000212"" ""55"" ""chrUngl000213"" ""56"" ""chrUngl000214"" ""57"" ""chrUngl000215"" ""58"" ""chrUngl000216"" ""59"" ""chrUngl000217"" ""60"" ""chrUngl000218"" ""61"" ""chrUngl000219"" ""62"" ""chrUngl000220"" ""63"" ""chrUngl000221"" ""64"" ""chrUngl000222"" ""65"" ""chrUngl000223"" ""66"" ""chrUngl000224"" ""67"" ""chrUngl000225"" ""68"" ""chrUngl000226"" ""69"" ""chrUngl000227"" ""70"" ""chrUngl000228"" ""71"" ""chrUngl000229"" ""72"" ""chrUngl000230"" ""73"" ""chrUngl000231"" ""74"" ""chrUngl000232"" ""75"" ""chrUngl000233"" ""76"" ""chrUngl000234"" ""77"" ""chrUngl000235"" ""78"" ""chrUngl000236"" ""79"" ""chrUngl000237"" ""80"" ""chrUngl000238"" ""81"" ""chrUngl000239"" ""82"" ""chrUngl000240"" ""83"" ""chrUngl000241"" ""84"" ""chrUngl000242"" ""85"" ""chrUngl000243"" ""86"" ""chrUngl000244"" ""87"" ""chrUngl000245"" ""88"" ""chrUngl000246"" ""89"" ""chrUngl000247"" ""90"" ""chrUngl000248"" ""91"" ""chrUn_gl000249"" ""92"" ""chrX"" ""93"" ""chrY""

**UCSCrefgene** ""x"" ""1"" ""chr1"" ""2"" ""chr1gl000191random"" ""3"" ""chr1gl000192random"" ""4"" ""chr1gl383519alt"" ""5"" ""chr1gl949741fix"" ""6"" ""chr1jh636052fix"" ""7"" ""chr1jh636054fix"" ""8"" ""chr10"" ""9"" ""chr10gl383543fix"" ""10"" ""chr10jh591181fix"" ""11"" ""chr10jh636060fix"" ""12"" ""chr11"" ""13"" ""chr11gl949744fix"" ""14"" ""chr11jh159138fix"" ""15"" ""chr11jh159142fix"" ""16"" ""chr12"" ""17"" ""chr13"" ""18"" ""chr14"" ""19"" ""chr14kb021645fix"" ""20"" ""chr15"" ""21"" ""chr16"" ""22"" ""chr17"" ""23"" ""chr17ctg5hap1"" ""24"" ""chr17gl000205random"" ""25"" ""chr17gl383560fix"" ""26"" ""chr17gl582976fix"" ""27"" ""chr17jh159145fix"" ""28"" ""chr18"" ""29"" ""chr18gl383571alt"" ""30"" ""chr19"" ""31"" ""chr19gl000209random"" ""32"" ""chr19gl383575alt"" ""33"" ""chr19gl582977fix"" ""34"" ""chr19gl949746alt"" ""35"" ""chr19gl949747alt"" ""36"" ""chr19gl949748alt"" ""37"" ""chr19gl949749alt"" ""38"" ""chr19gl949750alt"" ""39"" ""chr19gl949751alt"" ""40"" ""chr19gl949752alt"" ""41"" ""chr19gl949753alt"" ""42"" ""chr19jh159149fix"" ""43"" ""chr19kb021647fix"" ""44"" ""chr2"" ""45"" ""chr2kb663603fix"" ""46"" ""chr20"" ""47"" ""chr20gl582979fix"" ""48"" ""chr21"" ""49"" ""chr21ke332506fix"" ""50"" ""chr22"" ""51"" ""chr22gl383582alt"" ""52"" ""chr22jh720449fix"" ""53"" ""chr3"" ""54"" ""chr3gl383523fix"" ""55"" ""chr3jh159132fix"" ""56"" ""chr4"" ""57"" ""chr4ctg9hap1"" ""58"" ""chr4gl000193random"" ""59"" ""chr4gl000194random"" ""60"" ""chr4gl877872fix"" ""61"" ""chr4ke332496fix"" ""62"" ""chr5"" ""63"" ""chr5gl339449alt"" ""64"" ""chr5jh159133fix"" ""65"" ""chr5ke332497fix"" ""66"" ""chr6"" ""67"" ""chr6apdhap1"" ""68"" ""chr6coxhap2"" ""69"" ""chr6dbbhap3"" ""70"" ""chr6jh636056fix"" ""71"" ""chr6kb663604fix"" ""72"" ""chr6mannhap4"" ""73"" ""chr6mcfhap5"" ""74"" ""chr6qblhap6"" ""75"" ""chr6sstohap7"" ""76"" ""chr7"" ""77"" ""chr7gl000195random"" ""78"" ""chr7gl582971fix"" ""79"" ""chr7jh159134fix"" ""80"" ""chr8"" ""81"" ""chr8gl383535fix"" ""82"" ""chr8gl383536fix"" ""83"" ""chr9"" ""84"" ""chr9gl339450fix"" ""85"" ""chrM"" ""86"" ""chrUngl000211"" ""87"" ""chrUngl000212"" ""88"" ""chrUngl000213"" ""89"" ""chrUngl000215"" ""90"" ""chrUngl000218"" ""91"" ""chrUngl000219"" ""92"" ""chrUngl000220"" ""93"" ""chrUngl000222"" ""94"" ""chrUngl000223"" ""95"" ""chrUngl000224"" ""96"" ""chrUngl000227"" ""97"" ""chrUngl000228"" ""98"" ""chrUngl000241"" ""99"" ""chrX"" ""100"" ""chrXjh159150fix"" ""101"" ""chrXjh806587fix"" ""102"" ""chrXjh806590fix"" ""103"" ""chrXjh806593fix"" ""104"" ""chrXjh806594fix"" ""105"" ""chrXjh806595fix"" ""106"" ""chrXjh806597fix"" ""107"" ""chrXjh806599fix"" ""108"" ""chrXjh806600fix"" ""109"" ""chrXjh806601fix"" ""110"" ""chrXkb021648_fix"" ""111"" ""chrY""

**If anyone have any clues, please let me know. Your help is much appreciated. Thank you so much!**

sessionInfo()
R version 3.5.2 (2018-12-20)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 17134)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                           LC_TIME=English_United States.1252    

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] cowplot_0.9.4          reshape_0.8.8          ggplot2_3.1.0          clusterProfiler_3.10.1 GenomicFeatures_1.34.1
 [6] GenomicRanges_1.34.0   GenomeInfoDb_1.18.1    org.Hs.eg.db_3.7.0     AnnotationDbi_1.44.0   IRanges_2.16.0        
[11] S4Vectors_0.20.1       Biobase_2.42.0         BiocGenerics_0.28.0    ChIPseeker_1.18.0",AlanchenJP,https://github.com/Bioconductor/GenomicFeatures/issues/14
MDU6SXNzdWU0MjA2Mzc2NjU=,makeFeatureDbFromUCSC  not populating database correctly,CLOSED,2019-03-13T17:51:30Z,2019-03-25T16:52:13Z,2019-03-25T14:43:57Z,"See the details in the following support site post:
https://support.bioconductor.org/p/119066/

as James pointed out the `.adjustChromStarts` function reorders the columns. 
and as I pointed out the `insert_data_into_table` doesn't take into account a different ordering and populates the database incorrectly
",lshep,https://github.com/Bioconductor/GenomicFeatures/issues/15
MDU6SXNzdWU0MzMzMTYwOTI=,makeTxDbFromUCSC fails with with RMariaDB error,CLOSED,2019-04-15T14:33:00Z,2019-08-27T19:55:59Z,2019-08-27T19:55:59Z,"```
> makeTxDbFromUCSC()
Download the knownGene table ... Error in result_fetch(res@ptr, n = n) : Error fetching buffer: 
OK
```
I googled it and it pointed me to connector/c libs in MariaDb. On Debian I have libmariadb-dev 10.3.13 and libmariadb-dev-compat 10.3.13 installed. On Arch I have mariadb-libs 10.3.14 installed. I am not using RMariaDb directly and do not intend to.
I installed github version of RMariaDb, now the error message changed slightly:
```
> makeTxDbFromUCSC()
Download the knownGene table ... Error: Error fetching buffer:
OK
```
I have also installed github version of Bioconductor/GenomicFeatures. It did not change anything
I ran out of ideas. Is there a workaroud? Can I use sqlite instead?

```
> traceback()
11: stop(list(message = ""Error fetching buffer: "", call = result_fetch(res@ptr, 
        n = n), cppstack = list(file = """", line = -1L, stack = c(""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(Rcpp::exception::exception(char const*, bool)+0x74) [0x7f37a7770064]"", 
    ""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(void Rcpp::stop<char const*>(char const*, char const*&&)+0x4f) [0x7f37a7771cdf]"", 
    ""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(+0x22535) [0x7f37a777a535]"", 
    ""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(MariaRow::value_string(int)+0x3a) [0x7f37a777a57a]"", 
    ""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(MariaRow::set_list_value(SEXPREC*, int, int)+0x117) [0x7f37a777a777]"", 
    ""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(MariaResultPrep::fetch(int)+0x1b0) [0x7f37a7777c80]"", 
    ""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(DbResult::fetch(int)+0x3d) [0x7f37a77744ed]"", 
    ""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(result_fetch(DbResult*, int)+0x1d) [0x7f37a77864dd]"", 
    ""/usr/local/lib/R/site-library/RMariaDB/libs/RMariaDB.so(_RMariaDB_result_fetch+0x61) [0x7f37a7781941]"", 
    ""/usr/lib/R/lib/libR.so(+0x12da6c) [0x7f37b7365a6c]"", ""/usr/lib/R/lib/libR.so(Rf_eval+0x190) [0x7f37b7370170]"", 
    ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", ""/usr/lib/R/lib/libR.so(Rf_eval+0x347) [0x7f37b7370327]"", 
    ""/usr/lib/R/lib/libR.so(+0x13c988) [0x7f37b7374988]"", ""/usr/lib/R/lib/libR.so(Rf_eval+0x5c9) [0x7f37b73705a9]"", 
    ""/usr/lib/R/lib/libR.so(+0x13b756) [0x7f37b7373756]"", ""/usr/lib/R/lib/libR.so(Rf_eval+0x5c9) [0x7f37b73705a9]"", 
    ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", ""/usr/lib/R/lib/libR.so(+0x12edbe) [0x7f37b7366dbe]"", 
    ""/usr/lib/R/lib/libR.so(Rf_eval+0x190) [0x7f37b7370170]"", ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", 
    ""/usr/lib/R/lib/libR.so(R_execMethod+0x25a) [0x7f37b7372eba]"", 
    ""/usr/lib/R/library/methods/libs/methods.so(+0x4efd) [0x7f37b1584efd]"", 
    ""/usr/lib/R/lib/libR.so(+0x17a2cc) [0x7f37b73b22cc]"", ""/usr/lib/R/lib/libR.so(+0x128282) [0x7f37b7360282]"", 
    ""/usr/lib/R/lib/libR.so(Rf_eval+0x190) [0x7f37b7370170]"", ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", 
    ""/usr/lib/R/lib/libR.so(Rf_eval+0x347) [0x7f37b7370327]"", ""/usr/lib/R/lib/libR.so(+0x13b756) [0x7f37b7373756]"", 
    ""/usr/lib/R/lib/libR.so(Rf_eval+0x5c9) [0x7f37b73705a9]"", ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", 
    ""/usr/lib/R/lib/libR.so(+0x12edbe) [0x7f37b7366dbe]"", ""/usr/lib/R/lib/libR.so(Rf_eval+0x190) [0x7f37b7370170]"", 
    ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", ""/usr/lib/R/lib/libR.so(R_execMethod+0x25a) [0x7f37b7372eba]"", 
    ""/usr/lib/R/library/methods/libs/methods.so(+0x4efd) [0x7f37b1584efd]"", 
    ""/usr/lib/R/lib/libR.so(+0x17a2cc) [0x7f37b73b22cc]"", ""/usr/lib/R/lib/libR.so(+0x128282) [0x7f37b7360282]"", 
    ""/usr/lib/R/lib/libR.so(Rf_eval+0x190) [0x7f37b7370170]"", ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", 
    ""/usr/lib/R/lib/libR.so(+0x12edbe) [0x7f37b7366dbe]"", ""/usr/lib/R/lib/libR.so(Rf_eval+0x190) [0x7f37b7370170]"", 
    ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", ""/usr/lib/R/lib/libR.so(+0x12edbe) [0x7f37b7366dbe]"", 
    ""/usr/lib/R/lib/libR.so(Rf_eval+0x190) [0x7f37b7370170]"", ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", 
    ""/usr/lib/R/lib/libR.so(+0x12edbe) [0x7f37b7366dbe]"", ""/usr/lib/R/lib/libR.so(Rf_eval+0x190) [0x7f37b7370170]"", 
    ""/usr/lib/R/lib/libR.so(+0x139d9f) [0x7f37b7371d9f]"", ""/usr/lib/R/lib/libR.so(Rf_eval+0x347) [0x7f37b7370327]"", 
    ""/usr/lib/R/lib/libR.so(Rf_ReplIteration+0x2a2) [0x7f37b73a0722]"", 
    ""/usr/lib/R/lib/libR.so(+0x168ad1) [0x7f37b73a0ad1]"", ""/usr/lib/R/lib/libR.so(run_Rmainloop+0x48) [0x7f37b73a0b88]"", 
    ""/usr/lib/R/bin/exec/R(main+0x1b) [0x56407ed7207b]"", ""/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xeb) [0x7f37b6ff409b]"", 
    ""/usr/lib/R/bin/exec/R(_start+0x2a) [0x56407ed720ba]""))))
10: result_fetch(res@ptr, n = n)
9: .local(res, n, ...)
8: dbFetch(rs, n = n, ...)
7: dbFetch(rs, n = n, ...)
6: .local(conn, statement, ...)
5: dbGetQuery(dbconn, SQL)
4: dbGetQuery(dbconn, SQL)
3: UCSC_dbselect(genome, tablename, columns = columns, where = where)
2: .fetch_UCSC_txtable(genome(session), tablename, transcript_ids = transcript_ids)
1: makeTxDbFromUCSC()
```

```
> sessionInfo()
R version 3.5.2 (2018-12-20)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Debian GNU/Linux buster/sid

Matrix products: default
BLAS: /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.3.5.so

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_DK.UTF-8        LC_COLLATE=C              
 [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
 [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
[1] GenomicFeatures_1.34.6 GenomicRanges_1.34.0   GenomeInfoDb_1.18.2   
[4] AnnotationDbi_1.44.0   IRanges_2.16.0         S4Vectors_0.20.1      
[7] Biobase_2.42.0         BiocGenerics_0.28.0   

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.1                  compiler_3.5.2             
 [3] XVector_0.22.0              prettyunits_1.0.2          
 [5] bitops_1.0-6                tools_3.5.2                
 [7] zlibbioc_1.28.0             progress_1.2.0             
 [9] biomaRt_2.38.0              digest_0.6.18              
[11] bit_1.1-14                  lattice_0.20-38            
[13] RSQLite_2.1.1               memoise_1.1.0              
[15] pkgconfig_2.0.2             rlang_0.3.2                
[17] Matrix_1.2-17               DelayedArray_0.8.0         
[19] DBI_1.0.0                   GenomeInfoDbData_1.2.0     
[21] RMariaDB_1.0.6              rtracklayer_1.42.2         
[23] stringr_1.4.0               httr_1.4.0                 
[25] Biostrings_2.50.2           hms_0.4.2                  
[27] grid_3.5.2                  bit64_0.9-7                
[29] R6_2.4.0                    XML_3.98-1.19              
[31] BiocParallel_1.16.6         blob_1.1.1                 
[33] magrittr_1.5                matrixStats_0.54.0         
[35] GenomicAlignments_1.18.1    Rsamtools_1.34.1           
[37] SummarizedExperiment_1.12.0 assertthat_0.2.1           
[39] stringi_1.4.3               RCurl_1.95-4.12            
[41] crayon_1.3.4 
```

EDIT: I just booted a Windows machine and tested there. No errors. I got a txDb object.
",balwierz,https://github.com/Bioconductor/GenomicFeatures/issues/16
MDU6SXNzdWU0ODU5OTczODQ=,threeUTRsByTranscript per gene,CLOSED,2019-08-27T19:41:24Z,2019-08-27T19:49:48Z,2019-08-27T19:49:47Z,"How do I get the 3' UTR sequence per gene rather than transcript? Online resources suggest using columns=""gene_name"" parameter but it doesn't seem to be functional anymore.",asmagen,https://github.com/Bioconductor/GenomicFeatures/issues/17
MDU6SXNzdWU1Mjk4MjI2MzY=,Crash with failed memory allocation/mapping,CLOSED,2019-11-28T10:24:15Z,2024-03-23T00:54:42Z,2024-03-23T00:54:42Z,"Despite 800 GB from 1 TB RAM available, the program crashes with a segmentation fault.

```
Download the refGene table ...
 *** caught segfault ***
address (nil), cause 'memory not mapped'

Traceback:
 1: result_release(res@ptr)
 2: dbClearResult(rs)
 3: dbClearResult(rs)
 4: dbExecute(conn, ""SET time_zone = '+00:00'"")
 5: dbExecute(conn, ""SET time_zone = '+00:00'"")
 6: .local(drv, ...)
 7: dbConnect(RMariaDB::MariaDB(), dbname = dbname, username = ""genome"",     host = server, port = 3306)
 8: dbConnect(RMariaDB::MariaDB(), dbname = dbname, username = ""genome"",     host = server, port = 3306)
 9: UCSC_dbselect(genome, tablename, columns = columns, where = where)
10: .fetch_UCSC_txtable(genome(session), tablename, transcript_ids = transcript_ids)
11: makeTxDbFromUCSC(genome = ""hg19"", table = ""refGene"")
An irrecoverable exception occurred. R is aborting now ...
```

Could you please print out, how much RAM you tried to allocate?",paulmenzel,https://github.com/Bioconductor/GenomicFeatures/issues/18
MDU6SXNzdWU1NTgxMTMwOTc=,coverageByTranscript weights ?,OPEN,2020-01-31T12:49:34Z,2021-06-25T07:34:16Z,,"For human data, using human NGS reads (1.4GB) as GRanges:

```
# Using reduced data that has a score column for duplicated reads,
#  every unique read is only once.
system.time(withWeights <- coverageByTranscript(a, cds, weight = ""score""))
   user  system elapsed 
  3.987   0.683   4.667 
# Using raw data, without reducing the data-set by not creating 
# a $score column for number of duplicated reads
> system.time(withoutWeights <- coverageByTranscript(b, cds))
   user  system elapsed 
 37.956  21.586  59.547 
> identical(d, dd)
[1] TRUE

```
I just changed the coverageByTranscript function to allow weights, maybe a possible improvement?",Roleren,https://github.com/Bioconductor/GenomicFeatures/issues/19
MDU6SXNzdWU2MzU5NzM0OTk=,How to get promoter  sequences,CLOSED,2020-06-10T06:39:46Z,2020-06-10T16:04:56Z,2020-06-10T16:04:56Z,"Hello, i have a question on the getPromoterSeq function. I have several variants of a particular genome and i wish to get promoters from all of these variants. Is there a way to get promoter sequences from the fasta file of each genome directly without using BSgenome to forge a package.",FritzPeleke,https://github.com/Bioconductor/GenomicFeatures/issues/21
MDU6SXNzdWU2NTAwNTQzNTQ=,makeTxDbFromUCSC fails for hg38,CLOSED,2020-07-02T16:14:55Z,2020-07-10T05:06:03Z,2020-07-10T05:06:03Z,"Hey, I was trying to use the command makeTxDbFromUCSC() on hg38 and it seems to be failing. I'm trying to retrieve the knownGenes. A little investigation, supportedUCSCtables() returns ""knownGeneOld8"", but even specifying that in the tablename argument fails. 

```
TxDb_hg38 <- makeTxDbFromUCSC(genome = ""hg38"", tablename = ""knownGene"")
Error in .tablename2track(tablename, session) : 
  UCSC table ""knownGene"" is not supported
```
```
supportedUCSCtables(genome = ""hg38"")
               tablename          track          subtrack
1          knownGeneOld8 Old UCSC Genes              <NA>
2          knownGeneOld7 Old UCSC Genes              <NA>
3          knownGeneOld6 Old UCSC Genes              <NA>
4          knownGeneOld4 Old UCSC Genes              <NA>
5          knownGeneOld3 Old UCSC Genes              <NA>
6               ccdsGene           CCDS              <NA>
7                refGene    NCBI RefSeq       UCSC RefSeq
8            xenoRefGene   Other RefSeq              <NA>
9                sibGene      SIB Genes              <NA>
10               sgpGene      SGP Genes              <NA>
11                geneid   Geneid Genes              <NA>
12               genscan  Genscan Genes              <NA>
13            ncbiRefSeq    NCBI RefSeq        RefSeq All
14     ncbiRefSeqCurated    NCBI RefSeq    RefSeq Curated
15       ncbiRefSeqOther    NCBI RefSeq      RefSeq Other
16         ncbiRefSeqPsl    NCBI RefSeq RefSeq Alignments
17   ncbiRefSeqPredicted    NCBI RefSeq  RefSeq Predicted
18 ncbiRefSeqGenomicDiff    NCBI RefSeq      RefSeq Diffs
```
```
TxDb_hg38 <- makeTxDbFromUCSC(genome = ""hg38"", tablename = ""knownGeneOld8"")
Error in .tablename2track(tablename, session) : 
  UCSC table ""knownGeneOld8"" does not exist for genome ""hg38"", sorry
```
",Austin-s-h,https://github.com/Bioconductor/GenomicFeatures/issues/22
MDU6SXNzdWU2ODkxMTMyNzg=,Bug in merge_seqinfo_and_infer_missing_seqlengths for GAlignmentPairs,CLOSED,2020-08-31T10:54:59Z,2020-08-31T13:43:51Z,2020-08-31T13:43:51Z,"Forget this, was an error on my end. ",Roleren,https://github.com/Bioconductor/GenomicFeatures/issues/23
MDU6SXNzdWU3ODU0NjMyNjU=,TxDb from NCBI RefSeq GCF_000001405.39_GRCh38.p13 is failing,CLOSED,2021-01-13T21:17:07Z,2023-03-15T17:33:28Z,2023-03-15T17:33:27Z,"I'm trying to load transcript metadata for NCBI `GCF_000001405.39_GRCh38.p13` into a `TxDb` object. GenomicFeatures is currently having trouble parsing the build from RefSeq:

```r
packageVersion(""GenomicFeatures"")
## [1] ‘1.42.1’
library(GenomicFeatures)
file <- ""ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.39_GRCh38.p13/GCF_000001405.39_GRCh38.p13_genomic.gtf.gz""
txdb <- makeTxDbFromGFF(file = file)
```

```
Import genomic features from the file as a GRanges object ... trying URL 'ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.39_GRCh38.p13/GCF_000001405.39_GRCh38.p13_genomic.gtf.gz'
Content type 'unknown' length 41463702 bytes (39.5 MB)
==================================================
OK
Prepare the 'metadata' data frame ... OK
Make the TxDb object ... Warning in .get_cds_IDX(mcols0$type, mcols0$phase) :
  The ""phase"" metadata column contains non-NA values for features of type
  stop_codon. This information was ignored.
Calls: makeTxDbFromGFF -> makeTxDbFromGRanges -> .get_cds_IDX
Error in .make_splicings(exons, cds, stop_codons) :
  some CDS cannot be mapped to an exon
Calls: makeTxDbFromGFF -> makeTxDbFromGRanges -> .make_splicings
```",mjsteinbaugh,https://github.com/Bioconductor/GenomicFeatures/issues/26
MDU6SXNzdWU3OTMzODk1MDU=,Large discrepancy seen when parsing Ensembl GTF vs. GFF3 files,CLOSED,2021-01-25T13:37:52Z,2021-03-12T16:56:41Z,2021-03-12T16:56:41Z,"`TxDb` generation currently differs quite significantly between Ensembl GTF and GFF3 files. Parsing the files directly with rtracklayer can return the same number of genes and transcripts in the Ensembl GFF3 file as seen in the GTF, which is correct.

```r
suppressPackageStartupMessages({
    library(GenomicFeatures)
})
gtf <- paste0(
    ""ftp://ftp.ensembl.org/pub/release-102/gtf/"",
    ""homo_sapiens/Homo_sapiens.GRCh38.102.gtf.gz""
)
gff3 <- paste0(
    ""ftp://ftp.ensembl.org/pub/release-102/gff3/"",
    ""homo_sapiens/Homo_sapiens.GRCh38.102.gff3.gz""
)
suppressWarnings({
    suppressMessages({
        txdb_gtf <- makeTxDbFromGFF(file = gtf)
        txdb_gff3 <- makeTxDbFromGFF(file = gff3)
    })
})

print(txdb_gtf)
## TxDb object:
## # Db type: TxDb
## # Supporting package: GenomicFeatures
## # Data source: ftp://ftp.ensembl.org/pub/release-102/gtf/homo_sapiens/Homo_sapiens.GRCh38.102.gtf.gz
## # Organism: Homo sapiens
## # Taxonomy ID: 9606
## # miRBase build ID: NA
## # Genome: NA
## # Nb of transcripts: 232024
## # Db created by: GenomicFeatures package from Bioconductor
## # Creation time: 2021-01-25 08:31:27 -0500 (Mon, 25 Jan 2021)
## # GenomicFeatures version at creation time: 1.42.1
## # RSQLite version at creation time: 2.2.3
## # DBSCHEMAVERSION: 1.2

print(txdb_gff3)
## TxDb object:
## # Db type: TxDb
## # Supporting package: GenomicFeatures
## # Data source: ftp://ftp.ensembl.org/pub/release-102/gff3/homo_sapiens/Homo_sapiens.GRCh38.102.gff3.gz
## # Organism: Homo sapiens
## # Taxonomy ID: 9606
## # miRBase build ID: NA
## # Genome: NA
## # Nb of transcripts: 230447
## # Db created by: GenomicFeatures package from Bioconductor
## # Creation time: 2021-01-25 08:32:59 -0500 (Mon, 25 Jan 2021)
## # GenomicFeatures version at creation time: 1.42.1
## # RSQLite version at creation time: 2.2.3
## # DBSCHEMAVERSION: 1.2

length(genes(txdb_gtf))
## [1] 60675
## CORRECT.

suppressMessages({
    length(genes(txdb_gff3))
})
## [1] 35216
## INCORRECT.

length(transcripts(txdb_gtf))
## [1] 232024
## CORRECT.

length(transcripts(txdb_gff3))
## [1] 230447
## INCORRECT.
```",mjsteinbaugh,https://github.com/Bioconductor/GenomicFeatures/issues/28
MDU6SXNzdWU4MDEyMDAxNTc=,Unable to parse bacterial GFF files,CLOSED,2021-02-04T11:35:39Z,2022-05-11T01:51:31Z,2022-05-11T01:51:31Z,"When trying to import a gff for Mycobacterium tuberculosis from the NCBI, the following error is received:

Import genomic features from the file as a GRanges object ... OK
Prepare the 'metadata' data frame ... OK
Make the TxDb object ... OK
Warning message:
In .extract_transcripts_from_GRanges(tx_IDX, gr, mcols0$type, mcols0$ID,  :
  The following transcripts have multiple parts that were merged: gene-Rv3216

Code:

txdb <-makeTxDbFromGFF(""/path/to/file/GCA_000195955.2_ASM19595v2_genomic.gff"", organism=""Mycobacterium tuberculosis"")

Link to annotation and genome:

https://www.ncbi.nlm.nih.gov/assembly/GCF_000195955.2/
",jambler24,https://github.com/Bioconductor/GenomicFeatures/issues/30
MDU6SXNzdWU4NTUxODg3Njg=,Get gene_name column from GENCODE GTF?,CLOSED,2021-04-11T00:45:22Z,2021-04-12T11:56:52Z,2021-04-12T11:56:51Z,"Hi, I wonder whether it's possible to import columns other than ""gene_id"" from a GTF file to a TxDb?
To be specific, what I'm doing now is:
```r
gencode <- makeTxDbFromGFF(""gencode.gtf"", format = ""gtf"")
gene_gr <- genes(gencode, columns = ""gene_id"")
```
I want to do
```r
gene_gr <- genes(gencode, columns = c(""gene_id"", ""gene_name""))
```

The `gene_name` entry in GENCODE GTF is basically the gene symbol. I want to have both information so I can work on ENSG ID and also to look at the gene symbol at the same time to get a better sense of the genes.

Right now it seems impossible to do this, or is there a way to do it?

Thanks in advance!",Zepeng-Mu,https://github.com/Bioconductor/GenomicFeatures/issues/31
MDU6SXNzdWU5NDIxMzQ2MTY=,Fail to add stop_codon through makeTxDbFromGRanges,CLOSED,2021-07-12T14:39:37Z,2021-08-27T02:12:12Z,2021-08-27T02:12:12Z,"Hi,
    I'm not sure the function of drop.stop.codons in makeTxDbFromGRanges. 
    I could not add stop_codon to TxDb, when drop.stop.codons is FALSE.
    Thanks in advance.
Best wishes,
Liu",ggoodstudydaydayup,https://github.com/Bioconductor/GenomicFeatures/issues/32
MDU6SXNzdWU5NzA5NjA4NTA=,protein_coding_gene not recognized as valid gene feature,CLOSED,2021-08-14T17:28:43Z,2021-08-17T02:33:13Z,2021-08-17T02:33:13Z,"This genome from fungiDB:

https://fungidb.org/fungidb/app/record/dataset/NCBITAXON_235443

uses ""protein_coding_gene"" one of 3 top level features in column 3 of the gff3. The others are ncRNA_gene and pseudogene.

`makeTxDbFromGff` seems to recognize ncRNA_gene and pseudogene, but does not recognize protein_coding_gene. When I substituted 'gene' for 'protein_coding_gene' in the gff, `makeTxDbFromGff` worked as expected and parsed the gff correctly.

I'm actually not sure what the generally accepted source of truth is for the feature ontology, but I use this site:

http://www.sequenceontology.org/browser/current_release/term/SO:0001217

which indicates that protein_coding_gene is a valid feature at the same level as ncRNA_gene and pseudogene.

I can see this being addressed either in the code -- by adding protein_coding_gene as a 'gene' equivalent -- or in the documentation to make it clear what the expected ontology is.",cmatKhan,https://github.com/Bioconductor/GenomicFeatures/issues/33
I_kwDOBhavs8491z-o,`makeTxDbFromUCSC` fails with `!anyNA(m32) is not TRUE`,CLOSED,2021-10-27T14:47:50Z,2021-11-05T13:20:23Z,2021-11-05T13:20:23Z,"Hi,

I've been trying to create a txdb file with

```r
txdb_hg38 <- makeTxDbFromUCSC(genome = ""hg38"", tablename = ""knownGene"")
```

It fails with an output

```r
> txdb_hg38 <- makeTxDbFromUCSC(genome = ""hg38"", tablename = ""knownGene"")
Download the knownGene table ... OK
Download the knownToLocusLink table ... OK
Extract the 'transcripts' data frame ... OK
Extract the 'splicings' data frame ... Warning in .extract_cds_locs_from_UCSC_txtable(ucsc_txtable) :
  UCSC data anomaly in 21969 transcript(s): the cds cumulative length is not a multiple of 3 for transcripts
  ‘ENST00000341065.8’ ‘ENST00000455979.1’ ‘ENST00000466300.1’ ‘ENST00000624652.1’ ‘ENST00000434641.5’
  ‘ENST00000462097.5’ ‘ENST00000475119.5’ ‘ENST00000480643.1’ ‘ENST00000673999.1’ ‘ENST00000486379.1’
  ‘ENST00000403997.2’ ‘ENST00000509720.5’ ‘ENST00000422076.5’ ‘ENST00000488418.2’ ‘ENST00000379099.3’
  ‘ENST00000467712.1’ ‘ENST00000527383.5’ ‘ENST00000434694.6’ ‘ENST00000527719.5’ ‘ENST00000530031.5’
  ‘ENST00000534345.5’ ‘ENST00000498476.6’ ‘ENST00000470679.3’ ‘ENST00000525285.1’ ‘ENST00000488011.1’
  ‘ENST00000482621.5’ ‘ENST00000497013.1’ ‘ENST00000475091.2’ ‘ENST00000339113.9’ ‘ENST00000400830.4’
  ‘ENST00000510793.5’ ‘ENST00000503789.5’ ‘ENST00000514234.5’ ‘ENST00000472264.1’ ‘ENST00000435358.5’
  ‘ENST00000479362.1’ ‘ENST000004 [... truncated]
OK
Download and preprocess the 'chrominfo' data frame ... Error in .order_seqlevels(chrom_sizes[, ""chrom""]) : 
  !anyNA(m32) is not TRUE
OK
```

Traceback:
```r
Error in .order_seqlevels(chrom_sizes[, ""chrom""]) : 
!anyNA(m32) is not TRUE
9.
stop(simpleError(msg, call = if (p <- sys.parent(1L)) sys.call(p)))
8.
stopifnot(!anyNA(m32)) at hg38.R#36
7.
.order_seqlevels(chrom_sizes[, ""chrom""]) at hg38.R#67
6.
GET_CHROM_SIZES(goldenPath.url = goldenPath.url)
5.
.get_chrom_info_for_registered_UCSC_genome(script_path, assembled.molecules.only = assembled.molecules.only, 
map.NCBI = map.NCBI, add.ensembl.col = add.ensembl.col, goldenPath.url = goldenPath.url, 
recache = recache)
4.
getChromInfoFromUCSC(genome, goldenPath.url = goldenPath.url)
3.
.make_UCSC_chrominfo(genome, circ_seqs, goldenPath.url)
2.
.make_TxDb_from_UCSC_txtable(ucsc_txtable, txname2geneid$genes, 
genome, tablename, track, txname2geneid$gene_id_type, full_dataset = is.null(transcript_ids), 
circ_seqs = circ_seqs, goldenPath.url = goldenPath.url, taxonomyId = taxonomyId, 
miRBaseBuild = miRBaseBuild)
1.
makeTxDbFromUCSC(genome = ""hg38"", tablename = ""knownGene"")
```

Platform and R versions. The package version is the latest.
```
> version                     
platform       x86_64-conda-linux-gnu      
arch           x86_64                      
os             linux-gnu                   
system         x86_64, linux-gnu           
...             
version.string R version 4.1.1 (2021-08-10)
```

It's the first time I'm using this package (I need it to run `ORFik`).
Any help will be appreciated!
",edikedik,https://github.com/Bioconductor/GenomicFeatures/issues/34
I_kwDOBhavs84-vCWs,Why 'downstream' is set to 200 by default in getPromoterSeq(),CLOSED,2021-11-13T02:04:29Z,2022-05-07T16:01:12Z,2022-05-06T19:16:10Z,"@paul-shannon Paul?

https://support.bioconductor.org/p/9140532/#9140650

Thanks,
H.

",hpages,https://github.com/Bioconductor/GenomicFeatures/issues/35
I_kwDOBhavs84-yB0m,"makeTxDbFromGFF() how to handle entries lacking or duplicated ""transcript_id"" attribute  ",CLOSED,2021-11-15T07:24:46Z,2021-11-15T23:17:16Z,2021-11-15T23:12:05Z,"Hi, I'm getting these warnings when making a TxDb from a gff, which I rather avoid for my downstream analyses. 
How should I handle these instances, especially the ones that carry out as NA?
I checked and these entries are indeed there in the gff. I would rather save them if at all possible, but also ok with dropping the ones containing NA in the next step of my pipe `txdb.cds_by_transcript <- cdsBy(txdb, by=""tx"", use.names = TRUE) %>% drop_na(cds_name)` but `drop_na()` it's not applicable to that kind of object either.
```
> txdb <- makeTxDbFromGFF(""BFgenomic.gff"", format=""gff"")
Import genomic features from the file as a GRanges object ... OK
Prepare the 'metadata' data frame ... OK
Make the TxDb object ... OK
Warning messages:
1: In .extract_transcripts_from_GRanges(tx_IDX, gr, mcols0$type, mcols0$ID,  :
  some transcripts have no ""transcript_id"" attribute ==> their name (""tx_name"" column in
  the TxDb object) was set to NA
2: In .extract_transcripts_from_GRanges(tx_IDX, gr, mcols0$type, mcols0$ID,  :
  the transcript names (""tx_name"" column in the TxDb object) imported from the
  ""transcript_id"" attribute are not unique
```
Thank you,
-madza ",madzafv,https://github.com/Bioconductor/GenomicFeatures/issues/36
I_kwDOBhavs85AIY0L,GENE IDs are not loaded from UCSC tables using makeTxDbPackageFromUCSC,CLOSED,2021-12-09T19:46:34Z,2021-12-13T21:40:23Z,2021-12-11T10:28:15Z,"Hi,

I am trying to make a TxDb package for sus scrofa using UCSC tables by makeTxDbPackageFromUCSC; but for an unknown reason, the generated package(s) do not have any Gene IDs. Steps to reproduce:
 
```
require(biomaRt)
require(GenomicFeatures)

makeTxDbPackageFromUCSC(""0.0.1"", genome = ""susScr11"", tablename=""ncbiRefSeq"", circ_seqs=""chrM"")

```
 OUTPUT:
```
TxDb object:
# Db type: TxDb
# Supporting package: GenomicFeatures
# Data source: UCSC
# Genome: susScr11
# Organism: Sus scrofa
# Taxonomy ID: 9823
# UCSC Table: ncbiRefSeq
# UCSC Track: NCBI RefSeq
# Resource URL: http://genome.ucsc.edu/
# Type of Gene ID: no gene ids
# Full dataset: yes
# miRBase build ID: NA
# Nb of transcripts: 77708
# Db created by: GenomicFeatures package from Bioconductor
# Creation time: 2021-12-08 10:10:57 -0800 (Wed, 08 Dec 2021)
# GenomicFeatures version at creation time: 1.42.3
# RSQLite version at creation time: 2.2.4
# DBSCHEMAVERSION: 1.2

```

```
install.packages(""TxDb.Sscrofa.UCSC.susScr11.ncbiRefSeq"", repos = NULL, type = ""source"")


require(TxDb.Sscrofa.UCSC.susScr11.ncbiRefSeq)
txdb <- TxDb.Sscrofa.UCSC.susScr11.ncbiRefSeq
k <- keys(txdb, keytype = ""TXNAME"")
tx2gene <- select(txdb, k, ""GENEID"", ""TXNAME"")
head(tx2gene)

```

OUTPUT:
```
          TXNAME GENEID
1 XM_021085497.1   <NA>
2 NM_001244353.1   <NA>
3 XM_003353151.4   <NA>
4 XM_013992416.2   <NA>
5 XM_021085522.1   <NA>
6 XM_005659096.3   <NA>
```

I know in the UCSC table(s) listed here, there are GENE IDs: 

- ncbiRefSeq: [Details here](https://genome.ucsc.edu/cgi-bin/hgTables?db=susScr11&hgta_group=genes&hgta_track=refSeqComposite&hgta_table=ncbiRefSeq&hgta_doSchema=1)
- ncbiRefSeqPredicted: [Details here](https://genome.ucsc.edu/cgi-bin/hgTables?hgsid=1232667219_0KJa2AQ4SX3vlVusxbdQATrAn6rk&hgta_doSchemaDb=susScr11&hgta_doSchemaTable=ncbiRefSeqPredicted)

```
> sessionInfo()
R version 4.0.4 (2021-02-15)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] TxDb.Sscrofa.UCSC.susScr11.ncbiRefSeq_0.0.1         
 [2] TxDb.Sscrofa.UCSC.susScr11.ncbiRefSeqPredicted_0.0.1
 [3] GenomicFeatures_1.42.3                              
 [4] AnnotationDbi_1.52.0                                
 [5] Biobase_2.50.0                                      
 [6] rtracklayer_1.49.5                                  
 [7] GenomicRanges_1.42.0                                
 [8] GenomeInfoDb_1.26.4                                 
 [9] IRanges_2.24.1                                      
[10] S4Vectors_0.28.1                                    
[11] BiocGenerics_0.36.0                                 

loaded via a namespace (and not attached):
 [1] MatrixGenerics_1.2.1        httr_1.4.2                  splines_4.0.4              
 [4] bit64_4.0.5                 R.utils_2.10.1              assertthat_0.2.1           
 [7] DO.db_2.9                   askpass_1.1                 BiocManager_1.30.15        
[10] BiocFileCache_1.14.0        blob_1.2.1                  GenomeInfoDbData_1.2.4     
[13] Rsamtools_2.6.0             progress_1.2.2              pillar_1.6.1               
[16] RSQLite_2.2.4               lattice_0.20-41             glue_1.4.2                 
[19] XVector_0.30.0              qvalue_2.22.0               colorspace_2.0-1           
[22] R.oo_1.24.0                 plyr_1.8.6                  Matrix_1.3-4               
[25] XML_3.99-0.6                pkgconfig_2.0.3             biomaRt_2.46.3             
[28] zlibbioc_1.36.0             purrr_0.3.4                 GO.db_3.12.1               
[31] scales_1.1.1                BiocParallel_1.24.1         tibble_3.1.0               
[34] openssl_1.4.4               generics_0.1.0              ggplot2_3.3.3              
[37] ellipsis_0.3.2              cachem_1.0.4                SummarizedExperiment_1.20.0
[40] magrittr_2.0.1              crayon_1.4.1                memoise_2.0.0              
[43] DOSE_3.16.0                 R.methodsS3_1.8.1           fansi_0.4.2                
[46] xml2_1.3.2                  RMariaDB_1.1.2              tools_4.0.4                
[49] data.table_1.14.0           prettyunits_1.1.1           hms_1.0.0                  
[52] lifecycle_1.0.0             matrixStats_0.58.0          stringr_1.4.0              
[55] munsell_0.5.0               DelayedArray_0.16.3         Biostrings_2.58.0          
[58] compiler_4.0.4              rlang_0.4.10                grid_4.0.4                 
[61] RCurl_1.98-1.3              rstudioapi_0.13             rappdirs_0.3.3             
[64] bitops_1.0-6                gtable_0.3.0                DBI_1.1.1                  
[67] curl_4.3                    reshape2_1.4.4              R6_2.5.0                   
[70] lubridate_1.7.10            gridExtra_2.3               GenomicAlignments_1.26.0   
[73] dplyr_1.0.6                 fastmap_1.1.0               bit_4.0.4                  
[76] utf8_1.2.1                  fastmatch_1.1-0             fgsea_1.16.0               
[79] stringi_1.6.2               GOSemSim_2.16.1             Rcpp_1.0.7                 
[82] vctrs_0.3.8                 dbplyr_2.1.1                tidyselect_1.1.1   
```

Is this a bug or am I doing something wrong? 

Thank you.",farshadf,https://github.com/Bioconductor/GenomicFeatures/issues/37
I_kwDOBhavs85A1xFS,makeTxDbFromUCSC failing on check of txtable,CLOSED,2021-12-23T16:06:57Z,2021-12-23T23:14:34Z,2021-12-23T16:23:48Z,"DBI/RMariaDB is now returning a `blob` instead of a `list` for the exon starts and stops, so the check that the exon starts and stops column are `list` is failing.",jmacdon,https://github.com/Bioconductor/GenomicFeatures/issues/38
I_kwDOBhavs85BeYcq,promoters() returns out of range indicies,CLOSED,2022-01-10T23:14:08Z,2022-01-11T02:13:32Z,2022-01-11T02:13:32Z,"Should `promoters()` be allowed to return negative indicies?


When trying to use `getPromoterSeq()`, I received the following error:

```
Error in value[[3L]](cond) : 
   record 6097 (CP022322.1:-380-19) was truncated
  file: /home/chase/projects/brentlab/kn99_database/genome_files/kn99/KN99_fungiDB/FungiDB-53_CneoformansKN99_Genome.fasta
```

Upon inspecting the promoter regions with the same setting , `upstream = 400`, as I had used in `getPromoterSeq`, I discovered that there are two genes which, with this promoter definition, return negative values due to the fact that they are annotated at the very beginning of the chromosome such that 400bp upstream causes the promoter range to be returned as a negative value:

```
> promoters[promoters@ranges@start < 0]
GRanges object with 2 ranges and 2 metadata columns:
                      seqnames    ranges strand |     tx_id           tx_name
                         <Rle> <IRanges>  <Rle> | <integer>       <character>
  CKF44_06802-t26_1 CP022322.1  -380-219      + |      1106 CKF44_06802-t26_1
  CKF44_09000-t26_1 CP022335.1  -380-219      + |      9174 CKF44_09000-t26_1 
```

I confirmed that this was, in fact, the cause of the error in  `getPromoterSeq()` by setting `upstream` to 20 or less, so that no negative values are returned, and  `getPromoterSeq()` returned without error.

Possibly in the `promoters` function, a warning should be issued? Alternatively, if the definition of the promoter places the upstream/downstream indicies out of range of the chromosome, maybe setting to the chromosome limit (0 or length(chromosome)) would be appropriate? Maybe this should be an argument, something like, `handle_out_of_bound_indicies = TRUE` by default?",cmatKhan,https://github.com/Bioconductor/GenomicFeatures/issues/40
I_kwDOBhavs85B6pxG,error unknown,CLOSED,2022-01-17T14:01:34Z,2022-01-20T03:40:44Z,2022-01-20T03:40:44Z,"tried
`db <- makeFeatureDbFromUCSC(genome=""hg38"",tablename=""ncbiRefSeq"",track=""NCBI RefSeq"")`
got
`Error: near ""'none'"": syntax error`
same effect with
`UCSCFeatureDbTableSchema()`
although supported by
`supportedUCSCFeatureDbTables(genome=""hg38"", track=""NCBI RefSeq"") `",under-score,https://github.com/Bioconductor/GenomicFeatures/issues/41
I_kwDOBhavs85GB2oA,exonsBy Option to Resize Exons for Splicing Donor and Acceptor Regions,CLOSED,2022-03-21T05:00:03Z,2022-03-22T04:44:23Z,2022-03-22T04:44:23Z,"Could `exonsBy` get an option that resizes the exons so that the GT/AG donor/acceptor regions are also included (i.e. two bases into the introns)? This would involve special handing of the first and last exon. Then, the resulting list would be directly useful as the `which` parameter for `ScanVcfParam` if attempting to annotate coding and splice site mutations with whole genome sequencing data but wanting to avoid all of the variants that are intronic or intergenic for computation time.",DarioS,https://github.com/Bioconductor/GenomicFeatures/issues/43
I_kwDOBhavs85IZNpo,threeUTRsByTranscript() and fiveUTRsByTranscript() are not working correctly on minus strand,CLOSED,2022-04-25T14:08:19Z,2023-03-15T17:25:16Z,2023-03-15T17:25:16Z,"After making txdb out of a GTF file, when making UTR ranges of a gene on minus strand, the functions switch 3UTR and 5UTR around and only return a single exon. Additionally, if the UTR is composed of a single exon, it's not shown at all. I've attached example GTF files containing a single gene:

[good_UTRs_plus_strand.gtf.txt](https://github.com/Bioconductor/GenomicFeatures/files/8555213/good_UTRs_plus_strand.gtf.txt) - works well
[bad_UTRs_minus_strand.gtf.txt](https://github.com/Bioconductor/GenomicFeatures/files/8555211/bad_UTRs_minus_strand.gtf.txt) - switches UTRs
[bad_UTRs_minus_strand_single_exon.gtf.txt](https://github.com/Bioconductor/GenomicFeatures/files/8555212/bad_UTRs_minus_strand_single_exon.gtf.txt)  - returns no UTRs

This is the code I run:
```
ref_gff_file_fixed = file.path(WORK_FOLDER,'/bad_UTRs_minus_strand_single_exon.gtf')
txdb = makeTxDbFromGFF(ref_gff_file_fixed,chrominfo = chrominfo)
threeUTRs_by_tx = threeUTRsByTranscript(txdb,use.names=T)
fiveUTRs_by_tx = fiveUTRsByTranscript(txdb,use.names=T)
```

R version 3.6.3 (2020-02-29)
package version: 1.38.2

Thanks!",anmej,https://github.com/Bioconductor/GenomicFeatures/issues/44
I_kwDOBhavs85IcsVe,ExtractTranscriptSeqs extracted sequences with non-base,CLOSED,2022-04-26T06:48:22Z,2022-04-26T15:22:52Z,2022-04-26T15:22:51Z,"Hi, 

I want to use extractTranscriptSeqs to extract the CDS sequence corresponding to SNP and get the corresponding protein sequence, and the following is my code:
```
ref_genome <- BSgenome.Hsapiens.UCSC.hg38
alt_genome <- injectSNPs(ref_genome, SNPlocs.Hsapiens.dbSNP141.GRCh38)

cds<-cdsBy(txdb, by=""tx"", use.names=TRUE)
extractcds<-extractTranscriptSeqs(alt_genome,cds)
```
I found that if I do this, the final sequence will have many non-bases, such as ""R"", ""W"", ""S"", etc. I don't understand what kind of information these letters represent? How should I modify the code if I want to use the translate function of Biostrings?

Thanks,
LeeLee",lbwfff,https://github.com/Bioconductor/GenomicFeatures/issues/45
I_kwDOBhavs85IyRwz,How to find the reference to an organism in the organism database?,CLOSED,2022-04-29T15:53:59Z,2022-04-29T16:27:35Z,2022-04-29T16:05:46Z,"Hi - I've created a txdb object using makeTxDbFromEnsembl(organism = ""Equus caballus"", release=103) but I can't create a gene annotation file from this. Specifically, I'm using the ArchR function createGeneAnnotation which has as parameters the txdb object previously created and OrgDb, which their docs says is ""An OrgDb object (organism database) from Bioconductor."" How do I find a list of OrgDb objects (or, better yet, how do I find the name of the object I need for Equus caballus)?",prmunn,https://github.com/Bioconductor/GenomicFeatures/issues/46
I_kwDOBhavs85I9xK_,Find coordinates of all known transcription start and termination sites (TSS TTS) for a gene,CLOSED,2022-05-03T14:04:19Z,2022-06-09T18:52:11Z,2022-06-09T15:11:46Z,"The extractUpstreamSeqs(FaFile, x) function where x is either a transcript-wise or gene-wise GRanges object gives tss_genes metadata column which is expected to give the coordinates of the transcription splice site (TSS) per transcript or gene, depending on the input. However, in case of transcript-wise GRanges as input, this output TSS coordinate is same as the start of the first exon of that transcript, when in fact the TSS must be upstream this loci. [For gene-wise GRanges input, the TSS is the first (i.e. most upstream) of all transcript-wise TSSs.]

Given a list of transcripts of gene (ensembl IDs such as ENSTxxx and ENSGxxx), I wish to find all TSS within that gene and subsequently group transcripts sharing a common TSS. Could you guide me if such an analysis is possible via GenomicFeatures package? Furthermore, could a similar set-up be performed for transcription termination sites (TTS) for transcripts of a gene?",pgupta3005,https://github.com/Bioconductor/GenomicFeatures/issues/47
I_kwDOBhavs85JVIbc,makeTxDbFromBiomart error when querying fungi hosts,CLOSED,2022-05-09T21:34:50Z,2022-05-19T19:03:00Z,2022-05-19T17:47:32Z,"Related to an issue with `useEnsembl`  caching reported at https://github.com/grimbough/biomaRt/issues/64: 

```r
> yeast_txdb <- makeTxDbFromBiomart(biomart=""fungi_mart"",
+                                   dataset=""scerevisiae_eg_gene"",
+                                   host=""https://fungi.ensembl.org"")
Error in useEnsembl(biomart = biomart, dataset = dataset, host = host) : 
  Incorrect BioMart name, use the listMarts function to see which BioMart databases are available
Calls: makeTxDbFromBiomart -> .useMart2 -> useEnsembl
Execution halted
```
",LiNk-NY,https://github.com/Bioconductor/GenomicFeatures/issues/48
I_kwDOBhavs85KiQsK,makeTxDbFromEnsembl for Ensembl AnnotationHub objects?,CLOSED,2022-05-27T08:34:19Z,2022-05-27T16:36:44Z,2022-05-27T16:36:44Z,"Hi,

I was trying to make txdb object from `AnnotationHub` Ensembl releases using the  `makeTxDbFromEnsembl` function, as this is what I thought this function did from its description line.

> The makeTxDbFromEnsembl function creates a TxDb object for a given organism by importing the genomic locations of its transcripts, exons, CDS, and genes from an Ensembl database.

```r
ens106 = AnnotationHub::AnnotationHub()[[""AH100643""]]
txdb = GenomicFeatures::makeTxDbFromEnsembl(ens106)
# Error in .normarg_organism(organism) : 'organism' must be a single string
```

Reading the documentation more carefully (hence the edit), I realize that this function is not supposed to work on `AnnotationHub` objects.

However, would it make sense to provide this functionality?

<details>
<summary>sessionInfo</summary>

```
R version 4.2.0 (2022-04-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.4 LTS

other attached packages:
 [1] ensembldb_2.20.1        AnnotationFilter_1.20.0
 [3] GenomicFeatures_1.48.1  AnnotationDbi_1.58.0
 [5] Biobase_2.56.0          GenomicRanges_1.48.0
 [7] GenomeInfoDb_1.32.2     IRanges_2.30.0
 [9] S4Vectors_0.34.0        BiocGenerics_0.42.0
```

</details>",mschubert,https://github.com/Bioconductor/GenomicFeatures/issues/49
I_kwDOBhavs85LLsBR,makeTxDbFromUCSC fails to connect to UCSC server,CLOSED,2022-06-06T05:06:35Z,2022-06-30T23:23:53Z,2022-06-30T23:23:52Z,"Hi, I have been getting this error and am unsure how to resolve it as I don't seem to see anyone else encountering this issue.
```
> hg38.refseq.db <- makeTxDbFromUCSC(genome=""hg38"", table=""refGene"")
Download the refGene table ... Error: Failed to connect: Can't connect to server on 'genome-mysql.soe.ucsc.edu' (10061)
OK
```

Apologies if it is a trivial issue but I have tried updating everything and restarting my sessions yet nothing seems to be working. I don't think it is a wifi issue since I am able to run `browseUCSCtrack(""hg38"", ""refGene"")` fine, though I'm not sure how else to check it. I am currently using GenomicFeatures version 1.48.3 on R version 4.2.0 if it is relevant. ",ameliaregina,https://github.com/Bioconductor/GenomicFeatures/issues/50
I_kwDOBhavs85LmHBq,"makeTxDbFromGFF fails, possibly due to download.file / restfulr?",CLOSED,2022-06-11T13:48:04Z,2023-03-15T17:23:32Z,2023-03-15T17:23:32Z,"Hi wonderful GenomicFeatures people,

Genomic features isn't working as expected for me. We found this through a tximeta step which broke (which I reportted here https://github.com/mikelove/tximeta/issues/65). Hope I have included enough here to figure out what is going on.

> BiocManager::valid()
[1] TRUE

> library(GenomicFeatures)

> txdb <- makeTxDbFromGFF(""ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_mouse/release_M28/gencode.vM28.annotation.gtf.gz"") #
Import genomic features from the file as a GRanges object ... Error in (function (classes, fdef, mtable)  : 
  unable to find an inherited method for function 'download.file' for signature '""character""'
> 

restfulr could the problem.

restfulr::download.file(""ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_mouse/release_M28/gencode.vM28.annotation.gtf.gz"")
Error in (function (classes, fdef, mtable) :
unable to find an inherited method for function ‘download.file’ for signature ‘""character""’



> sessionInfo()
R version 4.2.0 (2022-04-22)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Monterey 12.3.1

Matrix products: default
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] GenomicFeatures_1.49.5 AnnotationDbi_1.59.1   Biobase_2.57.1         GenomicRanges_1.49.0   GenomeInfoDb_1.33.3    IRanges_2.31.0         S4Vectors_0.35.1      
 [8] BiocGenerics_0.43.0    restfulr_0.0.14        tximeta_1.15.0         workflowr_1.7.0       

loaded via a namespace (and not attached):
  [1] rjson_0.2.21                  ellipsis_0.3.2                rprojroot_2.0.3               XVector_0.37.0                fs_1.5.2                     
  [6] rstudioapi_0.13               remotes_2.4.2                 bit64_4.0.5                   interactiveDisplayBase_1.35.0 fansi_1.0.3                  
 [11] xml2_1.3.3                    codetools_0.2-18              tximport_1.25.0               cachem_1.0.6                  knitr_1.39                   
 [16] pkgload_1.2.4                 jsonlite_1.8.0                Rsamtools_2.13.3              dbplyr_2.2.0                  png_0.1-7                    
 [21] shiny_1.7.1                   readr_2.1.2                   BiocManager_1.30.18           compiler_4.2.0                httr_1.4.3                   
 [26] lazyeval_0.2.2                assertthat_0.2.1              Matrix_1.4-1                  fastmap_1.1.0                 cli_3.3.0                    
 [31] later_1.3.0                   htmltools_0.5.2               prettyunits_1.1.1             tools_4.2.0                   glue_1.6.2                   
 [36] GenomeInfoDbData_1.2.8        dplyr_1.0.9                   rappdirs_0.3.3                Rcpp_1.0.8.3                  vctrs_0.4.1                  
 [41] Biostrings_2.65.1             rtracklayer_1.57.0            xfun_0.31                     stringr_1.4.0                 ps_1.7.0                     
 [46] brio_1.1.3                    testthat_3.1.4                mime_0.12                     lifecycle_1.0.1               ensembldb_2.21.1             
 [51] devtools_2.4.3                XML_3.99-0.10                 AnnotationHub_3.5.0           getPass_0.2-2                 zlibbioc_1.43.0              
 [56] vroom_1.5.7                   ProtGenerics_1.29.0           hms_1.1.1                     promises_1.2.0.1              MatrixGenerics_1.9.0         
 [61] parallel_4.2.0                SummarizedExperiment_1.27.1   AnnotationFilter_1.21.0       yaml_2.3.5                    curl_4.3.2                   
 [66] memoise_2.0.1                 biomaRt_2.53.2                stringi_1.7.6                 RSQLite_2.2.14                BiocVersion_3.16.0           
 [71] BiocIO_1.7.1                  desc_1.4.1                    filelock_1.0.2                pkgbuild_1.3.1                BiocParallel_1.31.8          
 [76] rlang_1.0.2                   pkgconfig_2.0.3               bitops_1.0-7                  matrixStats_0.62.0            lattice_0.20-45              
 [81] evaluate_0.15                 purrr_0.3.4                   GenomicAlignments_1.33.0      bit_4.0.4                     processx_3.6.0               
 [86] tidyselect_1.1.2              magrittr_2.0.3                R6_2.5.1                      generics_0.1.2                DelayedArray_0.23.0          
 [91] DBI_1.1.2                     pillar_1.7.0                  whisker_0.4                   withr_2.5.0                   KEGGREST_1.37.2              
 [96] RCurl_1.98-1.7                tibble_3.1.7                  crayon_1.5.1                  utf8_1.2.2                    BiocFileCache_2.5.0          
[101] tzdb_0.3.0                    rmarkdown_2.14                progress_1.2.2                usethis_2.1.6                 grid_4.2.0                   
[106] blob_1.2.3                    callr_3.7.0                   git2r_0.30.1                  digest_0.6.29                 xtable_1.8-4                 
[111] httpuv_1.6.5                  sessioninfo_1.2.2  

",AMChalkie,https://github.com/Bioconductor/GenomicFeatures/issues/51
I_kwDOBhavs85SFrFh,makeTxDbPackageFromUCSC failed ,CLOSED,2022-09-18T23:53:22Z,2023-03-15T17:21:24Z,2023-03-15T17:21:23Z,"It doesn't even run for the example:
```
makeTxDbPackageFromUCSC(version=""0.01"",
                        maintainer=""Some One <so@someplace.org>"",
                        author=""Some One <so@someplace.com>"",
                        genome=""sacCer2"",
                        tablename=""ensGene"")
```

It gives the following error: 
```
Error in makeTxDbPackageFromUCSC(version = ""0.01"", maintainer = ""Some One <so@someplace.org>"",  : 
  'circ_seqs' must be supplied as a named character vector.
```

The following line seems to cause the problem: 
```
    if(!is.character(circ_seqs) || length(circ_seqs)<1){
        stop(""'circ_seqs' must be supplied as a named character vector."")}
```

The default value for `circ_seqs` (NULL) won't pass this line. 
",haowulab,https://github.com/Bioconductor/GenomicFeatures/issues/52
I_kwDOBhavs85YPX5J,Create custom TxDb Package from NCBI GFF file,CLOSED,2022-12-06T23:08:35Z,2022-12-07T11:22:54Z,2022-12-07T11:22:54Z,"
Hi,
I am trying to build a custom TxDb package but having errors at makeTxDbpackage step. Please, could you help with resolving the errors?  Code used below. Thanks.

> dir <- ""C:/Users/XX/AppData/Local/R/win-library/4.2/GenomicFeatures/extdata/seq""
> gffmodel <- file.path(dir,""GCF_009819885.2_bCatUst1.pri.v2_genomic.gff"")
> (txdb <- makeTxDbFromGFF(file=""GCF_009819885.2_bCatUst1.pri.v2.gff"", format=""gff3"", dataSource = ""https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/819/885/GCF_009819885.2_bCatUst1.pri.v2/"", organism = ""Catharus ustulatus""))

Import genomic features from the file as a GRanges object ... OK
Prepare the 'metadata' data frame ... OK
Make the TxDb object ... OK
TxDb object:
# Db type: TxDb
# Supporting package: GenomicFeatures
# Data source: https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/819/885/GCF_009819885.2_bCatUst1.pri.v2/
# Organism: Catharus ustulatus
# Taxonomy ID: 91951
# miRBase build ID: NA
# Genome: NA
# Nb of transcripts: 40735
# Db created by: GenomicFeatures package from Bioconductor
# Creation time: 2022-12-06 16:31:04 -0600 (Tue, 06 Dec 2022)
# GenomicFeatures version at creation time: 1.50.2
# RSQLite version at creation time: 2.2.19
# DBSCHEMAVERSION: 1.2
Warning messages:
1: In .extract_transcripts_from_GRanges(tx_IDX, gr, mcols0$type, mcols0$ID,  :
  some transcripts have no ""transcript_id"" attribute ==> their
  name (""tx_name"" column in the TxDb object) was set to NA
2: In .extract_transcripts_from_GRanges(tx_IDX, gr, mcols0$type, mcols0$ID,  :
  the transcript names (""tx_name"" column in the TxDb object)
  imported from the ""transcript_id"" attribute are not unique

> txdb
TxDb object:
# Db type: TxDb
# Supporting package: GenomicFeatures
# Data source: https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/819/885/GCF_009819885.2_bCatUst1.pri.v2/
# Organism: Catharus ustulatus
# Taxonomy ID: 91951
# miRBase build ID: NA
# Genome: NA
# Nb of transcripts: 40735
# Db created by: GenomicFeatures package from Bioconductor
# Creation time: 2022-12-06 16:31:04 -0600 (Tue, 06 Dec 2022)
# GenomicFeatures version at creation time: 1.50.2
# RSQLite version at creation time: 2.2.19
# DBSCHEMAVERSION: 1.2

> saveDb(txdb, file=""Custulatus.sqlite"")
TxDb object:
# Db type: TxDb
# Supporting package: GenomicFeatures
# Data source: https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/819/885/GCF_009819885.2_bCatUst1.pri.v2/
# Organism: Catharus ustulatus
# Taxonomy ID: 91951
# miRBase build ID: NA
# Genome: NA
# Nb of transcripts: 40735
# Db created by: GenomicFeatures package from Bioconductor
# Creation time: 2022-12-06 16:31:04 -0600 (Tue, 06 Dec 2022)
# GenomicFeatures version at creation time: 1.50.2
# RSQLite version at creation time: 2.2.19
# DBSCHEMAVERSION: 1.2
> con <- dbconn(txdb)
> DBI::dbGetQuery(con, ""INSERT INTO metadata VALUES ('Resource URL', 'https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/009/819/885/GCF_009819885.2_bCatUst1.pri.v2/');"")
data frame with 0 columns and 0 rows
Warning message:
In result_fetch(res@ptr, n = n) :
  SQL statements must be issued with dbExecute() or dbSendStatement() instead of dbGetQuery() or dbSendQuery().

> makeTxDbPackage(txdb, version=""1.2"", maintainer=""X X <X@zzz.edu>"", author=""X X"", destDir= ""C:/Users/X/AppData/Local/R/win-library/4.2/GenomicFeatures/exdata/seq"")
Error in createPackage(pkgname = pkgname, destinationDir = destDir, originDir = template_path,  : 
  'destinationDir' must be a directory (C:/Users/X/AppData/Local/R/win-library/4.2/GenomicFeatures/exdata/seq)",sopeadeniji,https://github.com/Bioconductor/GenomicFeatures/issues/53
I_kwDOBhavs85bSHaU,mapToTranscripts reports incorrect regions when supplied GRangesList containing some empty transcripts,OPEN,2023-01-12T23:12:01Z,2023-01-12T23:12:01Z,,"I experienced an error similar to one reported on the [support site](https://support.bioconductor.org/p/9141351/). Incorrect annotations are returned when calling a VariantAnnotation function (`locateVariants()` with  `region = IntronVariants()` ) that internally uses `mapToTranscripts` .  

I believe this error is caused by passing a list containing some empty transcripts to the `transcripts` argument of `mapToTranscripts()`.  This can be fixed by removing the empty transcripts, but perhaps it might be useful to signal an error to the user in this condition or handle this internally? As far as i can tell, the erroneous mapping occurs in the `.orderElementsByTranscription` function.

Here is a reprex using the example provided on the support site and an example of how  `.orderElementsByTranscription` will reorder/duplicate transcripts in the presence of empty list elements. 

``` r
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(GenomicFeatures)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene

# generate a grl with some zero length entries
grl <- intronsByTranscript(txdb)
sum(elementNROWS(grl) == 0)
#> [1] 10556

gr <- GRanges(seqnames = ""chr5"",
              ranges = IRanges(start = 20298238,
                               end = 20298238))
genome(gr) <- ""hg19""

tx <- mapToTranscripts(gr, grl)
tx
#> GRanges object with 1 range and 2 metadata columns:
#>       seqnames    ranges strand |     xHits transcriptsHits
#>          <Rle> <IRanges>  <Rle> | <integer>       <integer>
#>   [1]    19778    277333      - |         1           19778
#>   -------
#>   seqinfo: 82960 sequences from an unspecified genome

## wrong transcript is mapped
grl[[seqnames(tx)]]
#> GRanges object with 3 ranges and 0 metadata columns:
#>       seqnames              ranges strand
#>          <Rle>           <IRanges>  <Rle>
#>   [1]     chr4 110610725-110612005      -
#>   [2]     chr4 110612166-110615680      -
#>   [3]     chr4 110615857-110624511      -
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome

## should map to last entry (14) in this transcript
grl[[subjectHits(findOverlaps(gr, grl))]]
#> GRanges object with 14 ranges and 0 metadata columns:
#>        seqnames            ranges strand
#>           <Rle>         <IRanges>  <Rle>
#>    [1]     chr5 19473826-19483409      -
#>    [2]     chr5 19483662-19503100      -
#>    [3]     chr5 19503219-19520765      -
#>    [4]     chr5 19520888-19543977      -
#>    [5]     chr5 19544115-19571687      -
#>    ...      ...               ...    ...
#>   [10]     chr5 19747346-19838867      -
#>   [11]     chr5 19839352-19981168      -
#>   [12]     chr5 19981288-19991981      -
#>   [13]     chr5 19992124-20255552      -
#>   [14]     chr5 20255615-20575570      -
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome

## removing empty entries returns correct transcript
grl_no_zero  <- grl[elementNROWS(grl) > 0]
tx2 <- mapToTranscripts(gr, grl_no_zero)
grl_no_zero[[seqnames(tx2)]]
#> GRanges object with 14 ranges and 0 metadata columns:
#>        seqnames            ranges strand
#>           <Rle>         <IRanges>  <Rle>
#>    [1]     chr5 19473826-19483409      -
#>    [2]     chr5 19483662-19503100      -
#>    [3]     chr5 19503219-19520765      -
#>    [4]     chr5 19520888-19543977      -
#>    [5]     chr5 19544115-19571687      -
#>    ...      ...               ...    ...
#>   [10]     chr5 19747346-19838867      -
#>   [11]     chr5 19839352-19981168      -
#>   [12]     chr5 19981288-19991981      -
#>   [13]     chr5 19992124-20255552      -
#>   [14]     chr5 20255615-20575570      -
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome

## looks like .orderElementsByTranscription changes the order of elements 
## in the `grl` list when zero-length elements are in grl?
## e.g. the transcript in grl[[7]] != the transcript in ord_grl[[7]]
ord_grl <- GenomicFeatures:::.orderElementsByTranscription(grl)

# list with 1 empty entry 
grl[c(3,4,7)]
#> GRangesList object of length 3:
#> $`3`
#> GRanges object with 2 ranges and 0 metadata columns:
#>       seqnames      ranges strand
#>          <Rle>   <IRanges>  <Rle>
#>   [1]     chr1 12228-12645      +
#>   [2]     chr1 12698-13220      +
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome
#> 
#> $`4`
#> GRanges object with 0 ranges and 0 metadata columns:
#>    seqnames    ranges strand
#>       <Rle> <IRanges>  <Rle>
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome
#> 
#> $`7`
#> GRanges object with 2 ranges and 0 metadata columns:
#>       seqnames        ranges strand
#>          <Rle>     <IRanges>  <Rle>
#>   [1]     chr1 322229-324287      +
#>   [2]     chr1 324346-324438      +
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome

# first entry is duplicated at position 3
GenomicFeatures:::.orderElementsByTranscription(grl[c(3,4,7)])
#> GRangesList object of length 3:
#> $`3`
#> GRanges object with 2 ranges and 1 metadata column:
#>       seqnames      ranges strand | unordered
#>          <Rle>   <IRanges>  <Rle> | <integer>
#>   [1]     chr1 12228-12645      + |         1
#>   [2]     chr1 12698-13220      + |         2
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome
#> 
#> $`4`
#> GRanges object with 0 ranges and 1 metadata column:
#>    seqnames    ranges strand | unordered
#>       <Rle> <IRanges>  <Rle> | <integer>
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome
#> 
#> $`7`
#> GRanges object with 2 ranges and 1 metadata column:
#>       seqnames      ranges strand | unordered
#>          <Rle>   <IRanges>  <Rle> | <integer>
#>   [1]     chr1 12228-12645      + |         1
#>   [2]     chr1 12698-13220      + |         2
#>   -------
#>   seqinfo: 93 sequences (1 circular) from hg19 genome
```

<sup>Created on 2023-01-12 with [reprex v2.0.2](https://reprex.tidyverse.org)</sup>

<details style=""margin-bottom:10px;"">
<summary>
Session info
</summary>

``` r
sessioninfo::session_info()
#> ─ Session info ───────────────────────────────────────────────────────────────
#>  setting  value
#>  version  R Under development (unstable) (2022-10-30 r83209)
#>  os       macOS Monterey 12.2.1
#>  system   aarch64, darwin20
#>  ui       X11
#>  language (EN)
#>  collate  en_US.UTF-8
#>  ctype    en_US.UTF-8
#>  tz       America/Denver
#>  date     2023-01-12
#>  pandoc   2.19.2 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)
#> 
#> ─ Packages ───────────────────────────────────────────────────────────────────
#>  package                           * version   date (UTC) lib source
#>  AnnotationDbi                     * 1.61.0    2022-11-01 [1] Bioconductor
#>  assertthat                          0.2.1     2019-03-21 [1] CRAN (R 4.3.0)
#>  Biobase                           * 2.59.0    2022-11-01 [1] Bioconductor
#>  BiocFileCache                       2.7.1     2022-12-09 [1] Bioconductor
#>  BiocGenerics                      * 0.45.0    2022-11-01 [1] Bioconductor
#>  BiocIO                              1.9.1     2022-11-24 [1] Bioconductor
#>  BiocParallel                        1.33.9    2022-12-23 [1] Bioconductor
#>  biomaRt                             2.55.0    2022-11-01 [1] Bioconductor
#>  Biostrings                          2.67.0    2022-11-01 [1] Bioconductor
#>  bit                                 4.0.5     2022-11-15 [1] CRAN (R 4.3.0)
#>  bit64                               4.0.5     2020-08-30 [1] CRAN (R 4.3.0)
#>  bitops                              1.0-7     2021-04-24 [1] CRAN (R 4.3.0)
#>  blob                                1.2.3     2022-04-10 [1] CRAN (R 4.3.0)
#>  cachem                              1.0.6     2021-08-19 [1] CRAN (R 4.3.0)
#>  cli                                 3.6.0     2023-01-09 [1] CRAN (R 4.3.0)
#>  codetools                           0.2-18    2020-11-04 [1] CRAN (R 4.3.0)
#>  crayon                              1.5.2     2022-09-29 [1] CRAN (R 4.3.0)
#>  curl                                5.0.0     2023-01-12 [1] CRAN (R 4.3.0)
#>  DBI                                 1.1.3     2022-06-18 [1] CRAN (R 4.3.0)
#>  dbplyr                              2.2.1     2022-06-27 [1] CRAN (R 4.3.0)
#>  DelayedArray                        0.25.0    2022-11-01 [1] Bioconductor
#>  digest                              0.6.31    2022-12-11 [1] CRAN (R 4.3.0)
#>  dplyr                               1.0.10    2022-09-01 [1] CRAN (R 4.3.0)
#>  ellipsis                            0.3.2     2021-04-29 [1] CRAN (R 4.3.0)
#>  evaluate                            0.19      2022-12-13 [1] CRAN (R 4.3.0)
#>  fansi                               1.0.3     2022-03-24 [1] CRAN (R 4.3.0)
#>  fastmap                             1.1.0     2021-01-25 [1] CRAN (R 4.3.0)
#>  filelock                            1.0.2     2018-10-05 [1] CRAN (R 4.3.0)
#>  fs                                  1.5.2     2021-12-08 [1] CRAN (R 4.3.0)
#>  generics                            0.1.3     2022-07-05 [1] CRAN (R 4.3.0)
#>  GenomeInfoDb                      * 1.35.10   2023-01-03 [1] Bioconductor
#>  GenomeInfoDbData                    1.2.9     2022-11-08 [1] Bioconductor
#>  GenomicAlignments                   1.35.0    2022-11-01 [1] Bioconductor
#>  GenomicFeatures                   * 1.51.4    2022-12-23 [1] Bioconductor
#>  GenomicRanges                     * 1.51.4    2022-12-15 [1] Bioconductor
#>  glue                                1.6.2     2022-02-24 [1] CRAN (R 4.3.0)
#>  highr                               0.10      2022-12-22 [1] CRAN (R 4.3.0)
#>  hms                                 1.1.2     2022-08-19 [1] CRAN (R 4.3.0)
#>  htmltools                           0.5.4     2022-12-07 [1] CRAN (R 4.3.0)
#>  httr                                1.4.4     2022-08-17 [1] CRAN (R 4.3.0)
#>  IRanges                           * 2.33.0    2022-11-01 [1] Bioconductor
#>  KEGGREST                            1.39.0    2022-11-01 [1] Bioconductor
#>  knitr                               1.41      2022-11-18 [1] CRAN (R 4.3.0)
#>  lattice                             0.20-45   2021-09-22 [1] CRAN (R 4.3.0)
#>  lifecycle                           1.0.3     2022-10-07 [1] CRAN (R 4.3.0)
#>  magrittr                            2.0.3     2022-03-30 [1] CRAN (R 4.3.0)
#>  Matrix                              1.5-3     2022-11-11 [1] CRAN (R 4.3.0)
#>  MatrixGenerics                      1.11.0    2022-11-01 [1] Bioconductor
#>  matrixStats                         0.63.0    2022-11-18 [1] CRAN (R 4.3.0)
#>  memoise                             2.0.1     2021-11-26 [1] CRAN (R 4.3.0)
#>  pillar                              1.8.1     2022-08-19 [1] CRAN (R 4.3.0)
#>  pkgconfig                           2.0.3     2019-09-22 [1] CRAN (R 4.3.0)
#>  png                                 0.1-8     2022-11-29 [1] CRAN (R 4.3.0)
#>  prettyunits                         1.1.1     2020-01-24 [1] CRAN (R 4.3.0)
#>  progress                            1.2.2     2019-05-16 [1] CRAN (R 4.3.0)
#>  purrr                               1.0.1     2023-01-10 [1] CRAN (R 4.3.0)
#>  R.cache                             0.16.0    2022-07-21 [1] CRAN (R 4.3.0)
#>  R.methodsS3                         1.8.2     2022-06-13 [1] CRAN (R 4.3.0)
#>  R.oo                                1.25.0    2022-06-12 [1] CRAN (R 4.3.0)
#>  R.utils                             2.12.2    2022-11-11 [1] CRAN (R 4.3.0)
#>  R6                                  2.5.1     2021-08-19 [1] CRAN (R 4.3.0)
#>  rappdirs                            0.3.3     2021-01-31 [1] CRAN (R 4.3.0)
#>  Rcpp                                1.0.9     2022-07-08 [1] CRAN (R 4.3.0)
#>  RCurl                               1.98-1.9  2022-10-03 [1] CRAN (R 4.3.0)
#>  reprex                              2.0.2     2022-08-17 [1] CRAN (R 4.3.0)
#>  restfulr                            0.0.15    2022-06-16 [1] CRAN (R 4.3.0)
#>  rjson                               0.2.21    2022-01-09 [1] CRAN (R 4.3.0)
#>  rlang                               1.0.6     2022-09-24 [1] CRAN (R 4.3.0)
#>  rmarkdown                           2.19      2022-12-15 [1] CRAN (R 4.3.0)
#>  Rsamtools                           2.15.1    2022-12-30 [1] Bioconductor
#>  RSQLite                             2.2.20    2022-12-22 [1] CRAN (R 4.3.0)
#>  rstudioapi                          0.14      2022-08-22 [1] CRAN (R 4.3.0)
#>  rtracklayer                         1.59.1    2022-12-27 [1] Bioconductor
#>  S4Vectors                         * 0.37.3    2022-12-07 [1] Bioconductor
#>  sessioninfo                         1.2.2     2021-12-06 [1] CRAN (R 4.3.0)
#>  stringi                             1.7.12    2023-01-11 [1] CRAN (R 4.3.0)
#>  stringr                             1.5.0     2022-12-02 [1] CRAN (R 4.3.0)
#>  styler                              1.8.1     2022-11-07 [1] CRAN (R 4.3.0)
#>  SummarizedExperiment                1.29.1    2022-11-04 [1] Bioconductor
#>  tibble                              3.1.8     2022-07-22 [1] CRAN (R 4.3.0)
#>  tidyselect                          1.2.0     2022-10-10 [1] CRAN (R 4.3.0)
#>  TxDb.Hsapiens.UCSC.hg19.knownGene * 3.2.2     2023-01-12 [1] Bioconductor
#>  utf8                                1.2.2     2021-07-24 [1] CRAN (R 4.3.0)
#>  vctrs                               0.5.1     2022-11-16 [1] CRAN (R 4.3.0)
#>  withr                               2.5.0     2022-03-03 [1] CRAN (R 4.3.0)
#>  xfun                                0.36      2022-12-21 [1] CRAN (R 4.3.0)
#>  XML                                 3.99-0.13 2022-12-04 [1] CRAN (R 4.3.0)
#>  xml2                                1.3.3     2021-11-30 [1] CRAN (R 4.3.0)
#>  XVector                             0.39.0    2022-11-01 [1] Bioconductor
#>  yaml                                2.3.6     2022-10-18 [1] CRAN (R 4.3.0)
#>  zlibbioc                            1.45.0    2022-11-01 [1] Bioconductor
#> 
#>  [1] /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library
#> 
#> ──────────────────────────────────────────────────────────────────────────────
```

</details>
",kriemo,https://github.com/Bioconductor/GenomicFeatures/issues/54
I_kwDOBhavs85g6rUr,Add 'genome' argument to makeTxDbFromGFF(),CLOSED,2023-03-15T17:50:34Z,2024-03-23T00:41:55Z,2024-03-23T00:41:55Z,"### Edit: All `makeTxDb*()` functions have moved to the new **txdbmaker** package. So I re-created this issue [there](https://github.com/Bioconductor/txdbmaker/issues/2) and I'm closing this one.

Right now (as of **GenomicFeatures** 1.51.4) `makeTxDbFromGFF()` produces a TxDb object that has an unspecified genome by default. To change this, one needs to explicitely set the genome on the TxDb object returned by `makeTxDbFromGFF()`, e.g. with `genome(txdb) <- ""T2T-CHM13v2.0""` (it's important to use the official name of the assembly otherwise the `seqlevelsStyle()` setter won't be able to switch the sequence naming style to UCSC or RefSeq). Alternatively one can specify the genome at creation time with `makeTxDbFromGFF(..., metadata=data.frame(name=""Genome"", value=""T2T-CHM13v2.0""))` but this is admitedly poorly documented and not very convenient.

So let's add a `genome` argument to `makeTxDbFromGFF()`.
",hpages,https://github.com/Bioconductor/GenomicFeatures/issues/55
I_kwDOBhavs85ieFBB,`makeTxDbFromGFF` fails with (bacterial) genome GTF files from NCBI,CLOSED,2023-04-03T13:14:10Z,2024-03-23T00:45:45Z,2024-02-01T13:13:27Z,"Dear maintainers, I noticed recently that making a Txdb object from a GFF (or GTF) file from bacteria can be difficult.
I downloaded several genome assemblies from the NCBI genomes website, all of them the reference genomes for widely used model bacteria such as Salmonella or Bacillus. When I try to make the txdb object, the function throws the following error:

```
> GenomicFeatures::makeTxDbFromGFF("".../genomes/s_enterica/GCF_000006945.2/genomic.gtf"")

Import genomic features from the file as a GRanges object ... OK
Prepare the 'metadata' data frame ... OK
Make the TxDb object ... Error in .make_splicings(exons, cds, stop_codons) : 
  some CDS cannot be mapped to an exon
In addition: Warning message:
In .get_cds_IDX(mcols0$type, mcols0$phase) :
  The ""phase"" metadata column contains non-NA values for features of type
  stop_codon. This information was ignored.
```

The problem here seems that there are some underlying assumptions about the structure of genes. Bacteria don't have exons, so ideally the function should not throw an error when exon information is missing. Also, bacteria can have multiple CDS on one transcript (operon structure), I'm not sure if this is also related to the error above. I am willing to make a PR to fiy this bug if I know where to look for.

Thank you!
Michael",m-jahn,https://github.com/Bioconductor/GenomicFeatures/issues/56
I_kwDOBhavs85lM-He,`makeTxDbFromBiomart()` on the Ensembl archive version failed ,CLOSED,2023-05-05T16:42:48Z,2024-02-01T18:02:45Z,2024-02-01T18:02:45Z,"Hi there,
I'm having trouble with `makeTxDbFromBiomart()` on the archive version of the Ensembl Plant.

I hope to use a older version of maize genome at *https://nov2020-plants.ensembl.org*. Below is my function call:

```r
zmv4_txdb <- makeTxDbFromBiomart(dataset=""zmays_eg_gene"", 
                             biomart=""plants_mart"",
                             host=""https://nov2020-plants.ensembl.org"")
zmv4_txdb
```

Although it says **Ensembl Plants Genes 49** which uses **RefGen_v4**, the content is actually the newest version from **Zm-B73-REFERENCE-NAM-5.0** (as you can see below). I wonder how to let `makeTxDbFromBiomart()` work on the older version of Ensembl Plant if possible?

```
TxDb object:
# Db type: TxDb
# Supporting package: GenomicFeatures
# Data source: BioMart
# Organism: Zea mays
# Taxonomy ID: 4577
# Resource URL: plants.ensembl.org:443
# BioMart database: plants_mart
# BioMart database version: Ensembl Plants Genes 49
# BioMart dataset: zmays_eg_gene
# BioMart dataset description: Zea mays genes (Zm-B73-REFERENCE-NAM-5.0)
# BioMart dataset version: Zm-B73-REFERENCE-NAM-5.0
# Full dataset: yes
# miRBase build ID: NA
# Nb of transcripts: 77341
# Db created by: GenomicFeatures package from Bioconductor
# Creation time: 2023-05-05 12:37:16 -0400 (Fri, 05 May 2023)
# GenomicFeatures version at creation time: 1.50.4
# RSQLite version at creation time: 2.2.18
# DBSCHEMAVERSION: 1.2
```

The search call returned the correct version.

```r
listMarts(host=""https://nov2020-plants.ensembl.org"")
datasets <- listDatasets(useMart(biomart=""plants_mart"",
                                 host=""https://nov2020-plants.ensembl.org""))
subset(datasets, grepl(""mays"", dataset, ignore.case=TRUE))

#         dataset                    description       version
# 96 zmays_eg_gene Zea mays genes (B73 RefGen_v4) B73 RefGen_v4
```
Thanks!
Ji ",timedreamer,https://github.com/Bioconductor/GenomicFeatures/issues/57
I_kwDOBhavs85lisvy,installation issue,CLOSED,2023-05-10T10:22:14Z,2023-05-11T15:56:50Z,2023-05-11T15:56:50Z,"I am trying to install GenomicFeatures but I received and error that seems to be related to the version of DelayedArray I am using. 

```
BiocManager::install(""GenomicFeatures"", force= TRUE)
library(""GenomicFeatures"")
Error: package or namespace load failed for ‘GenomicFeatures’ in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):
 namespace ‘DelayedArray’ 0.25.0 is being loaded, but >= 0.26.1 is required

sessionInfo() 
R version 4.3.0 (2023-04-21)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Ventura 13.3.1

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Zurich
tzcode source: internal

other attached packages:
 [1] DelayedArray_0.25.0   MatrixGenerics_1.12.0 matrixStats_0.63.0   
 [4] Matrix_1.5-4          BiocManager_1.30.20   AnnotationDbi_1.62.1 
 [7] Biobase_2.60.0        GenomicRanges_1.52.0  GenomeInfoDb_1.36.0  
[10] IRanges_2.34.0        S4Vectors_0.38.1      BiocGenerics_0.46.0  
```

I can see I have DelayedArray_0.25.0 but 
```
BiocManager::install(""DelayedArray"")

Warning: unable to access index for repository https://bioconductor.org/packages/3.17/data/annotation/bin/macosx/big-sur-arm64/contrib/4.3:
  cannot open URL 'https://bioconductor.org/packages/3.17/data/annotation/bin/macosx/big-sur-arm64/contrib/4.3/PACKAGES'
trying URL 'https://bioconductor.org/packages/3.17/bioc/bin/macosx/big-sur-arm64/contrib/4.3/DelayedArray_0.25.0.tgz'
```
",LliliansCalvo,https://github.com/Bioconductor/GenomicFeatures/issues/58
I_kwDOBhavs85oQBT9,fiveUTRsByTranscript() and threeUTRsByTranscript() give incorrect UTRs,CLOSED,2023-06-09T03:09:37Z,2023-06-24T04:03:21Z,2023-06-24T04:03:20Z,"If exon feature contains ID attribute in gff, it will make incorrect UTR annotations.
```
# gff data is downloaded from https://solgenomics.net/ftp/tomato_genome/annotation/ITAG4.1_release/
>gff=""ITAG4.1_gene_models.gff"" 
>gff.gr<-import(gff)

>gtf=""ITAG4.1_gene_models.gtf"" # covert gff into gtf by gffread -T 
>gtf.gr<-import(gtf)

>table(gff.gr$type)
           gene            mRNA            exon             CDS three_prime_UTR  five_prime_UTR 
          34688           34688          164368          156076           21858           23098

>table(gtf.gr$type)
     transcript       exon        CDS 
          34688     164368     156076

>txdb.gff<-makeTxDbFromGRanges(gr = gff.gr)
>UTR5.gff.gr <- fiveUTRsByTranscript(txdb.gff)
>UTR3.gff.gr <- threeUTRsByTranscript(txdb.gff)

>txdb.gtf<-makeTxDbFromGRanges(gr = gtf.gr)
>UTR5.gtf.gr <- fiveUTRsByTranscript(txdb.gtf)
>UTR3.gtf.gr <- threeUTRsByTranscript(txdb.gtf)

>sapply(list(""three_prime_UTR""=UTR3.gff.gr,""five_prime_UTR""=UTR5.gff.gr),function(x) sum(elementNROWS(x)))
three_prime_UTR  five_prime_UTR 
          15127           14800
>sapply(list(""three_prime_UTR""=UTR3.gtf.gr,""five_prime_UTR""=UTR5.gtf.gr),function(x) sum(elementNROWS(x)))
three_prime_UTR  five_prime_UTR
          21859           23099
```

The number of UTRs is largely different between the two txdb objects, so I try to remove ID value of exon in GRanges.
And it gives the same number as txdb from gtf file.
```
>gff.noID.gr <- copy(gff.gr)
>gff.noID.gr[gff.noID.gr$type %in% c(""exon"")]$ID<-NA
>txdb.noID.gff    <- makeTxDbFromGRanges(gr = gff.noID.gr)
>UTR5.gff.noID.gr <- fiveUTRsByTranscript(txdb.noID.gff)
>UTR3.gff.noID.gr <- threeUTRsByTranscript(txdb.noID.gff)
>sapply(list(""three_prime_UTR""=UTR3.gff.noID.gr,""five_prime_UTR""=UTR5.gff.noID.gr),function(x) sum(elementNROWS(x)))
three_prime_UTR  five_prime_UTR 
          21859           23099
```

Example:
The ""Solyc00g007330.1.1""  information in gff file:
```
SL4.0ch00	maker_ITAG	gene	2379604	2380807	.	-	.	ID=gene:Solyc00g007330.1;Alias=Solyc00g007330;Name=Solyc00g007330.1;length=1203
SL4.0ch00	maker_ITAG	mRNA	2379604	2380807	.	-	.	ID=mRNA:Solyc00g007330.1.1;Parent=gene:Solyc00g007330.1;Name=Solyc00g007330.1.1;Note=Zinc finger transcription factor 1;_AED=1.00;_QI=373|0|0|0|0|0|2|0|171;_eAED=1.00
SL4.0ch00	maker_ITAG	CDS	2379604	2380119	.	-	0	ID=CDS:Solyc00g007330.1.1.1;Parent=mRNA:Solyc00g007330.1.1
SL4.0ch00	maker_ITAG	exon	2379604	2380324	.	-	.	ID=exon:Solyc00g007330.1.1.1;Parent=mRNA:Solyc00g007330.1.1
SL4.0ch00	maker_ITAG	five_prime_UTR	2380120	2380324	.	-	.	ID=five_prime_UTR:Solyc00g007330.1.1.0;Parent=mRNA:Solyc00g007330.1.1
SL4.0ch00	maker_ITAG	exon	2380640	2380807	.	-	.	ID=exon:Solyc00g007330.1.1.2;Parent=mRNA:Solyc00g007330.1.1
SL4.0ch00	maker_ITAG	five_prime_UTR	2380640	2380807	.	-	.	ID=five_prime_UTR:Solyc00g007330.1.1.1;Parent=mRNA:Solyc00g007330.1.1
```
The transcript has five_prime_UTR only, but txdb of gff file gives incorrect results
```
> UTR5.gff.gr[""Solyc00g007330.1.1""]
GRangesList object of length 1:
$Solyc00g007330.1.1
GRanges object with 1 range and 3 metadata columns:
       seqnames          ranges strand |   exon_id            exon_name exon_rank
          <Rle>       <IRanges>  <Rle> | <integer>          <character> <integer>
  [1] SL4.0ch00 2380120-2380324      - |       815 Solyc00g007330.1.1.1         1
  -------
  seqinfo: 13 sequences from an unspecified genome; no seqlengths
> UTR3.gff.gr[""Solyc00g007330.1.1""]
GRanges object with 1 range and 3 metadata columns:
       seqnames          ranges strand |   exon_id            exon_name exon_rank
          <Rle>       <IRanges>  <Rle> | <integer>          <character> <integer>
  [1] SL4.0ch00 2380640-2380807      - |       816 Solyc00g007330.1.1.2         2
  -------
  seqinfo: 13 sequences from an unspecified genome; no seqlengths
```

",a92932000,https://github.com/Bioconductor/GenomicFeatures/issues/59
I_kwDOBhavs85pnNaj,Extracting exons result is different from manual extraction,CLOSED,2023-06-23T18:15:03Z,2023-08-22T02:09:58Z,2023-08-22T02:09:58Z,"If I try to extract the length of all exons (also those overlapping) using your package with this code and [this gencode file](https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_43/gencode.v43.basic.annotation.gff3.gz)
```
library(GenomicFeatures)
txdb <- makeTxDbFromGFF(""tables/gencode.v43.basic.annotation.gtf.gz"",
                        format = ""gtf"")

exons.list.per.gene <- exonsBy(txdb, by = ""gene"")
sort(width(exons.list.per.gene)[[""ENSG00000000003.15""]])
```
the result is `[1]   75   84   99  108  135  189  189  199  312 2878 2879` (11 exons).
If I do it manually (with cleaning the file first using `gzcat gencode.v43.basic.annotation.gff3.gz | grep -v # > gencode.v43.basic.annotation.clean.gff`
```
library(data.table)
gencode_file_gff3 <- fread(""tables/gencode.v43.basic.annotation.clean.gff"",
                           header = FALSE)
gencode_file_gff3 <- gencode_file_gff3[V3 == ""exon""] # filtering for exons
gencode_file_gff3[, gene_id := gsub("".*gene_id=(.*);transcript_id.*"", ""\\1"", V9)] # extractin ENSG number
gencode_file_gff3 <- gencode_file_gff3[, c(""V4"", ""V5"", ""gene_id"")] # reducing to start, end and gene_id
gencode_file_gff3[, length := V5 - (V4 - 1)] # calculating length
gencode_file_gff3 <- unique(gencode_file_gff3) # removing identical exons from HAVANA and ENSEMBL
sort(gencode_file_gff3[gene_id == ""ENSG00000000003.15""]$length)
```
The result is `[1]   75   84   99  108  135  189  199  312 2878 2879` (10 exons). Without the unique command I retain 15 exons. So both is different from yours. I can't figure out where you got that additional exon from. the unique command is necessary if two exons from `HAVANA` and `ENSEMBL` are exactly identical. I am not able to reproduce the results from your package manually.

This i just exemplary, but I get slightly different numbers for most genes.",gernophil,https://github.com/Bioconductor/GenomicFeatures/issues/60
I_kwDOBhavs85sg6xI,makeTxDbFromUCSC failed for mm9,CLOSED,2023-07-25T15:13:22Z,2023-09-28T21:21:05Z,2023-08-22T02:08:41Z,"Hello,

Previous I have used mm9.refseq.db <- makeTxDbFromUCSC(genome=""mm9"", tablename = ""refGene"") and it worked very well, but today it suddenly not working, shows error message ""Error in .tablename2track(tablename, session) : 
  UCSC table ""refGene"" is not supported""

I have checked UCSC table browser, they still have refGene track for mm9.

I tried GenomicFeatures version 1.50.4 and 1.52.1, both are not working. Could you help me with this? Thank you very much!",Moonriver1988,https://github.com/Bioconductor/GenomicFeatures/issues/61
I_kwDOBhavs85uBHby, makeTxDbFromUCSC failed for susScr11,CLOSED,2023-08-10T19:40:11Z,2023-08-22T02:08:27Z,2023-08-22T02:08:27Z,"Hello,

I am having some issues creating a TxDb object for susScr11 (Pig, 2017). I have used makeTxDbFromUCSC in the past to create a TxDb object for this genome, but on a different device. I didn't run into any issues there, but I am now no longer able to create a TxDb for susScr11.

`makeTxDbFromUCSC(genome=""susScr11"")` returns the error ""Error in normArgTrack(track, trackids) : 'track' must be a single string.""

`supportedUCSCtables(genome=""susScr11"")` returns only one entry under the _tablename_ variable: knownGene, and both the 'track' and 'subtrack' values for this are ""NA"".

I'm not sure what happened in the interim between when I initially created a TxDb for susScr11 ~12 months ago without issue, but I would really appreciate some guidance on this. For what it's worth, I attempted to create a TxDb using the older pig genomes available from USCS, and the same outputs resulted. 

>sessionInfo()
R version 4.2.0 (2022-04-22 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

>Matrix products: default

>locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                           LC_TIME=English_United States.1252    

>attached base packages:
[1] stats4    grid      stats     graphics  grDevices utils     datasets  methods   base     

>other attached packages:
 [1] TxDb.Sscrofa.UCSC.susScr11.refGene_3.12.0 biomaRt_2.54.1                           
 [3] clusterProfiler_4.6.2                     org.Ss.eg.db_3.16.0                      
 [5] RMariaDB_1.2.2                            GenomicFeatures_1.50.4                   
 [7] AnnotationDbi_1.60.2                      Biobase_2.58.0                           
 [9] AnnotationHub_3.6.0                       BiocFileCache_2.6.1                      
[11] dbplyr_2.3.3                              ChIPseeker_1.34.1                        
[13] ChIPpeakAnno_3.32.0                       rtracklayer_1.58.0                       
[15] GenomicRanges_1.50.2                      GenomeInfoDb_1.34.9                      
[17] IRanges_2.32.0                            S4Vectors_0.36.2                         
[19] BiocGenerics_0.44.0                       venneuler_1.1-3                          
[21] rJava_1.0-6                               VennDiagram_1.7.3                        
[23] futile.logger_1.4.3                       lubridate_1.9.2                          
[25] forcats_1.0.0                             stringr_1.5.0                            
[27] dplyr_1.1.2                               purrr_1.0.1                              
[29] readr_2.1.4                               tidyr_1.3.0                              
[31] tibble_3.2.1                              ggplot2_3.4.2                            
[33] tidyverse_2.0.0                           BiocManager_1.30.21.1                    

>loaded via a namespace (and not attached):
  [1] utf8_1.2.3                              tidyselect_1.2.0                        RSQLite_2.3.1                          
  [4] BiocParallel_1.32.6                     scatterpie_0.2.1                        munsell_0.5.0                          
  [7] codetools_0.2-18                        withr_2.5.0                             colorspace_2.1-0                       
 [10] GOSemSim_2.24.0                         filelock_1.0.2                          knitr_1.43                             
 [13] rstudioapi_0.15.0                       DOSE_3.24.2                             labeling_0.4.2                         
 [16] MatrixGenerics_1.10.0                   GenomeInfoDbData_1.2.9                  polyclip_1.10-4                        
 [19] bit64_4.0.5                             farver_2.1.1                            downloader_0.4                         
 [22] vctrs_0.6.3                             treeio_1.22.0                           generics_0.1.3                         
 [25] gson_0.1.0                              lambda.r_1.2.4                          xfun_0.39                              
 [28] timechange_0.2.0                        regioneR_1.30.0                         R6_2.5.1                               
 [31] graphlayouts_1.0.0                      AnnotationFilter_1.22.0                 bitops_1.0-7                           
 [34] cachem_1.0.8                            fgsea_1.24.0                            gridGraphics_0.5-1                     
 [37] DelayedArray_0.24.0                     promises_1.2.0.1                        BiocIO_1.8.0                           
 [40] scales_1.2.1                            ggraph_2.1.0                            enrichplot_1.18.4                      
 [43] gtable_0.3.3                            tidygraph_1.2.3                         ensembldb_2.22.0                       
 [46] rlang_1.1.1                             splines_4.2.0                           lazyeval_0.2.2                         
 [49] yaml_2.3.7                              reshape2_1.4.4                          httpuv_1.6.11                          
 [52] qvalue_2.30.0                           RBGL_1.74.0                             tools_4.2.0                            
 [55] ggplotify_0.1.1                         ellipsis_0.3.2                          gplots_3.1.3                           
 [58] RColorBrewer_1.1-3                      Rcpp_1.0.11                             plyr_1.8.8                             
 [61] progress_1.2.2                          zlibbioc_1.44.0                         RCurl_1.98-1.12                        
 [64] prettyunits_1.1.1                       viridis_0.6.4                           cowplot_1.1.1                          
 [67] SummarizedExperiment_1.28.0             ggrepel_0.9.3                           magrittr_2.0.3                         
 [70] data.table_1.14.8                       futile.options_1.0.1                    ProtGenerics_1.30.0                    
 [73] matrixStats_1.0.0                       evaluate_0.21                           xtable_1.8-4                           
 [76] mime_0.12                               hms_1.1.3                               patchwork_1.1.2                        
 [79] HDO.db_0.99.1                           XML_3.99-0.14                           gridExtra_2.3                          
 [82] compiler_4.2.0                          KernSmooth_2.23-20                      crayon_1.5.2                           
 [85] shadowtext_0.1.2                        htmltools_0.5.5                         later_1.3.1                            
 [88] ggfun_0.1.1                             tzdb_0.4.0                              aplot_0.1.10                           
 [91] DBI_1.1.3                               tweenr_2.0.2                            formatR_1.14                           
 [94] MASS_7.3-56                             rappdirs_0.3.3                          boot_1.3-28                            
 [97] Matrix_1.4-1                            cli_3.6.1                               parallel_4.2.0                         
[100] igraph_1.5.0.1                          pkgconfig_2.0.3                         TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2
[103] GenomicAlignments_1.34.1                xml2_1.3.5                              InteractionSet_1.26.1                  
[106] ggtree_3.6.2                            multtest_2.54.0                         XVector_0.38.0                         
[109] yulab.utils_0.0.6                       digest_0.6.33                           graph_1.76.0                           
[112] Biostrings_2.66.0                       rmarkdown_2.23                          fastmatch_1.1-3                        
[115] tidytree_0.4.4                          restfulr_0.0.15                         curl_5.0.1                             
[118] shiny_1.7.4.1                           Rsamtools_2.14.0                        gtools_3.9.4                           
[121] rjson_0.2.21                            lifecycle_1.0.3                         nlme_3.1-157                           
[124] jsonlite_1.8.7                          viridisLite_0.4.2                       BSgenome_1.66.3                        
[127] fansi_1.0.4                             pillar_1.9.0                            lattice_0.20-45                        
[130] KEGGREST_1.38.0                         fastmap_1.1.1                           httr_1.4.6                             
[133] plotrix_3.8-2                           survival_3.3-1                          GO.db_3.16.0                           
[136] interactiveDisplayBase_1.36.0           glue_1.6.2                              png_0.1-8                              
[139] BiocVersion_3.16.0                      bit_4.0.5                               ggforce_0.4.1                          
[142] stringi_1.7.12                          blob_1.2.4                              caTools_1.18.2                         
[145] memoise_2.0.1                           ape_5.7-1                              ",sinnis007,https://github.com/Bioconductor/GenomicFeatures/issues/62
I_kwDOBhavs85uCU6x,GenomicFeature error with mm10,CLOSED,2023-08-11T02:14:45Z,2023-08-22T02:07:41Z,2023-08-22T02:07:41Z,"Hi,
 
I am getting a error when I am using the makeTxDbFromUCSC() function in GenomicFeatures for mm10 genome. 
 
library(GenomicFeatures)
mm10.refseq.db <- makeTxDbFromUCSC(genome = ""mm10"", tablename = ""knownGene"")
Error in normArgTrack(track, trackids) : 'track' must be a single string
 
It does the same with the example code from help. I checked the supportedUCSCtables() function.
 
>supportedUCSCtables(genome=""mm10"", url=http://genome.ucsc.edu/cgi-bin/)
  tablename track subtrack
1 knownGene  <NA>     <NA>

 Kindly let me know if I missed something here. 

Sincerely, 
Murli",MurliNair,https://github.com/Bioconductor/GenomicFeatures/issues/63
I_kwDOBhavs85ySjxt,Installation requires vctrs (≥ 0.6.0),CLOSED,2023-09-28T12:43:08Z,2023-10-02T17:41:20Z,2023-10-02T17:41:20Z,"Hey,
I install this package as part of a package that I'm developing.
Until recently, this was not an issue.
However, in the last few days, I encounter errors due to vctrs (≥ 0.6.0) (see attached screenshot).
This was a surprise to me since your package does not require vctrs directly. I looked for the actual problem and I think it rises from the installation of dplyr (ver. 1.1.3). Older version did not require vctrs (≥ 0.6.0) so I didn't have this issue. I still don't understand why dplyr (ver. 1.1.3) is even required since you don't mention it in the dependencies.

Please help me figuring this out.
Thanks

![genomicFeaturesBug](https://github.com/Bioconductor/GenomicFeatures/assets/107349233/b799d167-c170-42f6-a96e-a68029279421)


",amitfrishberg,https://github.com/Bioconductor/GenomicFeatures/issues/64
I_kwDOBhavs855f6Bw,How to make a TxDb object for the T2T-CHM13v2.0 genome (telomere to telomere Human genome),CLOSED,2023-12-12T19:18:05Z,2024-03-23T00:42:47Z,2024-03-22T21:57:35Z,"[Moved to https://github.com/Bioconductor/txdbmaker/issues/1 on March 22, 2024]
",hpages,https://github.com/Bioconductor/GenomicFeatures/issues/65
I_kwDOBhavs8576SQX,Feature Request: Implementation of getTerminatorSeq() Function,CLOSED,2024-01-12T13:40:56Z,2024-02-16T20:00:23Z,2024-01-23T18:53:40Z,"Currently, the package includes the getPromoterSeq() function, which is very useful for retrieving promoter sequences. But, there is currently no equivalent function for retrieving terminator sequences.",JavierMenRev,https://github.com/Bioconductor/GenomicFeatures/issues/66
I_kwDOBhavs86CsTdn,GenomicFeatures:::load_package_gracefully apparently fails on BBS,CLOSED,2024-03-18T16:12:51Z,2024-03-20T00:56:31Z,2024-03-20T00:56:30Z,"Hi,

I got several build warnings on BBS with Bioc 3.19 during testing, which all look kind of the same:

From [RNAmodR](https://master.bioconductor.org/checkResults/3.19/bioc-LATEST/RNAmodR.ML/nebbiolo1-checksrc.html) package
```
Backtrace
      ▆
   1. └─RNAmodR::End5SequenceData(files, annotation = annotation, sequences = sequences) at test-0SequenceData.R:37:3
   2.   └─RNAmodR:::.new_SequenceData(...)
   3.     └─RNAmodR:::.norm_annotation(annotation, className)
   4.       └─GenomicFeatures::makeTxDbFromGFF(annotation)
   5.         └─GenomicFeatures:::call_fun_in_txdbmaker(""makeTxDbFromGFF"", ...)
   6.           └─GenomicFeatures:::load_package_gracefully(...)`
```

From [RNAmodR.ML](https://master.bioconductor.org/checkResults/3.19/bioc-LATEST/RNAmodR.ML/nebbiolo1-checksrc.html) package
```
Last 13 lines of output:
    3. │   ├─testthat (local) .capture(...)
    4. │   │ └─base::withCallingHandlers(...)
    5. │   └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
    6. └─RNAmodR.ML (local) ModMLExample(files, annotation, sequences)
    7.   ├─RNAmodR:::Modifier(...) at test-RNAmodR.ML.R:16:5
    8.   └─RNAmodR:::Modifier(...)
    9.     └─RNAmodR:::.new_ModFromCharacter(...)
   10.       └─RNAmodR:::.norm_annotation(annotation, className)
   11.         └─GenomicFeatures::makeTxDbFromGFF(annotation)
   12.           └─GenomicFeatures:::call_fun_in_txdbmaker(""makeTxDbFromGFF"", ...)
   13.             └─GenomicFeatures:::load_package_gracefully(...)
```

I see that there are some recent changes from last week. I looked at changes and it seems that there is a new packlage 'txdbmaker' with a redirection to functions from that package.

@hpages Should I fix it in those packages or is this something you would like to address?
Thanks for any advice on how to fix this issue long term best.

Felix

edit: It might be a linux specific issue and/or timing related. Any advice would be much appreciated.",FelixErnst,https://github.com/Bioconductor/GenomicFeatures/issues/67
I_kwDOBhavs86FS9w6,How to import pseudogenes from GFF3 file as GRanges object?,OPEN,2024-04-10T20:04:32Z,2024-04-10T20:04:32Z,,"Thank you for developing such a powerful package for working with genomes in R. My questions is how do I import pseudogenes, e.g. MTCO2P2, from a NCBI RefSeq human assembly GFF3 file `TxDb` as `GRanges` object using `GenomicFeatures` functions? This entry was not found in the output `GRanges` objects of functions `transcripts`, `exons`, `cds`, or `genes`.

Pseudogene MTCO2P2 is on line 3862455 of GFF3 file GCF_000001405.40_GRCh38.p14_genomic.gff:
`# NC_000018.10    Curated Genomic pseudogene      47853230        47853472        .       -       .       ID=gene-MTCO2P2;Dbxref=GeneID:100873202,HGNC:HGNC:25354;Name=MTCO2P2;description=MT-CO2 pseudogene 2;gbkey=Gene;gene=MTCO2P2;gene_biotype=pseudogene;gene_synonym=HsT4010;pseudo=true`

The GFF3 file (Last modified: 2023-10-11 12:39) was downloaded from here: https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/GCF_000001405.40_GRCh38.p14_genomic.gff.gz

```
library(GenomicFeatures)
db <- makeTxDbFromGFF(""GCF_000001405.40_GRCh38.p14_genomic.gff"")

# Import genomic features from the file as a GRanges object ... OK
# Prepare the 'metadata' data frame ... OK
# Make the TxDb object ... OK
# Warning messages:
# 1: In .extract_transcripts_from_GRanges(tx_IDX, gr, mcols0$type, mcols0$ID,  :
#     some transcripts have no ""transcript_id"" attribute ==> their
#     name (""tx_name"" column in the TxDb object) was set to NA
# 2: In .extract_transcripts_from_GRanges(tx_IDX, gr, mcols0$type, mcols0$ID,  :
#     the transcript names (""tx_name"" column in the TxDb object)
#     imported from the ""transcript_id"" attribute are not unique
# 3: In .find_exon_cds(exons, cds) :
#     The following transcripts have exons that contain more than
#     one CDS (only the first CDS was kept for each exon):
#     rna-NM_001134939.1, rna-NM_001172437.2, rna-NM_001184961.1,
#     rna-NM_001301020.1, rna-NM_001301302.1, rna-NM_001301371.1,
#     rna-NM_002537.3, rna-NM_004152.3, rna-NM_015068.3,
#     rna-NM_016178.2

tx <- transcripts(db, columns = c(""tx_id"", ""tx_name"", ""gene_id""))
ex <- exons(db, columns = c(""exon_id"", ""gene_id""))
cds <- cds(db, columns = c(""cds_id"", ""gene_id""))
ge <- genes(db)

txdf <- as.data.frame(tx)
exdf <- as.data.frame(ex)
cdsdf <- as.data.frame(cds)
gedf <- as.data.frame(ge)

""MTCO2P2"" %in% txdf$gene_id
# [1] FALSE
47853230 %in% txdf$start
# [1] FALSE
47853472 %in% txdf$end
# [1] FALSE

""MTCO2P2"" %in% exdf$gene_id
# [1] FALSE
47853230 %in% exdf$start
# [1] FALSE
47853472 %in% exdf$end
# [1] FALSE

""MTCO2P2"" %in% cdsdf$gene_id
# [1] FALSE
47853230 %in% cdsdf$start
# [1] FALSE
47853472 %in% cdsdf$end
# [1] FALSE

""MTCO2P2"" %in% gedf$gene_id
# [1] FALSE
47853230 %in% gedf$start
# [1] FALSE
47853472 %in% gedf$end
# [1] FALSE
```
```
sessionInfo()
R version 4.3.2 (2023-10-31)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Sonoma 14.4.1

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets 
[7] methods   base     

other attached packages:
[1] GenomicFeatures_1.54.1 AnnotationDbi_1.64.1  
[3] Biobase_2.62.0         GenomicRanges_1.54.1  
[5] GenomeInfoDb_1.38.2    IRanges_2.36.0        
[7] S4Vectors_0.40.2       BiocGenerics_0.48.1   

loaded via a namespace (and not attached):
 [1] KEGGREST_1.42.0             SummarizedExperiment_1.32.0
 [3] xfun_0.41                   rjson_0.2.21               
 [5] lattice_0.22-5              vctrs_0.6.5                
 [7] tools_4.3.2                 bitops_1.0-7               
 [9] generics_0.1.3              curl_5.2.0                 
[11] parallel_4.3.2              tibble_3.2.1               
[13] fansi_1.0.6                 RSQLite_2.3.4              
[15] blob_1.2.4                  pkgconfig_2.0.3            
[17] Matrix_1.6-4                dbplyr_2.4.0               
[19] lifecycle_1.0.4             GenomeInfoDbData_1.2.11    
[21] compiler_4.3.2              stringr_1.5.1              
[23] Rsamtools_2.18.0            Biostrings_2.70.1          
[25] progress_1.2.3              codetools_0.2-19           
[27] htmltools_0.5.7             RCurl_1.98-1.13            
[29] yaml_2.3.8                  pillar_1.9.0               
[31] crayon_1.5.2                BiocParallel_1.36.0        
[33] DelayedArray_0.28.0         cachem_1.0.8               
[35] abind_1.4-5                 tidyselect_1.2.0           
[37] digest_0.6.33               stringi_1.8.3              
[39] dplyr_1.1.4                 restfulr_0.0.15            
[41] grid_4.3.2                  biomaRt_2.58.0             
[43] fastmap_1.1.1               SparseArray_1.2.2          
[45] cli_3.6.2                   magrittr_2.0.3             
[47] S4Arrays_1.2.0              XML_3.99-0.16              
[49] utf8_1.2.4                  prettyunits_1.2.0          
[51] filelock_1.0.3              rappdirs_0.3.3             
[53] bit64_4.0.5                 rmarkdown_2.25             
[55] XVector_0.42.0              httr_1.4.7                 
[57] matrixStats_1.2.0           bit_4.0.5                  
[59] png_0.1-8                   hms_1.1.3                  
[61] evaluate_0.23               memoise_2.0.1              
[63] knitr_1.45                  BiocIO_1.12.0              
[65] BiocFileCache_2.10.1        rtracklayer_1.62.0         
[67] rlang_1.1.2                 glue_1.6.2                 
[69] DBI_1.1.3                   xml2_1.3.6                 
[71] rstudioapi_0.15.0           R6_2.5.1                   
[73] MatrixGenerics_1.14.0       GenomicAlignments_1.38.0   
[75] zlibbioc_1.48.0    
```

Thank you",zhewa,https://github.com/Bioconductor/GenomicFeatures/issues/68
I_kwDOBhavs86XWu-G,`makeTxDbFromEnsembl` no longer connects to the right Ensembl database for Homo sapiens,OPEN,2024-09-20T17:36:10Z,2024-09-20T17:36:32Z,,"Relatively recently, `GenomicFeatures::makeTxDbFromEnsembl` stopped working for Human. I'm using 1.54.1, but the relevant code hasn't haven in 1.56 or in txdbmaker

```
txdb <- GenomicFeatures::makeTxDbFromEnsembl('homo_sapiens')
Error: Failed to connect: Unknown database 'homo_sapiens_core_112_37'
```

The issue appears to be in `GenomicFeatures:::.lookup_dbname_fix`. It loads the cor_dirs from the FTP which contains ...core_37 and core_38

```
core_dirs <- Ensembl_listMySQLCoreDirs(mysql_url, release = release)
.... ""homo_sapiens_core_112_37"". ""homo_sapiens_core_112_38""   ....
```

It then uses match to pick the first value, which is `homo_sapiens_core_112_37`:
```
i <- match(prefix, substr(core_dirs, 1L, nchar(prefix)))
```

But this is not a valid database for `makeTxDbFromEnsembl`. Replacing the DB with `homo_sapiens_core_112_38` manually, or replacing the above line with the following to choose the later value fixes the issue 
```
i <- max(which(prefix == substr(core_dirs, 1L, nchar(prefix))))
```",divibisan,https://github.com/Bioconductor/GenomicFeatures/issues/69
