id,title,state,created_at,updated_at,closed_at,body,user,url
MDU6SXNzdWU2NDE3NzM=,bedGraph version wignorm.,CLOSED,2011-03-02T22:38:30Z,2014-09-11T06:29:47Z,2011-05-18T17:50:49Z,"It will be another post-process script to combine two bedGraph output from MACS, calculate 'scores' for each data point, and call refined peaks using some threshold
",taoliu,https://github.com/macs3-project/MACS/issues/1
MDU6SXNzdWUxMTc2MjYx,Support data w/o control in MACS2 [Orig Title:NameError: poisson_cdf],CLOSED,2011-07-06T19:48:12Z,2013-10-17T15:05:45Z,2011-07-07T16:25:51Z,"Getting this error, not getting a cdf from the right place?

Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 354, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 171, in main
    peakdetect.call_peaks()
  File ""cPeakDetect.pyx"", line 83, in MACS2.cPeakDetect.PeakDetect.call_peaks (MACS2/cPeakDetect.c:1266)
  File ""cPeakDetect.pyx"", line 316, in MACS2.cPeakDetect.PeakDetect.__call_peaks_wo_control (MACS2/cPeakDetect.c:4306)
  File ""cBedGraph.pyx"", line 486, in MACS2.IO.cBedGraph.bedGraphTrackI.apply_func (MACS2/IO/cBedGraph.c:6431)
  File ""cPeakDetect.pyx"", line 316, in MACS2.cPeakDetect.__call_peaks_wo_control.lambda6 (MACS2/cPeakDetect.c:3835)
NameError: poisson_cdf
",nstong,https://github.com/macs3-project/MACS/issues/2
MDU6SXNzdWUxMjM5ODU1,ImportError when use macs2,CLOSED,2011-07-18T05:25:08Z,2014-08-15T15:13:24Z,2011-07-18T14:49:47Z,"I use python setup.py install on a Ubuntu server.
However, when I run ""macs2"" in terminal.
It shows like this:

Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 35, in <module>
    from MACS2.OptValidator import opt_validate
  File ""/usr/local/lib/python2.6/dist-packages/MACS2/OptValidator.py"", line 26, in <module>
    from MACS2.IO.cParser import BEDParser, ELANDResultParser, ELANDMultiParser, ELANDExportParser, SAMParser, BAMParser, BowtieParser,  guess_parser
ImportError: /usr/local/lib/python2.6/dist-packages/MACS2/IO/cParser.so: undefined symbol: PyUnicodeUCS2_DecodeUTF8

I've installed numpy and cython in this server, but when I get into the directory of /usr/local/lib/python2.6/dist-packages/MACS2/IO. I found cFeatIO.so was not there. I get a copy from other server and put it here. But It didn't work.
",hanfeisun,https://github.com/macs3-project/MACS/issues/3
MDU6SXNzdWUxNjIxMzk4,A small bug maybe caused by a new option--broad?,CLOSED,2011-09-12T06:27:44Z,2013-10-17T15:05:45Z,2011-09-12T06:31:54Z,"I encounter a bug after updating the new version of macs2.

[linxq@localhost ~/hmc_Tet1/raw_data/Tet1_hmc]$ macs2 --version
macs2 2.0.8 20110830 (tag:alpha)

[linxq@localhost ~/hmc_Tet1/raw_data/Tet1_hmc]$ macs2 -t Tet1_mES.bed -c Tet1_mES_input.bed -n Tet1 -f BED -g hs
Traceback (most recent call last):
  File ""/opt/bin/macs2"", line 354, in <module>
    main()
  File ""/opt/bin/macs2"", line 49, in main
    options = opt_validate(prepare_optparser())
  File ""/opt/bin/lib/python2.6/site-packages/MACS2/OptValidator.py"", line 107, in opt_validate
    if options.broad:
AttributeError: Values instance has no attribute 'broad'
",hanfeisun,https://github.com/macs3-project/MACS/issues/4
MDU6SXNzdWUxNjc5ODM2,MACS2 vs MACS14,CLOSED,2011-09-19T16:29:07Z,2011-09-19T19:13:54Z,2011-09-19T19:13:54Z,"MACS2 and MACS14 give different results when using the same parameters.

Both versions are installed on Ubuntu 10.4
macs14 1.4.1 20110622
macs2 2.0.8 20110916 (tag:alpha)

The parameters used:
[macs14|macs2] -t Treatment_chr12.bam --keep-dup all --pvalue=1e-3 --nomodel -g 1e8 --name Treatment_nm_dup_p1e-3_g1e8

MACS2 calls fewer peaks than MACS14, and misses some very important ones, called by MACS14. --broad parameter does not help. 
Why are the differences?
",mdozmorov,https://github.com/macs3-project/MACS/issues/5
MDU6SXNzdWUyNzc5MjA0,Error in bedGraphTrackII.call_peaks when use bdgpeakcall,CLOSED,2012-01-10T03:46:19Z,2012-01-11T02:05:09Z,2012-01-11T02:05:09Z,"I met an error when I use bdgpeakcall,  and the traceback shows that it was on the Line 882 of cBedGraph:

[liuj@BioServer1 ~/ENCODE/GEOdata]$ bdgpeakcall -i GSM831025_H1_CHD1_1.bdg 
INFO  @ Mon, 09 Jan 2012 23:51:58: Read and build bedGraph... 
INFO  @ Mon, 09 Jan 2012 23:57:45: Call peaks from bedGraph... 
Traceback (most recent call last):
  File ""/opt/bin/bdgpeakcall"", line 86, in <module>
    main()
  File ""/opt/bin/bdgpeakcall"", line 77, in main
    peaks = btrack.call_peaks(cutoff=options.cutoff,min_length=options.minlen,max_gap=options.maxgap)
  File ""cBedGraph.pyx"", line 882, in MACS2.IO.cBedGraph.bedGraphTrackII.call_peaks (MACS2/IO/cBedGraph.c:11840)
ValueError: operands could not be broadcast together with shapes (297031) (297030)

Then I change the Line882 from:
            above_cutoff_endpos = self.data[chrom]['pos'][above_cutoff] # end positions of regions where score is above cutoff
            above_cutoff_startpos = self.data[chrom]['pos'][above_cutoff_flag[1:]] # start position

to:
            above_cutoff_endpos = self.data[chrom]['pos'][above_cutoff] # end positions of regions where score is above cutoff
            above_cutoff_startpos = self.data[chrom]['pos'][above_cutoff_flag[0:]] # start position

and it seems passed, but I'm not sure whether it's ok to do that?
",hanfeisun,https://github.com/macs3-project/MACS/issues/6
MDU6SXNzdWU0MDQ5NTE1,MACS2 installation error,CLOSED,2012-04-10T16:39:15Z,2012-04-10T19:08:03Z,2012-04-10T17:01:50Z,"Hello,

I used Cython-0.15.1 and python 2.7 versions to build MACS2 on my OS X.

It is installing and writing the .egg-info file and other binary files.

I tried building MACS as a root also. There is no problem with installation.

But, when I run the command ./macs2 its giving me the following error

Traceback (most recent call last):
  File ""./macs2"", line 33, in <module>
    from MACS2.OptValidator import opt_validate
ImportError: No module named MACS2.OptValidator

Any help in this regard will be greatly appreciated.

Thanks,
",rkk1,https://github.com/macs3-project/MACS/issues/9
MDU6SXNzdWU2MzY0NDgy,too many peaks,CLOSED,2012-08-21T22:19:27Z,2014-10-23T19:57:09Z,2014-10-23T19:57:09Z,"Dear Tao, 

in contrast to issue 5 reported here i find macs2 calls more peaks than the original macs. I would say macs2 gives the most realistic looking peaks. However, for my faire-seq data it calls between 220k and 300k peaks with an FDR of 1% which I would say seems too many and its difficult to know where to draw the line. For faire-seq with so many peaks what is the best way of limiting the number to say 150k which is more in keeping with reported numbers. On the one hand one could simply arbitrarily sort on the fdr or p value and take the top 150k but is there a way of making macs2 less sensitive from the start? I don't have input control but i am comparing two conditions. interestingly if i use oe as the input for the other macs2 calls 5000 peaks whereas if one calls peaks independently as expected from 200k peaks 120k are shared and 80 unique. Do you regard using one condition as input as a valid analysis with macs2? 

kind regards

Michael
",mreschen,https://github.com/macs3-project/MACS/issues/10
MDU6SXNzdWU3NjkzOTg0,bdgpeakcall missing peaks,CLOSED,2012-10-18T17:45:45Z,2012-10-19T21:11:56Z,2012-10-18T18:31:51Z,"When looking at score bedGraphs generated by bdgcomp regions that are above threshold that should be called peaks are missed by bdgpeakcall.  For example:

chr2    0       1       0.00000
chr2    1       1157    0.16251
chr2    1157    1173    0.59598
chr2    1173    1177    1.92692
chr2    1177    1192    2.25381
chr2    1192    1251    3.78114
chr2    1251    1260    5.39507
chr2    1260    1278    4.89302
chr2    1278    1287    6.50066
chr2    1287    1307    6.02890
chr2    1307    1327    7.63021
chr2    1327    1352    9.31474
chr2    1352    1390    8.77969
chr2    1390    1391    8.62740
chr2    1391    1438    8.46170
chr2    1438    1441    8.94880
chr2    1441    1471    7.30162
chr2    1471    1475    7.81930
chr2    1475    1488    6.17264
chr2    1488    1530    4.61371
chr2    1530    1540    5.05366
chr2    1540    1543    5.60691
chr2    1543    1547    3.94172
chr2    1547    1551    5.60691
chr2    1551    1563    3.94172
chr2    1563    1564    3.49481
chr2    1564    1576    3.14424
chr2    1576    1606    1.74960
chr2    1606    1629    0.55045
chr2    1629    5718    0.16251
chr2    5718    5719    0.13415
chr2    5719    51113   0.16251
chr2    51113   51114   0.09686
chr2    51114   81245   0.16251
chr2    81245   81246   0.05880
chr2    81246   82785   0.16251
chr2    82785   82799   0.04603
chr2    82799   86160   0.16251
chr2    86160   86161   0.09345
chr2    86161   86638   0.16251
chr2    86638   86645   0.07291
chr2    86645   105818  0.16251

Even using lenient parameters (-l 10 -c 2 -g 2000), I can not get the peak in this region to be called.
",nstong,https://github.com/macs3-project/MACS/issues/11
MDU6SXNzdWU5NDgwOTgx,Pileup values with non-zero decimals.. (unexpected..?),CLOSED,2012-12-22T04:15:11Z,2013-03-15T15:46:31Z,2013-03-15T15:46:31Z,"Hi, 

I recently ran MACS2 to call peaks in some human transcription factors in Helas3 cell line, and obtained pileup.bdg output where the pileup values were not natural numbers as one would expect; I got numbers with non-zero decimal pileup values. I was wondering if somebody could please explain why this might be the case. 

Thank you.

ps. I have attached a png snapshot of the data herewith too. (The following is from the MACS2 pileup.bdg output on Helas3 Ap2gamma transcription factor).
![unexpected pileup values](https://f.cloud.github.com/assets/2818743/28297/38baf64e-4bed-11e2-895b-d8e77f439805.png)
",dineshmdh,https://github.com/macs3-project/MACS/issues/12
MDU6SXNzdWUxMDY1MDkwOQ==,Inconsistent help text for parameter --keep-dup,CLOSED,2013-02-05T14:04:54Z,2013-02-05T22:24:58Z,2013-02-05T22:24:58Z,"The help text for the 'keep-dup' option of the **callpeak** command suggests that the default is _""auto""_ but then lists the default as _""1""_. According to the code the actual default is ""1"". It would be nice if this could be made more consistent. 
",humburg,https://github.com/macs3-project/MACS/issues/14
MDU6SXNzdWUxMTE4Mzk2Mg==,chip-exo data,CLOSED,2013-02-20T03:57:09Z,2016-03-08T18:57:10Z,2016-03-08T18:57:10Z,"Hi,
     I want to try MACS on chip-exo data. This kind of data differs from Chip-seq data in the sense that the peaks are sharper and more concentrated. And the distance between the w-peak and c-peak are smaller. Do you have any suggestions on how to tune the parameters for these data? Thanks.

Fan
",caofan,https://github.com/macs3-project/MACS/issues/15
MDU6SXNzdWUxMTM4ODg5MA==,Broad peaks adding extra region,CLOSED,2013-02-26T01:07:14Z,2013-03-08T22:59:50Z,2013-03-08T22:59:50Z,"MACS2-2.0.10.09132012

example:

This is a single peak that is isolated, peak.bed file entry:
chr6    124894207   124894537   H3K4me1_peak_81597  6.49299

The broad peak bed12 file has it like this
chr6    124893066   124894537   H3K4me1_peak_40500  6   .   124894207   124894537   0   2   1,330   0,1141

Shouldn't  this bed12 entry be this:
chr6    124894207   124894537   H3K4me1_peak_40500  6   .   124894207 124894537 0   1   330 0

end_example

The above example add a 3' extension to the peak call. Other instances add a 5' or both 3' and 5' extensions. 
",vogelwk,https://github.com/macs3-project/MACS/issues/16
MDU6SXNzdWUxMjA2ODMwMA==,--name option ignored when using -nolambda option (running macs14 on Ubuntu12.10),CLOSED,2013-03-15T15:37:41Z,2013-03-15T17:30:16Z,2013-03-15T17:30:16Z,"Hi,

If I run ""macs14 -t treatment_file_name.bed -c control_file_name.bed -f BED -n result_name_prefix -g mm -s 50 -m 10,30 --bw 180 -p 1e-4"", the results files have, as expected, ""result_name_prefix"" as their prefix.

However, if I run  the same command with the -nolambda option, the -n option is ignored and ""olambda"" is used instead.

This behavior is particularly annoying when running scripts with multiple combinations of input files, since each output will erase the previous one. Is there any way around in MACS (i.e. without rewriting the script launching MACS)?

Best,

Sébastien
",svigneau,https://github.com/macs3-project/MACS/issues/17
MDU6SXNzdWUxMjY1MDY4NQ==,incorrect reported pileup height reported,CLOSED,2013-04-01T02:22:43Z,2016-03-08T18:57:22Z,2016-03-08T18:57:22Z,"Perhaps this is related to issue 12, noninteger pileup height...

I have a set of peak calls from the following command (CentOS6 / Python 2.7.2):

macs2 callpeak -t IP.bam -c input.bam -g mm -p 0.05 --nomodel

And in the resulting peaks.xls file, the pileup heights are, almost without exception, higher than the actual pileup heights from the bam file.

Using the reported peak chrom, start, and end, I assay bam pileup heights with the following command:

samtools depth -r chrom:start-end IP.bam | cut -f3 | sort | uniq -c

And the maximum is always lower than the macs2 pileup value.  This is especially problematic because I am using pileup heights to filter peaks, and if I want peaks with height >= 10 then macs2 should not tell me it is 10 when in fact it is 4, or 15 when it is 9, or 22 when 12, etc.

Also, I am testing the original bam, and macs2 supposedly removes duplicates, so the disparities are probably even worse.

So how are the pileup values generated, and why are they not the IP height?

Thanks,
Ariel
",ArielPaulson,https://github.com/macs3-project/MACS/issues/18
MDU6SXNzdWUxMzEyODEwNg==,refinepeak raises AttributeError,CLOSED,2013-04-12T16:27:25Z,2013-12-16T19:18:12Z,2013-12-16T19:18:12Z,"I know it's experimental, but I'd like to experiment with it.

```
$ macs2 refinepeak -b MP55_peaks.bed -i MP55.bam -o refinetest
INFO  @ Fri, 12 Apr 2013 10:24:27: read tag files... 
INFO  @ Fri, 12 Apr 2013 10:24:27: read alignment tags... 
INFO  @ Fri, 12 Apr 2013 10:24:27: Detected format is: BAM 
INFO  @ Fri, 12 Apr 2013 10:24:27: * Input file is gzipped. 
INFO  @ Fri, 12 Apr 2013 10:24:31:  1000000 
INFO  @ Fri, 12 Apr 2013 10:24:35:  2000000 
INFO  @ Fri, 12 Apr 2013 10:24:38: tag size is determined as 50 bps 
Traceback (most recent call last):
  File ""/usr/local/share/python/macs2"", line 510, in <module>
    main()
  File ""/usr/local/share/python/macs2"", line 77, in main
    run( args )
  File ""/usr/local/lib/python2.7/site-packages/MACS2/refinepeak.py"", line 66, in run
    retval = fwtrack.compute_region_tags_from_peaks( peaks, find_summit, window_size = options.windowsize, cutoff = options.cutoff )
  File ""cFixWidthTrack.pyx"", line 654, in MACS2.IO.cFixWidthTrack.FWTrackIII.compute_region_tags_from_peaks (MACS2/IO/cFixWidthTrack.c:10624)
  File ""cFixWidthTrack.pyx"", line 677, in MACS2.IO.cFixWidthTrack.FWTrackIII.compute_region_tags_from_peaks (MACS2/IO/cFixWidthTrack.c:9756)
AttributeError: 'MACS2.IO.cPeakIO.PeakIO' object has no attribute 'peaks'
```

```
$ macs2 --version
macs2 2.0.10.20130404 (tag:beta)
```
",brwnj,https://github.com/macs3-project/MACS/issues/19
MDU6SXNzdWUxMzQyMzgwNQ==,Feature: use basename of --name as peak names,CLOSED,2013-04-19T22:23:12Z,2013-12-16T19:17:19Z,2013-12-16T19:17:19Z,"I like that you can give a full path to --name in order to write files into their respective directories, but it results in having to parse the name field of the bed into something reasonable.

Command:

```
macs2 callpeak -t bam -n /vol1/home/brownj/xxxxx/test/test ...
```

Results in:

```
chr1    1657224 1657228 /vol1/home/brownj/xxxxx/test/test_peak_55   1.63761
```
",brwnj,https://github.com/macs3-project/MACS/issues/20
MDU6SXNzdWUxMzUwNDgwOQ==,Negative peaks file?,CLOSED,2013-04-22T20:22:37Z,2013-05-28T04:32:35Z,2013-05-28T04:32:35Z,"Hello there,

We are making some analysis using your program and we were expecting to find the ""negative peak calls"" output file. 

Was it removed between the version 1.4 and the version 2.0?

Thanks a lot!
",jcgrenier,https://github.com/macs3-project/MACS/issues/21
MDU6SXNzdWUxODE2MDQwMg==,Issue with peak calls,CLOSED,2013-08-16T14:47:51Z,2014-10-23T20:20:54Z,2014-10-23T20:20:54Z,"Hi,

I have been using MACS2 to call peaks for transcription factors using the bam files from the ENCODE database (for HeLaS3 cell line). In specific, for any two given transcription factors (TFs), I am interested in picking sites that is bound only by one of them. So, I called peaks using different q-value cut-offs -- q 0.001 for the TF1 (which is ""E2f1"" in my case) peak I want bound, and q 0.1 (or 0.2) for TF2 (""E2f4"" in my case) that I don't want bound at the same region that TF1 is bound. The idea was that this would give us E2f1 peaks with few false positive, and E2f4 peaks with more false positives (and including peaks that we are not so confident about), and when any of the E2f1 peaks that overlaps with such E2f4 peaks (generated using low q-value cut-off), we would be getting peaks that we know are bound only by the E2f1 Tf.

However, when I implemented this protocol, I came across a number of E2f1 peaks that had significant E2f4 pileup overlap, and therefore did not look like the regions were uniquely bound by E2f1 -- the regions looked like there should have been peaks called for both E2f1 and E2f4 Tfs. The MACS2 called peaks for only E2f1, but not for E2f4 in those regions. 

I have attached a plot of pileup coverage for both E2f1 and E2f4 in one of such what was supposed to be a binding site unique to E2f1. The title of the plot define the peak chromosome and position; the red bars in the plot define the actual boundaries of the E2f1 plot. 

Currently I am using further downstream filtering for this, but I just wanted to let you guys know of this issue.

Thank you.

Best,
Dinesh Manandhar,
Duke University.
![an_e2f1_unique_peak](https://f.cloud.github.com/assets/2818743/975963/cf4eec46-0682-11e3-865b-6f262bd906f0.png)
",dineshmdh,https://github.com/macs3-project/MACS/issues/22
MDU6SXNzdWUyMDc0NDA4NA==,OverflowError: value too large to convert to int,CLOSED,2013-10-09T14:06:10Z,2015-11-11T15:50:50Z,2014-10-23T19:55:01Z,"Whenever I am running macs for that bam file ( with only unique mapped reads) it get stuck at ""36000000"" for few hours and then I get this error.

INFO  @ Tue, 08 Oct 2013 11:53:22: #1 read tag files... 
INFO  @ Tue, 08 Oct 2013 11:53:22: #1 read treatment tags... 
INFO  @ Tue, 08 Oct 2013 11:53:28:  1000000 
INFO  @ Tue, 08 Oct 2013 11:53:33:  2000000 
INFO  @ Tue, 08 Oct 2013 11:53:38:  3000000 
INFO  @ Tue, 08 Oct 2013 11:53:44:  4000000 
INFO  @ Tue, 08 Oct 2013 11:53:49:  5000000 
INFO  @ Tue, 08 Oct 2013 11:53:55:  6000000 
INFO  @ Tue, 08 Oct 2013 11:54:00:  7000000 
INFO  @ Tue, 08 Oct 2013 11:54:05:  8000000 
INFO  @ Tue, 08 Oct 2013 11:54:11:  9000000 
INFO  @ Tue, 08 Oct 2013 11:54:16:  10000000 
INFO  @ Tue, 08 Oct 2013 11:54:21:  11000000 
INFO  @ Tue, 08 Oct 2013 11:54:27:  12000000 
INFO  @ Tue, 08 Oct 2013 11:54:32:  13000000 
INFO  @ Tue, 08 Oct 2013 11:54:37:  14000000 
INFO  @ Tue, 08 Oct 2013 11:54:43:  15000000 
INFO  @ Tue, 08 Oct 2013 11:54:48:  16000000 
INFO  @ Tue, 08 Oct 2013 11:54:53:  17000000 
INFO  @ Tue, 08 Oct 2013 11:54:59:  18000000 
INFO  @ Tue, 08 Oct 2013 11:55:04:  19000000 
INFO  @ Tue, 08 Oct 2013 11:55:09:  20000000 
INFO  @ Tue, 08 Oct 2013 11:55:14:  21000000 
INFO  @ Tue, 08 Oct 2013 11:55:20:  22000000 
INFO  @ Tue, 08 Oct 2013 11:55:25:  23000000 
INFO  @ Tue, 08 Oct 2013 11:55:30:  24000000 
INFO  @ Tue, 08 Oct 2013 11:55:36:  25000000 
INFO  @ Tue, 08 Oct 2013 11:55:41:  26000000 
INFO  @ Tue, 08 Oct 2013 11:55:46:  27000000 
INFO  @ Tue, 08 Oct 2013 11:55:51:  28000000 
INFO  @ Tue, 08 Oct 2013 11:55:57:  29000000 
INFO  @ Tue, 08 Oct 2013 11:56:02:  30000000 
INFO  @ Tue, 08 Oct 2013 11:56:07:  31000000 
INFO  @ Tue, 08 Oct 2013 11:56:13:  32000000 
INFO  @ Tue, 08 Oct 2013 11:56:18:  33000000 
INFO  @ Tue, 08 Oct 2013 11:56:23:  34000000 
INFO  @ Tue, 08 Oct 2013 11:56:29:  35000000 
INFO  @ Tue, 08 Oct 2013 11:56:34:  36000000 
Traceback (most recent call last):
  File ""/usr/bin/macs2"", line 514, in <module>
    main()
  File ""/usr/bin/macs2"", line 45, in main
    run( args )
  File ""/usr/lib64/python2.7/site-packages/MACS2/callpeak.py"", line 69, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/usr/lib64/python2.7/site-packages/MACS2/callpeak.py"", line 379, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""cParser.pyx"", line 824, in MACS2.IO.cParser.BAMParser.build_fwtrack (MACS2/IO/cParser.c:10311)
  File ""cParser.pyx"", line 828, in MACS2.IO.cParser.BAMParser.build_fwtrack (MACS2/IO/cParser.c:10262)
  File ""cParser.pyx"", line 891, in MACS2.IO.cParser.BAMParser.__build_fwtrack_wo_pysam (MACS2/IO/cParser.c:11246)
  File ""cParser.pyx"", line 1015, in MACS2.IO.cParser.BAMParser.__fw_binary_parse (MACS2/IO/cParser.c:13208)
OverflowError: value too large to convert to int
",georgeg9,https://github.com/macs3-project/MACS/issues/24
MDU6SXNzdWUyMTEzNzY0NQ==,IndexError: list index out of range,CLOSED,2013-10-17T08:01:38Z,2014-10-23T20:18:55Z,2014-10-23T20:18:55Z,"INFO  @ Wed, 16 Oct 2013 14:27:12: #1 read tag files... 
INFO  @ Wed, 16 Oct 2013 14:27:12: #1 read treatment tags... 
INFO  @ Wed, 16 Oct 2013 14:27:17:  1000000 
INFO  @ Wed, 16 Oct 2013 14:27:22:  2000000 
INFO  @ Wed, 16 Oct 2013 14:27:27:  3000000 
INFO  @ Wed, 16 Oct 2013 14:27:32:  4000000 
INFO  @ Wed, 16 Oct 2013 14:27:37:  5000000 
INFO  @ Wed, 16 Oct 2013 14:27:42:  6000000 
INFO  @ Wed, 16 Oct 2013 14:27:47:  7000000 
INFO  @ Wed, 16 Oct 2013 14:27:52:  8000000 
INFO  @ Wed, 16 Oct 2013 14:27:57:  9000000 
INFO  @ Wed, 16 Oct 2013 14:28:03:  10000000 
INFO  @ Wed, 16 Oct 2013 14:28:08:  11000000 
INFO  @ Wed, 16 Oct 2013 14:28:13:  12000000 
INFO  @ Wed, 16 Oct 2013 14:28:18:  13000000 
INFO  @ Wed, 16 Oct 2013 14:28:23:  14000000 
INFO  @ Wed, 16 Oct 2013 14:28:28:  15000000 
INFO  @ Wed, 16 Oct 2013 14:28:33:  16000000 
INFO  @ Wed, 16 Oct 2013 14:28:37:  17000000 
INFO  @ Wed, 16 Oct 2013 14:28:42:  18000000 
INFO  @ Wed, 16 Oct 2013 14:28:47:  19000000 
INFO  @ Wed, 16 Oct 2013 14:28:52:  20000000 
INFO  @ Wed, 16 Oct 2013 14:28:57:  21000000 
Traceback (most recent call last):
  File ""/usr/bin/macs2"", line 514, in <module>
    main()
  File ""/usr/bin/macs2"", line 45, in main
    run( args )
  File ""/usr/lib64/python2.7/site-packages/MACS2/callpeak.py"", line 69, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/usr/lib64/python2.7/site-packages/MACS2/callpeak.py"", line 379, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""cParser.pyx"", line 824, in MACS2.IO.cParser.BAMParser.build_fwtrack (MACS2/IO/cParser.c:10311)
  File ""cParser.pyx"", line 828, in MACS2.IO.cParser.BAMParser.build_fwtrack (MACS2/IO/cParser.c:10262)
  File ""cParser.pyx"", line 898, in MACS2.IO.cParser.BAMParser.__build_fwtrack_wo_pysam (MACS2/IO/cParser.c:11404)
IndexError: list index out of range
",georgeg9,https://github.com/macs3-project/MACS/issues/25
MDU6SXNzdWUyMjY1NDc2Ng==,Add Tag for latest commit c217f354fe13d86ac8b183cb0a02095b29969590,CLOSED,2013-11-14T10:42:10Z,2014-06-17T21:16:49Z,2014-06-17T21:16:49Z,,rjpbonnal,https://github.com/macs3-project/MACS/issues/26
MDU6SXNzdWUyMzA5Njk5MQ==,Adding separate normalisation factor for size difference between input and treatment,CLOSED,2013-11-21T20:57:14Z,2014-06-17T21:15:11Z,2014-06-17T21:15:11Z,"Just to revive an issue that has been commented before. It has been shown that for some datasets (particularly those with larger depths) the normalization between the Input and the IP has a criticall effect in the FDR calculation. There have been some attempts to develop estimations for the normalizing factor that seem to work nicely with a wide range of sequencing depths (see for example: http://www.biomedcentral.com/1471-2105/13/199). 

I've seen some forks from version 1.4 that include an option to give your own normalization factor (instead of using the linear normalization with --to-large or --down-scale). I think it would be great if such an option could be included in the main macs2 callpeak code (and not terribly complicated as far as I can tell). What do you think?

Best, and thaks for the program!
",dav7mx,https://github.com/macs3-project/MACS/issues/27
MDU6SXNzdWUyNDIyNTA0NA==,MACS14 doesn't recognized paired-end reads aligned to minus strand,CLOSED,2013-12-13T03:21:48Z,2014-06-17T15:29:20Z,2014-06-17T15:29:20Z,"Dear All.

I have paired-end BAM files for my treatment and control samples. When I run

```
macs14 -t treatment.bam -c control.bam -n output -g hs -B -S -p 0.05
```

I get the following warnings for all chromosomes on each file (treatment, and control):

```
WARNING @ Wed, 11 Dec 2013 12:17:35: NO records for chromosome chr1, minus strand!
.
WARNING @ Wed, 11 Dec 2013 12:17:35: NO records for chromosome chrY, minus strand!
```

I checked the BAM files, and there are reads aligned to the negative strand (across the files the sam flags are: 77, 83, 99, 141, 147, and 163). This problem doesn't show up when I run MACS on single-end libraries (sam flags: 0, and 16).

I would appreciate any idea about how to solve or circumvent this problem.

Thanks in advance,
Marcelo
",mrivas,https://github.com/macs3-project/MACS/issues/28
MDU6SXNzdWUyNDM5ODU0Ng==,Add options for customized scaling factors,CLOSED,2013-12-17T03:54:08Z,2014-04-14T20:18:56Z,2014-04-14T20:18:56Z,,taoliu,https://github.com/macs3-project/MACS/issues/29
MDU6SXNzdWUyNTczNjI4MA==,Manually filtering by q value gives more results than -q float,CLOSED,2014-01-16T16:17:30Z,2014-10-23T20:19:27Z,2014-10-23T20:19:27Z,"When I run macs using:

```
macs2 callpeak -t bHLHb5_bHLHb5_WT_B1.bam -c bHLHb5_bHLHb5_KO_B1.bam -f BAM -g mm -n p05 -p 0.05
```

to generate a large number of results (as multiple testing is ignored), then manually sort the results and filter out any with q > 0.05, I get 848 significant peaks. However if I just run:

```
macs2 callpeak -t bHLHb5_bHLHb5_WT_B1.bam -c bHLHb5_bHLHb5_KO_B1.bam -f BAM -g mm -n q05 -q 0.05
```

I only get 77 significant peaks. Should these methods be equivalent?
",edm1,https://github.com/macs3-project/MACS/issues/30
MDU6SXNzdWUyNjczMTc2MA==,installation,CLOSED,2014-02-01T04:24:06Z,2014-02-18T15:03:44Z,2014-02-18T15:03:44Z,"I'm having difficulty with installation.  I install to my own personal directory.  I also put

setenv PYTHONPATH /opt/python/lib/python2.7

in my .cshrc.

However, when I run macs2, I get the following error

Traceback (most recent call last):
  File ""./macs2"", line 362, in <module>
    main()
  File ""./macs2"", line 44, in main
    from MACS2.callpeak import run
ImportError: No module named callpeak

Thanks.
",xiaomimeow,https://github.com/macs3-project/MACS/issues/31
MDU6SXNzdWUyNjg0ODM3Nw==,Error within GZip,CLOSED,2014-02-03T23:47:31Z,2014-02-19T22:45:47Z,2014-02-19T22:45:47Z,"There is an error within the Gzip module during peakcalling, it is possible my data is corrupted, but samtools converts it from bam to sam and back with no issues. With a quick google search the problem seems to be in the gzip module, zlib I believe is the preferred python module for this kind of thing. If I could help in any other way please let me know.

Traceback (most recent call last):
  File ""/home/pi/hillst/bin/MACS/bin/macs2"", line 557, in <module>
    main()
  File ""/home/pi/hillst/bin/MACS/bin/macs2"", line 56, in main
    run( args )
  File ""/home/pi/hillst/.local/lib/python2.7/site-packages/MACS2/callpeak.py"", line 70, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/home/pi/hillst/.local/lib/python2.7/site-packages/MACS2/callpeak.py"", line 394, in load_tag_files_optio
ns
    control = options.parser(options.cfile[0], buffer_size=options.buffer_size).build_fwtrack()
  File ""cParser.pyx"", line 824, in MACS2.IO.cParser.BAMParser.build_fwtrack (MACS2/IO/cParser.c:10311)
  File ""cParser.pyx"", line 828, in MACS2.IO.cParser.BAMParser.build_fwtrack (MACS2/IO/cParser.c:10262)
  File ""cParser.pyx"", line 891, in MACS2.IO.cParser.BAMParser.__build_fwtrack_wo_pysam (MACS2/IO/cParser.c:11243
)
  File ""/local/cluster/lib/python2.7/gzip.py"", line 261, in read
    self._read(readsize)
  File ""/local/cluster/lib/python2.7/gzip.py"", line 308, in _read
    self._read_eof()
  File ""/local/cluster/lib/python2.7/gzip.py"", line 347, in _read_eof
    hex(self.crc)))
IOError: CRC check failed 0xeddeb258 != 0x498a3873L
",hillst,https://github.com/macs3-project/MACS/issues/32
MDU6SXNzdWUyNzI0MTQwNw==,'Keep duplicates' always ignores duplicates if tagged accordingly in SAM/BAM files,CLOSED,2014-02-10T04:34:57Z,2016-03-09T20:39:05Z,2016-03-09T20:39:05Z,"From the name of the parameter, it appears that ""--keep-dup all"" should use all duplicate reads regardless of. However, when a sam/bam file contains reads that are properly tagged as PCR or optical duplicate then these reads are ignored in the IO stage. 

[cParser.pyx](../blob/master/MACS2/IO/cParser.pyx) contains the following line of code (twice, lines 566 & 594 in current master)
`if bwflag & 4 or bwflag & 512 or bwflag & 1024:`
which filters reads with corresponding flags (i.e. 1024 for duplicates), therefore ignoring the user's request.

This bug(?) seems to be valid for both macs2 and macs14
",Gurado,https://github.com/macs3-project/MACS/issues/33
MDU6SXNzdWUzMDM0MDU3Nw==,MACS2 install issue,CLOSED,2014-03-27T20:47:07Z,2014-04-04T17:49:42Z,2014-04-04T17:49:42Z,"I am trying to install MACS2 on a computer running OSX 10.9.2. I have Python 2.7.5 and numpy is properly installed. I get the error message below whether i use easy_install or when i download from pypi (and do python setup.py install).  Any help would be appreciated.  Thanks. 

> easy_install MACS2

...

clang: error: unknown argument: '-mno-fused-madd' [-Wunused-command-line-argument-hard-error-in-future]

clang: note: this will be a hard error (cannot be downgraded to a warning) in the future

error: Setup script exited with error: command 'cc' failed with exit status 1
",dphansti,https://github.com/macs3-project/MACS/issues/34
MDU6SXNzdWUzMDc0Mjc0OA==,MACS2 installation error,CLOSED,2014-04-03T02:45:47Z,2014-06-17T16:13:51Z,2014-06-17T16:13:51Z,"Hi, 

I am having problem installing MACS2 on our system. 
The software builds without error, but when I run macs2diff, following error message shows up. 

File ""/opt/apps/macs2/2.0.10/macs2diff"", line 31, in <module>
    from MACS2.OptValidator import opt_validate_diff
  File ""/opt/apps/macs2/2.0.10/MACS2/OptValidator.py"", line 27, in <module>
    from MACS2.IO.cParser import BEDParser, ELANDResultParser, ELANDMultiParser, \
ImportError: No module named cParser

But if I list all the files on /opt/apps/macs2/2.0.10/MACS2/IO/
cParser.c, cParser.pyx  seems to be there.
and if I list files in /opt/apps/macs2/2.0.10/lib/python2.7/site-packages/MACS2/IO which is in PYTHONPATH, cParser.so is there. 

Can you tell me what seems to be an issue here? 

Thanks,
Jawon
",wonaya,https://github.com/macs3-project/MACS/issues/35
MDU6SXNzdWUzMjYzMjkyMg==,does not compile/install,CLOSED,2014-05-01T17:56:21Z,2014-08-31T05:53:07Z,2014-05-01T19:12:21Z,"I downloaded commit dd902d946053c32683c7ae82eb81a7b40448f903 and I was unable to install it.

```
thocking@silene:~/projects/chip-seq/MACS$ python setup.py install
/usr/lib/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: 'install_requires'
  warnings.warn(msg)
running install
running build
running build_py
creating build
creating build/lib.linux-x86_64-2.7
creating build/lib.linux-x86_64-2.7/MACS2
copying MACS2/Constants.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/bdgbroadcall.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/OptValidator.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/filterdup.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/predictd.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/pileup.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/refinepeak.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/diffpeak.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/bdgpeakcall.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/bdgcmp.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/__init__.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/randsample.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/bdgdiff.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/callpeak.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/OutputWriter.py -> build/lib.linux-x86_64-2.7/MACS2
copying MACS2/cStat.py -> build/lib.linux-x86_64-2.7/MACS2
creating build/lib.linux-x86_64-2.7/MACS2/IO
copying MACS2/IO/WiggleIO.py -> build/lib.linux-x86_64-2.7/MACS2/IO
copying MACS2/IO/BinKeeper.py -> build/lib.linux-x86_64-2.7/MACS2/IO
copying MACS2/IO/__init__.py -> build/lib.linux-x86_64-2.7/MACS2/IO
running build_ext
building 'MACS2.cProb' extension
creating build/temp.linux-x86_64-2.7
creating build/temp.linux-x86_64-2.7/MACS2
gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/lib/python2.7/dist-packages/numpy/core/include -I/usr/include/python2.7 -c MACS2/cProb.c -o build/temp.linux-x86_64-2.7/MACS2/cProb.o
gcc: error: MACS2/cProb.c: No such file or directory
gcc: fatal error: no input files
compilation terminated.
error: command 'gcc' failed with exit status 4
thocking@silene:~/projects/chip-seq/MACS$ python setup.py install
/usr/lib/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: 'install_requires'
  warnings.warn(msg)
running install
running build
running build_py
running build_ext
building 'MACS2.cProb' extension
gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/lib/python2.7/dist-packages/numpy/core/include -I/usr/include/python2.7 -c MACS2/cProb.c -o build/temp.linux-x86_64-2.7/MACS2/cProb.o
gcc: error: MACS2/cProb.c: No such file or directory
gcc: fatal error: no input files
compilation terminated.
error: command 'gcc' failed with exit status 4
```
",tdhock,https://github.com/macs3-project/MACS/issues/36
MDU6SXNzdWUzNDE2MDI2Ng==,format and use of gappedPeak output file?,CLOSED,2014-05-23T09:51:08Z,2014-06-20T12:37:19Z,2014-06-20T12:37:19Z,"Hello, 
Thanks for making the tool available. I am testing out macs2 and see how to use it for downstream analysis with MEDIPS or ChIPpeakAnno in R's Bioconductor package. 
I ran the following command:

``` bash
macs2 callpeak -t LT1.bam LT2.bam LT3.bam LT4.bam -c C5.bam C6.bam C7.bam C8.bam --broad -n RatMeDIP -f BAM -g 1949947921 --outdir macs2
```

Among the output files, I don't understand the format and use of .gappedPeak file. Could you update the README file so it explains about the format and use of this file?

Thanks
",biocyberman,https://github.com/macs3-project/MACS/issues/37
MDU6SXNzdWUzNDU4Mjk2MQ==,bdgdiff error: has no attribute 'empirical_distr_llr',CLOSED,2014-05-29T19:07:52Z,2014-06-17T16:05:50Z,2014-06-17T16:05:50Z,"We are comparing two files with the command:

```
macs2 bdgdiff --t1 rep1_treat_pileup.bdg --t2 rep2_treat_pileup.bdg --c1 rep1_control_lambda.bdg --c2 rep2_control_lambda.bdg --o-prefix REP1_REP2
```

We get this error message:

``` bash
Traceback (most recent call last):
  File ""/home/dave/bin/macs2"", line 559, in <module>
    main()
  File ""/home/dave/bin/macs2"", line 84, in main
    run( args )
  File ""/home/dave/lib/python2.7/site-packages/MACS2/bdgdiff.py"", line 92, in run
    depth2 )
  File ""cScoreTrack.pyx"", line 1415, in MACS2.IO.cScoreTrack.TwoConditionScores.__init__ (MACS2/IO/cScoreTrack.c:20454)
AttributeError: 'MACS2.IO.cScoreTrack.TwoConditionScores' object has no attribute 'empirical_distr_llr'
```

Is this a bug or is there something wrong with our input?  They were generated from ENCODE samples using callpeak:

``` bash
macs2 callpeak -t rep1.sam -f SAM -g hs -n rep1 -B -q 0.05
macs2 callpeak -t rep2.sam -f SAM -g hs -n rep2 -B -q 0.05
```

This was also observed for the data in the test folder using test.sh
",davebridges,https://github.com/macs3-project/MACS/issues/38
MDU6SXNzdWUzNTQwODQxMA==,MACS2 Cython compilation fails ,CLOSED,2014-06-10T18:00:17Z,2014-06-17T15:27:54Z,2014-06-17T15:27:54Z,"When building from source, one has to regenerate the .c file, using the `setup_w_cython.py`.

This fails for me when compiling the `MACS2/IO/cCallPeakUnit.pyx` file.

I’m using Python 2.7.3 under Ubuntu 12.04, Cython 0.15.1

Steps to reproduce:
- Straight out Git clone
- `python setup_w_cython.py build`

Stack trace:

```
MACS2/IO/cScoreTrack.c:14071:37: attention : ‘__pyx_v_cutoff’ may be used uninitialized in this function [-Wuninitialized]
gcc -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -Wl,-z,relro build/temp.linux-i686-2.7/MACS2/IO/cScoreTrack.o -o build/lib.linux-i686-2.7/MACS2/IO/cScoreTrack.so
cythoning MACS2/IO/cCallPeakUnit.pyx to MACS2/IO/cCallPeakUnit.c

Error compiling Cython file:
------------------------------------------------------------
...
                if call_summits:
                    #for x in peak_content:
                    #    if x[2] >= 10:
                    #        print peak_content
                    #        break
                    self.__close_peak_with_subpeaks (peak_content, peaks, min_length, chrom, smoothlen = min_length, score_cutoff_s = score_cutoff_s ) # smooth length is min_length, i.e. fragment size 'd'
                                                   ^
------------------------------------------------------------

MACS2/IO/cCallPeakUnit.pyx:689:52: Keyword and starred arguments not allowed in cdef functions.

Error compiling Cython file:
------------------------------------------------------------
...
                    #    if x[2] >= 10:
                    #        print peak_content
                    #        break
                    self.__close_peak_with_subpeaks (peak_content, peaks, min_length, chrom, smoothlen = min_length, score_cutoff_s = score_cutoff_s ) # smooth length is min_length, i.e. fragment size 'd'
                else:
                    self.__close_peak_wo_subpeaks   (peak_content, peaks, min_length, chrom, smoothlen = min_length, score_cutoff_s = score_cutoff_s ) # smooth length is min_length, i.e. fragment size 'd'
                                                   ^
------------------------------------------------------------

MACS2/IO/cCallPeakUnit.pyx:691:52: Keyword and starred arguments not allowed in cdef functions.

Error compiling Cython file:
------------------------------------------------------------
...
        # save the last peak
        if not peak_content:
            return peaks
        else:
            if call_summits:
                self.__close_peak_with_subpeaks (peak_content, peaks, min_length, chrom, smoothlen = min_length, score_cutoff_s = score_cutoff_s ) # smooth length is min_length, i.e. fragment size 'd'
                                               ^
------------------------------------------------------------

MACS2/IO/cCallPeakUnit.pyx:699:48: Keyword and starred arguments not allowed in cdef functions.

Error compiling Cython file:
------------------------------------------------------------
...
            return peaks
        else:
            if call_summits:
                self.__close_peak_with_subpeaks (peak_content, peaks, min_length, chrom, smoothlen = min_length, score_cutoff_s = score_cutoff_s ) # smooth length is min_length, i.e. fragment size 'd'
            else:
                self.__close_peak_wo_subpeaks   (peak_content, peaks, min_length, chrom, smoothlen = min_length, score_cutoff_s = score_cutoff_s ) # smooth length is min_length, i.e. fragment size 'd'
                                               ^
------------------------------------------------------------

MACS2/IO/cCallPeakUnit.pyx:701:48: Keyword and starred arguments not allowed in cdef functions.
building 'MACS2.IO.cCallPeakUnit' extension
gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/lib/python2.7/dist-packages/numpy/core/include -I/usr/include/python2.7 -c MACS2/IO/cCallPeakUnit.c -o build/temp.linux-i686-2.7/MACS2/IO/cCallPeakUnit.o
MACS2/IO/cCallPeakUnit.c:1:2: erreur: #error Do not use this file, it is the result of a failed Cython compilation.
error: command 'gcc' failed with exit status 1
```
",JeanFred,https://github.com/macs3-project/MACS/issues/40
MDU6SXNzdWUzNTcxNzM1Mw==,Geeting the number of reads per peak,CLOSED,2014-06-14T00:36:49Z,2014-10-23T20:19:10Z,2014-10-23T20:19:10Z,"Hi,

I wanted to check whether I can recover from the output of MACS2 the number of reads falling within a peak. Is this provided in the narrowPeak file as the column 5 entitled ""5th: integer score for display""?

Thanks,
Oana
",oursu,https://github.com/macs3-project/MACS/issues/41
MDU6SXNzdWUzNjE4NTc5Ng==,cannot run bdgdiff or diffpeak,CLOSED,2014-06-20T17:18:26Z,2014-06-20T20:55:13Z,2014-06-20T17:45:12Z,"I got `ImportError: No module named cDiffScore` error when running it. I checked my `/usr/local/lib/python2.7/dist-packages/MACS2/IO`, and cannot find `cDiffScore.pyx` inside. I also tried to download your source code from both github master and pypi. I found `cDiffScore.pyx` inside `MACS2/IO`, and I can use

``` python
import pyximport
pyximport.install()
from cDiffScore import DiffScoreTrackI
```

to compile it. I copied all files in IO after compiling to `/usr/local/lib/python2.7/dist-packages/MACS2/IO`. It still doesn't work. Do you have any idea to solve this problem?
",hunterchung,https://github.com/macs3-project/MACS/issues/42
MDU6SXNzdWUzNjI4MjIxOA==,How peaks are calculated ?,CLOSED,2014-06-23T11:28:16Z,2014-10-23T20:07:10Z,2014-10-23T20:07:10Z,"I noticed that after `callpeak` command with treat vs control MeDIP samples, I don't have peaks with fold-changes < 1, which, I suppose, are demethylated spots. Is it correct to expect fold-change < 1 for demethylated peaks? In general, a plain English explanation of how peaks and fold-changes are calculated will be very helpful. 

I tried looking for that information in the publication http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3120977 but could not find anything. The last resort could be to look into the source code, but I prefer to have the authors' words first.
",biocyberman,https://github.com/macs3-project/MACS/issues/43
MDU6SXNzdWUzNjUyNDYyNA==,macs2 output files,CLOSED,2014-06-25T21:32:46Z,2014-10-23T19:58:32Z,2014-10-23T19:58:32Z,"Hi Everyone,

I have recently started using MACS2 for peak calling. I want to understand some columns in the output file NAME_peaks.xls
What does 5th column which is Absolute peak summit position tells?
What does pileup height at peak summit means??

What is the difference when I call macs2 callpeak with -q 0.01 and with -q 0.05

Also I read about the -m MFOLD option but could not understand it properly.

Hope to hear from you soon 

Regards
Varun
",gupta567varun,https://github.com/macs3-project/MACS/issues/44
MDU6SXNzdWUzNzQ2Mzg5MQ==,gcc install,CLOSED,2014-07-09T13:29:48Z,2014-10-23T19:05:06Z,2014-10-23T19:05:06Z,"Dear Sir:

[root@biocc mpc-1.0.2]# ./configure --with-gmp-include=/usr/local/include --with-gmp-lib=/usr/local/lib
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking whether to enable maintainer-specific portions of Makefiles... no
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for a sed that does not truncate output... /bin/sed
checking for CC and CFLAGS in gmp.h... yes CC=gcc CFLAGS=-O2 -pedantic -m64
checking for CC=gcc and CFLAGS=-O2 -pedantic -m64... yes
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking for style of include used by make... GNU
checking dependency style of gcc... gcc3
checking for ar... ar
checking the archiver (ar) interface... ar
checking how to print strings... printf
checking for a sed that does not truncate output... (cached) /bin/sed
checking for fgrep... /bin/grep -F
checking for ld used by gcc... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
checking the name lister (/usr/bin/nm -B) interface... BSD nm
checking whether ln -s works... yes
checking the maximum length of command line arguments... 1966080
checking whether the shell understands some XSI constructs... yes
checking whether the shell understands ""+=""... yes
checking how to convert x86_64-unknown-linux-gnu file names to x86_64-unknown-linux-gnu format... func_convert_file_noop
checking how to convert x86_64-unknown-linux-gnu file names to toolchain format... func_convert_file_noop
checking for /usr/bin/ld option to reload object files... -r
checking for objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for dlltool... no
checking how to associate runtime and link libraries... printf %s\n
checking for archiver @FILE support... @
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /usr/bin/nm -B output from gcc object... ok
checking for sysroot... no
checking for mt... mt
checking if mt is a manifest tool... no
checking how to run the C preprocessor... gcc -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for dlfcn.h... yes
checking for objdir... .libs
checking if gcc supports -fno-rtti -fno-exceptions... no
checking for gcc option to produce PIC... -fPIC -DPIC
checking if gcc PIC flag -fPIC -DPIC works... yes
checking if gcc static flag -static works... no
checking if gcc supports -c -o file.o... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
checking whether -lc should be explicitly linked in... no
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... yes
checking for gmp.h... yes
checking for ANSI C header files... (cached) yes
checking locale.h usability... yes
checking locale.h presence... yes
checking for locale.h... yes
checking for inttypes.h... (cached) yes
checking for stdint.h... (cached) yes
checking limits.h usability... yes
checking limits.h presence... yes
checking for limits.h... yes
checking for unistd.h... (cached) yes
checking sys/time.h usability... yes
checking sys/time.h presence... yes
checking for sys/time.h... yes
checking whether time.h and sys/time.h may both be included... yes
checking complex.h usability... yes
checking complex.h presence... yes
checking for complex.h... yes
checking for library containing creal... -lm
checking whether creal, cimag and I can be used... yes
checking for an ANSI C-conforming const... yes
checking for size_t... yes
checking for gettimeofday... yes
checking for localeconv... yes
checking for setlocale... yes
checking for dup... yes
checking for dup2... yes
checking for __gmpz_init in -lgmp... yes
checking for MPFR... no
configure: error: libmpfr not found or uses a different ABI (including static vs shared).

my version of linux is Red Hat 4.4.7-7
I want to upgate the gcc, the three packages are ""gmp-6.0.0a.tar.bz2"", ""mpfr-3.1.2.tar.gz"" ,""mpc-1.0.1.tar.gz"". When I install the MPC, it exists the error above. So i want to ask you the reason. Thank you.
",zcl19880606,https://github.com/macs3-project/MACS/issues/45
MDU6SXNzdWUzODQxNzg2MA==,bdgdiff calling problem,CLOSED,2014-07-22T16:32:29Z,2014-07-25T18:22:59Z,2014-07-25T18:22:59Z,"I used `bdgdiff` to find different/common regions from two samples. The program ran successfully, but when I visualized them in UCSC genome browser, I found this region doesn't make sense.

![pic](https://cloud.githubusercontent.com/assets/1376579/3660745/ab97bb22-11ba-11e4-8776-ad2cb99fe821.png)
As you see in the image, the first track is `sample1_vs_sample2_cond2.bed`, the second track is `sample2_treat_pileup.bw`, and the third track is `sample1_treat_pileup.bw`.
Intuitively, those peaks showed in sample 1 and 2 look like common peaks, however, `macs2 bdgdiff` considered them as different peaks.

In case you need more information. Here are peak excel files from `macs2 callpeak`.

**sample 1**

| chr | start | end | length | abs_summit | pileup | -LOG10(pvalue) | fold_enrichment | -LOG10(qvalue) | name |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| chrUextra | 27371424 | 27371889 | 466 | 27371713 | 235 | 53.31093 | 3.29706 | 49.35984 | zr785_6_minus_control_peak_1858 |

**sample 2**

| chr | start | end | length | abs_summit | pileup | -LOG10(pvalue) | fold_enrichment | -LOG10(qvalue) | name |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| chrUextra | 27371432 | 27371888 | 457 | 27371731 | 214 | 63.16993 | 4.0555 | 58.86643 | zr785_7_minus_control_peak_1483 |

**sample1_vs_sample2_cond2.bed**
`chrUextra  27371569    27371799    sample1_vs_sample2_cond2_73 3.70122`
",hunterchung,https://github.com/macs3-project/MACS/issues/46
MDU6SXNzdWUzODY2MzEwMA==,bdgdiff for present or absent?,CLOSED,2014-07-24T18:58:49Z,2014-07-24T19:20:12Z,2014-07-24T19:20:12Z,"`bdgdiff` is good for identify up or down regulated peaks. I am also interested in present or absent peaks. According to `Call differential binding events` page in the wiki, 

>  A basic requirement is that this region should be at least enriched in either condition.

It looks like `bdgdiff` cannot identify present or absent peaks. Is it true? Do you have any suggestion for identifying present or absent peaks? 

Thanks!
",hunterchung,https://github.com/macs3-project/MACS/issues/47
MDU6SXNzdWUzODY3NDE1Ng==,Pileup bdg files,CLOSED,2014-07-24T21:07:49Z,2014-08-20T16:07:28Z,2014-08-20T16:07:28Z,"I am just a little bit confused about pileup bdg files. The scores/values in treat are always integer, but the scores/values in control are float points. I am wondering if `MACS2` normalized control pileup bdg according to treat, and keep treat **un-normalized**. If it is true, when I compare a treat to another, I still need to normalize them. Also, do you think normalize by mapped reads is a good way?

Thanks!
",hunterchung,https://github.com/macs3-project/MACS/issues/48
MDU6SXNzdWUzODg5MjcwMg==,"Fix ""/usr/lib/python2.7/distutils/dist.py:267 UserWarning: Unknown distribution option: 'install_requires'""",CLOSED,2014-07-28T14:03:10Z,2020-10-24T09:36:34Z,2014-10-23T19:08:50Z,"As mentioned on http://pythonhosted.org/distribute/, distribute is deprecated:

> Distribute is a deprecated fork of the Setuptools project.
> 
> Since the Setuptools 0.7 release, Setuptools and Distribute have merged and
> Distribute is no longer being maintained. All ongoing effort should reference the
> Setuptools project and the Setuptools documentation.

By using setuptools instead of distutils, the ""**/usr/lib/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: 'install_requires'**"" warning disappears:

```
$ python setup.py build
/usr/lib/python2.7/distutils/dist.py:267: UserWarning: Unknown distribution option: 'install_requires'
  warnings.warn(msg)
running build
running build_py
running build_ext
building 'MACS2.cProb' extension
creating build/temp.linux-x86_64-2.7
creating build/temp.linux-x86_64-2.7/MACS2
...
```

``` diff
$ git diff setup.py
diff --git a/setup.py b/setup.py
index 3044be4..714d3ac 100644
--- a/setup.py
+++ b/setup.py
@@ -19,7 +19,7 @@ the distribution).

 import os
 import sys
-from distutils.core import setup, Extension
+from setuptools import setup, Extension

 # Use build_ext from Cython if found
 command_classes = {}
```
",ghuls,https://github.com/macs3-project/MACS/issues/49
MDU6SXNzdWUzODkwNzUwMA==,Huge memory usage of callpeak for earthworm genome,CLOSED,2014-07-28T16:29:52Z,2019-10-02T20:51:00Z,2019-10-02T20:51:00Z,"I have some earthworm ChIP-seq samples. `MACS2 callpeak` needed a huge amount memory, and I got out of memory error for my server with **68GB** memory. I am not sure why, but I think it could be fixed.

**earthworm**

| Genome size | Effective genome size | ref genome scaffold/chromosome # | mapped reads # |
| --- | --- | --- | --- |
| 624328310 | 437029817  (genome size*0.7) | 7779940 | 477841 |

The output of `MACS2 callpeak`

```
INFO  @ Fri, 25 Jul 2014 16:38:21:
# Command line: callpeak -B -g 437029817 -t sample1.bam -c sample2.bam -n sample1_minus_control --nomodel --extsize 200
# ARGUMENTS LIST:
# name = sample1_minus_control
# format = AUTO
# ChIP-seq file = ['sample1.bam']
# control file = ['sample2.bam']
# effective genome size = 4.37e+08
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off

INFO  @ Fri, 25 Jul 2014 16:38:21: #1 read tag files...
INFO  @ Fri, 25 Jul 2014 16:38:21: #1 read treatment tags...
INFO  @ Fri, 25 Jul 2014 16:38:25: Detected format is: BAM
INFO  @ Fri, 25 Jul 2014 16:38:25: * Input file is gzipped.
INFO  @ Fri, 25 Jul 2014 16:38:38:  1000000
INFO  @ Fri, 25 Jul 2014 16:38:51:  2000000
INFO  @ Fri, 25 Jul 2014 16:39:07:  3000000
INFO  @ Fri, 25 Jul 2014 16:39:24:  4000000
INFO  @ Fri, 25 Jul 2014 16:39:43:  5000000
INFO  @ Fri, 25 Jul 2014 16:39:58:  6000000
comp.sh: line 1: 27146 Killed                  macs2 callpeak -B -g 437029817 -t sample1.bam -c sample2.bam -n sample1_minus_control --nomodel --extsize 200
```
",hunterchung,https://github.com/macs3-project/MACS/issues/50
MDU6SXNzdWU0MDM1NTY4NQ==,Problem when using --trackline argument when control file absent,CLOSED,2014-08-15T15:13:23Z,2014-10-23T19:53:23Z,2014-10-23T19:53:23Z,"When macs2 is used without a control file and with the --trackline argument, the application crashes at the call peaks step (#3 step).

Version: macs2 2.1.0.20140616 (installed using python package)

Operating system: CentOS 6

Reproduce steps: Use this command line with a valid BAM file  

```
macs2 callpeak -t VALID_BAM_FILE.bam  -f BAM --gsize 3.3e9 -q 0.01 -n output_file  --trackline -B --SPMR 
```

Output example:

```
[user@ls32]$ macs2 callpeak -t HI.1943.008.Index_14.LCC9_CTRL_MED1_ChIP8_GB_rep1.bam  -f BAM --gsize 3.3e9 -q 0.01 -n output_file  --trackline -B --SPMR
INFO  @ Fri, 15 Aug 2014 10:49:25: 
# Command line: callpeak -t HI.1943.008.Index_14.LCC9_CTRL_MED1_ChIP8_GB_rep1.bam -f BAM --gsize 3.3e9 -q 0.01 -n output_file --trackline -B --SPMR
# ARGUMENTS LIST:
# name = output_file
# format = BAM
# ChIP-seq file = ['HI.1943.008.Index_14.LCC9_CTRL_MED1_ChIP8_GB_rep1.bam']
# control file = None
# effective genome size = 3.30e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 1.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# MACS will save fragment pileup signal per million reads
INFO  @ Fri, 15 Aug 2014 10:49:25: #1 read tag files... 
INFO  @ Fri, 15 Aug 2014 10:49:25: #1 read treatment tags... 
INFO  @ Fri, 15 Aug 2014 10:49:30:  1000000 
... 
INFO  @ Fri, 15 Aug 2014 10:51:12:  25000000 
INFO  @ Fri, 15 Aug 2014 10:51:13: #1 tag size is determined as 50 bps 
INFO  @ Fri, 15 Aug 2014 10:51:13: #1 tag size = 50 
INFO  @ Fri, 15 Aug 2014 10:51:13: #1  total tags in treatment: 22592117 
INFO  @ Fri, 15 Aug 2014 10:51:13: #1 user defined the maximum tags... 
INFO  @ Fri, 15 Aug 2014 10:51:13: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Fri, 15 Aug 2014 10:51:16: #1  tags after filtering in treatment: 21510983 
INFO  @ Fri, 15 Aug 2014 10:51:16: #1  Redundant rate of treatment: 0.05 
INFO  @ Fri, 15 Aug 2014 10:51:16: #1 finished! 
INFO  @ Fri, 15 Aug 2014 10:51:16: #2 Build Peak Model... 
INFO  @ Fri, 15 Aug 2014 10:51:24: #2 number of paired peaks: 37367 
INFO  @ Fri, 15 Aug 2014 10:51:24: start model_add_line... 
INFO  @ Fri, 15 Aug 2014 10:51:52: start X-correlation... 
INFO  @ Fri, 15 Aug 2014 10:51:52: end of X-cor 
INFO  @ Fri, 15 Aug 2014 10:51:52: #2 finished! 
INFO  @ Fri, 15 Aug 2014 10:51:52: #2 predicted fragment length is 165 bps 
INFO  @ Fri, 15 Aug 2014 10:51:52: #2 alternative fragment length(s) may be 165 bps 
INFO  @ Fri, 15 Aug 2014 10:51:52: #2.2 Generate R script for model : output_file_model.r 
INFO  @ Fri, 15 Aug 2014 10:51:52: #3 Call peaks... 
Traceback (most recent call last):
  File ""/lustredirect/commonSoftware/python/python-2.7.8/bin/macs2"", line 559, in <module>
    main()
  File ""/lustredirect/commonSoftware/python/python-2.7.8/bin/macs2"", line 56, in main
    run( args )
  File ""/lustredirect/commonSoftware/python/python-2.7.8/lib/python2.7/site-packages/MACS2/callpeak.py"", line 261, in run
    peakdetect.call_peaks()
  File ""cPeakDetect.pyx"", line 110, in MACS2.cPeakDetect.PeakDetect.call_peaks (MACS2/cPeakDetect.c:1714)
  File ""cPeakDetect.pyx"", line 334, in MACS2.cPeakDetect.PeakDetect.__call_peaks_wo_control (MACS2/cPeakDetect.c:3939)
AttributeError: 'NoneType' object has no attribute 'enable_trackline'
```
",adeschen,https://github.com/macs3-project/MACS/issues/51
MDU6SXNzdWU0MTg0MjIwMg==,Logical error in code,CLOSED,2014-09-03T17:25:41Z,2014-10-22T12:00:37Z,2014-10-22T12:00:37Z,"https://github.com/taoliu/MACS/blob/2.1.0.20140616/MACS2/IO/cFixWidthTrack.pyx#L284

'n' is number of repeated tags. ANd it have not been initialized to 1 for every chromosome.
",kuldeepiitg,https://github.com/macs3-project/MACS/issues/52
MDU6SXNzdWU0MjEwODQ1OA==,"Deletion, Insertion and Soft clipping are not taken into consideration",CLOSED,2014-09-06T04:40:05Z,2014-10-29T06:04:57Z,2014-10-29T06:04:57Z,"While computing tags for negative strand in case of Single End Sam file, you take a tag to be end of a read that is ""start + readLength - 1"". Which is correct if read is exactly aligned. But when there is a few bases insertion or deletion then it might happen that end is not equal to ""start + readLength - 1"".
",kuldeepiitg,https://github.com/macs3-project/MACS/issues/53
MDU6SXNzdWU0MjQ5MzM0Nw==,How to run paired end samples?,CLOSED,2014-09-11T06:29:47Z,2014-09-29T06:06:23Z,2014-09-29T06:06:23Z,"I found in some google group that use BAMPE option for paired end samples. But it is throwing following error 

INFO  @ Thu, 11 Sep 2014 11:51:38: 
# Command line: callpeak -t SRR391645-Paired-treatment-Fully_Aligned_Reads-Filtered_On_Chr1.sam -f BAMPE
# ARGUMENTS LIST:
# name = NA
# format = BAMPE
# ChIP-seq file = ['SRR391645-Paired-treatment-Fully_Aligned_Reads-Filtered_On_Chr1.sam']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off

INFO  @ Thu, 11 Sep 2014 11:51:38: #1 read fragment files... 
INFO  @ Thu, 11 Sep 2014 11:51:38: #1 read treatment fragments... 
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 559, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 56, in main
    run( args )
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak.py"", line 69, in run
    if options.PE_MODE: (treat, control) = load_frag_files_options (options)
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak.py"", line 362, in load_frag_files_options
    treat = tp.build_petrack()
  File ""cParser.pyx"", line 1060, in MACS2.IO.cParser.BAMPEParser.build_petrack (MACS2/IO/cParser.c:13617)
  File ""cParser.pyx"", line 1064, in MACS2.IO.cParser.BAMPEParser.build_petrack (MACS2/IO/cParser.c:13568)
  File ""cParser.pyx"", line 1085, in MACS2.IO.cParser.BAMPEParser.__build_petrack_wo_pysam (MACS2/IO/cParser.c:13774)
  File ""cParser.pyx"", line 776, in MACS2.IO.cParser.BAMParser.get_references (MACS2/IO/cParser.c:9834)
  File ""cParser.pyx"", line 815, in MACS2.IO.cParser.BAMParser.__get_references_wo_pysam (MACS2/IO/cParser.c:10216)
struct.error: unpack requires a string argument of length 4
",kuldeepiitg,https://github.com/macs3-project/MACS/issues/54
MDU6SXNzdWU0NDExNDM3MQ==,Are output bdg files normalized for library size,CLOSED,2014-09-26T23:02:35Z,2014-10-07T16:20:28Z,2014-10-07T16:20:28Z,"I've read that the larger library is scaled to the smaller library.  
Do the bdg files (pileup and lamda) reflect this scaling?

I have samples from different conditions and I would like to show the graphs side by side but the library sizes were quite different.  Each replicate has an IP and an input file, so each replicate was run through MACS independently.
My understanding is that each pileup can be considered to be normalized for library size in comparison to the corresponding lambda, but not between different IP samples.... is that correct?
",IvoryC,https://github.com/macs3-project/MACS/issues/55
MDU6SXNzdWU0NDI2MTg2MQ==,Duplicate removal in paired end case seems to be ambiguous.,CLOSED,2014-09-29T06:41:14Z,2014-10-29T06:02:29Z,2014-10-29T06:02:29Z,"In my opinion, we should remove fragments with same start and end positions.

What did I understand by code is as follow: 
1. Make two separate lists of start and ends of fragments. Both the lists have equal number of entries.
2. Sort both of the lists. 
3. Now iterate over both lists simultaneously, such that nth entry from both the lists make a pair and if it is equal to (n-1)th pair then remove this pair.

counter example:
fragment1: (start:10, end:110)
fragment2: (10, 160)
fragment3: (20,110)

start tag list in sorted order : [10,10,20]
end tag list in sorted order : [110, 110, 160]

after duplicates removal,
start tags: [10, 20]
end tags: [110, 160]

It is removing entries even if there is no duplicate fragment.

Please correct me, if I have an incorrect understanding.
",kuldeepiitg,https://github.com/macs3-project/MACS/issues/56
MDU6SXNzdWU0NTAxNzA3MQ==,peak calling problem updating from MACS v1.0.1 to v2.0.10 ,CLOSED,2014-10-06T18:22:27Z,2014-10-21T21:29:32Z,2014-10-21T21:29:32Z,"Hi -

I've been struggling with this for a while now and I'm not able to figure out what the problem is, so I thought I'd report it here -- maybe it's a bug, maybe it's something I'm doing wrong.

I've used the same ChIP-seq dataset as input to MACS runs which have returned wildly different models. One was run on the Galaxy server (Macs-in-Galaxy v1.0.1) and one was run on a locally installed version (macs v2.0.10). Our data is generated from the sea star (P miniata) for which we have a draft genome (v1.0) that consists of >60k scaffolds. 

On my first run, a few months ago, I used MACS in Galaxy which seemed to run well, apart from giving me copious warnings about missing scaffolds with no mapped reads (to be expected, I'd guess), and returned the following model:

![macs-in-galaxy_model](https://cloud.githubusercontent.com/assets/8302017/4530788/3c5bb97e-4d84-11e4-9624-a43fe97c9df6.png)

Since then, I've been trying to upgrade my analysis to a more current version of MACS. Once I started feeding macs2 SAM files instead of BAM files (it was choking when there was a scaffold listed in the header that didn't contain any reads), it started to run. However, I'm getting errors such as:

""WARNING @ Mon, 06 Oct 2014 12:08:55: #2 Since the d (36) calculated from paired-peaks are smaller than 2*tag length, it may be influenced by unknown sequencing problem!""

When I look at the model produced, I can see that something is wrong:

![macs2_model](https://cloud.githubusercontent.com/assets/8302017/4530790/4422d994-4d84-11e4-957e-a332fdc63ed4.png)

Any suggestions on what is going on? I've tried mucking around with the MFOLD values, --fix-bimodal options, and scaling up or down the datasets, but to no avail. I'm pasting the calls used below, in case that helps.

Thanks to any help rendered or attempted!
Greg

macs-in-galaxy:
 This file is generated by MACS
 ARGUMENTS LIST:
 name = MACS_in_Galaxy
 format = BAM
 ChIP-seq file = /galaxy-repl/main/files/008/660/dataset_8660004.dat
 control file = /galaxy-repl/main/files/008/659/dataset_8659999.dat
 effective genome size = 8.00e+08
 tag size = 75
 band width = 250
 model fold = 10
 pvalue cutoff = 1.00e-05
 Ranges for calculating regional lambda are : peak_region,1000,5000,10000
 unique tags in treatment: 15369349
 total tags in treatment: 101339026
 unique tags in control: 31531393
 total tags in control: 36056319
 d = 88

macs2, locally:

macs2 callpeak\
 -t ../../alignments/ip.filtered.sam\
 -c ../../alignments/inp.filtered.sam\
 -f SAM -g 8e+8\
 -m 1 10\
 --bw 250\ 
 -p 1e-5\
 -n tbr_macs

R --vanilla --slave < tbr_macs_model.r
",caryga,https://github.com/macs3-project/MACS/issues/57
MDU6SXNzdWU0NTA1Mjc1NQ==,output to stdout when using bdgcmp -m logLR,CLOSED,2014-10-07T00:07:57Z,2014-10-07T14:57:03Z,2014-10-07T14:57:03Z,"I've run bdgcmp using `-m qpois` and `-m FE` and everything seemed to work perfectly.  But I had some trouble with using `-m logLR`.

I tried to run bdgcmp using this line:
`$ MACS2 bdgcmp -t Exp1_Rep1_treat_pileup.bdg -c Exp1_Rep1_control_lambda.bdg -o Exp1_Rep1.logLR.bdg -m logLR`

But the output file ,Exp1_Rep1.logLR.bdg, was never created and the system prints a bunch of information to the screen that looks like this:
24.0 58.4892807007 -5.69374
25.0 58.4892807007 -5.3158
26.0 58.4892807007 -4.95524
27.0 58.4892807007 -4.61138
28.0 58.4892807007 -4.28362
30.0 58.4892807007 -3.67409
31.0 58.4892807007 -3.39129
32.0 58.4892807007 -3.12251
33.0 58.4892807007 -2.8673
...

When I redirect stdout like so:
`$ MACS2 bdgcmp -t Exp1_Rep1_treat_pileup.bdg -c Exp1_Rep1_cont
rol_lambda.bdg -o Exp1_Rep1.logLR.bdg -m logLR > output.logLR.bdg`

then the file Exp1_Rep1.logLR.bdg seems to be generated correctly.  Its 1.3GB, and output.logLR.bdg has the above output format and its 1.72GB.

What's going on here? I don't know what to do with this extra output.

I'm running MACS2 2.1.0.20140616 on OS X 10.9.5
Thanks for your time!
",IvoryC,https://github.com/macs3-project/MACS/issues/58
MDU6SXNzdWU0NjY2OTUyNw==,Import Error when running Callpeaks update!,CLOSED,2014-10-23T20:00:57Z,2019-02-07T20:58:48Z,2014-10-23T20:03:35Z,"I am running macs2 on a unix server... i tried both setup.py and setup_w_cython.py for installation, 
No apparent error were thrown during the installation

but when I use callpeaks 

kshi219@bugaboo:~/preprocess> macs2 callpeak -t wgEncodeSydhHistoneMcf7H3k09me3UcdAlnRep1.bam.gz.unique.tagAlign.gz -c wgEncodeSydhHistoneMcf7InputUcdAlnRep2.bam.gz.unique.tagAlign.gz -f BAM -n out -g hs -p 1e-2 --nomodel --extsize 73 -B --SPMR
Traceback (most recent call last):
  File ""/home/kshi219/MACS/bin/macs2"", line 615, in <module>
    main()
  File ""/home/kshi219/MACS/bin/macs2"", line 55, in main
    from MACS2.callpeak import run
  File ""/home/kshi219/MACS/lib/python2.7/site-packages/MACS2/callpeak.py"", line 30, in <module>
    from MACS2.OptValidator import opt_validate
  File ""/home/kshi219/MACS/lib/python2.7/site-packages/MACS2/OptValidator.py"", line 27, in <module>
    from MACS2.IO.cParser import BEDParser, ELANDResultParser, ELANDMultiParser, \
ImportError: /home/kshi219/MACS/lib/python2.7/site-packages/MACS2/IO/cParser.so: undefined symbol: __intel_sse2_strlen

sorry i was in the process of typing this out
",kshi219,https://github.com/macs3-project/MACS/issues/59
MDU6SXNzdWU0NzI2NjU5Mw==,Macs2 --nomodel,CLOSED,2014-10-30T13:00:16Z,2014-10-30T18:08:29Z,2014-10-30T18:08:29Z,"Hello tailiu;
  I have a problem with the parameter --nomodel, 
  If I run: macs2 callpeak -t sample.txt -f BED -g hs -n result -B -q 0.01  
  I can't get the peaks,but the tools suggest me to use --nomdel and --extsize 147 or other fixed number instead. 
  Then I run: macs2 callpeak -t sample.txt  --nomodel -f BED -g hs -n result -B -q 0.01 
  This time I can get some peaks. So I am confused about the result, dose the new peaks reliable?
",x1ben1,https://github.com/macs3-project/MACS/issues/60
MDU6SXNzdWU0OTQxOTk4Mg==, macs2 callpeak AttributeError: 'Namespace',CLOSED,2014-11-19T16:47:17Z,2018-02-23T04:15:38Z,2014-12-19T18:27:45Z,"When I run macs2 to call peak with this command

GEN_SIZE=0.4379e9
PVALUE=1e-5
macs2 callpeak -t ""FAI/FAI-FM1.bam"" -c ""FAI/FAI-IM.bam"" -n ""FAI/FAI-IM-FM1_macs_p05"" -f BAM -g ""$GEN_SIZE"" -p ""$PVALUE"" 2> FAI-IM-FM1_macs_p05.log

 I get this error message:

Traceback (most recent call last):
  File ""/local/peakseq/MACS-2/bin/macs2"", line 337, in <module>
    main()
  File ""/local/peakseq/MACS-2/bin/macs2"", line 54, in main
    run( args )
  File ""/local/python/2.7-bis/lib/python2.7/site-packages/MACS2/callpeak.py"", line 55, in run
    options = opt_validate( args )
  File ""/local/python/2.7-bis/lib/python2.7/site-packages/MACS2/OptValidator.py"", line 132, in opt_validate
    options.peakxls = os.path.join( options.outdir, options.name+""_peaks.xls"" )
AttributeError: 'Namespace' object has no attribute 'outdir'

Is there something wrong with my input? Could you explain to me, please.
",y-mone,https://github.com/macs3-project/MACS/issues/61
MDU6SXNzdWU1MTMwMTA1NQ==,Diffpeak information?,CLOSED,2014-12-08T13:21:30Z,2019-10-02T20:52:03Z,2019-10-02T20:52:03Z,"Hi, 

I would like to look at differential histone modifications between two different conditions. I have tried the Diffpeak option for this but can not find much information as to how it calculates differential binding (i.e. the log2-fold change column in the output xls file)and whether this is appropriate for histone modifications rather than transcription factors. I tried the command macs2 diffpeak --help but this doesn't answer my question. 

Also how do you specify two different sequencing depths? As my two samples have different depths. I tried -d depth_condition1 -d depth_condition2 but in the output xls file under ""Depth multiplier"", the value of the second depth is shown and not the first.

Many thanks
",nataliesilmon,https://github.com/macs3-project/MACS/issues/63
MDU6SXNzdWU1MzkxMzk4Mw==,Differences between MACS version 2.0.10.20120913  and MACS version 2.1.0.20140616,CLOSED,2015-01-09T20:56:44Z,2019-10-02T20:52:56Z,2019-10-02T20:52:56Z,"Hello

We currently updated our server and this included updating MACs2 from 2.0.10.20120913 to 2.1.0.20140616 version.

We are analyzing ChIP-seq data for several histone marks and factors, after reanalyzing our ChiP-seq libraries with the most recent MACs2 version, we noticed a large discrepancy between MACS version 2.0.10.20120913  and MACS version 2.1.0.20140616. Specially for H3K27me, we called 100289 peaks with the older version, and 150541 with the newer version. Other marks called closer number of peaks. 

Command lines were exactly the same.

macs2 callpeak -t  chip-seq_read.bed.gz -c input_read.bed.gz  -f BED -g hs -q 0.05  -n out_chip-seq_peaks

Was there any major change in the algorithm between these two version that could be causing these difference?

Thanks for your help

Alejandra Medina
",medinaale,https://github.com/macs3-project/MACS/issues/64
MDU6SXNzdWU1NDc1MDY2OA==,OverflowError: Python int too large to convert to C long,CLOSED,2015-01-19T11:03:03Z,2019-10-02T21:03:24Z,2019-10-02T21:03:24Z,"With the following command

```
macs2 callpeak --broad -t results/sicer_input/regular_hg19_1_200_150_0.74_600_.01.bed  -c results/sicer_input/control_hg19_1_200_150_0.74_600_.01.bed --nomodel --extsize 146 --name broad_peaks_extsize_146
```

I got this error message (some output shown):

```
INFO  @ Mon, 19 Jan 2015 11:11:43:  101000000
INFO  @ Mon, 19 Jan 2015 11:11:44:  102000000
^QINFO  @ Mon, 19 Jan 2015 11:11:54: #1 tag size is determined as 51 bps
INFO  @ Mon, 19 Jan 2015 11:11:54: #1 tag size = 51
INFO  @ Mon, 19 Jan 2015 11:11:54: #1  total tags in treatment: 83049643
INFO  @ Mon, 19 Jan 2015 11:11:54: #1 user defined the maximum tags...
INFO  @ Mon, 19 Jan 2015 11:11:54: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s)
INFO  @ Mon, 19 Jan 2015 11:12:07: #1  tags after filtering in treatment: 73842618
INFO  @ Mon, 19 Jan 2015 11:12:07: #1  Redundant rate of treatment: 0.11
INFO  @ Mon, 19 Jan 2015 11:12:07: #1  total tags in control: 102171050
INFO  @ Mon, 19 Jan 2015 11:12:07: #1 user defined the maximum tags...
INFO  @ Mon, 19 Jan 2015 11:12:07: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s)
INFO  @ Mon, 19 Jan 2015 11:12:25: #1  tags after filtering in control: 99296421
INFO  @ Mon, 19 Jan 2015 11:12:25: #1  Redundant rate of control: 0.03
INFO  @ Mon, 19 Jan 2015 11:12:25: #1 finished!
INFO  @ Mon, 19 Jan 2015 11:12:25: #2 Build Peak Model...
INFO  @ Mon, 19 Jan 2015 11:12:25: #2 Skipped...
INFO  @ Mon, 19 Jan 2015 11:12:25: #2 Use 146 as fragment length
INFO  @ Mon, 19 Jan 2015 11:12:25: #3 Call peaks...
INFO  @ Mon, 19 Jan 2015 11:12:25: #3 Call broad peaks with given level1 -log10qvalue cutoff and level2: 1.301030, 1.000000...
INFO  @ Mon, 19 Jan 2015 11:12:25: #3 Pre-compute pvalue-qvalue table...
INFO  @ Mon, 19 Jan 2015 11:32:42: #3 Call peaks for each chromosome...
Traceback (most recent call last):
  File ""/Users/endrebakkenstovner/anaconda/bin/macs2"", line 559, in <module>
    main()
  File ""/Users/endrebakkenstovner/anaconda/bin/macs2"", line 56, in main
    run( args )
  File ""/Users/endrebakkenstovner/anaconda/lib/python2.7/site-packages/MACS2/callpeak.py"", line 261, in run
    peakdetect.call_peaks()
  File ""cPeakDetect.pyx"", line 105, in MACS2.cPeakDetect.PeakDetect.call_peaks (MACS2/cPeakDetect.c:1696)
  File ""cPeakDetect.pyx"", line 256, in MACS2.cPeakDetect.PeakDetect.__call_peaks_w_control (MACS2/cPeakDetect.c:3276)
  File ""cCallPeakUnit.pyx"", line 964, in MACS2.IO.cCallPeakUnit.CallerFromAlignments.call_broadpeaks (MACS2/IO/cCallPeakUnit.c:13516)
  File ""cCallPeakUnit.pyx"", line 1047, in MACS2.IO.cCallPeakUnit.CallerFromAlignments.call_broadpeaks (MACS2/IO/cCallPeakUnit.c:13210)
  File ""cCallPeakUnit.pyx"", line 1238, in MACS2.IO.cCallPeakUnit.CallerFromAlignments.__add_broadpeak (MACS2/IO/cCallPeakUnit.c:15428)
  File ""cPeakIO.pyx"", line 799, in MACS2.IO.cPeakIO.BroadPeakIO.add (MACS2/IO/cPeakIO.c:13956)
OverflowError: Python int too large to convert to C long
```

The offending code is in [this line](https://github.com/taoliu/MACS/blob/master/MACS2/IO/cPeakIO.pyx#L799)

```
def add (self, char * chromosome, long start, long end, long score = 0,
str thickStart=""."", str thickEnd=""."",
long blockNum=0, str blockSizes=""."",
str blockStarts=""."", float pileup = 0,
float pscore = 0, float fold_change = 0,
float qscore = 0, str name = ""NA"" ):
```

I've never used cython before, but is the fix just to make the long a longlong?

Ps. will rerun the same command with debug-level verbosity and post messages.
",N/A,https://github.com/macs3-project/MACS/issues/65
MDU6SXNzdWU1NzQxODI5NQ==,output from macs2 callpeak with --broad option contains strange numbers,CLOSED,2015-02-12T05:12:01Z,2016-03-09T20:05:15Z,2016-03-09T20:05:15Z,"I am analysing data from a pilot experiment, unfortunately containing relatively small number of reads.

The IP was performed with an AB against a H2 variant (not a post-translational modification), we have input DNA as control.

I first ran macs2 both with the --broad option, which seemed appropriate given that we are looking for histones and not TFs. When inspecting the XLS output I noticed strange values in the columns for pileup, -LOG10(pvalue)  etc. I have pasted the first 30 lines or so from the XLS file below.

When running macs2 callpeak without --broad a much smaller number of peaks is called (~2280 vs ~10700, probably mostly explained by the lower q-value cut-off of 0.01 vs 0.05 for broad peaks) but the values in pileup etc seem much more realistic.

I am not sure what to make of the callpeak --broad results at this moment... 

Thank you in advance for your suggestions!

```
# This file is generated by MACS version 2.1.0.20140616                             
# Command line: callpeak -t ../G1_H2A.Z.sorted.bam ../G1_H2A.Z-2.sorted.bam -c ../G1_Input.sorted.bam --name G1_H2AZ_broad --outdir G1_H2AZ_broad --broad -g mm --qvalue 0.05                               
# ARGUMENTS LIST:                               
# name = G1_H2AZ_broad                              
# format = AUTO                             
# ChIP-seq file = ['../G1_H2A.Z.sorted.bam', '../G1_H2A.Z-2.sorted.bam']                                
# control file = ['../G1_Input.sorted.bam']                             
# effective genome size = 1.87e+09                              
# band width = 300                              
# model fold = [5, 50]                              
# qvalue cutoff = 5.00e-02                              
# Larger dataset will be scaled towards smaller dataset.                                
# Range for calculating regional lambda is: 1000 bps and 10000 bps                              
# Broad region calling is on                                

# tag size is determined as 75 bps                              
# total tags in treatment: 66769037                             
# tags after filtering in treatment: 33493731                               
# maximum duplicate tags at the same position in treatment = 1                              
# Redundant rate in treatment: 0.50                             
# total tags in control: 16951267                               
# tags after filtering in control: 15359343                             
# maximum duplicate tags at the same position in control = 1                                
# Redundant rate in control: 0.09                               
# d = 126                               
# alternative fragment length(s) may be 126,282 bps                             
chr start   end length  pileup  #NAME?  fold_enrichment #NAME?  name
1   3672081 3672231 151 -4.60884E+31    -4.71848E+18    5.10251E+30 2.20193 G1_H2AZ_broad_peak_1
1   4756152 4756413 262 -2.21691E+31    -2.26965E+18    2.45437E+30 2.47998 G1_H2AZ_broad_peak_2
1   4785078 4786208 1131    -1.09006E+31    -1.11599E+18    1.20682E+30 3.79546 G1_H2AZ_broad_peak_3
1   4807398 4807626 229 -3.89191E+31    -3.98449E+18    4.30878E+30 1.52166 G1_H2AZ_broad_peak_4
1   4915904 4916436 533 -2.35609E+31    -2.41214E+18    2.60846E+30 1.95511 G1_H2AZ_broad_peak_5
1   5019973 5020548 576 -3.22336E+31    -3.30004E+18    3.56862E+30 1.46938 G1_H2AZ_broad_peak_6
1   5082560 5083003 444 -2.56296E+31    -2.62393E+18    2.83749E+30 4.22841 G1_H2AZ_broad_peak_7
1   5260697 5261362 666 -2.04439E+31    -2.09302E+18    2.26337E+30 3.21829 G1_H2AZ_broad_peak_8
```

```
# This file is generated by MACS version 2.1.0.20140616                                 
# Command line: callpeak -t ../G1_H2A.Z.sorted.bam ../G1_H2A.Z-2.sorted.bam -c ../G1_Input.sorted.bam --name G1_H2AZ_narrow --outdir G1_H2AZ_narrow -g mm --qvalue 0.01                                 
# ARGUMENTS LIST:                                   
# name = G1_H2AZ_narrow                                 
# format = AUTO                                 
# ChIP-seq file = ['../G1_H2A.Z.sorted.bam', '../G1_H2A.Z-2.sorted.bam']                                    
# control file = ['../G1_Input.sorted.bam']                                 
# effective genome size = 1.87e+09                                  
# band width = 300                                  
# model fold = [5, 50]                                  
# qvalue cutoff = 1.00e-02                                  
# Larger dataset will be scaled towards smaller dataset.                                    
# Range for calculating regional lambda is: 1000 bps and 10000 bps                                  
# Broad region calling is off                                   

# tag size is determined as 75 bps                                  
# total tags in treatment: 66769037                                 
# tags after filtering in treatment: 33493731                                   
# maximum duplicate tags at the same position in treatment = 1                                  
# Redundant rate in treatment: 0.50                                 
# total tags in control: 16951267                                   
# tags after filtering in control: 15359343                                 
# maximum duplicate tags at the same position in control = 1                                    
# Redundant rate in control: 0.09                                   
# d = 126                                   
# alternative fragment length(s) may be 126,282 bps                                 
chr start   end length  abs_summit  pileup  #NAME?  fold_enrichment #NAME?  name
1   4756180 4756401 222 4756202 10.09   7.84781 5.4492  3.90658 G1_H2AZ_narrow_peak_1
1   4785095 4785383 289 4785154 14.67   10.49901    6.53479 6.07783 G1_H2AZ_narrow_peak_2
1   5082869 5083001 133 5082927 16.05   14.48323    8.23278 9.41018 G1_H2AZ_narrow_peak_3
1   6351004 6351207 204 6351103 14.22   8.41215 5.07193 4.39934 G1_H2AZ_narrow_peak_4
1   7206546 7206681 136 7206598 16.97   10.25134    5.98908 5.84033 G1_H2AZ_narrow_peak_5
1   7206759 7207109 351 7207008 16.05   12.70838    7.14588 7.89689 G1_H2AZ_narrow_peak_6
1   7881634 7881786 153 7881705 14.67   12.31351    7.70274 7.55154 G1_H2AZ_narrow_peak_7
1   9848607 9848818 212 9848675 15.13   11.06422    6.42235 6.57351 G1_H2AZ_narrow_peak_8
```
",skurscheid,https://github.com/macs3-project/MACS/issues/67
MDU6SXNzdWU1NzgxMjk0Ng==,macs2 BAMPE parser and samtools rmdup,CLOSED,2015-02-16T14:52:11Z,2024-10-03T14:20:22Z,2024-10-03T14:20:21Z,"I'm calling peaks on paired-end data with macs2 callpeaks --format BAMPE, and using samtools rmdup to remove potential PCR duplicates beforehand.

Samtools rmdup only works on ""FR orientation"" alignments, obtained via [checking for isize > 0](https://github.com/samtools/samtools/blob/fcb8af08a6fd3bfcf195407c4ba5bae528ee326d/bam_rmdup.c#L152). The BAMPE parser in macs2 constructs the pileup by only [considering alignments that are ""first in sequencing""](https://github.com/taoliu/MACS/blob/87e287d88a557cfabb8c021c3c2f40d137f8dd9f/MACS2/IO/cParser.pyx#L1233-L1250).

Both criteria can be used to iterate over an alignment of paired-end tags such that one only considers every fragment in the sequenced library once. However, as the sign of isize and whether a tag is ""first in sequencing"" are independent of each other, using both discards half of the signal.

Assuming the above makes sense, would it be worth changing the BAMPE parser in macs2 to use the same criteria as samtools (=filter for isize > 0)? Technically this looks straightforward and I'm happy to contribute a patch, but I wanted to make sure that I haven't missed anything obvious...

Kind regards,
Jürgen
",jurgjn,https://github.com/macs3-project/MACS/issues/68
MDU6SXNzdWU1OTA0NTMyMA==,Error installing MACS2 with Cython installed ,CLOSED,2015-02-26T09:39:37Z,2015-04-24T15:47:18Z,2015-04-24T15:47:18Z,"Dear all,

I am having a problem with installing MACS2 (v 2.1.0, downloaded on 25-Feb-2015). 

When I run 

```
python setup.py install --prefix=/my/fav/folder
```

I get the following error. Cython, v 0.22 is installed. I know a similar issue was reposrted in issue #36, but no solution to the problem is provided there. Can anybody help? Thanks!

```
running install
/my/fav/folder/setuptools/lib/python2.7/site-packages/setuptools-12.2-py2.7.egg/pkg_resources/__init__.py:2512: PEP440Warning: 'distribute (0.6.24dev-r0)' is being parsed as a legacy, non PEP 440, version. You may find odd behavior and sort order. In particular it will be sorted as less than 0.0. It is recommend to migrate to PEP 440 compatible versions.
running bdist_egg
running egg_info
writing requirements to MACS2.egg-info/requires.txt
writing MACS2.egg-info/PKG-INFO
writing top-level names to MACS2.egg-info/top_level.txt
writing dependency_links to MACS2.egg-info/dependency_links.txt
writing requirements to MACS2.egg-info/requires.txt
writing MACS2.egg-info/PKG-INFO
writing top-level names to MACS2.egg-info/top_level.txt
writing dependency_links to MACS2.egg-info/dependency_links.txt
reading manifest file 'MACS2.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
warning: no files found matching 'MANIFEST'
writing manifest file 'MACS2.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
running build_ext
building 'MACS2.cProb' extension
gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/lib/pymodules/python2.7/numpy/core/include -I/usr/include/python2.7 -c MACS2/cProb.c -o build/temp.linux-x86_64-2.7/MACS2/cProb.o -w -Ofast
gcc: error: MACS2/cProb.c: No such file or directory
gcc: fatal error: no input files
compilation terminated.
error: command 'gcc' failed with exit status 4
```
",nicolazilio,https://github.com/macs3-project/MACS/issues/69
MDU6SXNzdWU2MDM1Mjc4OQ==,handling replicates,CLOSED,2015-03-09T14:41:17Z,2015-03-17T20:37:36Z,2015-03-17T20:37:36Z,"My colleague and I both separately installed macs2 2.1.0.20140616 (from `macs2 --version`) however our 2 installations seem to handle replicates for treatment/ChIP differently. According to `macs2 callpeak --help` one installation reads and combines files passed with `'-t A B C'` while the other treats the files as replicates using Liptak's method with weights.I have been trying to figure out why this is different if the versions are the same. In one case the version was installed from PyPI and in the other case from cloning the github repository.

Is it advisable to use the version on github or the official release? I would like to be able to use information from replicates and the release on PyPI is not doing that at the moment. Also can you direct me to any documentation about how replicates are weighted with Liptak's method?
",mxenoph,https://github.com/macs3-project/MACS/issues/70
MDU6SXNzdWU2NTYzODExNA==,Error with macs2 diffpeak,CLOSED,2015-04-01T09:02:06Z,2015-04-24T15:45:44Z,2015-04-24T15:45:44Z,"When I am trying to call it it can not find cDiffScore module. Below is what I get:

macs2 diffpeak --t1 noBPE_treat_pileup.bdg --t2 yesBPE_treat_pileup.bdg --c1 noBPE_control_lambda.bdg --c2 yesBPE_control_lambda.bdg -n no_vs_yes

Traceback (most recent call last):
  File ""/software/MACS/MACS-2.1/bin/macs2"", line 615, in <module>
    main()
  File ""/software/MACS/MACS-2.1/bin/macs2"", line 59, in main
    from MACS2.diffpeak import run
  File ""/software/MACS/MACS-2.1/lib64/python2.7/site-packages/MACS2/diffpeak.py"", line 31, in <module>
    from MACS2.IO.cDiffScore import DiffScoreTrackI
ImportError: No module named cDiffScore

Is there any way to fix this?

Thank you,
Moshe.
",MosheOlshansky,https://github.com/macs3-project/MACS/issues/72
MDU6SXNzdWU2NjA0NzMyMw==,ImportError with diffpeak,CLOSED,2015-04-03T01:30:39Z,2015-04-24T15:46:02Z,2015-04-24T15:46:02Z,"When I tried to run MACS2 from a local library (~/.local/lib/python2.7/site-packages) on Python 2.7.9, I get the following error:

```
$ macs2 diffpeak --t1 0956diff_1.ucsc.bedGraph --t2 0956lgr5_1.ucsc.bedGraph --c1 gen_1.ucsc.bedGraph --c2 gen_1.ucsc.bedGraph
Traceback (most recent call last):
  File ""/home/scnorton/.local/bin/macs2"", line 559, in <module>
    main()
  File ""/home/scnorton/.local/bin/macs2"", line 59, in main
    from MACS2.diffpeak import run
  File ""/home/scnorton/.local/lib/python2.7/site-packages/MACS2/diffpeak.py"", line 31, in <module>
    from MACS2.IO.cDiffScore import DiffScoreTrackI
ImportError: No module named cDiffScore
```

bdgdiff does not raise this error.
",PikalaxALT,https://github.com/macs3-project/MACS/issues/73
MDU6SXNzdWU2OTE2Mzc2Mw==,Negative p-values when using --broad peak flag,CLOSED,2015-04-17T15:43:23Z,2015-08-04T15:38:32Z,2015-08-04T15:38:32Z,"I am using MACS2 to call open chromatin regions in a MNase-seq dataset. However I'm generating negative p-values after calling broad peaks using the following commands:
macs2 callpeak -t treatment.s.bam -c input.bam -n tg \
--outdir ~/nucleosomedata/ -f BAMPE -g 1.87e9 --broad

Here is a few rows of output:

chr start   end length  pileup  -LOG10(pvalue)  fold_enrichment -LOG10(qvalue)  name
chr1    3003373 3003936 564 -1.23335E+31    -1.26269E+18    1.36546E+30 2.13806 tg_peak_1
chr1    3020520 3020966 447 -4.20326E+31    -4.30325E+18    4.65349E+30 1.28417 tg_peak_2
chr1    3029027 3030664 1638    -1.39736E+31    -1.4306E+18 1.54704E+30 1.49317 tg_peak_3
chr1    3045122 3045422 301 -5.30715E+31    -5.4334E+18 5.87561E+30 1.26046 tg_peak_4

Could this be due to defaulting to q-values when calling broad peaks?

Thanks
",lopatica,https://github.com/macs3-project/MACS/issues/74
MDU6SXNzdWU2OTcwMzEyNg==,Error updating MACS2 from PyPi with GCC 4.4.7 and Python 2.7.5,CLOSED,2015-04-20T23:24:24Z,2016-01-30T19:39:15Z,2015-06-18T15:22:39Z,"Command input: `pip install --upgrade --user MACS2`

Last few lines of output:

```
gcc -pthread -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/home/scnorton/.local/lib/python2.7/site-packages/numpy/core/include -I/opt/software/python/python-2.7.5/include/python2.7 -c MACS2/Prob.c -o build/temp.linux-x86_64-2.7/MACS2/Prob.o -w -Ofast

cc1: error: invalid option argument ‘-Ofast’

error: command 'gcc' failed with exit status 1

----------------------------------------
  Rolling back uninstall of MACS2
Cleaning up...
Command /opt/software/python/python-2.7.5/bin/python -c ""import setuptools;__file__='/tmp/pip_build_scnorton/MACS2/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))"" install --record /tmp/pip-3WIq2e-record/install-record.txt --single-version-externally-managed --user failed with error code 1 in /tmp/pip_build_scnorton/MACS2
Traceback (most recent call last):
  File ""/home/scnorton/.local/bin/pip"", line 11, in <module>
    sys.exit(main())
  File ""/opt/software/python/python-2.7.5/lib/python2.7/site-packages/pip-1.4.1-py2.7.egg/pip/__init__.py"", line 148, in main
    return command.main(args[1:], options)
  File ""/opt/software/python/python-2.7.5/lib/python2.7/site-packages/pip-1.4.1-py2.7.egg/pip/basecommand.py"", line 169, in main
    text = '\n'.join(complete_log)
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe2 in position 40: ordinal not in range(128)
```
",PikalaxALT,https://github.com/macs3-project/MACS/issues/75
MDU6SXNzdWU2OTk1NTY2OQ==,Broad peak calling and -p option,CLOSED,2015-04-21T21:23:16Z,2018-05-22T16:33:44Z,2015-04-24T21:14:09Z,"I ran MACS2 (2.1.0.20140616) to call peaks on chromatin accessibility data (ATAC-seq) with the following options:

-t reads.bam -f BAM -g mm --nomodel --shift -100 --extsize 200 -p 1e-4 --broad

I wanted to check sensitivity to the p-value cutoff specified by -p (which I believe controls narrow peak calling before merging to broad peaks?). Running with, e.g., -p 1e-3 or -p 1e-10 gave identical output to the first run. The output is different than using -q 0.01, however. Is this the intended behavior?
",jgarthur,https://github.com/macs3-project/MACS/issues/76
MDU6SXNzdWU3MDAxNzQ2Ng==,qvalues in MACS2,CLOSED,2015-04-22T04:15:18Z,2024-10-03T14:01:52Z,2024-10-03T14:01:52Z,"Two points:
1) Why is pvalue-qvalue table precomputed it I am running macs2 callpeak -p ... ?
2) Even if one asks for q-values, why pre-compute the table which takes quite long time? Isn't it easier to first compute p-values and then convert them into q-values, which should not take more than a few seconds (see p.adjust function in R)?
",MosheOlshansky,https://github.com/macs3-project/MACS/issues/77
MDU6SXNzdWU3NjA3MTcyMA==,IndexError out of bounds,CLOSED,2015-05-13T18:05:35Z,2022-06-10T12:56:32Z,2015-06-09T16:06:29Z,"Hello,

I have a problem while trying to run macs2 callpeak (see error message below). Here's my command line :

macs2 callpeak -t SRR574758.sorted.bam SRR574759.sorted.bam -f BAM -g mm --trackline -B --SPMR --call-summits -n peakcalling --outdir MACS

I've tried to uninstall MACS2 and re-install from source code (macs2 2.1.0.20150420) and update NumPy but I always get the same error saying the index 650321 is out of bounds for axis 0 with size 650321...

Could you help me to resolve this issue please ?
Thanks a lot !
MSF

Here's the error message I get :

Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 5, in <module>
    pkg_resources.run_script('MACS2==2.1.0.20150420', 'macs2')
  File ""/usr/lib/python2.7/dist-packages/pkg_resources.py"", line 528, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/usr/lib/python2.7/dist-packages/pkg_resources.py"", line 1401, in run_script
    exec(script_code, namespace, namespace)
  File ""/usr/local/lib/python2.7/dist-packages/MACS2-2.1.0.20150420-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 614, in <module>

  File ""/usr/local/lib/python2.7/dist-packages/MACS2-2.1.0.20150420-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 56, in main

  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 70, in run
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 400, in load_tag_files_options
  File ""MACS2/IO/Parser.pyx"", line 888, in MACS2.IO.Parser.BAMParser.append_fwtrack (MACS2/IO/Parser.c:12930)
  File ""MACS2/IO/Parser.pyx"", line 892, in MACS2.IO.Parser.BAMParser.append_fwtrack (MACS2/IO/Parser.c:12878)
  File ""MACS2/IO/Parser.pyx"", line 961, in MACS2.IO.Parser.BAMParser.__append_fwtrack_wo_pysam (MACS2/IO/Parser.c:14106)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 130, in MACS2.IO.FixWidthTrack.FWTrack.add_loc (MACS2/IO/FixWidthTrack.c:3181)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 149, in MACS2.IO.FixWidthTrack.FWTrack.add_loc (MACS2/IO/FixWidthTrack.c:3040)
IndexError: index 650321 is out of bounds for axis 0 with size 650321
",masaf2,https://github.com/macs3-project/MACS/issues/78
MDU6SXNzdWU3ODE1ODkyOA==,bdgopt multiply function error. Usage?,CLOSED,2015-05-19T16:29:40Z,2015-07-28T18:13:27Z,2015-07-28T18:13:26Z,"Hello,

I was using MACS2 and ran across an issue with the command 'bdgopt'. I was trying to run this job in UNIX: 

macs2 bdgopt -i ShootMinus_treat_pileup.bdg -m multiply -p 0.59529055 -o ShtMinus.bdg 

to normalize read depth by multiplying my control ShtMinus by the ratio of the reads ShtPlus/ShtMinus. Instead it returned an error: 

AttributeError: 'Namespace' object has no attribute 'extparam'

Does anyone know if this is an usage error or if there is a workaround?
",damcpher,https://github.com/macs3-project/MACS/issues/79
MDU6SXNzdWU3ODYzNDg0OA==,Error after installing with PIP,CLOSED,2015-05-20T18:20:33Z,2015-07-30T20:08:02Z,2015-07-30T20:08:02Z,"I installed MACs with PIP after installation from source failed (for a failure to find installed NUMPY) -- now when I try to run macs2, I get the following error:

Traceback (most recent call last):
  File ""/usr/bin/macs2"", line 559, in <module>
    main()
  File ""/usr/bin/macs2"", line 55, in main
    from MACS2.callpeak import run
  File ""/usr/lib/python2.7/site-packages/MACS2/callpeak.py"", line 30, in <module>
    from MACS2.OptValidator import opt_validate
  File ""/usr/lib/python2.7/site-packages/MACS2/OptValidator.py"", line 27, in <module>
    from MACS2.IO.cParser import BEDParser, ELANDResultParser, ELANDMultiParser, \
  File ""**init**.pxd"", line 155, in init MACS2.IO.cParser (MACS2/IO/cParser.c:22531)
  File ""/usr/lib/python2.7/site-packages/numpy/**init**.py"", line 170, in <module>
    from . import add_newdocs
  File ""/usr/lib/python2.7/site-packages/numpy/add_newdocs.py"", line 13, in <module>
    from numpy.lib import add_newdoc
  File ""/usr/lib/python2.7/site-packages/numpy/lib/**init**.py"", line 8, in <module>
    from .type_check import *
  File ""/usr/lib/python2.7/site-packages/numpy/lib/type_check.py"", line 11, in <module>
    import numpy.core.numeric as _nx
  File ""/usr/lib/python2.7/site-packages/numpy/core/__init__.py"", line 46, in <module>
    from numpy.testing import Tester
  File ""/usr/lib/python2.7/site-packages/numpy/testing/**init**.py"", line 13, in <module>
    from .utils import *
  File ""/usr/lib/python2.7/site-packages/numpy/testing/utils.py"", line 15, in <module>
    from tempfile import mkdtemp
  File ""/illumina/seqprg/anaconda/lib/python2.7/tempfile.py"", line 35, in <module>
    from random import Random as _Random
  File ""/illumina/seqprg/anaconda/lib/python2.7/random.py"", line 49, in <module>
    import hashlib as _hashlib
  File ""/illumina/seqprg/anaconda/lib/python2.7/hashlib.py"", line 138, in <module>
    _hashlib.openssl_md_meth_names)
AttributeError: 'module' object has no attribute 'openssl_md_meth_names'
",bcantarel,https://github.com/macs3-project/MACS/issues/80
MDU6SXNzdWU3OTAwOTg3MQ==,Comparing BAM vs BAMPE mode,CLOSED,2015-05-21T14:08:24Z,2024-10-03T14:21:58Z,2024-10-03T14:21:58Z,"Hi

I was comparing macs results for my protein in BAM vs BAMPE mode (my data is paired-end) and found the differences in results which I couldn't explain.
BAMPE mode gives much more peaks than BAM mode (about 1/3rd more than BAM mode), and also a lot of peaks in the smaller set (BAM mode) don't overlap with those in larger set. I looked at the unique peaks from either set in IGV and couldn't spot any difference. Both these peaks seem to have a moderate (not much enrichment) compared to input. Common detected peaks seem to have more enrichment than peaks detected uniquely by each. 

Can you explain this discrepancy and suggest which one is a better set to work with? This seems to be due to the difference in local lambda calculated using fragment size, but since in both cases it's automatically calculated, which one is more reliable?

Thanks a lot
Vivek
",vivekbhr,https://github.com/macs3-project/MACS/issues/81
MDU6SXNzdWU4Mzk2NTAzNA==,MACS1.4: division by zero,CLOSED,2015-06-02T10:45:02Z,2024-10-03T14:42:06Z,2024-10-03T14:42:06Z,"As [reported here](https://groups.google.com/forum/#!topic/macs-announcement/N3RAFfrwKc8) MACS1.4 will fail with a division by zero given certain unaligned inputs.

The thread also contains a patch that continuously extends the limit by 1000.
",rekado,https://github.com/macs3-project/MACS/issues/82
MDU6SXNzdWU5MjQzNzkyNQ==,integer score for display,CLOSED,2015-07-01T17:13:41Z,2015-07-30T20:04:29Z,2015-07-30T20:04:29Z,"I am looking at the .narrowPeak files generated by MACS. The 5th column is ""integer score for display"", which seems to correlate with -log10pvalue and -log10qvalue. Higher score is more significant, but what exactly does that score mean?
",igordot,https://github.com/macs3-project/MACS/issues/84
MDU6SXNzdWU5Mjg4Mzk3NA==,Getting traceback with bdgcmp ,CLOSED,2015-07-03T14:14:25Z,2018-12-11T08:04:44Z,2016-03-09T20:05:41Z,"Dear developers,

I'm trying to create a continuous coverage signal by comparing ChIP bedGraph to control bedGraph using bdgcmp option. For that purpose I'm using macs2 generated _control_lambde.bdg and _treat_pileup.bdg . 
The command and traceback shown here:

macs2 bdgcmp -t s_treat_pileup.bdg -c s_control_lambda.bdg --outdir fold_enrichment_above_input_bdg -o s.bdg -m FE
INFO  @ Fri, 03 Jul 2015 15:03:39: Read and build treatment bedGraph... 
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 614, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 72, in main
    run( args )
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/bdgcmp_cmd.py"", line 40, in run
    tbtrack = tbio.build_bdgtrack()
  File ""MACS2/IO/BedGraphIO.pyx"", line 108, in MACS2.IO.BedGraphIO.bedGraphIO.build_bdgtrack (MACS2/IO/BedGraphIO.c:1257)
IndexError: list index out of range

Any help?
",msxakk,https://github.com/macs3-project/MACS/issues/85
MDU6SXNzdWU5MjkwMTA3MQ==,stuck at pre-compute,CLOSED,2015-07-03T15:58:07Z,2017-09-04T17:07:18Z,2015-07-30T19:59:35Z,"Hi, 

I use macs2 2.1.0.20150420 version on ubuntu14.04. I have MACS2 installed on virtualenv. It takes forever (i am not sure it will end) at #3 pre-compute pvalue-qvalue table (if i remove --nolambda flag then it runs just fine). 

can you help? Thanks, 
Duy

This is what I did: 
# Command line: callpeak -t trial.bam -g mm --nomodel --nolambda --outdir /home/duypham/Desktop/trial/
# ARGUMENTS LIST:
# name = NA
# format = AUTO
# ChIP-seq file = ['trial.bam']
# control file = None
# effective genome size = 1.87e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off

INFO  @ Fri, 03 Jul 2015 10:55:36: #1 read tag files... 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1 read treatment tags... 
INFO  @ Fri, 03 Jul 2015 10:55:36: Detected format is: BAM 
INFO  @ Fri, 03 Jul 2015 10:55:36: \* Input file is gzipped. 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1 tag size is determined as 51 bps 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1 tag size = 51 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1  total tags in treatment: 1260 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1 user defined the maximum tags... 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1  tags after filtering in treatment: 1224 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1  Redundant rate of treatment: 0.03 
INFO  @ Fri, 03 Jul 2015 10:55:36: #1 finished! 
INFO  @ Fri, 03 Jul 2015 10:55:36: #2 Build Peak Model... 
INFO  @ Fri, 03 Jul 2015 10:55:36: #2 Skipped... 
INFO  @ Fri, 03 Jul 2015 10:55:36: #2 Use 200 as fragment length 
INFO  @ Fri, 03 Jul 2015 10:55:36: #3 Call peaks... 
INFO  @ Fri, 03 Jul 2015 10:55:36: # local lambda is disabled! 
INFO  @ Fri, 03 Jul 2015 10:55:36: #3 !!!! DYNAMIC LAMBDA IS DISABLED !!!! 
INFO  @ Fri, 03 Jul 2015 10:55:36: #3 Pre-compute pvalue-qvalue table...
",duyphamuab,https://github.com/macs3-project/MACS/issues/86
MDU6SXNzdWU5NDE3MjA0Ng==,macs2 filterdup fails,CLOSED,2015-07-09T23:05:04Z,2015-08-14T19:28:23Z,2015-07-27T17:54:27Z,"I tried changing the references of 'cProb' to 'Prob' in both diffpeak_cmd.py and filterdup_cmd.py.  Is this advisable?  I was getting the following error:

Traceback (most recent call last):
  File ""/data/local/bin/macs2"", line 4, in <module>
    **import**('pkg_resources').run_script('MACS2==2.1.0.20150603', 'macs2')
  File ""build/bdist.linux-x86_64/egg/pkg_resources/**init**.py"", line 735, in run_script
  File ""build/bdist.linux-x86_64/egg/pkg_resources/**init**.py"", line 1652, in run_script
  File ""/data/local/lib/python2.7/site-packages/MACS2-2.1.0.20150603-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 614, in <module>
    main()
  File ""/data/local/lib/python2.7/site-packages/MACS2-2.1.0.20150603-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 87, in main
    from MACS2.filterdup_cmd import run
  File ""/data/local/lib/python2.7/site-packages/MACS2-2.1.0.20150603-py2.7-linux-x86_64.egg/MACS2/filterdup_cmd.py"", line 29, in <module>
    from MACS2.cProb import binomial_cdf_inv
ImportError: No module named cProb
",tjsavitsky,https://github.com/macs3-project/MACS/issues/87
MDU6SXNzdWU5NTg5NTQzMA==,'MACS2.IO.Parser.BAMPEParser' object has no attribute 'finalize',CLOSED,2015-07-19T07:47:47Z,2015-07-27T16:39:01Z,2015-07-27T16:39:01Z,"Dear Tao,

Thanks for the great software. 

However, when running test command for PE-reads (current github version), this error appears. Could you help to solve it?

Thanks!

Chen Tong

```
macs2 callpeak -f BAMPE -t $CHIPPE -c $CTRLPE -n run_callpeak_pe_narrow -B --outdir run_callpeak_pe_narrow --call-summits &> run_callpeak_pe_narrow/run_callpeak_pe_narrow.log

cat run_callpeak_pe_narrow/run_callpeak_pe_narrow.log
INFO  @ Sun, 19 Jul 2015 10:56:00: 
# Command line: callpeak -f BAMPE -t CTCF_PE_ChIP_chr22.bam -c CTCF_PE_CTRL_chr22.bam -n run_callpeak_pe_narrow -B --outdir run_callpeak_pe_narrow --call-summits
# ARGUMENTS LIST:
# name = run_callpeak_pe_narrow
# format = BAMPE
# ChIP-seq file = ['CTCF_PE_ChIP_chr22.bam']
# control file = ['CTCF_PE_CTRL_chr22.bam']
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Searching for subpeak summits is on

INFO  @ Sun, 19 Jul 2015 10:56:00: #1 read fragment files... 
INFO  @ Sun, 19 Jul 2015 10:56:00: #1 read treatment fragments... 
Traceback (most recent call last):
  File ""/home/chentong/anaconda/bin/macs2"", line 5, in <module>
    pkg_resources.run_script('MACS2==2.1.0.20150603', 'macs2')
  File ""/home/chentong/anaconda/lib/python2.7/site-packages/setuptools-3.6-py2.7.egg/pkg_resources.py"", line 534, in run_script
  File ""/home/chentong/anaconda/lib/python2.7/site-packages/setuptools-3.6-py2.7.egg/pkg_resources.py"", line 1434, in run_script
  File ""/home/chentong/anaconda/lib/python2.7/site-packages/MACS2-2.1.0.20150603-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 614, in <module>
    main()
  File ""/home/chentong/anaconda/lib/python2.7/site-packages/MACS2-2.1.0.20150603-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 56, in main
    run( args )
  File ""/home/chentong/anaconda/lib/python2.7/site-packages/MACS2-2.1.0.20150603-py2.7-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 69, in run
    if options.PE_MODE: (treat, control) = load_frag_files_options (options)
  File ""/home/chentong/anaconda/lib/python2.7/site-packages/MACS2-2.1.0.20150603-py2.7-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 363, in load_frag_files_options
    tp.finalize()
AttributeError: 'MACS2.IO.Parser.BAMPEParser' object has no attribute 'finalize'
```
",ebookehbio,https://github.com/macs3-project/MACS/issues/88
MDU6SXNzdWU5Nzc5NTMzMw==,Default for -m in callpeak,CLOSED,2015-07-28T20:30:55Z,2015-07-28T20:34:14Z,2015-07-28T20:34:14Z,"The default is listed as 10,30 while it is actually 5,50
",nkoneillnk,https://github.com/macs3-project/MACS/issues/89
MDU6SXNzdWU5ODI0NzU4MQ==,control lambda bedGraph,CLOSED,2015-07-30T19:47:25Z,2020-11-03T04:36:11Z,2015-07-30T20:06:02Z,"The best description of lambda I could find (https://groups.google.com/forum/#!msg/macs-announcement/JkufzGpUNRk/kUx0z2M2b_cJ):

> For each peak region, MACS calculates the a local lambda for poisson
> distribution based on the control tags within the 1kb, 5kb and
> 10kb(1/5/10k are parameters that you can modify) nearby regions to
> consider the local fluctuations and biases. The local lambda is the
> maximum of the averages of tags for 1/5/10 kb regions and a whole
> genome background. Then this local lambda is used to calculate the p-
> value of poisson distribution.

With the --bdg parameter, I can output control_lambda.bdg files. If lambda is calculated locally, how is that translated into bedGraph peaks or are those showing something else entirely? Also, if lambda is calculated around peak regions, shouldn't most of the genome not have any values then?
",igordot,https://github.com/macs3-project/MACS/issues/90
MDU6SXNzdWU5ODk0Mzc0OQ==,Error when installing latest macs2,CLOSED,2015-08-04T11:05:04Z,2024-10-03T14:12:25Z,2024-10-03T14:12:25Z,"Hi Tao,

I currently have macs2 20140616 installed, and I noticed that there is a new version 20150731.

So I downloaded the source code from pypi, and tried to install it. However, I got the following error:

**$ python setup.py install**
running install
running bdist_egg
running egg_info
writing requirements to MACS2.egg-info/requires.txt
writing MACS2.egg-info/PKG-INFO
writing top-level names to MACS2.egg-info/top_level.txt
writing dependency_links to MACS2.egg-info/dependency_links.txt
writing requirements to MACS2.egg-info/requires.txt
writing MACS2.egg-info/PKG-INFO
writing top-level names to MACS2.egg-info/top_level.txt
writing dependency_links to MACS2.egg-info/dependency_links.txt
reading manifest file 'MACS2.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
warning: no files found matching 'MANIFEST'
no previously-included directories found matching 'test'
writing manifest file 'MACS2.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
running build_ext
building 'MACS2.Prob' extension
gcc -pthread -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/homes/xichen/anaconda/lib/python2.7/site-packages/numpy/core/include -I/homes/xichen/anaconda/include/python2.7 -c MACS2/Prob.c -o build/temp.linux-x86_64-2.7/MACS2/Prob.o -w -Ofast
cc1: error: invalid option argument ‘-Ofast’
error: command 'gcc' failed with exit status 1

when I tried to install using pip, similar thing happens:

**$ pip install -U MACS2**
Collecting MACS2
  Downloading MACS2-2.1.0.20150731.tar.gz (1.6MB)
    100% |████████████████████████████████| 1.6MB 190kB/s 
Requirement already up-to-date: numpy>=1.6 in ./anaconda/lib/python2.7/site-packages (from MACS2)
Installing collected packages: MACS2
  Found existing installation: MACS2 2.0.10.20131216
    DEPRECATION: Uninstalling a distutils installed project (MACS2) has been deprecated and will be removed in a future version. This is due to the fact that uninstalling a distutils project will only partially uninstall the project.
    Uninstalling MACS2-2.0.10.20131216:
      Successfully uninstalled MACS2-2.0.10.20131216
  Running setup.py install for MACS2
    Complete output from command /homes/xichen/anaconda/bin/python -c ""import setuptools, tokenize;**file**='/tmp/pip-build-6Z52HD/MACS2/setup.py';exec(compile(getattr(tokenize, 'open', open)(**file**).read().replace('\r\n', '\n'), **file**, 'exec'))"" install --record /tmp/pip-ait1FG-record/install-record.txt --single-version-externally-managed --compile:
    running install
    running build
    running build_py
    creating build
    creating build/lib.linux-x86_64-2.7
    creating build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/**init**.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/diffpeak_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/bdgdiff_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/cmbreps_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/refinepeak_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/OptValidator.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/predictd_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/filterdup_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/bdgopt_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/bdgbroadcall_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/OutputWriter.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/Constants.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/bdgpeakcall_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/bdgcmp_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/pileup_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/randsample_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    copying MACS2/callpeak_cmd.py -> build/lib.linux-x86_64-2.7/MACS2
    creating build/lib.linux-x86_64-2.7/MACS2/IO
    copying MACS2/IO/**init**.py -> build/lib.linux-x86_64-2.7/MACS2/IO
    copying MACS2/IO/test_threading.py -> build/lib.linux-x86_64-2.7/MACS2/IO
    copying MACS2/IO/test_processing.py -> build/lib.linux-x86_64-2.7/MACS2/IO
    copying MACS2/IO/BinKeeper.py -> build/lib.linux-x86_64-2.7/MACS2/IO
    running build_ext
    building 'MACS2.Prob' extension
    creating build/temp.linux-x86_64-2.7
    creating build/temp.linux-x86_64-2.7/MACS2
    gcc -pthread -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/homes/xichen/anaconda/lib/python2.7/site-packages/numpy/core/include -I/homes/xichen/anaconda/include/python2.7 -c MACS2/Prob.c -o build/temp.linux-x86_64-2.7/MACS2/Prob.o -w -Ofast
    cc1: error: invalid option argument ‘-Ofast’
    error: command 'gcc' failed with exit status 1

```
----------------------------------------
```

  Rolling back uninstall of MACS2

Any idea how to solve this problem? I vaguely remember there was somebody has similar issue with -Ofast, but I could not locate the solution.

Thanks.

Xi
",dbrg77,https://github.com/macs3-project/MACS/issues/91
MDU6SXNzdWU5OTEzMjU0Ng==,BAMPE,CLOSED,2015-08-05T06:15:23Z,2024-10-03T14:44:08Z,2024-10-03T14:44:07Z,"HI tao
 I am a freshman in CHIP-seq.I have some problems about macs2.In macs2 readme file,I found that ""BAMPE"" is a different parameter in macs14 and macs2.Is macs2 strictly distinguished from the data format? I had ran macs14 yet,now i want to try macs2.For PE data,i must set the ""BAMPE"" parameter? If I do not set the parameters of ""-f"" to ""BAMPE"", the analysis results will be very different? Will not be accurate?In addition, I have noticed that there is a regular peak calling analysis and a broad peak calling analysis of macs2.Is the analysis of the broad peak is a development of macs2?Is it necessary for me to analyse the regular peak and broad peak at sametime?

Best
salviadr
",salviadr,https://github.com/macs3-project/MACS/issues/92
MDU6SXNzdWU5OTYyNDgwNg==,Problem with multiple input files,CLOSED,2015-08-07T10:40:28Z,2015-08-11T19:03:07Z,2015-08-11T19:03:07Z,"Hello,

Previous versions of macs allowed multiple input files as documented in the -t and -c options. 
In version macs2 2.1.0.20150420 I get the following error:

```
macs2 callpeak -t pd.tmp.bam -n tmp   ## OK
macs2 callpeak -t pd1.tmp.bam -n tmp  ## OK

macs2 callpeak -t pd.tmp.bam pd1.tmp.bam -n tmp

INFO  @ Fri, 07 Aug 2015 11:32:40: 
# Command line: callpeak -t pd.tmp.bam pd1.tmp.bam -n tmp
# ARGUMENTS LIST:
# name = tmp
# format = AUTO
# ChIP-seq file = ['pd.tmp.bam', 'pd1.tmp.bam']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off

INFO  @ Fri, 07 Aug 2015 11:32:40: #1 read tag files... 
INFO  @ Fri, 07 Aug 2015 11:32:40: #1 read treatment tags... 
INFO  @ Fri, 07 Aug 2015 11:32:40: Detected format is: BAM 
INFO  @ Fri, 07 Aug 2015 11:32:40: * Input file is gzipped. 
INFO  @ Fri, 07 Aug 2015 11:32:40: Detected format is: BAM 
INFO  @ Fri, 07 Aug 2015 11:32:40: * Input file is gzipped. 
Traceback (most recent call last):
  File ""/home/berald01/.local/bin/macs2"", line 5, in <module>
    pkg_resources.run_script('MACS2==2.1.0.20150420', 'macs2')
  File ""build/bdist.linux-x86_64/egg/pkg_resources.py"", line 488, in run_script
  File ""build/bdist.linux-x86_64/egg/pkg_resources.py"", line 1345, in run_script
  File ""/home/berald01/.local/lib/python2.7/site-packages/MACS2-2.1.0.20150420-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 614, in <module>

  File ""/home/berald01/.local/lib/python2.7/site-packages/MACS2-2.1.0.20150420-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 56, in main

  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 70, in run
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 400, in load_tag_files_options
  File ""MACS2/IO/Parser.pyx"", line 888, in MACS2.IO.Parser.BAMParser.append_fwtrack (MACS2/IO/Parser.c:12930)
  File ""MACS2/IO/Parser.pyx"", line 892, in MACS2.IO.Parser.BAMParser.append_fwtrack (MACS2/IO/Parser.c:12878)
  File ""MACS2/IO/Parser.pyx"", line 961, in MACS2.IO.Parser.BAMParser.__append_fwtrack_wo_pysam (MACS2/IO/Parser.c:14106)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 130, in MACS2.IO.FixWidthTrack.FWTrack.add_loc (MACS2/IO/FixWidthTrack.c:3181)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 149, in MACS2.IO.FixWidthTrack.FWTrack.add_loc (MACS2/IO/FixWidthTrack.c:3040)
IndexError: index 1311 is out of bounds for axis 0 with size 1311
```

PS: I tried to download the current version in the repository but compilation fails since gcc can't find file `MACS2/Prob.c`

```
python setup.py install --user
running install
running bdist_egg
running egg_info
writing requirements to MACS2.egg-info/requires.txt
writing MACS2.egg-info/PKG-INFO
writing top-level names to MACS2.egg-info/top_level.txt
writing dependency_links to MACS2.egg-info/dependency_links.txt
reading manifest file 'MACS2.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
warning: no files found matching 'MANIFEST'
writing manifest file 'MACS2.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
running build_ext
building 'MACS2.Prob' extension
gcc -pthread -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/home/berald01/.local/lib/python2.7/site-packages/numpy/core/include -I/home/berald01/.local/include/python2.7 -c MACS2/Prob.c -o build/temp.linux-x86_64-2.7/MACS2/Prob.o -w -O3
gcc: MACS2/Prob.c: No such file or directory
gcc: no input files
error: command 'gcc' failed with exit status 1
```

Thanks!
Dario
",dariober,https://github.com/macs3-project/MACS/issues/93
MDU6SXNzdWUxMDI1MzcwNDM=,Error while compiling MACS 2.1.0,CLOSED,2015-08-22T13:25:39Z,2024-10-03T14:43:14Z,2024-10-03T14:43:14Z,"Hello,

I am trying to compile MACS2 (MACS2-2.1.0.20150731) on an Ubuntu server. My system has Python 2.7, gcc version 4.4.7 and Cython 0.18. I changed the -Ofast to -O3 in the setup.py file.

However, when running the setup (python setup.py install --prefix /home/sramdas/bin), I get the following error:
$python2.7 setup.py install
  File ""build/bdist.linux-x86_64/egg/pkg_resources.py"", line 2009, in yield_lines
    return ""EntryPoint.parse(%r)"" % str(self)
  File ""build/bdist.linux-x86_64/egg/pkg_resources.py"", line 2337, in _get_metadata

  File ""build/bdist.linux-x86_64/egg/pkg_resources.py"", line 1325, in get_metadata_lines
    def _get(self, path):
  File ""build/bdist.linux-x86_64/egg/pkg_resources.py"", line 1317, in get_metadata
    return os.path.isdir(path)
  File ""build/bdist.linux-x86_64/egg/pkg_resources.py"", line 1381, in _get

zipimport.ZipImportError: bad local file header in /home/junzli_lab/sramdas/.local/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg

I can't seem to figure out the solution to this. Any help would be appreciated!
",shramdas,https://github.com/macs3-project/MACS/issues/94
MDU6SXNzdWUxMDMxMDAzNjA=,macs2 command not found,CLOSED,2015-08-25T19:40:11Z,2015-08-26T01:02:09Z,2015-08-26T01:02:09Z,"I have Python 2.7.10 on a Mac. 

I believe there is something wrong with the way I am calling macs2. I always get this error:

otp588416ots:~ Priya$ macs2 callpeak -t ChIP.bam -c Control.bam -f BAM -g hs -n test -B -q 0.01
-bash: macs2: command not found

After installing macs2, my computer says the file is located in several folders (maybe from multiple installation attempts):

otp588416ots:~ Priya$ sudo find / -name macs2
Password:
find: /dev/fd/3: Not a directory
find: /dev/fd/4: Not a directory
/Library/Python/2.7/site-packages/MACS2-2.1.0.20150731/bin/macs2
/Library/Python/2.7/site-packages/MACS2-2.1.0.20150731/build/scripts-2.7/macs2
/opt/local/Library/Frameworks/Python.framework/Versions/2.7/bin/macs2
/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/MACS2-2.1.0.20150731/bin/macs2
/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/MACS2-2.1.0.20150731/build/scripts-2.7/macs2

Setting the PYTHONPATH to any of these directories does not change the error I receive when calling macs2. Are the multiple locations confusing my computer? Any help in resolving this problem would be greatly appreciated! Thank you!
",priyasshah,https://github.com/macs3-project/MACS/issues/95
MDU6SXNzdWUxMDQ2MDk1MjY=,hypermethylation vs. hypomethylation assessment ,CLOSED,2015-09-03T02:39:49Z,2024-10-03T14:15:13Z,2024-10-03T14:15:13Z,"I hope this is the right venue for this question, if not please let me know where I can direct it. I have paired samples (tumour & control) that have been sequenced for methylation. I'd like to assess hypermethylation and hypomethylation in the tumour versus the control, would the following commands be valid? I've switched control and treated to look at hypomethylation. 

hypermethylation: callpeak -f BAM -t treated.bam -c control.bam
hypomethylation: callpeak -f BAM -t control.bam -c treated.bam 
",burtontimothy,https://github.com/macs3-project/MACS/issues/96
MDU6SXNzdWUxMDY4OTYwOTA=,macs2: error: no such option: --call-summits,CLOSED,2015-09-17T01:41:09Z,2016-03-09T20:08:32Z,2016-03-09T20:08:32Z,"I ran 
macs2 callpeak -f BAM -t 84330.unique.bam -n 84330.unique -g mm -B -q 0.01 --call-summits 
But it said macs2: error: no such option: --call-summits

What's the reason?
",brianpenghe,https://github.com/macs3-project/MACS/issues/98
MDU6SXNzdWUxMTI3MjUyOTU=,question about RNApolymerase II chipseq data,CLOSED,2015-10-22T03:39:59Z,2024-10-03T14:44:46Z,2024-10-03T14:44:46Z,"Hi,

i'm dealing with RNApolyII chipseq data using MACS2.

RNApolyII chipseq data contains two kinds of peaks:narrow peaks at TSS region and broad peaks across genebody.

so,how to set options of MACS2?

DO i have to run MACS2 twice? first,run macs2 callpeak without --broad in order to find narrow peaks at TSS. Then run macs2 with --broad to find broad peaks? 

If I do that, should I run MACS2 bdgdiff separately if I want to find difference  between two different samples?
Best
chenzizhen
",chenzizhen,https://github.com/macs3-project/MACS/issues/99
MDU6SXNzdWUxMTQ5MjE2NjI=,How does MACS2 deal with Picard MarkDuplicates?,CLOSED,2015-11-03T22:08:16Z,2024-10-03T14:45:19Z,2024-10-03T14:45:19Z,"I was trying to run MACS2 callpeak with bam files and the number of tags returned was far less than what I expected to see. And I noticed that this seems because my input bam file has Picard MarkDuplicates. Should I remove the Picard MarkDuplicates flag first and then run MACS2? Or is there any recommended way (i.e. a specific option) to run MACS2 to deal with the bam file with this flag? Could you please take a look at the numbers returned by MACS2 and the samtool stats below?

---

INFO  @ Mon, 10 Oct 2015 12:01:37: #1 tag size is determined as 50 bps
INFO  @ Mon, 10 Oct 2015 12:01:37: #1 tag size = 50
INFO  @ Mon, 10 Oct 2015 12:01:37: #1  total tags in treatment: 5507943
INFO  @ Mon, 10 Oct 2015 12:01:37: #1 user defined the maximum tags...
INFO  @ Mon, 10 Oct 2015 12:01:37: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s)
INFO  @ Mon, 10 Oct 2015 12:01:38: #1  tags after filtering in treatment: 450697

---

25347362 + 0 in total (QC-passed reads + QC-failed reads)
11621361 + 0 duplicates
24716740 + 0 mapped (97.51%:nan%)
25347362 + 0 paired in sequencing
12673681 + 0 read1
12673681 + 0 read2
24500988 + 0 properly paired (96.66%:nan%)
24616531 + 0 with itself and mate mapped
100209 + 0 singletons (0.40%:nan%)
29069 + 0 with mate mapped to a different chr
22209 + 0 with mate mapped to a different chr (mapQ>=5)
",Yaelim,https://github.com/macs3-project/MACS/issues/100
MDU6SXNzdWUxMTU1MjQ0Njk=,MACS2 stalls pre-computing pvalue-qvalue table..,CLOSED,2015-11-06T15:20:20Z,2024-10-03T14:10:46Z,2024-10-03T14:10:46Z,"Hello,

MACS2 stalls at the following line:

```
#3 Pre-compute pvalue-qvalue table...
```

I have two BAM files, one converted to BAM from Bowtie2 output and the other which has underwent some processing. Here is an example alignment from the raw BAM file:

```
HISEQ:127:C7HJ7ANXX:1:1312:20025:49343  163 chr1    10069   30  50M =   10075   56  ACCCTAACCCTAACCCTAACCCTAACCCTAACCCTAACCCAACCCTAACC  CCCCCGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG  MD:Z:50 PG:Z:MarkDuplicates XG:i:0  NM:i:0  XM:i:0  XN:i:0  XO:i:0  AS:i:0  XS:i:0  YS:i:0  YT:Z:CP
```

and here is an example from the processed BAM file:

```
HISEQ:127:C7HJ7ANXX:1:1312:20025:49343/1    16  chr1    10070   255 50M *   0   0   *   *
```

MACS2 stalls when I input the processed BAM file but not the raw file. The processed BAM file was created by converting the raw BAM to a BED file, processing the data with AWK, and then converting back to a BAM file (both conversions done using BEDtools).

I call peaks using the following command:

```
macs2 callpeak -t sample.bam -f BAMPE -g hs -s 50 -n sample -q 0.01 --nomodel --nolambda --keep-dup all --call-summits
```

Thank you
",jma1991,https://github.com/macs3-project/MACS/issues/101
MDU6SXNzdWUxMTYzNjI0MjY=,Overflow Error,CLOSED,2015-11-11T15:51:04Z,2015-11-12T12:05:42Z,2015-11-12T12:05:42Z,"Error with macs2 version macs2 2.1.0.20150731, on OSX El Capitan:

```
INFO  @ Wed, 11 Nov 2015 15:29:57:
# Command line: callpeak -t sox32.bed -g 1.3e-9 -p 0.001 --bw=300 -B -f BED -n test_sox32
# ARGUMENTS LIST:
# name = test_sox32
# format = BED
# ChIP-seq file = ['sox32.bed']
# control file = None
# effective genome size = 1.30e-09
# band width = 300
# model fold = [5, 50]
# pvalue cutoff = 1.00e-03
# qvalue will not be calculated and reported as -1 in the final output.
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off

INFO  @ Wed, 11 Nov 2015 15:29:57: #1 read tag files...
INFO  @ Wed, 11 Nov 2015 15:29:57: #1 read treatment tags...
INFO  @ Wed, 11 Nov 2015 15:29:58:  1000000
INFO  @ Wed, 11 Nov 2015 15:30:00:  2000000
INFO  @ Wed, 11 Nov 2015 15:30:01:  3000000
INFO  @ Wed, 11 Nov 2015 15:30:02:  4000000
INFO  @ Wed, 11 Nov 2015 15:30:03:  5000000
INFO  @ Wed, 11 Nov 2015 15:30:04:  6000000
INFO  @ Wed, 11 Nov 2015 15:30:05:  7000000
INFO  @ Wed, 11 Nov 2015 15:30:06:  8000000
INFO  @ Wed, 11 Nov 2015 15:30:07:  9000000
INFO  @ Wed, 11 Nov 2015 15:30:08:  10000000
INFO  @ Wed, 11 Nov 2015 15:30:09: #1 tag size is determined as 73 bps
INFO  @ Wed, 11 Nov 2015 15:30:09: #1 tag size = 73
INFO  @ Wed, 11 Nov 2015 15:30:09: #1  total tags in treatment: 10878224
INFO  @ Wed, 11 Nov 2015 15:30:09: #1 user defined the maximum tags...
INFO  @ Wed, 11 Nov 2015 15:30:09: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s)
INFO  @ Wed, 11 Nov 2015 15:30:10: #1  tags after filtering in treatment: 6261074
INFO  @ Wed, 11 Nov 2015 15:30:10: #1  Redundant rate of treatment: 0.42
INFO  @ Wed, 11 Nov 2015 15:30:10: #1 finished!
INFO  @ Wed, 11 Nov 2015 15:30:10: #2 Build Peak Model...
Traceback (most recent call last):
  File ""/Users/andrea/Programs_NGS/MACS/bin/macs2"", line 614, in <module>
    main()
  File ""/Users/andrea/Programs_NGS/MACS/bin/macs2"", line 56, in main
    run( args )
  File ""/usr/local/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 175, in run
    opt = options
  File ""MACS2/PeakModel.pyx"", line 108, in MACS2.PeakModel.PeakModel.__init__ (MACS2/PeakModel.c:2385)
  File ""MACS2/PeakModel.pyx"", line 123, in MACS2.PeakModel.PeakModel.build (MACS2/PeakModel.c:2521)
OverflowError: value too large to convert to int
```
",andreamariossi,https://github.com/macs3-project/MACS/issues/102
MDU6SXNzdWUxMjEwMDAxMjc=,MACS2 IndexError: list index out of range,CLOSED,2015-12-08T12:51:28Z,2024-10-03T14:16:11Z,2024-10-03T14:16:11Z,"I get the following error stack upon running callpeak on my two BAM-files (through Galaxy). Any way I can troubleshoot what is wrong here?

```
~$ (macs2 callpeak --verbose 9 --name ""MACS2"" -t ""/home/ogaard/gits/galaxy2/database/files/000/dataset_140.dat"" -c ""/home/ogaard/gits/galaxy2/database/files/000/dataset_116.dat"" --format='BED' --gsize ""11000000"" --bw='400' --ratio 1.0 --slocal 1000 --llocal 10000 --broad --broad-cutoff='0.1' --keep-dup ""1"" --bdg --qvalue ""0.05"" )
INFO  @ Tue, 08 Dec 2015 13:45:52:
# Command line: callpeak --verbose 9 --name MACS2 -t /home/ogaard/gits/galaxy2/database/files/000/dataset_140.dat -c /home/ogaard/gits/galaxy2/database/files/000/dataset_116.dat --format=BED --gsize 11000000 --bw=400 --ratio 1.0 --slocal 1000 --llocal 10000 --broad --broad-cutoff=0.1 --keep-dup 1 --bdg --qvalue 0.05
# ARGUMENTS LIST:
# name = MACS2
# format = BED
# ChIP-seq file = ['/home/ogaard/gits/galaxy2/database/files/000/dataset_140.dat']
# control file = ['/home/ogaard/gits/galaxy2/database/files/000/dataset_116.dat']
# effective genome size = 1.10e+07
# band width = 400
# model fold = [5, 50]
# qvalue cutoff for narrow/strong regions = 5.00e-02
# qvalue cutoff for broad/weak regions = 1.00e-01
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is on

INFO  @ Tue, 08 Dec 2015 13:45:52: #1 read tag files...
INFO  @ Tue, 08 Dec 2015 13:45:52: #1 read treatment tags...
INFO  @ Tue, 08 Dec 2015 13:45:53: #1.2 read input tags...
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 614, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 56, in main
    run( args )
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak_cmd.py"", line 70, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak_cmd.py"", line 408, in load_tag_files_options
    control = options.parser(options.cfile[0], buffer_size=options.buffer_size).build_fwtrack()
  File ""MACS2/IO/Parser.pyx"", line 200, in MACS2.IO.Parser.GenericParser.build_fwtrack (MACS2/IO/Parser.c:4271)
  File ""MACS2/IO/Parser.pyx"", line 215, in MACS2.IO.Parser.GenericParser.build_fwtrack (MACS2/IO/Parser.c:3958)
  File ""MACS2/IO/Parser.pyx"", line 351, in MACS2.IO.Parser.BEDParser.__fw_parse_line (MACS2/IO/Parser.c:5869)
IndexError: list index out of range
```
",Jondeen,https://github.com/macs3-project/MACS/issues/103
MDU6SXNzdWUxMjEwMDU2MzY=,"Remove chrN_random,ChrUn,chrM mapped reads before using MACS2.",CLOSED,2015-12-08T13:25:04Z,2015-12-23T19:29:47Z,2015-12-23T19:29:47Z,"Hi, Dr Liu, 
   Is it necessary for peak calling of histone modifications ChIP-seq data to remove the mapped reads on chrN_random, ChrUn and chrM  before running MACS2?
  Thank you!
",CTLife,https://github.com/macs3-project/MACS/issues/104
MDU6SXNzdWUxMjE0MTY0MTA=,EOFError in callpeak_cmd.py,CLOSED,2015-12-10T06:39:36Z,2016-03-09T20:08:02Z,2016-03-09T20:08:02Z,"I am running MACS2 (version:macs2 2.1.0.20150731) as `Command line: callpeak -t $TREAT -c $CONTROL -f BAM -g hs -n ./H3K27ac_macs2.v.control -B -p 0.01`
and it fails with:

```
INFO  @ Wed, 09 Dec 2015 15:53:34: #3   Pileup will be based on sequencing depth in control. 
INFO  @ Wed, 09 Dec 2015 15:53:34: #3 Call peaks for each chromosome... 
Traceback (most recent call last):
  File ""/home/bin/anaconda/bin/macs2"", line 614, in <module>
    main()
  File ""/home/bin/anaconda/bin/macs2"", line 56, in main
    run( args )
  File ""/home/bin/anaconda/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 261, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 105, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1632)
  File ""MACS2/PeakDetect.pyx"", line 251, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:3172)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 857, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12297)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 911, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12049)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 966, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__chrom_call_peak_using_certain_criteria (MACS2/IO/CallPeakUnit.c:12455)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 461, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__pileup_treat_ctrl_a_chromosome (MACS2/IO/CallPeakUnit.c:6457)
EOFError
```

Not sure what's going on with this. Any obvious places to start tracking this down? 
",sitag,https://github.com/macs3-project/MACS/issues/105
MDU6SXNzdWUxMjI1OTE0ODI=,macs2 callpeak fails with overflow error,CLOSED,2015-12-16T20:11:12Z,2015-12-16T20:27:02Z,2015-12-16T20:27:02Z,"I have run macs2 on both local machines and the cluster. 

macs2 callpeak fails every time with the following error. I am using the most recent version of macs2. I see this error has been reported before, but I do not see a fix for it. 

Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 614, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 56, in main
    run( args )
  File ""/usr/local/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 261, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 105, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1632)
  File ""MACS2/PeakDetect.pyx"", line 263, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:3460)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 858, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12244)
OverflowError: value too large to convert to int
",tstricker,https://github.com/macs3-project/MACS/issues/106
MDU6SXNzdWUxMjM0NzQ4ODQ=,Can't detect format!,CLOSED,2015-12-22T12:38:55Z,2016-03-09T20:06:53Z,2016-03-09T20:06:53Z,"Apparently this may be related to an old issue:

http://seqanswers.com/forums/archive/index.php/t-12150.html

Is this still an issue with large files? Here's the traceback:

Command line: callpeak -t /scratch/sisaw7/macs2/2015-07-09/input/chipseq/GSM1601721_STAT3_WT_nc_1685.peaks.bedgraph --nomodel -B -g mm --outdir /scratch/sisaw7/macs2/2015-07-09/output/GSM1601721_STAT3_WT_nc_1685.peaks/macs2/ -n GSM1601721_STAT3_WT_nc_1685.peaks.macs2 -B -q 0.01
ARGUMENTS LIST:
name = GSM1601721_STAT3_WT_nc_1685.peaks.macs2
format = AUTO
ChIP-seq file = ['/scratch/sisaw7/macs2/2015-07-09/input/chipseq/GSM1601721_STAT3_WT_nc_1685.peaks.bedgraph']
control file = None
effective genome size = 1.87e+09
band width = 300
model fold = [5, 50]
qvalue cutoff = 1.00e-02
Larger dataset will be scaled towards smaller dataset.
Range for calculating regional lambda is: 10000 bps
Broad region calling is off

INFO  @ Tue, 22 Dec 2015 12:28:00: #1 read tag files... 
INFO  @ Tue, 22 Dec 2015 12:28:00: #1 read treatment tags... 
Exception ZeroDivisionError: 'integer division or modulo by zero' in 'MACS2.IO.Parser.GenericParser.tsize' ignored
Exception ZeroDivisionError: 'integer division or modulo by zero' in 'MACS2.IO.Parser.GenericParser.tsize' ignored
Exception ZeroDivisionError: 'integer division or modulo by zero' in 'MACS2.IO.Parser.GenericParser.tsize' ignored
Exception IndexError: 'list index out of range' in 'MACS2.IO.Parser.GenericParser.tsize' ignored
Exception IndexError: 'list index out of range' in 'MACS2.IO.Parser.GenericParser.tsize' ignored
Traceback (most recent call last):
  File ""/software/tools/pyenv/versions/2.7.9-macs2/bin/macs2"", line 614, in <module>
    main()
  File ""/software/tools/pyenv/versions/2.7.9-macs2/bin/macs2"", line 56, in main
    run( args )
  File ""/software/tools/pyenv/versions/2.7.9-macs2/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 70, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/software/tools/pyenv/versions/2.7.9-macs2/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 390, in load_tag_files_options
    tp = options.parser(options.tfile[0], buffer_size=options.buffer_size)
  File ""MACS2/IO/Parser.pyx"", line 68, in MACS2.IO.Parser.guess_parser (MACS2/IO/Parser.c:2754)
  File ""MACS2/IO/Parser.pyx"", line 102, in MACS2.IO.Parser.guess_parser (MACS2/IO/Parser.c:2645)
Exception: Can't detect format!
",adcwilliams,https://github.com/macs3-project/MACS/issues/107
MDU6SXNzdWUxMjY5OTU1OTQ=,Key Error in MACS2,CLOSED,2016-01-16T02:45:14Z,2016-01-17T19:38:44Z,2016-01-17T19:38:44Z,"This is the command I issue,

/Users/home/Tools/MACS-master/bin/macs2 callpeak --format BED --nomodel --broad --verbose 2 --qvalue 0.25 --g mm --name Input.vs.Exp --treatment treatment.bg --control control.bg --outdir .

and I get this error,

INFO  @ Fri, 15 Jan 2016 21:12:49: 
 # Command line: callpeak --format BED --nomodel --broad --verbose 2 --qvalue 0.25 --g mm --name Input.vs.Exp --treatment treatment.bg --control control.bg --outdir .
 # ARGUMENTS LIST:
 # name = Input.vs.Exp
 # format = BED
 # ChIP-seq file = ['treatment.bg']
 # control file = ['control.bg']
 # effective genome size = 1.87e+09
 # band width = 300
 # model fold = [5, 50]
 # qvalue cutoff for narrow/strong regions = 2.50e-01
 # qvalue cutoff for broad/weak regions = 1.00e-01
 # Larger dataset will be scaled towards smaller dataset.
 # Range for calculating regional lambda is: 1000 bps and 10000 bps
 # Broad region calling is on

INFO  @ Fri, 15 Jan 2016 21:12:49: #1 read tag files... 
INFO  @ Fri, 15 Jan 2016 21:12:49: #1 read treatment tags... 
INFO  @ Fri, 15 Jan 2016 21:12:50:  1000000 
INFO  @ Fri, 15 Jan 2016 21:12:51:  2000000 
INFO  @ Fri, 15 Jan 2016 21:12:53:  3000000 
INFO  @ Fri, 15 Jan 2016 21:12:54:  4000000 
INFO  @ Fri, 15 Jan 2016 21:12:55:  5000000 
INFO  @ Fri, 15 Jan 2016 21:12:56:  6000000 
INFO  @ Fri, 15 Jan 2016 21:12:57: #1.2 read input tags... 
INFO  @ Fri, 15 Jan 2016 21:12:58:  1000000 
INFO  @ Fri, 15 Jan 2016 21:13:00:  2000000 
INFO  @ Fri, 15 Jan 2016 21:13:01:  3000000 
INFO  @ Fri, 15 Jan 2016 21:13:02:  4000000 
INFO  @ Fri, 15 Jan 2016 21:13:03: #1 tag size is determined as 41 bps 
INFO  @ Fri, 15 Jan 2016 21:13:03: #1 tag size = 41 
INFO  @ Fri, 15 Jan 2016 21:13:03: #1  total tags in treatment: 6600699 
INFO  @ Fri, 15 Jan 2016 21:13:03: #1  total tags in control: 4295400 
INFO  @ Fri, 15 Jan 2016 21:13:03: #1 finished! 
INFO  @ Fri, 15 Jan 2016 21:13:03: #2 Build Peak Model... 
INFO  @ Fri, 15 Jan 2016 21:13:03: #2 Skipped... 
INFO  @ Fri, 15 Jan 2016 21:13:03: #2 Use 200 as fragment length 
INFO  @ Fri, 15 Jan 2016 21:13:03: #3 Call peaks... 
INFO  @ Fri, 15 Jan 2016 21:13:03: #3 Call broad peaks with given level1 -log10qvalue cutoff and level2: 0.602060, 1.000000... 
INFO  @ Fri, 15 Jan 2016 21:13:03: #3 Pre-compute pvalue-qvalue table... 
INFO  @ Fri, 15 Jan 2016 21:13:22: #3 Call peaks for each chromosome... 
Traceback (most recent call last):
  File ""/Users/kasthuri/Tools/MACS-master/bin/macs2"", line 617, in <module>
    main()
  File ""/Users/kasthuri/Tools/MACS-master/bin/macs2"", line 57, in main
    run( args )
  File ""/Library/Python/2.7/site-packages/MACS2-2.1.0.20151222-py2.7-macosx-10.9-intel.egg/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""PeakDetect.pyx"", line 105, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1650)
  File ""PeakDetect.pyx"", line 259, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:3248)
  File ""CallPeakUnit.pyx"", line 1428, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_broadpeaks (MACS2/IO/CallPeakUnit.c:18243)
  File ""CallPeakUnit.pyx"", line 1501, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_broadpeaks (MACS2/IO/CallPeakUnit.c:17770)
  File ""PeakIO.pyx"", line 158, in MACS2.IO.PeakIO.PeakIO.get_data_from_chrom (MACS2/IO/PeakIO.c:3309)
KeyError: 'chr12'

Any help will be much appreciated. Thanks.
",kannan-kasthuri,https://github.com/macs3-project/MACS/issues/108
MDU6SXNzdWUxMzA0NjM4OTI=,Summits that are too close,CLOSED,2016-02-01T19:48:56Z,2024-10-03T14:47:36Z,2024-10-03T14:47:36Z,"Hello MACS community,

Running MACS2 with --call-summits I found that often the summits of a single narrowpeak can be too close; as close as 2bp. In all of ENCODE dataset for example there is  62 such cases.

This complicates the interpretation of the summits and I was wondering to ask if this is a problem that other people have seen and might have an opinion on it.

Example of a command I use:
macs2 callpeak -t ENCSR000AUE_ENCFF000AHP_Rep1.bam ENCSR000AUE_ENCFF000AHR_Rep2.bam --nomodel --qvalue 0.001 -f BAM -g hs -n BradleyBernstein-Broad_A549_CTCF_CHEBI-41879-dexamethasone-1-hour-nM-100_No-Control_ENCSR000AUE --outdir MACS2/BradleyBernstein-Broad_A549_CTCF_CHEBI-41879-dexamethasone-1-hour-nM-100_No-Control_ENCSR000AUE --call-summits --verbose 2

Thanks
Mehran
",mehrankr,https://github.com/macs3-project/MACS/issues/110
MDU6SXNzdWUxMzMwNzM0NDQ=,usage of --slocal and --llocal,CLOSED,2016-02-11T19:57:57Z,2024-10-03T14:48:07Z,2024-10-03T14:48:07Z,"I am trying to run macs so that it does NOT consider the background lambda (λBG) when getting the maximum lambda to calculate the local lambda. I just want to use the 1kb, 5kb and 10kb window lambdas when calculating the local lambda. Is this possible using --slocal and --llocal?

From the explanation of --slocal and --llocal it is not clear whether when you specify these parameter the background lambda (λBG) is still considered when calculating the local lambda.

Thanks for the help,

E
",emancera,https://github.com/macs3-project/MACS/issues/111
MDU6SXNzdWUxMzMyNTI4MTY=,Full fragment bed file support,CLOSED,2016-02-12T14:17:22Z,2016-02-26T15:16:44Z,2016-02-26T15:16:44Z,"We would like to pass macs a bedfile that represents entire fragments. This would mean passing a bed file where the paired end data has been already mapped and converted into a ""fragment"" bed format, such as:

`chr start (of fragment) end (of fragment)`

We do exclusively paired end data, but we do not save the bulky bam files and instead convert directly into this fragment bed format. We are currently using an in house peak caller, but we would really like to use Macs and love to add you to our citations ;)

We have tried to trick Macs by converting our fragment bed to the paired end bed format (that is unfortunately poorly documented) and then back to bam. However, we were not successful and it anyhow seems overly circular. Since you already have an option that could be tweaked for single-end bedfile format could it be changed to not estimate the fragment length and use the entire start stop region rather than the beginning?

Many thanks,
Ashley
",N/A,https://github.com/macs3-project/MACS/issues/112
MDU6SXNzdWUxMzU0NjY5OTk=,error installing MACS2 from source,CLOSED,2016-02-22T16:25:45Z,2024-10-03T14:50:17Z,2024-10-03T14:50:17Z,"when trying to do
sudo python setup.py install

The following error comes up:

running install
running bdist_egg
running egg_info
writing requirements to MACS2.egg-info/requires.txt
writing MACS2.egg-info/PKG-INFO
writing top-level names to MACS2.egg-info/top_level.txt
writing dependency_links to MACS2.egg-info/dependency_links.txt
reading manifest file 'MACS2.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
warning: no files found matching 'MANIFEST'
writing manifest file 'MACS2.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
running build_ext
building 'MACS2.Prob' extension
x86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/lib/python2.7/dist-packages/numpy/core/include -I/usr/include/python2.7 -c MACS2/Prob.c -o build/temp.linux-x86_64-2.7/MACS2/Prob.o -w -O3 -ffast-math
x86_64-linux-gnu-gcc: error: MACS2/Prob.c: No such file or directory
x86_64-linux-gnu-gcc: fatal error: no input files
compilation terminated.
error: command 'x86_64-linux-gnu-gcc' failed with exit status 4

Prob.c is not generated to be compiled...
Thanks!
Javier
",jpflorido,https://github.com/macs3-project/MACS/issues/113
MDU6SXNzdWUxMzU4MTYxMzY=,fix integration in current version,CLOSED,2016-02-23T18:06:48Z,2016-02-26T15:13:54Z,2016-02-26T15:13:54Z,"Dear Taoliu,

I got the same error that was metioned in this post: https://github.com/taoliu/MACS/issues/108

Do you plan to integrate the fix?

thanks
",descostesn,https://github.com/macs3-project/MACS/issues/114
MDU6SXNzdWUxMzY5NjUyODI=,error: undefined symbol __log10_finite,CLOSED,2016-02-27T20:45:35Z,2023-10-08T13:23:07Z,2016-02-27T22:55:00Z,"I am tryint to run the following command and got the error. I guess I need to install additional libraries but I don't know which one. 

``` bash
macs2 callpeak -t treatment.bam --broad -n
 ""test"" -f BAM -g 1949947921 --outdir macs2 
Traceback (most recent call last):
  File ""~/bin/opt/anaconda/envs/pytools_env/bin/macs2"", line 617, in <module>
    main()
  File ""/~/bin/opt/anaconda/envs/pytools_env/bin/macs2"", line 56, in main
    from MACS2.callpeak_cmd import run
  File ""~/bin/opt/anaconda/envs/pytools_env/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 31, in <module
>
    from MACS2.OptValidator import opt_validate
  File ""~/bin/opt/anaconda/envs/pytools_env/lib/python2.7/site-packages/MACS2/OptValidator.py"", line 27, in <module
>
    from MACS2.IO.Parser import BEDParser, ELANDResultParser, ELANDMultiParser, \
  File ""MACS2/IO/Parser.pyx"", line 27, in init MACS2.IO.Parser (MACS2/IO/Parser.c:21821)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 31, in init MACS2.IO.FixWidthTrack (MACS2/IO/FixWidthTrack.c:20307)
  File ""MACS2/Pileup.pyx"", line 24, in init MACS2.Pileup (MACS2/Pileup.c:13248)
ImportError: ~/bin/opt/anaconda/envs/pytools_env/lib/python2.7/site-packages/MACS2/IO/BedGraph.so: undefined symbol
: __log10_finite

```
",biocyberman,https://github.com/macs3-project/MACS/issues/115
MDU6SXNzdWUxMzY5ODA3NzY=,"Q: 'effective genome size' , how precisse does it have to be?",CLOSED,2016-02-27T23:22:25Z,2019-08-16T17:25:03Z,2016-02-27T23:44:39Z,"Rat genome is one of the genomes that are not mentioned very much among macs2 users. So I had to look around and do some work for myself. I want to share the output and also ask a related question.

I used rat genome rn6 downloaded from UCSC bigzip file and kept all contigs that do not have standard chromosome names.  The calculation involved using `gem-indexer` for base-space data and  `gem-mappability` with kmer size of 45, 50, 75, 100, and 150 bases. The effective genome size values are the number of '!' characters in the `.mappability` files.   

``` text
rn6.softmask.all_45: 2105347242
rn6.softmask.all_50: 2081721273
rn6.softmask.all_75: 2197995070
rn6.softmask.all_100: 2247394146
rn6.softmask.all_150: 2285452802
```

I also did some test with color-space index of only chromosome 1. The numbers looks greater than that from base-space index of chromosome 1. So here comes some questions.
1. Which number should I use? The one from color-space index or base-space index. My BAM files were aligned with colorspace aligner and reads are colorspace reads.
2. What is the consequence of under or over estimate the effective genome size in macs2 output? 
3. Macs2 documentation does not seem to draw much attention about kmer size. What kmer size was used to calculate those values for 'supported' genomes by macs2?

Thanks. 
",biocyberman,https://github.com/macs3-project/MACS/issues/116
MDU6SXNzdWUxMzc2OTc2NTc=,MACS2 to CEAS,CLOSED,2016-03-01T21:53:01Z,2016-03-09T20:06:13Z,2016-03-09T20:06:13Z,"Hi Tao,

After MACS2, I want to run CEAS, and I found MACS2 give bdg and narrowpeak, so how can I change bdg to wig file and narrowpeak to bed file? I tried to run MACS and got bed and wig, but the peaks in MACS and MACS2 were different, I also tried use bdg and narrowpeak to run CEAS, it failed.
Thank you

Spencer
",yanyanyangunc,https://github.com/macs3-project/MACS/issues/117
MDU6SXNzdWUxMzgwNDkyMTM=,Issue install MACS2 mac,CLOSED,2016-03-03T01:46:26Z,2016-03-05T18:47:26Z,2016-03-05T18:47:26Z,"I am getting an issue when trying to install from source or pip. This is what I get

`Collecting MACS2
  Using cached MACS2-2.1.1.20160226.tar.gz
Requirement already satisfied (use --upgrade to upgrade): numpy>=1.6 in /Library/Python/2.7/site-packages (from MACS2)
Building wheels for collected packages: MACS2
  Running setup.py bdist_wheel for MACS2 ... error
  Complete output from command /Users/evanclark/Desktop/caputiclip/venv/bin/python -u -c ""import setuptools, tokenize;**file**='/private/var/folders/dr/07m1vc7x12n97h5p4zw_vlpw0000gn/T/pip-build-1hgEkD/MACS2/setup.py';exec(compile(getattr(tokenize, 'open', open)(**file**).read().replace('\r\n', '\n'), **file**, 'exec'))"" bdist_wheel -d /var/folders/dr/07m1vc7x12n97h5p4zw_vlpw0000gn/T/tmpPGbCk2pip-wheel- --python-tag cp27:
  running bdist_wheel
  running build
  running build_py
  creating build
  creating build/lib.macosx-10.8-intel-2.7
  creating build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/**init**.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/bdgbroadcall_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/bdgcmp_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/bdgdiff_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/bdgopt_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/bdgpeakcall_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/callpeak_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/cmbreps_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/Constants.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/diffpeak_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/filterdup_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/OptValidator.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/OutputWriter.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/pileup_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/predictd_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/randsample_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  copying MACS2/refinepeak_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
  creating build/lib.macosx-10.8-intel-2.7/MACS2/IO
  copying MACS2/IO/**init**.py -> build/lib.macosx-10.8-intel-2.7/MACS2/IO
  copying MACS2/IO/BinKeeper.py -> build/lib.macosx-10.8-intel-2.7/MACS2/IO
  copying MACS2/IO/test_processing.py -> build/lib.macosx-10.8-intel-2.7/MACS2/IO
  copying MACS2/IO/test_threading.py -> build/lib.macosx-10.8-intel-2.7/MACS2/IO
  running build_ext
  building 'MACS2.Prob' extension
  creating build/temp.macosx-10.8-intel-2.7
  creating build/temp.macosx-10.8-intel-2.7/MACS2
  clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -arch i386 -arch x86_64 -pipe -I/Library/Python/2.7/site-packages/numpy/core/include -I/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c MACS2/Prob.c -o build/temp.macosx-10.8-intel-2.7/MACS2/Prob.o -w -O3 -ffast-math
  clang: error: unknown argument: '-mno-fused-madd' [-Wunused-command-line-argument-hard-error-in-future]
  clang: note: this will be a hard error (cannot be downgraded to a warning) in the future
  error: command 'clang' failed with exit status 1

---

  Failed building wheel for MACS2
  Running setup.py clean for MACS2
Failed to build MACS2
Installing collected packages: MACS2
  Running setup.py install for MACS2 ... error
    Complete output from command /Users/evanclark/Desktop/caputiclip/venv/bin/python -u -c ""import setuptools, tokenize;**file**='/private/var/folders/dr/07m1vc7x12n97h5p4zw_vlpw0000gn/T/pip-build-1hgEkD/MACS2/setup.py';exec(compile(getattr(tokenize, 'open', open)(**file**).read().replace('\r\n', '\n'), **file**, 'exec'))"" install --record /var/folders/dr/07m1vc7x12n97h5p4zw_vlpw0000gn/T/pip-7yMtJ3-record/install-record.txt --single-version-externally-managed --compile --install-headers /Users/evanclark/Desktop/caputiclip/venv/include/site/python2.7/MACS2:
    running install
    running build
    running build_py
    creating build
    creating build/lib.macosx-10.8-intel-2.7
    creating build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/**init**.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/bdgbroadcall_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/bdgcmp_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/bdgdiff_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/bdgopt_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/bdgpeakcall_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/callpeak_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/cmbreps_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/Constants.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/diffpeak_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/filterdup_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/OptValidator.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/OutputWriter.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/pileup_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/predictd_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/randsample_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    copying MACS2/refinepeak_cmd.py -> build/lib.macosx-10.8-intel-2.7/MACS2
    creating build/lib.macosx-10.8-intel-2.7/MACS2/IO
    copying MACS2/IO/**init**.py -> build/lib.macosx-10.8-intel-2.7/MACS2/IO
    copying MACS2/IO/BinKeeper.py -> build/lib.macosx-10.8-intel-2.7/MACS2/IO
    copying MACS2/IO/test_processing.py -> build/lib.macosx-10.8-intel-2.7/MACS2/IO
    copying MACS2/IO/test_threading.py -> build/lib.macosx-10.8-intel-2.7/MACS2/IO
    running build_ext
    building 'MACS2.Prob' extension
    creating build/temp.macosx-10.8-intel-2.7
    creating build/temp.macosx-10.8-intel-2.7/MACS2
    clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -arch i386 -arch x86_64 -pipe -I/Library/Python/2.7/site-packages/numpy/core/include -I/System/Library/Frameworks/Python.framework/Versions/2.7/include/python2.7 -c MACS2/Prob.c -o build/temp.macosx-10.8-intel-2.7/MACS2/Prob.o -w -O3 -ffast-math
    clang: error: unknown argument: '-mno-fused-madd' [-Wunused-command-line-argument-hard-error-in-future]
    clang: note: this will be a hard error (cannot be downgraded to a warning) in the future
    error: command 'clang' failed with exit status 1`
",djevo1,https://github.com/macs3-project/MACS/issues/118
MDU6SXNzdWUxMzgwNjk3NDk=,Is the peak height fold change from two different peak calling events comparable?,CLOSED,2016-03-03T04:05:55Z,2024-10-03T14:51:52Z,2024-10-03T14:51:51Z,"Dear Scientist Tao,

Hi! I am just wondering whether I could directly compare the peak height from fold change generated from two different peak calling events, such as H3K4me3 ChIP from one condition and H3K4me3 ChIP from another condition (each has its own input control ChIP)?

Similarly, could I compare H3K4me3 ChIP from one biological replicate and H3K4me3 ChIP from another biological replicate (each has its own input control ChIP)?

I just realise that MACS can identify differential binding regions. I am not sure whether you have heard about csaw (https://bioconductor.org/packages/release/bioc/html/csaw.html), but if you do, could you have some comments about MACS and csaw in identifying differential binding regions? 

Thanks so much in advance!

Jingyi from the University of Melbourne
",JingyiTang,https://github.com/macs3-project/MACS/issues/119
MDU6SXNzdWUxMzkxNTkxMDY=,Chromosome by chromosome bias on peakcalling,CLOSED,2016-03-08T02:34:52Z,2024-10-03T14:52:22Z,2024-10-03T14:52:22Z,"Hi Tao

I am relatively new to Macs2.  Although it is sensitive enough pick up many picks, one thing that I noticed is that the number of peak can vary a lot from one chromosome to another.  

Peaks from my ChIP-seq data is not very strong (-q 0.1 --broad --llocal 100000).  For many peak calling comparison, values of fold enrichment are very different between chromosomes.  For example, I sometimes get 50 peaks on chromosome I (with fold enrichment <1.2), no peaks on chromosome II and 100 peaks on chromosome III (with fold enrichment~3).  Therefore, it looks like there might be systematic bias when calculating fold enrichment for each chromosome.

Is there anyway to get around this issue?  From my dataset, I expect more less equal distribution of many weak peaks throughout the genome (confirmed by visual inspection of ChIP-seq profiles).

Thanks,
Richard    
",richjoh,https://github.com/macs3-project/MACS/issues/121
MDU6SXNzdWUxNDE0MTY1Mjc=,Errors out at peak calling,OPEN,2016-03-16T22:07:30Z,2017-10-02T17:45:30Z,,"Have you guys run into this before? Know what's causing the issue, or how to work around it?

command im using:

macs2 callpeak -t $chipfile -c $controlfile -B --nomodel --shift $shift --SPMR -g hs -q 0.01 --broad -f BAMPE -n $chipfile.macs2

INFO  @ Wed, 16 Mar 2016 22:01:13: #3 Call peaks... 
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 5, in <module>
    pkg_resources.run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""/usr/lib/python2.7/dist-packages/pkg_resources.py"", line 528, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/usr/lib/python2.7/dist-packages/pkg_resources.py"", line 1394, in run_script
    execfile(script_filename, namespace, namespace)
  File ""/usr/local/lib/python2.7/dist-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>
    main()
  File ""/usr/local/lib/python2.7/dist-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 57, in main
    run( args )
  File ""/usr/local/lib/python2.7/dist-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""PeakDetect.pyx"", line 105, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1704)
  File ""PeakDetect.pyx"", line 177, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:2216)
AssertionError: slocal can't be smaller than d!
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 5, in <module>
    pkg_resources.run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""/usr/lib/python2.7/dist-packages/pkg_resources.py"", line 528, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/usr/lib/python2.7/dist-packages/pkg_resources.py"", line 1394, in run_script
    execfile(script_filename, namespace, namespace)
  File ""/usr/local/lib/python2.7/dist-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>
    main()
  File ""/usr/local/lib/python2.7/dist-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 57, in main
    run( args )
  File ""/usr/local/lib/python2.7/dist-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""PeakDetect.pyx"", line 105, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1704)
  File ""PeakDetect.pyx"", line 259, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:3344)
  File ""CallPeakUnit.pyx"", line 1431, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_broadpeaks (MACS2/IO/CallPeakUnit.c:18287)
  File ""CallPeakUnit.pyx"", line 1488, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_broadpeaks (MACS2/IO/CallPeakUnit.c:17664)
  File ""CallPeakUnit.pyx"", line 1567, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__chrom_call_broadpeak_using_certain_criteria (MACS2/IO/CallPeakUnit.c:18413)
  File ""CallPeakUnit.pyx"", line 475, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__pileup_treat_ctrl_a_chromosome (MACS2/IO/CallPeakUnit.c:6465)
ValueError: cannot resize this array: it does not own its data
",blikzen,https://github.com/macs3-project/MACS/issues/122
MDU6SXNzdWUxNDQ3MDU0NDE=,narrowPeak score (5th) column value above 1000,CLOSED,2016-03-30T20:07:44Z,2019-08-13T19:39:02Z,2019-08-13T19:39:02Z,"According to the [UCSC Encode narrowPeak format](https://genome.ucsc.edu/FAQ/FAQformat.html#format12), the fifth column (score) should be a value between 0-1000. Occasionally, MACS2 will produce peaks with a score value above 1000 (in our analysis, on average, this happens for less than 0.4% of the reported peaks). Still, some of the values go well beyond 1000, so I wonder how is the score computed in MACS2 and which is the score range used.

I found out this to be an issue when submitting data to the ENCODE project, which would not accept narrowPeaks files containing peaks with scores above 1000. 
",alexbarrera,https://github.com/macs3-project/MACS/issues/123
MDU6SXNzdWUxNDkyODc5Mzc=,OverflowError: value too large to convert to short,CLOSED,2016-04-18T22:22:33Z,2024-10-03T14:57:42Z,2024-10-03T14:57:41Z,"Hello,
I saw a similar error in the questions of this repository some times but could not find a solution, could you please help?

 Command line: callpeak -t CHD1_K562_mergedm1k1.bam -f BAM -g hs -n CHD1
 ARGUMENTS LIST:
 name = CHD1
 format = BAM
 ChIP-seq file = ['CHD1_K562_mergedm1k1.bam']
 control file = None
 effective genome size = 2.70e+09
 band width = 300
 model fold = [5, 50]
 qvalue cutoff = 5.00e-02
 Larger dataset will be scaled towards smaller dataset.
 Range for calculating regional lambda is: 10000 bps
 Broad region calling is off
 Paired-End mode is off

INFO  @ Tue, 19 Apr 2016 00:08:45: #1 read tag files... 
INFO  @ Tue, 19 Apr 2016 00:08:45: #1 read treatment tags... 
Exception struct.error: 'unpack requires a string argument of length 4' in 'MACS2.IO.Parser.BAMParser.tsize' ignored
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 617, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 57, in main
    run( args )
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak_cmd.py"", line 73, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak_cmd.py"", line 399, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""MACS2/IO/Parser.pyx"", line 880, in MACS2.IO.Parser.BAMParser.build_fwtrack (MACS2/IO/Parser.c:13703)
  File ""MACS2/IO/Parser.pyx"", line 903, in MACS2.IO.Parser.BAMParser.build_fwtrack (MACS2/IO/Parser.c:13365)
  File ""MACS2/IO/Parser.pyx"", line 964, in MACS2.IO.Parser.BAMParser.__fw_binary_parse (MACS2/IO/Parser.c:14669)
OverflowError: value too large to convert to short

Thanks
",simjbaum,https://github.com/macs3-project/MACS/issues/125
MDU6SXNzdWUxNTI2ODg2NzI=,MACS2 for Nicotiana tabacum,CLOSED,2016-05-03T02:37:59Z,2024-10-03T14:58:19Z,2024-10-03T14:58:18Z,"Hi Tao,
I want to analysis my Nicotiana tabacum chip-seq data with MACS2.My sequence type is single-ended 50. The 'genome' I used is composed of scaffolds,""ftp://ftp.solgenomics.net/genomes/Nicotiana_tabacum/assembly/Ntab-K326_AWOJ-SS.fa.gz"".
Can I properly analyzed it in this situation ? How long the 'GSIZE' I should set ?  
",februaryfang,https://github.com/macs3-project/MACS/issues/126
MDU6SXNzdWUxNTI4NzM3NTE=,threshold of macs2 for bdgbroadcall,CLOSED,2016-05-03T21:03:35Z,2024-10-03T14:58:56Z,2024-10-03T14:58:56Z,"Dear Dr. Liu,

I used the following command to conduct peak calling of my .bedGraph file. I am wondering if there is a default value of the parameter -c, which, from my understanding, is the cutoff of  maxHeightPixels of a region. Here I randomly chosen -c = 5. Thanks!
macs2 bdgbroadcall -i input.bedGraph -o output.bed -c 5

Maggie at WFU
",dguowfu,https://github.com/macs3-project/MACS/issues/127
MDU6SXNzdWUxNTMxOTkyMjM=,MeDIP-seq data,OPEN,2016-05-05T09:38:23Z,2016-05-19T14:43:45Z,,"Hi,
I was using MACS14 and MACS2 on MeDIP-seq data in default parameter. But the model generated by MACS14, looks like [I13_AGTCAA__model.pdf](https://github.com/taoliu/MACS/files/250181/I13_AGTCAA__model.pdf) and using MACS2 [I13_AGTCAA_macs2_model.pdf](https://github.com/taoliu/MACS/files/250184/I13_AGTCAA_macs2_model.pdf).
 Do you have any suggestions on how to tune the parameters for these ? 

Thanks.
Sourav
",porpheria,https://github.com/macs3-project/MACS/issues/128
MDU6SXNzdWUxNTQ4NDU2NzM=,add mapping quality cutoff in callpeak subcommand for BAM and BAMPE,OPEN,2016-05-14T10:14:47Z,2016-05-17T02:02:03Z,,"please consider add mapping quality cutoff for BAM and BAMPE format input during peak calling

thanks
",carl-,https://github.com/macs3-project/MACS/issues/130
MDU6SXNzdWUxNTUxNzMyMDY=,Difference b/w version 2.1.0.20150731 and version 2.1.1.20160309,CLOSED,2016-05-17T04:10:11Z,2024-11-13T17:51:24Z,2024-11-13T17:51:24Z,"Hi,

I recently updated MACS2 using 'pip', and re-run the peak calling. I found that the broad peak call numbers have increased so much. How is this?

I have used the same parameters in both the run, but still get different peak numbers. There is also a change in the number of narrow peaks, but not this dramatic.  I use BAMPE, since  my data is paired-end. 

**# broad peaks b/w the two version:**
 sample  v2.1.0  v2.1.1
Sample1  914      2250 
Sampe2   5          3860 

What is the difference in the broad peak calling between the two versions?

Appreciate your help!

Thanks,
Aarthi
",aarthi-mohan,https://github.com/macs3-project/MACS/issues/131
MDU6SXNzdWUxNTcyMzA4MjA=,ImportError: No module named MACS2.Constants,CLOSED,2016-05-27T15:22:35Z,2024-11-13T18:03:20Z,2024-11-13T18:03:20Z,"Hi Tao Liu,

When I run MACS2, there is en error.
Traceback (most recent call last):
  File ""/lorax/Software/MACS2-2.1.0/bin/macs2"", line 30, in <module>
    from MACS2.Constants import *
ImportError: No module named MACS2.Constants

And before I run MACS2, I used two commends to define the python:
export PYTHONPATH=$HOME/lib/python2.7/site-packages/:$PYTHONPATH
export PATH=$HOME/bin/:$PATH
Then, I run MACS2:
/lorax/Software/MACS2-2.1.0/bin/macs2 callpeak -t xxx.bam -f BAM -g 3.2e9 -n xxx -B -q 0.01.

Thank you very much!
",icTAIR,https://github.com/macs3-project/MACS/issues/132
MDU6SXNzdWUxNTkwMzc3MDY=,sorted bam files,CLOSED,2016-06-07T22:16:30Z,2024-11-13T18:01:56Z,2024-11-13T18:01:56Z,"I was wondering when you run MACS2 with BAMPE option, does it matter how to sort BAM files?
or is it best to run with unsorted bams? I saw that people reported unmatched results with coordinate and name sorted bams before.
",serkanerdin,https://github.com/macs3-project/MACS/issues/133
MDU6SXNzdWUxNTk4MDUzODI=,BAMPE mode: only properly paired reads were used for peak calling ?,OPEN,2016-06-12T03:22:52Z,2016-06-16T15:47:13Z,,"HI tao,

It seems that if only properly paired read were used in BAMPE mode. Is that true ? I just want to confirm that .
",carl-,https://github.com/macs3-project/MACS/issues/134
MDU6SXNzdWUxNTk5NDkwMzk=,option --linking-cutoff is not implemented for --broad ?,CLOSED,2016-06-13T13:23:20Z,2024-11-13T18:00:04Z,2024-11-13T18:00:04Z,"Hi, tao,

Is the option --linking-cutoff implemented for broad peak calling in macs2 now?

I found that option in the help message of callpeak sub command but got an error if i enable it
macs2: error: unrecognized arguments: --linking-cutoff
",carl-,https://github.com/macs3-project/MACS/issues/135
MDU6SXNzdWUxNjAzMDQ0MjI=,"question about q-value cutoff in broad peak calling, thank you",OPEN,2016-06-14T23:04:57Z,2017-08-06T02:53:18Z,,"hello @taoliu , 

For the peaking calling of a broad IP, I used both `--broad` and `--broad-cutoff 0.1`, so I expect the predicted peak to have `-log10(q-value)` greater than 1? However, in the predicted .broadPeak bed6+3 files, the minimum  `-log10(q-value)` value in the 9th column can reach as small as 0.2~0.3. I checked the log file (please see below), and it seems that the user-specified q-value cutoff is parsed correctly. I used different treatment files and they also generated `-log10(q-value)` smaller than 1 though I did set `--broad-cutoff 0.1`. 

Could you please correct me if I got my command wrong here for peaking calling on broad IP? The q-value cutoff works fine for my narrow IP, and all the predicted peaks have values in 9th columns greater than 2 (I set q-value cutoff at 0.01 for narrow IP).

```
# Command line: callpeak -t treatment.bam -c control.bam --broad -g hs --broad-cutoff 0.1 -n H3K27me3_vs_input --outdir output/
# ARGUMENTS LIST:
# name = H3K27me3_vs_input
# format = AUTO
# ChIP-seq file = ['treatment.bam]
# control file = ['control.bam']
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff for narrow/strong regions = 5.00e-02
# qvalue cutoff for broad/weak regions = 1.00e-01
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is on
```

Thank you very much!
",aliceZhu,https://github.com/macs3-project/MACS/issues/136
MDU6SXNzdWUxNjA2MDUxMzM=,macs2 command choice when call broad peak ,CLOSED,2016-06-16T08:27:55Z,2024-11-13T17:52:49Z,2024-11-13T17:52:48Z,"Hi @taoliu 
  Using  macs2 to call broad peak ,how to decide the command "" --nomodel , --extsize , --broad-cutoff ""  to use ?
The command line  : macs2 callpeak -t ""$IP_bam"" -c ""$Input_bam"" --broad -g hs --broad-cutoff 0.1 -n ""${file}""-A-NC-broad-nomodel --nomodel --extsize 146 
 or 
macs2 callpeak -t ""$IP_bam"" -c ""$Input_bam"" --broad -g hs -n ""${file}""-A-NC-broad
could you explain the difference of these two command line 
",yinyao41,https://github.com/macs3-project/MACS/issues/137
MDU6SXNzdWUxNjgzODkwMTU=,DOC: wrong argument in the wike for shift size,CLOSED,2016-07-29T18:46:27Z,2016-08-16T17:41:41Z,2016-08-16T17:41:41Z,"The page https://github.com/taoliu/MACS/wiki/Build-Signal-Track still refers to the --shiftsize option instead of the --shift one.

Thanks,
N
",NelleV,https://github.com/macs3-project/MACS/issues/138
MDU6SXNzdWUxNjg0NzUyMDM=,Does not throw error when files don't have read permissions,CLOSED,2016-07-30T16:26:00Z,2024-11-13T18:00:37Z,2024-11-13T18:00:37Z,"Macs will succesfully run on files the user does not have read permission on and will create empty output files. My guess is the program interprets them as being empty instead of being unable to be opened.  Either some sort of check for access permissions or a flag in the stdError/stdOut if an empty file is detected would be great.
",snystrom,https://github.com/macs3-project/MACS/issues/139
MDU6SXNzdWUxNzAxMzIxMTg=,cython >=  0.24: MACS2/IO/PeakIO.pyx:632:49: Cannot assign type 'float' to 'int',CLOSED,2016-08-09T10:22:52Z,2019-10-22T14:14:05Z,2019-10-22T14:14:05Z,"When running `python setup_w_cython.py install` with cython version >= 0.24, I get the following error:

```
cythoning MACS2/IO/PeakIO.pyx to MACS2/IO/PeakIO.c

Error compiling Cython file:
------------------------------------------------------------
...
            pileup = float(fields[5])
            pscore = float(fields[6])
            fc = float(fields[7])
            qscore = float(fields[8])
            peakname = rstrip(fields[9])
            add(chrom, start, end, summit, qscore, pileup, pscore, fc, qscore,
                                                ^
------------------------------------------------------------

MACS2/IO/PeakIO.pyx:632:49: Cannot assign type 'float' to 'int'
building 'MACS2.IO.PeakIO' extension
gcc -pthread -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/usr/include/python2.7 -c MACS2/IO/PeakIO.c -o build/temp.linux-x86_64-2.7/MACS2/IO/PeakIO.o -w -O3 -ffast-math
MACS2/IO/PeakIO.c:1:2: error: #error Do not use this file, it is the result of a failed Cython compilation.
 #error Do not use this file, it is the result of a failed Cython compilation.
  ^
error: command 'gcc' failed with exit status 1
```

Using an older cython version (e.g. `0.23`) resolves that issue:

```
pip install cython==0.23 --user
```
",your-highness,https://github.com/macs3-project/MACS/issues/140
MDU6SXNzdWUxNzE4MjEzMDE=,I have some problems to deal with macs.,CLOSED,2016-08-18T05:34:08Z,2024-11-13T18:01:27Z,2024-11-13T18:01:27Z,"Hello,

I recently followed the protocol of m6A sequencing which is published in 2013 (Dominissini, Dan, et al. ""Transcriptome-wide mapping of N6-methyladenosine by m6A-seq based on immunocapturing and massively parallel sequencing."" Nature protocols 8.1 (2013): 176-189.). And I got two problems. Those troubles are found in running macs. At first, according to above reference paper, they used ""--to-small"" parameter. However, in my case, my computer said there isn't such option called ""--to-small"". Next, if I typed like this.
$macs14 -t IP.sam -c Input.sam --name=m6A --format=""SAM"" --gsize=282000000 --tsize=36 --nomodel --shiftsize=50 -w -S 2 > macs.out &
Then, there are some errors found like as follows.

**# ARGUMENTS LIST:**

**# name = m6A**

**# format = SAM**

**# ChIP-seq file = IP.sam**

**# control file = Input.sam**

**# effective genome size = 2.82e+08**

**# band width = 300**

**# model fold = 10,30**

**# pvalue cutoff = 1.00e-05**

**# Large dataset will be scaled towards smaller dataset.**

**# Range for calculating regional lambda is: 1000 bps and 10000 bps**

INFO @ Wed, 17 Aug 2016 10:26:59: #1 read tag files...

INFO @ Wed, 17 Aug 2016 10:26:59: #1 read treatment tags...

Traceback (most recent call last):

File ""/usr/local/bin/macs14"", line 366, in <module> main()

File ""/usr/local/bin/macs14"", line 60, in main (treat, control) = load_tag_files_options (options)

File ""/usr/local/bin/macs14"", line 335, in load_tag_files_options ttsize = tp.tsize()

File ""/usr/local/lib/python2.7/dist-packages/MACS14/IO/Parser.py"", line 647, in tsize (chromosome,fpos,strand) = self.__fw_parse_line(thisline)

File ""/usr/local/lib/python2.7/dist-packages/MACS14/IO/Parser.py"", line 684, in __fw_parse_line bwflag = int(thisfields[1])

ValueError: invalid literal for int() with base 10: '-'

This is my first time to use macs, so if anyone helps me, I'll very appreciate it.

Thank you
",jamespotter,https://github.com/macs3-project/MACS/issues/141
MDU6SXNzdWUxNzE5Mjk4NTc=,Python int too large to convert to C long,OPEN,2016-08-18T15:28:34Z,2016-08-22T09:55:48Z,,"Hi, all,

Just ran MACS2 (2.1.1.20160309) using -f BAM and got this error:

WARNING @ Thu, 18 Aug 2016 17:07:57: #2 Since the d (85) calculated from paired-peaks are smaller than 2*tag length, it may be influenced by unknown sequencing problem! 
WARNING @ Thu, 18 Aug 2016 17:07:57: #2 You may need to consider one of the other alternative d(s): 85,488,546 
WARNING @ Thu, 18 Aug 2016 17:07:57: #2 You can restart the process with --nomodel --extsize XXX with your choice or an arbitrary number. Nontheless, MACS will continute computing. 
INFO  @ Thu, 18 Aug 2016 17:07:57: #3 Call peaks... 
Traceback (most recent call last):
  File ""/home/junxi/.local/bin/macs2"", line 617, in <module>
    main()
  File ""/home/junxi/.local/bin/macs2"", line 57, in main
    run( args )
  File ""/home/junxi/.local/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 105, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1632)
  File ""MACS2/PeakDetect.pyx"", line 157, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:1942)
OverflowError: Python int too large to convert to C long

Have you any thoughts? Thanks!

PS: the version of python is 2.7.12.
",junxiW,https://github.com/macs3-project/MACS/issues/142
MDU6SXNzdWUxNzIyODQwNDA=,Possible option: generate bedGraph without peaks,OPEN,2016-08-20T18:29:19Z,2016-08-23T05:17:19Z,,"Hello,

I am interested in generating signals, and as I understand to do that I need to have files in bedGraph format. I understand that to generate bedGraph files I need to call callpeaks, however, I do not want to calculate peaks, just would like to have bedGraph files to generate signals.

As I got from your code (maybe I am wrong), the transformation of replicate and control files to bedGraph is executed before peak is calculated, at least, for each chromosome. So, is that possible to add an option, which allows to skip the part of calculating peaks and just save bedGraph files to generate signals.

I am sorry if I missed something and this option already exists.

Sincerely,
Jurijs Nazarovs
",N/A,https://github.com/macs3-project/MACS/issues/143
MDU6SXNzdWUxNzM5MTA2MjE=,pileup column in .xls file when setting --broad,CLOSED,2016-08-30T01:36:24Z,2017-03-22T17:15:44Z,2016-09-28T03:43:47Z,"Hi Tao,
 I wonder what is the meaning of pileup column in .xls file(--broad) as there is no summit in broad peak calling.  I want to calculate correlation of peak strength  between a TF  and a histone marker. Is it OK to correlate the pileup column?
",ChenFengling,https://github.com/macs3-project/MACS/issues/144
MDU6SXNzdWUxNzQzNDc1OTk=,ATAC-seq settings,OPEN,2016-08-31T18:43:24Z,2021-08-05T17:00:15Z,,"I am trying to call peaks in ATAC-seq data. According to the documentation:

> To find enriched cutting sites such as some DNAse-Seq datasets. In this case, all 5' ends of sequenced reads should be extended in both direction to smooth the pileup signals. If the wanted smoothing window is 200bps, then use '--nomodel --shift -100 --extsize 200'.
> For certain nucleosome-seq data, we need to pileup the centers of nucleosomes using a half-nucleosome size for wavelet analysis (e.g. NPS algorithm). Since the DNA wrapped on nucleosome is about 147bps, this option can be used: '--nomodel --shift 37 --extsize 73'.

Based on a brief literature review, people use both `--shift -100 --extsize 200` and `--shift 37 --extsize 73` for ATAC-seq. Is one option more appropriate? Is there another setting I should be using?
",igordot,https://github.com/macs3-project/MACS/issues/145
MDU6SXNzdWUxNzQ5OTkzODQ=,ValueError: cannot resize this array: it does not own its data,CLOSED,2016-09-05T05:45:41Z,2024-11-13T17:59:44Z,2024-11-13T17:59:43Z,"I am invoking macs2 like this: `time macs2 callpeak -t paired.srtd.bam --outdir out2`.
This is on asorted bam file containing paired end data.
I am using `macs2 2.1.1.20160309`.
This leads to an error `ValueError: cannot resize this array: it does not own its data`:
How can I proceed from here? I would like to call peaks on this bam file.

> Traceback (most recent call last):
>   File ""/usr/local/bin/macs2"", line 617, in <module>
>     main()
>   File ""/usr/local/bin/macs2"", line 57, in main
>     run( args )
>   File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak_cmd.py"", line 264, in run
>     peakdetect.call_peaks()
>   File ""MACS2/PeakDetect.pyx"", line 110, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1665)
>   File ""MACS2/PeakDetect.pyx"", line 364, in MACS2.PeakDetect.PeakDetect.__call_peaks_wo_control (MACS2/PeakDetect.c:4714)
>   File ""MACS2/IO/CallPeakUnit.pyx"", line 861, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12334)
>   File ""MACS2/IO/CallPeakUnit.pyx"", line 915, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12086)
>   File ""MACS2/IO/CallPeakUnit.pyx"", line 970, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__chrom_call_peak_using_certain_criteria (MACS2/IO/CallPeakUnit.c:12492)
>   File ""MACS2/IO/CallPeakUnit.pyx"", line 475, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__pileup_treat_ctrl_a_chromosome (MACS2/IO/CallPeakUnit.c:6861)
> ValueError: cannot resize this array: it does not own its data
",antonkratz,https://github.com/macs3-project/MACS/issues/146
MDU6SXNzdWUxNzUxMDM1NzE=,issue with macs2 pileup,CLOSED,2016-09-05T16:38:35Z,2016-09-06T04:26:05Z,2016-09-06T04:26:05Z,"Hi Tao,

When i use 'macs2 pileup' to extend reads in both direction, the read extension does not happen as expected. For example, 

Sample BED file:
chr1    434     875     M00385:76:000000000-ABWJ2:1:1101:4790:17551/1   26      -
chr1    716     831     M00385:76:000000000-ABWJ2:1:1114:23574:10834    15      -
chr1    721     836     M00385:76:000000000-ABWJ2:1:1109:24833:15562    34      -
chr1    739     899     M00385:76:000000000-ABWJ2:1:2104:12739:2217     17      +
chr1    743     854     M00385:76:000000000-ABWJ2:1:2109:14706:8188     11      -
chr1    743     905     M00385:76:000000000-ABWJ2:1:1114:3235:13224     15      +
chr1    842     1282    M00385:76:000000000-ABWJ2:1:2112:4505:18341/2   12      -
chr1    874     1314    M00385:76:000000000-ABWJ2:1:2102:15305:25550/1  12      -
chr1    1001    1343    M00385:76:000000000-ABWJ2:1:1113:16010:19701    11      +
chr1    1027    1108    M00385:76:000000000-ABWJ2:1:1101:10141:19169    30      +

macs2 pileup: `(macs2 pileup -i T2_Input_S1_L001_trimmed_CP_UP_rname_sorted_se_pe_extende_frag.bed -B --extsize 500 -o d_500.bdg)`
chr1    0       239     0.00000
chr1    239     243     1.00000
chr1    243     331     2.00000
chr1    331     336     3.00000
chr1    336     354     4.00000
chr1    354     375     5.00000
chr1    375     501     6.00000
chr1    501     527     7.00000
chr1    527     529     8.00000
chr1    529     530     9.00000

Shouldn't the pileup start from the first record (read on -ve stradn) as ""chr1 375 1375"" ?

Appreciate your help!

Thanks,
Aarthi
",aarthi-mohan,https://github.com/macs3-project/MACS/issues/147
MDU6SXNzdWUxNzUyNjk1NTI=,Please include the tempdir option in help file,CLOSED,2016-09-06T14:58:07Z,2016-09-28T03:43:29Z,2016-09-28T03:43:29Z,"Using MACS on a shared HPC environment, it will fill up the tmp dir and result in some e-mails from the sysadmin. I see that the option exists in the callpeak_cmd.py source code and would be nice to add it to the help file and documentation as an option to redirect the temporary file write/read location.

Thanks!
",biobenkj,https://github.com/macs3-project/MACS/issues/148
MDU6SXNzdWUxNzY0NzQ4MzA=,turning off llocal and slocal lambda fails with div by 0 error,CLOSED,2016-09-12T20:23:58Z,2019-08-16T18:14:47Z,2016-09-27T15:26:04Z,"If I run macs2 without a control bam file, and turn off local lambda (setting both llocal and slocal to 0), will crash macs2 during peak call. It appears llocal is more important, as setting slocal to 0 is ok. This happens with both single and paired-end bam files. Shouldn't the genome background (which I thought is always calculated) prevent a zero from occurring in the lambda control track?

Traceback (most recent call last):
  File ""/home/BioApps/macs2/macs2"", line 4, in <module>
    **import**('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""build/bdist.linux-x86_64/egg/pkg_resources/**init**.py"", line 744, in run_script
  File ""build/bdist.linux-x86_64/egg/pkg_resources/**init**.py"", line 1506, in run_script
  File ""/home/BioApps/python2.7.8/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>

  File ""/home/BioApps/python2.7.8/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 57, in main

  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 264, in run
  File ""MACS2/PeakDetect.pyx"", line 110, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1665)
  File ""MACS2/PeakDetect.pyx"", line 321, in MACS2.PeakDetect.PeakDetect.__call_peaks_wo_control (MACS2/PeakDetect.c:3819)
ZeroDivisionError: float division by zero
",tjparnell,https://github.com/macs3-project/MACS/issues/150
MDU6SXNzdWUxNzg4NTY2Mzk=,Filter on p-value works in opposite way,CLOSED,2016-09-23T11:48:11Z,2017-03-22T19:56:29Z,2016-10-25T07:14:52Z,"When using q-value to filter peak detection (default), the lower the value the smaller is the final peak set. When using p-value, instead, the opposite happens: the lower the p-value the larger is the final peak set, suggesting that p-value filter is acting on the left tail of the distribution. The odd behaviour can be easily reproduced using test data shipped with MACS code:

p = 0.05

```
$ macs2 callpeak -t CTCF_ChIP_200K.bed.gz -g hs -n test_p05 -p 0.05
$ wc -l test_p05_peaks.narrowPeak
    61644 test_p05_peaks.narrowPeak
```

p = 0.01

```
$ macs2 callpeak -t CTCF_ChIP_200K.bed.gz -g hs -n test_p01 -p 0.01
$ wc -l test_p01_peaks.narrowPeak
    113888 test_p01_peaks.narrowPeak
```

p = 0.99

```
$ macs2 callpeak -t CTCF_ChIP_200K.bed.gz -g hs -n test_p99 -p 0.99
$ wc -l test_p99_peaks.narrowPeak
    23 test_p99_peaks.narrowPeak
```

default (q = 0.05)

```
$ macs2 callpeak -t CTCF_ChIP_200K.bed.gz -g hs -n test
$ wc -l test_peaks.narrowPeak
    5985 test_peaks.narrowPeak
```

q = 0.01

```
$ macs2 callpeak -t CTCF_ChIP_200K.bed.gz -g hs -n test -q 0.01
$ wc -l test_peaks.narrowPeak
    2435 test_peaks.narrowPeak
```
",dawe,https://github.com/macs3-project/MACS/issues/151
MDU6SXNzdWUxNzk3MjQ0MTg=,link to download PeakSplitter ,CLOSED,2016-09-28T09:34:28Z,2017-03-23T03:05:26Z,2016-09-29T15:21:03Z,"Hi, 

I've faced a problem when I try to use --call-subpeaks​

The ERROR file gave me the warning like this:  
ERROR:root:Please download PeakSplitter from http://www.ebi.ac.uk/bertone/software/PeakSplitter_Cpp.tar.gz.

When I tried to download the PeakSplitter_Cpp.tar.gz, this link was failed. For it seems like the website has moved this software to another place, shown below:
http://www.ebi.ac.uk/sites/ebi.ac.uk/files/groups/bertone/software/PeakSplitter_Cpp_1.0.tar.gz
",dorothyzh,https://github.com/macs3-project/MACS/issues/152
MDU6SXNzdWUxODA2NDAzODA=,local variable 'dup_locs' referenced before assignment,OPEN,2016-10-03T13:28:57Z,2016-11-12T13:32:37Z,,"Hi there

I am a macs2 newbie and I am not sure if this is a macs2 problem or something upstream, but perhaps somebody can guide me in the right direction. 

I ran macs2 on several treatment samples using matched control samples, and they all ran fine except for this particular case where I get the following error:

<pre>
INFO  @ Mon, 03 Oct 2016 12:31:30:  70000000 
INFO  @ Mon, 03 Oct 2016 12:33:32: #1 mean fragment size is determined as 144 bp from treatment 
INFO  @ Mon, 03 Oct 2016 12:33:32: #1 fragment size = 144 
INFO  @ Mon, 03 Oct 2016 12:33:32: #1  total fragments in treatment: 194500190 
INFO  @ Mon, 03 Oct 2016 12:33:32: #1 user defined the maximum fragments... 
INFO  @ Mon, 03 Oct 2016 12:33:32: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
Traceback (most recent call last):
  File ""/exports/igmm/software/pkg/el7/apps/bcbio/20160916/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""/exports/igmm/software/pkg/el7/apps/bcbio/share2/anaconda/lib/python2.7/site-packages/setuptools-20.3-py2.7.egg/pkg_resources/__init__.py"", line 726, in run_script
  File ""/exports/igmm/software/pkg/el7/apps/bcbio/share2/anaconda/lib/python2.7/site-packages/setuptools-20.3-py2.7.egg/pkg_resources/__init__.py"", line 1491, in run_script
  File ""/exports/igmm/software/pkg/el7/apps/bcbio/share2/anaconda/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>
    
  File ""/exports/igmm/software/pkg/el7/apps/bcbio/share2/anaconda/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 57, in main
    
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 103, in run
  File ""MACS2/IO/PairedEndTrack.pyx"", line 354, in MACS2.IO.PairedEndTrack.PETrackI.separate_dups (MACS2/IO/PairedEndTrack.c:5775)
UnboundLocalError: local variable 'dup_locs' referenced before assignment
</pre>


The command I used to run this is <pre>
macs2 callpeak -t $basedir/$file1.bam $basedir/$file2.bam -n $samp1_$samp2 --outdir $outdir -B --SPMR -g hs -f BAMPE --call-summits
</pre>

The job was run twice and got the same error. Sadly searching for it in google didn't return much. The input bam files look ok (and were generated the same way as the others). 

I would appreciate any thoughts as to what you might think can cause this error. 

Many thanks
vicky
",vsvinti,https://github.com/macs3-project/MACS/issues/153
MDU6SXNzdWUxODI2MTIwNzQ=,MACS2 ImportError: No module named filterdup_cmd,CLOSED,2016-10-12T19:26:07Z,2016-10-13T00:14:31Z,2016-10-13T00:14:31Z,"I keep getting the following error when using MACS2:
Input: macs2 filterdup -i 1.sam -o 1.filter.sam
output:
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 617, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 88, in main
    from MACS2.filterdup_cmd import run
ImportError: No module named filterdup_cmd

I've tried uninstalling, reinstalling, etc etc - nothing works. Also verified filterdup is present.

Please help.
",Phil-T,https://github.com/macs3-project/MACS/issues/154
MDU6SXNzdWUxODI2Mzc0OTI=,MACS2 can't find python files after fresh conda install,OPEN,2016-10-12T21:21:56Z,2019-04-08T20:02:45Z,,"I install `macs2` using `conda` and `which` can find it, but MACS2 throws errors when I try to run it about not being able to find files.

```
balter@server:~$ conda install macs2
Fetching package metadata ...........
Solving package specifications: ..........

Package plan for installation in environment <server path>/users/balter/miniconda2:

The following NEW packages will be INSTALLED:

    macs2: 2.1.1.20160309-r3.2.2_0 bioconda

Proceed ([y]/n)? y

Linking packages ...
[      COMPLETE      ]|###########################################################################################| 100%
balter@server:~$ which macs2
<server path>/users/balter/miniconda2/bin/macs2
balter@server:~$ macs2 -h
Traceback (most recent call last):
  File ""<server path>/users/balter/miniconda2/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""<server path>/users/balter/miniconda2/lib/python2.7/site-packages/setuptools-23.0.0-py2.7.egg/pkg_resources/__init__.py"", line 719, in run_script
  File ""<server path>/users/balter/miniconda2/lib/python2.7/site-packages/setuptools-23.0.0-py2.7.egg/pkg_resources/__init__.py"", line 1496, in run_script
pkg_resources.ResolutionError: No script named 'macs2'
balter@server:~$ macs2 --version
Traceback (most recent call last):
  File ""<server path>/users/balter/miniconda2/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""<server path>/users/balter/miniconda2/lib/python2.7/site-packages/setuptools-23.0.0-py2.7.egg/pkg_resources/__init__.py"", line 719, in run_script
  File ""<server path>/users/balter/miniconda2/lib/python2.7/site-packages/setuptools-23.0.0-py2.7.egg/pkg_resources/__init__.py"", line 1496, in run_script
pkg_resources.ResolutionError: No script named 'macs2'
```

I'm wondering if it has something to do with my python path settings. Here they are:

```
balter@server:~$ grep -i python* .bashrc
# Python environment variables
export PYTHONLIB=""<server path>/users/balter/miniconda2/lib""
export PYTHONPATH=""<server path>/users/balter/miniconda2/lib/python2.7/site-packages""
export PYTHONUSERBASE=""<server path>/users/balter/miniconda2""

balter@server:~$ grep -i path .bashrc
# Custom PATH variable
export PATH=""/bin:/usr/local/bin:/usr/bin:/opt/condor/bin:<server path>/CompBio/bin""
export PATH=""<server path>/users/balter/miniconda2/bin:$PATH""
```

Cross-posted here:
https://www.biostars.org/p/216312/
and here:
http://stackoverflow.com/questions/40008344/macs2-python-files-not-found-after-clean-install-with-conda
",abalter,https://github.com/macs3-project/MACS/issues/155
MDU6SXNzdWUxODI2NDU3NDY=,Question about calling differential binding events,OPEN,2016-10-12T22:04:03Z,2018-10-29T17:31:47Z,,"Hi there,

Macs2 is a great software and I used macs2 bdgdiff to call differential binding events of RNA polymerase ii following this link: https://github.com/taoliu/MACS/wiki/Call-differential-binding-events

I have two questions.I got three output files including diff_c1_vs_c2_c3.0_common.bed, diff_c1_vs_c2_c3.0_cond1.bed and diff_c1_vs_c2_c3.0_cond2.bed. But all the values in the last column of diff_c1_vs_c2_c3.0_common.bed are more than 0. As that link mentioned, the values are in log10 likelihood ratios, so some values should be negative value unless all the binding regions in this file enriched in condition 1 comparing to condition 2. In my observation, most binding regions are enriched in condition2 and most values are less than 1. In this case, I guess these values might be not in log10 likelihood ratios. Are these values really in log10?

After I get these values, I would like to do pathway analysis. I will annotate these regions by HOMER to obtain gene names. Then if these values are not in log10, is it okay to use log10(1/cond1_value), log10(1/common_value) and log10(cond2_value) with their gene names to do the pathway analysis?

Thanks,

Yunpeng
",toxin08x,https://github.com/macs3-project/MACS/issues/156
MDU6SXNzdWUxODQyNjA0Nzg=,ATAC macs14 peak calling ,OPEN,2016-10-20T15:22:17Z,2024-11-13T17:54:54Z,,"I am facing following error while using macs14
**Command used** : macs14 -t test.bam -c control.bam 
**Error**
# ARGUMENTS LIST:
# name = NA
# format = AUTO
# ChIP-seq file =text4.bam
# control file = control.bam
# effective genome size = 2.70e+09
# band width = 300
# model fold = 10,30
# pvalue cutoff = 1.00e-05
# Large dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps

INFO  @ Thu, 20 Oct 2016 17:18:49: #1 read tag files... 
INFO  @ Thu, 20 Oct 2016 17:18:49: #1 read treatment tags... 
INFO  @ Thu, 20 Oct 2016 17:18:49: Detected format is: BAM 
INFO  @ Thu, 20 Oct 2016 17:18:52: tag size: 50 
INFO  @ Thu, 20 Oct 2016 17:18:59:  1000000 
INFO  @ Thu, 20 Oct 2016 17:19:05:  2000000 
INFO  @ Thu, 20 Oct 2016 17:19:10:  3000000 
INFO  @ Thu, 20 Oct 2016 17:19:15:  4000000 
INFO  @ Thu, 20 Oct 2016 17:19:20:  5000000 
INFO  @ Thu, 20 Oct 2016 17:19:25:  6000000 
INFO  @ Thu, 20 Oct 2016 17:19:30:  7000000 
INFO  @ Thu, 20 Oct 2016 17:19:35:  8000000 
INFO  @ Thu, 20 Oct 2016 17:19:40:  9000000 
INFO  @ Thu, 20 Oct 2016 17:19:45:  10000000 
INFO  @ Thu, 20 Oct 2016 17:19:50:  11000000 
INFO  @ Thu, 20 Oct 2016 17:19:55:  12000000 
INFO  @ Thu, 20 Oct 2016 17:20:01:  13000000 
INFO  @ Thu, 20 Oct 2016 17:20:06:  14000000 
INFO  @ Thu, 20 Oct 2016 17:20:11:  15000000 
INFO  @ Thu, 20 Oct 2016 17:20:16:  16000000
Traceback (most recent call last):
  File ""/usr/local/bin/macs14"", line 366, in <module>
    main()
  File ""/usr/local/bin/macs14"", line 60, in main
    (treat, control) = load_tag_files_options (options)
  File ""/usr/local/bin/macs14"", line 338, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""/usr/local/lib/python2.7/dist-packages/MACS14/IO/Parser.py"", line 812, in build_fwtrack
    (chrid,fpos,strand) = self.__fw_binary_parse(fread(entrylength))  
  File ""/usr/lib/python2.7/gzip.py"", line 268, in read
    self._read(readsize)
  File ""/usr/lib/python2.7/gzip.py"", line 332, in _read
    self._read_eof()
  File ""/usr/lib/python2.7/gzip.py"", line 354, in _read_eof
    hex(self.crc)))
IOError: CRC check failed 0xbf9b068b != 0x7494add5L

Can any one help me to solve this, I have no ideas what is wrong , I have used the same command before and it worked fine 
",catch-minie,https://github.com/macs3-project/MACS/issues/157
MDU6SXNzdWUxODQzNzI2NTQ=, Build local bias track from control step two,CLOSED,2016-10-21T00:26:10Z,2017-03-22T16:45:26Z,2017-03-22T16:45:26Z,"Hi,
I was able to follow this pipeline up to 
Step 4: Build local bias track from control step two

step 1 successful:
macs2 pileup -i INPUTB-N1_sorted.bed -B --extsize 36 -o INPUTB-N1_sorted.bed_d_bg.bdg

output 
INFO  @ Thu, 20 Oct 2016 16:12:45: tag size is determined as 75 bps 
INFO  @ Thu, 20 Oct 2016 16:12:45: # tag size = 75 
INFO  @ Thu, 20 Oct 2016 16:12:45: # total tags in alignment file: 69619356 
INFO  @ Thu, 20 Oct 2016 16:12:45: # Pileup alignment file, extend each read towards up/downstream direction with 36 bps 
INFO  @ Thu, 20 Oct 2016 16:14:32: # Done! Check INPUTB-N1_sorted.bed_d_bg.bdg 

Step 2 The slocal background: successful
macs2 pileup -i INPUTB-N1_sorted.bed -B --extsize 500 -o INPUTB-N1_sorted.bed_1k_bg.bdg

output 
INFO  @ Thu, 20 Oct 2016 16:35:55: tag size is determined as 75 bps 
INFO  @ Thu, 20 Oct 2016 16:35:55: # tag size = 75 
INFO  @ Thu, 20 Oct 2016 16:35:55: # total tags in alignment file: 69619356 
INFO  @ Thu, 20 Oct 2016 16:35:55: # Pileup alignment file, extend each read towards up/downstream direction with 500 bps 
INFO  @ Thu, 20 Oct 2016 16:38:06: # Done! Check INPUTB-N1_sorted.bed_1k_bg.bdg

step3 normalized: not successful
macs2 bdgopt -i INPUTB-N1_sorted.bed_1k_bg.bdg -m multiply -p 0.072 -o INPUTB-N1_sorted_1k_bg_norm.bdg

( fragment length was determined to be 72bp I did 72/1000 = 0.072)

Error:

INFO  @ Thu, 20 Oct 2016 16:57:02: Read and build bedGraph... 
INFO  @ Thu, 20 Oct 2016 17:00:15: Modify bedGraph... 
Traceback (most recent call last):
  File ""/share/apps/python2.7.6/bin/macs2"", line 5, in <module>
    pkg_resources.run_script('MACS2==2.1.0.20150731', 'macs2')
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/distribute-0.6.28-py2.7.egg/pkg_resources.py"", line 499, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/distribute-0.6.28-py2.7.egg/pkg_resources.py"", line 1239, in run_script
    execfile(script_filename, namespace, namespace)
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 616, in <module>
    main()
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 78, in main
    run( args )  
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/bdgopt_cmd.py"", line 58, in run
    btrack.apply_func( lambda x: x \* options.extraparam)
  File ""MACS2/IO/BedGraph.pyx"", line 830, in MACS2.IO.BedGraph.bedGraphTrackI.apply_func (MACS2/IO/BedGraph.c:11540)
TypeError: 'float' object has no attribute '**getitem**'
[alerodri@compute-0-15 macs2_advancedresults]$ /share/apps/python2.7.6/bin/macs2 bdgopt -i /home/alerodri/ChIPSeq-RORA/sam_UCSC/macs2_advancedresults/combined-C-INPUTB-N1_sorted.bed_1k_bg.bdg -m multiply -p 0.072 -o /home/alerodri/ChIPSeq-RORA/sam_UCSC/macs2_advancedresults/combined-C-INPUTB-N1_sorted_1k_bg_norm.bdg
INFO  @ Thu, 20 Oct 2016 17:05:23: Read and build bedGraph... 
INFO  @ Thu, 20 Oct 2016 17:08:39: Modify bedGraph... 
Traceback (most recent call last):
  File ""/share/apps/python2.7.6/bin/macs2"", line 5, in <module>
    pkg_resources.run_script('MACS2==2.1.0.20150731', 'macs2')
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/distribute-0.6.28-py2.7.egg/pkg_resources.py"", line 499, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/distribute-0.6.28-py2.7.egg/pkg_resources.py"", line 1239, in run_script
    execfile(script_filename, namespace, namespace)
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 616, in <module>
    main()
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 78, in main
    run( args )  
  File ""/share/apps/python2.7.6/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/bdgopt_cmd.py"", line 58, in run
    btrack.apply_func( lambda x: x \* options.extraparam)
  File ""MACS2/IO/BedGraph.pyx"", line 830, in MACS2.IO.BedGraph.bedGraphTrackI.apply_func (MACS2/IO/BedGraph.c:11540)
TypeError: 'float' object has no attribute '**getitem**'

Please help,
thanks!
",ale07alvarez,https://github.com/macs3-project/MACS/issues/158
MDU6SXNzdWUxODY3MTk4ODY=,pvalue cutoff and qvalue cutoff,CLOSED,2016-11-02T06:06:10Z,2024-11-13T17:54:27Z,2024-11-13T17:54:27Z,"Dear, tao,

     I have a question about the output files: ""NAME_peaks.xls"" ""NAME_peaks.narrowPeak"".  
     Is it true that when **pvalue** cutoff was specified, then the ""qvalue"" will not be calculated and should be reported as ""-1"" in the final outpu, such as  ""NAME_peaks.xls"" ""NAME_peaks.narrowPeak""?
     But, in my test, the **pvalue** was specified, however, in the output files, there were still show ""-log10(qvalue)"" which is not reported as ""-1"".   Actually, the results seems no differents from ""qvalue"" cutoff was specified in form.

Thank you very much for all your help,
Ling.",liulingnovo,https://github.com/macs3-project/MACS/issues/159
MDU6SXNzdWUxODkxMDY3NzM=,possible --call-troughs option,CLOSED,2016-11-14T13:01:29Z,2024-11-13T17:53:53Z,2024-11-13T17:53:53Z,"Hi Tao,

Apologies if this is not the correct place to post a function request, but I'm not sure whether people are still visiting the macs google user group.

https://groups.google.com/forum/#!topic/macs-announcement/m6JXYMDeiRA

Aa suggested in the goole thread above, do you think you could implement a --call-troughs option, which is similar to --call-summits but to find the local minima? I think this will be very helpful for histone chip-seq, since regulatory elements tend to be located in the ""dip"" regions within the called peaks.

Thank you.

Regards,
Xi",dbrg77,https://github.com/macs3-project/MACS/issues/160
MDU6SXNzdWUxODk2MjA4MzM=,Call differential binding events with replicates,CLOSED,2016-11-16T07:50:51Z,2024-11-13T17:53:30Z,2024-11-13T17:53:30Z,"Hi taoliu,

I have two H3K27Ac chip-seq biological duplicates for treated and untreated groups, but no input at all.
There are two different methods mentioned in wiki, [Run MACS2 combining replicates](https://github.com/taoliu/MACS/wiki/Build-Signal-Track#run-macs2-combining-replicates) simply merges two samples for each condition. [Call differential binding events](https://github.com/taoliu/MACS/wiki/Call-differential-binding-events) doesn't take replicates into consideration. Because the samples are biological repeats, I cannot compare treated-1 with untreated-1 and treated-2 with untreated-2. Could you please tell me what would be the best method for this situation?
Thanks you very much.",atbest,https://github.com/macs3-project/MACS/issues/161
MDU6SXNzdWUxODk2NTk4NzY=,How to normalize the output.bdg,CLOSED,2016-11-16T10:31:07Z,2024-11-13T18:05:20Z,2024-11-13T18:05:20Z,"Hi taoliu,
     Dose the macs2 normalize the values in pileup.bdg ? 
    Thanks you very much.",JingxinGuo,https://github.com/macs3-project/MACS/issues/162
MDU6SXNzdWUxOTIyMDQ3MTY=,Error with --keep-dup,OPEN,2016-11-29T07:09:49Z,2017-03-22T15:18:48Z,,"Dear Tao,

I tried to use --keep-dup all and got this error:

INFO  @ Sat, 12 Nov 2016 12:10:38: #3 Call peaks... 
Traceback (most recent call last):
  File ""/usr/bin/macs2"", line 370, in <module>
    main()
  File ""/usr/bin/macs2"", line 193, in main
    if t1 > c1:
UnboundLocalError: local variable 't1' referenced before assignment

My script was:
module load macs2/2.1.0.20140616
macs2 callpeak -t x.bam -c input.bam -f BAM -g hs -n x_vs_input -B --keep-dup all -q 0.01

When using --keep-all auto, I had no errors. Could you please advice re: usage for -keep-dup all?
Thanks in advance,
Pauli",paulicm-UCD,https://github.com/macs3-project/MACS/issues/163
MDU6SXNzdWUxOTI1Mjg4ODk=,How to convert bedGraph file from macs2 to wig file for ceas analysis? ,CLOSED,2016-11-30T10:29:13Z,2024-11-13T18:05:39Z,2024-11-13T18:05:39Z,"Hi Liu,
  
      macs1.4 can build the wig file for ceas analysis while macs2 not, so how to convert bdg file from macs2 to wig file for ceas?

       Thank you!

Yongzhen  CAU",Yongzhen1204,https://github.com/macs3-project/MACS/issues/164
MDU6SXNzdWUxOTQzODA1MzU=,MACS2 default q-value cutoff,CLOSED,2016-12-08T16:26:29Z,2024-11-13T18:05:58Z,2024-11-13T18:05:58Z,"I am using MACS2 version: `macs2 2.1.0.20150731`. The documentation on macs2 --help says that the default q-value cut off is 0.05. But your documentation page here says it is 0.01. Can you clarify which is correct?

",komalsrathi,https://github.com/macs3-project/MACS/issues/165
MDU6SXNzdWUxOTQ4MTIwNzA=,macs2 callpeak error: ValueError: read length must be positive or -1,CLOSED,2016-12-11T04:25:41Z,2024-11-13T18:11:37Z,2024-11-13T18:11:36Z,"Hi,

I use macs2 to peak call ATAC-Seq 40 bp paired-end reads, and get an error message: ValueError: read length must be positive or -1 (the detail as the below). Could you help me? Many thanks.

Best,

Gary

gary > macs2 callpeak -t RA_G7_7_woChrM.bam --format AUTO --gsize 930000000 --keep-dup 1 --outdir RA_G7_7_woChrM --name RA_G7_7_woChrM --verbose 3 --nomodel --shift 50 --extsize 100 --qvalue 0.00000001 --cutoff-analysis --call-summits
INFO  @ Sat, 10 Dec 2016 13:33:18: 
# Command line: callpeak -t RA_G7_7_woChrM.bam --format AUTO --gsize 930000000 --keep-dup 1 --outdir RA_G7_7_woChrM --name RA_G7_7_woChrM --verbose 3 --nomodel --shift 50 --extsize 100 --qvalue 0.00000001 --cutoff-analysis --call-summits
# ARGUMENTS LIST:
# name = RA_G7_7_woChrM
# format = AUTO
# ChIP-seq file = ['RA_G7_7_woChrM.bam']
# control file = None
# effective genome size = 9.30e+08
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 1.00e-08
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Searching for subpeak summits is on
 
INFO  @ Sat, 10 Dec 2016 13:33:18: #1 read tag files... 
INFO  @ Sat, 10 Dec 2016 13:33:18: #1 read treatment tags... 
DEBUG @ Sat, 10 Dec 2016 13:33:18: Testing format BAM 
INFO  @ Sat, 10 Dec 2016 13:33:18: Detected format is: BAM 
INFO  @ Sat, 10 Dec 2016 13:33:18: * Input file is gzipped. 
INFO  @ Sat, 10 Dec 2016 13:33:22:  1000000 
INFO  @ Sat, 10 Dec 2016 13:33:26:  2000000 
INFO  @ Sat, 10 Dec 2016 13:33:30:  3000000 
INFO  @ Sat, 10 Dec 2016 13:33:35:  4000000 
INFO  @ Sat, 10 Dec 2016 13:33:39:  5000000 
INFO  @ Sat, 10 Dec 2016 13:33:44:  6000000 
INFO  @ Sat, 10 Dec 2016 13:33:48:  7000000 
INFO  @ Sat, 10 Dec 2016 13:33:53:  8000000 
INFO  @ Sat, 10 Dec 2016 13:33:57:  9000000 
INFO  @ Sat, 10 Dec 2016 13:34:02:  10000000 
INFO  @ Sat, 10 Dec 2016 13:34:07:  11000000 
INFO  @ Sat, 10 Dec 2016 13:34:11:  12000000 
INFO  @ Sat, 10 Dec 2016 13:34:15:  13000000 
INFO  @ Sat, 10 Dec 2016 13:34:20:  14000000 
INFO  @ Sat, 10 Dec 2016 13:34:24:  15000000 
INFO  @ Sat, 10 Dec 2016 13:34:29:  16000000 
INFO  @ Sat, 10 Dec 2016 13:34:33:  17000000 
INFO  @ Sat, 10 Dec 2016 13:34:38:  18000000 
INFO  @ Sat, 10 Dec 2016 13:34:42:  19000000 
INFO  @ Sat, 10 Dec 2016 13:34:46:  20000000 
INFO  @ Sat, 10 Dec 2016 13:34:50:  21000000 
INFO  @ Sat, 10 Dec 2016 13:34:53:  22000000 
INFO  @ Sat, 10 Dec 2016 13:34:57:  23000000 
INFO  @ Sat, 10 Dec 2016 13:35:01:  24000000 
INFO  @ Sat, 10 Dec 2016 13:35:05:  25000000 
INFO  @ Sat, 10 Dec 2016 13:35:10:  26000000 
INFO  @ Sat, 10 Dec 2016 13:35:14:  27000000 
INFO  @ Sat, 10 Dec 2016 13:35:18:  28000000 
INFO  @ Sat, 10 Dec 2016 13:35:22:  29000000 
INFO  @ Sat, 10 Dec 2016 13:35:26:  30000000 
INFO  @ Sat, 10 Dec 2016 13:35:30:  31000000 
INFO  @ Sat, 10 Dec 2016 13:35:34:  32000000 
INFO  @ Sat, 10 Dec 2016 13:35:38:  33000000 
INFO  @ Sat, 10 Dec 2016 13:35:42:  34000000 
INFO  @ Sat, 10 Dec 2016 13:35:46:  35000000 
INFO  @ Sat, 10 Dec 2016 13:35:51:  36000000 
INFO  @ Sat, 10 Dec 2016 13:35:55:  37000000 
INFO  @ Sat, 10 Dec 2016 13:35:59:  38000000 
Traceback (most recent call last):
  File ""/Users/gary/anaconda/bin/macs2"", line 614, in <module>
    main()
  File ""/Users/gary/anaconda/bin/macs2"", line 56, in main
    run( args )
  File ""/Users/gary/anaconda/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 70, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/Users/gary/anaconda/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 396, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""MACS2/IO/Parser.pyx"", line 805, in MACS2.IO.Parser.BAMParser.build_fwtrack (MACS2/IO/Parser.c:11351)
  File ""MACS2/IO/Parser.pyx"", line 810, in MACS2.IO.Parser.BAMParser.build_fwtrack (MACS2/IO/Parser.c:11218)
  File ""MACS2/IO/Parser.pyx"", line 877, in MACS2.IO.Parser.BAMParser.__build_fwtrack_wo_pysam (MACS2/IO/Parser.c:12358)
ValueError: read length must be positive or -1",YungChihLai,https://github.com/macs3-project/MACS/issues/166
MDU6SXNzdWUxOTYwMDAzNTA=,Negative peak candidates from MACS2,CLOSED,2016-12-16T07:53:21Z,2024-11-13T18:06:53Z,2024-11-13T18:06:53Z,"Hello @taoliu !

Recently, I've done a chip-seq project. In that I've to treat one of the sample as control that's not IgG/Input. So I wanted to get peaks that were both over expressed & under expressed in sample as compared to this control. In other words, I wanted 'negative peaks' also. Below is the command for it :

macs2 callpeak -f BAMPE -t @chip1 -c @control1 -g $org -n $input_path/results1/macs2/G'$itr'_C1_T1_broad_peaks -B --mfold -60 60 --broad --broad-cutoff 0.1 --bw 300 --buffer-size 100000 --qvalue 0.05 --slocal 1000 --llocal 10000 --cutoff-analysis --fe-cutoff 1.0

As written in README file :
'-n/--name
The name string of the experiment. MACS will use this string NAME to create output files like 'NAME_peaks.xls', 'NAME_negative_peaks.xls'..'  MACS2 will give me negative_peaks.xls. But it didn't gave any negative peaks for me. 

I saw in 'PeakDetect.pyx' this :

    #     self.info(""#3 diag: call negative peak candidates"")
    #     negative_peak_candidates = self.__call_peaks_from_trackI (self.control)

Is it that MACS2 doesn't call for negative peaks whereas MACS1.4 does? 
If so, do I need to swap control & sample manually & then run MACS2 for negative peaks?

Please help me out.

Thank you in advance!

-Anupriya Verma",Anupriya014,https://github.com/macs3-project/MACS/issues/167
MDU6SXNzdWUxOTYzNTc1MTM=,Genome background when --nolambda is set,CLOSED,2016-12-19T08:36:54Z,2024-11-13T18:30:09Z,2024-11-13T18:30:08Z,"Hi, 

In my quest to understand the fixed background used when --nolambda is set, I came across this very useful wiki about subcommands in MACS2 (https://github.com/taoliu/MACS/wiki/Advanced%3A-Call-peaks-using-MACS2-subcommands). So to my understanding, when --nolambda is set, the following genome background is used:

> The genome background
> 
> The whole genome background can be calculated as the number of control reads/genome size*fragment length, and in our example, it is 199867*254/2700000000 ~= .0188023. You don't need to run subcommands to build a genome background track since it's just a single value. 

And if no control is available, the genome background is estilmated using the IP reads, right? 

PS. I think the definition is not consistant with the numerical example, it should be:
(number of control reads* fragment lengh )/genome size 

",akramdi,https://github.com/macs3-project/MACS/issues/168
MDU6SXNzdWUxOTY0Mjk1ODE=,MACS2 error compilation ,CLOSED,2016-12-19T14:41:45Z,2019-10-03T19:11:17Z,2019-10-03T19:11:17Z,"Hi, I have problems to run macs2, when I compile the script, I have the next error 

Traceback (most recent call last):
  File ""/home/projas/MACS2-2.1.1.20160309/bin/macs2"", line 617, in <module>
    main()
  File ""/home/projas/MACS2-2.1.1.20160309/bin/macs2"", line 56, in main
    from MACS2.callpeak_cmd import run
  File ""/home/projas/MACS2-2.1.1.20160309/MACS2/callpeak_cmd.py"", line 31, in <module>
    from MACS2.OptValidator import opt_validate
  File ""/home/projas/MACS2-2.1.1.20160309/MACS2/OptValidator.py"", line 204
    options.argtxt += ""# Using a custom scaling factor: %.2e\n"" % (options.ratio)
                                                                                ^
TabError: inconsistent use of tabs and spaces in indentationTraceback (most recent call last):
  File ""/home/projas/MACS2-2.1.1.20160309/bin/macs2"", line 617, in <module>
    main()
  File ""/home/projas/MACS2-2.1.1.20160309/bin/macs2"", line 56, in main
    from MACS2.callpeak_cmd import run
  File ""/home/projas/MACS2-2.1.1.20160309/MACS2/callpeak_cmd.py"", line 31, in <module>
    from MACS2.OptValidator import opt_validate
  File ""/home/projas/MACS2-2.1.1.20160309/MACS2/OptValidator.py"", line 204
    options.argtxt += ""# Using a custom scaling factor: %.2e\n"" % (options.ratio)
                                                                                ^
TabError: inconsistent use of tabs and spaces in indentation


any help? ",rojasp,https://github.com/macs3-project/MACS/issues/169
MDU6SXNzdWUxOTk5Mjc5NjU=,MACS2 segmentation fault due to chromosome names,OPEN,2017-01-10T20:40:00Z,2017-03-22T16:16:42Z,,"Hi, I just wanted to let you know that MACS2 failed to finish when reference chromosome names contain symbols (e.g. `2L52.1a:gene=WBGene00007063`, `ZK856.2:type=Transposon-mRNA:gene=WBGene00023448`, etc). It stops right after `#3 Pre-compute pvalue-qvalue table`. I used BED for the run.",jnktsj,https://github.com/macs3-project/MACS/issues/170
MDU6SXNzdWUyMDE0MjAyODA=,AssertionError: slocal can't be smaller than d!,OPEN,2017-01-17T22:10:20Z,2017-01-19T02:19:30Z,,"Greetings,

(Googling around wasn't too helpful, so I hope posting here is appropriate).

I'm trying to run a ""simple"" MACS2 job (MACS2 2.1.0 20150420 rc):
```
macs2 callpeak \
--name 'HA vs. WT' \
--treatment $CHIPDATA1 \
--control $CHIPCTRL1 \
--outdir $DIRECTORY \
--qvalue .01 \
--format BAMPE \
--gsize mm \
--tempdir $TMP_DIRECTORY
```
The output of the job is as follows:
```
Log -- Running PEAKCALL_MACS2 Job
Log -- =================
Log -- Created tmp directory
INFO  @ Tue, 17 Jan 2017 15:11:11: 
# Command line: callpeak --name HA vs. WT --treatment /home/user/data/Processed-Data/3259-MAM/05-samtools/Ali
gned_sample_3259-MAM-7.out.sorted.bam --control /home/user/data/Processed-Data/3259-MAM/05-samtools/Aligned_sample_32
59-MAM-8.out.sorted.bam --outdir 07-peakcall_macs2 --qvalue .01 --format BAMPE --gsize mm --tempdir 07-peakcall_macs2/te
mp
# ARGUMENTS LIST:
# name = Neurog3-HA vs. WT
# format = BAMPE
# ChIP-seq file = ['/home/user/data/Processed-Data/3259-MAM/05-samtools/Aligned_sample_3259-MAM-7.out.sorted.bam']
# control file = ['/home/user/data/Processed-Data/3259-MAM/05-samtools/Aligned_sample_3259-MAM-8.out.sorted.bam']
# effective genome size = 1.87e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 1.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is on
INFO  @ Tue, 17 Jan 2017 15:11:11: #1 read fragment files... 
INFO  @ Tue, 17 Jan 2017 15:11:11: #1 read treatment fragments... 
INFO  @ Tue, 17 Jan 2017 15:11:30:  1000000 
INFO  @ Tue, 17 Jan 2017 15:11:48:  2000000 
INFO  @ Tue, 17 Jan 2017 15:12:06:  3000000 
...
...
...
INFO  @ Tue, 17 Jan 2017 15:44:11:  42000000 
INFO  @ Tue, 17 Jan 2017 15:44:37:  43000000 
INFO  @ Tue, 17 Jan 2017 15:45:23: #1 mean fragment size is determined as 1109 bp from treatment 
INFO  @ Tue, 17 Jan 2017 15:45:24: #1 note: mean fragment size in control is 1853 bp -- value ignored 
INFO  @ Tue, 17 Jan 2017 15:45:24: #1 fragment size = 1109 
INFO  @ Tue, 17 Jan 2017 15:45:24: #1  total fragments in treatment: 42552760 
INFO  @ Tue, 17 Jan 2017 15:45:24: #1 user defined the maximum fragments... 
INFO  @ Tue, 17 Jan 2017 15:45:24: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Tue, 17 Jan 2017 15:48:03: #1  fragments after filtering in treatment: 31036085 
INFO  @ Tue, 17 Jan 2017 15:48:03: #1  Redundant rate of treatment: 0.27 
INFO  @ Tue, 17 Jan 2017 15:48:03: #1  total fragments in control: 43232586 
INFO  @ Tue, 17 Jan 2017 15:48:03: #1 user defined the maximum fragments... 
INFO  @ Tue, 17 Jan 2017 15:48:03: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Tue, 17 Jan 2017 15:50:45: #1  fragments after filtering in control: 29065439 
INFO  @ Tue, 17 Jan 2017 15:50:45: #1  Redundant rate of control: 0.33 
INFO  @ Tue, 17 Jan 2017 15:50:45: #1 finished! 
INFO  @ Tue, 17 Jan 2017 15:50:45: #2 Build Peak Model... 
INFO  @ Tue, 17 Jan 2017 15:50:45: #2 Skipped... 
INFO  @ Tue, 17 Jan 2017 15:50:45: #2 Use 1109 as fragment length 
INFO  @ Tue, 17 Jan 2017 15:50:45: #3 Call peaks... 
Traceback (most recent call last):
  File ""/home/user/bin/anaconda2/bin/macs2"", line 617, in <module>
    main()
  File ""/home/user/bin/anaconda2/bin/macs2"", line 57, in main
    run( args )
  File ""/home/user/bin/anaconda2/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 105, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1632)
  File ""MACS2/PeakDetect.pyx"", line 177, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:2163)
AssertionError: slocal can't be smaller than d!
```
Any ideas on what I might be doing wrong?  Running out of ideas... 

Thanks!!!
JP",jpcartailler,https://github.com/macs3-project/MACS/issues/171
MDU6SXNzdWUyMDI3ODgxNjI=,"""advanced MACS2 subcommands"" wiki tutorial incorrect parameter",CLOSED,2017-01-24T11:08:15Z,2024-11-13T18:07:20Z,2024-11-13T18:07:20Z,"The **""Combine and generate the maximum background noise""** section has the following commands for building background track:

> 
> Take the maximum between slocal (1k) and llocal (10k) background:
> `macs2 bdgcmp -m max -t 1k_bg_norm.bdg -c 10k_bg_norm.bdg -o 1k_10k_bg_norm.bdg
> `
> Then, take the maximum then by comparing with d background:
> `macs2 bdgcmp -m max -t 1k_10k_bg_norm.bdg -c d_bg.bdg -o d_1k_10k_bg_norm.bdg
> `
> 

However `bdgcmp -m` doesnt have the 'max' option. 

This command is designed to be finding the maximum noise of the regions, so is it supposed to be cmbreps rather than bdgcmp? In which case the line would be:

`macs2 cmbreps -m max -i 1k_bg.bdg 10k_bg.bdg -o 1k_10k_bg_norm.bdg
`
Additionally, the next command:

> Finally, combine with the genome wide background using bdgopt subcommand
> `macs2 bdgopt -i d_1k_10k_bg_norm.bdg -m max -p .0188023 -o local_bias_raw.bdg`

doesnt have a 'max' option, and should be multiply I think.

Is this correct?

https://github.com/taoliu/MACS/wiki/Advanced:-Call-peaks-using-MACS2-subcommands#combine-and-generate-the-maximum-background-noise",passdan,https://github.com/macs3-project/MACS/issues/172
MDU6SXNzdWUyMDM2OTQwOTI=,p-value or q-value cutoff of 1.0 is not possible (MACS crashes),OPEN,2017-01-27T17:31:19Z,2017-12-06T15:50:30Z,,"If `-p 1.0` or `-q 1.0` is passed to the command then MACS fails with:
`UnboundLocalError: local variable 'peaks' referenced before assignment`

Fails at PeakDetect.pyx (line 370)

The problem is in PeakDetect.pyx:

`if self.log_pvalue:` (line 346) is false when `self.log_pvalue = 0.0`

`elif self.log_qvalue:` (line 358) is false when `self.log_qvalue = 0.0`

Entering one of these two if blocks is required to enable the `peaks` variable, but since `0.0` is a valid value for -log10(1.0), it is possible to enter neither.

Since python `0.0` is equivalent to `None` as far and boolean operator goes we will have to be more specific to separate the p-value or q-value == 1.0 from their absence.

Thanks!
Adam",atsteffen,https://github.com/macs3-project/MACS/issues/173
MDU6SXNzdWUyMDYxODMwODc=,macs2 bdgdiff for calling differential binding events without control,OPEN,2017-02-08T12:21:35Z,2019-04-22T15:44:51Z,,"I had one treated sample and one non-treated sample, but without Chip-Seq mock (or background control). But I want to identify regions that are differentially histone modification between control and treated. MACS2 bdgdiff is a prefect tool to complete the differential analysis of Chip-seq between two conditions. But how could MACS2 bdgdiff identify differential peaks without ChIP-Seq control. I really appreciate your help. 
Thanks a lot!",meihl,https://github.com/macs3-project/MACS/issues/174
MDU6SXNzdWUyMDgyMDY0NDg=,q-value confusion,CLOSED,2017-02-16T18:29:38Z,2019-08-16T18:09:16Z,2019-08-16T17:34:37Z,"When I run MACS2 callpeak I use the -q function to filter for peaks with q-values less than 10^-10. However, I get more peaks when I filter for -q .01 and then manually filter for 10^-10 using the following command:
`awk '{print exp($9*-log(10));}' MACS_peaks.narrowPeak | awk '$1<10^-10'| wc -l`
Why would this be the case?",sklasfeld,https://github.com/macs3-project/MACS/issues/175
MDU6SXNzdWUyMTE0MzA5MDU=,Peak Model -- Not Smooth,CLOSED,2017-03-02T15:48:54Z,2024-11-13T18:08:02Z,2024-11-13T18:08:02Z,I was reading the MACS paper and I noticed that the example Peaks model of the bimodal peaks on each strand have smooth peaks. What does it mean if the Rscript gives me a plot of ragged peaks?,sklasfeld,https://github.com/macs3-project/MACS/issues/176
MDU6SXNzdWUyMTU2NjAxMjc=,Missing summit location when run macs2 with --broad option,OPEN,2017-03-21T08:21:13Z,2017-03-23T00:54:51Z,,"Hi,

Is there a specific option to set when run macs2 in broad mode in order to get summit location? I want to call broad peaks for histone modification, when I run the following command:

```
macs2 callpeak -t my_sample.bed -n name -g 1.4e9 --broad --broad-cutoff 0.05 --nomodel --nolambda
```

The output files don't have NAME_summits.bed and there is no column of ""absolute peak summit position"" in NAME_peaks.xls. Did I use macs2 in wrong way? 

Thanks for your help! ",AlicePsyche,https://github.com/macs3-project/MACS/issues/177
MDU6SXNzdWUyMTY0ODU3MTk=,Is there any way I can get peaks' pvalues or qvalues when I use bdgpeakcall?,CLOSED,2017-03-23T16:14:32Z,2024-11-13T18:13:21Z,2024-11-13T18:13:20Z,"Hi,

I am trying to run MACS2 step by step based on MACS2' advanced tutorial.
However, I just found that the pvalue and qvalue columns in the final bed file of peaks generated by bdgpeakcall are missing.

Is there anyway I can get these values ?
If not, is there any other way I can use to rank these peaks? (e.g. integer score for display?)

Your help will be greatly appreciated!
Chengfei Yan",ChengfeiYan,https://github.com/macs3-project/MACS/issues/178
MDU6SXNzdWUyMTgzMzk1ODk=,Q: why python 2.7 precisely?,CLOSED,2017-03-30T21:55:42Z,2019-10-03T19:09:10Z,2019-10-03T19:09:10Z,"I'm using MACS as part of my pipeline, but was surprised to find it's 2.7 only.  Not 2.6, not 2.8, not anything near python3.  I'm contemplating a port to python 3.5, but would like to ask if there is some major impediment which would complicate this process?

Thanks in advance,",lzamparo,https://github.com/macs3-project/MACS/issues/179
MDU6SXNzdWUyMTk0OTE1MjM=,bdg file to wig file transformation,CLOSED,2017-04-05T07:24:56Z,2019-12-09T06:24:13Z,2019-12-09T06:24:13Z,"Hi, I want to run the CEAS(Cis-regulatory Element Annotation System, http://liulab.dfci.harvard.edu/CEAS/usermanual.html) to annotate my result from MACS2. However, I failed.

First, I get the wig file according to  https://github.com/taoliu/MACS/wiki/Build-Signal-Track#Fix_the_bedGraph_and_convert_them_to_bigWig_files

Then, I used the bigWig file to run CEAS：ceas  -g hg19.refGene  -b treat.pilleup.summits.bed  -w FE.bw
It return: UnboundLocalError: local variable 'newchrom' referenced before assignment

I tried to transform bigWig file to wig using bigWigToWig, the error still there.

I found the final wig file that I generated is:

#bedGraph section chr1:0-13890
chr1    0    9899    0
chr1    9899    9905    0.05126
chr1    9905    9910    0.05039
..........


However, the wig file format should like this:

track type=wiggle_0
variableStep chrom=chr1 span=1
6131 3
6141 4
6151 4
6161 4
6171 4


Anybody know how to get the right wig file from MACS2 results for CEAS analysis?


Thanks",zifeng9527,https://github.com/macs3-project/MACS/issues/180
MDU6SXNzdWUyMTk1MDgxNDU=,question about wigCorrelation,CLOSED,2017-04-05T08:37:58Z,2024-11-13T18:29:45Z,2024-11-13T18:29:44Z,"I want to know the correlation of several biological replicates that are produced by chip-seq. I have used wigCorrelation to get correlation, but I don't know what the correlation is good enough.",KeyingLu,https://github.com/macs3-project/MACS/issues/181
MDU6SXNzdWUyMTk2NzUyODA=,macs2 and bowtie2 alignments,CLOSED,2017-04-05T18:32:46Z,2024-11-13T18:17:54Z,2024-11-13T18:17:54Z,"Hi!

I am trying to use macs2 to detect some TDNA insertions from resequencing data.

First I mapped treatment (T) and control (wild type, C ) PE data with bowtie2 (v 2.2.7):

```
bowtie2 --time --very-sensitive-local --local -k 2 -p ${THREADS} -x ${REF} ${LIBRARIES} -S ${LABEL}.aln.sam`
```
then I used samtools (v 1.3.1) and some bash to remove from T and C all pairs witout a mapping on the TDNA sequence. The Idea is that I should get reads peaks on insertion borders. I finally get a sorted bam; here is a fragment of the corresponding sam (treatment):

```
@HD	VN:1.5	SO:coordinate
@SQ	SN:chromosome_1	LN:8033585
@SQ	SN:chromosome_2	LN:9223677
@SQ	SN:chromosome_3	LN:9219486
@SQ	SN:chromosome_4	LN:4091191
@SQ	SN:chromosome_5	LN:3500558
@SQ	SN:chromosome_6	LN:9023763
@SQ	SN:chromosome_7	LN:6421821
@SQ	SN:chromosome_8	LN:5033832
@SQ	SN:chromosome_9	LN:7956127
@SQ	SN:chromosome_10	LN:6576019
@SQ	SN:chromosome_11	LN:3826814
@SQ	SN:chromosome_12	LN:9730733
@SQ	SN:chromosome_13	LN:5206065
@SQ	SN:chromosome_14	LN:4157777
@SQ	SN:chromosome_15	LN:1922860
@SQ	SN:chromosome_16	LN:7783580
@SQ	SN:chromosome_17	LN:7188315
@SQ	SN:scaffold_18	LN:271631
@SQ	SN:scaffold_19	LN:219038
@SQ	SN:scaffold_20	LN:200793
@SQ	SN:scaffold_21	LN:189560
@SQ	SN:scaffold_22	LN:163774
@SQ	SN:scaffold_23	LN:127913
@SQ	SN:scaffold_24	LN:127161
@SQ	SN:scaffold_25	LN:102191
@SQ	SN:scaffold_26	LN:80213
@SQ	SN:scaffold_27	LN:55320
@SQ	SN:scaffold_28	LN:55278
@SQ	SN:scaffold_29	LN:52813
@SQ	SN:scaffold_30	LN:52376
@SQ	SN:scaffold_31	LN:48183
@SQ	SN:scaffold_32	LN:42264
@SQ	SN:scaffold_33	LN:39192
@SQ	SN:scaffold_34	LN:33576
@SQ	SN:scaffold_35	LN:32450
@SQ	SN:scaffold_36	LN:25399
@SQ	SN:scaffold_37	LN:24537
@SQ	SN:scaffold_38	LN:24437
@SQ	SN:scaffold_39	LN:22408
@SQ	SN:scaffold_40	LN:22082
@SQ	SN:scaffold_41	LN:21325
@SQ	SN:scaffold_42	LN:21000
@SQ	SN:scaffold_43	LN:20974
@SQ	SN:scaffold_44	LN:17736
@SQ	SN:scaffold_45	LN:16939
@SQ	SN:scaffold_46	LN:16627
@SQ	SN:scaffold_47	LN:14746
@SQ	SN:scaffold_48	LN:14165
@SQ	SN:scaffold_49	LN:13462
@SQ	SN:scaffold_50	LN:12727
@SQ	SN:scaffold_51	LN:11225
@SQ	SN:scaffold_52	LN:6241
@SQ	SN:scaffold_53	LN:2479
@SQ	SN:scaffold_54	LN:2277
@SQ	SN:pAgroLucR	LN:11063
@PG	ID:bowtie2	PN:bowtie2	VN:2.2.7	CL:""/gporq1_256k/usr/aprea/software/cresco4/gcc/4.8.3/bowtie2/2.2.7/bin/bowtie2-align-s --wrapper basic-0 --time --very-sensitive-local --local -k 2 -p 8 -x /gporq1_256k/usr/aprea/bio/xxx/ref/complex -S E1.aln.sam -1 /tmp/26895.inpipe1 -2 /tmp/26895.inpipe2 -U /tmp/26895.unp""
SNL169:252:c9yagacxx:7:2104:10588:96749	417	chromosome_1	2028	1	101M	chromosome_2	6946489	0	CACCACCCACAGAATCAAGAAAGAGCTCTCAATCTGTCAATCCTTCCCGTGTCTGGACCTGGTAAGTTTCCCCGTGTTGAGTCAAATTAAGCCGCAGGCTC	BBBFFFFFF<FFFIIIIIFFIIFIIFFFFIIFFFIIIIIIFFFIIIIIFFFFFFIIIIIIIFBFIIFFFFFFFFBFBBBBB<BBFBBBFFFBBFFBBBFFB	AS:i:202	XS:i:202	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:101	YT:Z:UP
SNL169:252:c9yagacxx:7:2104:10588:96749	417	chromosome_1	2028	1	101M	chromosome_2	6946489	0	CACCACCCACAGAATCAAGAAAGAGCTCTCAATCTGTCAATCCTTCCCGTGTCTGGACCTGGTAAGTTTCCCCGTGTTGAGTCAAATTAAGCCGCAGGCTC	BBBFFFFFF<FFFIIIIIFFIIFIIFFFFIIFFFIIIIIIFFFIIIIIFFFFFFIIIIIIIFBFIIFFFFFFFFBFBBBBB<BBFBBBFFFBBFFBBBFFB	AS:i:202	XS:i:202	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:101	YT:Z:UP
SNL169:253:hjm3ybcxx:2:2214:5321:31616	113	chromosome_2	323209	1	101M	pAgroLucR	5664	0	GCAGTCACGTCAACGCGGGCTGCGTGGCCGCACGTACACGACACGGGGCAGGAGGGAGGCAGGGGTGCAAAGCAGAGTCACGCTATGCTGACGGAGCGAGC	GGGA<IIIIIGGGGGGIGGGIGGGGGGAAGGGIIIIIGGIIIIIIIIGIIIIIIIIIIIIIIIIIIIIIIIGIIIIIIIIIIGIIIIIIIIIIIIIGGGGG	AS:i:202	XS:i:202	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:101	YT:Z:UP
SNL169:253:hjm3ybcxx:2:2214:5321:31616	369	chromosome_2	323492	1	101M	pAgroLucR	5664	0	GCAGTCACGTCAACGCGGGCTGCGTGGCCGCACGTACACGACACGGGGCAGGAGGGAGGCAGGGGTGCAAAGCAGAGTCACGCTATGCTGACGGAGCGAGC	GGGA<IIIIIGGGGGGIGGGIGGGGGGAAGGGIIIIIGGIIIIIIIIGIIIIIIIIIIIIIIIIIIIIIIIGIIIIIIIIIIGIIIIIIIIIIIIIGGGGG	AS:i:202	XS:i:202	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:101	YT:Z:UP
SNL169:252:c9yagacxx:7:2301:6366:64205	337	chromosome_2	6937395	11	74M1D21M2S	=	6942027	0	CCGTGCTGAAGCACGAGCAGGGGTATGCGTCAGTTCCCCGCGGTGAGATAGGCGCTGTCCCGGTGCCAAGCTAACCAGTGCCACAGTGGACCCGTGT	FFFBBFFFFFFFBBFFFFFBFBFFFFFFFFFFFFFFBFFFFFFFFFFFFFFIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIFFFFFFFFFFBBB	AS:i:182	XS:i:182	XN:i:0	XM:i:0	XO:i:1	XG:i:1	NM:i:1	MD:Z:74^C21	YT:Z:UP
SNL169:252:c9yagacxx:7:2301:6366:64205	337	chromosome_2	6937395	11	74M1D21M2S	=	6942027	0	CCGTGCTGAAGCACGAGCAGGGGTATGCGTCAGTTCCCCGCGGTGAGATAGGCGCTGTCCCGGTGCCAAGCTAACCAGTGCCACAGTGGACCCGTGT	FFFBBFFFFFFFBBFFFFFBFBFFFFFFFFFFFFFFBFFFFFFFFFFFFFFIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIFFFFFFFFFFBBB	AS:i:182	XS:i:182	XN:i:0	XM:i:0	XO:i:1	XG:i:1	NM:i:1	MD:Z:74^C21	YT:Z:UP
SNL169:253:hjm3ybcxx:2:1113:4164:26112	97	chromosome_2	6941441	255	101M	=	6941876	0	TGCACTGCAGCGTAGAAGCTGCAGTCATGGGCACAGCTTGTACCATACAGCACGGTCATCAAGGACACAATGCCGGAACGGCATCATACGAGGCGGGGTTG	GGGGGIIIIIIIIIIIIGIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIGIIIIIIIIIGGGIIIIIIIIGGIIIIIIIIIIIIIIIGIIGGAGI	AS:i:202	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:101	YT:Z:UP
SNL169:252:c9yagacxx:7:1315:15482:34528	97	chromosome_2	6941468	255	92M	=	6941878	0	TGGGCACAGCTTGTACCATACAGCACGGTCATCAAGGACACAATGCCGGAACGGCATCATACGAGGCGGGGTTGGGAGCTGCAGGAAGTGGG	FFFFFFFIIIFIIFIIIFFIIIFFFIIIBFFBBFFFIIIFIIIFFFFFFFIFFFFFBFFBFBBBFFFFFBF<BBBBFB<BBFFFF<B<00<B	AS:i:184	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:92	YT:Z:UP
SNL169:252:c9yagacxx:7:1315:15482:34528	97	chromosome_2	6941468	255	92M	=	6941878	0	TGGGCACAGCTTGTACCATACAGCACGGTCATCAAGGACACAATGCCGGAACGGCATCATACGAGGCGGGGTTGGGAGCTGCAGGAAGTGGG	FFFFFFFIIIFIIFIIIFFIIIFFFIIIBFFBBFFFIIIFIIIFFFFFFFIFFFFFBFFBFBBBFFFFFBF<BBBBFB<BBFFFF<B<00<B	AS:i:184	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:92	YT:Z:UP
SNL169:253:hjm3ybcxx:2:1113:4164:26112	145	chromosome_2	6941876	40	71M	=	6941441	0	CGAACCGAGTCCCCTTCAGCTGATGAACCCCGCAGCAACTTTTCCAAAAGCGCTTCAAATACGCCCAGCCC	IGGIIIIIIIIIIIIIIIIIIIIIIIIGIIIIIIIIIIIIIGGGIIIGIIIIIIIIIIIIGGIGGIGGGGA	AS:i:142	XS:i:42	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:71	YT:Z:UP
SNL169:252:c9yagacxx:7:1315:15482:34528	145	chromosome_2	6941878	38	91M	=	6941468	0	AACCGAGTCCCCTTCAGCTGATGAACCCCGCAGCAACTTTTCCAAAAGCGCTTCAAATACGCCCAGCCCGCCCATGGAGAAAGAGGCCAAA	7BBBBB<7B<BBBBBBBBB<FBB<0BB<7BBB<0<0BBBBBBBBBBBBBB<<BFFFB<<FFFB<IFFFFFFBBBFFBFFFFFBBB<BFBBB	AS:i:182	XS:i:86	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:91	YT:Z:UP
SNL169:252:c9yagacxx:7:1315:15482:34528	145	chromosome_2	6941878	38	91M	=	6941468	0	AACCGAGTCCCCTTCAGCTGATGAACCCCGCAGCAACTTTTCCAAAAGCGCTTCAAATACGCCCAGCCCGCCCATGGAGAAAGAGGCCAAA	7BBBBB<7B<BBBBBBBBB<FBB<0BB<7BBB<0<0BBBBBBBBBBBBBB<<BFFFB<<FFFB<IFFFFFFBBBFFBFFFFFBBB<BFBBB	AS:i:182	XS:i:86	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:91	YT:Z:UP
SNL169:252:c9yagacxx:7:2109:6827:53956	401	chromosome_2	6941926	31	11S90M	pAgroLucR	2536	0	AGAAACTCGACCGCTTCAAATACGCCCAGCCCGCCCATGGAGAAAGAGGCCAAAATCAACGGAGGATCGTTACAACCAACAAAATTGCAAAACTCCTCCGC	FFFBBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBFFFFFFFFIIIIIIIIIIIIFIIIIIIIIIIIFIIIIIFFIIFFIIIIFFIIIFFFFFFFFFFBBB	AS:i:180	XS:i:180	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:90	YT:Z:UP
SNL169:252:c9yagacxx:7:2109:6827:53956	401	chromosome_2	6941926	31	11S90M	pAgroLucR	2536	0	AGAAACTCGACCGCTTCAAATACGCCCAGCCCGCCCATGGAGAAAGAGGCCAAAATCAACGGAGGATCGTTACAACCAACAAAATTGCAAAACTCCTCCGC	FFFBBFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBFFFFFFFFIIIIIIIIIIIIFIIIIIIIIIIIFIIIIIFFIIFFIIIIFFIIIFFFFFFFFFFBBB	AS:i:180	XS:i:180	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:90	YT:Z:UP
SNL169:253:hjm3ybcxx:2:1108:8720:80462	129	chromosome_2	6941988	1	98M	chromosome_11	3732462	0	AACCAACAAAATTGCAAAACTCCTCCGCTTTTTACGTGTTGAAAAAGACTGATCAGCACGAAACGGGGAGCTAAGCTACCGCTTCAGCACTTGAGAGC	GGIIIIIIIIIIIIIIIIIIGIIIIIIIIIIIIIIIIGGGIIIIIIGGGGGGIGIGGGGGGIIIGGGGGGGIIIIIIIGIIGIIGIIIIIGGAGGAGG	AS:i:196	XS:i:196	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:98	YT:Z:UP
SNL169:252:c9yagacxx:7:2301:6366:64205	161	chromosome_2	6942027	1	94M	=	6942462	0	TGAAAAAGACTGATCAGCACGAAACGGGGAGCTAAGCTACCGCTTCAGCACTTGAGAGCAGTATCTTCCATCCACCGCCGTTCGTCAGGGGGCA	FFFFFFIIIIIIFFIIFFIIIIIIIIIIIFFFFFIFFIIIIIIFFFFFFFFFBFFFFFFFFBFFFFFFFFFFFFFFBFFFBFFFFFF<BBBFFB	AS:i:188	XS:i:188	XN:i:0	XM:i:0	XO:i:0	XG:i:0	NM:i:0	MD:Z:94	YT:Z:UP

```

When I try to call peaks with:

```
macs2 callpeak -t ${TREATMENT} -c ${CONTROL} -f BAM -g ${GSIZE} -n ${LABEL} -B -q 0.01
```

I get:

```
INFO  @ Wed, 05 Apr 2017 17:42:48: 
# Command line: callpeak -t /gporq1_256k/usr/aprea/bio/xxx/analysis/alignments/elettro_bowtie2/E1.aln.peaks.sorted.bam -c /gporq1_256k/usr/aprea/bio/xxx/analysis/alignments/wt/CW15.aln.peaks.sorted.bam -f BAM -g 111100715 -n E1 -B -q 0.01
# ARGUMENTS LIST:
# name = E1
# format = BAM
# ChIP-seq file = ['/gporq1_256k/usr/aprea/bio/xxx/analysis/alignments/elettro_bowtie2/E1.aln.peaks.sorted.bam']
# control file = ['/gporq1_256k/usr/aprea/bio/xxx/analysis/alignments/wt/CW15.aln.peaks.sorted.bam']
# effective genome size = 1.11e+08
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 1.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
INFO  @ Wed, 05 Apr 2017 17:42:48: #1 read tag files... 
INFO  @ Wed, 05 Apr 2017 17:42:48: #1 read treatment tags... 
INFO  @ Wed, 05 Apr 2017 17:42:48: #1.2 read input tags... 
INFO  @ Wed, 05 Apr 2017 17:42:54:  1000000 
INFO  @ Wed, 05 Apr 2017 17:42:56: #1 tag size is determined as 95 bps 
CRITICAL @ Wed, 05 Apr 2017 17:42:56: No common chromosome names can be found from treatment and control! Check your input files! MACS will quit... 
CRITICAL @ Wed, 05 Apr 2017 17:42:56: Chromosome names in treatment:  
CRITICAL @ Wed, 05 Apr 2017 17:42:56: Chromosome names in control: chromosome_1,chromosome_10,chromosome_11,chromosome_12,chromosome_13,chromosome_14,chromosome_15,chromosome_16,chromosome_17,chromosome_2,chromosome_3,chromosome_4,chromosome_5,chromosome_6,chromosome_7,chromosome_8,chromosome_9,scaffold_18,scaffold_19,scaffold_20,scaffold_21,scaffold_22,scaffold_23,scaffold_24,scaffold_25,scaffold_26,scaffold_27,scaffold_28,scaffold_29,scaffold_30,scaffold_31,scaffold_32,scaffold_33,scaffold_34,scaffold_35,scaffold_36,scaffold_37,scaffold_38,scaffold_39,scaffold_40,scaffold_41,scaffold_42,scaffold_43,scaffold_44,scaffold_45,scaffold_46,scaffold_47,scaffold_48,scaffold_49,scaffold_50,scaffold_51,scaffold_52 
```

It looks like macs2 has problems reading the T bam file only. It could be a format problem but it actually reads the C bam file so I don't understand what's going on.

Any Idea?

Thanks in advance

",linsson,https://github.com/macs3-project/MACS/issues/182
MDU6SXNzdWUyMTk4MzMxNDg=,pair-ended data in BAMPE and BEDPE do not produce the same results,OPEN,2017-04-06T09:11:13Z,2023-09-07T10:54:40Z,,"Using the same data set in BAMPE format and converting the BAMPE to a BEDPE  via
`samtools sort -l 0 -n -O bam <input_bampe_file> | samtools view -bf 0x2 | bedtools bamtobed -bedpe -i - > <temp_bedpe_file>` and subsequently `cut -f 1,2,6 <temp_bedpe_file> | sort -k1,1 -k2,2n -k3,3n > <bedpe_file>` and running MACS with `/macs2/bin/macs2 callpeak -t ./<input_bampe_file> -f BAMPE -g hs -n bampe` and `/macs2/bin/macs2 callpeak -t <bedepe_file> -f BEDPE -g hs -n bedpe` I get different resulting peak files. This is not the case if I run single-end reads data in both BAM and BED format.",MariusGheorghe,https://github.com/macs3-project/MACS/issues/183
MDU6SXNzdWUyMjA1NzExNjA=,MACS2 default q-value different in README vs using MACS2,OPEN,2017-04-10T08:26:59Z,2017-05-05T18:37:58Z,,"MACS2 is wonderful, thank-you for it.  I hope it becomes a paper to be referenced at some point.

I've only just noticed that while the README says the default q-vlaue is 0.01, that in the MACS2 (2.1.0) output the default q-value is 0.05.   The README indicates that 0.01 is good for strong peaks, while the 0.05 is more for broad/weaker peaks.  Yet I found the output of someone asking a question about MACS2 and MACS2's output said the opposite.
    # qvalue cutoff for narrow/strong regions = 5.00e-02
    # qvalue cutoff for broad/weak regions = 1.00e-02

I am now rather unsure whether I have been processing all my DNase-seq and ATAC-seq with the wrong q-value or the right one.  The choice of q-value has quite an impact on the regions that are reported.

------
Also, I was wondering if it was possible to report more decimal places for the q-value or p-value. I've been trying to use IDR with MACS2 and I am wondering if the large number of ties due to only 5 decimal places is causing some problems.
-----

thank-you for any advice on this,
Rebecca",rebeccawh,https://github.com/macs3-project/MACS/issues/184
MDU6SXNzdWUyMjExNTU1ODc=,bdgdiff comparison issue,CLOSED,2017-04-12T05:30:18Z,2024-11-13T18:04:58Z,2024-11-13T18:04:58Z,"Hi there,

I'm trying to use MACS2 bdgdiff for my ATAC-seq differential peaks analysis. I want to compare the differential expression between T2D (Type 2 Diabetes) and ND(Non-diabetes, control) with the same cell type. For example, compare T2D_Bcell with ND_Bcell. 
My question is, in the arguments of bdgdiff, what should I put for the arguments for the analysis?
How about:
Condition1: T2D_Bcell
Control1: ND_Bcell
Condition2: ND_Bcell
Control2: ND_Bcell  ?
I want to compare one sample (T2D) with one control (ND). What should I put for condition and control arguments?

Simon",shengyongniu,https://github.com/macs3-project/MACS/issues/185
MDU6SXNzdWUyMjExOTM4NTA=,Running MACS2 on RNA-Seq BAM files,OPEN,2017-04-12T08:52:45Z,2024-08-20T15:42:49Z,,"Hi,

I am aware that MACS2 is designed for finding peaks using ChIP-Seq data. However, when I run MACS2 on RNA-Seq data using default parameters, it seems to work as I expected. Now my question is do you see any problem with this approach? 

Thanks",gireeshkbogu,https://github.com/macs3-project/MACS/issues/186
MDU6SXNzdWUyMjM4MjA4NDg=,disable extsize,CLOSED,2017-04-24T13:30:30Z,2017-04-24T13:30:44Z,2017-04-24T13:30:44Z,"Hello,

where can I disable extsize. I dont want extend the tags",jano15,https://github.com/macs3-project/MACS/issues/187
MDU6SXNzdWUyMjM4MjEwMzc=,Question extsize,OPEN,2017-04-24T13:31:10Z,2018-11-14T13:01:50Z,,"Hello,

where can I disable extsize. I dont want extend the tags",jano15,https://github.com/macs3-project/MACS/issues/188
MDU6SXNzdWUyMjQzMjEyNzY=,UnboundLocalError for BAMPE,CLOSED,2017-04-26T01:58:12Z,2024-11-13T18:22:25Z,2024-11-13T18:22:25Z,"Dear Tao,
      Recently, I'm trying to use MACS2 for my ChIP-seq data. When I run MACS2  , I got error ""UnboundLocalError"".
     On the script ""PairedEndTrack.pyx"": #325 if size <= 1: new_locs = locs else:
     then if size <=1, the ""dup_locs"" have not been assignment value
     So if there has only one read in a single scaffold, then I will got the ""UnboundLocalError""?

My script：
macs2 callpeak -t input.bam -c control.bam -f BAMPE -g 5.94e9 -q 0.05 -B --name out --outdir outdir

The Error list as follows:
```
INFO  @ Mon, 24 Apr 2017 22:20:41: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
Traceback (most recent call last):
  File ""/panfs/home/kang/jiangfeng/software/99.others/Python-2.7.3/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""/panfs/home/kang/jiangfeng/software/98.lib/01.python/lib/python2.7/site-packages/site-packages/pkg_resources.py"", line 534, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/panfs/home/kang/jiangfeng/software/98.lib/01.python/lib/python2.7/site-packages/site-packages/pkg_resources.py"", line 1434, in run_script
    execfile(script_filename, namespace, namespace)
  File ""/panfs/home/kang/jiangfeng/software/99.others/Python-2.7.3/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>
    main()
  File ""/panfs/home/kang/jiangfeng/software/99.others/Python-2.7.3/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 57, in main
    run( args )
  File ""/panfs/home/kang/jiangfeng/software/99.others/Python-2.7.3/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 142, in run
    control.separate_dups(treatment_max_dup_tags) # changed 5-29
  File ""MACS2/IO/PairedEndTrack.pyx"", line 354, in MACS2.IO.PairedEndTrack.PETrackI.separate_dups (MACS2/IO/PairedEndTrack.c:5870)
UnboundLocalError: local variable 'dup_locs' referenced before assignment
```
  Liu",liuqing1992,https://github.com/macs3-project/MACS/issues/189
MDU6SXNzdWUyMjYzOTMxOTU=,MACS Differential Binding Output And Peak Call Numbers Doesn't Match,CLOSED,2017-05-04T20:04:35Z,2017-05-05T21:51:16Z,2017-05-05T21:51:16Z,"Hi taoliu,

I ran MACS2 callpeak like this

<code>macs2 callpeak -B -t chip11.bed chip21.bed chip31.bed -c input1.bed -n set1 --nomodel --extsize 195 -f BED -g mm</code>

<code>macs2 callpeak -B -t chip12.bed chip22.bed chip32.bed -c input2.bed -n set2 --nomodel --extsize 195 -f BED -g mm</code>

and did bdgdiff to get the differential peaks.

However, the three sets of files that bdgdiff generated had the following numbers

enriched_in_condition1=1428
enriched_in_condition2=29
common=1155

But the MACS2 callpeak command outputs 5349 peaks in the excel sheet for condition1 and 2610 peaks for condition2. This number doesn't match to the numbers from bdgdiff output. Why is it so? Can you please share any pointers. Thanks in advance.",gk7279,https://github.com/macs3-project/MACS/issues/190
MDU6SXNzdWUyMjY3MTY3ODA=,Cutoff analysis results,CLOSED,2017-05-05T23:35:58Z,2024-11-13T18:04:38Z,2024-11-13T18:04:38Z,"I'm confused about the output in the cutoff_analysis.txt file generated when the --cutoff-analysis argument is used. Why are the pscore and qscore values ranging from ~10 to 0? Are these -log(pvalue) and -log(qvalue)? Also when using the macs2 command you can only specify a p-value OR a q-value, but the cutoff analysis shows peak calling results for pairs of p-value and q-values. I'm not sure how to interpret that.",kernco,https://github.com/macs3-project/MACS/issues/191
MDU6SXNzdWUyMjk4MDI5OTc=,Pooling controls and fold-change,CLOSED,2017-05-18T20:58:46Z,2024-11-13T18:03:59Z,2024-11-13T18:03:58Z,If you give macs2 a single treatment file but 3 controls will it take into account the difference when calculated fold-change?,sklasfeld,https://github.com/macs3-project/MACS/issues/192
MDU6SXNzdWUyMzAzNDMwMzc=,Is read coverage normalised to RPM or RPGC?,CLOSED,2017-05-22T09:54:51Z,2024-11-13T18:25:11Z,2024-11-13T18:25:11Z,"When running `macs2 callpeak` with the  flags `-g GSIZE -B --SPMR` are the bedGraphs files produced normalised to reads per million (RPM), or is the effective genome size included in the calculation (RPGC), similar to the normalisation used in the [deepTools command bamCoverage](https://deeptools.readthedocs.io/en/latest/content/tools/bamCoverage.html)?",jma1991,https://github.com/macs3-project/MACS/issues/193
MDU6SXNzdWUyMzIxMDE4MTE=,Feature request - allow refinepeak to use peak interval instead of window,CLOSED,2017-05-29T21:36:37Z,2024-11-13T18:10:53Z,2024-11-13T18:10:53Z,I have peak intervals generated from intersecting peaks from multiple studies measuring the same factor. When I intersect these peaks I lose all information about peak summits. I would like to use the refinepeak command to identify the summits for these new peaks. To do this I tried setting the window size to zero because I only want to look for summits within the pre-defined peak intervals. However the search space is then limited to just the first base pair of the peak interval (because it assumes you are passing in a single base-pair summit interval). It would be very helpful if the refinepeak command would take the full peak-interval as the search space.,jma1991,https://github.com/macs3-project/MACS/issues/194
MDU6SXNzdWUyMzI1NTAyMDI=,ATAC-Seq parameters,OPEN,2017-05-31T12:20:52Z,2019-10-19T14:39:27Z,,"Hi,
I have gone through the other two ATAC-seq issues. Accordingly, I tried one run with BAMPE and one without. here are the codes.

``macs2 callpeak -t raw/dH1f_1.bam -n dh1f_1.broad -g hs -q 0.05 --nomodel --extsize 200 -f BAMPE -B --broad``

``callpeak -t raw/dh1f_2.bam -n dh1f_2.broad -g hs -q 0.05 --nomodel --shift -100 --extsize 200 -B --broad``

Then I wanted to see how close their results are and the length of broadPeak files are as
``  1232 dh1f_1.broad_peaks.broadPeak
  92323 dh1f.broad_peaks.broadPeak  ``

There is a huge difference and I cannot make sure what parameters to use.
",firatuyulur,https://github.com/macs3-project/MACS/issues/195
MDU6SXNzdWUyMzQwMzE1MDQ=,Import Error for Parser.so,OPEN,2017-06-06T21:33:20Z,2017-12-04T09:40:27Z,,"I load module of macs2 in the cluster. But when I run macs2, it shows that 
Traceback (most recent call last):
  File ""/isg/shared/apps/macs2/2.1.1.20160309/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""/usr/lib/python2.7/site-packages/pkg_resources.py"", line 540, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/usr/lib/python2.7/site-packages/pkg_resources.py"", line 1462, in run_script
    exec_(script_code, namespace, namespace)
  File ""/usr/lib/python2.7/site-packages/pkg_resources.py"", line 41, in exec_
    exec(""""""exec code in globs, locs"""""")
  File ""<string>"", line 1, in <module>
  File ""/isg/shared/apps/macs2/2.1.1.20160309/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>
    
  File ""/isg/shared/apps/macs2/2.1.1.20160309/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 56, in main
    
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 31, in <module>
  File ""build/bdist.linux-x86_64/egg/MACS2/OptValidator.py"", line 27, in <module>
  File ""build/bdist.linux-x86_64/egg/MACS2/IO/Parser.py"", line 7, in <module>
  File ""build/bdist.linux-x86_64/egg/MACS2/IO/Parser.py"", line 6, in __bootstrap__
ImportError: /home/CAM/jxing/.python-eggs/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg-tmp/MACS2/IO/Parser.so: undefined symbol: PyUnicodeUCS2_DecodeUTF8

I installed cython 0.24 but it didn't work all the time. I also use the PYTHON_CONFIGURE_OPTS= --enable-unicode=ucs4 to change the python interpreter.",chutxing,https://github.com/macs3-project/MACS/issues/196
MDU6SXNzdWUyMzcwNjI2NTk=,question about the difference in using MACS for single-end or paired-end data,OPEN,2017-06-20T00:50:45Z,2017-10-20T21:05:19Z,,"HI,tao:
    I notice that multiple ChIP-seq data were single-end and reads length was 50bp, and use MACS for peak calling.  
  1、 I am confused that for paired-end ChIP-seq data, does MACS also suitable？ Furthermore, for single-end and paired-end ChIP-seq data, does the parameter have difference?
  2、how long the reads length is perfect for MACS to perform peak calling?  50bp? 150bp? 250bp?  
does the reads length can influence the result?

",liulingnovo,https://github.com/macs3-project/MACS/issues/197
MDU6SXNzdWUyMzk5MTEwNTg=,"callpeak: read from stdin, write to stdout",CLOSED,2017-06-30T23:42:18Z,2024-11-13T18:15:19Z,2024-11-13T18:15:19Z,"For `callpeak`, is it possible to read the treatment records from `stdin` and output the BED entries for `NAME_summits.bed` to `stdout`? 

Thanks!",gunjanbaid,https://github.com/macs3-project/MACS/issues/198
MDU6SXNzdWUyNDEwNjIzMTc=,Questions about bdgdiff output,CLOSED,2017-07-06T19:33:44Z,2024-11-13T18:10:33Z,2024-11-13T18:10:33Z,"Hi,
Can you please explain how differential regions are called?
The differential region seems to have overlap with individual peak called on cond1 and cond2?
For example these are the peaks called on cond1, cond2 and enriched in cond2
peak on cond1. chr1:13,203-14,976
peak on cond2. chr1:11,900-16,152
enrich in cond2. chr1:12,432-15,783
The enrich region in cond2 overlap with peaks in both cond1 and cond2? How is this region determined?
Also, is there a way to tell the intensity of peak increases/decreases ?",olechnwin,https://github.com/macs3-project/MACS/issues/199
MDU6SXNzdWUyNDQxMTUyNjQ=,Mismatch between suggested and accepted options for predictd failure,CLOSED,2017-07-19T17:26:30Z,2024-11-13T18:14:34Z,2024-11-13T18:14:34Z,"When `predictd` fails with a `NotEnoughPairsException`, there's a suggested use of `--nomodel` and `--extsize`. Those options apply to `callpeak` rather than `predictd`, though.

Initial sticking point:
```
$ macs2 predictd -i test1.pe.q10.sort.rmdup.bed
INFO  @ Wed, 19 Jul 2017 13:23:59: # read alignment files... 
INFO  @ Wed, 19 Jul 2017 13:23:59: # read treatment tags... 
INFO  @ Wed, 19 Jul 2017 13:23:59: Detected format is: BED 
INFO  @ Wed, 19 Jul 2017 13:23:59: tag size is determined as 50 bps 
INFO  @ Wed, 19 Jul 2017 13:23:59: # tag size = 50 
INFO  @ Wed, 19 Jul 2017 13:23:59: # total tags in alignment file: 14810 
INFO  @ Wed, 19 Jul 2017 13:23:59: # Build Peak Model... 
INFO  @ Wed, 19 Jul 2017 13:23:59: #2 looking for paired plus/minus strand peaks... 
INFO  @ Wed, 19 Jul 2017 13:23:59: #2 number of paired peaks: 0 
WARNING @ Wed, 19 Jul 2017 13:23:59: Too few paired peaks (0) so I can not build the model! Broader your MFOLD range parameter may erase this error. If it still can't build the model, we suggest to use --nomodel and --extsize 147 or other fixed number instead. 
WARNING @ Wed, 19 Jul 2017 13:23:59: Process for pairing-model is terminated! 
WARNING @ Wed, 19 Jul 2017 13:23:59: # Can't find enough pairs of symmetric peaks to build model! 
```

Option mismatch:
```
$ macs2 predictd --nomodel --extsize 147 -i test1.pe.q10.sort.rmdup.bed
usage: macs2 [-h] [--version]
             
             {callpeak,bdgpeakcall,bdgbroadcall,bdgcmp,bdgopt,cmbreps,bdgdiff,filterdup,predictd,pileup,randsample,refinepeak}
             ...
macs2: error: unrecognized arguments: --nomodel --extsize 147
```
",vreuter,https://github.com/macs3-project/MACS/issues/200
MDU6SXNzdWUyNDUyODQxNzA=,Segmentation fault (core dumped),OPEN,2017-07-25T04:42:51Z,2023-09-11T06:07:01Z,,"$ macs2 callpeak -t /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/align/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.tagAlign.gz -f BED -n ""/public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/peak/macs2/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.pf"" -g ""mm"" -p 0.01 --nomodel --shift -75 --extsize 150 -B --SPMR --keep-dup all --call-summits
INFO  @ Tue, 25 Jul 2017 12:33:24: 
# Command line: callpeak -t /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/align/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.tagAlign.gz -f BED -n /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/peak/macs2/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.pf -g mm -p 0.01 --nomodel --shift -75 --extsize 150 -B --SPMR --keep-dup all --call-summits
# ARGUMENTS LIST:
# name = /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/peak/macs2/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.pf
# format = BED
# ChIP-seq file = ['/public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/align/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.tagAlign.gz']
# control file = None
# effective genome size = 1.87e+09
# band width = 300
# model fold = [5, 50]
# pvalue cutoff = 1.00e-02
# qvalue will not be calculated and reported as -1 in the final output.
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is off
# Searching for subpeak summits is on
# MACS will save fragment pileup signal per million reads
 
INFO  @ Tue, 25 Jul 2017 12:33:24: #1 read tag files... 
INFO  @ Tue, 25 Jul 2017 12:33:24: #1 read treatment tags... 
INFO  @ Tue, 25 Jul 2017 12:33:28:  1000000 
INFO  @ Tue, 25 Jul 2017 12:33:31:  2000000 
INFO  @ Tue, 25 Jul 2017 12:33:35:  3000000 
INFO  @ Tue, 25 Jul 2017 12:33:38:  4000000 
INFO  @ Tue, 25 Jul 2017 12:33:42:  5000000 
INFO  @ Tue, 25 Jul 2017 12:33:45:  6000000 
INFO  @ Tue, 25 Jul 2017 12:33:49:  7000000 
INFO  @ Tue, 25 Jul 2017 12:33:52:  8000000 
INFO  @ Tue, 25 Jul 2017 12:33:55:  9000000 
INFO  @ Tue, 25 Jul 2017 12:33:58:  10000000 
INFO  @ Tue, 25 Jul 2017 12:34:01:  11000000 
INFO  @ Tue, 25 Jul 2017 12:34:04:  12000000 
INFO  @ Tue, 25 Jul 2017 12:34:07:  13000000 
INFO  @ Tue, 25 Jul 2017 12:34:09:  14000000 
INFO  @ Tue, 25 Jul 2017 12:34:12:  15000000 
INFO  @ Tue, 25 Jul 2017 12:34:15:  16000000 
INFO  @ Tue, 25 Jul 2017 12:34:18:  17000000 
INFO  @ Tue, 25 Jul 2017 12:34:21:  18000000 
INFO  @ Tue, 25 Jul 2017 12:34:24:  19000000 
INFO  @ Tue, 25 Jul 2017 12:34:27:  20000000 
INFO  @ Tue, 25 Jul 2017 12:34:29:  21000000 
INFO  @ Tue, 25 Jul 2017 12:34:32:  22000000 
INFO  @ Tue, 25 Jul 2017 12:34:36: #1 tag size is determined as 40 bps 
INFO  @ Tue, 25 Jul 2017 12:34:36: #1 tag size = 40 
INFO  @ Tue, 25 Jul 2017 12:34:36: #1  total tags in treatment: 22535426 
INFO  @ Tue, 25 Jul 2017 12:34:36: #1 finished! 
INFO  @ Tue, 25 Jul 2017 12:34:36: #2 Build Peak Model... 
INFO  @ Tue, 25 Jul 2017 12:34:36: #2 Skipped... 
INFO  @ Tue, 25 Jul 2017 12:34:36: #2 Sequencing ends will be shifted towards 5' by 75 bp(s) 
INFO  @ Tue, 25 Jul 2017 12:34:36: #2 Use 150 as fragment length 
INFO  @ Tue, 25 Jul 2017 12:34:36: #3 Call peaks... 
INFO  @ Tue, 25 Jul 2017 12:34:36: #3 Going to call summits inside each peak ... 
INFO  @ Tue, 25 Jul 2017 12:34:36: #3 Call peaks with given -log10pvalue cutoff: 2.00000 ... 
INFO  @ Tue, 25 Jul 2017 12:34:36: #3 Pre-compute pvalue-qvalue table... 
INFO  @ Tue, 25 Jul 2017 12:35:46: #3 In the peak calling step, the following will be performed simultaneously: 
INFO  @ Tue, 25 Jul 2017 12:35:46: #3   Write bedGraph files for treatment pileup (after scaling if necessary)... /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/peak/macs2/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.pf_treat_pileup.bdg 
INFO  @ Tue, 25 Jul 2017 12:35:46: #3   Write bedGraph files for control lambda (after scaling if necessary)... /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/peak/macs2/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.pf_control_lambda.bdg 
INFO  @ Tue, 25 Jul 2017 12:35:46: #3   --SPMR is requested, so pileup will be normalized by sequencing depth in million reads. 
INFO  @ Tue, 25 Jul 2017 12:35:46: #3 Call peaks for each chromosome... 
INFO  @ Tue, 25 Jul 2017 12:40:39: #4 Write output xls file... /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/peak/macs2/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.pf_peaks.xls 
INFO  @ Tue, 25 Jul 2017 12:40:41: #4 Write peak in narrowPeak format file... /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/peak/macs2/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.pf_peaks.narrowPeak 
INFO  @ Tue, 25 Jul 2017 12:40:43: #4 Write summits bed file... /public/home/niehu/projects/Lulab20170712/pipeline/E9_5/out/peak/macs2/rep2/E9_5_2_R1.trim.PE2SE.nodup.tn5.pf_summits.bed 
INFO  @ Tue, 25 Jul 2017 12:40:44: Done! 
Segmentation fault (core dumped)


How to fix this problem.",niehu2018,https://github.com/macs3-project/MACS/issues/202
MDU6SXNzdWUyNDU2MjM2NTk=,About --SPMR,OPEN,2017-07-26T06:55:43Z,2017-07-27T11:45:57Z,,"Hi,
I have a number of atacseq bams and their total read numbers differ. I did peak calling with and without --SPMR and there is no difference between the two ......broad_peaks.broadPeak files. yet there is a difference in ....broad_treat_pileup.bdg files. While using callpeak, does --SPMR have no effect on the signalValues?",firatuyulur,https://github.com/macs3-project/MACS/issues/203
MDU6SXNzdWUyNDYxMDgwNTI=,Bed file to enrichment scores ,CLOSED,2017-07-27T17:08:13Z,2024-11-13T18:10:17Z,2024-11-13T18:10:16Z,"I have a consensus peak bed file for which I have to quantify the enrichment score of bam files against their respective control file. What is the best way in macs2 software to get enrichment scores of given bed file?

Also, is the col. 7 in narrowpeak file is the enrichment score for a given peak regions averaged over the width of the peak?",girdhar3,https://github.com/macs3-project/MACS/issues/204
MDU6SXNzdWUyNDg4NTcwODQ=,MACS1.4 vs MACS2,CLOSED,2017-08-08T21:49:48Z,2024-11-13T18:29:12Z,2024-11-13T18:29:12Z,"Hello I have a question about the candidate peaks. In MACS2 there are also candidate peaks, before the p-value is calculated or is for every window a p-value calculated ?",jano15,https://github.com/macs3-project/MACS/issues/205
MDU6SXNzdWUyNDkwNzgyMDI=,Running with python 3,OPEN,2017-08-09T15:53:34Z,2017-08-15T01:21:54Z,,"Hi, 

May I ask where you are with having your code run with Python 3? We need it to test our pipelines. 

Many thanks,
Kind Regards,
Reham",rehamFatima,https://github.com/macs3-project/MACS/issues/206
MDU6SXNzdWUyNTAxMDA1NDQ=,Reduce the memory usage for huge datasets,OPEN,2017-08-14T17:36:32Z,2017-11-18T12:57:27Z,,"It looks like the memory usage of MACS2 scales linearly with the input size, in particular the number of tags in my case. Perhaps because during the first step it stores the tag information in memory. Is it possible to make the memory usage scales only with the genome size? I have some huge datasets with several billion reads and cannot get MACS2 working for these data.",kaizhang,https://github.com/macs3-project/MACS/issues/207
MDU6SXNzdWUyNTAyMTQzODE=,"The q-value in broadPeak output does not reflect the ""--broad-cutoff "" setting?",OPEN,2017-08-15T03:44:56Z,2021-05-05T18:36:44Z,,"Hello @taoliu ,

While running macs2 on broad mark mode, I set the q-value cutoff as 0.1 for the broad region, and  0.05 for the narrow region, by:

```
# Command line: callpeak -t treatment.bam -c control.bam --broad -g hs --broad-cutoff 0.1 -n H3K27me3_vs_input --outdir output/
# ARGUMENTS LIST:
# name = H3K27me3_vs_input
# format = AUTO
# ChIP-seq file = ['treatment.bam]
# control file = ['control.bam']
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff for narrow/strong regions = 5.00e-02
# qvalue cutoff for broad/weak regions = 1.00e-01
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is on

```

I would thus expect the column 9 (9th: ```-log10qvalue```) in the output broadPeak file to be all >= 1. However, I still see values as low as 0.5 in the 9th column, suggesting the filtering does not occur. 

Is that a bug or is the q-value somehow postoperatively re-computed once after calling peaks using 0.1 for broad, and 0.05 for narrow? How should I interpret the 9th column, if I want to get all peaks with q-value<=0.01 ?


When I change the value of n in  ""--broad-cutoff n"" , the number of peaks outputted does change. 

Thanks a lot for your time and help! 

",aliceZhu,https://github.com/macs3-project/MACS/issues/208
MDU6SXNzdWUyNTE5OTAwNDA=,macs2 callpeak error!,CLOSED,2017-08-22T15:07:14Z,2024-11-13T18:09:21Z,2024-11-13T18:09:20Z,"Hi there,

I am new to ATAC-seq data analysis. I have installed MACS2 using pip. I just ran callpeak function using treated and control bam files. I used the following command:
macs2 callpeak -t K-P-1.mapQabove10.RG.marked.sorted.bam -c K-P-9.mapQabove10.RG.marked.sorted.bam -f BAM -g hs -n K-P-1 -B -q 0.01

I am getting the following message and error:

Traceback (most recent call last):
  File ""/mnt/DATAPART3/local/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""/mnt/DATAPART3/local/share/bcbio/anaconda/lib/python2.7/site-packages/setuptools-27.2.0-py2.7.egg/pkg_resources/__init__.py"", line 744, in run_script
  File ""/mnt/DATAPART3/local/share/bcbio/anaconda/lib/python2.7/site-packages/setuptools-27.2.0-py2.7.egg/pkg_resources/__init__.py"", line 1506, in run_script
  File ""/home/wenbin/.local/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>
    
  File ""/home/wenbin/.local/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 56, in main
    
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 31, in <module>
  File ""build/bdist.linux-x86_64/egg/MACS2/OptValidator.py"", line 27, in <module>
  File ""build/bdist.linux-x86_64/egg/MACS2/IO/Parser.py"", line 7, in <module>
  File ""build/bdist.linux-x86_64/egg/MACS2/IO/Parser.py"", line 6, in __bootstrap__
ImportError: /home/wenbin/.cache/Python-Eggs/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg-tmp/MACS2/IO/Parser.so: undefined symbol: PyFPE_jbuf

Please advice me on this. Thank you.

BR,
P

",DrPraRam,https://github.com/macs3-project/MACS/issues/210
MDU6SXNzdWUyNTM2NDkzMjQ=,Can the reads after trimmed affect the tag sizes ?,OPEN,2017-08-29T12:57:46Z,2018-03-01T01:07:18Z,,"Hi, tao
     I noticed the tag size will be detected by first ten reads. because of my data with different size after trimmed, I am afraid my peak calling is wrong. Could you explain my doubt?",yuaner90,https://github.com/macs3-project/MACS/issues/211
MDU6SXNzdWUyNTY1Mjk3MjU=,Documentation about summits column 5,CLOSED,2017-09-10T18:31:02Z,2022-12-21T18:50:52Z,2022-12-21T18:50:52Z,"In the documentation, the 5th column of the summits file is -log10p (""NAME_summits.bed is in BED format, which contains the peak summits locations for every peaks. The 5th column in this file is -log10pvalue the same as NAME_peaks.bed. ""). But it looks like to be identical to column 9 in the narrowPeak file, which is -log10qvalue. ",mxygc,https://github.com/macs3-project/MACS/issues/212
MDU6SXNzdWUyNTc5ODYxNTg=,macs2 callpeak :  ValueError: max() arg is an empty sequence,OPEN,2017-09-15T09:52:20Z,2019-02-19T08:24:59Z,,"Hi,

I have an intermitent problem with Macs2 callpeak when I use build model. It seems a problem with building model because I have no problem when I use --nomodel and a fixed extend size in the same sample
So I ran this command with MACS2 2.1.0.20151222 :
callpeak --name MACS2 -t treat.bam --format=BAM --gsize 2451960000 --bw=300 --ratio 1.0 --slocal 1000 --llocal 10000 --keep-dup 2 --bdg --pvalue 0.01
# ARGUMENTS LIST:
# name = MACS2
# format = BAM
# ChIP-seq file = ['treat.bam']
# control file = None
# effective genome size = 2.45e+09
# band width = 300
# model fold = [5, 50]
# pvalue cutoff = 1.00e-02
# qvalue will not be calculated and reported as -1 in the final output.
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
 
INFO  @ Fri, 15 Sep 2017 11:11:27: #1 read tag files...
INFO  @ Fri, 15 Sep 2017 11:11:27: #1 read treatment tags...
INFO  @ Fri, 15 Sep 2017 11:11:29:  1000000
INFO  @ Fri, 15 Sep 2017 11:11:31:  2000000
INFO  @ Fri, 15 Sep 2017 11:11:33:  3000000
...
...
...
INFO  @ Fri, 15 Sep 2017 11:13:00:  48000000
INFO  @ Fri, 15 Sep 2017 11:13:02:  49000000
INFO  @ Fri, 15 Sep 2017 11:13:03:  50000000
INFO  @ Fri, 15 Sep 2017 11:13:04: #1 tag size is determined as 16 bps
INFO  @ Fri, 15 Sep 2017 11:13:04: #1 tag size = 16
INFO  @ Fri, 15 Sep 2017 11:13:04: #1  total tags in treatment: 50000000
INFO  @ Fri, 15 Sep 2017 11:13:04: #1 user defined the maximum tags...
INFO  @ Fri, 15 Sep 2017 11:13:04: #1 filter out redundant tags at the same location and the same strand by allowing at most 2 tag(s)
INFO  @ Fri, 15 Sep 2017 11:13:10: #1  tags after filtering in treatment: 50000000
INFO  @ Fri, 15 Sep 2017 11:13:10: #1  Redundant rate of treatment: 0.00
INFO  @ Fri, 15 Sep 2017 11:13:10: #1 finished!
INFO  @ Fri, 15 Sep 2017 11:13:10: #2 Build Peak Model...
INFO  @ Fri, 15 Sep 2017 11:13:18: #2 number of paired peaks: 9006
INFO  @ Fri, 15 Sep 2017 11:13:18: start model_add_line...
INFO  @ Fri, 15 Sep 2017 11:13:31: start X-correlation...

Traceback (most recent call last):
  File ""/data/galaxy-dist/tool_dependency/macs2/2.1.0.20151222/iuc/package_macs2_2_1_0_20151222/e1370f7d5e2f/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.0.20151222', 'macs2')
  File ""/data/galaxy-dist/.venv/local/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 748, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/data/galaxy-dist/.venv/local/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 1524, in run_script
    exec(script_code, namespace, namespace)
  File ""/data/galaxy-dist/tool_dependency/macs2/2.1.0.20151222/iuc/package_macs2_2_1_0_20151222/e1370f7d5e2f/lib/python/MACS2-2.1.0.20151222-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 614, in <module>
   
  File ""/data/galaxy-dist/tool_dependency/macs2/2.1.0.20151222/iuc/package_macs2_2_1_0_20151222/e1370f7d5e2f/lib/python/MACS2-2.1.0.20151222-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 56, in main
   
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 175, in run
  File ""MACS2/PeakModel.pyx"", line 108, in MACS2.PeakModel.PeakModel.__init__ (MACS2/PeakModel.c:2385)
  File ""MACS2/PeakModel.pyx"", line 150, in MACS2.PeakModel.PeakModel.build (MACS2/PeakModel.c:2953)
  File ""MACS2/PeakModel.pyx"", line 230, in MACS2.PeakModel.PeakModel.__paired_peak_model (MACS2/PeakModel.c:4209)
ValueError: max() arg is an empty sequence


Any idea ?

Thanks
Julie",juliechevalier,https://github.com/macs3-project/MACS/issues/213
MDU6SXNzdWUyNjM4ODU3Mzg=,Cutoff analysis hitch,CLOSED,2017-10-09T12:57:50Z,2020-04-24T15:07:00Z,2020-04-24T15:07:00Z,"When running `callpeak` with `--cutoff-analysis`, I'm hitting a `KeyError`, with what looks like maybe a negative log of a small probability value. I'm wondering if any others have encountered something similar, and whether there's a known cause/workaround.
```
INFO  @ Fri, 06 Oct 2017 18:32:35: #3 Call peaks... 
INFO  @ Fri, 06 Oct 2017 18:32:35: #3 Pre-compute pvalue-qvalue table... 
INFO  @ Fri, 06 Oct 2017 18:32:35: #3 Cutoff will be automatically decided! 
Traceback (most recent call last):
  File ""~/venvs/macs2/bin/macs2"", line 617, in <module>
    main()
  File ""~/venvs/macs2/bin/macs2"", line 57, in main
    run( args )
  File ""~/venvs/macs2/local/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 105, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1632)
  File ""MACS2/PeakDetect.pyx"", line 263, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:3460)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 861, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12334)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 884, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:11697)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 850, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__pre_computes (MACS2/IO/CallPeakUnit.c:11115)
KeyError: 9.899999618530273
```",vreuter,https://github.com/macs3-project/MACS/issues/214
MDU6SXNzdWUyNjQwNjI4MTg=,"""-1"" Summit Values lead to ""TypeError: unorderable types: NoneType() < int()"" with IDR",CLOSED,2017-10-10T00:24:18Z,2024-11-13T18:19:24Z,2024-11-13T18:19:23Z,"Cross-posting this issue from nboley/idr repository, as I think the issue using IDR is related to the output from MACS2 call peak:

Trying to call peaks on an ATAC-seq sample (using the ENCODE ATAC-seq pipeline from kundajelab/atac_dnase_pipelines) which uses macs2 for peak calling.

My macs2 command is:

```
macs2 callpeak \
-t /gpfs/gpfs1/home/ATAC_SEQ/Sample_1.trim.PE2SE.nodup.tn5.tagAlign.gz\
-f BED \
-n ""/gpfs/gpfs1/home/ATAC_SEQ/Sample_1.trim.PE2SE.nodup.tn5.pf""
-g ""hs"" \
-p 0.01 \
--nomodel --shift -37 --extsize 73 -B --SPMR --keep-dup all --call-summits 

```

 Everything works fine on some samples, but occasionally during the pipeline (and if i run the steps individually myself) IDR after calling peaks will fail with the following error: 

```
Traceback (most recent call last):
  File ""/gpfs/gpfs1/home/miniconda3/envs/bds_atac_py3/bin/idr"", line 4, in <module>
    __import__('pkg_resources').run_script('idr==2.0.3', 'idr')
  File ""/gpfs/gpfs1/home/miniconda3/envs/bds_atac_py3/lib/python3.5/site-packages/pkg_resources/__init__.py"", line 748, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/gpfs/gpfs1/home/miniconda3/envs/bds_atac_py3/lib/python3.5/site-packages/pkg_resources/__init__.py"", line 1517, in run_script
    exec(code, namespace, namespace)
  File ""/gpfs/gpfs1/home/miniconda3/envs/bds_atac_py3/lib/python3.5/site-packages/idr-2.0.3-py3.5-linux-x86_64.egg/EGG-INFO/scripts/idr"", line 10, in <module>
    idr.idr.main()
  File ""/gpfs/gpfs1/home/miniconda3/envs/bds_atac_py3/lib/python3.5/site-packages/idr-2.0.3-py3.5-linux-x86_64.egg/idr/idr.py"", line 840, in main
    merged_peaks, signal_type = load_samples(args)
  File ""/gpfs/gpfs1/home/miniconda3/envs/bds_atac_py3/lib/python3.5/site-packages/idr-2.0.3-py3.5-linux-x86_64.egg/idr/idr.py"", line 760, in load_samples
    oracle_pks, args.use_nonoverlapping_peaks)
  File ""/gpfs/gpfs1/home/miniconda3/envs/bds_atac_py3/lib/python3.5/site-packages/idr-2.0.3-py3.5-linux-x86_64.egg/idr/idr.py"", line 281, in merge_peaks
    use_nonoverlapping_peaks=use_nonoverlapping_peaks)
  File ""/gpfs/gpfs1/home/miniconda3/envs/bds_atac_py3/lib/python3.5/site-packages/idr-2.0.3-py3.5-linux-x86_64.egg/idr/idr.py"", line 223, in merge_peaks_in_contig
    all_intervals.sort()
TypeError: unorderable types: int() < NoneType()

```

I found another user with the same issue after using MACS2 ( https://github.com/nboley/idr/issues/27), and it appears that the conversion of ""-1"" summit values called by macs2 is causing IDR to convert these summits to ""None"".

head -10 of macs2 call peak output file sorted with ""-1"" summit values:

```
chrom	chromStart	chromEnd	name	     score	strand	signal	pvalue	qvalue	peak
chr6	143608889	143608962	Peak_367001	29	.	2.781642.96535	0.83482	-1
chr21	18864214	18864362	Peak_366686	29	.	2.781642.96535	0.83482	-1
chr20	36662599	36662672	Peak_366672	29	.	2.781642.96535	0.83482	-1
chr13	50516550	50516623	Peak_366393	29	.	2.781642.96535	0.83482	-1
chr18	28161128	28161201	Peak_367933	29	.	2.767592.93914	0.81626	-1
chr1	145154724	145154839	Peak_367698	29	.	2.767592.93914	0.81626	-1
chr7	121425112	121425231	Peak_369596	29	.	2.753682.91339	0.79701	-1
chr7	114996427	114996500	Peak_369591	29	.	2.753682.91339	0.79701	-1
chr4	74529892	74529965	Peak_369431	29	.	2.753682.91339	0.79701	-1
chr13	33310992	33311065	Peak_368979	29	.	2.753682.91339	0.79701	-1
```

gets imported into IDR with ""-1"" summit lines reading like as:

`(Peak(chrm='chr1', strand='.', start=176983596, stop=176983716, signal=2.66479, summit=None, signalValue=2.65491, pValue=2.66479, qValue=0.72361), 0), `


I suppose I am just wondering how a ""-1"" summit can arise when using macs2, i.e. if they are a meaningful value or just a ""failed peak"" that must be discarded before further analysis.

For reference, in a peak file of ~ 500k peaks, there are roughly 900 with ""-1"" summit values.

Is there anyone who has seen this issue or can provide some insight on its origin or how to deal with it?

Thanks!",hardigan,https://github.com/macs3-project/MACS/issues/215
MDU6SXNzdWUyNjQ2NTU5NjE=,MACS2 Stalling,CLOSED,2017-10-11T16:36:19Z,2024-11-13T18:08:58Z,2024-11-13T18:08:58Z,"For some of my samples, MACS2 stalls when I remove the duplicates (either by --keep-dup 1 or when I manually remove the duplicates).  There is no error that is output, but the analysis is stalled at for example:
""INFO  @ Tue, 10 Oct 2017 11:02:53: #3 Call peaks... 
INFO  @ Tue, 10 Oct 2017 11:02:53: #3 Pre-compute pvalue-qvalue table... ""
",sklasfeld,https://github.com/macs3-project/MACS/issues/216
MDU6SXNzdWUyNjU1NDE1MjQ=,"BAMPE and BEDPE gave dramatically different ""mean fragment size"" ",OPEN,2017-10-15T03:03:48Z,2018-03-12T10:41:24Z,,"Using the same paired-end data, BAMPE gave mean fragment size of 111bp, while BEDPE mode gave mean fragment size of 259bp. Two logs were attached.

To produce bedpe files from BAM files, I followed one previous thread:
https://github.com/taoliu/MACS/issues/183
 Basically, I used ""samtools view -b -f 2 -F 4 -F 8 -F 256 -F 512 -F 2048"" to select reads first, and finally cut 3 columns of bedtools ouput to make the bedpe files specific to MACS2. 

I also used ""Picard  collectinsertsizemetrics"" to check insert size distribution, the median of which is very close to the ""mean fragment size"" in BEDPE mode. The size in BAMPE mode seemed mistakenly small.

I am using MACS2 2.1.1.20160309 installed with miniconda.

Thank you very much for the great tool! Just want to make sure I am using it correctly.

Xinwei Han
[s2_bampe.log](https://github.com/taoliu/MACS/files/1385159/s2_bampe.log)
[s2_bedpe.log](https://github.com/taoliu/MACS/files/1385160/s2_bedpe.log)



 ",xinweihan,https://github.com/macs3-project/MACS/issues/217
MDU6SXNzdWUyNjU2NjI1Njk=,peak calling  on scalfold level or  a great many chromosomes,OPEN,2017-10-16T06:49:33Z,2017-11-18T12:46:05Z,,"MACS2 always perform well when the number of chromosomes of my input bam files, but today, my bam file are on scalfold level, with 320000 scalfolfds.  MACS2 running 24 hours and returns nothing result, and I don't know when this program can finished.  Except the running time,  when the scalfold number is large, MACS2  cost 50Gb  disk space. 

Is  anyone meet such question?  I am so confused about this matter.

Thanks !",liulingnovo,https://github.com/macs3-project/MACS/issues/218
MDU6SXNzdWUyNjg3NzQ3MDU=,MACS2 Set pValue to -1 and terrifies IDR,OPEN,2017-10-26T14:08:41Z,2017-10-26T14:09:19Z,,"Hi It seems MACS2 Set pValue for some peaks to -1 and IDR cannot accept that and crashed
have to convert all -1 to 0 and it worked",amirshams84,https://github.com/macs3-project/MACS/issues/220
MDU6SXNzdWUyNzQxNjQ5MDE=,Error with --nolamda option enabled,OPEN,2017-11-15T13:56:46Z,2020-05-27T15:52:33Z,,"Greetings,

I am facing some troubles when I am using --nolamda option:

macs2 callpeak -t CB9TUACXX_OATAC_TAS_17s005511-1-1_lane6_1_sequence.dup.bed -f BED --nomodel --nolambda --keep-dup all --shift 37 --extsize 73 -n peak_calling/nolambda_out

...

INFO  @ Wed, 15 Nov 2017 14:44:10:  50000000 
INFO  @ Wed, 15 Nov 2017 14:44:12:  51000000 
INFO  @ Wed, 15 Nov 2017 14:44:14:  52000000 
INFO  @ Wed, 15 Nov 2017 14:44:16:  53000000 
INFO  @ Wed, 15 Nov 2017 14:44:19:  54000000 
INFO  @ Wed, 15 Nov 2017 14:44:21:  55000000 
INFO  @ Wed, 15 Nov 2017 14:44:23:  56000000 
INFO  @ Wed, 15 Nov 2017 14:44:26: #1 tag size is determined as 49 bps 
INFO  @ Wed, 15 Nov 2017 14:44:26: #1 tag size = 49 
INFO  @ Wed, 15 Nov 2017 14:44:26: #1  total tags in treatment: 56122595 
INFO  @ Wed, 15 Nov 2017 14:44:26: #1 finished! 
INFO  @ Wed, 15 Nov 2017 14:44:26: #2 Build Peak Model... 
INFO  @ Wed, 15 Nov 2017 14:44:26: #2 Skipped... 
INFO  @ Wed, 15 Nov 2017 14:44:26: #2 Sequencing ends will be shifted towards 3' by 37 bp(s) 
INFO  @ Wed, 15 Nov 2017 14:44:26: #2 Use 73 as fragment length 
INFO  @ Wed, 15 Nov 2017 14:44:26: #3 Call peaks... 
INFO  @ Wed, 15 Nov 2017 14:44:26: # local lambda is disabled! 
INFO  @ Wed, 15 Nov 2017 14:44:26: #3 !!!! DYNAMIC LAMBDA IS DISABLED !!!! 
INFO  @ Wed, 15 Nov 2017 14:44:26: #3 Pre-compute pvalue-qvalue table... 
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 614, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 56, in main
    run( args )
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak_cmd.py"", line 261, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 110, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1665)
  File ""MACS2/PeakDetect.pyx"", line 364, in MACS2.PeakDetect.PeakDetect.__call_peaks_wo_control (MACS2/PeakDetect.c:4714)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 858, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12340)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 883, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:11717)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 653, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__cal_pvalue_qvalue_table (MACS2/IO/CallPeakUnit.c:9065)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 496, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__pileup_treat_ctrl_a_chromosome (MACS2/IO/CallPeakUnit.c:7329)
TypeError: 'float' object cannot be interpreted as an index

while when I do not enable it, the program is run with no errors.

Any help would be appreciated.",dimkonstanto,https://github.com/macs3-project/MACS/issues/221
MDU6SXNzdWUyNzQ1NjM5NDY=,bdgdiff output peak numbers don't match up with the narrowPeak results numbers,OPEN,2017-11-16T15:48:03Z,2018-02-10T00:27:53Z,,"Hi Tao Liu,

I'm a researcher in Korea, republic of, using MACS2 for analysing ChIP-seq peaks.
I wanted to know how the peaks are different or common in my experiment conditions.
(ex. overlaps of cond1 vs cond2, peaks in just cond1, peaks in just cond2)
So I followed your instructions you wrote.
https://github.com/taoliu/MACS/wiki/Call-differential-binding-events
(What's the option -g and -l in the bdgdiff command?? I assumed they are the half point of the extsize and the extsize each. Are they right?)

And I got the result. The result file "".narrowPeak"" gave me like 5000 peaks in cond1 and 1000 peaks in cond2. But the result of differential binding command above, gave me that more enriched peaks in cond1 is like 2000 peaks, more enriched peaks in cond2 is 2, peaks enriched commonly are like 600 peaks.
Q1. I'm curious where are the rest of the peaks I got from the narrowPeak files??
Q2. Is there any advise you can give me how to get the overlaping peaks and not overlaping peaks in each results using outputs of MACS2??

It'll be very grateful if you could give me some advise or directions.


It's the first time using this git issue section, so if there's anything wrong about the way I wrote 'issue' or said something that are not appropriate, please let me know.

Thank you very much.

Best, Woongjae
",N/A,https://github.com/macs3-project/MACS/issues/222
MDU6SXNzdWUyNzg3ODIxOTg=,Release schedule,OPEN,2017-12-03T14:27:04Z,2017-12-27T14:24:44Z,,"Good morning,

Wondering if you might be able to do an official 2.1.0 release in the near future.  This would be helpful to those of us maintaining packages.  I'm personally maintaining a FreeBSD port and a pkgsrc package.

We can work with Github commits, but that requires playing some games with the versioning to ensure compatibility with future releases.

Cheers,

    Jason",outpaddling,https://github.com/macs3-project/MACS/issues/223
MDU6SXNzdWUyODAzNDkyMDc=,tag size,CLOSED,2017-12-08T02:29:47Z,2018-11-14T13:04:40Z,2018-11-14T13:04:40Z,"Hi,

I am confused about the macs2 parameter -s/--tsize. I find tag size determined by macs2 is not the same as read length in my paired-end chip-seq data. Any one can tell me the difference between tags and reads? And, what cause the difference  ?",wangjiawen2013,https://github.com/macs3-project/MACS/issues/224
MDU6SXNzdWUyODQ0NTc1Njk=,Results for MACS2,OPEN,2017-12-25T16:11:03Z,2017-12-25T16:11:03Z,,"Dear Tao,
   I am confused about the results of MACS2 (2.1.0). There are some peaks which have strong signal both in Input and ChIP sample. I don’t think these peaks are real.
   The command as : macs2 callpeak -t ChIP.bam -c Input.bam -f BAMPE -g 5.94e9 -q 0.05 -B --name name –outdir outdir
   There is an example:
[Question1.pdf](https://github.com/taoliu/MACS/files/1585995/Question1.pdf)

   Best
   QingLiu",liuqing1992,https://github.com/macs3-project/MACS/issues/225
MDU6SXNzdWUyODUzMTE2Njg=,[MACS2] False negative peak calling problem,CLOSED,2018-01-01T15:00:04Z,2018-01-01T16:25:44Z,2018-01-01T16:25:44Z,"Hi, all.
Now I am using MACS2 to analyse ChIP-seq data of histone modification. I found that some obvious peaks were not called from MACS2, while some less obvious peaks were recognized by MACS2. In addition, no matter how I loosen the parameters, those obvious peaks were not included. I am wondering the reason behind this.
The parameter used to generate the following example:
macs2 callpeak -t treatmen.bam -c input.bam -n output_name -g mm --bdg --broad -p 0.01 -m 3 99999
Peaks defined by MACS2:
![image](https://user-images.githubusercontent.com/22598576/34468601-3fd64d06-ef04-11e7-9f6a-aa5ba6dfb081.png)

Peak missed by MACS2:
![image](https://user-images.githubusercontent.com/22598576/34468607-4bfe1262-ef04-11e7-9da8-76fc8053d3b5.png)

Thanks!",dudelaw,https://github.com/macs3-project/MACS/issues/226
MDU6SXNzdWUyODU2Mzg3NjE=,bdg files with different intervals,OPEN,2018-01-03T09:47:53Z,2018-01-03T09:53:25Z,,"Dear Tao Liu @taoliu ,

I am working on two sets of ChIP-seq peaks results called by MACS2 (v2.1.0.20150731) to compare signals of peaks in two conditions.

The setup of two sets of ChIP experiments is:
1. WT cell line: ChIP of 3 different antibodies (A1, A2, A3), with 1 total input as the control for all 3 ChIP
2. KO cell line: ChIP of 3 different antibodies (A1, A2, A3), with 1 total input as the control for all 3 ChIP

What I want to figure out is whether the signals of peaks called from this two cell line are significantly different in A3 ChIP.
To work this out, I run MACS2 with -B parameter to generate bdg files. So for each cell line, I can get NAME_control_lambda.bdg and NAME_treat_pileup.bdg (NAME = A1 or A2 or A3).
`
macs2 callpeak -t ../CHH31473.mapq30.bam ../CHH31477.mapq30.bam -c ../CHH31476.mapq30.bam ../CHH31480.mapq30.bam -f BAM --outdir ./peaksResult -n WT_A1 -g hs --nomodel --extsize 147 -B -p 0.01
`
### Different intervals in bdg files
What I found out is that in the same cell line, the intervals in 3 NAME_control_lambda.bdg files are different. My guess is that it's because I used different fragment sizes. However, looking at the control and treat bdg files for a same antibody in the same cell line, the intervals are totally different.

What is in A1_control_lambda.bdg:
> chr1    0       9977    1.72096
chr1    9977    10062   2.00000
chr1    10062   10067   3.00000
chr1    10067   10075   2.00000
chr1    10075   10112   1.72096
chr1    10112   10121   1.76400
chr1    10121   10407   1.86200
chr1    10407   10454   2.00000
chr1    10454   10493   3.00000
chr1    10493   10498   2.00000
chr1    10498   10504   3.00000
...

What is in A1_treat_pileup.bdg:
> chr1    0       10021   0.00000
chr1    10021   10033   0.82917
chr1    10033   10119   1.65834
chr1    10119   10131   0.82917
chr1    10131   10440   0.00000
chr1    10440   10450   0.82917
chr1    10450   10454   1.65834
chr1    10454   10459   2.48751
chr1    10459   10463   3.31668
chr1    10463   10519   4.14585
chr1    10519   10538   4.97503
...

How does this happen? What are the numbers stand for in the fourth column? Also, MACS2 would scale down the larger library by the ratio of `large_library/small_library`, I would expect one bdg file to be all integer while the other one should be in float number. However, I saw a mixture of both integer and float numbers in a single bdg file.

### How to get the average signal of every single peak
In order to compare signals of peaks in two cell line, what is the proper way to compute the signals if a peaks span across many intervals in bdg file? Is it suitable to just sum all the signals and divided with the number of intervals a peak span across? 
In consideration of the control, should I subtract the control signal from treat signal before I compare them between the 2 cell lines? What should we do if the control signal is bigger than the treat signal? 
For example, in the quote above, the control signal is `chr1    10454   10493   3.00000`, while the treat signal is ```chr1    10454   10459   2.48751
chr1    10459   10463   3.31668
chr1    10463   10519   4.14585```

Thank you so much!
Best regards.
Yichao
  ",yichao-cai,https://github.com/macs3-project/MACS/issues/227
MDU6SXNzdWUyODk1NTA4MjM=,ImportError: No module named callpeak_cmd,OPEN,2018-01-18T08:58:49Z,2018-01-18T08:58:49Z,,"I have used MACS2 for some time, it works on my linux server. But recently it failed when I run as I used to perform. The alerts are as bellow:
------------------------------------
Traceback (most recent call last):
  File ""/apps/MACS2-2.1.1.20160309/bin/macs2"", line 617, in <module>
    main()
  File ""/apps/MACS2-2.1.1.20160309/bin/macs2"", line 56, in main
    from MACS2.callpeak_cmd import run
ImportError: No module named callpeak_cmd
-----------------------------------------
I wonder if someone can give some help to solve such a problem. Thanks in advance.",weig-fd,https://github.com/macs3-project/MACS/issues/228
MDU6SXNzdWUyOTMyMzMwNDY=,UMIs in MACS2,OPEN,2018-01-31T16:52:50Z,2018-01-31T16:52:50Z,,"Hi folks,

We have UMI sequences stored in the RX tag in our BAM files. Is there a way to get MACS2 to use the UMI information other than pre-processing the BAM files?

thanks,
Richard",RichardCorbett,https://github.com/macs3-project/MACS/issues/230
MDU6SXNzdWUyOTYyMTM3Njk=,MACS stalling - different behaviour if using pip and bioconda downloads,OPEN,2018-02-11T18:40:47Z,2019-04-11T15:38:33Z,,"Using the following call in MACS2:

`macs2 callpeak -t {input} -f BAMPE -B -g hs --outdir peak_files/ -n  {name}`

MACS2 either stalls or presents an error message depending on whether I download MACS2 and its dependencies using `pip install macs2` or `conda install bioconda -c macs2`. I've tried both as I cannot get MACS2 to finish a peak calling job. 

In both versions the error is thrown at the `INFO  @ Fri, 09 Feb 2018 16:44:45: #3 Pre-compute pvalue-qvalue table...` stage as mentioned by a [previous individual](https://github.com/taoliu/MACS/issues/216). 

If using the `pip` installed version, this error is thrown:

```
INFO  @ Sun, 11 Feb 2018 18:47:43: #3 Pre-compute pvalue-qvalue table... 
Traceback (most recent call last):
  File ""/home/c1477909/.conda/envs/macs2/bin/macs2"", line 617, in <module>
    main()
  File ""/home/c1477909/.conda/envs/macs2/bin/macs2"", line 57, in main
    run( args )
  File ""/home/c1477909/.conda/envs/macs2/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 110, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1665)
  File ""MACS2/PeakDetect.pyx"", line 364, in MACS2.PeakDetect.PeakDetect.__call_peaks_wo_control (MACS2/PeakDetect.c:4714)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 861, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12334)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 886, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:11711)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 695, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__cal_pvalue_qvalue_table (MACS2/IO/CallPeakUnit.c:9488)
KeyError: nan
```

However if using the `bioconda` installed version the software stalls at the `Pre-compute pvalue-qvalue table...` line and doesn't exit.

I run MACS2 in a virtual environment. Here is the spec I use using either installation:

```
name: macs2
channels:
- defaults
dependencies:
- certifi=2016.2.28=py27_0
- openssl=1.0.2l=0
- pip=9.0.1=py27_1
- python=2.7.13=0
- readline=6.2=2
- setuptools=36.4.0=py27_1
- sqlite=3.13.0=0
- tk=8.5.18=0
- wheel=0.29.0=py27_0
- zlib=1.2.11=0
- pip:
  - macs2==2.1.1.20160309
  - numpy==1.14.0
prefix: /home/c1477909/.conda/envs/macs2
```

I'm pretty stumped here as MACS2 has worked fine in the past for me, but I've had to update everything recently, so I may have been using older versions of MACS2 (or its dependencies) that previously worked fine, but I've not got a record if this. 

A quick look at the downsized bam file I'm using to test this shows that there are a lot of additional chromosomes in the file, not sure if this could be causing the issue but I doubt it as I have older bam files that have been processed perfectly well before containing these:

```
chr10 131285
chr11 149926
chr11_gl000202_random 10
chr12 146778
chr13 95596
chr14 107526
chr15 71546
chr16 80665
chr17_ctg5_hap1 580
chr17 81460
chr17_gl000203_random 11
chr17_gl000204_random 12
chr17_gl000205_random 1525
chr17_gl000206_random 13
chr18 75456
chr18_gl000207_random 2
chr19 70306
chr19_gl000208_random 152
chr19_gl000209_random 29
chr1 373698
chr1_gl000191_random 62
chr1_gl000192_random 330
chr20 55192
chr21 31701
chr21_gl000210_random 4
chr22 25992
chr2 259442
chr3 216100
chr4_ctg9_hap1 252
chr4 172614
chr4_gl000193_random 175
chr4_gl000194_random 143
chr5 219488
chr6_apd_hap1 690
chr6_cox_hap2 1406
chr6_dbb_hap3 1307
chr6 178887
chr6_mann_hap4 1057
chr6_mcf_hap5 1216
chr6_qbl_hap6 1361
chr6_ssto_hap7 1296
chr7 181426
chr7_gl000195_random 1698
chr8 152503
chr8_gl000196_random 3
chr8_gl000197_random 25
chr9 125321
chr9_gl000198_random 61
chr9_gl000199_random 1057
chr9_gl000200_random 54
chr9_gl000201_random 38
chrM 0
chrUn_gl000211 63
chrUn_gl000212 119
chrUn_gl000213 36
chrUn_gl000214 240
chrUn_gl000215 26
chrUn_gl000216 342
chrUn_gl000217 79
chrUn_gl000218 88
chrUn_gl000219 394
chrUn_gl000220 9791
chrUn_gl000221 106
chrUn_gl000222 112
chrUn_gl000223 215
chrUn_gl000224 195
chrUn_gl000225 682
chrUn_gl000226 697
chrUn_gl000227 56
chrUn_gl000228 158
chrUn_gl000229 24
chrUn_gl000230 12
chrUn_gl000231 27
chrUn_gl000232 35
chrUn_gl000233 12
chrUn_gl000234 52
chrUn_gl000235 21
chrUn_gl000236 9
chrUn_gl000237 35
chrUn_gl000238 7
chrUn_gl000239 21
chrUn_gl000240 14
chrUn_gl000241 106
chrUn_gl000242 10
chrUn_gl000243 30
chrUn_gl000244 18
chrUn_gl000245 26
chrUn_gl000246 5
chrUn_gl000247 21
chrUn_gl000248 9
chrUn_gl000249 7
chrX 82277
chrY 11873
```
",Dazcam,https://github.com/macs3-project/MACS/issues/231
MDU6SXNzdWUzMDE2MDQ4MjY=,Bug: Some kind of memory error?,OPEN,2018-03-01T23:57:16Z,2019-09-19T20:15:06Z,,"Hi there,

I'm running MACS2 to analyze some ATAC-Seq data. I have a genome size of 3.6GB or so, and around 10-50 million reads mapped using Bowtie2 per sample. For the smaller samples, MACS2 is succeeding just fine, but for the larger samples, I keep getting the error below.

I am running MACS2 on a SLURM cluster, using a single node with 20 cores and 512GB memory, so I'd be surprised if there wasn't enough memory to go around... Please let me know if there's some obvious thing I can do to solve this.

INFO  @ Thu, 01 Mar 2018 13:17:34: #1 mean fragment size is determined as 54 bp from treatment 
INFO  @ Thu, 01 Mar 2018 13:17:34: #1 fragment size = 54 
INFO  @ Thu, 01 Mar 2018 13:17:34: #1  total fragments in treatment: 79240199 
INFO  @ Thu, 01 Mar 2018 13:17:34: #1 finished! 
INFO  @ Thu, 01 Mar 2018 13:17:34: #2 Build Peak Model... 
INFO  @ Thu, 01 Mar 2018 13:17:34: #2 Skipped... 
INFO  @ Thu, 01 Mar 2018 13:17:34: #2 Use 54 as fragment length 
INFO  @ Thu, 01 Mar 2018 13:17:34: #3 Call peaks... 
INFO  @ Thu, 01 Mar 2018 13:17:34: #3 Pre-compute pvalue-qvalue table... 
Traceback (most recent call last):
  File ""/clusterfs/vector/home/groups/software/sl-7.x86_64/modules/macs/2.1.1/bin/macs2"", line 617, in <module>
    main()
  File ""/clusterfs/vector/home/groups/software/sl-7.x86_64/modules/macs/2.1.1/bin/macs2"", line 57, in main
    run( args )
  File ""/clusterfs/vector/home/groups/software/sl-7.x86_64/modules/macs/2.1.1/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 110, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1665)
  File ""MACS2/PeakDetect.pyx"", line 364, in MACS2.PeakDetect.PeakDetect.__call_peaks_wo_control (MACS2/PeakDetect.c:4714)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 861, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12334)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 886, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:11711)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 656, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__cal_pvalue_qvalue_table (MACS2/IO/CallPeakUnit.c:9059)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 483, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__pileup_treat_ctrl_a_chromosome (MACS2/IO/CallPeakUnit.c:7032)
  File ""MACS2/IO/PairedEndTrack.pyx"", line 510, in MACS2.IO.PairedEndTrack.PETrackI.pileup_a_chromosome (MACS2/IO/PairedEndTrack.c:8254)
  File ""MACS2/IO/PairedEndTrack.pyx"", line 528, in MACS2.IO.PairedEndTrack.PETrackI.pileup_a_chromosome (MACS2/IO/PairedEndTrack.c:8045)
  File ""MACS2/Pileup.pyx"", line 661, in MACS2.Pileup.quick_pileup (MACS2/Pileup.c:9292)
  File ""MACS2/Pileup.pyx"", line 698, in MACS2.Pileup.quick_pileup (MACS2/Pileup.c:8468)
MemoryError",mezarque,https://github.com/macs3-project/MACS/issues/232
MDU6SXNzdWUzMDkzOTA2NTY=,Extend Documentation about CallPeaks .narrowPeaks output format,OPEN,2018-03-28T14:26:01Z,2018-03-28T14:26:39Z,,"The [README documentation of CallPeak output files](https://github.com/taoliu/MACS#output-files) states

> 2. NAME_peaks.narrowPeak is BED6+4 format file which contains the peak locations together with peak summit, pvalue and qvalue. You can load it to UCSC genome browser. Definition of some specific columns are:
    - 5th: integer score for display
    - 7th: fold-change
    - 8th: -log10pvalue
    - 9th: -log10qvalue
    - 10th: relative summit position to peak start

But it's unclear what p-value, q-value, and fold-change represent here. A little expansion of the documentation would be extremely helpful! 

",alexlenail,https://github.com/macs3-project/MACS/issues/233
MDU6SXNzdWUzMTE5MTIyOTQ=,MACS2- AttributeError: 'Namespace' object has no attribute 'tempdir',CLOSED,2018-04-06T09:42:53Z,2018-10-03T20:44:42Z,2018-10-03T20:44:42Z,"Hello,

I am using MACS2 2.1.1.2016039 to analyse  test ChIP-Seq  data from Feng et al, 2012 Nature Protocols paper. I have installed MACS2 using PyPI on Linux machine under python 2.7.  I get the following error when I run callpeak 
macs2 callpeak -t HAIB_T47D_FoxA1.sam -g hs -n foxa1test 

Traceback (most recent call last):
File ""/usr/bin/macs2"", line 614, in <module>main()
File ""/usr/bin/macs2"", line 56, in main
run( args )
File ""/home/venky/.local/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 68, in run
tempfile.tempdir = options.tempdir
AttributeError: 'Namespace' object has no attribute 'tempdir'

I have tried modifying the command to 
macs2 callpeak -t HAIB_T47D_FoxA1.sam -g hs -n foxa1test --tempdir ./TEMP
But this gives the error message “unrecognised arguments: --tempdir ./TEMP”.
Can you tell me how this issue can be solved? Thank you.

Sincerely,
Subhashini",subhashini-sadasivam,https://github.com/macs3-project/MACS/issues/234
MDU6SXNzdWUzMTYzNzcyNzg=,`bdgdiff` outputs are empty?,OPEN,2018-04-20T19:00:57Z,2018-04-20T19:00:57Z,,"Hi,

I am using `macs2` version 
    ```
    [sm2556@c13n01 b9-hu-smad3]$ macs2 --version
    macs2 2.1.1.20160309
    ```

The `bdgdiff` outputs are empty.  I used the `--SPMR` when calling peaks, and used those generated `.bdg` files with `bdgdiff`.  Am I doing something wrong?  Why would all the three output files be empty.

Best,",sameet,https://github.com/macs3-project/MACS/issues/235
MDU6SXNzdWUzMTc5OTI2NjU=,Callpeaks function and the -g argument for mixed species genome,OPEN,2018-04-26T11:44:48Z,2018-04-26T12:27:58Z,,"Hi there,

I have a mixed sample mapped with custom reference genome which is composed of both human hg19 and mouse mm10. In the callpeak function, what -g value should I assign? 

Simon",shengyongniu,https://github.com/macs3-project/MACS/issues/236
MDU6SXNzdWUzMTg3MzUwMzM=,Problem with MACS2 results,OPEN,2018-04-29T17:40:20Z,2018-04-29T17:40:20Z,,"Hi,

I am trying to analyze some ChIPSeq data from Myxococcus xanthus. I tried this and I obtained the following message:

callpeak -t /home/eduardo/Documentos/DATOS_TFG/Resultados_Alineamiento/CarD_AntiFLAG_CrecidoLUZ_1.bam -f BAM -g 9.14e+06 -n CarD_AntiCarD_CrecidoLUZ_1

WARNING @ Sun, 29 Apr 2018 19:22:42: Too few paired peaks (0) so I can not build the model! Broader your MFOLD range parameter may erase this error. If it still can't build the model, we suggest to use --nomodel and --extsize 147 or other fixed number instead. WARNING @ Sun, 29 Apr 2018 19:22:42: Process for pairing-model is terminated!

Then, I tried this to solve the problem

callpeak -t /home/eduardo/Documentos/DATOS_TFG/Resultados_Alineamiento/CarD_AntiFLAG_CrecidoLUZ_1.bam -f BAM -g 9.14e+06 -n CarD_AntiCarD_CrecidoLUZ_1 --fix-bimodal --extsize 100

The problem is solve but I don't know if the data are reliable. I'd appreciate any guidance. Thanks for your attention.
",eduillueca,https://github.com/macs3-project/MACS/issues/237
MDU6SXNzdWUzMTkwODQ5NjY=,Q: Limit number of threads,OPEN,2018-05-01T01:00:43Z,2022-12-07T11:03:25Z,,"Hi,

I'm running macs2 through miniconda3 on a shared server. It looks like macs2 by default uses the maximum number of available cores to spawn subprocesses during peak calling, thereby blocking anyone else from using the server. How can I limit the number of processes macs2 is allowed to run? I'm unable to find an option for that.

Thanks!",dwesche,https://github.com/macs3-project/MACS/issues/238
MDU6SXNzdWUzMTk0NTQwODg=,An odd number of differential peaks in MACS2,OPEN,2018-05-02T08:16:49Z,2018-05-02T08:16:49Z,,"hi, 
I'm working with ChIP-seq data and using MACS2 version- macs2 2.1.0.20140616.
I run MACS2 callpeak twice for two different data sets to find the enrichment peaks for each one of them. I got 22,830 peaks at the first and 28,911 peaks at the second,  when I use the bdg files for running bdgdiff it find only 6 and 183 differential peaks. 
why does MACS2 remove so many of the peaks? in which parameters should I focus on? 
thanks,
Nehora.
",nehoralevi,https://github.com/macs3-project/MACS/issues/239
MDU6SXNzdWUzMjczNDM4Mjk=,ubiquitus protein,OPEN,2018-05-29T14:23:32Z,2018-05-29T14:23:32Z,,"Hello,
I would like to use MACS to analyse ChIP-Seq of a structural protein which is found on many of positions all along the genome.

Do you know if MACS2 is suited for this purpose ?

Thanks a lot !",rmontagn,https://github.com/macs3-project/MACS/issues/241
MDU6SXNzdWUzMjc3NjY1MjE=,Feat: move to python3,CLOSED,2018-05-30T14:49:37Z,2019-10-04T04:17:29Z,2019-10-03T18:46:51Z,"Hi @taoliu 

What are the plans for moving macs2 code to python3? 
",vivekbhr,https://github.com/macs3-project/MACS/issues/242
MDU6SXNzdWUzMjc3NzMzNTc=,Sorted vs unsorted bam file,OPEN,2018-05-30T15:04:56Z,2018-05-30T15:04:56Z,,"Hello,

I have just tested macs2 for chip-seq peak calling on the same bam files sorted vs unsorted. I have sorted (using samtools) 4 different bam files, and the number of peaks called using the same standard command is quite different between pairs, going from 30 to 400 peaks difference between sorted vs unsorted. Any thoughts? 

Thanks!
Anna",ao358,https://github.com/macs3-project/MACS/issues/243
MDU6SXNzdWUzMzE4ODk4Mzk=,MACS2  with  ATAC-seq ?,CLOSED,2018-06-13T08:20:47Z,2018-07-17T08:25:45Z,2018-07-17T08:25:45Z,How to call peak with MACS2 ? ,hmyh1202,https://github.com/macs3-project/MACS/issues/244
MDU6SXNzdWUzMzE5MTE3ODk=,Fold Enrichment ?,CLOSED,2018-06-13T09:24:09Z,2024-11-13T18:20:51Z,2024-11-13T18:20:51Z,"I am new in ChIP-seq, what is fold enrichment, and how to calculation that value ?",hmyh1202,https://github.com/macs3-project/MACS/issues/245
MDU6SXNzdWUzMzgwODQ5MzU=,why cond1 peaks number + common peaks number > narrow.peaks number?,OPEN,2018-07-03T23:29:50Z,2018-07-03T23:29:50Z,,"Hi, when i use macs2 diffpeak to find overlap and individual peaks of different TF, i find a weird things. I total have ~18000 peaks in condition1. But I get overlappeaks ~17000 in both condition(one bed file), and I get ~13000 peaks only in condition 1( another bed file). if 17000+13000 >> 18000? I do not understand how to explain this thing. Did someone can give me some suggestion? Thanks
",yachenshen2017,https://github.com/macs3-project/MACS/issues/246
MDU6SXNzdWUzNDA4MzAxMDQ=,merging bams vs providing separate bams to MACS2,OPEN,2018-07-12T23:18:00Z,2018-07-12T23:18:00Z,,"Hi,

I recently ran MACS2 on a set of ~100 bam files.  I tried with two different methods: 1) providing the list of all 100 files to macs2 directly, and 2) merging the files first with samtools, and then running macs2.

I get about double the number of peaks, with many fewer summits, in the merged set (ie method 2) than from the first analysis.  The readme and manuscript say that macs pools the reads from all provided bams when you run it, so I am confused what the difference is caused from.

Any explanation into why the results are different, and which method should be used and why, would be greatly appreciated!

Thanks!",billgreenwald,https://github.com/macs3-project/MACS/issues/247
MDU6SXNzdWUzNDA5ODgyNzg=,install problem python version egg_info,CLOSED,2018-07-13T11:44:53Z,2019-10-03T19:12:03Z,2019-10-03T19:12:03Z,"Hi there. 
Sorry to open an issue, but I am really lost here. Everything seem to fit the requirements, but still I cannot install macs2 using pip.

Running:
```
$ sudo -H pip install macs2
Complete output from command python setup.py egg_info:
    CRITICAL: Python version must be 2.7

$ gcc --version
gcc (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609

$ uname -a
Linux WorkStation 4.13.0-45-generic #50~16.04.1-Ubuntu SMP Wed May 30 11:18:27 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux

$ sudo -H pip install Numpy Cython
Requirement already satisfied: Numpy in /usr/local/lib/python3.5/dist-packages (1.12.0)
Requirement already satisfied: Cython in /usr/local/lib/python3.5/dist-packages/Cython-0.28.3-py3.5-linux-x86_64.egg (0.28.3)

$ sudo apt install python-dev
python-dev is already the newest version (2.7.12-1~16.04)

```
-> Is there a problem with this python-dev ?? I build and installed python 2.7.15, but I don't think this is related. Any advice will be very welcome!
```
$ python --version
Python 2.7.15
```

regards",GildasLepennetier,https://github.com/macs3-project/MACS/issues/248
MDU6SXNzdWUzNDE2ODk1MTQ=,Paired input vs. control NameError: 'righ_pos' is not defined,OPEN,2018-07-16T21:43:05Z,2018-10-03T20:36:58Z,,"I've tried installing MACS2 with both pip and from source, but neither will satisfy this command. MACS2 successfully calls peaks with single samples, but I have not been able to successfully supply control samples in the same command.

Example:

```
callpeak -t treat1.bedpe treat2.bedpe \
-c control1.bedpe control2.bedpe \
-f BEDPE \
-n foo_broad \
-g mm \
--broad \
--broad-cutoff 0.05 \
--keep-dup all
```

Here's an example of the output error:

```
...
# Broad region calling is on
# Paired-End mode is on

INFO  @ Mon, 16 Jul 2018 17:25:17: #1 read fragment files...
INFO  @ Mon, 16 Jul 2018 17:25:17: #1 read treatment fragments...
INFO  @ Mon, 16 Jul 2018 17:25:19:  1000000
INFO  @ Mon, 16 Jul 2018 17:25:21:  2000000
INFO  @ Mon, 16 Jul 2018 17:25:23:  3000000
INFO  @ Mon, 16 Jul 2018 17:25:25:  4000000
INFO  @ Mon, 16 Jul 2018 17:25:26:  5000000
INFO  @ Mon, 16 Jul 2018 17:25:28:  6000000
INFO  @ Mon, 16 Jul 2018 17:25:30:  7000000
INFO  @ Mon, 16 Jul 2018 17:25:32:  8000000
INFO  @ Mon, 16 Jul 2018 17:25:34:  9000000
INFO  @ Mon, 16 Jul 2018 17:25:35:  10000000
INFO  @ Mon, 16 Jul 2018 17:25:37:  11000000
INFO  @ Mon, 16 Jul 2018 17:25:39:  12000000
INFO  @ Mon, 16 Jul 2018 17:25:41:  13000000
INFO  @ Mon, 16 Jul 2018 17:25:43:  14000000
INFO  @ Mon, 16 Jul 2018 17:25:44:  15000000
INFO  @ Mon, 16 Jul 2018 17:25:46:  16000000
INFO  @ Mon, 16 Jul 2018 17:25:48:  17000000
INFO  @ Mon, 16 Jul 2018 17:25:50:  18000000
INFO  @ Mon, 16 Jul 2018 17:25:52:  19000000
INFO  @ Mon, 16 Jul 2018 17:25:53:  20000000
INFO  @ Mon, 16 Jul 2018 17:25:55:  21000000
Traceback (most recent call last):
  File ""/mnt/home/reskejak/.local/bin/macs2"", line 617, in <module>
    main()
  File ""/mnt/home/reskejak/.local/bin/macs2"", line 57, in main
    run( args )
  File ""/mnt/home/reskejak/.local/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 72, in run
    if options.PE_MODE: (treat, control) = load_frag_files_options (options)
  File ""/mnt/home/reskejak/.local/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 364, in load_frag_files_options
    treat = tp.append_petrack( treat )
  File ""MACS2/IO/Parser.pyx"", line 421, in MACS2.IO.Parser.BEDPEParser.append_petrack (MACS2/IO/Parser.c:7748)
  File ""MACS2/IO/Parser.pyx"", line 448, in MACS2.IO.Parser.BEDPEParser.append_petrack (MACS2/IO/Parser.c:7536)
NameError: name 'righ_pos' is not defined
```

I appreciate any suggestions. Thank you.",reskejak,https://github.com/macs3-project/MACS/issues/249
MDU6SXNzdWUzNDI3NjgyNTQ=,ATAC-seq short peaks calling,CLOSED,2018-07-19T15:02:53Z,2018-07-24T07:46:01Z,2018-07-24T07:29:37Z,"Dear all,

I am working with ATAC-seq data and I use MACS2  `-f BAMPE`  for the peak calling as suggested; however, only the unexpectedly short peak at 1 nucleotide was detected (as seen from chr start and end positions shown below). 

i.e. 
chr1    778830  778831  SRR2920477_1.Bowtie2Mapping_sorted_fdr1_summits_peak_1  32.30726
chr1    870077  870078  SRR2920477_1.Bowtie2Mapping_sorted_fdr1_summits_peak_2  7.02096
chr1    897421  897422  SRR2920477_1.Bowtie2Mapping_sorted_fdr1_summits_peak_3  9.74649
chr1    906924  906925  SRR2920477_1.Bowtie2Mapping_sorted_fdr1_summits_peak_4  25.38635

Prior to the peak calling, I converted the sam file to sorted bam format using samtools. I really doubt in which step I did wrong and possibly cause this problem. I could not find such an error posted elsewhere so, I decided to put a question here. Thank you in advance for your response. 

Wannisa
",ritma001,https://github.com/macs3-project/MACS/issues/250
MDU6SXNzdWUzNDM5MDEzODM=,No model.r files generated,CLOSED,2018-07-24T06:29:02Z,2020-07-22T15:23:05Z,2018-10-03T20:34:58Z,"Hi. I ran execute MACS2 as below:
`macs2 callpeak -t ChIP.input1.bam ChIP.input2.bam ChIP.input3.bam -c Control.input1.bam Control.input2.bam -f BAM -g hs  --nomodel --extsize 147 -n output.macs
`
I have the following outputs:
```
output.macs_peaks.narrowPeak
output.macs_peaks.xls
output.macs_summits.bed
```
I realize that there is supposed to be model.r output as well but it is missing. Any idea how I could generate this file? The version of MACS2 is 2.1.2_dev. Thanks.  
",EPKok,https://github.com/macs3-project/MACS/issues/251
MDU6SXNzdWUzNDY3MzA0ODQ=,Macs2 Numpy Error,OPEN,2018-08-01T19:10:28Z,2018-10-03T20:34:16Z,,"I recently downloaded macs2 from the bioconda channel using conda.

I tried to call peaks on a bedgraph file with the following command:
""macs2 bdgpeakcall -i atac_seq/ENCFF700NIW.bedgraph -o test.bed""

However, I received the following error:
""Traceback (most recent call last):
  File ""/home/benauer/anaconda2/envs/conda_env/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.0.20150731', 'macs2')
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 750, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 1534, in run_script
    exec(script_code, namespace, namespace)
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 614, in <module>
    
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 63, in main
    
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/bdgpeakcall_cmd.py"", line 23, in <module>
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/IO/BedGraphIO.py"", line 7, in <module>
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/IO/BedGraphIO.py"", line 6, in __bootstrap__
  File ""MACS2/IO/BedGraphIO.pyx"", line 22, in init MACS2.IO.BedGraphIO (MACS2/IO/BedGraphIO.c:2577)
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/IO/BedGraph.py"", line 7, in <module>
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/IO/BedGraph.py"", line 6, in __bootstrap__
  File ""MACS2/IO/BedGraph.pyx"", line 32, in init MACS2.IO.BedGraph (MACS2/IO/BedGraph.c:19103)
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/IO/ScoreTrack.py"", line 7, in <module>
  File ""/home/benauer/anaconda2/envs/conda_env/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/IO/ScoreTrack.py"", line 6, in __bootstrap__
  File ""numpy.pxd"", line 155, in init MACS2.IO.ScoreTrack (MACS2/IO/ScoreTrack.c:31313)
ValueError: numpy.dtype has the wrong size, try recompiling""


Any idea of how to fix? Thanks.",bauerbach95,https://github.com/macs3-project/MACS/issues/252
MDU6SXNzdWUzNDcxOTIzNTA=,Is the -q parameter supposed to be different from manually filtering by q-value?,CLOSED,2018-08-02T22:10:29Z,2018-10-03T20:48:37Z,2018-10-03T20:48:37Z,"I've just found that if I run macs2 peak calling with the parameter ""-q 0.01"", then I run it again with the exact same input data but with the parameter ""-q 0.5"" and then filter the called peaks by looking at the second to last column, which is -log10qvalue, and only keeping peaks with a q-value <= 0.01, I get very different numbers of peaks. Filtering manually after running with a higher q-value cutoff results in thousands more peaks. Is this working as intended? What is happening to cause this difference?",kernco,https://github.com/macs3-project/MACS/issues/253
MDU6SXNzdWUzNDc2MzMwMzc=,What parameter values should we change in peak calling with MACS2 when calculating IDR afterwards?,CLOSED,2018-08-04T17:01:10Z,2024-11-13T18:20:14Z,2024-11-13T18:20:13Z,To use IDR we need to relax peak calling settings when running MACS2. How do we do that? Is it enough to increase the qvalue threshold? Are there any specific parameter values we need to use?,PkiwiBird,https://github.com/macs3-project/MACS/issues/254
MDU6SXNzdWUzNTYyMzM5OTM=,"Albeit outdir definition, my output goes to folder of input",CLOSED,2018-09-01T21:31:21Z,2018-09-05T17:51:54Z,2018-09-05T17:51:54Z,"Hi,
first of all, great software!
I seem to just have a problem getting my output in the right location. Using the following call..
```
workdir=""$1""
files=($(awk '{print $1}' $2 ))
infile=""$workdir""/bam/${files[$SGE_TASK_ID]}.sorted.dedup.bam 
macs2 predictd -i $infile -f BAM -g mm -m 5 50 --outdir ""$workdir""/macs2/qc --rfile ${$infile%.sorted.dedup.bam}_model.r
```
..my input goes to $workdir/bam

Any suggestions? Thanks!

",dgoekbuget,https://github.com/macs3-project/MACS/issues/255
MDU6SXNzdWUzNTc1Mjk5OTM=,Where's the strand info gone?,OPEN,2018-09-06T07:31:41Z,2018-10-03T16:28:55Z,,"I used macs2 with -t -c -n -f BAM, but in the output file, i.e., _peaks.narrowPeak, I did not see +/- in column 6 but '.'. What happened to peak calling? Where could I get the peak strand information if I need it?",solo7773,https://github.com/macs3-project/MACS/issues/256
MDU6SXNzdWUzNTc3ODMwMDU=,Inconsistency between number of reads in Samtools flagstat and Macs2 total tags,CLOSED,2018-09-06T18:57:07Z,2018-09-06T20:07:56Z,2018-09-06T20:07:56Z,"I am trying to call peaks on my ATAC data using MACS2 and realized that there is a huge inconsistency within the number of reads in my bam file and the total tags reported by MACS2.

I have seen previous posts that mention using ""--keep-dup 'all'"" option but I have deduplicated my bam using picard before macs. Below is the command am using and the outputs for macs and samtools flagstat.

`macs2 callpeak -t PrimaryKeratinocytes.suf.bam -g hs -n test --nomodel --shift -51 --extsize 102 --q 0.05 --keep-dup 'all'`

macs2

`INFO  @ Fri, 17 Aug 2018 14:53:58: #1 tag size is determined as 51 bps` 
`INFO  @ Fri, 17 Aug 2018 14:53:58: #1 tag size = 51` 
`INFO  @ Fri, 17 Aug 2018 14:53:58: #1  total tags in treatment: 37171037`

flagstat
`52164544 + 0 in total (QC-passed reads + QC-failed reads)`
`14993507 + 0 secondary`
`0 + 0 supplementary`
`0 + 0 duplicates`
`52164544 + 0 mapped (100.00% : N/A)`

`samtools view PrimaryKeratinocytes.suf.bam | cut -f 1 | sort | uniq -c | wc -l`
`41121155`


Why is macs using only 37 million reads? How can I include all the reads for peak calling?

Thank you
",ahmadamalik,https://github.com/macs3-project/MACS/issues/257
MDU6SXNzdWUzNjA1MDU4ODE=,d calculated from paired-peaks are smaller than 2*tag length,OPEN,2018-09-15T04:19:36Z,2018-10-24T15:50:33Z,,"Hi Tao,

I used INPUT as my ctrl and used default parameters to call narrow peaks.
I encountered a warning:
Since the d(171) calculated from paired-peaks are smaller than 2*tag length, it may be influenced by unknown sequencing problem!

Any idea what happened and how to fix it?

Thanks!

Best,
Steve",stevehxf,https://github.com/macs3-project/MACS/issues/258
MDU6SXNzdWUzNjQ3MTA5NzI=,fold enrichment,OPEN,2018-09-28T01:46:27Z,2018-10-22T18:48:22Z,,"When building signal track with MACS2, the FE signal in genome range where the coverage is very low will become very significant, because the denominator is near zero in that range. Could you assign a weight to the low coverage range  to avoid this artifact ?",wangjiawen2013,https://github.com/macs3-project/MACS/issues/259
MDU6SXNzdWUzNjUwODk2MTU=,struct.error: unpack requires a string argument of length 4,CLOSED,2018-09-29T02:53:40Z,2024-10-08T14:11:24Z,2024-10-08T14:11:24Z,"I am having this issue but I do not know why exactly.
Could you help me?
Thank you in advance

INFO  @ Fri, 28 Sep 2018 22:39:33: 
# Command line: callpeak -t AndrewCD38LowR1.BedUtils.bed -f BED --format BAMPE -n BAMPEAndrewCD38Low_ -g hs
# ARGUMENTS LIST:
# name = BAMPEAndrewCD38Low_
# format = BAMPE
# ChIP-seq file = ['AndrewCD38LowR1.BedUtils.bed']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is on
 
INFO  @ Fri, 28 Sep 2018 22:39:33: #1 read fragment files... 
INFO  @ Fri, 28 Sep 2018 22:39:33: #1 read treatment fragments... 
Traceback (most recent call last):
  File ""/n/app/macs2/2.1.1.20160309/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""/n/app/python/2.7.12/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 719, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/n/app/python/2.7.12/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 1511, in run_script
    exec(script_code, namespace, namespace)
  File ""/n/app/macs2/2.1.1.20160309/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>
    
  File ""/n/app/macs2/2.1.1.20160309/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 57, in main
    
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 72, in run
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 358, in load_frag_files_options
  File ""MACS2/IO/Parser.pyx"", line 1024, in MACS2.IO.Parser.BAMPEParser.build_petrack (MACS2/IO/Parser.c:15888)
  File ""MACS2/IO/Parser.pyx"", line 1041, in MACS2.IO.Parser.BAMPEParser.build_petrack (MACS2/IO/Parser.c:15269)
  File ""MACS2/IO/Parser.pyx"", line 869, in MACS2.IO.Parser.BAMParser.get_references (MACS2/IO/Parser.c:12733)
struct.error: unpack requires a string argument of length 4",Belsufu,https://github.com/macs3-project/MACS/issues/260
MDU6SXNzdWUzNjY1MzY3ODM=,Segment fault issue,CLOSED,2018-10-03T21:28:15Z,2019-10-06T17:45:10Z,2019-10-06T17:45:10Z,"Hi Tao,

I am having some issues with peak calling. From the terminal output, I can see that ""building peak model"" is being skipped and I guess that is why the peaks are not called. How do I fix this problem? 

The terminal output is pasted below.
Thanks in advance
Swadha

# Command line: callpeak -t /home/roylab/swadha/histone/HTZ_1/HTZ1.SSTT004_S36HTZ1EX39_TTAGGC_L005_R1_001.sam -n /HTZ1.SSTT004_S36HTZ1EX39_TTAGGC_L005_R1_001 -g ce --bdg --keep-dup=auto --broad --broad-cutoff=0.01 --nomodel -f SAM --extsize=250 --outdir /home/roylab/swadha/histone/HTZ_1/macs_output
# ARGUMENTS LIST:
# name = /HTZ1.SSTT004_S36HTZ1EX39_TTAGGC_L005_R1_001
# format = SAM
# ChIP-seq file = ['/home/roylab/swadha/histone/HTZ_1/HTZ1.SSTT004_S36HTZ1EX39_TTAGGC_L005_R1_001.sam']
# control file = None
# effective genome size = 9.00e+07
# band width = 300
# model fold = [5, 50]
# qvalue cutoff for narrow/strong regions = 5.00e-02
# qvalue cutoff for broad/weak regions = 1.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is on
# Paired-End mode is off

INFO  @ Wed, 03 Oct 2018 14:00:28: #1 read tag files...
INFO  @ Wed, 03 Oct 2018 14:00:28: #1 read treatment tags...
INFO  @ Wed, 03 Oct 2018 14:00:35:  1000000
INFO  @ Wed, 03 Oct 2018 14:00:41:  2000000
INFO  @ Wed, 03 Oct 2018 14:00:55: #1 tag size is determined as 50 bps
INFO  @ Wed, 03 Oct 2018 14:00:55: #1 tag size = 50
INFO  @ Wed, 03 Oct 2018 14:00:55: #1  total tags in treatment: 3353652
INFO  @ Wed, 03 Oct 2018 14:00:55: #1 calculate max duplicate tags in single position based on binomial distribution...
INFO  @ Wed, 03 Oct 2018 14:00:55: #1  max_dup_tags based on binomial = 2
INFO  @ Wed, 03 Oct 2018 14:00:55: #1 filter out redundant tags at the same location and the same strand by allowing at most 2 tag(s)
INFO  @ Wed, 03 Oct 2018 14:00:55: #1  tags after filtering in treatment: 2967172
INFO  @ Wed, 03 Oct 2018 14:00:55: #1  Redundant rate of treatment: 0.12
INFO  @ Wed, 03 Oct 2018 14:00:55: #1 finished!
INFO  @ Wed, 03 Oct 2018 14:00:55: #2 Build Peak Model...
INFO  @ Wed, 03 Oct 2018 14:00:55: #2 Skipped...
INFO  @ Wed, 03 Oct 2018 14:00:55: #2 Use 250 as fragment length
INFO  @ Wed, 03 Oct 2018 14:00:55: #3 Call peaks...
INFO  @ Wed, 03 Oct 2018 14:00:55: #3 Call broad peaks with given level1 -log10qvalue cutoff and level2: 1.301030, 2.000000...
INFO  @ Wed, 03 Oct 2018 14:00:55: #3 Pre-compute pvalue-qvalue table...
INFO  @ Wed, 03 Oct 2018 14:01:05: #3 In the peak calling step, the following will be performed simultaneously:
INFO  @ Wed, 03 Oct 2018 14:01:05: #3   Write bedGraph files for treatment pileup (after scaling if necessary)... /HTZ1.SSTT004_S36HTZ1EX39_TTAGGC_L005_R1_001_treat_pileup.bdg
INFO  @ Wed, 03 Oct 2018 14:01:05: #3   Write bedGraph files for control lambda (after scaling if necessary)... /HTZ1.SSTT004_S36HTZ1EX39_TTAGGC_L005_R1_001_control_lambda.bdg
INFO  @ Wed, 03 Oct 2018 14:01:05: #3 Call peaks for each chromosome...
Segmentation fault",Swadha22,https://github.com/macs3-project/MACS/issues/261
MDU6SXNzdWUzNjgzODY2NDY=,Found the answer in advanced option. thanks!,CLOSED,2018-10-09T20:37:25Z,2018-11-01T21:28:17Z,2018-11-01T21:28:17Z,Found the answer in advanced option. thanks! ,mkmwong,https://github.com/macs3-project/MACS/issues/262
MDU6SXNzdWUzNjg4ODc1MzA=,ERROR: cannot find macs2 in environment; add it to user PATH environment or specify executable using a flag.,OPEN,2018-10-10T22:57:15Z,2018-12-20T15:54:36Z,,"Hello!

I am trying to run the hichipper program that uses MACS to call peaks. I've installed MACS using pip:
$ pip install -U MACS2

and added the appropriate paths to my PYTHONPATH and PATH:
$ export PYTHONPATH=/home/bryan/anaconda2/lib/python2.7/site-packages:$PYTHONPATH
$ export PATH=/home/bryan/bin:$PATH

when I run the hichipper program, I get the following error:
ERROR: cannot find macs2 in environment; add it to user PATH environment or specify executable using a flag.

Any advice on what is happening here? Thanks,
-Andrea ",aperreault,https://github.com/macs3-project/MACS/issues/263
MDU6SXNzdWUzNzAyNzcwNjg=,unequal treatments and controls,OPEN,2018-10-15T17:59:10Z,2024-02-23T14:33:54Z,,"Hello,
 I was just wonder how MACS2 deals with unequal treatments and controls. For example, if I have three input replicates, does it make sense to use them all even if I only have treatment ChIP? For example, should I use `-t treatment1.bam -c control1.bam control2.bam control3.bam` OR should I try normalizing the three control files and averaging them? Similarly, if I use `-t treatment1.bam treatment2.bam -c control1.bam` will MACS2 account for the number of samples being different in the control and treatment?
Thank you so much for your time. I look forward to a response soon.
Sammy",sklasfeld,https://github.com/macs3-project/MACS/issues/264
MDU6SXNzdWUzNzE4MjI1ODY=,ppois signal track problem,OPEN,2018-10-19T06:25:51Z,2024-07-16T08:35:07Z,,"Hi,
I used the following command to generate FE ppois signal track:

`macs2 bdgcmp -t E1-H3K27ac_treat_pileup.bdg -c E1-H3K27ac_control_lambda.bdg -m FE -o E1-H3K27ac_FE.bdg`
`macs2 bdgcmp -t E1-H3K27ac_treat_pileup.bdg -c E1-H3K27ac_control_lambda.bdg -m ppois -o E1-H3K27ac_ppois.bdg`

The FE signal track looks correct. But the ppois signal track is quite different from the FE and seems incorrect (see the figure below). What could be the reason? Thank you! 

![ppois_signal](https://user-images.githubusercontent.com/12710658/47200618-745d3780-d3a9-11e8-9c5c-5fd5b7ee5373.png)",YiqunCao,https://github.com/macs3-project/MACS/issues/265
MDU6SXNzdWUzNzMzOTc4MTQ=,No common chromosome names can be found from treatment and control! Check your input files! MACS will quit...,OPEN,2018-10-24T09:50:06Z,2022-06-22T05:36:37Z,,"Hi. I received the following error when performing `macs2 callpeaks`

```
INFO  @ Wed, 24 Oct 2018 17:15:52: #1.2 read input tags...
INFO  @ Wed, 24 Oct 2018 17:15:52: #1 tag size is determined as 150 bps
CRITICAL @ Wed, 24 Oct 2018 17:15:52: No common chromosome names can be found from treatment and control! Check your input files! MACS will quit...
CRITICAL @ Wed, 24 Oct 2018 17:15:52: Chromosome names in treatment: chr10,chr18,chr2,chr3
CRITICAL @ Wed, 24 Oct 2018 17:15:52: Chromosome names in control:
```

I used the same reference genome for BWA mapping of both treatment and control. I extracted the header of the BAM as below:
Treatment:
```
@HD     VN:1.5  SO:coordinate
@SQ     SN:chr1 LN:249250621
@SQ     SN:chr2 LN:243199373
@SQ     SN:chr3 LN:198022430
@SQ     SN:chr4 LN:191154276
@SQ     SN:chr5 LN:180915260
@SQ     SN:chr6 LN:171115067
@SQ     SN:chr7 LN:159138663
@SQ     SN:chr8 LN:146364022
@SQ     SN:chr9 LN:141213431
@SQ     SN:chr10        LN:135534747
@SQ     SN:chr11        LN:135006516
@SQ     SN:chr12        LN:133851895
@SQ     SN:chr13        LN:115169878
@SQ     SN:chr14        LN:107349540
@SQ     SN:chr15        LN:102531392
@SQ     SN:chr16        LN:90354753
@SQ     SN:chr17        LN:81195210
@SQ     SN:chr18        LN:78077248
@SQ     SN:chr19        LN:59128983
@SQ     SN:chr20        LN:63025520
@SQ     SN:chr21        LN:48129895
@SQ     SN:chr22        LN:51304566
@SQ     SN:chrM LN:16571
@SQ     SN:chrX LN:155270560
@SQ     SN:chrY LN:59373566
```

Control:
```
@HD     VN:1.5  SO:coordinate
@SQ     SN:chr1 LN:249250621
@SQ     SN:chr2 LN:243199373
@SQ     SN:chr3 LN:198022430
@SQ     SN:chr4 LN:191154276
@SQ     SN:chr5 LN:180915260
@SQ     SN:chr6 LN:171115067
@SQ     SN:chr7 LN:159138663
@SQ     SN:chr8 LN:146364022
@SQ     SN:chr9 LN:141213431
@SQ     SN:chr10        LN:135534747
@SQ     SN:chr11        LN:135006516
@SQ     SN:chr12        LN:133851895
@SQ     SN:chr13        LN:115169878
@SQ     SN:chr14        LN:107349540
@SQ     SN:chr15        LN:102531392
@SQ     SN:chr16        LN:90354753
@SQ     SN:chr17        LN:81195210
@SQ     SN:chr18        LN:78077248
@SQ     SN:chr19        LN:59128983
@SQ     SN:chr20        LN:63025520
@SQ     SN:chr21        LN:48129895
@SQ     SN:chr22        LN:51304566
@SQ     SN:chrM LN:16571
@SQ     SN:chrX LN:155270560
@SQ     SN:chrY LN:59373566
```

I don't really see the difference between the header of the treatment and control.
",EPKok,https://github.com/macs3-project/MACS/issues/266
MDU6SXNzdWUzNzg0NjkwMTk=,score from NarrowPeak >1000 when option --keep-dup all used,CLOSED,2018-11-07T21:06:15Z,2019-10-04T05:37:09Z,2019-10-04T05:37:09Z,"Hi Tao,

I'm trying to use ENCODE-DCC/atac-seq-pipeline on my yeast data.  The pipeline calls MACS2 in the following way:

>macs2 callpeak -t $ATACPATH/ATAC_399_1_S19_L003_R1_001.trim.merged.nodup.tn5.tagAlign.gz -f BED -n ATAC_399_1_S19_L003_R1_001.trim.merged.nodup.tn5 -g 12631379 -p 0.01 --shift -37 --extsize 73 --nomodel -B --SPMR --keep-dup all --call-summits

MACS2 completes successfully but the pipeline fails soon after because it encountered a score from the 
narrowPeak file which is >1000.  (Since the documentation says the range is [0-1000], this is a error.)

>cat ATAC_399_1_S19_L003_R1_001.trim.merged.nodup.tn5_peaks.narrowPeak | awk -F'\t' '{print $5}' | awk '{if(min==""""){min=max=$1}; if($1>max) {max=$1}; if($1<min) {min=$1}; total+=$1; count+=1} END {print ""avg"", total/count, ""max"", max, ""min"", min}'
>avg 628.772 max 19684 min 20

While swapping out various options to the macs2 callpeaks command, I discovered that the problem goes away if I remove the option --keep-dup all. 

>macs2 callpeak -t $ATACPATH/ATAC_399_1_S19_L003_R1_001.trim.merged.nodup.tn5.tagAlign.gz -f BED -n ATAC_399_1_S19_L003_R1_001.trim.merged.nodup.tn5 -g 12631379 -p 0.01 --shift -37 --extsize 73 --nomodel -B --SPMR  --call-summits

>cat ATAC_399_1_S19_L003_R1_001.trim.merged.nodup.tn5_peaks.narrowPeak | awk -F'\t' '{print $5}' | awk '{if(min==""""){min=max=$1}; if($1>max) {max=$1}; if($1<min) {min=$1}; total+=$1; count+=1} END {print ""avg"", total/count, ""max"", max, ""min"", min}'
>avg 138.853 max 919 min 20

I'm not sure if I misunderstand what keep-dup does or if there is a problem with keep-dup

",dianeking0,https://github.com/macs3-project/MACS/issues/268
MDU6SXNzdWUzODE4NjI3MjE=,atac-seq bampe and extsize,CLOSED,2018-11-17T13:20:40Z,2024-11-13T18:31:30Z,2024-11-13T18:31:30Z,"Dear Dr. Liu, 
I am calling atac-seq peaks with macs2, I don't quite understand the following parameters (--keep-dup and extsize):
How does --keep-dup 1 works when setting -f BAMPE ? will --keep-dup 1 still deduplicate the fragments ?

what will happens when I set --nomodel while don't set --extsize or --shift?
for example , the following code:
1, macs2 callpeak -t ChIP.bam -c Control.bam -f BAM -g hs -n test -B -q 0.01 --nomodel
2, macs2 callpeak -t ChIP.bam -c Control.bam -f BAM -g hs -n test -B -q 0.01 --nomodel --extsize 200
3, macs2 callpeak -t ChIP.bam -c Control.bam -f BAM -g hs -n test -B -q 0.01 --nomodel --shift -100
4, macs2 callpeak -t ChIP.bam -c Control.bam -f BAM -g hs -n test -B -q 0.01 --nomodel --shift -100 --extsize 200

Is it necessary to always put --nomodel --extsize and --shift together ?

",wangjiawen2013,https://github.com/macs3-project/MACS/issues/269
MDU6SXNzdWUzODI2MTQ4MDk=,Effective genome size for HG38?,CLOSED,2018-11-20T11:14:20Z,2019-10-03T19:00:52Z,2019-10-03T19:00:52Z,"What is the effective genome size for files aligned to HG38?  Mappable genome size for default option hs is similar, if not, how much is the difference?

",ankushs0128,https://github.com/macs3-project/MACS/issues/270
MDU6SXNzdWUzODY0MTU3MTE=,Why are input/control reads counted twice in PE mode?,CLOSED,2018-12-01T03:04:57Z,2024-11-13T18:31:50Z,2024-11-13T18:31:49Z,"At first I thought MACS2 was scaling the wrong sample, the control sample was being scaled but based on the stdout it seemed to be the smaller dataset:
```
total fragments in treatment: 39844232
total fragments in control: 22946943
```

But I see in the source code that for PE mode the control/input fragments are counted twice meaning the control size is actually 45893886 - what is the reasoning for this?

Thanks!
Daniel",daniel-wells,https://github.com/macs3-project/MACS/issues/271
MDU6SXNzdWUzODkyMTY5MjM=,bdgdiff IndexError: list index out of range,OPEN,2018-12-10T09:45:00Z,2018-12-10T09:45:00Z,,"Hi everyone,

when performing bdgdiff using MACS2 for ChIP-Seq data following error occurs shortly after starting the procedure: ""IndexError: list index out of range""

_MacBook-Air: xxx_bdgdiff $ macs2 bdgdiff --t1 cond1_treat_pileup.bdg --c1 cond1_control_lambda.bdg --t2 cond2_treat_pileup.bdg --c2 cond2_peaks_control_lambda.bdg --d1 76813950 --d2 67194613 -g 60 -l 200 --o-prefix diff_cond1_vs_cond2
INFO  @ Mon, 10 Dec 2018 09:34:23: Read and build treatment 1 bedGraph... 
Traceback (most recent call last):
  File ""/Library/Frameworks/Python.framework/Versions/2.7/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.2', 'macs2')
  File ""/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 658, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 1445, in run_script
    exec(script_code, namespace, namespace)
  File ""/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/MACS2-2.1.2-py2.7-macosx-10.9-x86_64.egg/EGG-INFO/scripts/macs2"", line 622, in <module>
    
  File ""/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/MACS2-2.1.2-py2.7-macosx-10.9-x86_64.egg/EGG-INFO/scripts/macs2"", line 93, in main
    
  File ""build/bdist.macosx-10.9-x86_64/egg/MACS2/bdgdiff_cmd.py"", line 60, in run
  File ""MACS2/IO/BedGraphIO.pyx"", line 108, in MACS2.IO.BedGraphIO.bedGraphIO.build_bdgtrack (MACS2/IO/BedGraphIO.c:1213)
IndexError: list index out of range_

- I installed the latest versions of MACS and Python.
- Callpeaks just worked fine before.

Does anyone have an idea on how to solve the problem?
Thank you in advance!

Leo

",hlk123,https://github.com/macs3-project/MACS/issues/272
MDU6SXNzdWUzOTM1NzkyNDE=,I have new MACS2 version but GUAVA is still not opening!!,CLOSED,2018-12-21T20:16:08Z,2018-12-22T02:51:06Z,2018-12-22T02:50:43Z,"I have the macs2 2.1.2 version but when I try to run GUAVA it says it cannot find the macs 2.1.1.20160309 version. How do I get the program to read the newer version?

awd2056a:GUAVA-1 chungs1$ pip install MACS2
Requirement already satisfied: MACS2 in /Users/chungs1/.local/lib/python2.7/site-packages (2.1.2)
Requirement already satisfied: numpy>=1.6 in /Users/chungs1/miniconda2/lib/python2.7/site-packages (from MACS2) (1.15.4)
awd2056a:GUAVA-1 chungs1$ java -jar GUAVA.jar
GUAVA version 1
Operating System of machine :Mac OS X
		cutadapt:		Working!
		bowtie:		Working!
		bowtie2:	Working!
		fastqc:		Working!
		samtools:	Working!
		Cannot run program ""macs2"": error=2, No such file or directory
		MACS2 version (macs2 2.1.1.20160309) :			NOT FOUND !!!
		Picard:		Working!
		bedtools:		Working!
		bedGraphToBigWig:		Working!
		igv:		Working!

There are missing dependancies!
Please use configure.sh to install dependencies.
If you are having difficulties in installing dependencies, please report issue at *GitHub*.
>>> https://github.com/MayurDivate/GUAVASourceCode/issues
EXIT(GUAVA) ... 
",swc42,https://github.com/macs3-project/MACS/issues/273
MDU6SXNzdWUzOTU3OTYxODg=,macs2 callpeak error,CLOSED,2019-01-04T03:12:35Z,2019-01-05T23:17:09Z,2019-01-05T23:17:09Z,"**ImportError: /usr/lib64/libgfortran.so.1: undefined symbol: sqrtq**
And anybody kown how to deal with this problem ?",xndless,https://github.com/macs3-project/MACS/issues/274
MDU6SXNzdWUzOTcxNDgxNzM=,callpeak without control/input sample but with -B option,OPEN,2019-01-09T00:05:50Z,2019-01-09T00:06:27Z,,"Hi,

If I don't have any input sample and use the -B option (macs2 callpeak -t <treatment_file> -f BAM -g hs --outdir peaks -q 0.05  -n filtered -B), there are two files called filtered_control_lambda.bdg and filtered_treat_pileup.bdg generated in the output directory. My question is how is the control_lambda.bdg file generated when I did not specify any control sample?

Also, can I use those two files for bdgcmp given that I did not have any input sample at the beginning?",tannishtha,https://github.com/macs3-project/MACS/issues/275
MDU6SXNzdWUzOTg2MDU4Nzc=,Would it be possible to include a NAME_summits.bed file in the output of bdgpeakcall?,CLOSED,2019-01-13T00:26:05Z,2024-11-13T18:32:36Z,2024-11-13T18:32:36Z,"I get the peak call file, but not summits.
Thanks,
Cesar

**$ macs2 bdgpeakcall -i 12_hours_dedup_QC_end_plus5.bedGraph -c 5 -l 1 -o 12hl1c5_bdg
$ head 12hl1c5_bdg
track type=narrowPeak name=""12hl1c5_bdg"" description=""12hl1c5_bdg"" nextItemButton=on
Scaffold1       6650    6656    12hl1c5_bdg_narrowPeak1 50      .       0.00000 0.00000 0.00000 0
Scaffold1       6806    6849    12hl1c5_bdg_narrowPeak2 50      .       0.00000 0.00000 0.00000 21
Scaffold1       8514    8569    12hl1c5_bdg_narrowPeak3 60      .       0.00000 0.00000 0.00000 27
Scaffold1       9238    9250    12hl1c5_bdg_narrowPeak4 50      .       0.00000 0.00000 0.00000 6
Scaffold1       9420    9452    12hl1c5_bdg_narrowPeak5 70      .       0.00000 0.00000 0.00000 16**
",CesarArenas-Mena,https://github.com/macs3-project/MACS/issues/276
MDU6SXNzdWU0MDIzNjkzNDk=,Mean fragment size is short than read length,OPEN,2019-01-23T18:20:00Z,2019-01-25T14:27:49Z,,"
Command line:
```
callpeak -f BAMPE -g mm -t IP.bam -c input.bam -n test--outdir macs2_outdir/
```

Version: 2.1.2

Read length is 150 bps. But the ""#1 mean fragment size "" is 94 bps by macs2
```
#1 mean fragment size is determined as 94 bp from treatment
```

Could someone help me explain this? Thanks. 
",xie186,https://github.com/macs3-project/MACS/issues/277
MDU6SXNzdWU0MDUwMTA5NDU=,callpeaks give different number of peaks using different MACS2 versions,OPEN,2019-01-30T23:23:56Z,2019-03-08T16:01:39Z,,"## Run macs2 peaks using version 2.1.1.20160309
```
macs2 callpeak -f BAMPE -g mm -t bam_files/IP_sorted.bam -c bam_files/input_sorted.bam -n IP --outdir IP_prev_version/
```
## Results using version 2.1.1.20160309
```
19472 peaks were detected by MACS
``` 
## Run macs2 peaks using version 2.1.2
```
macs2 callpeak -f BAMPE -g mm -t bam_files/IP_sorted.bam -c bam_files/input_sorted.bam -n IP --outdir IP_new_version/

```
## Results using version 2.1.2
```
1272 peaks were detected by MACS
```
Could you please let me know whether latest version have some stringent default parameters which were not  present in previous MACS2 version.

Thank you for your help.
",bhidek,https://github.com/macs3-project/MACS/issues/278
MDU6SXNzdWU0MDUxOTkyMDA=,Aberrant fragment length in MACS2,CLOSED,2019-01-31T11:22:09Z,2019-10-02T20:05:57Z,2019-10-02T20:05:57Z,"Hello everyone

This is the first time that I’m analyzing ChIP-seq data and I have some troubles with the peak calling.
First, I ‘m working on Wheat genome that gave some problems for the mapping step and solved by splitting the chromosomes in 2 parts. STAR is used for the mapping with the following command:
```

STAR --alignIntronMax 1 --alignIntronMin 2 --outFilterMultimapNmax 1 --genomeDir ${REF}
--runThreadN 8 --readFilesCommand zcat --readFilesIn ${input1} ${input2}
--outFileNamePrefix ${odir}/${out}
```

After the mapping the PCR duplicates are removed from the BAM files using these commands:

```
java -Xmx2048m -jar picard/SortSam.jar INPUT=input.bam OUTPUT=output.bam SORT_ORDER=coordinate VALIDATION_STRINGENCY=SILENT
java -Xmx2048m -jar picard/MarkDuplicates.jar INPUT=input.bam OUTPUT=output.bam METRICS_FILE=output.dup_metrics REMOVE_DUPLICATES=false ASSUME_SORTED=true VALIDATION_STRINGENCY=SILENT
samtools view -b -F 4 -q 5 input.bam > intermediate.output.bam
samtools view -b -F 1024 intermediate.output.bam > output.bam
```

For the peak calling I used MACS2 with the standard command line and got the following error:

```
callpeak -t test1.bam test2.bam test3.bam -c control1.bam control2.bam control3.bam -f BAMPE -g 1.4e10 -n MACS2_H3K27me3 --outdir ../MACS2
. . . 
INFO  @ Tue, 29 Jan 2019 14:05:19:  39000000
INFO  @ Tue, 29 Jan 2019 14:05:28:  40000000
INFO  @ Tue, 29 Jan 2019 14:05:38:  1000000
INFO  @ Tue, 29 Jan 2019 14:11:58:  1000000
INFO  @ Tue, 29 Jan 2019 14:19:15: #1 mean **fragment size is determined as 2713.0 bp from treatment**
INFO  @ Tue, 29 Jan 2019 14:19:15: #1 note: mean **fragment size in control is 2117.1 bp** -- value ignored
INFO  @ Tue, 29 Jan 2019 14:19:15: #1 fragment size = 2713.0
INFO  @ Tue, 29 Jan 2019 14:19:15: #1  total fragments in treatment: 97725002
INFO  @ Tue, 29 Jan 2019 14:19:15: #1 user defined the maximum fragments...
INFO  @ Tue, 29 Jan 2019 14:19:15: #1 filter out redundant fragments by allowing at most 1 identical fragment(s)
INFO  @ Tue, 29 Jan 2019 14:22:14: #1  fragments after filtering in treatment: 97140015
INFO  @ Tue, 29 Jan 2019 14:22:14: #1  Redundant rate of treatment: 0.01
INFO  @ Tue, 29 Jan 2019 14:22:14: #1  total fragments in control: 116365929
INFO  @ Tue, 29 Jan 2019 14:22:14: #1 user defined the maximum fragments...
INFO  @ Tue, 29 Jan 2019 14:22:14: #1 filter out redundant fragments by allowing at most 1 identical fragment(s)
INFO  @ Tue, 29 Jan 2019 14:25:45: #1  fragments after filtering in control: 115900890
INFO  @ Tue, 29 Jan 2019 14:25:45: #1  Redundant rate of control: 0.00
INFO  @ Tue, 29 Jan 2019 14:25:45: #1 finished!
INFO  @ Tue, 29 Jan 2019 14:25:45: #2 Build Peak Model...
INFO  @ Tue, 29 Jan 2019 14:25:45: #2 Skipped...
INFO  @ Tue, 29 Jan 2019 14:25:45: #3 Call peaks...
Traceback (most recent call last):
  File ""/tools/eb/software/MPI/GCC/7.3.0-2.30/OpenMPI/3.1.1/biogrid_python/2.7.15/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.2', 'macs2')
  File ""build/bdist.linux-x86_64/egg/pkg_resources/__init__.py"", line 654, in run_script
  File ""build/bdist.linux-x86_64/egg/pkg_resources/__init__.py"", line 1441, in run_script
  File ""/tools/eb/software/MPI/GCC/7.3.0-2.30/OpenMPI/3.1.1/biogrid_python/2.7.15/lib/python2.7/site-packages/MACS2-2.1.2-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 622,
 in <module>

  File ""/tools/eb/software/MPI/GCC/7.3.0-2.30/OpenMPI/3.1.1/biogrid_python/2.7.15/lib/python2.7/site-packages/MACS2-2.1.2-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 57,
in main

  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 264, in run
  File ""MACS2/PeakDetect.pyx"", line 116, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1815)
  File ""MACS2/PeakDetect.pyx"", line 188, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control (MACS2/PeakDetect.c:2364)
AssertionError: slocal can't be smaller than d!

```

What does it mean exactly? Look like a bit strange? 
I expected to have something around 140-180 for the fragment length.
I tried to change the slocal by a larger one (3000) and it works but I’m questioning if there a mistake somewhere due to the fragment length? 
Any clues or explanations?
Thank you

",Stef-FR,https://github.com/macs3-project/MACS/issues/279
MDU6SXNzdWU0MDU4NTI5NTk=,bdgdiff and broad marks,OPEN,2019-02-01T20:01:59Z,2019-02-01T20:01:59Z,,"Currently `bdgdiff` can only use `bdgpeakcall` to call peaks from the logLR `ScoreTrack`s, which means that it's not suitable for calling differential peaks if we know the mark will be broad (for example, H3K27me3). Is there an actual reason why a `bdgbroadcall`-based method is not implemented for `bdgdiff`?

As an aside--is it possible to output these `ScoreTrack`s to a bedGraph file?",JohnMCMa,https://github.com/macs3-project/MACS/issues/280
MDU6SXNzdWU0MTExNjM0ODM=,Q: No model.r files generated,OPEN,2019-02-17T08:39:50Z,2019-08-13T20:37:01Z,,"Hi. I ran execute MACS2 as below:
`$macs2 callpeak -t ID1_sort.bam -c HALO_sort.bam -g 2.1e9 -B -f BAMPE -n ID1-HALO --outdir macs2-out 2> err-macs2.log`
I have the following outputs:

```
ID1-HALO_control_lambda.bdg  ID1-HALO_peaks.xls    ID1-HALO_treat_pileup.bdg  ID1-Y_peaks.narrowPeak  ID1-Y_summits.bed
ID1-HALO_peaks.narrowPeak    ID1-HALO_summits.bed  ID1-Y_control_lambda.bdg   ID1-Y_peaks.xls         ID1-Y_treat_pileup.bdg
```
I realize that there is supposed to be model.r output as well but it is missing. Any idea how I could generate this file? The version of macs2 2.1.1.20160309
.",chaimol,https://github.com/macs3-project/MACS/issues/281
MDU6SXNzdWU0MTk1ODM3OTE=,Q: macs2 installation issues using pip,OPEN,2019-03-11T17:08:43Z,2019-10-02T13:34:52Z,,"I have been trying to install macs2 to run some jobs on hpc server, but still failing after multiple attempts to install. I used ""pip install MACS2"" and this is the error I get:

`tommy35@hpc-login3:~/project/NGStools pip install MACS2
Collecting MACS2
Requirement already satisfied: numpy>=1.6 in /auto/rcf-40/tommy35/.local/lib/python2.7/site-packages (from MACS2)
Installing collected packages: MACS2
Exception:
Traceback (most recent call last):
  File ""/home/rcf-40/tommy35/.local/lib/python2.7/site-packages/pip/basecommand.py"", line 215, in main
    status = self.run(options, args)
  File ""/home/rcf-40/tommy35/.local/lib/python2.7/site-packages/pip/commands/install.py"", line 342, in run
    prefix=options.prefix_path,
  File ""/home/rcf-40/tommy35/.local/lib/python2.7/site-packages/pip/req/req_set.py"", line 784, in install
    **kwargs
  File ""/home/rcf-40/tommy35/.local/lib/python2.7/site-packages/pip/req/req_install.py"", line 851, in install
    self.move_wheel_files(self.source_dir, root=root, prefix=prefix)
  File ""/home/rcf-40/tommy35/.local/lib/python2.7/site-packages/pip/req/req_install.py"", line 1064, in move_wheel_files
    isolated=self.isolated,
  File ""/home/rcf-40/tommy35/.local/lib/python2.7/site-packages/pip/wheel.py"", line 345, in move_wheel_files
    clobber(source, lib_dir, True)
  File ""/home/rcf-40/tommy35/.local/lib/python2.7/site-packages/pip/wheel.py"", line 316, in clobber
    ensure_dir(destdir)
  File ""/home/rcf-40/tommy35/.local/lib/python2.7/site-packages/pip/utils/__init__.py"", line 83, in ensure_dir
    os.makedirs(path)
  File ""/usr/lib64/python2.7/os.py"", line 157, in makedirs
    mkdir(name, mode)
OSError: [Errno 13] Permission denied: '/usr/lib64/python2.7/site-packages/MACS2'
You are using pip version 9.0.3, however version 19.0.3 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.`

I can't do 'sudo' since I am on hpc and I don't have permission to do that. 
I tried also `pip install macs2 --user` which successfully installed : `tommy35@hpc-login3:~ pip show macs2
Name: MACS2
Version: 2.1.2
Summary: Model Based Analysis for ChIP-Seq data
Home-page: http://github.com/taoliu/MACS/
Author: Tao Liu
Author-email: vladimir.liu@gmail.com
License: UNKNOWN
Location: /auto/rcf-40/tommy35/.local/lib/python2.7/site-packages
Requires: numpy`

But when I call macs2, I get no command error: 
`tommy35@hpc-login3:~ macs2
-bash: macs2: command not found` 

What do you suggest?",gsathishk,https://github.com/macs3-project/MACS/issues/282
MDU6SXNzdWU0Mjc3ODgwMDE=,Feat: Update documentation,CLOSED,2019-04-01T16:00:38Z,2019-08-13T19:39:46Z,2019-08-13T19:39:46Z,I suggest updating the documentation to include the relatively new `--min-length` paramater. We just had a [question on Biostars](https://www.biostars.org/p/372577/) towards filtering for minimal peak width which is why I noticed that it is missing from the README here on Git.,ATpoint,https://github.com/macs3-project/MACS/issues/284
MDU6SXNzdWU0MzgwMDMxMjI=,Q: ATAC data got significantly different peak results with BAM and BED input format,OPEN,2019-04-28T02:14:31Z,2019-09-04T21:28:58Z,,"Hi
I am currently working on ATAC data from PE sequencing. When I called peak with following command: 
`macs2 callpeak -t my_sample.bam -f BAM --nomodel -g hs -n name -q 0.05 --extsize 200 --shift -100 --keepd-dup all`
 I go t 14667 significant peaks. 
But when I converted the bam file into bed fomat using 
`bedtools -i my_sample.bam > my_sample.bed` 
and then called peak with following command:
 `macs2 callpeak -t my_sample.bed -f BED --nomodel -g hs -n name -q 0.05 --extsize 200 --shift -100 --keepd-dup all`
I got 35446 significant peaks. Why are the two results so different? Whether it is not reasonable to convert PE bam file into bed format and then call peak？",tianwen0003,https://github.com/macs3-project/MACS/issues/285
MDU6SXNzdWU0Mzk1MTQxMTc=,trapped in AttributeError: 'Namespace' object has no attribute 'maxgap',CLOSED,2019-05-02T10:06:25Z,2019-05-04T08:20:20Z,2019-05-04T08:20:19Z,"Hi Tao,

This afternoon I tried to conduct peak calling with MACS2 but I trapped in the problem below.

Here is my command line:
```
for i in SRR7759388 SRR7759389 SRR7759390
do
pkurun-cns 1 10 macs2 callpeak -t ${i}.sorted.bam -f BAM -p 0.0001 -g hs -n ${i} --outdir ./
done
```

AND the error info is 
```
Traceback (most recent call last):
  File ""/lustre1/zihua/bin/macs2"", line 617, in <module>
    main()
  File ""/lustre1/zihua/bin/macs2"", line 57, in main
    run( args )
  File ""/lustre2/zihua/tools/Python-2.7.15/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 56, in run
    options = opt_validate( args )
  File ""/lustre2/zihua/tools/Python-2.7.15/lib/python2.7/site-packages/MACS2/OptValidator.py"", line 193, in opt_validate
    if options.maxgap:
AttributeError: 'Namespace' object has no attribute 'maxgap'
```

Please help me to fix the problem, many thanks! ",ZihuaLiu666,https://github.com/macs3-project/MACS/issues/286
MDU6SXNzdWU0NDExMzgzMjU=,"Q: Issue install MACS2 - Python 2.7, Pip version deprecating",CLOSED,2019-05-07T09:41:17Z,2019-08-13T20:55:02Z,2019-08-13T20:55:01Z,"Installing MACS2 with Pip3 

> pip3 install MACS2
> Collecting MACS2
>   Using cached https://files.pythonhosted.org/packages/5e/32/0108a85d9a91c18413e8492bea631725cdbc20b45970ef63e8d0020ef2da/MACS2-2.1.2.1.tar.gz
>     ERROR: Complete output from command python setup.py egg_info:
>     ERROR: CRITICAL: Python version must be 2.7!
>     ----------------------------------------
> ERROR: Command ""python setup.py egg_info"" failed with error code 1 in /tmp/pip-install-6h3j14wy/MACS2/

**Installing MACS2 with Python version 2.7 and pip **
Python 2.7 version will be deprecating in 2020 and Pip will drop support for Python 2.7

Error message on install: 

> Python 2.7 will reach the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 won't be maintained after that date. A future version of pip will drop support for Python 2.7.
> Collecting numpy
>   Downloading https://files.pythonhosted.org/packages/e1/72/179a78b565ecf01fe98dab6417581d30acac15c2d93c49f93169ebea99b1/numpy-1.16.3-cp27-cp27mu-manylinux1_x86_64.whl (17.0MB)
>      |################################| 17.0MB 4.9MB/s 
> ERROR: pymatgen 3.3.1 requires enum34, which is not installed.
> ERROR: pymatgen 3.3.1 requires scipy>=0.14, which is not installed.
> ERROR: pandas 0.17.1 requires python-dateutil, which is not installed.
> ERROR: pandas 0.17.1 requires pytz>=2011k, which is not installed.
> ERROR: matplotlib 1.5.1 requires pyparsing!=2.0.4,>=1.5.6, which is not installed.
> ERROR: matplotlib 1.5.1 requires python-dateutil, which is not installed.
> ERROR: matplotlib 1.5.1 requires pytz, which is not installed.

How to rectify these error messages and successfully install MACS2 updated version 

Thanks in advance 
Best Regards 
Ankush",ankushs0128,https://github.com/macs3-project/MACS/issues/287
MDU6SXNzdWU0NDIwMDM0NTk=,call peaks error - struct.error: unpack requires a string argument of length 4,CLOSED,2019-05-09T00:56:33Z,2019-05-09T18:16:53Z,2019-05-09T18:16:39Z,"# Command line: callpeak -t filtered_H3K9ME3_MEIS1_NATIVE_A10.bam -f BAM -c input_Meis1_native_D02.bam -g mm --broad --broad-cutoff 0.1
# ARGUMENTS LIST:
# name = NA
# format = BAM
# ChIP-seq file = ['filtered_H3K9ME3_MEIS1_NATIVE_A10.bam']
# control file = ['input_Meis1_native_D02.bam']
# effective genome size = 1.87e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff for narrow/strong regions = 5.00e-02
# qvalue cutoff for broad/weak regions = 1.00e-01
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is on
# Paired-End mode is off
 
INFO  @ Wed, 08 May 2019 17:48:44: #1 read tag files... 
INFO  @ Wed, 08 May 2019 17:48:44: #1 read treatment tags... 
INFO  @ Wed, 08 May 2019 17:48:48:  1000000 
INFO  @ Wed, 08 May 2019 17:48:52:  2000000 
INFO  @ Wed, 08 May 2019 17:48:55:  3000000 
INFO  @ Wed, 08 May 2019 17:48:59:  4000000 
INFO  @ Wed, 08 May 2019 17:49:03:  5000000 
INFO  @ Wed, 08 May 2019 17:49:07:  6000000 
INFO  @ Wed, 08 May 2019 17:49:11:  7000000 
INFO  @ Wed, 08 May 2019 17:49:14:  8000000 
INFO  @ Wed, 08 May 2019 17:49:18:  9000000 
INFO  @ Wed, 08 May 2019 17:49:22:  10000000 
INFO  @ Wed, 08 May 2019 17:49:26:  11000000 
INFO  @ Wed, 08 May 2019 17:49:30:  12000000 
INFO  @ Wed, 08 May 2019 17:49:34:  13000000 
INFO  @ Wed, 08 May 2019 17:49:38:  14000000 
INFO  @ Wed, 08 May 2019 17:49:42:  15000000 
INFO  @ Wed, 08 May 2019 17:49:46:  16000000 
INFO  @ Wed, 08 May 2019 17:49:49:  17000000 
INFO  @ Wed, 08 May 2019 17:49:53:  18000000 
INFO  @ Wed, 08 May 2019 17:49:57:  19000000 
INFO  @ Wed, 08 May 2019 17:50:01:  20000000 
INFO  @ Wed, 08 May 2019 17:50:05:  21000000 
INFO  @ Wed, 08 May 2019 17:50:08:  22000000 
INFO  @ Wed, 08 May 2019 17:50:12:  23000000 
INFO  @ Wed, 08 May 2019 17:50:16:  24000000 
INFO  @ Wed, 08 May 2019 17:50:20:  25000000 
INFO  @ Wed, 08 May 2019 17:50:24:  26000000 
INFO  @ Wed, 08 May 2019 17:50:28:  27000000 
INFO  @ Wed, 08 May 2019 17:50:31:  28000000 
INFO  @ Wed, 08 May 2019 17:50:35:  29000000 
INFO  @ Wed, 08 May 2019 17:50:39:  30000000 
INFO  @ Wed, 08 May 2019 17:50:43:  31000000 
INFO  @ Wed, 08 May 2019 17:50:47:  32000000 
INFO  @ Wed, 08 May 2019 17:50:51:  33000000 
INFO  @ Wed, 08 May 2019 17:50:55:  34000000 
INFO  @ Wed, 08 May 2019 17:50:59:  35000000 
INFO  @ Wed, 08 May 2019 17:51:03:  36000000 
INFO  @ Wed, 08 May 2019 17:51:08:  37000000 
INFO  @ Wed, 08 May 2019 17:51:12:  38000000 
INFO  @ Wed, 08 May 2019 17:51:16:  39000000 
INFO  @ Wed, 08 May 2019 17:51:20:  40000000 
INFO  @ Wed, 08 May 2019 17:51:24:  41000000 
INFO  @ Wed, 08 May 2019 17:51:29:  42000000 
INFO  @ Wed, 08 May 2019 17:51:33:  43000000 
INFO  @ Wed, 08 May 2019 17:51:37:  44000000 
INFO  @ Wed, 08 May 2019 17:51:41:  45000000 
INFO  @ Wed, 08 May 2019 17:51:45:  46000000 
INFO  @ Wed, 08 May 2019 17:51:49:  47000000 
INFO  @ Wed, 08 May 2019 17:51:53:  48000000 
INFO  @ Wed, 08 May 2019 17:51:57:  49000000 
INFO  @ Wed, 08 May 2019 17:52:01:  50000000 
INFO  @ Wed, 08 May 2019 17:52:06:  51000000 
INFO  @ Wed, 08 May 2019 17:52:10:  52000000 
INFO  @ Wed, 08 May 2019 17:52:14:  53000000 
INFO  @ Wed, 08 May 2019 17:52:18:  54000000 
INFO  @ Wed, 08 May 2019 17:52:22:  55000000 
INFO  @ Wed, 08 May 2019 17:52:26:  56000000 
INFO  @ Wed, 08 May 2019 17:52:30:  57000000 
INFO  @ Wed, 08 May 2019 17:52:34:  58000000 
INFO  @ Wed, 08 May 2019 17:52:38:  59000000 
INFO  @ Wed, 08 May 2019 17:52:42:  60000000 
INFO  @ Wed, 08 May 2019 17:52:46:  61000000 
INFO  @ Wed, 08 May 2019 17:52:49:  62000000 
INFO  @ Wed, 08 May 2019 17:52:53:  63000000 
INFO  @ Wed, 08 May 2019 17:52:57:  64000000 
INFO  @ Wed, 08 May 2019 17:53:01:  65000000 
INFO  @ Wed, 08 May 2019 17:53:05:  66000000 
INFO  @ Wed, 08 May 2019 17:53:09:  67000000 
INFO  @ Wed, 08 May 2019 17:53:13:  68000000 
INFO  @ Wed, 08 May 2019 17:53:17:  69000000 
INFO  @ Wed, 08 May 2019 17:53:20:  70000000 
INFO  @ Wed, 08 May 2019 17:53:24:  71000000 
INFO  @ Wed, 08 May 2019 17:53:28:  72000000 
INFO  @ Wed, 08 May 2019 17:53:32:  73000000 
INFO  @ Wed, 08 May 2019 17:53:36:  74000000 
INFO  @ Wed, 08 May 2019 17:53:40:  75000000 
INFO  @ Wed, 08 May 2019 17:53:43:  76000000 
INFO  @ Wed, 08 May 2019 17:53:47:  77000000 
INFO  @ Wed, 08 May 2019 17:53:51:  78000000 
INFO  @ Wed, 08 May 2019 17:53:55:  79000000 
INFO  @ Wed, 08 May 2019 17:53:59:  80000000 
INFO  @ Wed, 08 May 2019 17:54:03: #1.2 read input tags... 
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 622, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 57, in main
    run( args )
  File ""/Library/Python/2.7/site-packages/MACS2/callpeak_cmd.py"", line 73, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/Library/Python/2.7/site-packages/MACS2/callpeak_cmd.py"", line 411, in load_tag_files_options
    control = options.parser(options.cfile[0], buffer_size=options.buffer_size).build_fwtrack()
  File ""MACS2/IO/Parser.pyx"", line 876, in MACS2.IO.Parser.BAMParser.build_fwtrack (MACS2/IO/Parser.c:13658)
  File ""MACS2/IO/Parser.pyx"", line 889, in MACS2.IO.Parser.BAMParser.build_fwtrack (MACS2/IO/Parser.c:13066)
  File ""MACS2/IO/Parser.pyx"", line 862, in MACS2.IO.Parser.BAMParser.get_references (MACS2/IO/Parser.c:12582)
struct.error: unpack requires a string argument of length 4",AYYYang,https://github.com/macs3-project/MACS/issues/288
MDU6SXNzdWU0NTA5MzU1MjY=,Q: call-summits on specified regions?,OPEN,2019-05-31T18:51:27Z,2019-08-13T21:41:14Z,,"Hi,

I'm using peaks called by MACS2 from within an existing pipeline that ultimately uses IDR to filter and produce a top-set of peaks. I'd like to use the --call-summits command to identify summits within those post-IDR top-set peaks to use for motif analysis. I can't figure out whether I can use the call-summits command along with prescribed regions (e.g. input bam file & bed file to get summits only on the bed file)? 

Thank you for your help!",erin-a-clark,https://github.com/macs3-project/MACS/issues/289
MDU6SXNzdWU0NTQ5Mzg1NjE=,Q: Generating wiggle file from bam ,CLOSED,2019-06-11T22:55:26Z,2019-09-24T14:19:59Z,2019-09-24T14:19:59Z,"Hey there!

I have a Tophat aligned RNA-seq BAM file and I'd like to generate a wiggle or bedGraph file for visualization. Can I do this with MACS2? If so, which command would I use and can I use the bam input without running MACS2 to ""call peaks"" on my RNA-seq file?

Thanks!
-Andrea ",aperreault,https://github.com/macs3-project/MACS/issues/290
MDU6SXNzdWU0NjA2MTYxMDE=,How is the control produced without a control as input?,OPEN,2019-06-25T20:09:08Z,2019-06-25T20:09:08Z,,"Hello and thank you for MACS2!

Firstly, great work! I have 2 biological replicates for ChIP-seq data in a wildtype setting (i.e. with no control). MACS2's callpeak requires that there is a treatment and a control. When I run the following command, a control out.sorted.bam_control_lambda.bdg is generated. After reading (https://groups.google.com/forum/#!msg/macs-announcement/JkufzGpUNRk/kUx0z2M2b_cJ) I think I understand how this generated control. This is the command I used:
macs2 callpeak -t MR-12/out.sorted.bam MR-13/out.sorted.bam -B -f AUTO --SPMR --keep-dup all -g dm --trackline -n out.sorted.bam --cutoff-analysis --call-summits -p 0.01 --outdir cell_line_m 2> cell_line_m/out.sorted.bam.log

I am concerned about the interpretability of the produced p and q values. How should they be interpreted in my case, as I do not have a control? It seems to me that one can call peaks without a control, but I am not sure how to interpret the significance thresholds here.

The statement I am referring to is:
For each peak region, MACS calculates the a local lambda for poisson
distribution based on the control tags within the 1kb, 5kb and
10kb(1/5/10k are parameters that you can modify) nearby regions to
consider the local fluctuations and biases. The local lambda is the
maximum of the averages of tags for 1/5/10 kb regions and a whole
genome background. Then this local lambda is used to calculate the p-
value of poisson distribution.

THANK YOU in advance!",ashleymaeconard,https://github.com/macs3-project/MACS/issues/291
MDU6SXNzdWU0NjMzNzA5MjE=,Q: Changing MFOLD not altering output,OPEN,2019-07-02T18:21:13Z,2019-08-13T16:39:35Z,,"Hello, I wanted to try varying the upper and lower bound for the MFOLD parameter and I do not see any changes in the results. Can you tell me why this is? I should note that I do not have a control, and I realize that in that case, macs2 infers a noise level (i.e. background) and thus generates a control. 

This is my command: `macs2 callpeak -t /out.sorted.bam -B -f AUTO --nomodel --SPMR --keep-dup all -g dm --trackline -n out.sorted.bam --cutoff-analysis --call-summits -p 0.01 -m 40 100 --outdir /outdir/ 2> /outdir/out.sorted.bam.log &`

I tried 3 different MFOLD boundary limits: 5 50, 25 100, and 40 100, and when examining the narrowPeak and pileup.bdg files there is no difference. 

Thank you!
Ashley:) ",ashleymaeconard,https://github.com/macs3-project/MACS/issues/292
MDU6SXNzdWU0NjQyNTYzNjU=,Q: Macs2 peak calling with different thresholds,OPEN,2019-07-04T13:04:59Z,2022-05-22T03:07:30Z,,"I have one question regarding Macs2 software. Could you please help?

I was running macs2 with two different pvalue thresholds: 0.00001 and 0.01. The commands were:
1: macs2 callpeak -t test.bam -c control.bam --name=test --outdir=out_5 --format=BAM --gsize=dm --tsize=51 --pvalue=0.00001 --nomodel --extsize 200
2: macs2 callpeak -t test.bam -c control.bam --name=test --outdir=out_2 --format=BAM --gsize=dm --tsize=51 --pvalue=0.01 --nomodel --extsize 200.

And after that, when I apply 0.00001 pvalue threshold to the peak calling result obtained in the 2nd command (initial 0.01 threshold + posterior 0.00001 threshold), I have 590 peaks.
And at the same time in the 1st command  (with initial 0.00001 threshold), I obtained only 117 peaks. 
I've tried the same with another chip-seq data, and the results were similar.
Do you have any ideas what may be the reason?

Thank you very much!",natashaklmnk,https://github.com/macs3-project/MACS/issues/293
MDU6SXNzdWU0NzE4MTMwMjg=,Bug: Figure missing from Wiki: MACS2 CPU and Memory Usage,OPEN,2019-07-23T16:55:28Z,2019-08-12T20:52:58Z,,Just pointing out that the figure seems to be missing from this page: https://github.com/taoliu/MACS/wiki/MACS2-CPU-and-Memory-Usage ,bhanratt,https://github.com/macs3-project/MACS/issues/294
MDU6SXNzdWU0NzE5OTk3MDY=,Q: Pip is confused between 2.1.2 and 2.1.2.1,CLOSED,2019-07-23T22:44:00Z,2019-09-30T21:58:57Z,2019-09-30T21:58:21Z,"Even after a succesful pip upgrade to 2.1.2.1 it still reports the old versio
I think this is a version in the pypi metadata YAML problem perhaps?
Not sure

```
Package Version Latest  Type
------- ------- ------- -----
MACS2   2.1.2   2.1.2.1 sdist
```
",tseemann,https://github.com/macs3-project/MACS/issues/295
MDU6SXNzdWU0NzUyMzQ2ODE=,Q: bdgcmp without normalizing for sequencing depth?,CLOSED,2019-07-31T16:11:21Z,2019-08-12T20:51:17Z,2019-08-12T20:51:17Z,"Is it possible to add an option to bdgcmp command for not to normalize the target and control bedgraphs to sequencing depth? Assuming that they have already been normalized in a particular way before runing this command.

**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
",smarhon,https://github.com/macs3-project/MACS/issues/296
MDU6SXNzdWU0NzYyNDI5ODI=,Q: NAME_treat_pvalue.bdg not generated even though --bdg is set,CLOSED,2019-08-02T15:42:34Z,2019-08-16T17:36:58Z,2019-08-16T14:05:57Z,"I want to use the macs2 cmbreps option to compare peaks between replicates. However I can not seem to produce the log10 pvalues.
When I call macs2 (v2.1.2) with the --bdg command I get the NAME_treat_pileup.bdg and the NAME_control_lambda.bdg as described [here](https://github.com/taoliu/MACS/blob/master/README.md#-b--bdg), however I do not get NAME_treat_pvalue.bdg or NAME_treat_qvalue.bdg.

The header of the NAME_peaks.xls is:

\# This file is generated by MACS version 2.1.2
\# Command line: callpeak --bdg -t /mnt/ocimum/vol/atacpipeline/dedup/GSM2837484-Bl71nemr.bam --outdir /mnt/ocimum/vol/atacpipeline/macs2/ -n GSM2837484-Bl71nemr --shift -100 --extsize 200 --nomodel --keep-dup 1 --buffer-size 10000 -g 415501436
\# ARGUMENTS LIST:
\# name = GSM2837484-Bl71nemr
\# format = AUTO
\# ChIP-seq file = ['/mnt/ocimum/vol/atacpipeline/dedup/GSM2837484-Bl71nemr.bam']
\# control file = None
\# effective genome size = 4.16e+08
\# band width = 300
\# model fold = [5, 50]
\# qvalue cutoff = 5.00e-02
\# The maximum gap between significant sites is assigned as the read length/tag size.
\# The minimum length of peaks is assigned as the predicted fragment length ""d"".
\# Larger dataset will be scaled towards smaller dataset.
\# Range for calculating regional lambda is: 10000 bps
\# Broad region calling is off
\# Paired-End mode is off
\# tag size is determined as 43 bps
\# total tags in treatment: 28550699
\# tags after filtering in treatment: 20545115
\# maximum duplicate tags at the same position in treatment = 1
\# Redundant rate in treatment: 0.28
\# Sequencing ends will be shifted towards 5' by 100 bp(s)
\# d = 200",Maarten-vd-Sande,https://github.com/macs3-project/MACS/issues/297
MDU6SXNzdWU0Nzc4OTYxNjY=,Bug: Trouble with numpy using macs2 2.1.2,CLOSED,2019-08-07T12:24:02Z,2019-09-24T14:19:13Z,2019-09-24T14:19:13Z,"Hi I have some trooble with my macs2 environment installed with conda. The source of the package it's in the channel bioconda and the version of macs2 is 2.1.2. The version of numpy is : 1.16.4 ( I've try with the 1.17 version but it's seems the same issues).

Here you have the error of macs2 : 

`
Traceback (most recent call last):
  File ""/opt/share/FLOCAD/userspace/cpichot/miniconda3/envs/macs2TestNewInstall/bin/macs2"", line 622, in <module>
    main()
  File ""/opt/share/FLOCAD/userspace/cpichot/miniconda3/envs/macs2TestNewInstall/bin/macs2"", line 56, in main
    from MACS2.callpeak_cmd import run
  File ""/opt/share/FLOCAD/userspace/cpichot/miniconda3/envs/macs2TestNewInstall/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 31, in <module>
    from MACS2.OptValidator import opt_validate
  File ""/opt/share/FLOCAD/userspace/cpichot/miniconda3/envs/macs2TestNewInstall/lib/python2.7/site-packages/MACS2/OptValidator.py"", line 27, in <module>
    from MACS2.IO.Parser import BEDParser, ELANDResultParser, ELANDMultiParser, \
  File ""__init__.pxd"", line 861, in init MACS2.IO.Parser (MACS2/IO/Parser.c:22634)
ValueError: numpy.ufunc has the wrong size, try recompiling
'
Do you have any idea to solved my problem ?  
thanks in advances",El-Castor,https://github.com/macs3-project/MACS/issues/298
MDU6SXNzdWU0Nzk0MzQwMzQ=,Q: how can I estimate other species effective genome size？,CLOSED,2019-08-12T00:46:03Z,2019-08-13T20:37:11Z,2019-08-13T20:37:11Z,"These days I want to analysis plant ATAC-seq data, and use MACS2 to call peaks. But I don't know how can I estimate a plant effective genome size.

I searched online and saw this page: https://deeptools.readthedocs.io/en/latest/content/feature/effectiveGenomeSize.html. It said that we can use unique-kmers.py to estimate effective genome size. So I used ""unique-kmers.py -k ksize TAIR10.fa"" with k value 65, 75, 85 and 95. And the biggest result was only 22% of TAIR10 genome length. But the usage of MACS2 said ""Because of the repetitive features on the chromsomes, the actual mappable genome size will be smaller than the original size, about 90% or 70% of the genome size. "" I think my value is wrong, but I don't know why.

Another way I tried was mask simple repeats, and count the number of capital letters other than N, and it is about 78% of TAIR10 genome length.

**How can I get the right effective genome size for plant? And whether MACS is suitable for plants ATAC-seq data analysis**

Thank you.",axin527,https://github.com/macs3-project/MACS/issues/299
MDU6SXNzdWU0ODE3MjUyOTY=,Bug: 0 in control.bdg even when slocal and llocal are NOT OFF.,CLOSED,2019-08-16T18:12:54Z,2019-08-16T18:39:10Z,2019-08-16T18:39:09Z,"I'm having an issue that I think is related to this. There is a short 17bp region in the middle of chr7 in one of my control bdg files that has a value of 0. I am using a treatment bed file as input with no control bam. I did not turn off slocal or llocal and I did not set nolambda. How is there a 0 value in the control bdg? Shouldn't the genome background be substitute if there aren't any nearby reads in that region?

_Originally posted by @kwcurrin in https://github.com/taoliu/MACS/issues/150#issuecomment-520017299_",taoliu,https://github.com/macs3-project/MACS/issues/303
MDU6SXNzdWU0OTAxNTg3MDg=,Q: about --cutoff-analysis output,OPEN,2019-09-06T06:42:59Z,2019-09-19T21:05:56Z,,"Hi all,
Thank you for this excellent program.

I just found out about the --cutoff-analysis option but I am buffled about the interpretation of the output. bellow is the output of one of my analysis:
1. are pscore and qscore in -log10?
npeaks is the nuber of peaks
lpeaks is the total legth?
then what is the avelpeak? average legnth of peaks?
also, how one can decide about the optimal qvalue if we are unaware of the expected biding events of a transcription factor.
```
pscore	qscore	npeaks	lpeaks	avelpeak
9.90	7.76	28061	17459315	622.00
9.60	7.48	28923	18068257	624.00
9.30	7.19	29616	18603240	628.00
9.00	6.90	30608	19291719	630.00
8.70	6.62	31440	19920529	633.00
8.40	6.33	32468	20670557	636.00
8.10	6.05	33317	21358507	641.00
7.80	5.76	34369	22139649	644.00
7.50	5.48	35392	22944232	648.00
7.20	5.19	36515	23792075	651.00
6.90	4.91	37636	24710696	656.00
6.60	4.63	39108	25816238	660.00
6.30	4.35	40339	26842484	665.00
6.00	4.07	41957	28050768	668.00
5.70	3.79	43469	29270194	673.00
5.40	3.51	45460	30751019	676.00
5.10	3.23	47310	32298631	682.00
4.80	2.96	49508	33954554	685.00
4.50	2.68	52234	35943685	688.00
4.20	2.41	54919	38018766	692.00
3.90	2.14	58558	40687652	694.00
3.60	1.87	61831	43210452	698.00
3.30	1.61	66794	46777504	700.00
3.00	1.36	73108	51046907	698.00
2.70	1.09	78646	55202392	701.00
2.40	0.85	88109	61430201	697.00
2.10	0.61	101081	69645065	689.00
1.80	0.39	120417	81323452	675.00
1.50	0.18	149170	98161975	658.00
1.20	0.00	195097	124579518	638.00
0.90	0.00	270581	167939231	620.00
0.60	0.00	397701	244617164	615.00
0.30	0.00	695330	441357030	634.00

```",sunta3iouxos,https://github.com/macs3-project/MACS/issues/312
MDU6SXNzdWU0OTQ2NTAyMDQ=,"Bug: ""Memory Error: MACS2.IO.FixWidthTrack.FWTrack.get_rlengths""",CLOSED,2019-09-17T14:12:47Z,2019-09-20T01:09:27Z,2019-09-20T01:09:27Z,"Hi, tao,
recently I ran macs2 callpeak on a genome with ~50K contigs, but macs2 aborted with the fowlling message. Is there any way to resolve this problem.

INFO  @ Sun, 15 Sep 2019 22:32:43: #3 Call peaks... 
INFO  @ Sun, 15 Sep 2019 22:32:43: #3 Pre-compute pvalue-qvalue table... 
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 622, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 57, in main
    run( args )
  File ""/usr/local/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 264, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 121, in MACS2.PeakDetect.PeakDetect.call_peaks (MACS2/PeakDetect.c:1856)
  File ""MACS2/PeakDetect.pyx"", line 393, in MACS2.PeakDetect.PeakDetect.__call_peaks_wo_control (MACS2/PeakDetect.c:5182)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 873, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:12626)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 898, in MACS2.IO.CallPeakUnit.CallerFromAlignments.call_peaks (MACS2/IO/CallPeakUnit.c:11962)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 668, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__cal_pvalue_qvalue_table (MACS2/IO/CallPeakUnit.c:9249)
  File ""MACS2/IO/CallPeakUnit.pyx"", line 497, in MACS2.IO.CallPeakUnit.CallerFromAlignments.__pileup_treat_ctrl_a_chromosome (MACS2/IO/CallPeakUnit.c:7252)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 949, in MACS2.IO.FixWidthTrack.FWTrack.pileup_a_chromosome (MACS2/IO/FixWidthTrack.c:15953)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 966, in MACS2.IO.FixWidthTrack.FWTrack.pileup_a_chromosome (MACS2/IO/FixWidthTrack.c:15375)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 218, in MACS2.IO.FixWidthTrack.FWTrack.get_rlengths (MACS2/IO/FixWidthTrack.c:4487)
MemoryError
",carl-,https://github.com/macs3-project/MACS/issues/313
MDU6SXNzdWU0OTYyMjM3Mjk=,Q: Is there any difference in peak-calling accuracy between v1.4 and v2.*?,OPEN,2019-09-20T08:40:03Z,2019-09-30T14:04:17Z,,"Hi, Thanks for this extremely good program.
I found that some of the recently published articles used macs v1.4 to find peaks. So I wonder if there is any difference in peak-calling accuracy between v1.4 and v2.*?
Thank you.
Pan",RicardoPluto,https://github.com/macs3-project/MACS/issues/315
MDU6SXNzdWU0OTc0ODY5NTY=,Cython.Compiler.Errors.CompileError: MACS2/IO/BedGraph.pyx of MACS (2.1.3.3),CLOSED,2019-09-24T06:34:55Z,2019-09-25T15:12:56Z,2019-09-25T15:12:56Z,"**Describe the error**
Cython.Compiler.Errors.CompileError: MACS2/IO/BedGraph.pyx

**installation environment**
Anaconda2/4.2.0

**error detail**
```bash
(py2) [user@host MACS2]$ python2.7 setup.py install
Compiling MACS2/Prob.pyx because it changed.
Compiling MACS2/IO/Parser.pyx because it changed.
Compiling MACS2/Pileup.pyx because it changed.
Compiling MACS2/PeakModel.pyx because it changed.
Compiling MACS2/PeakDetect.pyx because it changed.
Compiling MACS2/Signal.pyx because it changed.
Compiling MACS2/IO/PeakIO.pyx because it changed.
Compiling MACS2/IO/BedGraphIO.pyx because it changed.
Compiling MACS2/IO/FixWidthTrack.pyx because it changed.
Compiling MACS2/IO/PairedEndTrack.pyx because it changed.
Compiling MACS2/IO/BedGraph.pyx because it changed.
Compiling MACS2/IO/ScoreTrack.pyx because it changed.
Compiling MACS2/IO/CallPeakUnit.pyx because it changed.
Compiling MACS2/hashtable.pyx because it changed.
Compiling MACS2/Statistics.pyx because it changed.
[ 1/15] Cythonizing MACS2/IO/BedGraph.pyx

Error compiling Cython file:
------------------------------------------------------------
...
            return bpeaks

        thickStart = str(lvl1peakset[0][""start""])
        thickEnd   = str(lvl1peakset[-1][""end""])
        blockNum   = len(lvl1peakset)
        blockSizes = "","".join( map(lambda x:str(x[""length""]),lvl1peakset) )
                            ^
------------------------------------------------------------

MACS2/IO/BedGraph.pyx:580:29: Cannot convert Unicode string to 'str' implicitly. This is not portable and requires explicit encoding.

Error compiling Cython file:
------------------------------------------------------------
...

        thickStart = str(lvl1peakset[0][""start""])
        thickEnd   = str(lvl1peakset[-1][""end""])
        blockNum   = len(lvl1peakset)
        blockSizes = "","".join( map(lambda x:str(x[""length""]),lvl1peakset) )
        blockStarts = "","".join( map(lambda x:str(x[""start""]-start),lvl1peakset) )
                             ^
------------------------------------------------------------

MACS2/IO/BedGraph.pyx:581:30: Cannot convert Unicode string to 'str' implicitly. This is not portable and requires explicit encoding.

Error compiling Cython file:
------------------------------------------------------------
...
        # add 1bp left and/or right block if necessary
        if int(thickStart) != start:
            # add 1bp left block
            thickStart = str(start)
            blockNum += 1
            blockSizes = ""1,""+blockSizes
                            ^
------------------------------------------------------------

MACS2/IO/BedGraph.pyx:588:29: Cannot convert Unicode string to 'str' implicitly. This is not portable and requires explicit encoding.

Error compiling Cython file:
------------------------------------------------------------
...
        if int(thickStart) != start:
            # add 1bp left block
            thickStart = str(start)
            blockNum += 1
            blockSizes = ""1,""+blockSizes
            blockStarts = ""0,""+blockStarts
                             ^
------------------------------------------------------------

MACS2/IO/BedGraph.pyx:589:30: Cannot convert Unicode string to 'str' implicitly. This is not portable and requires explicit encoding.

Error compiling Cython file:
------------------------------------------------------------
...
            blockStarts = ""0,""+blockStarts
        if int(thickEnd) != end:
            # add 1bp right block
            thickEnd = str(end)
            blockNum += 1
            blockSizes = blockSizes+"",1""
                                  ^
------------------------------------------------------------

MACS2/IO/BedGraph.pyx:594:35: Cannot convert Unicode string to 'str' implicitly. This is not portable and requires explicit encoding.

Error compiling Cython file:
------------------------------------------------------------
...
                        total_p += 1
                cutoff_lpeaks[ cutoff ] = cutoff_lpeaks.get( cutoff, 0 ) + total_l
                cutoff_npeaks[ cutoff ] = cutoff_npeaks.get( cutoff, 0 ) + total_p

        # write pvalue and total length of predicted peaks
        ret = ""pscore\tnpeaks\tlpeaks\tavelpeak\n""
             ^
------------------------------------------------------------

MACS2/IO/BedGraph.pyx:1051:14: Cannot convert Unicode string to 'str' implicitly. This is not portable and requires explicit encoding.

Error compiling Cython file:
------------------------------------------------------------
...

        # write pvalue and total length of predicted peaks
        ret = ""pscore\tnpeaks\tlpeaks\tavelpeak\n""
        for cutoff in sorted(cutoff_lpeaks.keys(), reverse=True):
            if cutoff_npeaks[ cutoff ] > 0:
                ret += ""%.2f\t%d\t%d\t%.2f\n"" % ( cutoff, cutoff_npeaks[ cutoff ], cutoff_lpeaks[ cutoff ], cutoff_lpeaks[ cutoff ]/cutoff_npeaks[ cutoff ] )
                   ^
------------------------------------------------------------

MACS2/IO/BedGraph.pyx:1054:20: Cannot convert Unicode string to 'str' implicitly. This is not portable and requires explicit encoding.
Traceback (most recent call last):
  File ""setup.py"", line 115, in <module>
    main()
  File ""setup.py"", line 111, in main
    ext_modules = cythonize(ext_modules, language_level=""2"")
  File ""/home/kzhou/.conda/envs/py2/lib/python2.7/site-packages/Cython/Build/Dependencies.py"", line 1016, in cythonize
    cythonize_one(*args)
  File ""/home/kzhou/.conda/envs/py2/lib/python2.7/site-packages/Cython/Build/Dependencies.py"", line 1138, in cythonize_one
    raise CompileError(None, pyx_file)
Cython.Compiler.Errors.CompileError: MACS2/IO/BedGraph.pyx
```
",kerenzhou062,https://github.com/macs3-project/MACS/issues/317
MDU6SXNzdWU0OTg1MTY3NzQ=,Bug: Random scores in bdgdiff output,CLOSED,2019-09-25T20:50:27Z,2019-09-30T19:34:20Z,2019-09-30T19:34:20Z,"**Describe the bug**
If we use bdgdiff to call differential peaks, the 5th column (score) of the outputs shows random values, although they usually only differ in the 2nd or 3rd digits. In some other cases, the value can be a large negative float number. 

**To Reproduce**
Steps to reproduce the behavior:
1. `cd test`
2. `./test.sh test`
3. `cd test_run_bdgdiff`
4. See the content of `run_bdgdiff_prefix_c3.0_cond1.bed` and `cond1.bed`

**Expected behavior**
The 5th column shouldn't show different values.

**Computer environment:**
 - OS: Debian/Linux

",taoliu,https://github.com/macs3-project/MACS/issues/318
MDU6SXNzdWU0OTg1MjE0NzA=,Feat: SAPPER integration,CLOSED,2019-09-25T21:00:39Z,2023-08-03T03:10:21Z,2023-08-03T03:10:21Z,"SAPPER (https://github.com/LiuLabUB/SAPPER) was implemented to assemble the DNA sequence at peaks called by MACS and to call variants directly. It is written in Python3 and can be easily integrated into MACS codes.

**Describe the solution you'd like**
SAPPER should be integrated into MACS python3 branch.

",taoliu,https://github.com/macs3-project/MACS/issues/319
MDU6SXNzdWU0OTg1MjY0NzU=,Feat: HMMRATAC integration,CLOSED,2019-09-25T21:12:05Z,2022-10-03T14:44:31Z,2022-10-03T14:44:30Z,"HMMRATAC (https://github.com/LiuLabUB/HMMRATAC) is a dedicated peak caller for ATAC-seq data. It is written in JAVA, and it has some shared ideas with MACS2. It can be rewritten in Python3 and be integrated into MACS as a subcommand while dealing with ATAC-seq data.

**Describe the solution you'd like**

1. JAVA -> Python3 translation
2. Share MACS components
3. Design unit tests

**Additional context**
Some difficulties: HMMRATAC contains machine learning components such as EM algorithm, and Hidden Markov Models. We may need to introduce more dependencies including scikit-learn, hmmlearn and matplotlib.
",taoliu,https://github.com/macs3-project/MACS/issues/320
MDU6SXNzdWU1MDA0Mjc1NDc=,Bug: Cython dependency in setup.py,CLOSED,2019-09-30T17:55:15Z,2019-10-02T00:55:53Z,2019-10-02T00:55:53Z,"Thanks @taoliu  but it no longer works for me:
```
Collecting MACS2
  Using cached https://files.pythonhosted.org/packages/e9/7d/5e24cf24c048548371fc1892fc9a4261ac92cc31ec7ed99552c73c727e9e/MACS2-2.1.3.3.tar.gz
    ERROR: Command errored out with exit status 1:
     command: /home/linuxbrew/.linuxbrew/Cellar/python@2/2.7.16_1/bin/python -c 'import sys, setuptools, tokenize; sys.argv[0] = '""'""'/tmp/pip-install-LCDody/MACS2/setup.py'""'""'; __file__='""'""'/tmp/pip-install-LCDody/MACS2/setup.py'""'""';f=getattr(tokenize, '""'""'open'""'""', open)(__file__);code=f.read().replace('""'""'\r\n'""'""', '""'""'\n'""'""');f.close();exec(compile(code, __file__, '""'""'exec'""'""'))' egg_info --egg-base pip-egg-info
         cwd: /tmp/pip-install-LCDody/MACS2/
    Complete output (7 lines):
    Traceback (most recent call last):
      File ""<string>"", line 1, in <module>
      File ""/tmp/pip-install-LCDody/MACS2/setup.py"", line 115, in <module>
        main()
      File ""/tmp/pip-install-LCDody/MACS2/setup.py"", line 111, in main
        ext_modules = cythonize(ext_modules, language_level=""2"")
    NameError: global name 'cythonize' is not defined
    ----------------------------------------
ERROR: Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.
```

_Originally posted by @tseemann in https://github.com/taoliu/MACS/issues/295#issuecomment-536170628_",taoliu,https://github.com/macs3-project/MACS/issues/321
MDU6SXNzdWU1MDQ3MTczNjQ=,"Bug: abnormal output of .bed result from ""macs2 callpeak"" function",CLOSED,2019-10-09T15:12:06Z,2020-02-17T16:25:04Z,2019-10-09T15:23:20Z,"**Describe the bug**
I use macs2 callpeak to do peak finding for Chip-Seq data. I notice there are something wrong happen when *.bed results were output.

**To Reproduce**
> I use code as following:
```shell
ws=/home/huangwb8/Test/test_chip_3
cd $ws/output/align
ls *merge.rmdup.bam | grep -v Control | while read id
do (nohup macs2 callpeak --tempdir /data/ \
-c Control*bam -t $id -f BAM -B -g mm \
-n $ws/output/peaks/$(basename $id "".bam"") > \
$ws/log/peaks/$(basename $id "".bam"").log 2>&1 &)
done
```
> Here is a peak record for example. They are produced by the same code
  + *.narrowPeak
      ```
      chr1	4481756	4481888	/home/huangwb8/Test/test_chip_3/output/peaks/H2Aub1.ChIPSeq-GSM850471.merge.rmdup_peak_1	47	.      4.83060	9.25272	4.70255	96
      ```

  + *.xls
      ```
      chr1    4481757 4481888 132     4481853 18.32   9.25272 4.83060 4.70255 /home/huangwb8/Test/test_chip_3/output/peaks/H2Aub1.ChIPSeq-GSM850471.merge.rmdup_peak_1
      ```
  + *.bed
      ```
      chr1    4481852 4481853 /home/huangwb8/Test/test_chip_3/output/peaks/H2Aub1.ChIPSeq-GSM850471.merge.rmdup_peak_1        4.70255
      ```
> Thus, I found the gene fragment is from 4481852 to 4481853, **which means that the lenght of the peak is 1!** However, from *.narrowPeak or *.xls, **the gene fragment of the peak should be from 4481756/7 to 4481888.**

**System (please complete the following information):**
+ the environment of my softwares
```shell
conda 4.7.12; envs=chip-seq
Ubuntu 18.04.3 
Python 3.7.3; path=/usr/bin/python3
Python 2.7.15; path=/home/huangwb8/Downloads/conda/location/envs/chip-seq/bin/python2
macs2 2.1.3.3; path=/home/huangwb8/Downloads/conda/location/envs/chip-seq/bin/macs2
```
",huangwb8,https://github.com/macs3-project/MACS/issues/326
MDU6SXNzdWU1MDUwODg5NTY=,Q:  why MACS slides 2bandwidth windows across the genome for calling peaks?,OPEN,2019-10-10T07:28:58Z,2019-10-10T16:13:10Z,,"I learned  macs2 to call peaks for chip-seq data.But I do not know why MACS slides 2bandwidth windows across the genome for calling peaks? Someone can tell me ? thanks
",yirenheihei,https://github.com/macs3-project/MACS/issues/327
MDU6SXNzdWU1MDYxOTU4NDM=,Feat: Unit tests to cover most of MACS2 codes,OPEN,2019-10-12T14:45:45Z,2020-06-29T16:48:56Z,,"This issue ticket is to track the progress of code coverage in MACS2 unit tests.

Codecov: [![Codecov](https://img.shields.io/codecov/c/github/taoliu/MACS)](https://codecov.io/gh/taoliu/MACS)
",taoliu,https://github.com/macs3-project/MACS/issues/328
MDU6SXNzdWU1MDgxMTA4NzM=,Q: MACS2 Usage vs. MACS14,CLOSED,2019-10-16T21:32:41Z,2019-10-18T15:14:20Z,2019-10-18T15:14:20Z,"**Use case**
We are following the test/example data protocol (from section D) of the 2012 Nature paper (Identifying ChIP-seq enrichment using MACS), and we have run into several errors while trying to install PeakSplitter to use --call-subpeaks flag. 

**Describe the problem**
There are a lot of errors when we are trying to compile/make PeakSplitter which seems to be deprecated. We are wondering if MACS2 has the functionality as MACS14 and could also be used with this test data instead or if you had any recommendations for fixing the PeakSplitter compiling issues. 

```bash
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config:328:20: note: 'char32_t' declared here
typedef __char32_t char32_t;
                   ^
In file included from SplitPeaks/SequenceDownloader.cpp:2:
In file included from ./SplitPeaks/Parser.h:2:
In file included from ./SplitPeaks/Shared.h:8:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iostream:38:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ios:216:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__locale:15:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string:477:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string_view:176:
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__string:451:13: error: unknown type name 'char16_t'; did you mean 'char32_t'?
char_traits<char16_t>::length(const char_type* __s) _NOEXCEPT
            ^
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config:328:20: note: 'char32_t' declared here
typedef __char32_t char32_t;
                   ^
In file included from SplitPeaks/SequenceDownloader.cpp:2:
In file included from ./SplitPeaks/Parser.h:2:
In file included from ./SplitPeaks/Shared.h:8:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iostream:38:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ios:216:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__locale:15:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string:477:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string_view:176:
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__string:460:7: error: unknown type name 'char16_t'; did you mean 'char32_t'?
const char16_t*
      ^
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config:328:20: note: 'char32_t' declared here
typedef __char32_t char32_t;
                   ^
In file included from SplitPeaks/SequenceDownloader.cpp:2:
In file included from ./SplitPeaks/Parser.h:2:
In file included from ./SplitPeaks/Shared.h:8:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iostream:38:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ios:216:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__locale:15:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string:477:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string_view:176:
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__string:461:13: error: unknown type name 'char16_t'; did you mean 'char32_t'?
char_traits<char16_t>::find(const char_type* __s, size_t __n, const char_type& __a) _NOEXCEPT
            ^
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config:328:20: note: 'char32_t' declared here
typedef __char32_t char32_t;
                   ^
In file included from SplitPeaks/SequenceDownloader.cpp:2:
In file included from ./SplitPeaks/Parser.h:2:
In file included from ./SplitPeaks/Shared.h:8:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iostream:38:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ios:216:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__locale:15:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string:477:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string_view:176:
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__string:473:1: error: unknown type name 'char16_t'; did you mean 'char32_t'?
char16_t*
^
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config:328:20: note: 'char32_t' declared here
typedef __char32_t char32_t;
                   ^
In file included from SplitPeaks/SequenceDownloader.cpp:2:
In file included from ./SplitPeaks/Parser.h:2:
In file included from ./SplitPeaks/Shared.h:8:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iostream:38:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ios:216:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__locale:15:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string:477:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string_view:176:
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__string:474:13: error: unknown type name 'char16_t'; did you mean 'char32_t'?
char_traits<char16_t>::move(char_type* __s1, const char_type* __s2, size_t __n) _NOEXCEPT
            ^
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config:328:20: note: 'char32_t' declared here
typedef __char32_t char32_t;
                   ^
In file included from SplitPeaks/SequenceDownloader.cpp:2:
In file included from ./SplitPeaks/Parser.h:2:
In file included from ./SplitPeaks/Shared.h:8:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/iostream:38:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/ios:216:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__locale:15:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string:477:
In file included from /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/string_view:176:
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__string:493:1: error: unknown type name 'char16_t'; did you mean 'char32_t'?
char16_t*
^
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/__config:328:20: note: 'char32_t' declared here
```
**Describe the solution you tried**
We have tried to fix certain deprecated errors as they come up when we are compiling such as an incorrect header; however, we are not well versed in C, and it seems to be unfeasible to try to fix every bug/deprecation by brute force. 

**Additional context**
Our main question is that if we could use MACS2 rather than MACS14, and if there was any guide comparing the functions/flags of MACS14 and MACS2. ",yunfei-dai,https://github.com/macs3-project/MACS/issues/329
MDU6SXNzdWU1MDg0Mzk5MjQ=,clang: error: no such file or directory: 'MACS2/Prob.c' ,OPEN,2019-10-17T12:25:41Z,2019-10-17T15:18:45Z,,"**Describe the bug**
when i install the software on my macbookpro : sudo python setup.py install. It runs Bug:
clang: error: no such file or directory: 'MACS2/Prob.c'
clang: error: no input files
error: command 'cc' failed with exit status 1
A clear and concise description of what the bug is.
clang: error: no such file or directory: 'MACS2/Prob.c'

**To Reproduce**
NA

**Expected behavior**
NA

**Screenshots**
clang: error: no such file or directory: 'MACS2/Prob.c'
clang: error: no input files
error: command 'cc' failed with exit status 1

**System (please complete the following information):**
 - OS: [e.g. Linux, Mac OSX]
 - Python version [e.g. 3.7.1]
 - Numpy version [e.g. 1.17.0]
 - MACS Version [e.g. 2.2.4]

**Additional context**
NA",koujiaodahan,https://github.com/macs3-project/MACS/issues/330
MDU6SXNzdWU1MDk0MjkzNTQ=,"Q: MACS2 parameter for ATAC-seq, BAMPE or single-end mode",OPEN,2019-10-19T10:17:34Z,2019-11-07T05:34:14Z,,"Hi, I am tring to call peaks using macs2 from ATAC-seq data. 

many papers use --shift -100 --extsize 200 for MACS2 rather than -f BAMPE; but my data is paired_end reads，if I use -f BAMPE, then the parameter of --shift -100 and --extsize 200 will be discard.

so, I have some questions:  
if I am interested in genome_wide chromatin accessibility, which parameter is better?




",yue131,https://github.com/macs3-project/MACS/issues/331
MDU6SXNzdWU1MDk0NjcyNDk=,Q: How to calculate fold-enrichment or -log10(pvalue) for given peaks ,CLOSED,2019-10-19T15:20:04Z,2019-10-22T13:37:42Z,2019-10-22T13:37:42Z,"I want to know when I use macs2 callpeak to analysis TF1 chip-seq and get TF1 peaks and then I want to calculate fold-enrichment or -log10(pvalue) for TF1 peaks in TF2 or TF3 chip-seq, what could I do. Thank you so much for taking the time reading this question",674040463,https://github.com/macs3-project/MACS/issues/332
MDU6SXNzdWU1MTE1NjMyODQ=,Bug: Correct .keys() functions in BedGraph.pyx ,CLOSED,2019-10-23T20:48:07Z,2019-10-30T16:56:02Z,2019-10-30T16:56:02Z,"**Describe the bug**
BedGraph.pyx file has legacy Python2 style codes when using self.__data.keys(). 

**To Reproduce**
`macs2 bdgpeakcall --cutoff-analysis ...`

",taoliu,https://github.com/macs3-project/MACS/issues/333
MDU6SXNzdWU1MTI5MDcxOTg=,Feat: Multi-threads support in MACS2,OPEN,2019-10-27T01:39:27Z,2020-06-29T16:46:28Z,,"Can i set multi-threads when using macs2? one thread is slow.

",Lee211,https://github.com/macs3-project/MACS/issues/334
MDU6SXNzdWU1MTMzOTM3OTk=,Feat: Optimize MACS speed in Python3,CLOSED,2019-10-28T15:52:30Z,2019-10-31T07:04:14Z,2019-10-31T07:04:14Z,"Currently, the speed of Python3.7 MACS2 v2.2.4 is much slower than Python2.7 MACS2 v2.1.4. Optimization has to be done. 


",taoliu,https://github.com/macs3-project/MACS/issues/335
MDU6SXNzdWU1MTMzOTU1NDQ=,Feat: Optimize speed and memory usage,CLOSED,2019-10-28T15:55:19Z,2020-04-12T14:39:00Z,2020-04-12T14:38:19Z,Speed and memory usage optimization,taoliu,https://github.com/macs3-project/MACS/issues/336
MDU6SXNzdWU1MTU1ODk3NTg=,Bug: test/test_Signal.py:51: AssertionError 162 != 161 with Python 3.7 & MACS 2.2.5,OPEN,2019-10-31T16:52:37Z,2019-11-13T23:26:47Z,,"Thanks for the new release with all the tests!

**Describe the bug**
Build time test failure

**To Reproduce**

`python3.7 -m pytest test`

**Expected behavior**
No failed tests

**Screenshots**
```
I: pybuild base:217: cd /build/macs-2.2.5/.pybuild/cpython3_3.7_MACS2/build; python3.7 -m pytest test
============================= test session starts ==============================
platform linux -- Python 3.7.5, pytest-4.6.6, py-1.8.0, pluggy-0.13.0

[…]

=================================== FAILURES ===================================
___________________________ Test_maxima.test_maxima ____________________________

self = <test_Signal.Test_maxima testMethod=test_maxima>

    def test_maxima(self):
        expect = self.summit
        result = maxima( self.signal, self.windowsize )[0]
>       self.assertEqual( result, expect )
E       AssertionError: 162 != 161

test/test_Signal.py:51: AssertionError
----------------------------- Captured stdout call -----------------------------
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 4. 4. 4. 4.
 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 5. 5. 5. 5. 5. 5. 5. 5. 5.
 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5. 5.
 5. 5. 5. 5. 5. 5. 5. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6.
 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 7. 7. 7.
 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7.
 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 6. 6. 6. 7. 7. 7. 7. 7. 7. 7. 7.
 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7.
 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 7. 8. 8. 8. 8.
 8. 8. 8. 8. 8. 8. 7. 7. 7. 7. 7. 7. 7. 7. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6.
 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 6. 4. 4. 4. 4. 4.
 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4.
 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4. 4.
 4. 4. 4. 4. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3.
 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3.
 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3.
 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3.
 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3. 3.
 3. 3. 3. 3. 3. 3.]
```

**System (please complete the following information):**
 - OS: Debian Linux ""sid""
 - Python version 3.7.5
 - Numpy version 1.16.5-1
 - MACS Version 2.2.5

**Additional context**
Add any other context about the problem here.
",mr-c,https://github.com/macs3-project/MACS/issues/340
MDU6SXNzdWU1MTY0NDk1MTA=,Bug: AssertionError when --cutoff-analysis was set,CLOSED,2019-11-02T03:01:20Z,2019-11-09T01:43:42Z,2019-11-09T01:43:42Z,"**Describe the bug**
An exception was thrown when run callpeak program with --cutoff-analysis set.

**Screenshots**
![image](https://user-images.githubusercontent.com/21093659/68064733-40f20e80-fd5a-11e9-85c8-ee70b869f1a9.png)
**Screenshots (no --cutoff-analysis)**
![image](https://user-images.githubusercontent.com/21093659/68064798-2ec4a000-fd5b-11e9-97ae-4c4808c5b92f.png)

**Screenshots (with control, maybe another issue) **
![image](https://user-images.githubusercontent.com/21093659/68065148-af859b00-fd5f-11e9-83db-2d3e84ee3924.png)
![image](https://user-images.githubusercontent.com/21093659/68065151-b6aca900-fd5f-11e9-8789-d783602c66ed.png)

**Another data with contorl**
![image](https://user-images.githubusercontent.com/21093659/68065024-4b160c00-fd5e-11e9-93a3-2a33e265f5e7.png)
![image](https://user-images.githubusercontent.com/21093659/68065033-59fcbe80-fd5e-11e9-9a3f-09ff0738aaf4.png)

**Another data with contorl  (no --cutoff-analysis)**
![image](https://user-images.githubusercontent.com/21093659/68065058-89abc680-fd5e-11e9-99e6-82d1ffb5f71a.png)
![image](https://user-images.githubusercontent.com/21093659/68065069-acd67600-fd5e-11e9-9e97-c77e08c1b73e.png)


**System (please complete the following information):**
 - OS: Linux
 - python-3.7.5
 - numpy-1.17.2
 - macs2 2.2.5
",freedog8,https://github.com/macs3-project/MACS/issues/341
MDU6SXNzdWU1Mjk5MjUwNzc=,Bug: macs2 docker container v2.2.5 installs v2.1.3 of macs2,CLOSED,2019-11-28T13:51:46Z,2020-04-12T14:36:10Z,2020-04-12T14:36:10Z,"hi,

when I run `macs2 --version` from inside the macs2 container, I get v2.1.3 even though the documentation in https://github.com/taoliu/MACS/tree/master/DOCKER says that there is v2.2.5 inside the container. 

best. ",tinavisnovska,https://github.com/macs3-project/MACS/issues/346
MDU6SXNzdWU1MzQxODA4NjU=,Bug: Error in SAMParser and ELANDParsers.,CLOSED,2019-12-06T17:57:13Z,2019-12-16T11:23:12Z,2019-12-12T20:37:47Z,"Hello,

Could you please give me a hend:
I installed macs2 by git cloning and then
sudo python3 setup.py install
which worked.
Then I updated the PYTHONPATH and PATH accordingly.

So when I do ""macs2 callpeak -h"" I see the help menu.
However, when I try to run macs2 
macs2 callpeak -t $InDir1/chip1_alignment_1ms.sam -g $efg -n chip1_default --outdir $OutDir1
It gives the error below.
I think it's related with python3, but I needed to use it because with python2 it gave the CRITICAL error >=3.5.
If I run with
python(dflt is 2) PATH-to-macs2 ...
Then it works.

Do you have a suggestion?
Thank you in advance,
Mafalda.

(...)
TypeError: a bytes-like object is required, not 'str'
Exception ignored in: 'MACS2.IO.Parser.ELANDResultParser.__tlen_parse_line'
TypeError: a bytes-like object is required, not 'str'
TypeError: a bytes-like object is required, not 'str'
Exception ignored in: 'MACS2.IO.Parser.ELANDResultParser.__tlen_parse_line'
TypeError: a bytes-like object is required, not 'str'
TypeError: a bytes-like object is required, not 'str'
Exception ignored in: 'MACS2.IO.Parser.ELANDResultParser.__tlen_parse_line'
TypeError: a bytes-like object is required, not 'str'
TypeError: a bytes-like object is required, not 'str'
Exception ignored in: 'MACS2.IO.Parser.ELANDResultParser.__tlen_parse_line'
TypeError: a bytes-like object is required, not 'str'
TypeError: a bytes-like object is required, not 'str'
Exception ignored in: 'MACS2.IO.Parser.ELANDResultParser.__tlen_parse_line'
TypeError: a bytes-like object is required, not 'str'
TypeError: a bytes-like object is required, not 'str'
Exception ignored in: 'MACS2.IO.Parser.ELANDResultParser.__tlen_parse_line'
TypeError: a bytes-like object is required, not 'str'
TypeError: a bytes-like object is required, not 'str'
Exception ignored in: 'MACS2.IO.Parser.ELANDResultParser.__tlen_parse_line'
TypeError: a bytes-like object is required, not 'str'
ZeroDivisionError: float division
Exception ignored in: 'MACS2.IO.Parser.GenericParser.tsize'
ZeroDivisionError: float division
ZeroDivisionError: float division
Exception ignored in: 'MACS2.IO.Parser.GenericParser.tsize'
ZeroDivisionError: float division
INFO  @ Fri, 06 Dec 2019 17:51:10: Detected format is: SAM
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.2.6a2', 'macs2')
  File ""/usr/lib/python3/dist-packages/pkg_resources/__init__.py"", line 658, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/usr/lib/python3/dist-packages/pkg_resources/__init__.py"", line 1438, in run_script
    exec(code, namespace, namespace)
  File ""/usr/local/lib/python3.6/dist-packages/MACS2-2.2.6a2-py3.6-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 652, in <module>
    main()
  File ""/usr/local/lib/python3.6/dist-packages/MACS2-2.2.6a2-py3.6-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 51, in main
    run( args )
  File ""/usr/local/lib/python3.6/dist-packages/MACS2-2.2.6a2-py3.6-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 65, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/usr/local/lib/python3.6/dist-packages/MACS2-2.2.6a2-py3.6-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 391, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""MACS2/IO/Parser.pyx"", line 191, in MACS2.IO.Parser.GenericParser.build_fwtrack
  File ""MACS2/IO/Parser.pyx"", line 206, in MACS2.IO.Parser.GenericParser.build_fwtrack
  File ""MACS2/IO/Parser.pyx"", line 721, in MACS2.IO.Parser.SAMParser.__fw_parse_line
  File ""/usr/lib/python3.6/re.py"", line 222, in findall
    return _compile(pattern, flags).findall(string)
TypeError: cannot use a string pattern on a bytes-like object",MafGal,https://github.com/macs3-project/MACS/issues/347
MDU6SXNzdWU1Mzk2NzAzODE=,Bug: v2.2.6 fails tests with Python 3.8.1rc1,OPEN,2019-12-18T13:09:37Z,2019-12-21T06:10:20Z,,"**Describe the bug**
When MACS version 2.2.6 is built and tested using Python 3.8.1rc1, one of the tests (`Test_maxima.test_maxima`) fails.

Alas, the development version of Debian has Python 3.8.1rc1, and thus it breaks the new package of MACS :-(

**To Reproduce**

See https://github.com/taoliu/MACS/pull/348
&
https://travis-ci.com/taoliu/MACS/jobs/268503237#L493

**Expected behavior**
All Tests pass
",mr-c,https://github.com/macs3-project/MACS/issues/349
MDU6SXNzdWU1NDEyODkwMTU=,"Bug: cmdlinetest failures on arm64, ppc64el, s390x (official Debian ports) and hppa, hurd-i386, ia64, sparc64 (unofficial Debian ports)",OPEN,2019-12-21T06:10:12Z,2019-12-31T16:13:55Z,,"Hello,

In Debian we just started to run the cmdlinetests in addition to the unit tests and we noticed some test failures

```
14.4.2 checking bdgdiff cond1.bed ...
 ... failed! Difference:
10c10
< chr22	17753011	17753262	cond1.bed10	10.91568
---
> chr22	17753011	17753262	cond1.bed10	10.91567
13c13
< chr22	18020285	18020538	cond1.bed13	15.57159
---
> chr22	18020285	18020538	cond1.bed13	15.57158
36c36
< chr22	19483443	19483663	cond1.bed36	13.70841
```
and more: https://buildd.debian.org/status/fetch.php?pkg=macs&arch=arm64&ver=2.2.6-2&stamp=1576883064&raw=0
(similar failures for ppc64el https://buildd.debian.org/status/fetch.php?pkg=macs&arch=ppc64el&ver=2.2.6-2&stamp=1576879893&raw=0 )

s390x:
```
 checking macs2.2.6-2-3.8_run_callpeak_pe_broad/run_callpeak_bampe_broad.log...
  File ""MACS2/IO/Parser.pyx"", line 1120, in MACS2.IO.Parser.BAMPEParser.build_petrack
  File ""MACS2/IO/Parser.pyx"", line 1153, in MACS2.IO.Parser.BAMPEParser.build_petrack
ZeroDivisionError: float division
```
and more: https://buildd.debian.org/status/fetch.php?pkg=macs&arch=sparc64&ver=2.2.6-2&stamp=1576886179&raw=0
(similar failures for hppa: https://buildd.debian.org/status/fetch.php?pkg=macs&arch=hppa&ver=2.2.6-2&stamp=1576885988&raw=0 )",mr-c,https://github.com/macs3-project/MACS/issues/351
MDU6SXNzdWU1NDQwNjI1Mzg=,"""Exception: !!""",CLOSED,2019-12-31T01:50:00Z,2020-01-02T17:15:23Z,2020-01-02T17:15:22Z,"I'm having an issue with running callpeak. 
I usually look up the error messages online, but the error message in this case is ""!!"" and I've had quite a bit of trouble trying to find similar issues.
Any info (even just identifying what the double exclamation mark means) would be really helpful. 
Thank you in advance

-----------------------------------

```
# Command line: callpeak -t ./rh3_k4m1_ps_chip_rmdup.sam -c ./rh3_k4m1_ps_input_rmdup.sam -f SAM -s 40 --broad -g 2.87e9 --broad-cutoff 0.1 -B -n rh3_k4m1_ps
# ARGUMENTS LIST:
# name = rh3_k4m1_ps
# format = SAM
# ChIP-seq file = ['./rh3_k4m1_ps_chip_rmdup.sam']
# control file = ['./rh3_k4m1_ps_input_rmdup.sam']
# effective genome size = 2.87e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff for narrow/strong regions = 5.00e-02
# qvalue cutoff for broad/weak regions = 1.00e-01
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is on
# Paired-End mode is off
 
INFO  @ Mon, 30 Dec 2019 20:04:28: #1 read tag files... 
INFO  @ Mon, 30 Dec 2019 20:04:28: #1 read treatment tags... 
INFO  @ Mon, 30 Dec 2019 20:04:31:  1000000 
INFO  @ Mon, 30 Dec 2019 20:04:34:  2000000 
INFO  @ Mon, 30 Dec 2019 20:04:37:  3000000 
INFO  @ Mon, 30 Dec 2019 20:04:41:  4000000 
.
.
INFO  @ Mon, 30 Dec 2019 20:07:39:  65000000 
INFO  @ Mon, 30 Dec 2019 20:07:42:  66000000 
Traceback (most recent call last):
  File ""/ycga-gpfs/apps/hpc/software/MACS2/2.1.1.20160309-foss-2016b-Python-2.7.13/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.1.20160309', 'macs2')
  File ""/ycga-gpfs/apps/hpc/software/Python/2.7.13-foss-2016b/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 748, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/ycga-gpfs/apps/hpc/software/Python/2.7.13-foss-2016b/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 1524, in run_script
    exec(script_code, namespace, namespace)
  File ""/ycga-gpfs/apps/hpc/software/MACS2/2.1.1.20160309-foss-2016b-Python-2.7.13/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 617, in <module>
    
  File ""/ycga-gpfs/apps/hpc/software/MACS2/2.1.1.20160309-foss-2016b-Python-2.7.13/lib/python2.7/site-packages/MACS2-2.1.1.20160309-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 57, in main
    
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 73, in run
  File ""build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py"", line 399, in load_tag_files_options
  File ""MACS2/IO/Parser.pyx"", line 191, in MACS2.IO.Parser.GenericParser.build_fwtrack (MACS2/IO/Parser.c:4345)
  File ""MACS2/IO/Parser.pyx"", line 216, in MACS2.IO.Parser.GenericParser.build_fwtrack (MACS2/IO/Parser.c:4254)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 130, in MACS2.IO.FixWidthTrack.FWTrack.add_loc (MACS2/IO/FixWidthTrack.c:3440)
  File ""MACS2/IO/FixWidthTrack.pyx"", line 157, in MACS2.IO.FixWidthTrack.FWTrack.add_loc (MACS2/IO/FixWidthTrack.c:3307)
Exception: !!
```",sb-cmd,https://github.com/macs3-project/MACS/issues/352
MDU6SXNzdWU1NDg0MzA0OTA=,Q: Using MACS2 callpeak for bacteria ChIP-Seq data with --keep-up 1 reports too few paired peaks,OPEN,2020-01-11T13:31:44Z,2020-10-02T00:04:22Z,,"**Describe the bug**
Flowing the instructions, I chose the --keep-up 1 to callpeak with macs2 for bacterial ChIP-Seq data. But, it reported ""Too few paired peaks So I can not build the model! ..."". Then, I changed the parameter with --keep-up all, It reported the seemingly right results.
So, I was wandering If I should keep the parameter --keep-up all when I analyzed the bacterial ChIP-Seq data, or I could modified any other parameters to fit the analysis. Thanks. 

**To Reproduce**
Command line: callpeak --SPMR --trackline --bdg --keep-dup 1 --mfold 5 50 --gsize 5.3e6 --format BAM --name RNAP_beta --outdir RNAP_beta_output -t ERR654293.RNAP_beta_filtered_sorted.bam ERR654291.RNAP_beta_filtered_sorted.bam -c ERR654295.untagged_filtered_sorted.bam ERR654288.untagged_filtered_sorted.bam

**Screenshots**
![1](https://user-images.githubusercontent.com/24424074/72205058-a7617e80-34b9-11ea-801f-c06943a65c6d.png)



**System (please complete the following information):**
 - OS: [e.g. Mac OSX]
 - Python version [e.g. 3.7.5]
 - MACS Version [e.g. 2.2.5]

",huizhen2014,https://github.com/macs3-project/MACS/issues/353
MDU6SXNzdWU1NDg1NjQzMTA=,Some understanding about the model search and construction parameters ,OPEN,2020-01-12T12:33:45Z,2020-02-02T08:45:59Z,,"Hello, thanks for your excellent software, It is also pretty helpful to comprehend the associated biological background knowledge. By some related usages and instructions from the internet, I had some understanding about model search and construction principals. So, could you mind to help  check these deductions blew, and give any corrections?

1. With the parameter ""--bw"", which means if the user knew the length of the sheared fragment, such as 400bp, Setting the ""--bw 400"" would tell the software the fragment size, aka the sheared fragment length, is 400bp, the software then construct the Waston and Crick peak model, and would directly shift d/2 bp(200bp) from 5' to 3' end to get the peak instead of estimating the fragment size process. I mean, I reality, the sheared fragment length distribution is according to a normal distribution, a minor percentage of sheared fragment will shorter or longer than 400bp, I was wandering if the software will abandon these minor fragments in the peaks construction processes or just take the two peaks distance as 400bp. If in that way, It would output some less fold change peaks and ignore some real bind sites. 

2. According to the instructions about the parameter ""--extsize"", my understanding is if I used the parameter with parameter ""--nomodel"", such as 300, I would tell the software the sheared fragment length is 300, and from the Watson and Crick peak, It should just shift the peak to 3' end about 150bp to get the binding peak. 
Thank you !
",huizhen2014,https://github.com/macs3-project/MACS/issues/354
MDU6SXNzdWU1NTAwMDY4MzY=,Q: peaks length is very long,OPEN,2020-01-15T07:11:59Z,2020-01-15T18:41:59Z,,"Hello ,Tao,
I have a question about peaks length.I get the peaks by macs2 for chipseq data(BAMPE file),but my peaks length is very long.they almost are bigger than 500 base. this is normal right?I will list some data from my peaks file below.Thank you very much.


```
chr | star | end | length |  
chrR | 1888880 | 1897200 | 8320 | .
chr3 | 1030562 | 1036279 | 5717 | .
chr4 | 15450 | 21144 | 5694 | .
chr7 | 12389 | 17091 | 4702 | .
chr5 | 667728 | 671990 | 4262 | .
chr1 | 1475634 | 1479773 | 4139 | .
chr3 | 132973 | 136895 | 3922 | .
chr5 | 347409 | 351045 | 3636 | .
chr7 | 629367 | 632930 | 3563 | .
chr5 | 708703 | 712215 | 3512 | .
chr1 | 761428 | 764877 | 3449 | .
chr1 | 3146009 | 3149230 | 3221 | .
chr1 | 3105738 | 3108941 | 3203 | .
chr7 | 385703 | 388840 | 3137 | .
chr7 | 194748 | 197879 | 3131 | .
chr2 | 623495 | 626552 | 3057 | .
chr2 | 638941 | 641974 | 3033 | .
chrR | 1722466 | 1725316 | 2850 | .
chr2 | 1649317 | 1652141 | 2824 | .
chr1 | 1952043 | 1954826 | 2783 | .
chr2 | 804016 | 806797 | 2781 | .
chr4 | 1271810 | 1274566 | 2756 | .
chr1 | 661633 | 664373 | 2740 | .
chr6 | 86747 | 89481 | 2734 | .
chr1 | 2456965 | 2459657 | 2692 | .
chr2 | 522903 | 525579 | 2676 | .
chr1 | 3045426 | 3048054 | 2628 | .
chr1 | 190996 | 193613 | 2617 | .
chrR | 1586201 | 1588812 | 2611 | .
chr4 | 1041711 | 1044314 | 2603 | .
chr6 | 76212 | 78804 | 2592 | .
chr2 | 1746703 | 1749288 | 2585 | .
chr1 | 2432263 | 2434826 | 2563 | .
chr1 | 949260 | 951816 | 2556 | .
chr7 | 9592 | 12094 | 2502 | .
chr6 | 512863 | 515365 | 2502 | .
chr1 | 1509268 | 1511753 | 2485 | .
chrR | 988412 | 990843 | 2431 | .
chr7 | 439503 | 441929 | 2426 | .
chr2 | 180741 | 183107 | 2366 | .
chr1 | 1826541 | 1828905 | 2364 | .
chr4 | 1467570 | 1469922 | 2352 | .
chrR | 1762374 | 1764697 | 2323 | .
chr1 | 1526805 | 1529087 | 2282 | .


```


",yirenheihei,https://github.com/macs3-project/MACS/issues/355
MDU6SXNzdWU1NTA0ODg1OTE=,Q: How to incorporate ChIP-seq spike in normalisation into peak calling? ,OPEN,2020-01-15T23:35:11Z,2024-03-28T10:21:18Z,,"Hello, 
I have been trying to figure out how to incorporate external spike-in normalisation factors to both single-end and paired-end ChIP-seq data for peak calling with MACS2. 

I tried peak calling through sub commands - by scaling ChIP and control samples using 'bdgopt' subcommand based on calculated spike-in normalisation factor. 
However, at the moment ""Advanced: Call peaks using MACS2 subcommands"" tutorial provides instruction only for single-end data.

What would be the best way to perform this type of analysis for paired end data?

Thank you very much in advance.",tudumanne,https://github.com/macs3-project/MACS/issues/356
MDU6SXNzdWU1NTA1ODE5MjU=,Q: confuse about the description to --SPMR,CLOSED,2020-01-16T05:23:06Z,2020-01-22T15:32:36Z,2020-01-22T15:32:36Z,"Dear Dr. Liu, 

Here, I am a little confuse about --SPMR: 

""If you plan to use the signal output in bedGraph to call peaks using bdgcmp and bdgpeakcall, you shouldn't use this option because you will end up with different results""

What I am thinking is SPMR normalization only change the absolute value and keep the relative values for the pattern, I think there should be no difference with suitable statistic approach, right? hope to receive some help to understand it. 

Thanks. 

Shicheng

",Shicheng-Guo,https://github.com/macs3-project/MACS/issues/357
MDU6SXNzdWU1NjY3MzI3OTA=,Bug: floating point rounding discrepancies on some architectures,OPEN,2020-02-18T08:42:45Z,2020-03-30T20:16:12Z,,"**Describe the bug**
The Debian packaged version of MACS has shown floating point rounding issues when building on different hardware architectures.  You can find the affected architectures on the [autobuilder page](https://buildd.debian.org/status/package.php?p=macs).

There is a [bug report in the Debian bug tracking system](https://bugs.debian.org/949204) explaining the issue.  The bug report extracts the main information from these logs:

    > 14.9.6 checking callpeak_pe_broad run_callpeak_bedpe_broad_peaks.broadPeak ...
    >   ... failed! Difference:
    > 4c4
    > < chr22 17398268 17398740 run_callpeak_bedpe_broad_peak_4 279 . 13.95538 30.73891 27.95395
    > ---
    > > chr22 17398268 17398740 run_callpeak_bedpe_broad_peak_4 279 . 13.95538 30.73891 27.95394

    i386, mips64el and mipsel, failed with a NaN verses 0 discrepancy

    > E       0.0
    > E
    > E       - (-48.6784, nan)
    > E       ?            ^^^
    > E
    > E       + (-48.6784, 0.0)
    > E       ?            ^^^
    and s390x failed with a zerodivisionerror

    >    File ""MACS2/IO/Parser.pyx"", line 1153, in MACS2.IO.Parser.BAMPEParser.build_petrack
    > ZeroDivisionError: float division
    >   ... error/warning found!


**To Reproduce**
I tried to reproduce the issue in an i386 chroot - but here the test suite worked (may be due to the fact that amd64 floating point is used in this case.  So testing on a real hardware emulation or real hardware is necessary.

**Expected behavior**
The test suite should run on all supported hardware platforms.

**System (please complete the following information):**
 - OS: Debian GNU Linux - different hardware
 - Python version: 3.7.5
 - Numpy version: 1.17.4
 - MACS Version: 2.2.6

Kind regards, Andreas.",tillea,https://github.com/macs3-project/MACS/issues/359
MDU6SXNzdWU1ODA5Njc3OTc=,Bug: bdgbroadcall reporting problem,CLOSED,2020-03-14T01:09:29Z,2020-04-12T14:35:03Z,2020-04-12T14:35:03Z,"**Describe the bug**
I’m trying to call peaks using bdgbroadcall from bdg generates by cmbreps and -m fisher  But the out put of the bdgbroadcall contain no p – value or any other than coordinate (below you can find the heading of the output)


track name=""peak"" description=""peak"" type=gappedPeak nextItemButton=on

chr1 818930 819140 H3K4me1_H0_1_2_G840.bdg_broadRegion1 0 . 818930 819140 0 2 1,1 0,209 0.00000 0.00000 0.00000

chr1 903599 904278 H3K4me1_H0_1_2_G840.bdg_broadRegion2 0 . 903599 904278 0 3 1,632,1 0,37,678 0.00000 0.00000 0.00000

chr1 905126 907304 H3K4me1_H0_1_2_G840.bdg_broadRegion3 0 . 905126 907304 0 3 1,212,1 0,1915,2177 0.00000 0.00000 0.0000

**To Reproduce**

So this what I did

1 call peaks after removing all duplicates
macs2 callpeak -t $INDIR/ Sample1_Mkdup_fliter.bam \
-c $Input/Input_Mkdup_fliter.bam \
-f BAM -g hs -n H3K4me1_H0_1 -B --broad -q 0.01 --keep-dup all --nomodel --extsize 210 –outdir

2 compare pileup and lambda for each replicates to get pvalue track
macs2 bdgcmp -t rep1_pileup.bdg -c rep1_lambda.bdg -m ppois -o rep1_pvalue.bdg
macs2 bdgcmp -t rep2_pileup.bdg -c rep2_lambda.bdg -m ppois -o rep2_pvalue.bdg

3- combine both files
macs2 cmbreps -i rep1_pvalue.bdg rep2_pvalue.bdg -m fisher -o rep1_rep2_pvalue.bdg.bdg

4 recall peaks
macs2 bdgbroadcall -i rep1_rep2_pvalue.bdg.bdg -c 8 -l 210 -g 76 -o rep1_rep2.bdg

**Expected behavior**
I think it is a reporting problem by macs2 , since the narrow peak calling with bdgpeakcall tool work fine

**Screenshots**
If applicable, add screenshots to help explain your problem.
![image](https://user-images.githubusercontent.com/25483535/76671837-cdc69780-6598-11ea-93fc-311797a17af0.png)


**System (please complete the following information):**
 - OS: [e.g. Linux, Mac OSX]
 

**Additional context**
Add any other context about the problem here.

",Me6me82,https://github.com/macs3-project/MACS/issues/362
MDU6SXNzdWU1ODM5MzAyNDc=,Bug: can't install without NumPy,CLOSED,2020-03-18T18:41:05Z,2020-04-12T14:34:07Z,2020-04-12T14:34:06Z,"**Describe the bug**
The install instructions at https://github.com/taoliu/MACS/blob/5e742732e32f6e5648b2bd5466d50e32f66f8ad0/INSTALL.md#install-through-pypi say that ""PyPI will
install Numpy automatically if it is absent.""

This doesn't work, because `setup.py` imports NumPy directly: https://github.com/taoliu/MACS/blob/5e742732e32f6e5648b2bd5466d50e32f66f8ad0/setup.py#L16

This is easy to work around, and most people probably won't ever encounter this -- I assume most installations of MACS2 are in an existing Python environment that already includes NumPy. It's easy to hit this when building a Docker image though, with the common practice of creating a `requirements.txt` file, `COPY`ing that to the container, then running `pip install -r requirements.txt`.

In any case, this should probably either be fixed or the installation instructions should be modified. (It's also more accurate to say ""`pip` will install NumPy automatically ..."" instead of ""PyPI ..."" if modifying those instructions.)

**To Reproduce**
```
$ docker run -it --rm python:3 /bin/bash
root@e8aafde9f328:/# pip install MACS2==2.2.6
Collecting MACS2==2.2.6
  Downloading MACS2-2.2.6.tar.gz (2.0 MB)
     |████████████████████████████████| 2.0 MB 4.5 MB/s 
    ERROR: Command errored out with exit status 1:
     command: /usr/local/bin/python -c 'import sys, setuptools, tokenize; sys.argv[0] = '""'""'/tmp/pip-install-a0ddbdtm/MACS2/setup.py'""'""'; __file__='""'""'/tmp/pip-install-a0ddbdtm/MACS2/setup.py'""'""';f=getattr(tokenize, '""'""'open'""'""', open)(__file__);code=f.read().replace('""'""'\r\n'""'""', '""'""'\n'""'""');f.close();exec(compile(code, __file__, '""'""'exec'""'""'))' egg_info --egg-base /tmp/pip-install-a0ddbdtm/MACS2/pip-egg-info
         cwd: /tmp/pip-install-a0ddbdtm/MACS2/
    Complete output (5 lines):
    Traceback (most recent call last):
      File ""<string>"", line 1, in <module>
      File ""/tmp/pip-install-a0ddbdtm/MACS2/setup.py"", line 16, in <module>
        from numpy import get_include as numpy_get_include
    ModuleNotFoundError: No module named 'numpy'
    ----------------------------------------
ERROR: Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.
```

Even if NumPy and MACS2 are both listed in a `requirements.txt` file, installation of MACS2 will still fail, because `pip` imports this `setup.py` between downloading and installing packages:

```
$ docker run -it --rm python:3 /bin/bash
root@ef1339bcaf4e:/# echo 'numpy==1.18.2' > requirements.txt
root@ef1339bcaf4e:/# echo 'MACS2==2.2.6' >> requirements.txt 
root@ef1339bcaf4e:/# pip install -r requirements.txt 
Collecting numpy==1.18.2
  Downloading numpy-1.18.2-cp38-cp38-manylinux1_x86_64.whl (20.6 MB)
     |████████████████████████████████| 20.6 MB 4.6 MB/s 
Collecting MACS2==2.2.6
  Downloading MACS2-2.2.6.tar.gz (2.0 MB)
     |████████████████████████████████| 2.0 MB 33.1 MB/s 
    ERROR: Command errored out with exit status 1:
     command: /usr/local/bin/python -c 'import sys, setuptools, tokenize; sys.argv[0] = '""'""'/tmp/pip-install-88yrb2td/MACS2/setup.py'""'""'; __file__='""'""'/tmp/pip-install-88yrb2td/MACS2/setup.py'""'""';f=getattr(tokenize, '""'""'open'""'""', open)(__file__);code=f.read().replace('""'""'\r\n'""'""', '""'""'\n'""'""');f.close();exec(compile(code, __file__, '""'""'exec'""'""'))' egg_info --egg-base /tmp/pip-install-88yrb2td/MACS2/pip-egg-info
         cwd: /tmp/pip-install-88yrb2td/MACS2/
    Complete output (5 lines):
    Traceback (most recent call last):
      File ""<string>"", line 1, in <module>
      File ""/tmp/pip-install-88yrb2td/MACS2/setup.py"", line 16, in <module>
        from numpy import get_include as numpy_get_include
    ModuleNotFoundError: No module named 'numpy'
    ----------------------------------------
ERROR: Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.
```

**Expected behavior**
NumPy would be installed as a dependency of MACS2, instead of `setup.py` failing due to the lack of this package.

**System (please complete the following information):**
 - OS: `python:3` Docker image
 - Python version: 3.8.2 as of writing this, but also encountered this under 3.6.9 on Ubuntu 18.04
 - Numpy version: None - that's the problem
 - MACS Version 2.2.6",mruffalo,https://github.com/macs3-project/MACS/issues/364
MDU6SXNzdWU1ODYzNjQ3NTI=,Bug: callpeak --broad uses 4*tagsize as lvl2_max_gap,CLOSED,2020-03-23T17:03:59Z,2020-04-12T14:30:31Z,2020-04-12T14:30:31Z,"**Describe the bug**
From 97e27a0dc685123ef5d89a8ed5601423b0b724a6 it seems callpeak --broad uses 4\*tagsize when merging level 2 peaks, instead of 4\*fragmentsize which was used earlier.  
I cannot find this change described in the change log, and the readme still says 
""The maximum length of broad region length is 4 times of d from MACS.""

**To Reproduce**
L253 of PeakDetect.pyx

**Expected behavior**
Either 4*fragmentsize should be used, or readme and changelog updated. 

",knutdrand,https://github.com/macs3-project/MACS/issues/365
MDU6SXNzdWU1ODcyNjQyOTE=,using --ratio in macs2 callpeak to do spike-in normalization?,CLOSED,2020-03-24T20:38:28Z,2020-03-26T21:17:25Z,2020-03-26T21:17:25Z,"Hi,

I noticed there is a similar question on how to incorporate spike-in normalization into macs2 peak calling in #356 which recommends doing subcommands. 
However, I saw that `macs2 callpeak` has `--ratio `option and am wondering whether this is a new feature that enable us to specify spike-in normalization via `--ratio` instead of doing the subcommands?

Thanks in advance!",olechnwin,https://github.com/macs3-project/MACS/issues/366
MDU6SXNzdWU1ODc5NTAwMTI=,Q: Combine --qvalue with bdgpeakcall ,CLOSED,2020-03-25T19:51:15Z,2020-03-26T13:57:28Z,2020-03-26T13:57:28Z,"**Use case**
I used cmbreps to combine replicates and now i want to call peaks on this, however I don't see how I can change the qvalue.

**Describe the problem**
I want to change the qvalue",Maarten-vd-Sande,https://github.com/macs3-project/MACS/issues/368
MDU6SXNzdWU1OTA4NDMxMjc=,Q: peaks extended outside of chromosome,CLOSED,2020-03-31T06:49:34Z,2020-04-06T14:48:33Z,2020-04-06T14:48:33Z,"Hi,@taoliu .
When I use macs2 call peaks,I get a peak extended outside of chromosome.
![深度截图_选择区域_20200331144255](https://user-images.githubusercontent.com/40382381/77995385-4631a480-735e-11ea-9662-25d3ac01ee98.png)

Align:BWA  Ref:Hg19

Hg19's chr17  is only 81195210.
81195249 > 81195210
Looking forward to your reply!
",TheSallyGardens,https://github.com/macs3-project/MACS/issues/371
MDU6SXNzdWU1OTIwNDIzOTk=,Feat: A new subcommand to output peak-count-matrix by taking MACS2 peaks and bdg files.,OPEN,2020-04-01T16:22:54Z,2020-07-07T14:40:38Z,,"**Is your feature request related to a problem? Please describe.**
No.

**Describe the solution you'd like**
A straightforward subcommand which can take peaks and bedGraph files and output peak-count matrix so that users can use whatever downstream differential peak calling tool on it. We may need to output either plain text format (for R downstream) or to use scipy sparse matrix format (for scanpy downstream).

`macs2 buildmatrix -p peak1.bed peak2.bed peak3.bed peak4.bed -b signal1.bdg signal2.bdg signal3.bdg signal4.bdg -f plain -o matrix.txt`


",taoliu,https://github.com/macs3-project/MACS/issues/372
MDU6SXNzdWU1OTU5NjA4NTI=,Q: MACS2 IndexError: list index out of range #652,CLOSED,2020-04-07T15:35:32Z,2022-02-08T14:27:38Z,2020-04-08T15:54:36Z,"I get the following error stack upon running callpeak on my two SAM-files (from bowtie). 
Any way I can troubleshoot what is wrong here?
Thank you so much!


# Command line: callpeak -t ip.sam -c input.sam --name=m6A --format=SAM --tsize=36 --nomodel --extsize=100
# ARGUMENTS LIST:
# name = m6A
# format = SAM
# ChIP-seq file = ['ip.sam']
# control file = ['input.sam']
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
INFO  @ Tue, 07 Apr 2020 23:04:37: #1 read tag files... 
INFO  @ Tue, 07 Apr 2020 23:04:37: #1 read treatment tags... 
Traceback (most recent call last):
  File ""/public/software/anaconda3/bin/macs2"", line 652, in <module>
    main()
  File ""/public/software/anaconda3/bin/macs2"", line 51, in main
    run( args )
  File ""/public/software/anaconda3/lib/python3.7/site-packages/MACS2/callpeak_cmd.py"", line 65, in run
    else:       (treat, control) = load_tag_files_options  (options)
  File ""/public/software/anaconda3/lib/python3.7/site-packages/MACS2/callpeak_cmd.py"", line 391, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""MACS2/IO/Parser.pyx"", line 188, in MACS2.IO.Parser.GenericParser.build_fwtrack
  File ""MACS2/IO/Parser.pyx"", line 203, in MACS2.IO.Parser.GenericParser.build_fwtrack
  File ""MACS2/IO/Parser.pyx"", line 783, in MACS2.IO.Parser.SAMParser.__fw_parse_line
IndexError: list index out of range",zoucheng123,https://github.com/macs3-project/MACS/issues/374
MDU6SXNzdWU1OTY0NDI2NDY=,Q: Is it necessary to use IgG as control for CUT&TAG data,OPEN,2020-04-08T09:35:29Z,2022-01-07T16:29:25Z,,"
Hi, my data is CUT&Tag-sequencing, but I don't know should I add IgG sample as control for peak calling when using macs2. In my experiment, L9 was the IgG sample, and L1\L2\L3\L4 sample were just different in cells input (100，1k,1w and 10 w respectively). Other experimental conditions are the same. The alignment results was as table 1. when I did not add IgG control, the peaks number was as table 2. The number of peaks increased with the amount of cells. However, it get the opposite result when using the L9 as IgG control (Table3). I don't know which result is correct, could you give me any advice?
(1) Table1 :Alignment results

Sample | L1 | L2 | L3 | L4 | L9
-- | -- | -- | -- | -- | --
Clean reads pair | 23352501 | 14016997 | 8588937 | 12006095 | 7104387
Mapped reads pair | 21165340 | 12074669 | 7180872 | 11589712 | 6476417
Mapping rate(%) | 90.63 | 86.14 | 83.61 | 96.53 | 91.16
Duplicate reads | 40234544 | 22294654 | 10839854 | 6596992 | 11982356
Duplicate rate(%) | 95.05 | 92.32 | 75.48 | 28.46 | 92.51
chrMT reads | 570956 | 401178 | 397724 | 431596 | 1452286
chrMT rate(%) | 1.35 | 1.66 | 2.77 | 1.86 | 11.21

(2)Table2: Number of peaks calling by macs2 without IgG.
 `macs2 callpeak -t L2.rmMT.bam -g hs -f BAMPE -n L2 -p 1e-05
`

Sample | Peaks_num
-- | --
L1 | 2204
L2 | 2800
L3 | 6531
L4 | 18018

(3)Table3 :Number of peaks calling by macs2 with IgG.
`macs2 callpeak -t L2.rmMT.bam -c L9.rmMT.bam -g hs -f BAMPE -n L2 -p 1e-05`

Sample | Peaks_number
-- | --
L1 | 34841
L2 | 44386
L3 | 8201
L4 | 5011

(4) TSS heatmap
![图片1](https://user-images.githubusercontent.com/63155081/78766763-4237ff00-79bc-11ea-9bbd-f8c046124728.png)
",leafyeszjl,https://github.com/macs3-project/MACS/issues/375
MDU6SXNzdWU1OTcwMDExNjU=,Q: p-value of peak in MACS2,CLOSED,2020-04-09T03:51:17Z,2020-04-11T14:47:41Z,2020-04-11T14:47:41Z,"Hi, I am wondering how MACS2 calculate p-value for identified peak. As far as I am understood, MACS2 performs poisson test base-by-base across genome and does multiple test correction, resulting in q-values. Peaks are constructed from the regions above the threshold of q-value/fold change. Am I correct? Then, my question is how to calculate a p-value/q-value for a peak if p-values/q-values are calculated base-by-base.",taeyoungh,https://github.com/macs3-project/MACS/issues/376
MDU6SXNzdWU1OTcxOTYxMTY=,Bug:  macs2: error: unrecognized arguments: --min-length 500 --max-gap 5000',CLOSED,2020-04-09T10:50:13Z,2020-04-09T19:29:51Z,2020-04-09T19:26:41Z,"Dear Taoliu,

I am using macs2 2.1.2 version and working with BAMPE file. When I am looking at the manual (macs2 -h), I could see that the following arguments are available: --min-length, --max-gap. However when I tried tu use it, I get the following message: 'macs2: error: unrecognized arguments: --min-length 500 --max-gap 5000'. 

Combined to them I used the following arguments: 
--format BAMPE \
--gsize 1.87e9 \
--outdir  \
--name  \
--outdir  \
--bdg \
--qvalue 0.05 \
--broad \
--cutoff-analysis \
--fe-cutoff 1.0 \

Please, would you like to tell me what is the issue? 

Thank you very much for your help,

MB
",mb6434,https://github.com/macs3-project/MACS/issues/377
MDU6SXNzdWU1OTgwNzI4OTY=,Bug: bdgpeakcall output zeros,CLOSED,2020-04-10T20:16:18Z,2020-04-13T14:48:44Z,2020-04-10T21:04:50Z,"**Describe the bug**
This is very similar to #362 in that using `bdgpeakcall` generates output that contain zeros in columns 7-9.
  
Below, example lines from bdgpeakcall output file
```
track type=narrowPeak name=""peaks.bed"" description=""peaks.bed"" nextItemButton=on
chr1	12237	15856	peaks.bed_narrowPeak1	367	.	0.00000	0.00000	0.00000	905
chr1	16017	16585	peaks.bed_narrowPeak2	90	.	0.00000	0.00000	0.00000	425
chr1	16786	18924	pval_peaks.bed_narrowPeak3	218	.	0.00000	0.00000	0.00000	704
```

**To Reproduce**
I am following the steps in [https://github.com/taoliu/MACS/wiki/Advanced%3A-Call-peaks-using-MACS2-subcommands]() . 
At the last step to call peaks on score track using a cutoff, this what I did:
`macs2 bdgpeakcall -i peak_pvalue.bdg -c 2 -l 175 -g 150 -o peaks.bed
`

**Expected behavior**
I can see peak_pvalue.bdg have pvalues that are not zero
Here are the first few  peaks in peak_pvalue.bdg sort by 5th column (i.e. -log10(pvalue))

```
 sort -nrk 4 peaks_pvalue.bdg | head
chr3    122870739       122870740       2952.45776
chr3    122870740       122870742       2940.46948
chr3    122870742       122870743       2935.67627
```

Here are the first few sorted peaks based on 8th column which should be -log10(pvalue)
```
sort -nrk 8 peaks.bed | head -n 10
track type=narrowPeak name=""peaks.bed"" description=""peaks.bed"" nextItemButton=on
chrY    959237  959448  peaks.bed_narrowPeak212237     68      .       0.00000 0.00000 0.00000 166
chrY    7717573 7717766 peaks.bed_narrowPeak212349     83      .       0.00000 0.00000 0.00000 45
chrY    7311337 7311645 peaks.bed_narrowPeak212348     631     .       0.00000 0.00000 0.00000 230
```

Here are the  same narrowpeak file but sorted based on 5th column
```
sort -nrk 5 peaks.bed | head -n 10
chr3    122867452       122877691       peaks.bed_narrowPeak151954     29524   .       0.00000 0.00000 0.00000 3287
chr12   72773195        72777012        peaks.bed_narrowPeak48999      25339   .       0.00000 0.00000 0.00000 1398
chr15   90017533        90024659        peaks.bed_narrowPeak68747      24055   .       0.00000 0.00000 0.00000 506
```
 
**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: Linux
 - MACS Version  2.2.6 and 2.1.4

**Additional context**
I first discovered the problem running macs version 2.1.4. Since #362 mentioned narrow peak calling with `bdgpeakcall` works fine, I upgraded to macs version 2.2.6 and had the same problem.

Thank you!
",olechnwin,https://github.com/macs3-project/MACS/issues/379
MDU6SXNzdWU2MDI2OTA4NjY=,Q: The Broad peak calling with extra parameter --nomodel  --extsize 73 gives biologically opposite result compared to default broad peaks calling,CLOSED,2020-04-19T11:27:23Z,2020-04-20T18:26:43Z,2020-04-20T18:26:43Z,"Dear MACS2 programmers, 
We are analyzing ChiPmentation data of H3K27m3 mark, data was generated in our lab. It happened, that we used 2 different approaches to call peaks:
1st approach: macs2 callpeak -t Sample.bam -c Control.bam -f BAM -g hs -B --broad -n  --outdir ~/H3K27me 
2nd approach: macs2 callpeak -t Sample.bam -c Control.bam -f BAM -g hs -B --broad -n  --outdir ~/H3K27me **--nomodel  --extsize 73**

The problem is, that the resulting broad peaks from the same sample, but different approaches, differs dramatically. Where second approach shows general loss of H4K27me3, the first approach demonstrates the gain of this mark. 
We also checked the control genes H4K27me3 status but with 2 different packages, DeSeq2 and DiffBind (using DeSeq2 algorithm). And the control genes demonstrate expected pattern with approach 1 and approach 2. 

I plotted pileups from the different approaches: 
![ready_forum](https://user-images.githubusercontent.com/15571241/79689882-ee4cd600-8257-11ea-80ac-b85cda6caf50.jpeg)

Is this analysis already enough to conclude that 1 approach is better? 

What would be the best way to decide which peak calling line is better? Are there any possible additional analysis of the peak lists to select the way?

Many thanks in advance,
Best wishes, 
Anna
 
  
",AnnaKuchmiy,https://github.com/macs3-project/MACS/issues/382
MDU6SXNzdWU2MDMzODE4MTA=,Bug: `callpeak --cutoff-analysis` ZeroDivision when there is no peaks can be called.,CLOSED,2020-04-20T16:47:59Z,2020-04-24T15:06:14Z,2020-04-24T15:06:14Z,"Need to suppress the warning msg and skip the corresponding cutoff.

```
$macs2 callpeak -f BAMPE -t dummy.bam --cutoff-analysis
INFO  @ Mon, 20 Apr 2020 10:32:48:
# Command line: callpeak -f BAMPE -t dummy.bam --cutoff-analysis
# ARGUMENTS LIST:
# name = NA
# format = BAMPE
# ChIP-seq file = ['dummy.bam']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is on

INFO  @ Mon, 20 Apr 2020 10:32:48: #1 read fragment files...
INFO  @ Mon, 20 Apr 2020 10:32:48: #1 read treatment fragments...
INFO  @ Mon, 20 Apr 2020 10:32:48: 13 fragments have been read.
INFO  @ Mon, 20 Apr 2020 10:32:48: #1 mean fragment size is determined as 174.8 bp from treatment
INFO  @ Mon, 20 Apr 2020 10:32:48: #1 fragment size = 174.8
INFO  @ Mon, 20 Apr 2020 10:32:48: #1  total fragments in treatment: 13
INFO  @ Mon, 20 Apr 2020 10:32:48: #1 user defined the maximum fragments...
INFO  @ Mon, 20 Apr 2020 10:32:48: #1 filter out redundant fragments by allowing at most 1 identical fragment(s)
INFO  @ Mon, 20 Apr 2020 10:32:48: #1  fragments after filtering in treatment: 13
INFO  @ Mon, 20 Apr 2020 10:32:48: #1  Redundant rate of treatment: 0.00
INFO  @ Mon, 20 Apr 2020 10:32:48: #1 finished!
INFO  @ Mon, 20 Apr 2020 10:32:48: #2 Build Peak Model...
INFO  @ Mon, 20 Apr 2020 10:32:48: #2 Skipped...
INFO  @ Mon, 20 Apr 2020 10:32:48: #3 Call peaks...
INFO  @ Mon, 20 Apr 2020 10:32:48: #3 Pre-compute pvalue-qvalue table...
INFO  @ Mon, 20 Apr 2020 10:32:48: #3 Cutoff vs peaks called will be analyzed!
ZeroDivisionError: division by zero
Exception ignored in: 'MACS2.IO.CallPeakUnit.CallerFromAlignments.__pre_computes'
Traceback (most recent call last):
  File ""/Users/taoliu/Codes/TLPython3/lib/python3.8/site-packages/MACS2-2.2.7.1-py3.8-macosx-10.9-x86_64.egg/MACS2/callpeak_cmd.py"", line 256, in run
    peakdetect.call_peaks()
ZeroDivisionError: division by zero
INFO  @ Mon, 20 Apr 2020 10:32:48: #3 Call peaks for each chromosome...
INFO  @ Mon, 20 Apr 2020 10:32:48: #4 Write output xls file... NA_peaks.xls
INFO  @ Mon, 20 Apr 2020 10:32:48: #4 Write peak in narrowPeak format file... NA_peaks.narrowPeak
INFO  @ Mon, 20 Apr 2020 10:32:48: #4 Write summits bed file... NA_summits.bed
INFO  @ Mon, 20 Apr 2020 10:32:48: Done!
```

The zeroDivisionError is due to the fact that there is no peaks can be called under certain cutoff. I will silence the error and skip the corresponding cutoff during cutoff-analysis in the future version. But I can't reproduce the `KeyError` you saw. Could you share me the file you used before which contains 50 pairs?

_Originally posted by @taoliu in https://github.com/taoliu/MACS/issues/214#issuecomment-616596440_",taoliu,https://github.com/macs3-project/MACS/issues/383
MDU6SXNzdWU2MDM0ODc0MDg=,Feat: Genrich like AUC peak calling method,OPEN,2020-04-20T19:43:13Z,2020-06-03T13:08:40Z,,"**Is your feature request related to a problem? Please describe.**
NA

**Describe the solution you'd like**
Genrich(https://github.com/jsh58/Genrich) has an interesting feature while calling peaks. It will measure the Area Under the Curve, i.e. the sum of signals under the curve of peak shape (above certain baseline). Currently, when MACS2 call peaks, it will only check if the entire peak region is above certain baseline, then report the maximum value (narrowpeak) or average value (broadpeak). It will be interesting to provide options to users that they can get different types of statistics, and control the peak calling strategy.

**Additional context**
Scipy sparseMatrix to store signals may be necessary.
",taoliu,https://github.com/macs3-project/MACS/issues/385
MDU6SXNzdWU2MDcyODcwMzY=,Bug:  ModuleNotFoundError: No module named 'MACS2',CLOSED,2020-04-27T06:53:25Z,2020-04-28T14:25:52Z,2020-04-28T14:25:51Z,"**Describe the bug**

When I run the MACS2 on my environment, it returns the error as below,

Traceback (most recent call last):
  File ""/usr/bin/macs2"", line 31, in <module>
    from MACS2.Constants import *
ModuleNotFoundError: No module named 'MACS2'

Actually I have used it without any problem before installing python3 and change it into the default version. I also tried running macs2 after changing the python version 2.7 but it returns same error.

**System (please complete the following information):**
 - OS: Ubuntu 18.04
 - Python version 3.6.9
 - Numpy version numpy-1.18.3
 - MACS Version 2-2.1.0.20151222

",yurasong,https://github.com/macs3-project/MACS/issues/387
MDU6SXNzdWU2MTA1MDE4NzM=,Q: ChIPSeq calling peaks with SPMR,OPEN,2020-05-01T01:37:48Z,2020-05-11T19:06:37Z,,"Hello, I am running the command below

macs2 callpeak -t 18.chip.sorted.bam \
-c 12.input.sorted.bam \
-f BAMPE -g hs --broad-cutoff 0.1 -B --SPMR -n His_Rep2 \
--outdir /SPMR/eachind

I understand that when using SPMR I can use this to visualize signal tracks and should not use it for calling peaks from the bedgraphs subsequently generated but can I use the peaks bed/xls file that is generated after running the above command? I think that is fine?
",bioinfograd,https://github.com/macs3-project/MACS/issues/388
MDU6SXNzdWU2MTA2Mjg5NDE=,Version 1.4.2 is not in the releases section,OPEN,2020-05-01T08:14:01Z,2020-05-15T15:01:47Z,,"Hi,

I downloaded macs 1.4.2-1 in 2018 from 

https://github.com/downloads/taoliu/MACS/MACS-1.4.2-1.tar.gz

I would like to cite this very version but I don't see any link to it on the github page itself in the releases section. The last version on github in the releases section is 1.4.1 so I am wondering if you could also add version 1.4.2 to the releases section?

Best regards
",Drmirdeep,https://github.com/macs3-project/MACS/issues/389
MDU6SXNzdWU2MTUzMjIzMTM=,Q: Too few paired peaks (0) so I can not build the model! Broader you r MFOLD range parameter may erase this error.,CLOSED,2020-05-10T05:43:09Z,2020-05-13T05:17:46Z,2020-05-13T05:17:45Z,"Hi,

I get this error while peak calling when not using a control.I get peaks when i use control. Why is this ?

Command:
macs2 callpeak -t Treated_Q30Filtered.rmdup.bam -f BAM -g 4432532 -B -n Treated

Error:
""WARNING @ Sun, 10 May 2020 11:10:32: Too few paired peaks (0) so I can not build the model! Broader your MFOLD range parameter may erase this error. If it still can't build the model, we suggest to use --nomodel and --extsize 147 or other fixed number instead.
WARNING @ Sun, 10 May 2020 11:10:32: Process for pairing-model is terminated!""

Even if i change the parameters ( I have changed MFOLD, --nomodel ,  --extsize and q value),  the program runs but with no peaks.

Why is it so?

",Rya-Stark,https://github.com/macs3-project/MACS/issues/390
MDU6SXNzdWU2MTY1NTQwOTY=,"Q: What parameters would you recommend optimizing, and what could be the reason for some peaks not being called?",OPEN,2020-05-12T10:44:17Z,2021-03-21T08:07:01Z,,"Hi Taoliu,

I am using macs2 for CUT&RUN transcription factor peaks. My biologist colleagues pointed out some peaks that are not called, but are visible in the rpm-normalized bedgraph visualization, and I am trying to find an explanation, as well as find an optimal calling method. Some non-peaks may be called as well.

I used `--qvalue 0.05 --scale-to small --call-summits`.

As I understand the algorithm, a peak is not called if 1) the control has a lot of tags in the surrounding area (lambda 1k, 5k, 10k) or in total (lambda bg) 2) lack of bimodal character, so after shifting the Watson and Crick tags, they do not pile high at the binding site (in which case maybe it is not a real peak) 3) maybe there are duplicate tags in the peak, and it is shorter after removal of those.

I also computed the rpkm-ratio of the case vs control reads in each peak, and tried different cutoff values to filter a bit further.

Why do you think some peaks are not called? 
Which peak-calling parameters do you think I should adjust to find optimal values?
Do you think using a reasonable rpkm cutoff to filter out potential false positives is appropriate? 

Thank you for your kind answers in advance!

Best",eregenyi,https://github.com/macs3-project/MACS/issues/391
MDU6SXNzdWU2MTg1OTg4MjM=,"""ZeroDivisionError: float division"" from -f BAMPE option in callpeak",CLOSED,2020-05-14T23:37:59Z,2020-05-20T15:49:05Z,2020-05-18T22:33:14Z,"Hello! 

I am seeing the following error when I try to use MACS2 (2.2.7.1) to call peaks for PE data. 
```
# Command line: callpeak -t BWA_Output/Narrow/H3K27ac_Skin_A.duplicate-removed.bam -c BWA_Output/Duplicates/Input_Skin_A.duplicate-removed.bam -f BAMPE -n Peak_Calls/H3K27ac_Skin_A -g 2409143234
# ARGUMENTS LIST:
# name = Peak_Calls/H3K27ac_Skin_A
# format = BAMPE
# ChIP-seq file = ['BWA_Output/Narrow/H3K27ac_Skin_A.duplicate-removed.bam']
# control file = ['BWA_Output/Duplicates/Input_Skin_A.duplicate-removed.bam']
# effective genome size = 2.41e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is on
 
INFO  @ Thu, 14 May 2020 16:02:11: #1 read fragment files... 
INFO  @ Thu, 14 May 2020 16:02:11: #1 read treatment fragments... 
INFO  @ Thu, 14 May 2020 16:02:14: 0 fragments have been read. 
Traceback (most recent call last):
  File ""/share/apps/bio3user/miniconda3/envs/macs2/bin/macs2"", line 653, in <module>
    main()
  File ""/share/apps/bio3user/miniconda3/envs/macs2/bin/macs2"", line 51, in main
    run( args )
  File ""/share/apps/bio3user/miniconda3/envs/macs2/lib/python3.7/site-packages/MACS2/callpeak_cmd.py"", line 64, in run
    if options.PE_MODE: (treat, control) = load_frag_files_options (options)
  File ""/share/apps/bio3user/miniconda3/envs/macs2/lib/python3.7/site-packages/MACS2/callpeak_cmd.py"", line 350, in load_frag_files_options
    treat = tp.build_petrack()
  File ""MACS2/IO/Parser.pyx"", line 1267, in MACS2.IO.Parser.BAMPEParser.build_petrack
  File ""MACS2/IO/Parser.pyx"", line 1311, in MACS2.IO.Parser.BAMPEParser.build_petrack
ZeroDivisionError: float division
```

From some searching, I've noticed that a few other MACS2 commands gave a similar error (#383 and #386 ) due to a bug in the code. Is that possibly what is causing this error message too?

Here is the head of one of my bam files from my treatment group in case it provides any helpful information:

@HD	VN:1.5	SO:coordinate
@SQ	SN:chr1	LN:188260577
@SQ	SN:chr2	LN:121350024
@SQ	SN:chr3	LN:121351753
@SQ	SN:chr4	LN:109462549
@SQ	SN:chr5	LN:96759418
@SQ	SN:chr6	LN:87230776
@SQ	SN:chr7	LN:100787686
@SQ	SN:chr8	LN:97563019
@SQ	SN:chr9	LN:85793548
@SQ	SN:chr10	LN:85155674
@SQ	SN:chr11	LN:61676917
@SQ	SN:chr12	LN:36992759
@SQ	SN:chr13	LN:43784481
@SQ	SN:chr14	LN:94600235
@SQ	SN:chr15	LN:92851403
@SQ	SN:chr16	LN:88962352
@SQ	SN:chr17	LN:80722430
@SQ	SN:chr18	LN:82641348
@SQ	SN:chr19	LN:62681739
@SQ	SN:chr20	LN:65343332
@SQ	SN:chr21	LN:58984458
@SQ	SN:chr22	LN:50928189
@SQ	SN:chr23	LN:55556184
@SQ	SN:chr24	LN:48288683
@SQ	SN:chr25	LN:40282968
@SQ	SN:chr26	LN:43147642
@SQ	SN:chr27	LN:40254690
@SQ	SN:chr28	LN:47348498
@SQ	SN:chr29	LN:34776120
@SQ	SN:chr30	LN:31395959
@SQ	SN:chr31	LN:26001039
@SQ	SN:chrX	LN:128206784
@PG	ID:bwa	PN:bwa	VN:0.7.9a-r786	CL:bwa mem -M -t 3 /home/nbk/FAANG_Project/Genome/EquCab3.0_Genbank_Build.nowrap.fasta Trimmed_Reads/H3K27ac_Skin_A_R1_val_1.fq.gz Trimmed_Reads/H3K27ac_Skin_A_R2_val_2.fq.gz
@PG	ID:MarkDuplicates	VN:2.8.1	CL:picard.sam.markduplicates.MarkDuplicates INPUT=[Sort/H3K27ac_Skin_A.sorted.bam] OUTPUT=Duplicates/H3K27ac_Skin_A.duplicate-marked.bam METRICS_FILE=Duplicates/H3K27ac_Skin_A.dup_metrics REMOVE_DUPLICATES=false ASSUME_SORTED=true VALIDATION_STRINGENCY=LENIENT    MAX_SEQUENCES_FOR_DISK_READ_ENDS_MAP=50000 MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=8000 SORTING_COLLECTION_SIZE_RATIO=0.25 REMOVE_SEQUENCING_DUPLICATES=false TAGGING_POLICY=DontTag DUPLICATE_SCORING_STRATEGY=SUM_OF_BASE_QUALITIES PROGRAM_RECORD_ID=MarkDuplicates PROGRAM_GROUP_NAME=MarkDuplicates READ_NAME_REGEX=<optimized capture of last three ':' separated fields as numeric values> OPTICAL_DUPLICATE_PIXEL_DISTANCE=100 VERBOSITY=INFO QUIET=false COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json	PN:MarkDuplicates
A00902:80:HL7Y2DRXX:2:2147:17589:4930	161	chr1	677	60	49M	=	1254	626	ACCTAAGTATTTCAAGGTATTTTTGGTACTATTGAAAATCATATGCTTA	F:F,FFFFFFFFFF:FF:FFFF:,FFF,FFFFFFFFF:FFFF:FFFFFF	MD:Z:29G4G9T4	PG:Z:MarkDuplicates	NM:i:3	AS:i:34	XS:i:20
A00902:80:HL7Y2DRXX:2:2208:31412:24549	145	chr1	5276	60	2S47M	chr6	27664629	0	TTCATTTCTTAAAAGCAAAACATGCTGTCTTTCAATTCAGAAAGGCCGG	:FFFFFFFFFFF:FFFFF,FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	MD:Z:16C28A1	PG:Z:MarkDuplicates	NM:i:2	AS:i:40	XS:i:19
A00902:80:HL7Y2DRXX:2:2141:21206:6934	129	chr1	13335	60	47M	chr10	12337455	0	CAAGAGTGCAAGGAGCGAATTTCTTCCCTGAACTCCCAGATCGAGGA	FFFFFFFFFF,FFFFFFFFFFFFFFFFFFFFFFFFFFF:F,FFFFFF	MD:Z:47	PG:Z:MarkDuplicates	NM:i:0	AS:i:47	XS:i:20
A00902:80:HL7Y2DRXX:2:2150:12228:2848	65	chr1	18596	60	50M	chr22	49184915	0	CAGGAAAGACGATAGTGTAAGTTCCAGGCTGAGGGCAGGAGAGGACCCAT	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	MD:Z:50	PG:Z:MarkDuplicates	NM:i:0	AS:i:50	XS:i:20
A00902:80:HL7Y2DRXX:2:2208:6768:5134	97	chr1	18679	60	49M	chr30	26290956	0	GTCCTCTTCCTCAGCACTTCCGTTCTATTCAAATGTTCACTGATTGGAT	FFFFFFFFFFFFFFFFFFFFFFFFFF:FFFFF:FFFFFFFFFFFFFFFF	MD:Z:49	PG:Z:MarkDuplicates	NM:i:0	AS:i:49	XS:i:21
A00902:80:HL7Y2DRXX:2:2173:15031:34507	161	chr1	36613	60	50M	=	37231	668	TGACAGACATTGGGAAAAAGAAGTCAAAGCCTAGATGACTGTTGCAGCTG	FFFF,FFFFFFFFF,FF,:FFFFFFF:FF:FFFFFFFFFFFF,FFFFF:F	MD:Z:50	PG:Z:MarkDuplicates	NM:i:0	AS:i:50	XS:i:21
A00902:80:HL7Y2DRXX:2:2173:15031:34507	81	chr1	37231	60	50M	=	36613	-668	AGGGGTGGAGATGAACAAGATAGTGCCCATTACTTCTCACTCTGCCGTGC	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	MD:Z:50	PG:Z:MarkDuplicates	NM:i:0	AS:i:50	XS:i:19
A00902:80:HL7Y2DRXX:2:2258:5385:35368	161	chr1	46963	60	50M	chr10	17682362	0	CTTGCCTCCTAACCCTCACTTGACAACCACTGAAATTCTGGGTTGTTGTT	FFFFFFF:FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	MD:Z:50	PG:Z:MarkDuplicates	NM:i:0	AS:i:50	XS:i:19
A00902:80:HL7Y2DRXX:2:2261:11532:21120	145	chr1	47761	60	49M	=	79012	31204	GAGAGTTCAGAGTGCTGATGGTTTCTCATTGGCTGAGCTGCTGGGATAG	FFFFFFF,F:FF:FFFFF:FF,FFF:FF:FFF,FFF:FFF:F:FFFFFF	MD:Z:49	PG:Z:MarkDuplicates	NM:i:0	AS:i:49	XS:i:30
A00902:80:HL7Y2DRXX:2:2160:31367:22780	161	chr1	56106	60	50M	=	56643	587	ACCAGAAAGAGAGTCCTCACCTGAACCAAACTGGTCAGCGCCTTGATCTG	FFF:FFFF:,FFFFFFFFFFFFFFFFFFFFFFFFFF:FFFFFFFFFFFFF	MD:Z:50	PG:Z:MarkDuplicates	NM:i:0	AS:i:50	XS:i:19
A00902:80:HL7Y2DRXX:2:2160:31367:22780	81	chr1	56643	60	50M	=	56106	-587	CAAAGGACTCACTTCAGCTTTAAGGACACACCTATACAAACAGTCAAGGA	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	MD:Z:50	PG:Z:MarkDuplicates	NM:i:0	AS:i:50	XS:i:29
A00902:80:HL7Y2DRXX:2:2117:21658:9909	65	chr1	75812	35	50M	chr3	19954790	0	TTGTTTATGTCTATGTCCCTGAAGCTGAATTTCGCTCATTTCTACTTTCT	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	XA:Z:chr1,+43686,50M,2;	MD:Z:50	PG:Z:MarkDuplicates	NM:i:0	AS:i:50	XS:i:40
A00902:80:HL7Y2DRXX:2:2117:21468:10113	97	chr1	75812	35	50M	chr6	22223109	0	TTGTTTATGTCTATGTCCCTGAAGCTGAATTTCGCTCATTTCTACTTTCT	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF	XA:Z:chr1,+43686,50M,2;	MD:Z:50	PG:Z:MarkDuplicates	NM:i:0	AS:i:50	XS:i:40
A00902:80:HL7Y2DRXX:2:2261:22336:13369	161	chr1	77784	55	50M	=	78648	911	ACAACGGGTTTGAGAGAGCGCCGATAACAAAAGAATGAGTGAGAGCGATG	FF,F:FFF:,FF:,,F,FFFF,,,,:,F::,:FF,,:,F,F,FF:FF:,F	MD:Z:21A17G8A1	PG:Z:MarkDuplicates	NM:i:3	AS:i:38	XS:i:19
A00902:80:HL7Y2DRXX:2:2261:22336:13369	81	chr1	78648	60	47M	=	77784	-911	CCGAGGAGCAATCACTGACGCCACAGCCGAGCCGGCGCTTCACCAGC	F:FFFFFFFFF:F,F,FF,:FFFFFFFFFFFF:FF:F:F,FFFF,:F	MD:Z:18A28	PG:Z:MarkDuplicates	NM:i:1	AS:i:42	XS:i:0


Please let me know if you need any more information, and thank you for your time!",NBKingsley,https://github.com/macs3-project/MACS/issues/392
MDU6SXNzdWU2MjE2ODQxMDY=,Bug: IndexError: list index out of range ,CLOSED,2020-05-20T11:26:10Z,2020-05-20T16:00:16Z,2020-05-20T12:13:01Z,"I am encountering the error below. I have not seen this one before, just came up when I started running larger datasets. 

```
INFO  @ Tue, 19 May 2020 18:15:57:
# Command line: callpeak -f BAMPE --nomodel -g mm --keep-dup all --cutoff-analysis --tempdir 20200519T1202285_795-I_GT20_00733_TAAGGCGA-TCTCTCCG_cat/temp -n 795-I_GT20_00733_TAAGGCGA-TCTCTCCG_cat -t 795-I_GT20_00733_TAAGGCGA-TCTCTCCG_cat.sorted.rmDup.rmChrM.rmMulti.filtered.shifted.mm10.bam --outdir 20200519T1202285_795-I_GT20_00733_TAAGGCGA-TCTCTCCG_cat
# ARGUMENTS LIST:
# name = 795-I_GT20_00733_TAAGGCGA-TCTCTCCG_cat
# format = BAMPE
# ChIP-seq file = ['795-I_GT20_00733_TAAGGCGA-TCTCTCCG_cat.sorted.rmDup.rmChrM.rmMulti.filtered.shifted.mm10.bam']
# control file = None
# effective genome size = 1.87e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is on

INFO  @ Tue, 19 May 2020 18:15:57: #1 read fragment files...
INFO  @ Tue, 19 May 2020 18:15:57: #1 read treatment fragments...
INFO  @ Tue, 19 May 2020 18:16:01:  1000000
INFO  @ Tue, 19 May 2020 18:16:04:  2000000
INFO  @ Tue, 19 May 2020 18:16:07:  3000000
INFO  @ Tue, 19 May 2020 18:16:11:  4000000
INFO  @ Tue, 19 May 2020 18:16:14:  5000000
INFO  @ Tue, 19 May 2020 18:16:17:  6000000
INFO  @ Tue, 19 May 2020 18:16:21:  7000000
INFO  @ Tue, 19 May 2020 18:16:24:  8000000
INFO  @ Tue, 19 May 2020 18:16:28:  9000000
INFO  @ Tue, 19 May 2020 18:16:31:  10000000
INFO  @ Tue, 19 May 2020 18:16:34:  11000000
INFO  @ Tue, 19 May 2020 18:16:38:  12000000
INFO  @ Tue, 19 May 2020 18:16:41:  13000000
INFO  @ Tue, 19 May 2020 18:16:44:  14000000
INFO  @ Tue, 19 May 2020 18:16:47:  15000000
INFO  @ Tue, 19 May 2020 18:16:51:  16000000
INFO  @ Tue, 19 May 2020 18:16:54:  17000000
INFO  @ Tue, 19 May 2020 18:16:57:  18000000
INFO  @ Tue, 19 May 2020 18:17:00:  19000000
INFO  @ Tue, 19 May 2020 18:17:04:  20000000
INFO  @ Tue, 19 May 2020 18:17:07:  21000000
INFO  @ Tue, 19 May 2020 18:17:10:  22000000
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 653, in <module>
    main()
  File ""/usr/local/bin/macs2"", line 51, in main
    run( args )
  File ""/usr/local/lib/python3.8/site-packages/MACS2/callpeak_cmd.py"", line 64, in run
    if options.PE_MODE: (treat, control) = load_frag_files_options (options)
  File ""/usr/local/lib/python3.8/site-packages/MACS2/callpeak_cmd.py"", line 350, in load_frag_files_options
    treat = tp.build_petrack()
  File ""MACS2/IO/Parser.pyx"", line 1267, in MACS2.IO.Parser.BAMPEParser.build_petrack
  File ""MACS2/IO/Parser.pyx"", line 1300, in MACS2.IO.Parser.BAMPEParser.build_petrack
IndexError: list index out of range
```",MikeWLloyd,https://github.com/macs3-project/MACS/issues/393
MDU6SXNzdWU2MjIwMTM2ODY=,Advanced: Call peaks using MACS2 subcommands - How to obtain fold enrichment ,OPEN,2020-05-20T18:58:59Z,2020-05-28T19:46:25Z,,"I am following the steps in [https://github.com/taoliu/MACS/wiki/Advanced%3A-Call-peaks-using-MACS2-subcommands](https://github.com/taoliu/MACS/wiki/Advanced%3A-Call-peaks-using-MACS2-subcommands).

The final output will generate a file with peak location and p-values or q-values. 
Is there a way to get a file with peaks location, p-values/q-values and **fold-enrichment**?

Thank you! ",olechnwin,https://github.com/macs3-project/MACS/issues/394
MDU6SXNzdWU2MjQ2MzMxOTQ=,number of peaks when setting q-value and  p-value,OPEN,2020-05-26T06:31:40Z,2020-05-28T18:10:06Z,,"Hello, I'm Dahun.
In advance, I appreicate of using MACS.

I have a question for setting q-value and p-value.

when I call the peaks, I've known that I can set p or q value.
Because I'm curious for number of called peaks, I tried setting different p or q values.
But same results came out. When I set p-value as 0.01 and 0.1, number of peaks is same.
Of course, the result was different when setting p-value and q-value.
But difference for number of peaks are so huge. I mean... if q-value, peaks are 6681. But if p-value, peaks are 1079525.

Are there any  other options I should set?

Thank you.
Dahun",dahun73,https://github.com/macs3-project/MACS/issues/395
MDU6SXNzdWU2MjUxMDI2Njk=,Bug: error when running bdgopt in python3 but not in python2,CLOSED,2020-05-26T18:41:41Z,2020-05-26T18:56:39Z,2020-05-26T18:56:38Z,"Hi,
I got the following error when running `macs2 bdgopt` in macs2 version 2.2.6 but no error in macs2 version 2.1.4. which makes me think this is due to python2 versus python3.

```
macs2 bdgopt -i 250K_Rb_1k_bg.pileup.bdg -m multiply -p .2090 -o 250K_Rb_1k_bg_norm.bdg
INFO  @ Tue, 19 May 2020 15:25:33: Read and build bedGraph...
INFO  @ Tue, 19 May 2020 15:25:37: Modify bedGraph...
INFO  @ Tue, 19 May 2020 15:25:37: Write bedGraph of modified scores...
Traceback (most recent call last):
  File ""/opt/miniconda3/envs/macs2_env/bin/macs2"", line 652, in <module>
    main()
  File ""/opt/miniconda3/envs/macs2_env/bin/macs2"", line 73, in main
    run( args )
  File ""/opt/miniconda3/envs/macs2_env/lib/python3.7/site-packages/MACS2/bdgopt_cmd.py"", line 68, in run
    btrack.write_bedGraph(ofhd,name=""%s_modified_scores"" % (options.method.upper()),description=""Scores calculated by %s"" % (options.method.upper()))
  File ""MACS2/IO/BedGraph.pyx"", line 247, in MACS2.IO.BedGraph.bedGraphTrackI.write_bedGraph
TypeError: a bytes-like object is required, not 'str'
```
I'm attaching the input file to re-create the error. The input file was generated following the subcommands tutorial of macs2.

[250K_Rb_1k_bg.pileup.bdg.gz](https://github.com/taoliu/MACS/files/4684306/250K_Rb_1k_bg.pileup.bdg.gz)

Thank you!

",olechnwin,https://github.com/macs3-project/MACS/issues/396
MDU6SXNzdWU2MjYxNTI3MjQ=,Not able to capture large peak,CLOSED,2020-05-28T01:53:44Z,2020-05-29T18:24:06Z,2020-05-29T17:06:31Z,"Hi Dr. Liu and MACS team,

I recently run MACS2 on a *bam file and noticed some issues on my data. 

Firstly, it's a little noisy of my data, I'm not able to capture many peaks (only ~100 peaks) if I use IgG as controls. My first question is that is it possible to take scale factor or downsample for IgG in MACS2? Or do I need to downsampling before run MACS2 for peak calling? 

So I then tried to run macs2 without IgG controls, it woks fine to capture the peaks. 
However, somehow an obvious enriched peak which we thought to be important was not captured, as highlighted in red in attached screenshot (in a large scale and small scale). That peak possibly is wider (~2000bp) than others (~300bp). I've tried broad peak setting using --broad flag and tried different cutoffs from FDR=0.1 to FDR=0.01, but none of them are able to capture that large peak.  

I'm wondering what could be the possible reasons for it? Why does MACS2 capture the small peaks near it, but not that large peak? Is there any parameters that I could tune to capture the peak? 

I appreciate your suggestions!

Thank you,
Helen

<img width=""1636"" alt=""Screen Shot 2020-05-27 at 5 27 47 PM"" src=""https://user-images.githubusercontent.com/43098514/83089184-b0677c80-a063-11ea-9ab0-60c1daca2c2c.png"">
<img width=""1635"" alt=""Screen Shot 2020-05-27 at 9 36 37 PM"" src=""https://user-images.githubusercontent.com/43098514/83089187-b2314000-a063-11ea-89d6-91faf6aaff83.png"">
",helenhuangmath,https://github.com/macs3-project/MACS/issues/397
MDU6SXNzdWU2MjY4MDYwMTQ=,Q: filterdup result for BAMPE,OPEN,2020-05-28T20:50:45Z,2020-06-03T17:19:26Z,,"Hi,

I'm confused with `macs filterdup` result for paired-end bam files.
Here are my commands and output:
```
samtools view -S -b iEF.sam.ecoli | samtools sort - -o iEF.ecoli.sorted.bam

macs2 filterdup -g 4.7e+6 -f BAMPE -i iEF.ecoli.sorted.bam --keep-dup=1 -o iEF.ecoli_filterdup.bed
INFO  @ Wed, 27 May 2020 19:47:21: # read input file in Paired-end mode. 
INFO  @ Wed, 27 May 2020 19:47:21: # read treatment fragments... 
INFO  @ Wed, 27 May 2020 19:47:31:  1000000 
INFO  @ Wed, 27 May 2020 19:47:35: # total fragments/pairs in alignment file: 1393787 
INFO  @ Wed, 27 May 2020 19:47:35: user defined the maximum tags... 
INFO  @ Wed, 27 May 2020 19:47:35: filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Wed, 27 May 2020 19:47:37:  tags after filtering in alignment file: 107233 
INFO  @ Wed, 27 May 2020 19:47:37:  Redundant rate of alignment file: 0.92 
INFO  @ Wed, 27 May 2020 19:47:37: Write to BED file 
INFO  @ Wed, 27 May 2020 19:47:37: finished! Check iEF.ecoli_filterdup.bed.
```
and these are the output from bowtie for the same file:
```
bowtie2 --very-sensitive --no-unal --no-mixed --no-discordant --dovetail --phred33 -q -I 10 -X 700 --threads 16 -x /Bowtie2Index/genome -1 iEF_S2_L007_R1_001_val_1.fq -2 iEF_S2_L007_R2_001_val_2.fq >> iEF.sam.ecoli
44335335 reads; of these:
  44335335 (100.00%) were paired; of these:
    42941548 (96.86%) aligned concordantly 0 times
    1321521 (2.98%) aligned concordantly exactly 1 time
    72266 (0.16%) aligned concordantly >1 times
3.14% overall alignment rate
```
The ""# total fragments/pairs in alignment file: 1393787"" matches with output of bowtie (aligned concordantly exactly 1 time + aligned concordantly > 1 times). But, I'm confused with the ""tags after filtering in alignment file: 107233"". I was expecting this to be 1321521 (i.e. the number of aligned concordantly exactly 1 time)?

Thanks in advance for your help.",olechnwin,https://github.com/macs3-project/MACS/issues/398
MDU6SXNzdWU2Mjg1NjkzMDA=,Feat: Quick peak calling,OPEN,2020-06-01T16:26:17Z,2020-06-01T16:26:17Z,,"A subcommand to do quick peak calling. It will skip the duplicates filtering and p-value/q-value calculation. It will only do the pileup from alignment files and find the genomic regions of enrichment above a given pileup cutoff. This function was proposed to pre-scan genomics data to find regions for downstream analysis such as clustering cells or samples when the precision of peak locations is not a high priority.

**Is your feature request related to a problem? Please describe.**
NA

**Describe the solution you'd like**
Pileup then peak call = `pileup` + `callpeak` subcommands

**Describe alternatives you've considered**
NA

**Additional context**
We need to think about how to define a 'good' cutoff.
",taoliu,https://github.com/macs3-project/MACS/issues/399
MDU6SXNzdWU2MzAxNzc2ODc=,Feat: Fast hash,CLOSED,2020-06-03T17:19:08Z,2020-12-09T05:07:47Z,2020-12-09T05:07:47Z,"**Is your feature request related to a problem? Please describe.**
NA

**Describe the solution you'd like**
Plan to switch back to khash or use the python wrapper for kash ""https://github.com/realead/cykhash"" for faster and more efficient hash implementation. Hash/python dictionary is used for p/q-value calculation.

**Describe alternatives you've considered**
NA

**Additional context**
NA
",taoliu,https://github.com/macs3-project/MACS/issues/400
MDU6SXNzdWU2MzY1NzEwNTE=,Q: Why is the default value of max-gap the detected read length?,CLOSED,2020-06-10T21:48:14Z,2023-03-09T19:55:14Z,2023-03-09T19:55:14Z,"Hi,

I would like to use MACS2 for ATAC-seq. Could you please explain the reasoning behind the default value for max-gap being the detected read length (= tag size). Since tags are extended anyway, why use their original length for this?",angelosarmen,https://github.com/macs3-project/MACS/issues/401
MDU6SXNzdWU2MzY5NTAyNzY=,Q: The number of reported differential peaks is much lower than the number of originally called peaks: Why?,OPEN,2020-06-11T11:49:12Z,2020-06-26T21:38:46Z,,"Hi Taoliu,

I am comparing two transcription factor's peaks. I analyzed unique peaks, meaning peaks that had no overlap (0 overlapping bases) between the two TFs. I was also interested in differentially enriched peaks, so I followed the differential binding event wiki article (https://github.com/macs3-project/MACS/wiki/Call-differential-binding-events).

However, inspecting the results, I found that much less of the peaks are reported in the differential analysis compared to the originally called peaks. Looking at the diff_.....bed peaks in IGV, some very obvious peaks at known target promoters are missed (they appear neither among the common, nor the unique peaks).

Number of lines in TF1- and TF2_peaks.xls: ~90 000 and ~130 000
Number of lines in diff_common: 31 360
diff_TF1: 1 172
diff_TF2: 329

I kept the 'd' parameter constant.

Why is this? 
Could I tweak the parameters to include more peaks?
Can I somehow use these peaks? I have strong strong feelings against using them after seeing that some obvious peaks are not reported in _common.bed. 

Thank you for your help in advance",eregenyi,https://github.com/macs3-project/MACS/issues/402
MDU6SXNzdWU2NDQxOTExOTA=,MACS2 vs MACS3,CLOSED,2020-06-23T22:34:34Z,2020-06-26T20:39:57Z,2020-06-26T20:14:31Z,"What exactly is the difference between MACS2 and this MACS3 project? 

What specifically is trying to be aimed by MACS3? 

Could not find a clear explanation of this searching through the ""Issues"". ",YogiOnBioinformatics,https://github.com/macs3-project/MACS/issues/403
MDU6SXNzdWU2NDg1OTc5MzE=,Bug: OverflowError: value too large to convert to int,CLOSED,2020-07-01T01:10:45Z,2020-07-01T02:07:59Z,2020-07-01T02:07:59Z,"I know this the old issue. But I still cannot find the solution.

I installed macs2 through conda (conda install -c bioconda macs2). The 64bit environment was created. The version macs2 2.2.7.1 was installed.

""macs2 callpeak"" was run on maize data, which has ~2.3 Gb genome.

Here is the error I received:

Traceback (most recent call last):
  File "".conda/envs/macs2/bin/macs2"", line 653, in <module>
    main()
  File "".conda/envs/macs2/bin/macs2"", line 51, in main
    run( args )
  File ""conda/envs/macs2/lib/python3.7/site-packages/MACS2/callpeak_cmd.py"", line 170, in run
    opt = options
  File ""MACS2/PeakModel.pyx"", line 105, in MACS2.PeakModel.PeakModel.__init__
  File ""MACS2/PeakModel.pyx"", line 120, in MACS2.PeakModel.PeakModel.build
OverflowError: value too large to convert to int

Appreciated your comments. Thanks.",liu3zhenlab,https://github.com/macs3-project/MACS/issues/404
MDU6SXNzdWU2NDkyODY0NDY=,Feat: Remove secure strings from travis.yml,OPEN,2020-07-01T20:07:26Z,2020-07-01T20:07:26Z,,"Remove the 'secure' string for pypi username and password from travis file. Instead, save them in travis-ci.com as ""Environment Variables"".",taoliu,https://github.com/macs3-project/MACS/issues/405
MDU6SXNzdWU2NTI5ODgxOTI=,Q: Filter Pvalue for narrowPeak files is reasonable?,OPEN,2020-07-08T05:50:22Z,2020-07-15T19:21:03Z,,"hello tao,I'm here to disturb you again,I am using macs2 call my chip seq TF data.Now I have some confused about the peaks .I got the peaks bed file,I loaded the file and corresponding bw files(using deeptools produce the bw files from bam files )   in IGV,I found that some peaks that their Pvalue(-log10 Pvalue) is little ,like 9.7 were false peaks,but the peaks pvalue is very large like  54 is very true .Now my question is that I filter the Pvalue (by threshold value like 20 or 30 ) is  reasonable?Thank you 

",yirenheihei,https://github.com/macs3-project/MACS/issues/406
MDU6SXNzdWU2NTM2MzQ0OTI=,AssertionError: slocal can't be smaller than d,OPEN,2020-07-08T22:24:31Z,2020-07-15T19:50:47Z,,"Hi,
this question has been asked previously but I have not managed to find a satisfactory solution

I have a CHIPseq dataset sequenced with paired end reads.
I aligned the reads with bowtie2 for Input and Treatment and got an average insert size of ~250 for all samples, according to picard collectinsertsize metrics.
using plotFingerprint from deeptools indicates that the enrichment of these samples is sufficiently good.
When using macs2 on this data using as input format BAMPE, it detects fragment size that is longer than 3kb and exits with error.


Note that using  macs v2.2.7.1 predicts different fragment size length than macs v2.1.0
i.e.
v2.2.7.1
```
INFO  @ Wed, 08 Jul 2020 21:41:51: 30906652 fragments have been read. 
INFO  @ Wed, 08 Jul 2020 21:42:15: #1 mean fragment size is determined as 3943.0 bp from treatment 
INFO  @ Wed, 08 Jul 2020 21:42:15: #1 note: mean fragment size in control is 5923.6 bp -- value ignored 
INFO  @ Wed, 08 Jul 2020 21:42:15: #1 fragment size = 3943.0 
INFO  @ Wed, 08 Jul 2020 21:42:15: #1  total fragments in treatment: 25461742 
INFO  @ Wed, 08 Jul 2020 21:42:15: #1 user defined the maximum fragments... 
INFO  @ Wed, 08 Jul 2020 21:42:15: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 08 Jul 2020 21:43:32: #1  fragments after filtering in treatment: 25444635 
INFO  @ Wed, 08 Jul 2020 21:43:32: #1  Redundant rate of treatment: 0.00 
INFO  @ Wed, 08 Jul 2020 21:43:32: #1  total fragments in control: 30906652 
INFO  @ Wed, 08 Jul 2020 21:43:32: #1 user defined the maximum fragments... 
INFO  @ Wed, 08 Jul 2020 21:43:32: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 08 Jul 2020 21:45:06: #1 finished! 
after filtering in control: 30890631 
INFO  @ Wed, 08 Jul 2020 21:45:06: #1  Redundant rate of control: 0.00 
INFO  @ Wed, 08 Jul 2020 21:45:06: #1 finished! 
INFO  @ Wed, 08 Jul 2020 21:45:06: #2 Build Peak Model... 
INFO  @ Wed, 08 Jul 2020 21:45:06: #2 Skipped... 
INFO  @ Wed, 08 Jul 2020 21:45:06: #3 Call peaks... 
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.2.7.1', 'macs2')
  File ""/usr/local/lib/python3.8/site-packages/pkg_resources/__init__.py"", line 667, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/usr/local/lib/python3.8/site-packages/pkg_resources/__init__.py"", line 1464, in run_script
    exec(code, namespace, namespace)
  File ""/usr/local/lib/python3.8/site-packages/MACS2-2.2.7.1-py3.8-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 653, in <module>
    main()
  File ""/usr/local/lib/python3.8/site-packages/MACS2-2.2.7.1-py3.8-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 51, in main
    run( args )
  File ""/usr/local/lib/python3.8/site-packages/MACS2-2.2.7.1-py3.8-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 256, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 107, in MACS2.PeakDetect.PeakDetect.call_peaks
  File ""MACS2/PeakDetect.pyx"", line 179, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control
AssertionError: 1000 can't be smaller than 3943.0146484375!

```
while 2.1.0

```
INFO  @ Wed, 08 Jul 2020 17:27:44: #1 mean fragment size is determined as 2165 bp from treatment 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1 note: mean fragment size in control is 2916 bp -- value ignored 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1  total fragments in trINFO  @ Wed, 08 Jul 2020 17:27:44: #1  total fragments in treatment: 25461742 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1 user defined the maximum fragments... 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1  fragments after filtering in treatment: 25447791 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1  Redundant rate of treatment: 0.00 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1  total fragments in control: 30906652 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1 user defined the maximum fragments... 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 08 Jul 2020 17:27:44: #2 Use 2165 as fragment length 
INFO  @ Wed, 08 Jul 2020 17:27:44: #3 Call peaks... 
: #1  Redundant rate of control: 0.00 
INFO  @ Wed, 08 Jul 2020 17:27:44: #1 finished! 
INFO  @ Wed, 08 Jul 2020 17:27:44: #2 Build Peak Model... 
INFO  @ Wed, 08 Jul 2020 17:27:44: #2 Skipped... 
INFO  @ Wed, 08 Jul 2020 17:27:44: #2 Use 2165 as fragment length 
INFO  @ Wed, 08 Jul 2020 17:27:44: #3 Call peaks... 
Traceback (most recent call last):
  File ""/usr/local/bin/macs2"", line 559, in <module>
    run( args )
  File ""/usr/local/lib/python2.7/dist-packa    run( args )
  File ""/usr/local/lib/python2.7/dist-packages/MACS2/callpeak.py"", line 261, in run
    peakdetect.call_peaks()
  File ""cPeakDetect.pyx"", line 105, in MACS2.cPeakDetect.PeakDetect.call_peaks (MACS2/cPeakDetect.c:1696)
  File ""cPeakDetect.pyx"", line 177, in MACS2.cPeakDetect.PeakDetect.__call_peaks_w_control (MACS2/cPeakDetect.c:2208)
AssertionError: slocal can't be smaller than d!

```


The command line used was

```
 macs2 callpeak --name AB157_INPUT0p3nM_AB155_H3K27me3 --SPMR --bdg --bw 200 --call-summits -f BAMPE -g hs --keep-dup 1 --mfold 5 80 --nomodel -q 0.05 --control /chip_seq_qc/samtools_index/AB157_INPUT0p3nM_mulmaprem.mdup_blkrem.bam --treatment /chip_seq_qc/samtools_index/AB155_H3K27me3_mulmaprem.mdup_blkrem.bam
```

For now, to avoid this error I have ended up specifying the format as BAM, i.e. ignoring the paired read.

How is the insert size calculated in BAMPE data and why is there such difference between macs2 and picard estimates? 
is there any suggestion how to bypass the problem by using the PE data, I could set slocal to a large value, or 0 but that would decrease the quality of the result, correct?

Thanks in advance for your help
",kmavrommatis,https://github.com/macs3-project/MACS/issues/407
MDU6SXNzdWU2NTM4MzUzODQ=,Q: Can peak num be affected by changing chromosome notation?,OPEN,2020-07-09T07:35:39Z,2020-07-15T19:20:33Z,,"**Use case**
Recently, I found a triky phenomenon when using MCAS2 to obtain peak from ChIPseq data.

**Describe the problem**
I compared the peak numbers before and after changing chromosome notation in bam files including treatment and control. I use the genome sequence file (primary assembly version, that is used in mapping step) and GTF file downloaded from ENSEMBL. But some tools only recognize the chromosome name with 'chr'. Hence I converted the chromosome name used in ENSEMBL into ones in UCSC version by 'reheader' function in samtools according to the annotation file downloaded from '[dpryan79/ChromosomeMappings](https://github.com/dpryan79/ChromosomeMappings)' in github. In the end, the conversion of chromosome name will lose almost 50% of peak number, although I didn't change the parameters used in peakcalling step.

**Describe the solution you tried**
I checked the read number before and after the conversion of chromosome name by 'idxstats' function in samtools. The number of mapped reads stored in these bam file was same. Have you encountered a similar situation? Or do you have any idea about this wierd situation?
",AIBio,https://github.com/macs3-project/MACS/issues/408
MDU6SXNzdWU2NTM4ODQ0NTc=,Q: -log10(qvalue) are 0 in output files ,OPEN,2020-07-09T08:49:10Z,2020-07-15T19:17:18Z,,"Dear Dr. Liu,

I am trying to use MACS2 on human double-strand breaks files.

When I set the cutoff pvalue to 0.05 (in test14), I could get a lot of peaks, but the -log10(qvalue) column in the output files are almost all 0. Here is part of test14_peak.xls:
```
# This file is   generated by MACS version 2.2.7.1
# Command line: callpeak -t  bowtie-output.bam -c bowtie-outputc.bam -f BAM -g hs -p 0.05 -B -n test14  --outdir test1/test14
# ARGUMENTS LIST:
# name = test14
# format = BAM
# ChIP-seq file = ['bowtie-output.bam']
# control file = ['bowtie-outputc.bam']
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# pvalue cutoff = 5.00e-02
# qvalue will not be calculated and   reported as -1 in the final output.
# The maximum gap between significant   sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned   as the predicted fragment length ""d"".
# Larger dataset will be scaled towards   smaller dataset.
# Range for calculating regional lambda   is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
# tag size is determined as 38 bps
# total tags in treatment: 5709090
# tags after filtering in treatment:   5050586
# maximum duplicate tags at the same   position in treatment = 1
# Redundant rate in treatment: 0.12
# total tags in control: 1643714
# tags after filtering in control:   1403958
# maximum duplicate tags at the same   position in control = 1
# Redundant rate in control: 0.15
# d = 298
chr | start | end | length | abs_summit | pileup | -log10(pvalue) | fold_enrichment | -log10(qvalue) | name
chr12 | 1.1E+08 | 1.1E+08 | 298 | 1.1E+08 | 1.67 | 1.96519 | 2.30994 | 0 | test14_peak_1139
chr12 | 1.11E+08 | 1.11E+08 | 298 | 1.11E+08 | 1.95 | 1.96519 | 2.55062 | 0 | test14_peak_1140
chr12 | 1.14E+08 | 1.14E+08 | 298 | 1.14E+08 | 1.39 | 1.96519 | 2.06925 | 0 | test14_peak_1141
chr12 | 1.19E+08 | 1.19E+08 | 298 | 1.19E+08 | 1.67 | 1.96519 | 2.30994 | 0 | test14_peak_1142
chr12 | 1.25E+08 | 1.25E+08 | 298 | 1.25E+08 | 1.95 | 1.96519 | 2.55062 | 0 | test14_peak_1143
chr12 | 1.3E+08 | 1.3E+08 | 305 | 1.3E+08 | 1.67 | 1.52089 | 2.10367 | 0 | test14_peak_1144
chr12 | 1.32E+08 | 1.32E+08 | 298 | 1.32E+08 | 1.67 | 1.43779 | 2.05537 | 0 | test14_peak_1145
chr12 | 1.33E+08 | 1.33E+08 | 341 | 1.33E+08 | 1.67 | 1.96519 | 2.30994 | 0 | test14_peak_1146
chr12 | 1.34E+08 | 1.34E+08 | 451 | 1.34E+08 | 48.37 | 40.6812 | 12.3421 | 32.5313 | test14_peak_1147
chr13 | 30027344 | 30027647 | 304 | 30027572 | 1.95 | 1.96519 | 2.55062 | 0 | test14_peak_1148
chr13 | 32683817 | 32684214 | 398 | 32683944 | 1.67 | 1.96519 | 2.30994 | 0 | test14_peak_1149
chr13 | 36372288 | 36372585 | 298 | 36372386 | 1.11 | 1.96519 | 1.82857 | 0 | test14_peak_1150
chr13 | 49105674 | 49105971 | 298 | 49105736 | 1.67 | 1.96519 | 2.30994 | 0 | test14_peak_1151
chr13 | 59508035 | 59508376 | 342 | 59508164 | 1.67 | 1.96519 | 2.30994 | 0 | test14_peak_1152
chr13 | 59936998 | 59937295 | 298 | 59937179 | 1.95 | 1.96519 | 2.55062 | 0 | test14_peak_1153
chr13 | 60828276 | 60828711 | 436 | 60828432 | 2.22 | 3.25781 | 2.79131 | 0 | test14_peak_1154
chr13 | 60839184 | 60839481 | 298 | 60839343 | 1.67 | 1.96519 | 2.30994 | 0 | test14_peak_1155
chr13 | 61727987 | 61728284 | 298 | 61728133 | 1.95 | 1.96519 | 2.55062 | 0 | test14_peak_1156
chr13 | 62251916 | 62252213 | 298 | 62252062 | 1.39 | 1.43779 | 1.84121 | 0 | test14_peak_1157
chr13 | 62868519 | 62868816 | 298 | 62868671 | 1.95 | 1.96519 | 2.55062 | 0 | test14_peak_1158
chr13 | 64825181 | 64825478 | 298 | 64825418 | 1.67 | 1.96519 | 2.30994 | 0 | test14_peak_1159
chr13 | 65697225 | 65697589 | 365 | 65697366 | 2.5 | 3.25781 | 3.03199 | 0 | test14_peak_1160
```
When I set the cutoff qvalue to 0.05 (in test15), I was only able to get one peak. Here is test15_peak.xls:
```
# This file is   generated by MACS version 2.2.7.1
# Command line: callpeak -t   bowtie-output.bam -c bowtie-outputc.bam -f BAM -g hs -q 0.05 -B -n test15   --outdir test1/test15
# ARGUMENTS LIST:
# name = test15
# format = BAM
# ChIP-seq file = ['bowtie-output.bam']
# control file = ['bowtie-outputc.bam']
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant   sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned   as the predicted fragment length ""d"".
# Larger dataset will be scaled towards   smaller dataset.
# Range for calculating regional lambda   is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
# tag size is determined as 38 bps
# total tags in treatment: 5709090
# tags after filtering in treatment:   5050586
# maximum duplicate tags at the same   position in treatment = 1
# Redundant rate in treatment: 0.12
# total tags in control: 1643714
# tags after filtering in control:   1403958
# maximum duplicate tags at the same   position in control = 1
# Redundant rate in control: 0.15
# d = 298
# alternative fragment length(s) may be   83,258,298 bps
chr | start | end | length | abs_summit | pileup | -log10(pvalue) | fold_enrichment | -log10(qvalue) | name
chr12 | 1.34E+08 | 1.34E+08 | 382 | 1.34E+08 | 48.37 | 40.6812 | 12.3421 | 32.5313 | test15_peak_1
```
It seems that it's not calculating the qvalues correctly because the qvalue cutoff is not really working. Could you take a look and point out what have I done wrong?

Thank you!

**System:**
 - OS: Wondows subsystem for Linux, Ubuntu
 - Python version 3.8.2
 - Numpy version 1.18.4
 - MACS Version 2.2.7.1",MalindaH,https://github.com/macs3-project/MACS/issues/409
MDU6SXNzdWU2ODc1NzYwODg=,Q: scale-to and downsample options with only treatment files?,OPEN,2020-08-27T22:12:55Z,2020-08-27T22:12:55Z,,"I am trying to generate a set of consensus peaks from a number of ATAC-Seq samples. A number of papers pool all of the samples and call peaks on the pool. It looks like I can just input all of the samples at once in MACS2 using `-t sample1 sample2 sample3...`. However, I want to make sure that all of the samples equally contribute to peak calling and some samples don't dominate others just because they have more reads. 

I was unclear if the `--scale-to` or `--down-sample` commands will scale all of the samples equally within treatment or if they only scale treatment vs. control? 

Thank you",jfreimer,https://github.com/macs3-project/MACS/issues/410
MDU6SXNzdWU2OTIyMTUwMTc=,Q: Why cannot you not set --extsize to 0?,OPEN,2020-09-03T19:02:22Z,2020-09-30T20:14:50Z,,"I am running MACS2 and I wanted to see which regions were called without extended the reads towards the 3' end. Therefore, I set --nomodel and --extsize 0 (since by default --extsize is 200). I get the following error:

ERROR:root:--extsize must >= 1!

I understand that based on the ChIP-seq model, I should want to extend the reads, but is there away to avoid this step?

Thank you so much for your time.
Sincerely,
Sammy",sklasfeld,https://github.com/macs3-project/MACS/issues/411
MDU6SXNzdWU3MDMyOTczMTY=,Q: atac-seq nolambda?,OPEN,2020-09-17T06:07:01Z,2021-03-29T15:46:35Z,,"Hi,

I have seen most papers doing ATAC-Seq analysis run macs2 with the --nolambda option, including the hmmratac paper. Naively, it seems like this would overcall peaks/peak summits in generally open regions. Can you please explain why macs2 should be run with --nolambda for ATAC-Seq data?

Thanks",jfreimer,https://github.com/macs3-project/MACS/issues/412
MDU6SXNzdWU3MDQxNjQ4NjE=,Q: macs2: error: unrecognized arguments: 2,OPEN,2020-09-18T07:41:52Z,2020-09-30T20:16:17Z,,"Hi, when I try to call peaks for two groups with replicates, I got an error ""macs2: error: unrecognized arguments: 2"".  I've sucessfully run ""macs2 callpeak..."" for two groups without replicate, but now I'm confused about this error. Could anyone please help me with this? Thanks a lot! 

code:
bam_dir=/home/zhuofeng/star/second_mapping
macs2 callpeak -t $bam_dir/PCA1_IP_2nd_Aligned.sortedByCoord.out.bam $bam_dir/PCA2_IP_2nd_Aligned.sortedByCoord.out.bam $bam_dir/PCA3_IP_2nd_Aligned.sortedByCoord.out.bam $bam_dir/PCA4_IP_2nd_Aligned.sortedByCoord.out.bam -c $bam_dir/PCA1_input_2nd_Aligned.sortedByCoord.out.bam $bam_dir/PCA2_input_2nd_Aligned.sortedByCoord.out.bam $bam_dir/PCA3_input_2nd_Aligned.sortedByCoord.out.bam $bam_dir/PCA4_input_2nd_Aligned.sortedByCoord.out.bam -g hs -n PCa_ip_vs_input -B 2 > PCa_ip_vs_input_macs2.log
",zoucheng123,https://github.com/macs3-project/MACS/issues/413
MDU6SXNzdWU3MDYxNDMzMjM=,Q: question about peak name,OPEN,2020-09-22T07:26:48Z,2020-09-30T20:24:16Z,,"**Use case**
I tried to analyze ATAC-seq data with MACS2 as following:
macs2 callpeak -t input.bed -f BED -n sampleName -g mm -p 0.1 --nomodel --shift 100 --extsize 200 -B --SPMR --call-summits --outdir /output
**Describe the problem**
I am confused with the peak names in the output files:
1	3495637	3496463	sampleName_peak_3a	28	.	2.20978	2.89339	1.32929	117
1	3495637	3496463	sampleName_peak_3b	48	.	2.84115	4.89429	3.20113	456
There are two peaks for sampleName_peak_3, sampleName_peak_3a	and sampleName_peak_3b, which one I should use in following steps?

Thanks
**Describe the solution you tried**
A clear and concise description of any solutions you've tried.

**Additional context**
Add any other context or screenshots about your use case here.
",bioysu,https://github.com/macs3-project/MACS/issues/414
MDU6SXNzdWU3MDc0NzMzNTU=,Issue: different versions gives different results,OPEN,2020-09-23T15:36:42Z,2020-10-08T22:06:20Z,,"**Use case**
I had 20 different bam files from different publications (so some have different read-sizes) and I ran MACS2 with them. For the code below I will just refer to the file names for all 20 as 'X'. 

I first ran MACS version 2.1.1.20160309 with the following command:
`macs2 callpeak -t X -f BAM --keep-dup auto --nomodel -g 101274395 --broad --outdir outdir -n pooled_treatments`

I then ran MACS2 version 2.2.7.1 with the following command:
` macs2 callpeak -t X -f BAM --keep-dup auto --nomodel -g 101274395 --broad --outdir outdir -n pooled_treatments2`

I get drastically different results. The results in the new version are less broad.

**Describe the problem**
Different versions of MACS2 give wildly different results

**Describe the solution you tried**
I haven't found a way to get the new code to run like the old code. Ive tried extending the maxGap length, the minLength, I tried not using the broad parameter. None of these methods seem to give the results from the previous version.

**Additional context**
Not that I can think of.",sklasfeld,https://github.com/macs3-project/MACS/issues/415
MDU6SXNzdWU3MTUxNTA1NjM=,Q: single end ATAC peak calling ,OPEN,2020-10-05T20:46:29Z,2020-10-09T08:54:05Z,,"Hi, I do know that this is far from ideal, but what's your opinion about the recommended parameters for single-end ATAC seq?

Thank you so much for your help!
",shokohirosue,https://github.com/macs3-project/MACS/issues/416
MDU6SXNzdWU3MTUyMzkzMjY=,Q: Why don't model.r files work?,CLOSED,2020-10-06T00:00:05Z,2020-10-08T19:37:52Z,2020-10-08T19:37:51Z,"**RESOLVED!!!**

**Sorry, after re-reading various docs, I see my mistake. I needed to run `Rscript model.r` at the CLI. I'll leave this here for future reference.**

----

Thank you for reading and feedback!

**Use case**
MACS2 works fine but I've never been able to get the generated `model.r` files to run.

**Describe the problem**
The MACS2-generated R file contains several vectors:

```
p <- c(0.036822804229564896,0.042945149993034726,0.04844638821528297, ...)
m <- c(0.04235406205004406,0.0489205832981129,0.055904974080149765, ...)
etc...
```
Upon executing loading of vector `p`, the console awaits more content (it shows the `+` sign and not the `>` sign). If I provide the console an additional `)`, it appears to finish loading the vector, HOWEVER it shows a length of 264 vector elements, far short of what's trying to load.. This is in R 3.6.3.

**Describe the solution you tried**
I was running an older version of MACS2 and upgraded to 2.2.7.1 (via bioconda) and the issue remains. I also looked through the `p` vector and nothing jumped out at me as being wrong within it. I'm thinking it's something silly on my part but have run out of ideas. 

**Additional context**
I have provided the entire R file at https://pastebin.com/aCtwGWPM. 
",jpcartailler,https://github.com/macs3-project/MACS/issues/417
MDU6SXNzdWU3MTU4NzAyMTQ=,"Q: Different read lengths for input and IP sample, would it affect accuracy of peak calls?",OPEN,2020-10-06T17:14:32Z,2021-06-22T08:54:45Z,,"For a recent ChIP-seq experiment we sequenced the input sample and IP sample with different read lengths (IP was 125 paired-end, INPUT was 50 single-end). When calling peaks using mostly default options, peaks were called successfully but MACS2 printed a warning indicating that ""since the calculated d (53) from paired-peaks are smaller than 2*tag length, etc."". It gave alternate 'd' to use that was longer (though still shorter than 2*tag length depending on what tag length is used. 

My first thought is that this would just affect the distance that nearby peaks are merged together and not necessarily the calls themselves, but any informed thoughts on whether this difference in length off reads will have a discernible effect on peak calls would be appreciated.",BuddahKat,https://github.com/macs3-project/MACS/issues/418
MDU6SXNzdWU3MzM5NDQwNzE=,Bug: setup.py should not call pip,CLOSED,2020-11-01T11:31:17Z,2020-12-09T08:14:18Z,2020-12-09T08:14:18Z,https://github.com/macs3-project/MACS/blob/2db0f0f14698579746b688c134aa237ffb2ff77c/setup.py#L30,greyltc,https://github.com/macs3-project/MACS/issues/419
MDU6SXNzdWU3MzY1OTAzNDM=,Bug: Install Error using pip3 install,OPEN,2020-11-05T03:58:16Z,2020-11-24T23:39:17Z,,"**Describe the bug**
A error happened when using pip3 install on my ubuntu20.04 with gcc9.3.0

**To Reproduce**
pip3 install --user macs2

**Expected behavior**
Looking in indexes: https://pypi.mirrors.ustc.edu.cn/simple/, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting macs2
  Downloading https://mirrors.tuna.tsinghua.edu.cn/pypi/web/packages/e2/61/85d30ecdd34525113e28cb0c5a9f393f93578165f8d848be5925c0208dfb/MACS2-2.2.7.1.tar.gz (2.1 MB)
     |████████████████████████████████| 2.1 MB 713 kB/s 
  ERROR: Error expected str, bytes or os.PathLike object, not NoneType while executing command /usr/bin/python3 /usr/lib/python3/dist-packages/pip install --ignore-installed --no-user --prefix /var/tmp/pip-build-env-zlje73qm/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i https://pypi.mirrors.ustc.edu.cn/simple/ --extra-index-url https://pypi.tuna.tsinghua.edu.cn/simple --trusted-host pypi.mirrors.ustc --trusted-host '' --trusted-host pypi.tuna.tsinghua -- pip 'setuptools>=41.2' 'numpy>=1.17' 'cython>=0.29' wheel
  Installing build dependencies ... error
ERROR: Exception:
Traceback (most recent call last):
  File ""/usr/lib/python3/dist-packages/pip/_internal/cli/base_command.py"", line 186, in _main
    status = self.run(options, args)
  File ""/usr/lib/python3/dist-packages/pip/_internal/commands/install.py"", line 357, in run
    resolver.resolve(requirement_set)
  File ""/usr/lib/python3/dist-packages/pip/_internal/legacy_resolve.py"", line 177, in resolve
    discovered_reqs.extend(self._resolve_one(requirement_set, req))
  File ""/usr/lib/python3/dist-packages/pip/_internal/legacy_resolve.py"", line 333, in _resolve_one
    abstract_dist = self._get_abstract_dist_for(req_to_install)
  File ""/usr/lib/python3/dist-packages/pip/_internal/legacy_resolve.py"", line 282, in _get_abstract_dist_for
    abstract_dist = self.preparer.prepare_linked_requirement(req)
  File ""/usr/lib/python3/dist-packages/pip/_internal/operations/prepare.py"", line 515, in prepare_linked_requirement
    abstract_dist = _get_prepared_distribution(
  File ""/usr/lib/python3/dist-packages/pip/_internal/operations/prepare.py"", line 95, in _get_prepared_distribution
    abstract_dist.prepare_distribution_metadata(finder, build_isolation)
  File ""/usr/lib/python3/dist-packages/pip/_internal/distributions/sdist.py"", line 38, in prepare_distribution_metadata
    self._setup_isolation(finder)
  File ""/usr/lib/python3/dist-packages/pip/_internal/distributions/sdist.py"", line 66, in _setup_isolation
    self.req.build_env.install_requirements(
  File ""/usr/lib/python3/dist-packages/pip/_internal/build_env.py"", line 201, in install_requirements
    call_subprocess(args, spinner=spinner)
  File ""/usr/lib/python3/dist-packages/pip/_internal/utils/subprocess.py"", line 186, in call_subprocess
    proc = subprocess.Popen(
  File ""/usr/lib/python3.8/subprocess.py"", line 854, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File ""/usr/lib/python3.8/subprocess.py"", line 1637, in _execute_child
    self.pid = _posixsubprocess.fork_exec(
TypeError: expected str, bytes or os.PathLike object, not NoneType


**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: [e.g. Linux ubuntu20]
 - Python version [e.g. 3.8.5]
 - Numpy version [e.g. 1.19.2]
 - MACS Version [e.g. 2.2.7.1]

**Additional context**
NO
",lufuhao,https://github.com/macs3-project/MACS/issues/420
MDU6SXNzdWU3MzY4NTkyMzA=,Q: Peakcalling in paired-end bam as single-end and keeping all reads,OPEN,2020-11-05T11:38:55Z,2024-10-11T20:11:51Z,,"I am using macs2 version 2.2.6.

Can you confirm my observations please :

- When **--format BAMPE** is used with paired-end BAM files, only properly paired are kept

- When **--format BAM** is used with paired-end BAM files, only properly paired are kept and then only R1 tags are considered

If this is the case, my question is how can I analyze my paired-end bam files as single-end **without filtering any reads** ?

Thank you in advance for your help.",MbDiop,https://github.com/macs3-project/MACS/issues/421
MDU6SXNzdWU3NDQzNjMxMjA=,Q: Problem with macs2 command,CLOSED,2020-11-17T02:51:30Z,2020-11-18T10:04:28Z,2020-11-18T10:04:28Z,"Hi 

I was trying to install macs2. It seemed to have installed properly.

However, I received the following error when running macs2

Can anyone please help. Thanks.  


$ `python setup.py install --prefix=/project/xxx/software/MACS-master/`
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: numpy>=1.17 in /project/xxx/software/python_package (1.19.4)
running install
running bdist_egg
running egg_info
creating MACS2.egg-info
writing MACS2.egg-info/PKG-INFO
writing dependency_links to MACS2.egg-info/dependency_links.txt
writing requirements to MACS2.egg-info/requires.txt
writing top-level names to MACS2.egg-info/top_level.txt
writing manifest file 'MACS2.egg-info/SOURCES.txt'
reading manifest file 'MACS2.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
warning: no previously-included files found matching '.gitignore'
warning: no previously-included files found matching '.travis.yml'
no previously-included directories found matching '.github'
no previously-included directories found matching 'DOCKER'
writing manifest file 'MACS2.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
creating build
creating build/lib.linux-x86_64-3.7
creating build/lib.linux-x86_64-3.7/MACS2
copying MACS2/bdgcmp_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/pileup_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/cmbreps_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/filterdup_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/predictd_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/__init__.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/bdgdiff_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/bdgbroadcall_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/randsample_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/callpeak_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/diffpeak_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/Constants.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/bdgopt_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/refinepeak_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/bdgpeakcall_cmd.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/OptValidator.py -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/OutputWriter.py -> build/lib.linux-x86_64-3.7/MACS2
creating build/lib.linux-x86_64-3.7/MACS2/IO
copying MACS2/IO/__init__.py -> build/lib.linux-x86_64-3.7/MACS2/IO
copying MACS2/cPosValCalculation.pxd -> build/lib.linux-x86_64-3.7/MACS2
copying MACS2/khash.pxd -> build/lib.linux-x86_64-3.7/MACS2
running build_ext
skipping 'MACS2/Prob.c' Cython extension (up-to-date)
skipping 'MACS2/IO/Parser.c' Cython extension (up-to-date)
skipping 'MACS2/Pileup.c' Cython extension (up-to-date)
skipping 'MACS2/PeakModel.c' Cython extension (up-to-date)
skipping 'MACS2/PeakDetect.c' Cython extension (up-to-date)
skipping 'MACS2/Signal.c' Cython extension (up-to-date)
skipping 'MACS2/IO/PeakIO.c' Cython extension (up-to-date)
skipping 'MACS2/IO/BedGraphIO.c' Cython extension (up-to-date)
skipping 'MACS2/IO/FixWidthTrack.c' Cython extension (up-to-date)
skipping 'MACS2/IO/PairedEndTrack.c' Cython extension (up-to-date)
skipping 'MACS2/IO/BedGraph.c' Cython extension (up-to-date)
skipping 'MACS2/IO/ScoreTrack.c' Cython extension (up-to-date)
skipping 'MACS2/IO/CallPeakUnit.c' Cython extension (up-to-date)
building 'MACS2.Prob' extension
creating build/temp.linux-x86_64-3.7
creating build/temp.linux-x86_64-3.7/MACS2
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/Prob.c -o build/temp.linux-x86_64-3.7/MACS2/Prob.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/Prob.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lm -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/Prob.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.IO.Parser' extension
creating build/temp.linux-x86_64-3.7/MACS2/IO
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/IO/Parser.c -o build/temp.linux-x86_64-3.7/MACS2/IO/Parser.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/IO/Parser.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/IO/Parser.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.Pileup' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/Pileup.c -o build/temp.linux-x86_64-3.7/MACS2/Pileup.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/cPosValCalculation.c -o build/temp.linux-x86_64-3.7/MACS2/cPosValCalculation.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/Pileup.o build/temp.linux-x86_64-3.7/MACS2/cPosValCalculation.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/Pileup.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.PeakModel' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/PeakModel.c -o build/temp.linux-x86_64-3.7/MACS2/PeakModel.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/PeakModel.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/PeakModel.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.PeakDetect' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/PeakDetect.c -o build/temp.linux-x86_64-3.7/MACS2/PeakDetect.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/PeakDetect.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/PeakDetect.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.Signal' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/Signal.c -o build/temp.linux-x86_64-3.7/MACS2/Signal.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/Signal.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/Signal.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.IO.PeakIO' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/IO/PeakIO.c -o build/temp.linux-x86_64-3.7/MACS2/IO/PeakIO.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/IO/PeakIO.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/IO/PeakIO.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.IO.BedGraphIO' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/IO/BedGraphIO.c -o build/temp.linux-x86_64-3.7/MACS2/IO/BedGraphIO.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/IO/BedGraphIO.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/IO/BedGraphIO.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.IO.FixWidthTrack' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/IO/FixWidthTrack.c -o build/temp.linux-x86_64-3.7/MACS2/IO/FixWidthTrack.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/IO/FixWidthTrack.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/IO/FixWidthTrack.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.IO.PairedEndTrack' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/IO/PairedEndTrack.c -o build/temp.linux-x86_64-3.7/MACS2/IO/PairedEndTrack.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/IO/PairedEndTrack.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/IO/PairedEndTrack.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.IO.BedGraph' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/IO/BedGraph.c -o build/temp.linux-x86_64-3.7/MACS2/IO/BedGraph.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/IO/BedGraph.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lm -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/IO/BedGraph.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.IO.ScoreTrack' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/IO/ScoreTrack.c -o build/temp.linux-x86_64-3.7/MACS2/IO/ScoreTrack.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/IO/ScoreTrack.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/IO/ScoreTrack.cpython-37m-x86_64-linux-gnu.so
building 'MACS2.IO.CallPeakUnit' extension
/spack/apps/gcc/8.3.0/bin/gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -I/project/xxx/software/python_package/numpy/core/include -I/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/include/python3.7m -c MACS2/IO/CallPeakUnit.c -o build/temp.linux-x86_64-3.7/MACS2/IO/CallPeakUnit.o -w -O3 -ffast-math -g0
/spack/apps/gcc/8.3.0/bin/gcc -pthread -shared -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/sqlite-3.30.1-law2rzqeabsqggz3c74aydhnkjsozab2/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libuuid-1.0.3-heivksfaa2zlycd2sxxezhyeo3tojhyt/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/bzip2-1.0.8-b65almiioh2l4xgr3ulcr7bftjvo5m2u/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/ncurses-6.1-akiyo4qrgzlzxw3hggkc42nvv7hz2evj/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/expat-2.2.9-ope3awavw2mgzmhncl5tqddb4ewhj4zh/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/openssl-1.1.1d-d7a46dreyvyazopzpgcwerqvjfmy2grd/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gettext-0.20.1-xk2yprlbovytt6sd54xjhbzsz2erz7gg/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/xz-5.2.4-k3s7isvxg4uuldajdbyu6lbmkhm2ntxm/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/gdbm-1.18.1-vmpezmonnso5wltqaaz5huflaqswzvec/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libffi-3.2.1-5zm7fbrppbfnsdztrda267dtlcelq7rx/lib64 -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/libnsl-1.2.0-dwvt6mwkaqgyibvqcjpiz27cjwtquj7g/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/zlib-1.2.11-dp3wfr26pumq5x4dltujahr4qse4agnk/lib -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/readline-8.0-odh3n6nbrw6ffkpsjcnwpv7tlyxpregx/lib build/temp.linux-x86_64-3.7/MACS2/IO/CallPeakUnit.o -L/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib -lpython3.7m -o build/lib.linux-x86_64-3.7/MACS2/IO/CallPeakUnit.cpython-37m-x86_64-linux-gnu.so
creating build/bdist.linux-x86_64
creating build/bdist.linux-x86_64/egg
creating build/bdist.linux-x86_64/egg/MACS2
creating build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/ScoreTrack.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/BedGraphIO.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/BedGraph.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/Parser.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/CallPeakUnit.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/__init__.py -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/PairedEndTrack.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/PeakIO.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/IO/FixWidthTrack.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2/IO
copying build/lib.linux-x86_64-3.7/MACS2/Prob.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/randsample_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/diffpeak_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/Pileup.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/Signal.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/OutputWriter.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/OptValidator.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/cPosValCalculation.pxd -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/cmbreps_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/pileup_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/filterdup_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/refinepeak_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/callpeak_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/bdgcmp_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/__init__.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/Constants.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/PeakModel.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/khash.pxd -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/predictd_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/bdgopt_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/bdgpeakcall_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/PeakDetect.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/bdgbroadcall_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
copying build/lib.linux-x86_64-3.7/MACS2/bdgdiff_cmd.py -> build/bdist.linux-x86_64/egg/MACS2
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/__init__.py to __init__.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/randsample_cmd.py to randsample_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/diffpeak_cmd.py to diffpeak_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/OutputWriter.py to OutputWriter.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/OptValidator.py to OptValidator.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/cmbreps_cmd.py to cmbreps_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/pileup_cmd.py to pileup_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/filterdup_cmd.py to filterdup_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/refinepeak_cmd.py to refinepeak_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/callpeak_cmd.py to callpeak_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/bdgcmp_cmd.py to bdgcmp_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/__init__.py to __init__.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/Constants.py to Constants.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/predictd_cmd.py to predictd_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/bdgopt_cmd.py to bdgopt_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/bdgpeakcall_cmd.py to bdgpeakcall_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/bdgbroadcall_cmd.py to bdgbroadcall_cmd.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/bdgdiff_cmd.py to bdgdiff_cmd.cpython-37.pyc
creating stub loader for MACS2/Prob.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/IO/Parser.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/Pileup.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/PeakModel.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/PeakDetect.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/Signal.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/IO/PeakIO.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/IO/BedGraphIO.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/IO/FixWidthTrack.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/IO/PairedEndTrack.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/IO/BedGraph.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/IO/ScoreTrack.cpython-37m-x86_64-linux-gnu.so
creating stub loader for MACS2/IO/CallPeakUnit.cpython-37m-x86_64-linux-gnu.so
byte-compiling build/bdist.linux-x86_64/egg/MACS2/Prob.py to Prob.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/Parser.py to Parser.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/Pileup.py to Pileup.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/PeakModel.py to PeakModel.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/PeakDetect.py to PeakDetect.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/Signal.py to Signal.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/PeakIO.py to PeakIO.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/BedGraphIO.py to BedGraphIO.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/FixWidthTrack.py to FixWidthTrack.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/PairedEndTrack.py to PairedEndTrack.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/BedGraph.py to BedGraph.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/ScoreTrack.py to ScoreTrack.cpython-37.pyc
byte-compiling build/bdist.linux-x86_64/egg/MACS2/IO/CallPeakUnit.py to CallPeakUnit.cpython-37.pyc
creating build/bdist.linux-x86_64/egg/EGG-INFO
installing scripts to build/bdist.linux-x86_64/egg/EGG-INFO/scripts
running install_scripts
running build_scripts
creating build/scripts-3.7
copying and adjusting bin/macs2 -> build/scripts-3.7
changing mode of build/scripts-3.7/macs2 from 660 to 775
creating build/bdist.linux-x86_64/egg/EGG-INFO/scripts
copying build/scripts-3.7/macs2 -> build/bdist.linux-x86_64/egg/EGG-INFO/scripts
changing mode of build/bdist.linux-x86_64/egg/EGG-INFO/scripts/macs2 to 775
copying MACS2.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MACS2.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MACS2.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MACS2.egg-info/requires.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying MACS2.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
writing build/bdist.linux-x86_64/egg/EGG-INFO/native_libs.txt
zip_safe flag not set; analyzing archive contents...
MACS2.IO.__pycache__.BedGraph.cpython-37: module references __file__
MACS2.IO.__pycache__.BedGraphIO.cpython-37: module references __file__
MACS2.IO.__pycache__.CallPeakUnit.cpython-37: module references __file__
MACS2.IO.__pycache__.FixWidthTrack.cpython-37: module references __file__
MACS2.IO.__pycache__.PairedEndTrack.cpython-37: module references __file__
MACS2.IO.__pycache__.Parser.cpython-37: module references __file__
MACS2.IO.__pycache__.PeakIO.cpython-37: module references __file__
MACS2.IO.__pycache__.ScoreTrack.cpython-37: module references __file__
MACS2.__pycache__.PeakDetect.cpython-37: module references __file__
MACS2.__pycache__.PeakModel.cpython-37: module references __file__
MACS2.__pycache__.Pileup.cpython-37: module references __file__
MACS2.__pycache__.Prob.cpython-37: module references __file__
MACS2.__pycache__.Signal.cpython-37: module references __file__
creating dist
creating 'dist/MACS2-2.2.7.1-py3.7-linux-x86_64.egg' and adding 'build/bdist.linux-x86_64/egg' to it
removing 'build/bdist.linux-x86_64/egg' (and everything under it)
Processing MACS2-2.2.7.1-py3.7-linux-x86_64.egg
creating /project/xxx/software/MACS-master/lib/python3.7/site-packages/MACS2-2.2.7.1-py3.7-linux-x86_64.egg
Extracting MACS2-2.2.7.1-py3.7-linux-x86_64.egg to /project/xxx/software/MACS-master/lib/python3.7/site-packages
Adding MACS2 2.2.7.1 to easy-install.pth file
Installing macs2 script to /project/xxx/software/MACS-master//bin

Installed /project/xxx/software/MACS-master/lib/python3.7/site-packages/MACS2-2.2.7.1-py3.7-linux-x86_64.egg
Processing dependencies for MACS2==2.2.7.1
Searching for numpy==1.19.4
Best match: numpy 1.19.4
Adding numpy 1.19.4 to easy-install.pth file
Installing f2py script to /project/xxx/software/MACS-master//bin
Installing f2py3 script to /project/xxx/software/MACS-master//bin
Installing f2py3.7 script to /project/xxx/software/MACS-master//bin

Using /project/xxx/software/python_package
Finished processing dependencies for MACS2==2.2.7.1
$ `cd bin/`
$ `macs2`
Traceback (most recent call last):
  File ""/project/xxx/software/MACS-master/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.2.7.1', 'macs2')
  File ""/project/xxx/software/python_package/pkg_resources/__init__.py"", line 650, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/project/xxx/software/python_package/pkg_resources/__init__.py"", line 1436, in run_script
    .format(**locals()),
pkg_resources.ResolutionError: Script 'scripts/macs2' not found in metadata at '/project/xxx/software/python_package/MACS2-2.2.7.1.dist-info'
$
",beetlejuice007,https://github.com/macs3-project/MACS/issues/422
MDU6SXNzdWU3NDgxMDMwODM=,Q: using macs2 to call peaks on eCLIP-seq data get an error,OPEN,2020-11-21T21:07:03Z,2020-11-25T20:01:19Z,,"Hi:

I am trying to analyze eCLIP-seq data and my PI advised me to call peaks using MACS2. I read the manual on how macs2 can be used for peak calling when doing chip-seq. It looks easy to follow: I just need to provide the macs command bam files. So, I did the following:

> `$ macs2 callpeak -t GRCh37SRR5111379Aligned.sortedByCoord.out.bam -c GRCh37SRR5111939Aligned.sortedByCoord.out.bam -f BAM -g 1.3e+8 -n HNRNPKRep1 --outdir macs2/ >log1 2>error1  `

But I got error like this:

```
INFO  @ Sat, 21 Nov 2020 14:51:08: 
# Command line: callpeak -t GRCh37SRR5111379Aligned.sortedByCoord.out.bam -c GRCh37SRR5111939Aligned.sortedByCoord.out.bam -f BAM -g 1.3e+8 -n HNRNPKRep1 --outdir macs2/
# ARGUMENTS LIST:
# name = HNRNPKRep1
# format = BAM
# ChIP-seq file = ['GRCh37SRR5111379Aligned.sortedByCoord.out.bam']
# control file = ['GRCh37SRR5111939Aligned.sortedByCoord.out.bam']
# effective genome size = 1.30e+08
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
INFO  @ Sat, 21 Nov 2020 14:51:08: #1 read tag files... 
INFO  @ Sat, 21 Nov 2020 14:51:08: #1 read treatment tags... 
INFO  @ Sat, 21 Nov 2020 14:51:11:  1000000 
INFO  @ Sat, 21 Nov 2020 14:51:14:  2000000 
INFO  @ Sat, 21 Nov 2020 14:51:17:  3000000 
INFO  @ Sat, 21 Nov 2020 14:51:20:  4000000 
INFO  @ Sat, 21 Nov 2020 14:51:23:  5000000 
INFO  @ Sat, 21 Nov 2020 14:51:24: #1.2 read input tags... 
INFO  @ Sat, 21 Nov 2020 14:51:27:  1000000 
INFO  @ Sat, 21 Nov 2020 14:51:29:  2000000 
INFO  @ Sat, 21 Nov 2020 14:51:32:  3000000 
INFO  @ Sat, 21 Nov 2020 14:51:34:  4000000 
INFO  @ Sat, 21 Nov 2020 14:51:37:  5000000 
INFO  @ Sat, 21 Nov 2020 14:51:40:  6000000 
INFO  @ Sat, 21 Nov 2020 14:51:43:  7000000 
INFO  @ Sat, 21 Nov 2020 14:51:46:  8000000 
INFO  @ Sat, 21 Nov 2020 14:51:49:  9000000 
INFO  @ Sat, 21 Nov 2020 14:51:52:  10000000 
INFO  @ Sat, 21 Nov 2020 14:51:55:  11000000 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1 tag size is determined as 42 bps 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1 tag size = 42.0 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1  total tags in treatment: 1942896 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1 user defined the maximum tags... 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1  tags after filtering in treatment: 1617769 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1  Redundant rate of treatment: 0.17 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1  total tags in control: 3284905 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1 user defined the maximum tags... 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1  tags after filtering in control: 1846916 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1  Redundant rate of control: 0.44 
INFO  @ Sat, 21 Nov 2020 14:51:58: #1 finished! 
INFO  @ Sat, 21 Nov 2020 14:51:58: #2 Build Peak Model... 
INFO  @ Sat, 21 Nov 2020 14:51:58: #2 looking for paired plus/minus strand peaks... 
INFO  @ Sat, 21 Nov 2020 14:51:58: #2 number of paired peaks: 2 
WARNING @ Sat, 21 Nov 2020 14:51:58: Too few paired peaks (2) so I can not build the model! Broader your MFOLD range parameter may erase this error. If it still can't build the model, we suggest to use --nomodel and --extsize 147 or other fixed number instead. 
WARNING @ Sat, 21 Nov 2020 14:51:58: Process for pairing-model is terminated!
```

Does any one can help me correct the command to make it work?

Thanks,
",qicaibiology,https://github.com/macs3-project/MACS/issues/423
MDU6SXNzdWU3NTU0ODkxNDE=,OSError: [Errno 122] Disk quota exceeded,OPEN,2020-12-02T17:56:43Z,2020-12-03T16:46:25Z,,"Hi

I am receiving the following error message. I have 5TB space in my tempdir. Can anyone help what the issue is ? Thanks. 
The same command works when I did not have --broad

$ macs2 --version
macs2 2.2.7.1

INFO  @ Tue, 01 Dec 2020 23:42:29: 
 Command line: callpeak --broad --tempdir /scratch/xxx/ -t /project/xxx_71/xxx/xx1/A1.clean_sorted.bam -c /project/xxx_71/xxx/xx1/F1.clean_sorted.bam -f BAMPE -g hs --outdir /project/xxx_71/xxx/xx1/broad -n A1.F1 -B -q 0.01
 ARGUMENTS LIST:
 name = A1.F1
 format = BAMPE
 ChIP-seq file = ['/project/xxx_71/xxx/xx1/A1.clean_sorted.bam']
 control file = ['/project/xxx_71/xxx/xx1/F1.clean_sorted.bam']
 effective genome size = 2.70e+09
 band width = 300
 model fold = [5, 50]
 qvalue cutoff for narrow/strong regions = 1.00e-02
 qvalue cutoff for broad/weak regions = 1.00e-01
 The maximum gap between significant sites is assigned as the read length/tag size.
 The minimum length of peaks is assigned as the predicted fragment length ""d"".
 Larger dataset will be scaled towards smaller dataset.
 Range for calculating regional lambda is: 1000 bps and 10000 bps
 Broad region calling is on
 Paired-End mode is on
 
INFO  @ Tue, 01 Dec 2020 23:42:29: #1 read fragment files... 
INFO  @ Tue, 01 Dec 2020 23:42:29: #1 read treatment fragments... 
INFO  @ Tue, 01 Dec 2020 23:42:34:  1000000 
INFO  @ Tue, 01 Dec 2020 23:42:39:  2000000 

....

INFO  @ Tue, 01 Dec 2020 23:49:26:  93000000 
INFO  @ Tue, 01 Dec 2020 23:49:31:  94000000 
INFO  @ Tue, 01 Dec 2020 23:49:36:  95000000 
INFO  @ Tue, 01 Dec 2020 23:49:36: 95032218 fragments have been read. 
INFO  @ Tue, 01 Dec 2020 23:50:56: #1.2 read input fragments... 
INFO  @ Tue, 01 Dec 2020 23:51:01:  1000000 
INFO  @ Tue, 01 Dec 2020 23:51:06:  2000000 

....

INFO  @ Wed, 02 Dec 2020 00:00:40:  124000000 
INFO  @ Wed, 02 Dec 2020 00:00:44:  125000000 
INFO  @ Wed, 02 Dec 2020 00:00:49:  126000000 
INFO  @ Wed, 02 Dec 2020 00:00:54:  127000000 
INFO  @ Wed, 02 Dec 2020 00:00:54: 127040449 fragments have been read. 
INFO  @ Wed, 02 Dec 2020 00:02:31: #1 mean fragment size is determined as 285.8 bp from treatment 
INFO  @ Wed, 02 Dec 2020 00:02:31: #1 note: mean fragment size in control is 247.8 bp -- value ignored 
INFO  @ Wed, 02 Dec 2020 00:02:31: #1 fragment size = 285.8 
INFO  @ Wed, 02 Dec 2020 00:02:31: #1  total fragments in treatment: 95032218 
INFO  @ Wed, 02 Dec 2020 00:02:31: #1 user defined the maximum fragments... 
INFO  @ Wed, 02 Dec 2020 00:02:31: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 02 Dec 2020 00:05:58: #1  fragments after filtering in treatment: 67559775 
INFO  @ Wed, 02 Dec 2020 00:05:58: #1  Redundant rate of treatment: 0.29 
INFO  @ Wed, 02 Dec 2020 00:05:58: #1  total fragments in control: 127040449 
INFO  @ Wed, 02 Dec 2020 00:05:58: #1 user defined the maximum fragments... 
INFO  @ Wed, 02 Dec 2020 00:05:58: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 02 Dec 2020 00:10:46: #1  fragments after filtering in control: 115046583 
INFO  @ Wed, 02 Dec 2020 00:10:46: #1  Redundant rate of control: 0.09 
INFO  @ Wed, 02 Dec 2020 00:10:46: #1 finished! 
INFO  @ Wed, 02 Dec 2020 00:10:46: #2 Build Peak Model... 
INFO  @ Wed, 02 Dec 2020 00:10:46: #2 Skipped... 
INFO  @ Wed, 02 Dec 2020 00:10:46: #3 Call peaks... 
INFO  @ Wed, 02 Dec 2020 00:10:46: #3 Call broad peaks with given level1 -log10qvalue cutoff and level2: 2.000000, 1.000000... 
INFO  @ Wed, 02 Dec 2020 00:10:46: #3 Pre-compute pvalue-qvalue table... 
INFO  @ Wed, 02 Dec 2020 00:26:01: #3 In the peak calling step, the following will be performed simultaneously: 
INFO  @ Wed, 02 Dec 2020 00:26:01: #3   Write bedGraph files for treatment pileup (after scaling if necessary)... A1.F1_treat_pileup.bdg 
INFO  @ Wed, 02 Dec 2020 00:26:01: #3   Write bedGraph files for control lambda (after scaling if necessary)... A1.F1_control_lambda.bdg 
INFO  @ Wed, 02 Dec 2020 00:26:01: #3 Call peaks for each chromosome... 
INFO  @ Wed, 02 Dec 2020 00:42:19: #4 Write output xls file... /project/xxx_71/xxx/xx1/broad/A1.F1_peaks.xls 
Traceback (most recent call last):
  File ""/project/xxx_71/xxx/xx1/software/MACS-master/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.2.7.1', 'macs2')
  File ""/project/xxx_71/xxx/xx1/software/python_package/pkg_resources/__init__.py"", line 650, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/project/xxx_71/xxx/xx1/software/python_package/pkg_resources/__init__.py"", line 1446, in run_script
    exec(code, namespace, namespace)
  File ""/project/xxx_71/xxx/xx1/software/MACS-master/lib/python3.7/site-packages/MACS2-2.2.7.1-py3.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 653, in <module>
    main()
  File ""/project/xxx_71/xxx/xx1/software/MACS-master/lib/python3.7/site-packages/MACS2-2.2.7.1-py3.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 51, in main
    run( args )
  File ""/project/xxx_71/xxx/xx1/software/MACS-master/lib/python3.7/site-packages/MACS2-2.2.7.1-py3.7-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 297, in run
    peakdetect.peaks.write_to_xls(ofhd_xls, name = options.name.encode())
  File ""MACS2/IO/PeakIO.pyx"", line 1175, in MACS2.IO.PeakIO.BroadPeakIO.write_to_xls
OSError: [Errno 122] Disk quota exceeded



",beetlejuice007,https://github.com/macs3-project/MACS/issues/424
MDU6SXNzdWU3NzAyMjc0ODc=,Q: dose --fe-cutoff actually mean --log2fe-cutoff ？,OPEN,2020-12-17T17:19:24Z,2020-12-17T17:19:24Z,,"**Use case**
A clear and concise description of what the use case is. For example: my data is from [...]

**Describe the problem**
A clear and concise description of what happend.

**Describe the solution you tried**
A clear and concise description of any solutions you've tried.

**Additional context**
Add any other context or screenshots about your use case here.
",xieyy46,https://github.com/macs3-project/MACS/issues/436
MDU6SXNzdWU3ODEzMTIwNzY=,Q: peaks falling out of chromosomes after using --shift -75 --extsize 150 (So can't use bedToBigBed),CLOSED,2021-01-07T13:25:47Z,2021-01-21T04:08:11Z,2021-01-21T04:08:11Z,"Hi all. 
I performed two calling with MACS2 on ATAC-seq paired end data. The first one with `- f BAMPE`, and the second one with `-f BED --shift -75 --extsize 150` as suggested in [the following discussion](https://github.com/macs3-project/MACS/discussions/435). 

Then i would like to convert peakfiles to bigBed format using the bedToBigBed tool from UCSC.  But in the case I use peakfiles from the `-f BED --shift -75 --extsize 150` calling, I get the following error : 

`End coordinate 81195231 bigger than chr17 size of 81195210`. 

Even if i am using the right chrom.sizes file !  This issue has already been reported on [biostars](https://www.biostars.org/p/269061/). This happens when we got peaks on chromosome edges... The use of the bedClip tool from UCSC solves this issue. But it looses some information dropping peaks or truncating it...

Have you got a better way to prevent or solve it without loosing information?

",clbenoit,https://github.com/macs3-project/MACS/issues/438
MDU6SXNzdWU3ODQ0ODQxNTU=,Q: callpeak doesn't generate bedgraphs?,CLOSED,2021-01-12T18:33:44Z,2021-01-12T18:37:17Z,2021-01-12T18:37:17Z,fixed - sorry!,tinakeshav,https://github.com/macs3-project/MACS/issues/439
MDU6SXNzdWU3ODc0NjYyNTM=,Q: Is it ok to use --nolambda for chip-seq data with input control?,CLOSED,2021-01-16T13:27:52Z,2021-01-21T08:13:25Z,2021-01-21T08:13:25Z,"Hello,

I am calling peaks on chip-seq data for a broad epigenetic mark. When I run the callpeaks command with mostly default settings and an input sample I get very few peaks (~3000). When I run the same command with input control and the --nolambda flag I get many more peaks (~15000). Looking at literature it seems 15000-20000 peaks are more consistent with what other people have found for this mark. But after reading the documentation it seems it is not a good idea to use a fixed global lambda. 

Do you have any comments on whether it is ok to use the --nolamda flag for chip-seq data which has an input control? I have seen a lot of papers use the --nolambda option especially for histone marks but they dont give a rationale for it.

Thanks ",re2srm,https://github.com/macs3-project/MACS/issues/440
MDU6SXNzdWU3ODk2MjE4MjY=,Bug: Installation error on Windows using pip install macs2,CLOSED,2021-01-20T04:32:31Z,2023-03-15T13:07:36Z,2021-01-25T06:36:03Z,"**Describe the bug**
When using `pip install macs2`, when building the wheel, an error `LINK : fatal error LNK1181: cannot open input file 'm.lib'
  error: command 'C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Tools\\MSVC\\14.21.27702\\bin\\HostX86\\x64\\link.exe' failed with exit status 1181` occurs.


**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
![image](https://user-images.githubusercontent.com/48355111/105127077-09b47c80-5b1b-11eb-86ce-f017351cd31b.png)


**System
 - OS: Windows 10
 - Python version: 3.8.6
 - Numpy version: 1.20
 - MACS version: 2.2.7.1

**Additional context**
I have also tried downloading and using the setup script to install MACS2. There is a line in the script where there is an ""m"". 
![image](https://user-images.githubusercontent.com/48355111/105127190-4d0eeb00-5b1b-11eb-8a46-1c4c521c4be0.png)
I have tried removing it and changing it but it still fails to install.
![image](https://user-images.githubusercontent.com/48355111/105127293-8b0c0f00-5b1b-11eb-8a76-ae1d48c2a7ec.png)


",philyang07,https://github.com/macs3-project/MACS/issues/441
MDU6SXNzdWU3OTU3NjU1MDY=,Bug: callpeak using exact same arguments results in error on MACS3 but no error on MACS2,CLOSED,2021-01-28T07:58:35Z,2021-02-10T17:22:09Z,2021-02-08T15:29:49Z,"**Describe the bug**
I tried using the `callpeak` function on the same BAM file and gsize value (the default value of 2.7e9) for both MACS2 and MACS3. However, MACS2 ran fine without an error, but MACS3 produced an error.

**To Reproduce**
`macs2 callpeak -t demux_testfastq_S1_L001_R1_001_aligned.bam -g 2.7e9 &> out2.txt`
`macs3 callpeak -t demux_testfastq_S1_L001_R1_001_aligned.bam -g 2.7e9 &> out3.txt`

**Expected behavior**
No errors when running either command

**Screenshots**
![image](https://user-images.githubusercontent.com/48355111/106106915-36067380-6181-11eb-97ce-cdada61bced3.png)
![image](https://user-images.githubusercontent.com/48355111/106106945-3f8fdb80-6181-11eb-9589-f674126bb861.png)

**System (please complete the following information):**
 - OS: Linux
 - Python version 3.6.9
 - Numpy version 1.18.2
 - MACS2 version 2.2.7.1
 - MACS3 version 3.0.0a5
",philyang07,https://github.com/macs3-project/MACS/issues/442
MDU6SXNzdWU3OTU5OTQ2ODY=,Q: MACS3 callvar parameter,OPEN,2021-01-28T13:15:38Z,2021-01-28T13:15:38Z,,"Hi, I am tring to call variants in given peak regions from the alignment BAM files  from ATAC-seq data using macs3.

I found the callvar_examples file in the folder named  test, but the parameters are too simple. However, I did not find the detailed description of ""macs3 callvar"" parameters.  when I click the ""callvar"" bottun, I get an error. #404

I have 3 stages of ATAC-seq data, and 4 biological replicates in each stage.  now I have get chromatin accessiblility of each sample using MACS2.

so, I have some questions:
if I am interested in variate in given peak regions, which parameter should be add?
",yue131,https://github.com/macs3-project/MACS/issues/443
MDU6SXNzdWU3OTc2MTczMTk=,MACS wont install,OPEN,2021-01-31T04:41:12Z,2021-10-24T09:56:26Z,,"git clone doesnt work: 
```
git clone git@github.com:taoliu/MACS.git
Cloning into 'MACS'...
The authenticity of host 'github.com (140.82.114.3)' can't be established.
RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'github.com,140.82.114.3' (RSA) to the list of known hosts.
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.

```

install instruction on the website does not work: 
```
pip install MACS2
Collecting MACS2
  Using cached MACS2-2.2.7.1.tar.gz (2.1 MB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
    Preparing wheel metadata ... done
Requirement already satisfied: numpy>=>=1.17 in c:\users\danie\appdata\local\packages\pythonsoftwarefoundation.python.3.9_qbz5n2kfra8p0\localcache\local-packages\python39\site-packages (from MACS2) (1.20.0)
Building wheels for collected packages: MACS2
  Building wheel for MACS2 (PEP 517) ... error
  ERROR: Command errored out with exit status 1:
   command: 'C:\Users\danie\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\python.exe' 'C:\Users\danie\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.9_qbz5n2kfra8p0\LocalCache\local-packages\Python39\site-packages\pip\_vendor\pep517\_in_process.py' build_wheel 'C:\Users\danie\AppData\Local\Temp\tmpfun47h13'
       cwd: C:\Users\danie\AppData\Local\Temp\pip-install-414hvz4o\macs2_e89766b7fac946bc8f3f6165c43fb583
  Complete output (44 lines):
  Requirement already satisfied: numpy>=1.17 in c:\users\danie\appdata\local\temp\pip-build-env-huutz002\overlay\lib\site-packages (1.20.0)
  running bdist_wheel
  running build
  running build_py
  creating build
  creating build\lib.win-amd64-3.9
  creating build\lib.win-amd64-3.9\MACS2
  copying MACS2\bdgbroadcall_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\bdgcmp_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\bdgdiff_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\bdgopt_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\bdgpeakcall_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\callpeak_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\cmbreps_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\Constants.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\diffpeak_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\filterdup_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\OptValidator.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\OutputWriter.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\pileup_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\predictd_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\randsample_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\refinepeak_cmd.py -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\__init__.py -> build\lib.win-amd64-3.9\MACS2
  creating build\lib.win-amd64-3.9\MACS2\IO
  copying MACS2\IO\__init__.py -> build\lib.win-amd64-3.9\MACS2\IO
  copying MACS2\cPosValCalculation.pxd -> build\lib.win-amd64-3.9\MACS2
  copying MACS2\khash.pxd -> build\lib.win-amd64-3.9\MACS2
  running build_ext
  skipping 'MACS2\Prob.c' Cython extension (up-to-date)
  skipping 'MACS2/IO\Parser.c' Cython extension (up-to-date)
  skipping 'MACS2\Pileup.c' Cython extension (up-to-date)
  skipping 'MACS2\PeakModel.c' Cython extension (up-to-date)
  skipping 'MACS2\PeakDetect.c' Cython extension (up-to-date)
  skipping 'MACS2\Signal.c' Cython extension (up-to-date)
  skipping 'MACS2/IO\PeakIO.c' Cython extension (up-to-date)
  skipping 'MACS2/IO\BedGraphIO.c' Cython extension (up-to-date)
  skipping 'MACS2/IO\FixWidthTrack.c' Cython extension (up-to-date)
  skipping 'MACS2/IO\PairedEndTrack.c' Cython extension (up-to-date)
  skipping 'MACS2/IO\BedGraph.c' Cython extension (up-to-date)
  skipping 'MACS2/IO\ScoreTrack.c' Cython extension (up-to-date)
  skipping 'MACS2/IO\CallPeakUnit.c' Cython extension (up-to-date)
  building 'MACS2.Prob' extension
  error: Microsoft Visual C++ 14.0 or greater is required. Get it with ""Microsoft C++ Build Tools"": https://visualstudio.microsoft.com/visual-cpp-build-tools/
  ----------------------------------------
  ERROR: Failed building wheel for MACS2
Failed to build MACS2
ERROR: Could not build wheels for MACS2 which use PEP 517 and cannot be installed directly

```

Please make an installer that works ",decapicone,https://github.com/macs3-project/MACS/issues/444
MDU6SXNzdWU3OTgzODQ5NTU=,Q: Hi  ,OPEN,2021-02-01T14:07:47Z,2021-02-01T14:18:18Z,,"Hi, 
when I call peak for multiple bam, Whether to support the path of multiple files, placed inside the file, provided to the -t parameter. 
Store the path to each bam file in the file（bam_list.txt），Then, provide the file to MACS callpeak.
Thank you!
**Use case**
A clear and concise description of what the use case is. For example: my data is from [...]

**Describe the problem**
A clear and concise description of what happend.

**Describe the solution you tried**
A clear and concise description of any solutions you've tried.

**Additional context**
Add any other context or screenshots about your use case here.
",azyro,https://github.com/macs3-project/MACS/issues/445
MDU6SXNzdWU4MDQ3Nzc4NTY=,Should Debian ship MACS 3.0.0 alpha 6 in the next Debian stable release?,CLOSED,2021-02-09T17:52:04Z,2021-02-09T17:54:17Z,2021-02-09T17:54:16Z,"Hello,

The window for updates to Debian packages for Debian ""Bullseye"" is closing soon. Currently we have [MACS 2.2.7.1](https://packages.debian.org/source/testing/macs). Should we instead be shipping the latest MACS 3.0.0 alpha, or is that still too soon?",mr-c,https://github.com/macs3-project/MACS/issues/447
MDU6SXNzdWU4MDczNjI3Mjg=,Q: macs2 usage of parameter for PE reads ,OPEN,2021-02-12T16:19:36Z,2021-03-29T15:19:23Z,,"Hello, 

Thanks for the tool, Using the macs2 for peak calling for chip PE(150 bp) data, confused with parameter usage can you please suggest me below usage of command is correct or not. --shift and --extsize is good use in case PE data or not. 
currently I tried 

macs2 callpeak -f BAMPE --keep-dup all -g mm  -t H3k4me3.bam -c Input.bam  --outdir H3k4me3 
macs2 callpeak -f BAMPE --keep-dup all -g mm  -t TF_protein_1.bam -c Input.bam  --outdir TF_protein_1

I am getting around 15000 peaks for H3k4me3 and for TF_protein_1 very less single digit.

Thank you ",Hemantcnaik,https://github.com/macs3-project/MACS/issues/448
MDU6SXNzdWU4NDEyNDI0MzQ=,Bug: negative values produced for offset column,CLOSED,2021-03-25T19:28:52Z,2021-04-28T13:02:52Z,2021-04-28T13:02:52Z,"I've tried several versions (most recently 2.2.7.1 containerized here: https://hub.docker.com/r/fooliu/macs2) and I keep getting a recurring issue where the final column (10th col, peak offset) receives negative values-- contigs over 1e9bp seems to be the threshold that breaks a lot of the tools we're used to with human/mouse. This is naturally throwing off the remainder of our process (loosely based on the ENCODE pipeline).

As is clear from the start sites, this is related to this organism (axolotl) having very large contigs. We've already had to use different BAM indexing, etc. to get suitable tag files (and updated bedtools versions using 64-bit ints). 

I suppose the work-around would be to split and subsequently merge the contigs to get them under 1e9 bp. But maybe we're missing a flag or something that would allow us to run MACS2 without resorting to that...?

Thanks! Hopefully I have not missed anything relevant or made any glaring mistakes!

Command (based on older ENCODE process) was as follows. All commands run inside of the aforementioned Docker image.
```
root@64443225403a:/work# macs2 --version
macs2 2.2.7.1
```

```
macs2 callpeak 
    -t pulldown.tagAlign 
    -c input.tagAlign
     -f BED 
     -n zzz 
     -p 0.01 
     --nomodel 
     --shift 0 
     --extsize 200 
     --keep-dup all 
     -B 
     --SPMR
```
Example output:
```
chr10p	1073719728	1073719928	zzz_peak_49839	24	.	2.31041	2.44992	0.500814	24
chr10p	1073722889	1073723176	zzz_peak_49840	34	.	3.13098	3.41397	0.759108	111
chr10p	1073732609	1073732848	zzz_peak_49841	44	.	3.68143	4.43782	0.959737	148
chr10p	1073774034	1073774389	zzz_peak_49842	35	.	3.08054	3.58377	0.805273	-2147483492
chr10p	1073821756	1073821974	zzz_peak_49843	41	.	3.52644	4.12448	0.89786	-2147483594
chr10p	1073822267	1073822467	zzz_peak_49844	20	.	2.11586	2.04971	0.410871	-2147483585
chr10p	1073825075	1073825285	zzz_peak_49845	32	.	2.94515	3.28755	0.732502	-2147483449
chr10p	1073827168	1073827389	zzz_peak_49846	30	.	2.82115	3.04023	0.612908	-2147483509
``` 

I can provide the input tag files if necessary.",blawney,https://github.com/macs3-project/MACS/issues/450
MDU6SXNzdWU4NDIxNzI1NDM=,call summit q-value in bigwig file,OPEN,2021-03-26T17:35:58Z,2021-03-30T14:25:59Z,,"To call peaks from multiple replicates I first extended the reads, normalized the signal in each replicate, and then took the average signal at each base pair using my own code. I then did the same for the multiple replicates of the control I have. I then compared the ChIP to the control bigwigs using `bdgcmp -m qpois`. Then I used the output of this command for input to `bdgpeakcall` which gives me a narrowPeak file of significant regions and their region q-values. However, I would like to obtain the summit q-values. Is this possible?",sklasfeld,https://github.com/macs3-project/MACS/issues/451
MDU6SXNzdWU4NjI1NTcwOTI=,Q:  I got an Error with PeakDetect.call_peaks while running callpeak with pair-end MEDIP seq data,CLOSED,2021-04-20T08:22:44Z,2024-12-02T07:22:56Z,2021-05-03T08:19:47Z,"my data is : Illumina paired-end MEDIP seq

I used -f BAMPE -g hs -p 1.00e-02
and I got this error. please give me any suggestions

------------------------------------------------

effective genome size = 2.70e+09
band width = 300
model fold = [5, 50]
pvalue cutoff = 1.00e-02
qvalue will not be calculated and reported as -1 in the final output.
The maximum gap between significant sites is assigned as the read length/tag size.
The minimum length of peaks is assigned as the predicted fragment length ""d"".
Larger dataset will be scaled towards smaller dataset.
Range for calculating regional lambda is: 1000 bps and 10000 bps
Broad region calling is off
Paired-End mode is on
 
INFO  @ Tue, 20 Apr 2021 15:21:07: #1 read fragment files... 
INFO  @ Tue, 20 Apr 2021 15:21:07: #1 read treatment fragments... 
INFO  @ Tue, 20 Apr 2021 15:21:09:  1000000 
INFO  @ Tue, 20 Apr 2021 15:21:12:  2000000 
INFO  @ Tue, 20 Apr 2021 15:21:14:  3000000 
INFO  @ Tue, 20 Apr 2021 15:21:17:  4000000 
INFO  @ Tue, 20 Apr 2021 15:21:19:  5000000 
INFO  @ Tue, 20 Apr 2021 15:21:21:  6000000 
INFO  @ Tue, 20 Apr 2021 15:21:24:  7000000 
INFO  @ Tue, 20 Apr 2021 15:21:26:  8000000 
INFO  @ Tue, 20 Apr 2021 15:21:28:  9000000 
INFO  @ Tue, 20 Apr 2021 15:21:30:  10000000 
INFO  @ Tue, 20 Apr 2021 15:21:33:  11000000 
INFO  @ Tue, 20 Apr 2021 15:21:47: 11517512 fragments have been read. 
INFO  @ Tue, 20 Apr 2021 15:21:55: #1.2 read input fragments... 
INFO  @ Tue, 20 Apr 2021 15:21:57:  1000000 
INFO  @ Tue, 20 Apr 2021 15:21:59:  2000000 
INFO  @ Tue, 20 Apr 2021 15:22:02:  3000000 
INFO  @ Tue, 20 Apr 2021 15:22:04:  4000000 
INFO  @ Tue, 20 Apr 2021 15:22:06:  5000000 
INFO  @ Tue, 20 Apr 2021 15:22:09:  6000000 
INFO  @ Tue, 20 Apr 2021 15:22:11:  7000000 
INFO  @ Tue, 20 Apr 2021 15:22:13:  8000000 
INFO  @ Tue, 20 Apr 2021 15:22:16:  9000000 
INFO  @ Tue, 20 Apr 2021 15:22:18:  10000000 
INFO  @ Tue, 20 Apr 2021 15:22:20:  11000000 
INFO  @ Tue, 20 Apr 2021 15:22:23:  12000000 
INFO  @ Tue, 20 Apr 2021 15:22:25:  13000000 
INFO  @ Tue, 20 Apr 2021 15:22:27:  14000000 
INFO  @ Tue, 20 Apr 2021 15:22:39: 14942679 fragments have been read. 
INFO  @ Tue, 20 Apr 2021 15:22:49: #1 mean fragment size is determined as 0.0 bp from treatment 
INFO  @ Tue, 20 Apr 2021 15:22:49: #1 note: mean fragment size in control is 0.0 bp -- value ignored 
INFO  @ Tue, 20 Apr 2021 15:22:49: #1 fragment size = 0.0 
INFO  @ Tue, 20 Apr 2021 15:22:49: #1  total fragments in treatment: 11517512 
INFO  @ Tue, 20 Apr 2021 15:22:49: #1 user defined the maximum fragments... 
INFO  @ Tue, 20 Apr 2021 15:22:49: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Tue, 20 Apr 2021 15:23:03: #1  fragments after filtering in treatment: 93 
INFO  @ Tue, 20 Apr 2021 15:23:03: #1  Redundant rate of treatment: 1.00 
INFO  @ Tue, 20 Apr 2021 15:23:03: #1  total fragments in control: 14942679 
INFO  @ Tue, 20 Apr 2021 15:23:03: #1 user defined the maximum fragments... 
INFO  @ Tue, 20 Apr 2021 15:23:03: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Tue, 20 Apr 2021 15:23:20: #1  fragments after filtering in control: 93 
INFO  @ Tue, 20 Apr 2021 15:23:20: #1  Redundant rate of control: 1.00 
INFO  @ Tue, 20 Apr 2021 15:23:20: #1 finished! 
INFO  @ Tue, 20 Apr 2021 15:23:20: #2 Build Peak Model... 
INFO  @ Tue, 20 Apr 2021 15:23:20: #2 Skipped... 
INFO  @ Tue, 20 Apr 2021 14:51:02: #3 Call peaks... 
Traceback (most recent call last):
  File ""/ckeerati/.conda/envs/MACS2-CK/bin/macs2"", line 653, in <module>
    main()
  File ""/ckeerati/.conda/envs/MACS2-CK/bin/macs2"", line 51, in main
    run( args )
  File ""/ckeerati/.conda/envs/MACS2-CK/lib/python3.6/site-packages/MACS2/callpeak_cmd.py"", line 256, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 107, in MACS2.PeakDetect.PeakDetect.call_peaks
  File ""MACS2/PeakDetect.pyx"", line 155, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control
ZeroDivisionError: float division

---------------------------------------------------------------",chantisakee,https://github.com/macs3-project/MACS/issues/452
MDU6SXNzdWU4NjQyMjc2Mzc=,Macs2 inconsistent.  Sometimes it works. sometimes it doesnt. ,CLOSED,2021-04-21T19:54:15Z,2022-02-18T21:42:08Z,2022-02-18T21:42:08Z,"Ok, whats going on here?  Sometimes macs2 works; sometimes it doesn't.  I changed nothing about my code.  You can even look at the command line in both outputs below and see they are the exact same, aside from the tmp directory.  

I am using the Signac wrapper for macs2.  Signac (R package) is an extension of Seurat (R package), used for single cell data analysis.  Signac first splits my fragment file by cell type and puts the new .bed file into a tmp directory, which is fed to macs2.  I am submitting 144 macs2 jobs as a slurm array.  I thought the issue could be that there were too many tmp directories being created at the same time.  Nope.  After using a loop instead of parallel computing, the same error still occurs.  

Here is the output from a failed run: 

```
INFO  @ Wed, 21 Apr 2021 11:42:50: 
# Command line: callpeak -t /tmp/RtmpSWcxw9/Astro.bed -g 2.7e+09 -f BED --nomodel --extsize 200 --shift -100 -n Astro --outdir /gpfs/fs1/data/chiba-faleklab/Daniel/snATAC.snRNA.R01.v2/R.objects/recalled.peaks/astro2/99/
# ARGUMENTS LIST:
# name = Astro
# format = BED
# ChIP-seq file = ['/tmp/RtmpSWcxw9/Astro.bed']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
INFO  @ Wed, 21 Apr 2021 11:42:50: #1 read tag files... 
INFO  @ Wed, 21 Apr 2021 11:42:50: #1 read treatment tags... 
Exception ZeroDivisionError: 'integer division or modulo by zero' in 'MACS2.IO.Parser.GenericParser.tsize' ignored
INFO  @ Wed, 21 Apr 2021 11:42:50: #1 tag size is determined as 0 bps 
INFO  @ Wed, 21 Apr 2021 11:42:50: #1 tag size = 0.0 
INFO  @ Wed, 21 Apr 2021 11:42:50: #1  total tags in treatment: 0 
INFO  @ Wed, 21 Apr 2021 11:42:50: #1 user defined the maximum tags... 
INFO  @ Wed, 21 Apr 2021 11:42:50: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Wed, 21 Apr 2021 11:42:50: #1  tags after filtering in treatment: 0 
Traceback (most recent call last):
  File ""/nfs/software/helmod/apps/Core/macs2/2.1.2.20181108-gcb01/bin/macs2"", line 622, in <module>
    main()
  File ""/nfs/software/helmod/apps/Core/macs2/2.1.2.20181108-gcb01/bin/macs2"", line 57, in main
    run( args )
  File ""/nfs/software/helmod/apps/Core/macs2/2.1.2.20181108-gcb01/lib/python2.7/site-packages/MACS2/callpeak_cmd.py"", line 112, in run
    info(""#1  Redundant rate of treatment: %.2f"", float(t0 - t1) / t0)
ZeroDivisionError: float division by zero
Error in file(file, ""rt"") : cannot open the connection
Calls: CallPeaks ... CallPeaks -> CallPeaks.default -> read.table -> file
In addition: Warning message:
In file(file, ""rt"") :
  cannot open file '/gpfs/fs1/data/chiba-faleklab/Daniel/snATAC.snRNA.R01.v2/R.objects/recalled.peaks/astro2/99//Astro_peaks.narrowPeak': No such file or directory
Execution halted
```

Here is the same exact code, but it works: 

```
INFO  @ Wed, 21 Apr 2021 13:02:14: 
# Command line: callpeak -t /tmp/RtmpaQeXyt/Astro.bed -g 2.7e+09 -f BED --nomodel --extsize 200 --shift -100 -n Astro --outdir /gpfs/fs1/data/chiba-faleklab/Daniel/snATAC.snRNA.R01.v2/R.objects/recalled.peaks/astro2/99/
# ARGUMENTS LIST:
# name = Astro
# format = BED
# ChIP-seq file = ['/tmp/RtmpaQeXyt/Astro.bed']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
INFO  @ Wed, 21 Apr 2021 13:02:14: #1 read tag files... 
INFO  @ Wed, 21 Apr 2021 13:02:14: #1 read treatment tags... 
INFO  @ Wed, 21 Apr 2021 13:02:16:  1000000 
INFO  @ Wed, 21 Apr 2021 13:02:18:  2000000 
INFO  @ Wed, 21 Apr 2021 13:02:19:  3000000 
INFO  @ Wed, 21 Apr 2021 13:02:21:  4000000 
INFO  @ Wed, 21 Apr 2021 13:02:22:  5000000 
INFO  @ Wed, 21 Apr 2021 13:02:24:  6000000 
INFO  @ Wed, 21 Apr 2021 13:02:26:  7000000 
INFO  @ Wed, 21 Apr 2021 13:02:27:  8000000 
INFO  @ Wed, 21 Apr 2021 13:02:29:  9000000 
INFO  @ Wed, 21 Apr 2021 13:02:30:  10000000 
INFO  @ Wed, 21 Apr 2021 13:02:32:  11000000 
INFO  @ Wed, 21 Apr 2021 13:02:33:  12000000 
INFO  @ Wed, 21 Apr 2021 13:02:35:  13000000 
INFO  @ Wed, 21 Apr 2021 13:02:36:  14000000 
INFO  @ Wed, 21 Apr 2021 13:02:38:  15000000 
INFO  @ Wed, 21 Apr 2021 13:02:40:  16000000 
INFO  @ Wed, 21 Apr 2021 13:02:41:  17000000 
INFO  @ Wed, 21 Apr 2021 13:02:43:  18000000 
INFO  @ Wed, 21 Apr 2021 13:02:44:  19000000 
INFO  @ Wed, 21 Apr 2021 13:02:46:  20000000 
INFO  @ Wed, 21 Apr 2021 13:02:48:  21000000 
INFO  @ Wed, 21 Apr 2021 13:02:49:  22000000 
INFO  @ Wed, 21 Apr 2021 13:02:51:  23000000 
INFO  @ Wed, 21 Apr 2021 13:02:52:  24000000 
INFO  @ Wed, 21 Apr 2021 13:02:54:  25000000 
INFO  @ Wed, 21 Apr 2021 13:02:55:  26000000 
INFO  @ Wed, 21 Apr 2021 13:02:56:  27000000 
INFO  @ Wed, 21 Apr 2021 13:02:58:  28000000 
INFO  @ Wed, 21 Apr 2021 13:02:59:  29000000 
INFO  @ Wed, 21 Apr 2021 13:03:01:  30000000 
INFO  @ Wed, 21 Apr 2021 13:03:02:  31000000 
INFO  @ Wed, 21 Apr 2021 13:03:04:  32000000 
INFO  @ Wed, 21 Apr 2021 13:03:05:  33000000 
INFO  @ Wed, 21 Apr 2021 13:03:07:  34000000 
INFO  @ Wed, 21 Apr 2021 13:03:08:  35000000 
INFO  @ Wed, 21 Apr 2021 13:03:10:  36000000 
INFO  @ Wed, 21 Apr 2021 13:03:12:  37000000 
INFO  @ Wed, 21 Apr 2021 13:03:13:  38000000 
INFO  @ Wed, 21 Apr 2021 13:03:15:  39000000 
INFO  @ Wed, 21 Apr 2021 13:03:16:  40000000 
INFO  @ Wed, 21 Apr 2021 13:03:18:  41000000 
INFO  @ Wed, 21 Apr 2021 13:03:19:  42000000 
INFO  @ Wed, 21 Apr 2021 13:03:21:  43000000 
INFO  @ Wed, 21 Apr 2021 13:03:22:  44000000 
INFO  @ Wed, 21 Apr 2021 13:03:24:  45000000 
INFO  @ Wed, 21 Apr 2021 13:03:25:  46000000 
INFO  @ Wed, 21 Apr 2021 13:03:27:  47000000 
INFO  @ Wed, 21 Apr 2021 13:03:28:  48000000 
INFO  @ Wed, 21 Apr 2021 13:03:29: #1 tag size is determined as 138 bps 
INFO  @ Wed, 21 Apr 2021 13:03:29: #1 tag size = 138.0 
INFO  @ Wed, 21 Apr 2021 13:03:29: #1  total tags in treatment: 48060470 
INFO  @ Wed, 21 Apr 2021 13:03:29: #1 user defined the maximum tags... 
INFO  @ Wed, 21 Apr 2021 13:03:29: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Wed, 21 Apr 2021 13:03:30: #1  tags after filtering in treatment: 40448582 
INFO  @ Wed, 21 Apr 2021 13:03:30: #1  Redundant rate of treatment: 0.16 
INFO  @ Wed, 21 Apr 2021 13:03:30: #1 finished! 
INFO  @ Wed, 21 Apr 2021 13:03:30: #2 Build Peak Model... 
INFO  @ Wed, 21 Apr 2021 13:03:30: #2 Skipped... 
INFO  @ Wed, 21 Apr 2021 13:03:30: #2 Use 200 as fragment length 
INFO  @ Wed, 21 Apr 2021 13:03:30: #2 Sequencing ends will be shifted towards 5' by 100 bp(s) 
INFO  @ Wed, 21 Apr 2021 13:03:30: #3 Call peaks... 
INFO  @ Wed, 21 Apr 2021 13:03:30: #3 Pre-compute pvalue-qvalue table... 
INFO  @ Wed, 21 Apr 2021 13:05:28: #3 Call peaks for each chromosome... 
INFO  @ Wed, 21 Apr 2021 13:06:57: #4 Write output xls file... /gpfs/fs1/data/chiba-faleklab/Daniel/snATAC.snRNA.R01.v2/R.objects/recalled.peaks/astro2/99/Astro_peaks.xls 
INFO  @ Wed, 21 Apr 2021 13:06:58: #4 Write peak in narrowPeak format file... /gpfs/fs1/data/chiba-faleklab/Daniel/snATAC.snRNA.R01.v2/R.objects/recalled.peaks/astro2/99/Astro_peaks.narrowPeak 
INFO  @ Wed, 21 Apr 2021 13:06:59: #4 Write summits bed file... /gpfs/fs1/data/chiba-faleklab/Daniel/snATAC.snRNA.R01.v2/R.objects/recalled.peaks/astro2/99/Astro_summits.bed 
INFO  @ Wed, 21 Apr 2021 13:06:59: Done! 

```

From the output above, the command line input given to macs2 from signac is identical (see below).  Why is one failing while the other does not?  

```
# Command line: callpeak -t /tmp/RtmpSWcxw9/Astro.bed -g 2.7e+09 -f BED --nomodel --extsize 200 --shift -100 -n Astro --outdir /gpfs/fs1/data/chiba-faleklab/Daniel/snATAC.snRNA.R01.v2/R.objects/recalled.peaks/astro2/99/
# ARGUMENTS LIST:
# name = Astro
# format = BED
# ChIP-seq file = ['/tmp/RtmpSWcxw9/Astro.bed']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02

# Command line: callpeak -t /tmp/RtmpaQeXyt/Astro.bed -g 2.7e+09 -f BED --nomodel --extsize 200 --shift -100 -n Astro --outdir /gpfs/fs1/data/chiba-faleklab/Daniel/snATAC.snRNA.R01.v2/R.objects/recalled.peaks/astro2/99/
# ARGUMENTS LIST:
# name = Astro
# format = BED
# ChIP-seq file = ['/tmp/RtmpaQeXyt/Astro.bed']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
```",danielcgingerich,https://github.com/macs3-project/MACS/issues/453
MDU6SXNzdWU4NjUyNzMzODE=,Q: What does the fold enrichment value represent? Is it log transformed? How can I have an output fold enrichment value of as low 1.1 that is highly significnat (q< 0.000001)?,OPEN,2021-04-22T18:09:02Z,2021-04-27T19:58:13Z,,"**Use case**
A clear and concise description of what the use case is. For example: my data is from [...]

**Describe the problem**
A clear and concise description of what happend.

**Describe the solution you tried**
A clear and concise description of any solutions you've tried.

**Additional context**
Add any other context or screenshots about your use case here.
",mmbennet1205,https://github.com/macs3-project/MACS/issues/454
MDU6SXNzdWU4NzEyMTM3NjY=,Q: bdgdiff log likelihood ratios: what is the statistical cutoff?,OPEN,2021-04-29T16:24:04Z,2022-06-27T14:27:30Z,,"Hi,

I'm having trouble finding any explanation of the bdgdiff log likelihood ratios and I am wondering:
(I followed the instructions in the Wiki for identifying differential sites)

- are all reported differential sites in cond1 and cond2 files statistically significant?
- if yes to above, what is that exact statistical threshold AND can it be modified?

Thanks !!!

Best,
Dan",dansapozhnikov,https://github.com/macs3-project/MACS/issues/455
MDU6SXNzdWU4NzI0ODY0Njg=,Q: Peakcalling using -f BAMPE vs -f BAM on paired-end reads,OPEN,2021-04-30T13:13:34Z,2021-05-03T14:50:27Z,,"Hi Tao!

Thanks for the great tool and services!

I have some questions about calling peaks using -f BAM (SE) vs -f BAMPE (PE) for paired-end reads. Could you please help check if I get them right? Thanks.

(1) When calculating coverage using -f BAMPE for PE reads, each pair of reads will be counted as one read, instead of 2, no matter how many overlaps R1 and R2 have?

(2) If -f BAM (SE) was used for PE reads (which was incorrect but happened sometimes), only R1 would be kept as you mentioned in another issue. R1 refers to reads from the R1.fastq from the sequencing center, and has nothing to do with forward or reverse reads, right?

I called peaks from PE reads using -f BAM by mistake. Then I corrected the calling using -f BAMPE. When I compared these two sets of peaks, the amount of peaks for some ChIP samples doubled, while other decreased, compared to the incorrect SE calling. Any suggestions on why samples showed opposite trends?

Thanks,
Mao",mlin2017,https://github.com/macs3-project/MACS/issues/456
MDU6SXNzdWU4NzMxNDY1ODc=,Q: How to identify sub-peak / summit width?,OPEN,2021-04-30T19:25:29Z,2021-05-01T05:34:31Z,,"Hi,
I am calling peaks with MACS2 using:

`macs2 callpeak -t reads.bam  --call-summits -c input.bam -B --outdir peaks
`

Since some of the peaks have subpeaks, MACS will call summits for these subpeaks. However, my current output does not seem to describe the width of these subpeaks/summits, which makes it difficult to separate the peaks into subpeaks in order to analyze them separately. 

I am interested in this because I have noticed some of my chip-seq peaks are very wide, while others are very punctuate. It would be interesting to separate these two kinds of peaks and analyze jointly. However, this is complicated by the fact that the peak widths I get from MACS will count multiple narrow sub-peaks as one wide peak, which is not accurate. Thus, it would be interesting to de-convolve the peak into the widths of the subpeaks. Is there any way to do this currently?",gdolsten,https://github.com/macs3-project/MACS/issues/457
MDU6SXNzdWU4NzMxODA0MjA=,ZeroDivisionError: integer division or modulo by zero (with /MACS1/IO/Parser.py),CLOSED,2021-04-30T19:43:25Z,2021-05-04T22:19:54Z,2021-05-04T22:19:54Z,"""File ""/Library/Python/2.7/site-packages/MACS1/IO/Parser.py"", line 655, in tsize     return int(s/n) ZeroDivisionError: integer division or modulo by zero""

I have my .sam files ready to go after being SRR files were processed by bowtie1.1.1 --was having issues with newer bowtie versions (the data is not sorted)

When processing using MACS, I am encountering an error with Parser.py (error above)

In terms of troubleshooting, I am at a bit of a loss. If anyone has encountered this error before, I would appreciate it.
Maybe my .sam file is not correct? 



",jcness216,https://github.com/macs3-project/MACS/issues/458
MDU6SXNzdWU4NzQyMDQxOTc=,Q: MACS3 is not on conda?,CLOSED,2021-05-03T03:53:51Z,2023-10-02T11:44:38Z,2021-05-03T04:29:27Z,"It looks like MACS3 is not in the conda repository? Has it just not been added yet? I have an error when trying to install through pip (building wheel for cykhash), so I'd like to try a conda install.",wesleylcai,https://github.com/macs3-project/MACS/issues/459
MDU6SXNzdWU4ODYyMzk5NTM=,"Pipeline didn't provide ""_model.r "" outputs from MEDIP-seq data",OPEN,2021-05-11T06:49:24Z,2021-05-12T19:00:32Z,,"Hi,
I've analysed Medipseq data using MACS2

here is my script:

macs2 callpeak -t Tumor_rmdup.bam -c Control_rmdup.bam \
-f BAMPE -g hs \
-p 0.01 \
-n RCC10_L4 \
--bdg \
--outdir ${OUTPUT_DIR}

here is all the outputs i've got : RCC10_L4_peaks.narrowPeak  RCC10_L4_summits.bed RCC10_L4_peaks.xls ; 

Just wondering Why didn't I get another ""_model.r"" output from this script? and How do I get them?

Thank you in advance,
Chantisa",chantisakee,https://github.com/macs3-project/MACS/issues/460
MDU6SXNzdWU4OTczNjY3Mzk=,Bug: MACS2 segfault on bedgraph output into non-existant folder,OPEN,2021-05-20T19:54:13Z,2021-05-27T18:54:44Z,,"**Describe the bug**
MACS2 segfaults. Output looks like the following:
```
INFO  @ Mon, 29 Mar 2021 16:07:56: #3   --SPMR is requested, so pileup will be normalized by sequencing depth in million reads. 
InNFO  @ Mon, 29 Mar 2021 16:07:56: #3 Call peaks for each chromosome... 
Segmentation fault
```

**To Reproduce**
Run `callpeak` with the `--name` option specifying a directory that does not yet exist. e.g.
`macs2 callpeak --treatment chip_TA_H3K4me1.tagAlign.gz --control chip_TA_control.tagAlign.gz --format BED --name peak_output/chip_TA --gsize 2.8e9 --pvalue 1e-2 --nomodel --extsize 250 --keep-dup all --bdg --SPMR --shift 0` where the subfolder `peak_output` does not exist.

**Expected behavior**
No segfault

**Screenshots**
Here's a core dump where it shows calling into writing out a bedGraph, likely to a non-existant path.
```
#0  __vfprintf_internal (s=0x0, format=0x7fa124b1ca46 ""%s\t%d\t%d\t%.5f\n"", ap=ap@entry=0x7ffdc4b17ba0, mode_flags=2) at vfprintf-internal.c:1328
#1  0x00007fa1a8113023 in ___fprintf_chk (fp=<optimized out>, flag=<optimized out>, format=<optimized out>) at fprintf_chk.c:33
#2  0x00007fa124abf2f3 in __pyx_f_5MACS2_2IO_12CallPeakUnit_20CallerFromAlignments___write_bedGraph_for_a_chromosome ()
   from /home/ericr/miniconda3/envs/macs2/lib/python3.9/site-packages/MACS2/IO/CallPeakUnit.cpython-39-x86_64-linux-gnu.so
#3  0x00007fa124ae9bed in __pyx_f_5MACS2_2IO_12CallPeakUnit_20CallerFromAlignments___chrom_call_peak_using_certain_criteria ()
   from /home/ericr/miniconda3/envs/macs2/lib/python3.9/site-packages/MACS2/IO/CallPeakUnit.cpython-39-x86_64-linux-gnu.so
#4  0x00007fa124af94f9 in __pyx_f_5MACS2_2IO_12CallPeakUnit_20CallerFromAlignments_call_peaks ()
   from /home/ericr/miniconda3/envs/macs2/lib/python3.9/site-packages/MACS2/IO/CallPeakUnit.cpython-39-x86_64-linux-gnu.so
#5  0x00007fa124ade304 in __pyx_pw_5MACS2_2IO_12CallPeakUnit_20CallerFromAlignments_9call_peaks ()
   from /home/ericr/miniconda3/envs/macs2/lib/python3.9/site-packages/MACS2/IO/CallPeakUnit.cpython-39-x86_64-linux-gnu.so
#6  0x000055d931010ed5 in cfunction_call (func=0x7fa124a711d0, args=<optimized out>, kwargs=<optimized out>)
    at /home/conda/feedstock_root/build_artifacts/python-split_1613883019772/work/Objects/methodobject.c:539
#7  0x00007fa124b4749f in __Pyx_PyObject_Call () from /home/ericr/miniconda3/envs/macs2/lib/python3.9/site-packages/MACS2/PeakDetect.cpython-39-x86_64-linux-gnu.so
#8  0x00007fa124b5b85d in __pyx_pw_5MACS2_10PeakDetect_10PeakDetect_5__call_peaks_w_control ()
   from /home/ericr/miniconda3/envs/macs2/lib/python3.9/site-packages/MACS2/PeakDetect.cpython-39-x86_64-linux-gnu.so
#9  0x00007fa124b4a867 in __pyx_pw_5MACS2_10PeakDetect_10PeakDetect_3call_peaks ()
   from /home/ericr/miniconda3/envs/macs2/lib/python3.9/site-packages/MACS2/PeakDetect.cpython-39-x86_64-linux-gnu.so
#10 0x000055d930ff7b26 in _PyObject_MakeTpCall (tstate=0x55d9319060c0, callable=0x7fa124ec74c0, args=<optimized out>, nargs=<optimized out>, keywords=<optimized out>)
    at /home/conda/feedstock_root/build_artifacts/python-split_1613883019772/work/Include/internal/pycore_pyerrors.h:14
#11 0x000055d93105243e in _PyObject_VectorcallTstate (kwnames=<optimized out>, nargsf=<optimized out>, args=0x55d931eb7540, callable=0x7fa124ec74c0, tstate=0x55d9319060c0)
    at /home/conda/feedstock_root/build_artifacts/python-split_1613883019772/work/Include/cpython/abstract.h:1161
```

**System (please complete the following information):**
 - OS: Linux
 - Python 3.9.2
 - Numpy 1.20.2
 - MACS Version 2.2.7.1

**Additional context**
This problem does not exist on non-bed output because presumably there is no immediate call into the c-extension and python catches the missing path instead (where an Exception is raised).
",EricR86,https://github.com/macs3-project/MACS/issues/461
MDU6SXNzdWU4OTc1MTQzMjE=,How run macs2 for allelic bam files,OPEN,2021-05-20T22:25:58Z,2021-05-20T22:25:58Z,,"Hello, Thanks for the tool

I have used macs for non allelic data there we will have the one input and one sample as treated, Currently I have allelic bam files for Input  control and treated can you suggest me how can run macs2 for peak calling how to use it can you please suggest me

files
allele1_input.bam, allele2_input.bam
allele1_pol2.bam, allele2_pol2.bam

Thank you

",luckysardar,https://github.com/macs3-project/MACS/issues/462
MDU6SXNzdWU4OTkxNzk3Mzk=,macs2 callpeak option about effective genome size and shift model,OPEN,2021-05-24T02:10:11Z,2021-09-27T03:14:48Z,,"Hi 
Recently I try to run ATAC-seq data based on ENCODE pipeline, when I call peaks, I notice the default value for some certain species like human and mouse, while my species is animal (e.g., sheep), so how can I properly set this parameter? 
Besides, I wonder how to determine the parameters for shift model. _--nomodel --shift -100 --extsize 200_ or _--nomodel --shift -75 --extsize 150_? Does it depends on the length of paired-end reads? @taoliu 
Thanks !

Best wishes
Zoe
",LunaPatton,https://github.com/macs3-project/MACS/issues/463
MDU6SXNzdWU5MTA2NjI0OTI=,Q: What is BEDPE?,CLOSED,2021-06-03T16:26:14Z,2024-02-24T18:31:42Z,2021-06-03T16:35:25Z,"Hi,

I'm looking over the documentation for `callpeak` and it states, about the BEDPE format: `Please note, this is NOT the same format used by BEDTOOLS, and the BEDTOOLS version of BEDPE is actually not in a standard BED format.`

Going to Google and typing in BEDPE format leads to https://bedtools.readthedocs.io/en/latest/content/general-usage.html. It seems BEDTOOLS developed the BEDPE format as a different format from simple BED.

When using MACS to convert to ""BEDPE"" format, as suggested on the `callpeak` doc, `macs2 randsample -i align.bam -f BAMPE -p 100 -o align.bedpe`, it returns a simple BED format, not BEDPE format. There are three columns: `chr start end`

My question is: What is BEDPE according to MACS? Is it just the same thing as bed, just with `chrom start_of_fragment end_of_fragment`? If so, I suggest changing the ""BEDPE"" format you refer to to a different name, such as BEDFRAG or something like that.

Thanks!
Artur",BeyondTheProof,https://github.com/macs3-project/MACS/issues/464
MDU6SXNzdWU5MTk1NjgzOTc=,"macs3 ""mean fragment size is determined as 0.0 bp from treatment""",CLOSED,2021-06-12T14:04:25Z,2021-06-14T14:01:19Z,2021-06-14T14:01:19Z,"I'm trying to call peaks from encode data, but it estimates fragment sizes as 0, which is impossible and then it throws this error `ZeroDivisionError: float division`",Delta-43,https://github.com/macs3-project/MACS/issues/465
MDU6SXNzdWU5Mjk1MjAwOTg=,Q: MACS2 snATAC,OPEN,2021-06-24T18:55:21Z,2021-06-24T18:55:21Z,,"Hi, thanks for this truly awesome tool.
As you may already know, there is a lot of discussion around using which parameters for MACS2 peak calling in single-nucleus ATAC-seq. I have been using 
-q 0.01 -g hs --nomodel  --nolambda --extsize 200 --shift -100 -f BED
the above parameters to for my PE100 snATAC. I wanted to confirm with you if this makes sense from how MACS2 works and what will be the implication of these parameters. 
My understanding is that -f BED will allow peak calling on both the reads, then --nomodel will disable poisson modelling and shit the window for peak calling to 100 bp 3' and then extend it to 100 bp both sides.
Please let me know if I understand this correctly and if this makes sense to you. Do you think that rare peaks from rare cell populations may still be missed with these parameters? Thank you.

Anjali",AnjaliC4,https://github.com/macs3-project/MACS/issues/466
MDU6SXNzdWU5NDE0MDgwNDc=,Q: Should I use --nolambda without no control?,CLOSED,2021-07-11T09:09:19Z,2021-07-16T13:46:00Z,2021-07-16T13:46:00Z,"**Use case**

When I was going to call peaks with my H3K9me3 chipseq sample, I found that some people recommond:

> For broader peaks we recommend using --nomodel,--broad, --nolambda (if there's no control), and using the fragment size calculated on the strand cross correlation analysis.

**Describe the problem**

After looking for some imformation about the *lambda* and *bampe* , I was confused:

1. lambda seems be caculated by the control data. So, should I use `--nolambda` without no control in any other situation? i.e. TFs and H3K27ac. (the technical staff in our lab has a bad habit that many chipseq sample data has no input/IgG data!)
2. My data was Pair-end, so I  used `-f bampe`, in which the `--nomodel` and `--extsize` will be ignored. So. is `-f BAMPE --broad --broad-cutoff 0.1 --nolambda` enough for me?",809825706,https://github.com/macs3-project/MACS/issues/467
MDU6SXNzdWU5NDQ4MjgwMjA=,"BAMPE for CUT&RUN paired end data gives me ""AssertionError: 1000 can't be smaller than"" with both macs2 and macs3",OPEN,2021-07-14T21:59:19Z,2022-11-07T07:05:47Z,,"I am using MACS to call peaks for CUT&RUN data aligned with bwa (sorted and indexed bam files).
I am get the following errors with the included commands:

**MACS3**
macs3 callpeak -f BAMPE -t bams/31Corr-Day2_H3K4me3_PF.maxL.bam -c bams/31Corr-Day1_IgG_PF.maxL.bam --outdir peaks -g hs -n 31Corr-Day2 -B -q 0.05

**ERROR:**
INFO  @ Wed, 14 Jul 2021 17:38:08: 22663234 fragments have been read. 
INFO  @ Wed, 14 Jul 2021 17:38:22: #1 mean fragment size is determined as 10303.2 bp from treatment 
INFO  @ Wed, 14 Jul 2021 17:38:22: #1 note: mean fragment size in control is 16011.8 bp -- value ignored 
INFO  @ Wed, 14 Jul 2021 17:38:22: #1 fragment size = 10303.2 
INFO  @ Wed, 14 Jul 2021 17:38:22: #1  total fragments in treatment: 25914096 
INFO  @ Wed, 14 Jul 2021 17:38:22: #1 user defined the maximum fragments... 
INFO  @ Wed, 14 Jul 2021 17:38:22: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 14 Jul 2021 17:39:00: #1  fragments after filtering in treatment: 25019384 
INFO  @ Wed, 14 Jul 2021 17:39:00: #1  Redundant rate of treatment: 0.03 
INFO  @ Wed, 14 Jul 2021 17:39:00: #1  total fragments in control: 22663234 
INFO  @ Wed, 14 Jul 2021 17:39:00: #1 user defined the maximum fragments... 
INFO  @ Wed, 14 Jul 2021 17:39:00: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 14 Jul 2021 17:39:34: #1  fragments after filtering in control: 22183414 
INFO  @ Wed, 14 Jul 2021 17:39:34: #1  Redundant rate of control: 0.02 
INFO  @ Wed, 14 Jul 2021 17:39:34: #1 finished! 
INFO  @ Wed, 14 Jul 2021 17:39:34: #2 Build Peak Model... 
INFO  @ Wed, 14 Jul 2021 17:39:34: #2 Skipped... 
INFO  @ Wed, 14 Jul 2021 17:39:34: #3 Call peaks... 
Traceback (most recent call last):
  File ""/home/sylent/.conda/envs/conda-env/bin/macs3"", line 727, in <module>
    main()
  File ""/home/sylent/.conda/envs/conda-env/bin/macs3"", line 48, in main
    run( args )
  File ""/home/sylent/.conda/envs/conda-env/lib/python3.6/site-packages/MACS3/Commands/callpeak_cmd.py"", line 249, in run
    peakdetect.call_peaks()
  File ""MACS3/Signal/PeakDetect.pyx"", line 112, in MACS3.Signal.PeakDetect.PeakDetect.call_peaks
  File ""MACS3/Signal/PeakDetect.pyx"", line 184, in MACS3.Signal.PeakDetect.PeakDetect.__call_peaks_w_control
AssertionError: 1000 can't be smaller than 10303.216796875!

**MACS2**
macs2 callpeak -f BAMPE -t bams/31Corr-Day2_H3K4me3_PF.maxL.bam -c bams/31Corr-Day1_IgG_PF.maxL.bam --outdir peaks -g hs -n 31Corr-Day2 -B -q 0.05

**ERROR:**
INFO  @ Wed, 14 Jul 2021 14:36:07: 22663234 fragments have been read. 
INFO  @ Wed, 14 Jul 2021 14:36:21: #1 mean fragment size is determined as 10303.2 bp from treatment 
INFO  @ Wed, 14 Jul 2021 14:36:21: #1 note: mean fragment size in control is 16011.8 bp -- value ignored 
INFO  @ Wed, 14 Jul 2021 14:36:21: #1 fragment size = 10303.2 
INFO  @ Wed, 14 Jul 2021 14:36:21: #1  total fragments in treatment: 25914096 
INFO  @ Wed, 14 Jul 2021 14:36:21: #1 user defined the maximum fragments... 
INFO  @ Wed, 14 Jul 2021 14:36:21: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 14 Jul 2021 14:37:03: #1  fragments after filtering in treatment: 25019384 
INFO  @ Wed, 14 Jul 2021 14:37:03: #1  Redundant rate of treatment: 0.03 
INFO  @ Wed, 14 Jul 2021 14:37:03: #1  total fragments in control: 22663234 
INFO  @ Wed, 14 Jul 2021 14:37:03: #1 user defined the maximum fragments... 
INFO  @ Wed, 14 Jul 2021 14:37:03: #1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
INFO  @ Wed, 14 Jul 2021 14:37:40: #1  fragments after filtering in control: 22183414 
INFO  @ Wed, 14 Jul 2021 14:37:40: #1  Redundant rate of control: 0.02 
INFO  @ Wed, 14 Jul 2021 14:37:40: #1 finished! 
INFO  @ Wed, 14 Jul 2021 14:37:40: #2 Build Peak Model... 
INFO  @ Wed, 14 Jul 2021 14:37:40: #2 Skipped... 
INFO  @ Wed, 14 Jul 2021 14:37:40: #3 Call peaks... 
Traceback (most recent call last):
  File ""/home/sylent/.conda/envs/conda-env/bin/macs2"", line 653, in <module>
    main()
  File ""/home/sylent/.conda/envs/conda-env/bin/macs2"", line 51, in main
    run( args )
  File ""/home/sylent/.conda/envs/conda-env/lib/python3.6/site-packages/MACS2/callpeak_cmd.py"", line 256, in run
    peakdetect.call_peaks()
  File ""MACS2/PeakDetect.pyx"", line 107, in MACS2.PeakDetect.PeakDetect.call_peaks
  File ""MACS2/PeakDetect.pyx"", line 179, in MACS2.PeakDetect.PeakDetect.__call_peaks_w_control
AssertionError: 1000 can't be smaller than 10303.216796875!

I confirmed with predictd that fragment length was 170bp as expected from the library QC gels:
macs2 predictd -i bams/31Corr-Day2_H3K4me3_PF.maxL.bam -g hs
[SNIP]
INFO  @ Tue, 13 Jul 2021 18:17:14: 25914096 reads have been read. 
INFO  @ Tue, 13 Jul 2021 18:17:14: tag size is determined as 76 bps 
INFO  @ Tue, 13 Jul 2021 18:17:14: # tag size = 76 
INFO  @ Tue, 13 Jul 2021 18:17:14: # total tags in alignment file: 25914096 
INFO  @ Tue, 13 Jul 2021 18:17:14: # Build Peak Model... 
INFO  @ Tue, 13 Jul 2021 18:17:14: #2 looking for paired plus/minus strand peaks... 
INFO  @ Tue, 13 Jul 2021 18:17:18: #2 number of paired peaks: 49969 
INFO  @ Tue, 13 Jul 2021 18:17:18: start model_add_line... 
INFO  @ Tue, 13 Jul 2021 18:17:20: start X-correlation... 
INFO  @ Tue, 13 Jul 2021 18:17:20: end of X-cor 
INFO  @ Tue, 13 Jul 2021 18:17:20: # finished! 
INFO  @ Tue, 13 Jul 2021 18:17:20: # predicted fragment length is 170 bps 
INFO  @ Tue, 13 Jul 2021 18:17:20: # alternative fragment length(s) may be 170,349,535 bps 
INFO  @ Tue, 13 Jul 2021 18:17:20: # Generate R script for model : predictd 

I also used deeptools (see attached fragment size plot below) to assess fragment size.

Please let me know if this is a bug and/or how I can resolve this.
Thanks,
Piali

![fragmentSize](https://user-images.githubusercontent.com/7396915/125698550-32e720a1-2700-47b5-b1a4-45f081a8f902.png)
",pialim,https://github.com/macs3-project/MACS/issues/468
MDU6SXNzdWU5NDgwMDg3NDY=,Q: BioConda Permissions issue,OPEN,2021-07-19T20:39:18Z,2023-08-03T09:05:31Z,,"When clicking the link (https://anaconda.org/bioconda/macs3) in the documentation for accessing the conda install instructions. I get the following error message on the conda site. 

You don't have permission to view this page.
Please contact bioconda if you think this is an error.",csayre,https://github.com/macs3-project/MACS/issues/469
MDU6SXNzdWU5NDg3Mjk5MTE=,Q: Can I use all peaks (-q 1) for analysis?,OPEN,2021-07-20T14:46:47Z,2021-07-20T14:46:47Z,,"Hi, thanks for developing such a good tool!

**Use case**
In my case I am working on MeDIP-seq, and want to generate null distribution of all peaks, for gene promoter peak enrich p value calculation. By doing so, I can get ranks of significant genes better than just overlapping sig-peak on promoters.

**Describe the problem**
The situation is, I found the null distribution is difference between parameter -q 1 and -q 0.01. And clearly sig-peaks have higher affinity binding value. So I want to know **peaks with higher q value means 1): they have less intensity (like a unexpression gene, or low methylated CpG), or 2): they are low-quality, unreliable results should be discarded?**

![image](https://user-images.githubusercontent.com/2176883/126343478-a274e085-6d1f-4ffe-b0a0-a3bdd8aee89c.png)

If it's situation 1),  can I just export all peaks for all downstream analysis like differential calling .etc? I can do significance filtering manually at any stage.

I posted the same question in [BioStars](https://www.biostars.org/p/9481269/) as well.",YuanTian1991,https://github.com/macs3-project/MACS/issues/470
MDU6SXNzdWU5NjAwMzY3Nzc=,Bug: model.r file not readable in R Studio,OPEN,2021-08-04T08:09:07Z,2022-03-07T21:58:28Z,,"**Describe the bug**
I am using macs3 for peak calling in CUT&Tag data. But the output model.r files, when subjected to run using R studio, is giving error ""Error: unexpected symbol in:"".

**To Reproduce**
macs3 callpeak -f BAM -t Merged_sorted_markdup.bam -c Mock_sorted_markdup.bam -g mm -p 0.01 -n Merged --keep-dup all --outdir ./MACS3Peaks

**Expected behavior**
The model.r file is supposed to produce a pdf of data modelled. But it is giving a blank pdf.
![Screenshot from 2021-08-04 13-31-58](https://user-images.githubusercontent.com/82174846/128144895-d6e2e9b1-bf25-4112-a096-d63378343b65.png)
![Screenshot from 2021-08-04 13-32-15](https://user-images.githubusercontent.com/82174846/128144918-1e857224-8b83-4bac-a6da-1f25d310b565.png)


**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: Ubuntu
 - Python version 3.8.6
 - Numpy version 1.21.1
 - MACS Version 3.0.0a6

**Additional context**
[Merged_model.zip](https://github.com/macs3-project/MACS/files/6929643/Merged_model.zip)
",subhajit-dutta-ngs,https://github.com/macs3-project/MACS/issues/472
MDU6SXNzdWU5NjM1OTIxNjA=,Bug: ,CLOSED,2021-08-09T02:30:04Z,2021-08-11T07:52:01Z,2021-08-11T07:52:01Z,"**Describe the bug**
fermi-lite needs lib/x86/sse2.h file

**To Reproduce**
git clone https://github.com/macs3-project/MACS.git
cd MACS
python3 setup.py build

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
k-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -fPIC -I/home/lufuhao/P5820T1D2T/Programs/libraries/python_modules/lib/python3.8/site-packages/numpy/core/include -I./ -I./MACS3/fermi-lite/ -I./MACS3/Signal/ -I/usr/include/python3.8 -c MACS3/fermi-lite/htab.c -o build/temp.linux-x86_64-3.8/MACS3/fermi-lite/htab.o -w -Ofast -g0 -std=gnu99 -DUSE_SIMDE -DSIMDE_ENABLE_NATIVE_ALIASES -fopenmp-simd -DSIMDE_ENABLE_OPENMP
x86_64-linux-gnu-gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -g -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -fPIC -I/home/lufuhao/P5820T1D2T/Programs/libraries/python_modules/lib/python3.8/site-packages/numpy/core/include -I./ -I./MACS3/fermi-lite/ -I./MACS3/Signal/ -I/usr/include/python3.8 -c MACS3/fermi-lite/ksw.c -o build/temp.linux-x86_64-3.8/MACS3/fermi-lite/ksw.o -w -Ofast -g0 -std=gnu99 -DUSE_SIMDE -DSIMDE_ENABLE_NATIVE_ALIASES -fopenmp-simd -DSIMDE_ENABLE_OPENMP
MACS3/fermi-lite/ksw.c:31:10: fatal error: lib/x86/sse2.h: No such file or directory
   31 | #include ""lib/x86/sse2.h""
      |          ^~~~~~~~~~~~~~~~
compilation terminated.
error: command 'x86_64-linux-gnu-gcc' failed with exit status 1

**System (please complete the following information):**
 - OS: Ubuntu 20.04.2
 - Python version 3.8.10
 - Numpy version 1.21.1
 - MACS Version v3.0.0a6-bce60cf

**Additional context**
I guess the fermi-lite implement is not complete
",lufuhao,https://github.com/macs3-project/MACS/issues/473
MDU6SXNzdWU5NzQ5ODkxMzM=,Q: How exactly does cutoff-analysis work?,OPEN,2021-08-19T19:43:31Z,2021-08-31T19:52:47Z,,"Hi, I am using --cutoff-analysis to see where to put my p-values in combination with IDR.
I am confused, because I called peaks with default settings: 

macs2 callpeak -t ${files[@]} -f BAMPE --call-summits -g mm  -B --SPMR --outdir ./peaks/ -n testmacs --cutoff-analysis

When I look at cutoff analysis file, I see this: 
```

9.90	7.85	8170	22838154	2795.37
9.60	7.55	8334	23012621	2761.29
9.30	7.27	8655	24020243	2775.30
9.00	6.98	8991	24975334	2777.81
8.70	6.70	9329	25974511	2784.28
8.40	6.41	9749	27042216	2773.85
8.10	6.13	10163	28149912	2769.84
7.80	5.84	10562	29406424	2784.17
7.50	5.55	10765	29635006	2752.90
7.20	5.27	11255	30944376	2749.39
6.90	4.98	11822	32334821	2735.14
6.60	4.70	12361	33889368	2741.64
6.30	4.42	12917	35486336	2747.26
6.00	4.14	13521	37235498	2753.90
5.70	3.86	14110	39072368	2769.13
5.40	3.58	14803	41062556	2773.93
5.10	3.30	15623	43265761	2769.36
4.80	3.02	16470	45620369	2769.91
4.50	2.74	17372	48154532	2771.96
4.20	2.47	19321	53637710	2776.14
3.90	2.21	20500	57022628	2781.59
3.60	1.93	21886	60767021	2776.52
3.30	1.66	23239	64844893	2790.35
3.00	1.39	26275	73758160	2807.16
2.70	1.14	28250	79378821	2809.87
2.40	0.87	30249	85459624	2825.20
2.10	0.63	34883	99113222	2841.30
1.80	0.38	40607	115671821	2848.57
1.50	0.13	44369	126210817	2844.57
1.20	0.00	52441	149797749	2856.50
0.90	0.00	68738	196269644	2855.33
0.60	0.00	93683	264697132	2825.46
0.30	0.00	134088	369036298	2752.19

```
However, when I examine the number of peaks with those q-values (or p-values) by filtering the .narrowPeak file, I see many more in my .narrowPeak than the cutoff-analysis claims. Does this mean that cutoff-analysis calls a separate set of peaks for each q-cutoff described above, rather than simply thresholding the peaks?",gdolsten,https://github.com/macs3-project/MACS/issues/474
MDU6SXNzdWU5ODc3NDM1MzU=,Q: whether MACS2 could randomly select a certain number of cells in a sample to call peaks,OPEN,2021-09-03T12:54:37Z,2021-09-04T09:17:22Z,,"Hello! I'm a beginner of MACS2. I wonder whether MACS2 could randomly select a certain number of cells in a sample to call peaks? What I mean is, I have two samples, but because the difference in the number of cells between them is too large, the difference in the number of peaks is also too large. I want to know whether MACS2 has related functions that can be used for normalization. Thank you very much for your time and help.
",qimiaonnegliguo,https://github.com/macs3-project/MACS/issues/475
MDU6SXNzdWU5OTAyMDMzNTk=,Bug: ,CLOSED,2021-09-07T17:34:16Z,2021-09-07T19:05:26Z,2021-09-07T19:05:26Z,"Hello! It has been quite a while since I've lurked around the MACS github page. Thanks for continuing to maintain MACS. I would like to bring this bug to your attention. It is possible you already know about it, and have a solution.

**Describe the bug**
This bug arises on my system (`uname -a` = `Linux basecaller.ciwemb.edu 3.13.0-73-generic #116-Ubuntu SMP Fri Dec 4 15:31:30 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux`) with `MACS3` (`macs3 3.0.0a6`) installed via pip (`pip install macs3 --force-reinstall`).

The bug arises with `macs3 callpeak` only when I try to include a control (`-c control.bam`). It runs fine with no control.

```
ValueError: cannot resize this array: it does not own its data
Exception ignored in: 'MACS3.Signal.CallPeakUnit.clean_up_ndarray'
Traceback (most recent call last):
  File ""/mnt/sequence/jurban/software/conda/anaconda3/lib/python3.8/site-packages/MACS3/Commands/callpeak_cmd.py"", line 249, in run
    peakdetect.call_peaks()
ValueError: cannot resize this array: it does not own its data
ValueError: cannot resize this array: it does not own its data
Exception ignored in: 'MACS3.Signal.CallPeakUnit.clean_up_ndarray'
Traceback (most recent call last):
  File ""/mnt/sequence/jurban/software/conda/anaconda3/lib/python3.8/site-packages/MACS3/Commands/callpeak_cmd.py"", line 249, in run
    peakdetect.call_peaks()
ValueError: cannot resize this array: it does not own its data
ValueError: cannot resize this array: it does not own its data
Exception ignored in: 'MACS3.Signal.CallPeakUnit.clean_up_ndarray'
Traceback (most recent call last):
  File ""/mnt/sequence/jurban/software/conda/anaconda3/lib/python3.8/site-packages/MACS3/Commands/callpeak_cmd.py"", line 249, in run
    peakdetect.call_peaks()
ValueError: cannot resize this array: it does not own its data
```

**To Reproduce**
All of the following commands produced the error:
```
macs3 callpeak -t ${BAM} -c ${CONTROL} -g ${GSIZE} --nomodel --extsize ${EXT} --keep-dup all --outdir ${DIR5} -n ${BASE} --bdg --SPMR -q 0.01 --seed ${RSEED} --call-summits 2> ${DIR5}/${BASE}.macs3.err &

macs3 callpeak -t ${BAM} -c ${CONTROL} -g ${GSIZE} --nomodel --extsize ${EXT} --keep-dup all --outdir ${DIR6} -n ${BASE} --bdg --SPMR -q 0.01 --seed ${RSEED} 2> ${DIR6}/${BASE}.macs3.err &

macs3 callpeak -t ${BAM} -c ${CONTROL} -g ${GSIZE} --nomodel --extsize ${EXT} --keep-dup auto --outdir ${DIR7} -n ${BASE} --bdg --SPMR -q 0.001 --seed ${RSEED} 2> ${DIR7}/${BASE}.macs3.err &

macs3 callpeak -t ${BAM} -c ${CONTROL} -g ${GSIZE} --nomodel --extsize ${EXT} --keep-dup 1 --outdir ${DIR8} -n ${BASE} --bdg --SPMR -q 0.001 --seed ${RSEED} 2> ${DIR8}/${BASE}.macs3.err &
```

Simply removing `-c ${CONTROL}` from those commands allows MACS to finish just fine.

**Expected behavior**
A clear and concise description of what you expected to happen:
- expectation = finish without throwing an error haha.


**System (please complete the following information):**
 - OS: Linux
 - Python version: 3.8.5
 - Numpy version: 1.21.2
 - MACS Version: `macs3 3.0.0a6`
- `uname -a` = `Linux basecaller.ciwemb.edu 3.13.0-73-generic #116-Ubuntu SMP Fri Dec 4 15:31:30 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux`



Many thanks for any advice.
",JohnUrban,https://github.com/macs3-project/MACS/issues/476
MDU6SXNzdWU5OTEzNzQzNTQ=,Q: How can I use bdgpeakcall and other functions? ,OPEN,2021-09-08T17:36:15Z,2021-09-08T17:36:15Z,,"Hi,

Is there a manual and example data for macs3? I wonder how to use some of those functions, like ""bdgpeakcall"" etc",y-gao,https://github.com/macs3-project/MACS/issues/479
I_kwDOABXaI847YCCi,Can macs2 be used as a general peakcaller?,OPEN,2021-09-14T15:30:03Z,2021-09-14T16:50:31Z,,"Hi,

Can MACS2 be used as a peak caller on different genomic datasets like GRO-seq or PRO-seq or PRO-cap? There I just want to know where are the peaks on each strand (plus and minus) separately without any shifting. So can I use MACS2 just as a normal peakcaller for each strand bam or bedgraph file? If yes can you suggest which parameters shall I use to achieve that?

Also, will the results differ if I use bam or bedgraph as input file?

Thanks",MasterChief1O7,https://github.com/macs3-project/MACS/issues/480
I_kwDOABXaI848wQca,extending reads before macs2 has different behavior than macs2 shift plus extsizeBug: ,OPEN,2021-10-06T21:36:55Z,2021-10-07T16:27:34Z,,"**Describe the bug**
A clear and concise description of what the bug is.

**To Reproduce**
Steps to reproduce the behavior. If possible, could you share the data with us?

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: [e.g. Linux, Mac OSX]
 - Python version [e.g. 3.7.1]
 - Numpy version [e.g. 1.17.0]
 - MACS Version [e.g. 2.2.4]

**Additional context**
Add any other context about the problem here.
Hello,

Our old pipeline extended reads to the desired sizes before use with macs2 because we wanted to use the extended reads for other things as well. We have changed our pipeline and now don't make the extended reads, and instead want to do the extending in macs2. However, the numbers of peaks and peak sizes are not equal between the two methods, though peaks are highly similar. Our old approach used the below bash code to extend reads 100bp from either end of the Tn5 binding site (ATAC-seq data:

bamToBed -i  ${bam_file} \
| awk '{if($6 == ""+"") {
print $1""\t""$2+4""\t""$2+5""\t""$4""\t""$5""\t""$6} \
if($6 == ""-"") {
print $1""\t""$3-6""\t""$3-5""\t""$4""\t""$5""\t""$6}}' \
 | slopBed -l 100 -r 99 -i stdin \
-g ${chrom_sizes} \
| bedToBam -i stdin \
-g ${chrom_sizes} \
| samtools sort -o ${extended_bam}

samtools index ${extended_bam}

# macs2 doesn't like the bam file from bamToBed, but we need it for other things.
# So convert to bed for macs:
bamToBed -i ${extended_bam} > ${extended_bed}


We would then run macs2 with the below options:
# Note, --keep-dup all was used because picard was previously used to remove duplicates in paired-end mode
macs2 callpeak -t ${extended_bed} \
-g hs -q 0.05 --nomodel \
--keep-dup all

So in the above command we don't use --shift -100 --extsize 200 because the this extension was already performed. The above produced 142,318 peaks.

 However, now we run macs2 on a bed file produced from a bam file without extending. We convert to bed because we want to use both ends of the ATAC-seq fragments because they represent separate cut events:
bamToBed -i ${bam_file} > ${bed_file}

macs2 callpeak -t ${bed_file} \
-g hs -q 0.05 --nomodel --shift -100 --extsize 200 \
--keep-dup all

The above command produced 133,521 peaks, which is around 9,000 less. However, it appears that this second set of peaks contains larger peaks that sometimes overlap multiple of the peaks in the old command because almost all of the peaks in the first set (141,659 of 142,318) overlap the peaks in the second set. Consistent with this, the peaks in the first set are on average larger, with median size of 447 bp compared to a median of 381 bp for the second peak set. 

Do you have any suggestions for what could be causing this difference? 

Thanks,

Kevin",kwcurrin,https://github.com/macs3-project/MACS/issues/481
I_kwDOABXaI849vedq,Q:how should I process a chip-seq data that each sample with a input by macs2,OPEN,2021-10-26T05:30:35Z,2021-11-05T21:45:24Z,,"**Use case**
 input_control, chip_control, input_sample1, chip_sample1, input_sample2,  chip_sample2, input_sample3, chip_sample3

**Describe the problem**
I have a ChIP-seq data, four samples that each with a input data, just like above.

**Describe the solution you tried**
And I want to estimate ChIP-seq background noise and normalize the ChIP data on the same level. If there is only one input, I can use deeptools Bamcompare to normalize. However, this data have four input files and a ChIP control, it really makes me confused and I don't konw how to process this data. Anyone can give me some advice? Thank you very much.

",ryrl9703,https://github.com/macs3-project/MACS/issues/483
I_kwDOABXaI8492dpT,Bug: Advanced Usage page is missing,OPEN,2021-10-27T17:39:11Z,2022-11-17T10:58:52Z,,The advanced usage page listed in the docs is not found: https://github.com/macs3-project/MACS/blob/master/docs/advanced_usage.md ,bhanratt,https://github.com/macs3-project/MACS/issues/485
I_kwDOABXaI849_uDh,Bug: Question about the -f parameter,OPEN,2021-10-30T10:48:52Z,2024-08-12T18:13:12Z,,"dear professor

when i run macs2[2.2.7.1], ATACdata of O.sativa, i tried different commands. and the result shows very big difference

```
COMMAND1: i used processed bam file as input, and set the -f BAM
```

```
macs2 callpeak -t  sample.bowtie2.rmdup.uniq.bam \
-n sample --shift -100 --extsize 200 --nomodel -B --SPMR \
-f BAM -g 3.6e8 --outdir macs2_peak/ \
--keep-dup all -q 0.05
```
```
wc -l *narrowPeak
   9859 sample1-1_peaks.narrowPeak
   3655 sample1-2_peaks.narrowPeak
   7481 sample2-1_peaks.narrowPeak
  10243 sample2-2_peaks.narrowPeak
  10271 sample3-1_peaks.narrowPeak
   6735 sample3-2_peaks.narrowPeak
   7680 sample4-1_peaks.narrowPeak
   5309 sample4-2_peaks.narrowPeak
   7569 sample5-1_peaks.narrowPeak
   5052 sample5-2_peaks.narrowPeak
   6135 sample6-1_peaks.narrowPeak
   3538 sample6-2_peaks.narrowPeak
   5079 sample7-1_peaks.narrowPeak
   4228 sample7-2_peaks.narrowPeak
   7097 sample8-1_peaks.narrowPeak
   9641 sample8-2-2_peaks.narrowPeak
   6967 sample8-2_peaks.narrowPeak
   5802 sample9-1_peaks.narrowPeak
   6108 sample9-2_peaks.narrowPeak
```

```
COMMAND2: i used processed bam's bed file as input(generated by bedtools), and set the -f AUTO
```

```
macs2 callpeak -t  sample.bowtie2.rmdup.uniq.bam.bedtools.bed \
-n sample --shift -100 --extsize 200 --nomodel -B --SPMR \
-g 3.6e8 --keep-dup all -q --outdir macs2_peak/
```
```
wc -l *narrowPeak
   26326 sample1-1_peaks.narrowPeak
   26912 sample1-2_peaks.narrowPeak
   25170 sample2-1_peaks.narrowPeak
   37342 sample2-2_peaks.narrowPeak
   29962 sample3-1_peaks.narrowPeak
   27257 sample3-2_peaks.narrowPeak
   27043 sample4-1_peaks.narrowPeak
   26673 sample4-2_peaks.narrowPeak
   26177 sample5-1_peaks.narrowPeak
   30028 sample5-2_peaks.narrowPeak
   31005 sample6-1_peaks.narrowPeak
   18296 sample6-2_peaks.narrowPeak
   35879 sample7-1_peaks.narrowPeak
   35805 sample7-2_peaks.narrowPeak
   30060 sample8-1_peaks.narrowPeak
   17175 sample8-2-2_peaks.narrowPeak
   23912 sample8-2_peaks.narrowPeak
   32167 sample9-1_peaks.narrowPeak
   30430 sample9-2_peaks.narrowPeak
```

when i read the -f parameter, it tells me that ""please note that if the format is
set as BAMPE or BEDPE, MACS2 will call its special Paired-end mode to call peaks by piling up the actual ChIPed
fragments defined by both aligned ends, instead of predicting the fragment size first and extending reads"".

 it seems that the --shift and --extsize argument are ignored in BAMPE/BEDPE mode. They do work in the default (BAM) mode[MY COMMAND1], but then, with paired-end reads,  **most of the alignments are automatically discarded??**

so when i use the bed file generated by the bam file[MY COMMAND2], it use more reads than COMMAND1?

I checked my data, for example sample9-2

sample9-2.bowtie2.rmdup.uniq.bam.stat(samtools flagstat):

71286716 + 0 in total (QC-passed reads + QC-failed reads)
63250204 + 0 secondary
0 + 0 supplementary
0 + 0 duplicates
71286716 + 0 mapped (100.00% : N/A)
8036512 + 0 paired in sequencing
4018256 + 0 read1
4018256 + 0 read2
8036512 + 0 properly paired (100.00% : N/A)
8036512 + 0 with itself and mate mapped
0 + 0 singletons (0.00% : N/A)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)

it seems only a small part of reads are paired in sequencing?

Could you give me some advice for my data processing?

thank you very much

best wishes

Wang
",wangc1106,https://github.com/macs3-project/MACS/issues/486
I_kwDOABXaI84-Cx7Q,Bug: the wrong peak called by macs2,OPEN,2021-11-01T08:37:27Z,2021-11-08T02:38:24Z,,"Hi:
 I used the MACS2 to deal with the ATAC-seq. The command was `macs2 callpeak -t /Sh4-1.chr_filt_dedup_sortbyname_fixed_tn5.bedpe -f BEDPE -n Sh4-1 -g hs --outdir ./ -B --keep-dup all --call-summits`

The output of Sh4-1_peaks.narrowPeak contains: chr19	41714971	41721180	test_Sh4-1_peak_12088	4605	.	8.66483	464.632	460.565	3281
But the bw shown in IGV:
![image](https://user-images.githubusercontent.com/66869156/139644537-03188d74-f4a5-4708-9011-6068bff78ea2.png)
It seems that there were multiple peaks rather that one peak.
What is wrong? Please help me.
 Thank you",ZHIDIHUAYUAN,https://github.com/macs3-project/MACS/issues/487
I_kwDOABXaI84-EJQa,Q: mac2 callpeak divide by zero error for redundant rate of treatment calculation,OPEN,2021-11-01T15:03:51Z,2021-11-05T21:24:14Z,,"**Use case**

I am trying to run `macs2 callpeak` 2.2.7.1 using a ChIP-seq alignment produced by `bwa mem` 0.7.17. The alignment has been sorted with `samtools sort`. As far as the alignment goes, `samtools stats` reports:

    SN      raw total sequences:    1385028 # excluding supplementary and secondary reads
    SN      filtered sequences:     0
    SN      sequences:      1385028
    SN      is sorted:      1
    SN      1st fragments:  692514
    SN      last fragments: 692514
    SN      reads mapped:   866791
    SN      reads mapped and paired:        749976  # paired-end technology bit set + both mates mapped
    SN      reads unmapped: 518237
    SN      reads properly paired:  0       # proper-pair bit set
    SN      reads paired:   1385028 # paired-end technology bit set
    SN      reads duplicated:       0       # PCR or optical duplicate bit set
    SN      reads MQ0:      460530  # mapped and MQ=0
    SN      reads QC failed:        0
    SN      non-primary alignments: 0


**Describe the problem**

I'm getting a Divide by zero error in `macs2 callpeak` related to the redundant rate of treatment.

**Describe the solution you tried**

From the `macs2 callpeak` output:

    INFO  @ Mon, 01 Nov 2021 14:42:38:
    # Command line: callpeak --format=BAM --nomodel --extsize=300 --treatment=/opt/data/chipseq/aligns-with- 
    bwa/AN3740008-paired-sorted.bam --gsize=2134628047 --outdir=results --name=AN3740008-paired-sorted
    # ARGUMENTS LIST:
    # name = AN3740008-paired-sorted
    # format = BAM
    # ChIP-seq file = ['/opt/data/chipseq/aligns-with-bwa/AN3740008-paired-sorted.bam']
    # control file = None
    # effective genome size = 2.13e+09
    # band width = 300
    # model fold = [5, 50]
    # qvalue cutoff = 5.00e-02
    # The maximum gap between significant sites is assigned as the read length/tag size.
    # The minimum length of peaks is assigned as the predicted fragment length ""d"".
    # Larger dataset will be scaled towards smaller dataset.
    # Range for calculating regional lambda is: 10000 bps
    # Broad region calling is off
    # Paired-End mode is off

    INFO  @ Mon, 01 Nov 2021 14:42:38: #1 read tag files...
    INFO  @ Mon, 01 Nov 2021 14:42:38: #1 read treatment tags...
    INFO  @ Mon, 01 Nov 2021 14:42:41: 0 reads have been read.
    INFO  @ Mon, 01 Nov 2021 14:42:41: #1 tag size is determined as 137 bps
    INFO  @ Mon, 01 Nov 2021 14:42:41: #1 tag size = 137.0
    INFO  @ Mon, 01 Nov 2021 14:42:41: #1  total tags in treatment: 0
    INFO  @ Mon, 01 Nov 2021 14:42:41: #1 user defined the maximum tags...
    INFO  @ Mon, 01 Nov 2021 14:42:41: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s)
    INFO  @ Mon, 01 Nov 2021 14:42:41: #1  tags after filtering in treatment: 0
    Traceback (most recent call last):
      File ""/home/ubuntu/miniconda3/envs/bio-hichip-env/bin/macs2"", line 653, in <module>
      main()
      File ""/home/ubuntu/miniconda3/envs/bio-hichip-env/bin/macs2"", line 51, in main
      run( args )
      File ""/home/ubuntu/miniconda3/envs/bio-hichip-env/lib/python3.9/site-packages/MACS2/callpeak_cmd.py"", line 
      104, in run
      info(""#1  Redundant rate of treatment: %.2f"", float(t0 - t1) / t0)
      ZeroDivisionError: float division by zero


**Additional context**

This error is reported when using `bwa mem` alignments. When using `bowtie2` alignments, no problem.",crowja,https://github.com/macs3-project/MACS/issues/488
I_kwDOABXaI84-6Bp7,Q: bdgpeakcall usage on input normalized chip data.,OPEN,2021-11-16T21:54:11Z,2022-10-14T08:26:52Z,,"**Use case**
We are trying to use input normalized chip data to call peaks.
I see that probably the 'proper' way to do this is to simply use callpeak function with chip and input bam files, but we want to use specific feature of deeptools bamCompare function (MAPQ threshold and blacklist region) before calling peaks.
I have the following questions:
1. Is this a valid way to call peaks? if not, what else can I try
2. Assuming this practice is valid.. is the bdgpeakcalls CUTOFF option no longer a 'statistical threshold' since its simply calling peaks based on the 4th column of my input bedgraph? Basically, if bdgpeakcall is used to call peaks on bedgraph, is there still a 'model-based' calling of peaks?
3. If we decide to simply use callpeak function using chip and input bam files, is there a way to specify MAPQ threshold? or does callpeak simply use all reads (ie MAPQ >=0).

Thank you,
Jun
",kimj50,https://github.com/macs3-project/MACS/issues/489
I_kwDOABXaI84_TvB6,Q: minimum thresh hold for peakcalling,OPEN,2021-11-24T08:30:47Z,2021-11-24T08:38:01Z,,"**Use case**
I'm trying to find no-peak detected regions in the genome for several histone modifications.
my sample contains Input, H3K4me1, H3K4me3, H3K9me3, H3K27ac, H3K27me3, H3K36me.

I want to figure out no histone-marked regions in the genome. In this case, the threshold of macs callpeak should be as low as possible so I can detect and avoid any peaks from both narrow and broad peaks in searching histone mark-free region. 

**Describe the problem**
To get as many peaks as possible, I think I should adjust the mfold and q-value. However, I am not sure what is acceptable range of mfold and q-value to detect any single peaks without considering false-positive peaks. What would be the parameter to detect any potential peaks independent of false-positive peaks? (detection of false-positive peaks is no problem)

**Describe the solution you tried**
If I run macs2 callpeak with default parameter settings, about 50,000 ~ 150,000 peaks were detected for histone modification, which is too small to filtering histone mark-free region.

Many thanks in advance.",k-chansik,https://github.com/macs3-project/MACS/issues/490
I_kwDOABXaI84_xnTq,Bug: ModuleNotFoundError: No module named 'cykhash.khashsets',CLOSED,2021-12-02T20:51:48Z,2021-12-03T13:21:25Z,2021-12-03T13:21:25Z,"**Describe the bug**
Hi! I installed Macs3 following this post : https://github.com/macs3-project/MACS/issues/459 (because I could not install it any other way...) : 

```
conda create -n macs3
source activate macs3


conda install -n macs3 -c conda-forge python cykhash numpy cython \
pytest pytest-cov codecov setuptools \
gcc_linux-64 gxx_linux-64

# which pip
# pip install python-dev-tools   # may not need this 

# the key is gcc,
# the base gcc in the server not match my macs3 env,
# so install a new one in conda env,
# but the default bin name is x86_64-conda_cos-linux-gnu-gcc,
# need to build a soft link
ln -s ${conda_dir}/envs/macs3/bin/x86_64-***-linux-gnu-gcc ${conda_dir}/envs/macs3/bin/gcc

# then the main installation worked
pip install macs3

macs3 --help
```
Then I ran : `macs3 callpeak -t CNVR15.R1.filtered02.bam -c CNVR11.R1.filtered02.bam -g dm -n DmGoth10.1_Cont1-K4`
And I get an error based on the cykhash dependency:

```
Traceback (most recent call last):
  File ""/home/data/rrebollo/miniconda2/envs/macs3/bin/macs3"", line 727, in <module>
    main()
  File ""/home/data/rrebollo/miniconda2/envs/macs3/bin/macs3"", line 47, in main
    from MACS3.Commands.callpeak_cmd import run
  File ""/home/data/rrebollo/miniconda2/envs/macs3/lib/python3.9/site-packages/MACS3/Commands/callpeak_cmd.py"", line 24, in <module>
    from MACS3.Utilities.OptValidator import opt_validate_callpeak
  File ""/home/data/rrebollo/miniconda2/envs/macs3/lib/python3.9/site-packages/MACS3/Utilities/OptValidator.py"", line 24, in <module>
    from MACS3.IO.Parser import BEDParser, ELANDResultParser, ELANDMultiParser, \
  File ""MACS3/IO/Parser.pyx"", line 30, in init MACS3.IO.Parser
  File ""MACS3/Signal/FixWidthTrack.pyx"", line 28, in init MACS3.Signal.FixWidthTrack
  File ""MACS3/Signal/Pileup.pyx"", line 23, in init MACS3.Signal.Pileup
  File ""MACS3/Signal/BedGraph.pyx"", line 23, in init MACS3.Signal.BedGraph
  File ""MACS3/Signal/ScoreTrack.pyx"", line 34, in init MACS3.Signal.ScoreTrack
  File ""/home/data/rrebollo/.local/lib/python3.7/site-packages/cykhash/__init__.py"", line 3, in <module>
    from .khashsets import *
ModuleNotFoundError: No module named 'cykhash.khashsets'
```

**System (please complete the following information):**
 - OS: [e.g. Linux, Mac OSX] : Linux
 - Python version [e.g. 3.7.1] : 3.9.7
 - Numpy version [e.g. 1.17.0] : 1.21.4
 - MACS Version [e.g. 2.2.4] : 3.0.0a6


**Additional context**
Sorry, I am a beginner so I'm sure the errors comes from the installation of cyckhash but I don't get how to fix it...
",RRebo,https://github.com/macs3-project/MACS/issues/491
I_kwDOABXaI85AMVPj,Q: What is the relationship between the value of the bigwig file generated by macs2 bdgcmp  and the read count?,OPEN,2021-12-10T15:38:34Z,2022-01-07T19:55:01Z,,"Hello, the bdg file generated by `bdgcmp ` can convert into a bigwig file, for a particular region, what is the relationship between the signal values I get with bigwig and the reads count I get with the bam file ? `bdgcmp -m` can be set to `ppois `or `FE `etc, what is the difference between them ?
Thank you very much!",User-yx,https://github.com/macs3-project/MACS/issues/494
I_kwDOABXaI85BDoJt,Simultaneously have mock and input samples,OPEN,2021-12-31T08:15:06Z,2021-12-31T08:15:06Z,,"I have both mock and input samples, how do I choose control samples? Whether to choose both, mock or input?",showteeth,https://github.com/macs3-project/MACS/issues/495
I_kwDOABXaI85BPFVP,paired-end MeRIP-seq,OPEN,2022-01-05T15:28:04Z,2023-03-31T11:28:38Z,,"Hello,
I have paired-end MeRIP-seq and input RNA-seq. the input files are bam files generated by Hisat2. When I ran MACS3 with -f BAM, it works. However, when setting -f to BAMPE, I got the following errors:
INFO @ Wed, 05 Jan 2022 08:14:44: #3 Call peaks...
Traceback (most recent call last):
File ""/macs3"", line 727, in
main()
File ""/macs3"", line 48, in main
run( args )
File ""/MACS3/Commands/callpeak_cmd.py"", line 249, in
run
peakdetect.call_peaks()
File ""MACS3/Signal/PeakDetect.pyx"", line 112, in MACS3.Signal.PeakDetect.PeakDetect.call_peaks
File ""MACS3/Signal/PeakDetect.pyx"", line 184, in MACS3.Signal.PeakDetect.PeakDetect.__call_peaks_w_control
AssertionError: 1000 can't be smaller than 2024.6768798828125!

Does it mean that MACS3 analyzes paired-end MeRIP-seq using -f BAM?
Best

**Additional context**
Add any other context or screenshots about your use case here.
",BenxiaHu,https://github.com/macs3-project/MACS/issues/496
I_kwDOABXaI85B56ps,Feat: Support for Python 3.10,CLOSED,2022-01-17T10:59:15Z,2022-02-18T18:11:35Z,2022-02-18T18:11:35Z,"
Hello, I've problems installing MACS using the latest python version, 3.10.1  As I am maintaining a production environment, I cannot downgrade the python version to 3.8 (which is 2 years old)

Please include support for this version :)

Many thanks 
",dgalligani,https://github.com/macs3-project/MACS/issues/498
I_kwDOABXaI85C0q76,Bug: variable overflow in peak column of narrowPeak file,OPEN,2022-02-01T19:19:54Z,2022-02-08T19:31:18Z,,"**Describe the bug**
Hi, 
for some reason we are getting negative values in the peak column of the narrowPeak file from our data (see image attached). This is probably due to the size of our chromosomes (32 gbp genome) and smells to me like a variable overflow when computing the peak summits.

**To Reproduce**
macs3 callpeak -f BAMPE -t ${dedupBAM} -g 2.0e10 -n \${name} -B --SPMR --seed 23 -q 0.01 --call-summits --keep-dup all

**Expected behavior**
I believe these are supposed to be positive values.

**Screenshots**
<img width=""932"" alt=""Screenshot 2022-02-01 at 20 11 22"" src=""https://user-images.githubusercontent.com/80003172/152035460-f78b9fae-ecd3-4d5d-af9e-a33cf4907ed9.png"">

**System (please complete the following information):**
Linux, macs3a6

",diego-rt,https://github.com/macs3-project/MACS/issues/500
I_kwDOABXaI85D8em6,Bug: Header line not written in _peaks.xls file if no peaks were called,CLOSED,2022-02-16T12:07:14Z,2022-02-18T18:11:59Z,2022-02-18T18:11:59Z,"**Describe the bug**
The header line with column names is not written in `_peaks.xls` file if no peaks were called. Versions affected: all Macs2 and Macs3 versions.

**To Reproduce**
Call Macs2 with an IP without peaks. For instance, these few reads in a bed file would serve as a toy example:
```
chr10   3100266 3100350 NB501946:635:H3WHKBGXK:3:21511:6327:15393       39      +
chr10   3100915 3100999 NB501946:635:H3WHKBGXK:3:22512:18744:5628       35      -
chr10   3101455 3101539 NB501946:635:H3WHKBGXK:1:21208:4927:4483        31      +
chr10   3101663 3101747 NB501946:635:H3WHKBGXK:1:11204:25019:20096      31      +
chr10   3101866 3101950 NB501946:635:H3WHKBGXK:4:12501:22081:19925      32      -
chr10   3101926 3102010 NB501946:635:H3WHKBGXK:2:21206:20225:15364      42      -
chr10   3102007 3102091 NB501946:635:H3WHKBGXK:2:21204:14450:2582       34      -
chr10   3102451 3102535 NB501946:635:H3WHKBGXK:1:23305:10256:9175       38      -
chr10   3102649 3102733 NB501946:635:H3WHKBGXK:4:12603:8801:16638       34      +
chr10   3102673 3102757 NB501946:635:H3WHKBGXK:1:22311:17619:14120      6       -
```
If the reads are saved in a file called `x.bed`, then the following call to Macs2 will produce the XLS file without the header:

```
macs2 callpeak -t x.bed -c x.bed -n z -g hs --bw 200 --keep-dup auto --nomodel --extsize 147
```
The `z_peaks.xls` file would look like:
```
$ cat z_peaks.xls 
# This file is generated by MACS version 2.2.6
# Command line: callpeak -t x.bed -c x.bed -n z -g hs --bw 200 --keep-dup auto --nomodel --extsize 147
# ARGUMENTS LIST:
# name = z
# format = AUTO
# ChIP-seq file = ['ip.bed']
# control file = ['ip.bed']
# effective genome size = 2.70e+09
# band width = 200
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off

# tag size is determined as 84 bps
# total tags in treatment: 10
# tags after filtering in treatment: 2
# maximum duplicate tags at the same position in treatment = 0
# Redundant rate in treatment: 0.80
# total tags in control: 10
# tags after filtering in control: 2
# maximum duplicate tags at the same position in control = 0
# Redundant rate in control: 0.80
# d = 147
```
Missing the last line with the header.

**Expected behavior**
The header line with the field names should be always present.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: Linux
 - Python version: 3.8.5
 - Numpy version: 1.17.0
 - MACS Version: 2.2.6 (but other versions including Macs3 are also affected)

**Additional context**
The issue seems to be in the `PeakIO.pyx` file, in the method `_to_xls` that handles XLS output for the class PeakIO.
The method that actually runs is the following:
```
 218     # these methods are very fast, specifying types is unnecessary 
 219     def write_to_xls (self, fhd, bytes name_prefix=b""%s_peak_"", bytes name=b""MACS""):
 220         return self._to_xls(name_prefix=name_prefix, name=name,
 221                             print_func=fhd.write)
 222
 223     cdef _to_xls (self, bytes name_prefix=b""%s_peak_"", bytes name=b""MACS"", print_func=sys.stdout.write):
 224
 225         if self.peaks:
 226             print_func(""\t"".join((""chr"",""start"", ""end"",  ""length"",  ""abs_summit"", ""pileup"", ""-log10(pvalue)"", ""fold_enrichment"", ""-log10(qvalue)"", ""name""))+""\n"")
 227         else:
 228             return
...
```
Specifically, the `if` in line 225 will skip the header if no peaks were called.
This overrides a second method definition with exactly the same name for this class (which would actually always write a header):
```
 499     def write_to_xls (self, ofhd, bytes name_prefix = b""%s_peak_"", bytes name = b""MACS""): 
 500         """"""Save the peak results in a tab-delimited plain text file
 501         with suffix .xls.
 502
 503
 504         wait... why I have two write_to_xls in this class?
 505
 506         """"""
 507         write = ofhd.write
 508         write(""\t"".join((""chr"",""start"", ""end"",  ""length"",  ""abs_summit"", ""pileup"", ""-log10(pvalue)"", ""fold_enrichment"", ""-log10(qvalue)"", ""name""))+""\n"")
...
```
Looks like there's no reason to have a second `write_to_xls` method in the class ;-)

Also, this doesn't apply when calling Macs2 in `--broad` mode. There's a separate class to handle BroadPeakIO which properly handles the case. ",ssayols,https://github.com/macs3-project/MACS/issues/501
I_kwDOABXaI85FAenk,Q: Reproducibility of MACS3 on the same sample,CLOSED,2022-03-02T22:22:06Z,2022-03-10T00:35:16Z,2022-03-10T00:34:48Z,"I tried to run MACS3 on the same input bam file and get slightly different peak lists. The difference is pretty minor but I am curious if MACS3 is designed to reproduce the same output every time. Or there is some randomness and the peaks may be slightly different every time. 

I tried to search issues or online but cannot find a clear answer. Most people seem to care more about reprowducilty between biological replicates.


",yjqiu,https://github.com/macs3-project/MACS/issues/503
I_kwDOABXaI85FeN6n,Q: Fold-Change values are always > 1,OPEN,2022-03-10T18:02:41Z,2022-03-10T18:02:41Z,,"I am running MACS3 on some ATACseq data collected from T cells treated with shRNAmir's for various genes. 

I'm supplying multiple control and treatment files, and use the ```callpeaks``` command to generate .narrowpeak files. However, I am noticing that the fold-changes are always > 1.00 

Does this mean that ```callpeaks``` only considers peaks that are upregulated in treatment compared to sample? One would expect that downregulated peaks are also considered, and these peaks would show up with a fold change <1.00

It may also be possible that I have peaks that are downregulated, but they do not make it past the p-value cutoff I have set (0.01). 
Thanks!
",dapluggg,https://github.com/macs3-project/MACS/issues/504
I_kwDOABXaI85Gd9mQ,bedGraphToBigWig: error while loading shared libraries: libssl.so.1.0.0: cannot open shared object file: No such file or directory,CLOSED,2022-03-27T02:12:58Z,2022-04-15T21:31:03Z,2022-04-15T21:31:03Z,"**Describe the bug**
Hello MACS3,
I'm trying to convert bedGraph to bigWig (which is generated by MACS3). I followed your tutorial here (https://gist.github.com/taoliu/2469050).
However, I met errors `bedGraphToBigWig: error while loading shared libraries: libssl.so.1.0.0: cannot open shared object file: No such file or directory`.
I tried below coding, but openssl is upgraded to v1.1.1f and error was not solved. I found that Unbuntu20.04 has droped the installation of openssl v1.0.0.
```python
sudo apt-get update -y
sudo apt-get install -y libssl-dev
sudo ln -s libssl.so.1.1.1f libssl.so.1.0.0
sudo ln -s libcrypto.so.1.1.1f libcrypto.so.1.0.0
```
Also tried all solutions here (https://askubuntu.com/questions/1261614/ubuntu-20-04-libssl-so-1-0-0-cannot-open-shared-object-file-no-such-file-or-d). Didn't work.

Appreciate it if you could help me with this issue.
Thanks!
Best,
YJ

**To Reproduce**
```python
conda install -c bioconda ucsc-bedclip
conda install -c bioconda ucsc-bedgraphtobigwig
bedtools slop -i /home/hyjforesight/MACS3_outputs/Cracd_KO1_treat_pileup.bdg -g /home/hyjforesight/mm10_chromInfo.txt -b 0 | bedClip stdin /home/hyjforesight/mm10_chromInfo.txt /home/hyjforesight/bigWig/Cracd_KO1_treat_pileup_clip.bdg    # clip bedGraph generated by MACS2
LC_ALL=C sort -k1,1 -k2,2n /home/hyjforesight/bigWig/Cracd_KO1_treat_pileup_clip.bdg > /home/hyjforesight/bigWig/Cracd_KO1_treat_pileup_clip_sorted.bdg    # sort
bedGraphToBigWig /home/hyjforesight/bigWig/Cracd_KO1_treat_pileup_clip_sorted.bdg /home/hyjforesight/mm10_chromInfo.txt /home/hyjforesight/bigWig/Cracd_KO1_treat_pileup_clip_sorted.bw
bedGraphToBigWig: error while loading shared libraries: libssl.so.1.0.0: cannot open shared object file: No such file or directory
```

**Expected behavior**
should generate bigWig smoothly

**Screenshots**
![image](https://user-images.githubusercontent.com/75048821/160263701-31365508-b725-4d82-9539-52195171c2ba.png)

**System (please complete the following information):**
 - OS: [Ubuntu 20.04]
 - MACS Version [3.0.0a7]

**Additional context**
Add any other context about the problem here.
",hyjforesight,https://github.com/macs3-project/MACS/issues/505
I_kwDOABXaI85G1RK-,broken link in readme,CLOSED,2022-03-31T16:51:52Z,2024-02-20T15:01:48Z,2024-02-20T15:01:48Z,"Just want to point out the link to [https://github.com/macs3-project/MACS/blob/master/docs/advanced_usage.md](https://github.com/macs3-project/MACS/blob/master/docs/advanced_usage.md) is broken.
It is the ""advanced usage"" link below subcommand table in readme.
![image](https://user-images.githubusercontent.com/20069067/161108441-5a633948-9af8-42cf-ac59-722bfce49b86.png)

Also, how can I find the advanced usage information?
Thanks!",olechnwin,https://github.com/macs3-project/MACS/issues/506
I_kwDOABXaI85ILwX9,Bug: installation in conda env fails to find zlib.h &  zconf.h,OPEN,2022-04-21T13:23:10Z,2022-04-21T13:23:10Z,,"**Describe the bug**


installation of macs3 inside of the conda environment fails because of ""missing"" zlib.h and then zconf.h

```
MACS3/fermi-lite/bseq.c:1:10: fatal error: zlib.h: No such file or directory
    1 | #include <zlib.h>
```
and:

```
/some/path/.conda/envs/macs3/include/python3.8/zlib.h:34:10: fatal error: zconf.h: No such file or directory
   34 | #include ""zconf.h""
``` 
(this one after creating the first soft link, see below)

The above errors did occur during running:
```
 python setup.py install --prefix /some/path/soft
```
In a directory created after unpacking 
```
https://files.pythonhosted.org/packages/f9/72/d1a7578f0888b1e07823d33d564c316e5af1be79466e120028b41a37b0ce/MACS3-3.0.0a7.tar.gz
```

This is due to:  
```
-I/some/path/.conda/envs/macs3/include/python3.8
```

To semi-resolve it I did:

```
cd /some/path/.conda/envs/macs3/include/python3.8/
ln -s ../zlib.h .
ln -s ../zconf.h .
```

but I think it should be fixed upstream, so  ```/some/path/.conda/envs/macs3/include/``` is included. 

Hope it helps

Darek Kedra

PS I am on Centos 7 inside of the conda env with the following packages:
```
# Name                    Version                   Build  Channel
_libgcc_mutex             0.1                 conda_forge    conda-forge
_openmp_mutex             4.5                      1_llvm    conda-forge
asttokens                 2.0.5              pyhd8ed1ab_0    conda-forge
binutils_impl_linux-64    2.36.1               h193b22a_2    conda-forge
blas                      2.3                    openblas    conda-forge
ca-certificates           2020.10.14                    0    anaconda
certifi                   2020.6.20                py38_0    anaconda
cykhash                   2.0.0            py38hfa26641_1    conda-forge
cython                    0.29.28          py38hfa26641_2    conda-forge
executing                 0.8.3              pyhd8ed1ab_0    conda-forge
gcc                       11.2.0               h702ea55_9    conda-forge
gcc_impl_linux-64         11.2.0              h82a94d6_15    conda-forge
kernel-headers_linux-64   2.6.32              he073ed8_15    conda-forge
ld_impl_linux-64          2.36.1               hea4e1c9_2    conda-forge
libblas                   3.9.0                3_openblas    conda-forge
libcblas                  3.9.0                3_openblas    conda-forge
libedit                   3.1.20191231         h14c3975_1    anaconda
libffi                    3.3                  he6710b0_2    anaconda
libgcc-devel_linux-64     11.2.0              h0952999_15    conda-forge
libgcc-ng                 11.2.0              h1d223b6_15    conda-forge
libgfortran-ng            7.5.0               h14aa051_20    conda-forge
libgfortran4              7.5.0               h14aa051_20    conda-forge
libgomp                   11.2.0              h1d223b6_15    conda-forge
liblapack                 3.9.0                3_openblas    conda-forge
liblapacke                3.9.0                3_openblas    conda-forge
libopenblas               0.3.12          pthreads_hb3c22a3_1    conda-forge
libsanitizer              11.2.0              he4da1e4_15    conda-forge
libstdcxx-ng              11.2.0              he4da1e4_15    conda-forge
libzlib                   1.2.11            h36c2ea0_1013    conda-forge
llvm-openmp               13.0.1               he0ac6c6_1    conda-forge
ncurses                   6.2                  he6710b0_1    anaconda
numpy                     1.19.1           py38h30dfecb_0    anaconda
numpy-base                1.19.1           py38h75fe3a5_0    anaconda
openssl                   1.1.1h               h7b6447c_0    anaconda
pip                       20.2.4                   py38_0    anaconda
python                    3.8.5                h7579374_1    anaconda
python-devtools           0.8.0              pyhd8ed1ab_0    conda-forge
python_abi                3.8                      2_cp38    conda-forge
readline                  8.0                  h7b6447c_0    anaconda
setuptools                50.3.0           py38hb0f4dca_1    anaconda
six                       1.16.0             pyh6c4a22f_0    conda-forge
sqlite                    3.33.0               h62c20be_0    anaconda
sysroot_linux-64          2.12                he073ed8_15    conda-forge
tk                        8.6.10               hbc83047_0    anaconda
wheel                     0.35.1                     py_0    anaconda
xz                        5.2.5                h7b6447c_0    anaconda
zlib                      1.2.11            h36c2ea0_1013    conda-forge

```
",darked89,https://github.com/macs3-project/MACS/issues/507
I_kwDOABXaI85JB39e,Q: calculating the genome size needed for the MACS --gsize option,OPEN,2022-05-04T11:12:17Z,2022-06-08T08:53:27Z,,"Hi,

I had a query about calculating the genome size needed for the MACS --gsize option.


**Use case**
I shall be using genomes not listed in your documentation and so need to calculate the genome size values myself.  

To check I can do this correctly, I tried to get the same values for human and mouse as reported in your documentation (https://macs3-project.github.io/MACS/docs/callpeak.html).


**Describe the problem**
To perform the calculation, I ran the script unique-kmers.py as described at:
https://deeptools.readthedocs.io/en/develop/content/feature/effectiveGenomeSize.html

My results for human38 (assuming k-mers of 100-bp) were similar to that reported in the MACS documentation: 2.8e9 vs 2.7e9 respectively.

However, the results for mouse38 were substantially different: 2.47e9 (my calculation) vs 1.87e9 (MACS documentation).

(As might be expected, my calculations agree with those displayed on https://deeptools.readthedocs.io/en/develop/content/feature/effectiveGenomeSize.html for 100-bp kmers.)


Sorry if I am being naive or have overlooked something obvious, but I was wondering if I should be calculating the effective genomes size in a different way? Do you recommend a particular tool to perform this calculation?

Any helpful feedback would be much appreciated.

Best regards,
Steven",StevenWingett,https://github.com/macs3-project/MACS/issues/508
I_kwDOABXaI85JoiyC,"Q: Same parameters,but different peaks number",OPEN,2022-05-13T15:07:53Z,2022-05-21T14:11:10Z,,"Hi @taoliu ,
   
**Describe the problem**
 ```callpeak --nomodel -f BAMPE --keep-dup 1 -q 0.05 -B --SPMR -t TF.bam -c IgG.bam -n TF``` 
generate TF.narrowPeak files contain 6 rows.
```callpeak --nomodel -f BAMPE --keep-dup 1 -q 0.05 -B --SPMR -t TF.bam -n TFwithoutIgG```
generate TFwithoutIgG.narrowPeak files contain 6067 rows.

It's a strange things that two narrowPeak files have a such big difference.

**Describe the solution you tried**

Using IGV to find why,but still confusing!
The narrowPeak without IgG.bam Input have a peak,but the narrowPeak with IgG.bam Input doesn't have this peak.

![igv png](https://user-images.githubusercontent.com/62577709/168313131-d86e6902-1f81-4865-8ee2-433bd213f93c.JPG)

Thanks in advanced! 

",zhangpicb,https://github.com/macs3-project/MACS/issues/509
I_kwDOABXaI85J-3Hy,Q: custom normalization between samples?,OPEN,2022-05-19T05:11:34Z,2022-06-10T20:04:53Z,,"**Use case**
I have a series of ChIP-seq samples that I eventually want to perform differential peak calling and motif enrichment analysis upon between different treatment groups (and input).   

**Describe the problem**
I would like to use macs3 (or macs2) to call peaks but I want to apply and test a series of custom normalization methods to the samples instead of using macs size/normalization factor calculations. Am I able to bypass the normalization step in macs3 but have the algorithm  perform all other steps besides the read normalization? 
 
If so, can you direct me to the location in the docs or some steps I would need to take in order to achieve this?

Thank you!
",tbrunetti,https://github.com/macs3-project/MACS/issues/510
I_kwDOABXaI85KDUt6,Compiled Linux and MacOS binaries,OPEN,2022-05-19T22:14:06Z,2022-06-06T18:40:46Z,,"Hi Tao,

Thank you so much for providing such a great tool!

I'm just wondering if there's any chance that you could provide compiled C++ binaries for Linux and MacOS. I'm working on analysis across platforms. I tried to do it my self, but either I had issue installing MACS3 from source or had errors when using tools like pyinstaller to convert python script to c++ binaries.

So if you could kindly provide the compiled ones, that'll be very helpful!

Thank you,
John",zeus19900814,https://github.com/macs3-project/MACS/issues/511
I_kwDOABXaI85LcgOa,Q: What is meaning of 'local lambda value'?,CLOSED,2022-06-09T08:13:51Z,2022-06-23T01:19:59Z,2022-06-23T01:19:59Z,"Hello !!

I have a question about 'local lambda value'. When using '--bdg' parameter, MACS will save bedGraph file of 'local lambda value'. 
![image](https://user-images.githubusercontent.com/52641420/172798936-c9cb3bf9-ae03-4ace-bcde-35771e50d2b4.png)

In this bedGraph file, what is the difference of bigWig file? Is it normalized or not?

I usually use 'makeUCSCfile' of HOMER or 'bamCoverage' of Deeptools for making coverage data. Because I don't know the exact meaning of 'local lambda value', I could not use this bedGraph format instead of other coverage data. 

Thank you in advance!!
",dahun73,https://github.com/macs3-project/MACS/issues/512
I_kwDOABXaI85LwGm7,Q: `-slocal` and `-llocal`,OPEN,2022-06-14T14:30:39Z,2022-06-22T01:53:01Z,,"Hi, 

This is a general question about the `-slocal` and `-llocal` parameters. I wonder under what condition would the callpeak function uses `-slocal` and when `-llocal` is used? Since I'm using macs3 on ATAC-Seq data and some of my stretches are beyond 10,000 bp, I suspect macs3 missing some of the peaks because the peak itself is being considered as noise. In this case, should I just change `-llocal` or `-slocal` should be changed accordingly? 

Thanks in advance for you're help,",tom21100227,https://github.com/macs3-project/MACS/issues/513
I_kwDOABXaI85MGnFH,Q: ,OPEN,2022-06-20T11:44:43Z,2022-06-20T11:44:43Z,,"**Use case**
A clear and concise description of what the use case is. For example: my data is from [...]

**Describe the problem**
A clear and concise description of what happend.
Hello! I used samtools to convert the sam file to bam file.  After sorting and index, the generated file is taken for MACS3 callpeak.  However, the error is reported. 

INFO  @ Mon, 20 Jun 2022 14:55:11: 
# Command line: callpeak -t /home/liwang/ChIP-seq/Prac/SRR18116336/SRR18116336.sorted.bai.bam -f BAM -g mm -B -n SRR18116336 --outdir /home/liwang/ChIP-seq/Prac/SRR18116336/
# ARGUMENTS LIST:
# name = SRR18116336
# format = BAM
# ChIP-seq file = ['/home/liwang/ChIP-seq/Prac/SRR18116336/SRR18116336.sorted.bai.bam']
# control file = None
# effective genome size = 1.87e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
INFO  @ Mon, 20 Jun 2022 14:55:11: #1 read tag files... 
INFO  @ Mon, 20 Jun 2022 14:55:11: #1 read treatment tags... 
struct.error: unpack requires a buffer of 4 bytes
Exception ignored in: 'MACS3.IO.Parser.BAMParser.tsize'
struct.error: unpack requires a buffer of 4 bytes
Traceback (most recent call last):
  File ""/home/liwang/MyPythonEnv/bin/macs3"", line 725, in <module>
    main()
  File ""/home/liwang/MyPythonEnv/bin/macs3"", line 48, in main
    run( args )
  File ""/home/liwang/MyPythonEnv/lib64/python3.6/site-packages/MACS3/Commands/callpeak_cmd.py"", line 70, in run
    (treat, control) = load_tag_files_options  (options)
  File ""/home/liwang/MyPythonEnv/lib64/python3.6/site-packages/MACS3/Commands/callpeak_cmd.py"", line 366, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""MACS3/IO/Parser.pyx"", line 1200, in MACS3.IO.Parser.BAMParser.build_fwtrack
  File ""MACS3/IO/Parser.pyx"", line 1212, in MACS3.IO.Parser.BAMParser.build_fwtrack
  File ""MACS3/IO/Parser.pyx"", line 1197, in MACS3.IO.Parser.BAMParser.get_references
struct.error: unpack requires a buffer of 4 bytes

**Describe the solution you tried**
A clear and concise description of any solutions you've tried.

I have reconverted, resorted and re-indexed the bam file. But it did not work
[report.txt](https://github.com/macs3-project/MACS/files/8940259/report.txt)
.
**Additional context**
Add any other context or screenshots about your use case here.
",LeeWang21,https://github.com/macs3-project/MACS/issues/514
I_kwDOABXaI85Mtry4,"Q:  q-values from -f BAMPE, -f BAM and -f BED",OPEN,2022-06-28T09:15:56Z,2022-06-28T09:50:59Z,,"Hi 
I am comparing different peak calling parameters for pair-end ATACseq data. I noticed that for the same peak called with different parameters has different q Values. 

Here are the 3  commands I used.

1. Command 1, -f BAMPE

` macs2 callpeak --tempdir /tmp/dsu/ -t BAMFILE -c control.bam -f BAMPE -g hs --cutoff-analysis -B  --SPMR --keep-dup all`
Macs2 detects **64906588 fragments**

```
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is on
# MACS will save fragment pileup signal per million reads

# fragment size is determined as 158 bps
# total fragments in treatment: 64906588
# total fragments in control: 46367297
# d = 158
```

2. Command 2 -f BAM
`macs2 callpeak -t BAMFILE -c /control.bam -f BAM -g hs --nomodel --shift -100 --extsize 200 -B --SPMR --cutoff-analysis --keep-dup all`

Macs2 detects **64906588 tags**

```
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off
# MACS will save fragment pileup signal per million reads

# tag size is determined as 140 bps
# total tags in treatment: 64906588
# total tags in control: 46367297
# Sequencing ends will be shifted towards 5' by 100 bp(s)
# d = 200
```

3. command 3, converting pair-end bamfile to bed file (not in pair-end mode, done with bedtools bamtobed)

`macs2 callpeak -t BEDFILE -c control.bed -f BED -g hs --nomodel --shift -100 --extsize 200 -B --SPMR --cutoff-analysis --keep-dup all`
Macs2 detects  **130765033 tags**
```
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off
# MACS will save fragment pileup signal per million reads
# tag size is determined as 113 bps
# total tags in treatment: 130765033
# total tags in control: 93006925
# Sequencing ends will be shifted towards 5' by 100bp(s)
# d = 200

```
Most of the peaks are consistently called by these 3 commands. I checked them on IGV and noticed that for the same region, the called peak are slightly different among the three commands, which should be expected. However, their q values differ. 
q Value (-log 10)  from command 1 and 2 is very close and is roughly half of the q value from command 3. So is the score for the peak. 

> chr20:25294444-25295029
> Merge_AB_BAMPE_peak_62946
> chr20:25294444-25295029
> Score = 1157.0
> Signal Value: 17.1874
> pValue (-log10): 118.057
> qValue (-log10): 115.733
> 
> chr20:25294422-25295051
> Macs2_shift100extsize200_fBAM_peak_66940
> chr20:25294422-25295051
> Score = 1160.0
> Signal Value: 18.2561
> pValue (-log10): 118.392
> qValue (-log10): 116.033
> 
> chr20:25294417-25295073
> Macs2_Nomodelshift100extsize200_fBED_peak_76999
> chr20:25294417-25295073
> Score = 2361.0
> Signal Value: 19.8826
> pValue (-log10): 238.517
> qValue (-log10): 236.15

I wonder how is q value calculated in BAMPE mode and BAM mode. I thought that in pair-end mode, macs2 detects 64906588 fragments, which means 2* 64906588 tags. Thus q value from -f BAMPE should be similar to -f BED mode, and more significant compared with -f BAM mode as -f BAM only uses half of the information from the pair-end data. 
Could you please kindly explain how q values are calculated when pair-end mode is on or off.

Do the differences in q value suggest that in pair-end mode, there is higher false-negative rates apart from the issue due to the minimum peak length mentioned in John M. Gaspar's  Improved peak-calling with MACS2 (http://orcid.org/0000-0002-0155-4123) 

Also,  I understand in pair-end data from ATACseq/ChIPseq, each fragment contains 2 tags. Is it therefore better to use all the information and use command 3? 

Many thanks in advance for sharing your thoughts/ideas!
Dingwen",Dingersrun,https://github.com/macs3-project/MACS/issues/515
I_kwDOABXaI85OiXxW,Q: fold enrichment and IP/input ratio,OPEN,2022-07-26T03:03:37Z,2022-07-28T16:06:57Z,,"Hello,
    I have run MACS3 to call peaks from IP and input files, and obtained the peaks and related fold enrichment. **Peaks** are filtered based on fold enrichment>5 and q value<1e-5.

I also manually calculated the (IP CPM)/(input CPM) ratio for these **Peaks**. 

In theory,  `the (IP CPM)/(input CPM) ratio` for these **Peaks** should be > 5. However, what I got was that `the (IP CPM)/(input CPM) ratio` < 3.
Thus, I am a little confused what the difference between `the (IP CPM)/(input CPM) ratio` and fold enrichment output by MACS3.

",BenxiaHu,https://github.com/macs3-project/MACS/issues/517
I_kwDOABXaI85PAVmx,How to normalize the data for bdgdiff,OPEN,2022-08-02T08:38:10Z,2022-08-16T16:21:59Z,,"Hi,

I would like to detect differential peaks between two different conditions by  `macs2 bdgdiff` and use `-d1` depth_condition1 `-d2` depth_condition2. But I don't know whether to normalize the data from different chip-seq and how to normalize? 

Thanks a lot!

Yu",liuyu988,https://github.com/macs3-project/MACS/issues/518
I_kwDOABXaI85QiirL,Bug:  Python version detection is faulty,OPEN,2022-08-25T17:31:23Z,2022-09-30T15:08:39Z,,"**Describe the bug**
The code checks to see if the Python version is less than 3.6.  It does this by using the floating point equivalent of the version number.  This means the code will not build on Python 3.10.x, since 3.1 is less than 3.6.

**To Reproduce**
Try installing on a Python 3.10.x system

**Expected behavior**
It should check correctly, by comparing major and minor release numbers separately.

**Screenshots**

**System (please complete the following information):**
 - OS: RHEL 8.3
 - Python version 3.10.6
 - Numpy version 1.23.2
 - MACS Version 2.7.1.1

**Additional context**
",caldodge,https://github.com/macs3-project/MACS/issues/519
I_kwDOABXaI85Q0cVd,Bug: python3.10 install,OPEN,2022-08-30T15:13:04Z,2022-10-07T18:16:25Z,,"**Describe the bug**
Python 3.10 has a change, I think in cython where use_tracing is now replaced by tracing.  It causes failure to install at Prob.c, MACS2/IO/Parser.c and probably more.  It can be overcome in one file like
sed -i 's/tstate->use_tracing/tstate->tracing/g' Prob.c



**To Reproduce**
To see the problem with python 3.10, you first need to overcome the python version test bug in setup.py eg replace
if float(sys.version[:3])<3.6:
with (terrible bad hack)
if float(sys.version[:3])>3.6:



**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: Ubuntu 22.04LTS
 - Python version 3.10.4
 - Numpy version 
 - MACS Version 2.2.7

**Additional context**
x86_64-linux-gnu-gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -g -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -fPIC -I/usr/local/lib/python3.10/dist-packages/numpy/core/include -I/usr/include/python3.10 -c MACS2/Prob.c -o build/temp.linux-x86_64-3.10/MACS2/Prob.o -w -O3 -ffast-math -g0
MACS2/Prob.c: In function ‘__Pyx_call_return_trace_func’:
MACS2/Prob.c:1412:15: error: ‘PyThreadState’ {aka ‘struct _ts’} has no member named ‘use_tracing’; did you mean ‘tracing’?
",vschulz,https://github.com/macs3-project/MACS/issues/520
I_kwDOABXaI85SKYW_,MACS3 TypeError: an integer is required,CLOSED,2022-09-19T19:54:39Z,2024-02-20T14:56:36Z,2024-02-20T14:56:36Z,"### Discussed in https://github.com/macs3-project/MACS/discussions/522

<div type='discussions-op-text'>

<sup>Originally posted by **luised94** September 19, 2022</sup>
Wasnt sure if it should be on issue or discussion board. 

Hello, I have been trying to use MACS3 from the command line to call peaks from a SAM file. I have been trying to adapt the protocol from https://www.biologie.ens.fr/~mthomas/other/chip-seq-training/#download, which uses bowtie to generate SAM files and macs1 to perform the analysis. I have been getting the following error: 

INFO  @ Mon, 19 Sep 2022 15:30:04: 
# Command line: callpeak -t SRR576933.sam -c SRR576938.sam -f SAM --gsize 4639675 --name macs3 --bw 400 --nomodel --keep-dup 1 --bdg
# ARGUMENTS LIST:
# name = macs3
# format = SAM
# ChIP-seq file = ['SRR576933.sam']
# control file = ['SRR576938.sam']
# effective genome size = 4.64e+06
# band width = 400
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
INFO  @ Mon, 19 Sep 2022 15:30:04: #1 read tag files... 
INFO  @ Mon, 19 Sep 2022 15:30:04: #1 read treatment tags... 
Traceback (most recent call last):
  File ""/home/lius/.local/bin/macs3"", line 725, in <module>
    main()
  File ""/home/lius/.local/bin/macs3"", line 48, in main
    run( args )
  File ""/home/lius/.local/lib/python3.8/site-packages/MACS3/Commands/callpeak_cmd.py"", line 70, in run
    (treat, control) = load_tag_files_options  (options)
  File ""/home/lius/.local/lib/python3.8/site-packages/MACS3/Commands/callpeak_cmd.py"", line 366, in load_tag_files_options
    treat = tp.build_fwtrack()
  File ""MACS3/IO/Parser.pyx"", line 398, in MACS3.IO.Parser.GenericParser.build_fwtrack
  File ""MACS3/IO/Parser.pyx"", line 420, in MACS3.IO.Parser.GenericParser.build_fwtrack
  File ""MACS3/IO/Parser.pyx"", line 1044, in MACS3.IO.Parser.SAMParser.__fw_parse_line
TypeError: an integer is required
</div>",luised94,https://github.com/macs3-project/MACS/issues/523
I_kwDOABXaI85SXKaH,macs callpeak q value cutoff 1 and 0.05 with different peak result,CLOSED,2022-09-22T04:15:50Z,2023-02-17T16:15:04Z,2023-02-17T16:15:04Z,"Hi tao,

I am using macs call peak, when i set q cutoff with 1 and 0.05, the results show a little different, set ""-q 1"", with ~1500 peaks with q<0.05, but set ""-q 0.05"" only report ~800 peaks, and there ~100 peaks which were not called by ""-q 1"". 
all commands are same except for ""-q""

what's reason about this issues?",zqmiao-mzq,https://github.com/macs3-project/MACS/issues/524
I_kwDOABXaI85Soi06,Q: Can I use bigWig data for peak calling?,OPEN,2022-09-26T16:13:23Z,2022-09-30T15:25:17Z,,"Hi, 

I have access to bigWig file from an ATACseq experiment, but I do not have the original fastqs nor the bam files of the alignment. I wanted to know if there is a way to identify peaks from this data. 

I have converted the bigWig to bedgraph and used ""bdgpeakcall"" on it, but the assumption of bdgpeakcall is that the input bedgraph  was generated by macs, which I don't think is the case for this file. 

How can I find ideal parameters for background noise and identify significant peaks from this data? I look forward to hearing back from you.

Kind regards,

Juan D. Montenegro
",jdmontenegro,https://github.com/macs3-project/MACS/issues/525
I_kwDOABXaI85TDzK0,Q: Script 'scripts/ceas' not found in metadata at None,CLOSED,2022-10-01T18:25:36Z,2022-10-11T17:18:53Z,2022-10-11T17:18:53Z,"Hello,

I am working on a cloud server and trying to download CEAS. My procedure was,


```
wget `http://slackware.uk/sbosrcarch/by-name/academic/cistrome-CEAS/CEAS-Package-1.0.2.tar.gz
tar xvf CEAS-Package-1.0.2.tar.gz
cd CEAS-Package-1.0.2
python setup.py install --prefix=$HOME/.local
```

All of this works without issue. I get the package `ceas` installed in `$HOME/.local/bin/python3.7`. 
Now, I do

```
ml r/3.6.3
python --version
```

(I get Python 3.7.2 as the output)

and finally, to see if ceas works,

`$HOME/.local/bin/ceas `

However, this yields the output,

![image](https://user-images.githubusercontent.com/69087781/192599492-9fb08244-58da-456a-939c-65a222061951.png)

I am not sure why this is happening. Please let me know if you need anything else from my side. Thanks!

",aryan-dugar2,https://github.com/macs3-project/MACS/issues/526
I_kwDOABXaI85UWIjY,Q: Using MACS2 in ArchR. ,CLOSED,2022-10-19T14:31:44Z,2023-02-08T20:03:08Z,2023-02-08T20:03:08Z,"Hi

I am using ArchR to analysis scATAC and using MACS2 with ArchR to do peak calling.
However, I got this error:

Error in .checkMacs2Options(pathToMacs2) : 
  Macs2 Path (macs2) is out of date (version Traceback (most recent call last):  File ""/usr/local/bin/macs2"", line 23, in <module>    from MACS2.Constants import *ModuleNotFoundError: No module named 'MACS2') and does not have --shift option.
  Please update (https://github.com/taoliu/MACS) and provide new path!
In addition: Warning messages:
1: In system2(path, ""callpeak -h"", stdout = TRUE, stderr = TRUE) :
  running command ''macs2' callpeak -h 2>&1' had status 1
2: In system2(path, "" --version"", stdout = TRUE, stderr = TRUE) :
  running command ''macs2'  --version 2>&1' had status 1

I tried pathToMacs2 = pathToMacs2, it can find macs2 and the macs2 in my computer is  executable. 
In the error context, it says update, but I'm not sure if MACS3 fits ArchR. 

![Screenshot_2022-10-19_16-24-58](https://user-images.githubusercontent.com/113095697/196719303-06b8738f-ec73-45d0-bc5c-6d300c60a160.png)
",TauHHCC,https://github.com/macs3-project/MACS/issues/530
I_kwDOABXaI85UsoxW,Bug: HMMRATAC ends in ZeroDivisionError: float division,OPEN,2022-10-24T15:06:57Z,2023-07-28T17:36:53Z,,"**Describe the bug**
hmmratac crashes with ZeroDivisionError: float division

Execution of only one of my sample-sets (control condition aka static in this case) leads to a crash of MACS3. All other samples run fine.

Command is:
`MACS3 hmmratac -b replicate1.bam replicate2.bam replicate3.bam --outdir static.pooled --save-digested --save-states`

Last output including error message is:
```
INFO  @ Mon, 24 Oct 2022 15:27:44:  12000000 fragments parsed
INFO  @ Mon, 24 Oct 2022 15:27:45: 12252543 fragments have been read.
INFO  @ Mon, 24 Oct 2022 15:28:17: #2 Use EM algorithm to estimate means and stddevs of fragment lengths
INFO  @ Mon, 24 Oct 2022 15:28:17: #  for mono-, di-, and tri-nucleosomal signals...
INFO  @ Mon, 24 Oct 2022 15:28:17: # A random seed 10151 has been used in the sampling function
INFO  @ Mon, 24 Oct 2022 15:28:21: # Downsampled 1498990 fragments will be used for EM training...
INFO  @ Mon, 24 Oct 2022 15:33:36: # Reached convergence after 11 iterations
INFO  @ Mon, 24 Oct 2022 15:33:36: #  The means and stddevs after EM:
INFO  @ Mon, 24 Oct 2022 15:33:36: #                         short       mono         di        tri
INFO  @ Mon, 24 Oct 2022 15:33:36: #             means:         50      187.7        383      601.7
INFO  @ Mon, 24 Oct 2022 15:33:36: #           stddevs:         20       53.3       44.9       98.8
INFO  @ Mon, 24 Oct 2022 15:33:36: #  Pile up all fragments
INFO  @ Mon, 24 Oct 2022 15:34:08: #  Convert pileup to fold-change over average signal
INFO  @ Mon, 24 Oct 2022 15:34:15: #  Compute the weights for each fragment length for each of the four signal types
Traceback (most recent call last):
  File ""/home/raaz/miniconda3/envs/lr-MACS3/bin/macs3"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS3==3.0.0b1', 'macs3')
  File ""/home/raaz/miniconda3/envs/lr-MACS3/lib/python3.10/site-packages/pkg_resources/__init__.py"", line 672, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/home/raaz/miniconda3/envs/lr-MACS3/lib/python3.10/site-packages/pkg_resources/__init__.py"", line 1472, in run_script
    exec(code, namespace, namespace)
  File ""/home/raaz/miniconda3/envs/lr-MACS3/lib/python3.10/site-packages/MACS3-3.0.0b1-py3.10-linux-x86_64.egg/EGG-INFO/scripts/macs3"", line 861, in <module>
    main()
  File ""/home/raaz/miniconda3/envs/lr-MACS3/lib/python3.10/site-packages/MACS3-3.0.0b1-py3.10-linux-x86_64.egg/EGG-INFO/scripts/macs3"", line 101, in main
    run( args )
  File ""/home/raaz/miniconda3/envs/lr-MACS3/lib/python3.10/site-packages/MACS3-3.0.0b1-py3.10-linux-x86_64.egg/MACS3/Commands/hmmratac_cmd.py"", line 151, in run
    weight_mapping = generate_weight_mapping( fl_list, em_means, em_stddevs )
  File ""MACS3/Signal/HMMR_Signal_Processing.pyx"", line 56, in MACS3.Signal.HMMR_Signal_Processing.generate_weight_mapping
  File ""MACS3/Signal/HMMR_Signal_Processing.pyx"", line 87, in MACS3.Signal.HMMR_Signal_Processing.generate_weight_mapping
ZeroDivisionError: float division
```

The exact command with paths is:
`MACS3 hmmratac -b ./input/static/mpimg_L26666-1_LR2223-ATAC-LR2223-S15_S29_R1_001.trim.srt.nodup.no_chrM_MT.bam ./input/static/mpimg_L26666-1_LR2223-ATAC-LR2223-S39_S30_R1_001.trim.srt.nodup.no_chrM_MT.bam ./input/static/mpimg_L
26666-1_LR2223-ATAC-LR2223-S86_S31_R1_001.trim.srt.nodup.no_chrM_MT.bam --outdir static.pooled --save-digested --save-states`

**To Reproduce**
Run this sample-set. I have no clue how it differs from the other three conditions nor the second control set I was running successfully before that.

**Expected behavior**
I would expect macs3 to finish the run successfully

**System (please complete the following information):**
 - OS: Linux
 - Python version 3.10.6
 - Numpy version 1.23.1
 - MACS Version 3.0.0b1

**Additional context**
Since the files are quite big please let me know in case it seems to be necessary to upload them.
",lionaid,https://github.com/macs3-project/MACS/issues/531
I_kwDOABXaI85UyA95,Q: is install via (bio)conda planned again?,OPEN,2022-10-25T12:38:18Z,2022-10-25T12:55:13Z,,"**Use case**
I would love to install MACS3 directly via the conda manager to keep things as clean as possible.

**Describe the problem**
The link to the bioconda page has no read permission / doesn't seem to work
[bioconda link](https://anaconda.org/bioconda/macs3)

**Describe the solution you tried**
install via conda with bioconda in repo list
open the link in a browser

Thank you for this great effort of enhancing and developing MACS :)",lionaid,https://github.com/macs3-project/MACS/issues/532
I_kwDOABXaI85YjMiT,Import Error Undefined Symbol,CLOSED,2022-12-08T23:56:58Z,2023-02-09T17:24:50Z,2023-02-09T17:24:50Z,"When using macs2 package, I got a error like this. I saw an issue with the same error, but I cannot solve my problem with his solution.

> RuntimeError                              Traceback (most recent call last)
> File <timed eval>:1
> 
> File ~/anaconda3/envs/r4/lib/python3.9/site-packages/snapatac2/tools/_call_peaks.py:53, in call_peaks(adata, groupby, selections, q_value, out_dir, key_added, inplace)
>      51     groupby = list(adata.obs[groupby])
>      52 out_dir = out_dir if out_dir is None else str(out_dir)
> ---> 53 res = _snapatac2.call_peaks(adata, groupby, selections, q_value, out_dir)
>      54 if inplace:
>      55     if adata.isbacked:
> 
> RuntimeError: macs2 error:
> Traceback (most recent call last):
>   File ""/home/shrestha/anaconda3/envs/r4/bin/macs2"", line 653, in <module>
>     main()
>   File ""/home/shrestha/anaconda3/envs/r4/bin/macs2"", line 49, in main
>     from MACS2.callpeak_cmd import run
>   File ""/home/shrestha/anaconda3/envs/r4/lib/python3.9/site-packages/MACS2/callpeak_cmd.py"", line 23, in <module>
>     from MACS2.OptValidator import opt_validate
>   File ""/home/shrestha/anaconda3/envs/r4/lib/python3.9/site-packages/MACS2/OptValidator.py"", line 20, in <module>
>     from MACS2.IO.Parser import BEDParser, ELANDResultParser, ELANDMultiParser, \
>   File ""MACS2/IO/Parser.pyx"", line 25, in init MACS2.IO.Parser
>   File ""MACS2/IO/FixWidthTrack.pyx"", line 27, in init MACS2.IO.FixWidthTrack
>   File ""MACS2/Pileup.pyx"", line 19, in init MACS2.Pileup
>   File ""MACS2/IO/BedGraph.pyx"", line 26, in init MACS2.IO.BedGraph
> ImportError: /home/shrestha/anaconda3/envs/r4/lib/python3.9/site-packages/MACS2/IO/ScoreTrack.cpython-39-x86_64-linux-gnu.so: undefined symbol: __log_finite

How to solve this undefined symbol error?",yuelaiwang,https://github.com/macs3-project/MACS/issues/534
I_kwDOABXaI85Ymqm3,Bug: Installation of MACS2 with pip in python 3.10,OPEN,2022-12-09T10:48:35Z,2023-03-29T21:44:07Z,,"**Describe the bug**
Installation with pip install macs2 in Python 3.10 fails, with a critical error complaining about the python version even though it is correct:
```
Collecting MACS2
  Downloading MACS2-2.2.7.1.tar.gz (2.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 33.9 MB/s eta 0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... error
  error: subprocess-exited-with-error
  
  × Getting requirements to build wheel did not run successfully.
  │ exit code: 1
  ╰─> [1 lines of output]
      CRITICAL: Python version must >= 3.6!
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
error: subprocess-exited-with-error

× Getting requirements to build wheel did not run successfully.
│ exit code: 1
╰─> See above for output.
```

**To Reproduce**
pip install macs2 (python 3.10)

**Expected behavior**
Successful installation. The installation works in Python 3.8 still.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: [e.g. Linux, Mac OSX]
 - Python version [e.g. 3.7.1]
 - Numpy version [e.g. 1.17.0]
 - MACS Version [e.g. 2.2.4]

**Additional context**
Add any other context about the problem here.
",cbravo93,https://github.com/macs3-project/MACS/issues/535
I_kwDOABXaI85bL1vN,Q: Are 2.1.2.1 or 2.1.1.20160309 results better?   Some differences noted,OPEN,2023-01-11T22:54:45Z,2023-01-12T17:52:46Z,,"Hi folks,

We had trouble processing some data with 2.1.1.20160309 so we ran instead with 2.1.2.1.   In another test we are seeing what look like significant differences in results between versions and are looking for guidance about which set of results should be reported.

We have samples with paired end reads that we processed with both versions.   Here are examples of the commands used:
```
#2.1.1.20160309
macs2 callpeak -t A91514_2_lanes_dupsFlagged.bam -c A91520_2_lanes_dupsFlagged.bam --gsize hs -f BAMPE --name A91514_H3K4me1 --outdir out1  --broad --bdg

#2.1.2.1
macs2 callpeak -t A91514_2_lanes_dupsFlagged.bam -c A91520_2_lanes_dupsFlagged.bam --gsize hs -f BAMPE --name A91514_H3K4me1 --outdir out2  --broad --bdg
```

Although the peaks in the  A91514_H3K4me1_peaks.xls cover similar fractions of the genome, the peaks themselves are quite disparate


| metric | 2.1.1.20160309 | 2.1.2.1 | 
|---|----|---|
| total bases in peaks | 404096581  | 381773429
| total peaks | 238101 | 196949
| peak bases unique to dataset | 35769857 | 13487857
| peaks completely unique to dataset | 30261 | 468

First, off does it make sense to compare results this way?  If so, is there reason to trust one set over the other?  Which would you use?",RichardCorbett,https://github.com/macs3-project/MACS/issues/537
I_kwDOABXaI85cb4zj,Running MACS2 in R Studio w/ Signac,CLOSED,2023-01-20T13:03:52Z,2023-01-24T16:58:59Z,2023-01-24T16:58:59Z,"I have installed MACS2 with % pip install MACS2 and my paths seem correct
PATH=/Users/ehoreth/anaconda3/bin:$PATH
PYTHONPATH=/Users/ehoreth/anaconda3/lib/python3.9/site-packages:$PYTHONPATH

yet when I try to run CallPeaks function in R Studio following this tutorial: https://stuartlab.org/signac/articles/pbmc_multiomic.html
I receive the error:
Error in CallPeaks.default(object = allfragpaths, macs2.path = macs2.path,  : 
  MACS2 not found. Please install MACS:https://macs3-project.github.io/MACS/

I am sure this is probably a Signac issue, but just in case, I am also posting this issue here. 

Thank you for your time.

",ehoreth,https://github.com/macs3-project/MACS/issues/538
I_kwDOABXaI85ckh_I,Bug: Installing on Windows 10 via pip,CLOSED,2023-01-23T13:15:30Z,2023-01-24T13:55:32Z,2023-01-24T13:55:32Z,"Hi, I'm currently trying to use MACS with Signac to analyse ATAC data, but can't seem to get MACS3 installed on my system. 

I've tried installing it in a virtual environment via pip, but it keeps throwing the same error. Personally I can't make any sense of this, except that at some point it is missing a file. 

Has anyone else encountered this problem?

Error:

```
(PythonVenv) (base) C:\Users\cook>pip install macs3
Collecting macs3
  Using cached MACS3-3.0.0b1.tar.gz (634 kB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... error
  error: subprocess-exited-with-error

  × Getting requirements to build wheel did not run successfully.
  │ exit code: 1
  ╰─> [26 lines of output]
      Traceback (most recent call last):
        File ""D:\PythonVenv\lib\site-packages\pip\_vendor\pep517\in_process\_in_process.py"", line 363, in <module>
          main()
        File ""D:\PythonVenv\lib\site-packages\pip\_vendor\pep517\in_process\_in_process.py"", line 345, in main
          json_out['return_val'] = hook(**hook_input['kwargs'])
        File ""D:\PythonVenv\lib\site-packages\pip\_vendor\pep517\in_process\_in_process.py"", line 130, in get_requires_for_build_wheel
          return hook(config_settings)
        File ""C:\Users\cook\AppData\Local\Temp\pip-build-env-0ji96_4_\overlay\Lib\site-packages\setuptools\build_meta.py"", line 338, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=['wheel'])
        File ""C:\Users\cook\AppData\Local\Temp\pip-build-env-0ji96_4_\overlay\Lib\site-packages\setuptools\build_meta.py"", line 320, in _get_build_requires
          self.run_setup()
        File ""C:\Users\cook\AppData\Local\Temp\pip-build-env-0ji96_4_\overlay\Lib\site-packages\setuptools\build_meta.py"", line 484, in run_setup
          super(_BuildMetaLegacyBackend,
        File ""C:\Users\cook\AppData\Local\Temp\pip-build-env-0ji96_4_\overlay\Lib\site-packages\setuptools\build_meta.py"", line 335, in run_setup
          exec(code, locals())
        File ""<string>"", line 155, in <module>
        File ""<string>"", line 71, in main
        File ""C:\Users\cook\Anaconda3\lib\subprocess.py"", line 424, in check_output
          return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
        File ""C:\Users\cook\Anaconda3\lib\subprocess.py"", line 505, in run
          with Popen(*popenargs, **kwargs) as process:
        File ""C:\Users\cook\Anaconda3\lib\subprocess.py"", line 951, in __init__
          self._execute_child(args, executable, preexec_fn, close_fds,
        File ""C:\Users\cook\Anaconda3\lib\subprocess.py"", line 1420, in _execute_child
          hp, ht, pid, tid = _winapi.CreateProcess(executable, args,
      FileNotFoundError: [WinError 2] Das System kann die angegebene Datei nicht finden
      [end of output]

  note: This error originates from a subprocess, and is likely not a problem with pip.
error: subprocess-exited-with-error

× Getting requirements to build wheel did not run successfully.
│ exit code: 1
╰─> See above for output.

```

**UPDATE:** It seems I hadn't installed gcc. Have installed it now, but then got an error further down the setup script when it attempted to assign some variables  - there was an uncaught exception arising from the fact that my system has no 'CC' entry in sysconfig.get_config_vars(). After catching this, subsequent errors were thrown up when attempting to attach the ""m"" library, which wasn't found. 

After removing those library args, the code ran further, but I am now running into issues with swalign not executing properly and throwing errors about assigning arrays of unknown length. I''ll make a separate issue about this. 


**To Reproduce**
Install Anaconda, then run:

python -m venv path/to/venv

path/to/venv/activate.bat

pip install macs3


**System (please complete the following information):**
 - OS: [Windows 10]
 - Python version [e.g. 3.9.2]
 - MACS Version [e.g. 3.0.0]
",AinsleyisLife,https://github.com/macs3-project/MACS/issues/539
I_kwDOABXaI85csAEJ,Bug: swalign errors during setup,CLOSED,2023-01-24T13:59:24Z,2023-02-17T10:02:29Z,2023-02-17T10:02:28Z,"**Describe the bug**

I've been struggling to get the package installed overall - latest issue is that when executing swalign during the setup process, it throws errors complaining about assigning arrays of unknown length / length 0:

```
MACS3/Signal/swalign.c(97): error C2057: Konstanter Ausdruck erwartet
MACS3/Signal/swalign.c(97): error C2466: Zuordnung eines Arrays der konstanten Größe 0 nicht möglich.
MACS3/Signal/swalign.c(97): error C2133: ""reversed1"": Unbekannte Größe
MACS3/Signal/swalign.c(98): error C2057: Konstanter Ausdruck erwartet
MACS3/Signal/swalign.c(98): error C2466: Zuordnung eines Arrays der konstanten Größe 0 nicht möglich.
MACS3/Signal/swalign.c(98): error C2133: ""reversed2"": Unbekannte Größe
MACS3/Signal/swalign.c(99): error C2057: Konstanter Ausdruck erwartet
MACS3/Signal/swalign.c(99): error C2466: Zuordnung eines Arrays der konstanten Größe 0 nicht möglich.
MACS3/Signal/swalign.c(99): error C2133: ""reversed3"": Unbekannte Größe
MACS3/Signal/swalign.c(339): error C2057: Konstanter Ausdruck erwartet
MACS3/Signal/swalign.c(339): error C2466: Zuordnung eines Arrays der konstanten Größe 0 nicht möglich.
MACS3/Signal/swalign.c(339): error C2133: ""c"": Unbekannte Größe
MACS3/Signal/swalign.c(339): error C2133: ""d"": Unbekannte Größe

```

Has anyone encountered this issue or got an idea of how to fix it?


**System (please complete the following information):**
 - OS: Windows 10
 - Python version 3.9.13
 - Numpy version 1.17
 - MACS Version 3.0.0

",AinsleyisLife,https://github.com/macs3-project/MACS/issues/540
I_kwDOABXaI85dSRJd,Bug: Pip install fails -- parsing 'numpy>=>=1.17' in setup,CLOSED,2023-01-31T22:07:28Z,2023-05-31T19:08:49Z,2023-05-31T19:08:49Z,"**Describe the bug**
When installing most recent macs2 via pip, install fails at ""Preparing metadata (pyproject.toml) phase"", Doesn't appear to be restricted to a specific python version

Concise error message (see screenshot for full trace):

``` 
error in MACS2 setup command: 'install_requires' must be a string or list of strings containing valid project/version requirement specifiers; Expected end or semicolon (after name and no valid version specifier)
          numpy>=>=1.17
               ^
      [end of output]
```

**To Reproduce**
1) From fresh install of python 3.8/3.9, etc., run 
```pip install --upgrade pip numpy && pip install macs2``` 
(I used the docker container python:3.8-slim-buster, but also my local computer)

**Expected behavior**

MACS2 to install successfully

**Screenshots**
![Screenshot from 2023-01-31 16-58-16](https://user-images.githubusercontent.com/91626233/215894247-898ae95d-2b0d-410a-94bd-e5240159ce9b.png)

**System (please complete the following information):**
 - OS: Linux
 - Python version 3.8.15
 - Numpy version 1.24.1
 - MACS Version 2.2.7.1

**Additional context**
Add any other context about the problem here.
",cossentinoCS,https://github.com/macs3-project/MACS/issues/541
I_kwDOABXaI85dWBR1,Bug: Same output in all .bdg files when running --save-digested with HMMRATAC,OPEN,2023-02-01T12:48:03Z,2023-02-01T12:48:03Z,,"I have tried running macs3 hmmratac. I set the --save-digested flag because I want this for downstream analysis. I note that the bedgraph files contain the same signal in short-, mono-, di-, and tri- signals in all four bedgraph files in all regions. 

I have analyzed public ATAC-seq data from https://pubmed.ncbi.nlm.nih.gov/33407087/. 
Data available at https://www.ncbi.nlm.nih.gov/Traces/study/?acc=SRP272433&o=acc_s%3Aa samples SRR12261697, SRR12261698, SRR12261699. These all have good periodicity in the insert size distribubion plots so I expect that these would work well. 

I have attached a screenshot from a genome browser on what it looks like. 

![jbrowse_zmays](https://user-images.githubusercontent.com/46961584/216047327-ed241533-0d13-4487-9179-7f5104511913.png)

 - OS: Linux
 - Python version 3.9.12
 - Numpy version 1.24.1
 - MACS 3.0.0b1

I first tried this on newly generated data from our lab and got the same signal in all four output files.",TeiturAK,https://github.com/macs3-project/MACS/issues/542
I_kwDOABXaI85drE5G,Bug: `numpy>=>=1.17`,CLOSED,2023-02-05T19:06:15Z,2023-05-31T19:06:28Z,2023-05-31T19:06:28Z,"```
pip install macs2

Collecting MACS2
  Using cached MACS2-2.2.7.1.tar.gz (2.1 MB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... error
  error: subprocess-exited-with-error

  × Preparing metadata (pyproject.toml) did not run successfully.
  │ exit code: 1
  ╰─> [4 lines of output]
      Requirement already satisfied: numpy>=1.17 in /tmp/pip-build-env-25k996_o/overlay/lib/python3.9/site-packages (1.24.1)
      error in MACS2 setup command: 'install_requires' must be a string or list of strings containing valid project/version requirement specifiers; Expected end or semicolon (after name and no valid version specifier)
          numpy>=>=1.17
               ^
      [end of output]

  note: This error originates from a subprocess, and is likely not a problem with pip.
error: metadata-generation-failed

× Encountered error while generating package metadata.
╰─> See above for output.
```

When I download https://pypi.org/project/MACS2/#files I can verify that `/MACS2.egg-info/requires.txt` contains the string `numpy>=>=1.17`",alexlenail,https://github.com/macs3-project/MACS/issues/544
I_kwDOABXaI85eySOF,No output files,OPEN,2023-02-18T07:07:02Z,2023-02-18T07:09:43Z,,"I ran the MACS 3 command. There seems to be no error in the log. However, no output files are saved. I checked all required packages, and they are installed and satisfy the requirements for MACS3. The output file directory is also writable. Could you help me fix it?


` Command line: callpeak -t Renamed_Bam_files/HS766T_treatment_rep2.bam -c Renamed_Bam_files/HS766T_control_rep2.bam -n Peaks_files/HS766T_treatment_rep2_vs_control --outdir Peaks_files -g hs -s 37 --qvalue 0.01 --bdg --nomodel`

`# ARGUMENTS LIST:`
`# name = Peaks_files/HS766T_treatment_rep2_vs_control`
`# format = AUTO`
`# ChIP-seq file = ['Renamed_Bam_files/HS766T_treatment_rep2.bam']`
`# control file = ['Renamed_Bam_files/HS766T_control_rep2.bam']`
`# effective genome size = 2.70e+09`
`# band width = 300`
`# model fold = [5, 50]`
`# qvalue cutoff = 1.00e-02`
`# The maximum gap between significant sites is assigned as the read length/tag size.`
`# The minimum length of peaks is assigned as the predicted fragment length ""d"".`
`# Larger dataset will be scaled towards smaller dataset.`
`# Range for calculating regional lambda is: 1000 bps and 10000 bps`
`# Broad region calling is off`
`# Paired-End mode is off`
 
INFO  @ Fri, 17 Feb 2023 23:02:31: #1 read tag files... 
INFO  @ Fri, 17 Feb 2023 23:02:31: #1 read treatment tags... 
INFO  @ Fri, 17 Feb 2023 23:02:31: Detected format is: BAM 
INFO  @ Fri, 17 Feb 2023 23:02:31: * Input file is gzipped. 
INFO  @ Fri, 17 Feb 2023 23:02:34: 736555 reads have been read. 
INFO  @ Fri, 17 Feb 2023 23:02:34: #1.2 read input tags... 
INFO  @ Fri, 17 Feb 2023 23:02:34: Detected format is: BAM 
INFO  @ Fri, 17 Feb 2023 23:02:34: * Input file is gzipped. 
INFO  @ Fri, 17 Feb 2023 23:02:36: 433633 reads have been read. 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1 tag size is determined as 37 bps 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1 tag size = 37.0 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1  total tags in treatment: 736555 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1 user defined the maximum tags... 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1  tags after filtering in treatment: 727574 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1  Redundant rate of treatment: 0.01 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1  total tags in control: 433633 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1 user defined the maximum tags... 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1  tags after filtering in control: 428281 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1  Redundant rate of control: 0.01 
INFO  @ Fri, 17 Feb 2023 23:02:36: #1 finished! 
INFO  @ Fri, 17 Feb 2023 23:02:36: #2 Build Peak Model... 
INFO  @ Fri, 17 Feb 2023 23:02:36: #2 Skipped... 
INFO  @ Fri, 17 Feb 2023 23:02:36: #2 Use 200 as fragment length 
INFO  @ Fri, 17 Feb 2023 23:02:36: #3 Call peaks... 
INFO  @ Fri, 17 Feb 2023 23:02:36: #3 Pre-compute pvalue-qvalue table... 
INFO  @ Fri, 17 Feb 2023 23:02:39: #3 In the peak calling step, the following will be performed simultaneously: 
INFO  @ Fri, 17 Feb 2023 23:02:39: #3   Write bedGraph files for treatment pileup (after scaling if necessary)... Peaks_files/HS766T_treatment_rep2_vs_control_treat_pileup.bdg 
INFO  @ Fri, 17 Feb 2023 23:02:39: #3   Write bedGraph files for control lambda (after scaling if necessary)... Peaks_files/HS766T_treatment_rep2_vs_control_control_lambda.bdg 
INFO  @ Fri, 17 Feb 2023 23:02:39: #3   Pileup will be based on sequencing depth in control. 
INFO  @ Fri, 17 Feb 2023 23:02:39: #3 Call peaks for each chromosome... 
`macs_script.sh: line 15: 25962 Segmentation fault      (core dumped) macs3 callpeak -t ""${treatment_bam}"" -c ""${control_bam}"" -n ""${output_prefix}"" --outdir ""${peaks_dir}"" -g hs -s 37 --qvalue 0.01 --bdg --nomodel`",kchen96,https://github.com/macs3-project/MACS/issues/545
I_kwDOABXaI85ezRBt,Spike-in + input normalisation with MACS,OPEN,2023-02-18T23:08:59Z,2024-02-22T01:44:38Z,,"Hello,

I have a few questions on ChIP-seq experimental design, and normalisation by input vs spike-in control. I am working with different tissues, and would like to do the following:

1. Identify peaks that are only present in some tissues/samples but not in the others
2. Compare the levels of histone acetylation (what I've IPed) at specific peaks among different samples
3. Visualise normalised tracks

From my understanding, 1. can be done by comparing the signal in ChIP vs input samples by MACS `callpeak`, and this step does not make use of a spike-in control. My question is about the second point: MACS can compare peaks between samples with the [`bdgdiff` command](https://github.com/macs3-project/MACS/wiki/Call-differential-binding-events), however if I understand this correctly, this is about *enrichment* of signal within a peak in sample 1 vs sample 2. For instance, if peak A in sample 1 comprises 1% of all mapped reads for sample 1, and the same peak comprises 20% of mapped reads for sample 2, bdgdiff would flag peak A as significantly enriched in sample 2. However, in a scenario where the global level of e.g. acetylation changes between sample 1 and 2, bdgdiff would not necessarily peak up this difference. E.g. if sample 1 had an ""absolute""/global acetylation level of 1000, whilst sample 2 had an ""absolute"" acetylation level of 50, the ""absolute"" acetylation signal at peak A would be 1%*1000 = 10 for sample 1, and 20%*50 = 10 for sample 2. In this case, bdgdiff would still flag peak A as enriched in sample 2, but it could not work out that the ""absolute"" acetylation level is the same in each sample (right?). Incorporating a spike-in control would allow to pick up ""absolute""/global differences, as in [Egan et al. (2016)](https://doi.org/10.1371/journal.pone.0166438).

My questions are:
     a) How can I incorporate spike-ins into my MACS analysis? Should I perform spike-in normalisation prior to running bdgdiff and or callpeak? If so, would it be the same calculation as in [Egan et al. (2016)](https://doi.org/10.1371/journal.pone.0166438), i.e. scaling the number of mapped dm6 (spike-in) reads by the lowest and multiplying these ""correction factors"" by the number of mapped hg38 reads (for both ChIP and input samples)?
     b) How can I incorporate spike-in normalisation for visualisation purposes? Would I need to do the spike-in normalisation on the bam files beforehand and then run callpeak, to get a bedgraph file which is both spike-in-normalised and also CPM-normalised? Or could I perform the spike-in normalisation after running callpeak on raw files, e.g. using deepTools to convert the bedgraph (from MACS) to bigwig including a scaling factor (bamCoverage --scaleFactor)?

Thanks for your time and apologies for the long post!",acv21,https://github.com/macs3-project/MACS/issues/546
I_kwDOABXaI85fWYI-,Bug: Python version error when install with conda,OPEN,2023-02-25T12:59:10Z,2023-02-25T12:59:10Z,,"**Describe of the bug**
I tried to install macs3 in conda with the following command.
```
conda install -c maximinio macs3
``` 
For the first time when installed without specific Python version (default 3.11) It reported
```
Found conflicts! Looking for incompatible packages.
This can take several minutes.  Press CTRL-C to abort.
failed                                                                                                           

UnsatisfiableError: The following specifications were found
to be incompatible with the existing python installation in your environment:

Specifications:

  - macs3 -> python[version='>=3.8,<3.9.0a0']

Your python: python=3.11

If python is on the left-most side of the chain, that's the version you've asked for.
When python appears to the right, that indicates that the thing on the left is somehow
not available for the python version you are constrained to. Note that conda will not
change your python version to a different minor version unless you explicitly specify
that.

The following specifications were found to be incompatible with your system:

  - feature:/linux-64::__glibc==2.17=0
  - feature:|@/linux-64::__glibc==2.17=0

Your installed version is: 2.17
```
Then I tried python 3.8 but it reported
```
Found conflicts! Looking for incompatible packages.
This can take several minutes.  Press CTRL-C to abort.
failed                                                                                                           

UnsatisfiableError: The following specifications were found
to be incompatible with the existing python installation in your environment:

Specifications:

  - macs3 -> python[version='>=2.7,<2.8.0a0|>=3.10,<3.11.0a0|>=3.9,<3.10.0a0|>=3.7,<3.8.0a0|>=3.6,<3.7.0a0']

Your python: python=3.8

If python is on the left-most side of the chain, that's the version you've asked for.
When python appears to the right, that indicates that the thing on the left is somehow
not available for the python version you are constrained to. Note that conda will not
change your python version to a different minor version unless you explicitly specify
that.

The following specifications were found to be incompatible with your system:

  - feature:/linux-64::__glibc==2.17=0
  - feature:|@/linux-64::__glibc==2.17=0

Your installed version is: 2.17
```
I also tried python 3.9 and the error is the same as that in python 3.11
**System information:**
 - OS: [Linux]
 - MACS Version 3.0.0b1",wook2014,https://github.com/macs3-project/MACS/issues/547
I_kwDOABXaI85gIqnF,Bug: UnboundLocalError: local variable 'dup_locs' referenced before assignment,OPEN,2023-03-07T07:26:07Z,2023-03-07T07:26:07Z,,"How can I troubleshoot an error that occurred while using MACS2, while another sample did not encounter such an error in the same environment?

INFO  @ Tue, 07 Mar 2023 15:20:11: #1 note: mean fragment size in control is 205 bp -- value ignored
INFO  @ Tue, 07 Mar 2023 15:20:11: #1 fragment size = 108
INFO  @ Tue, 07 Mar 2023 15:20:11: #1  total fragments in treatment: 16324161
INFO  @ Tue, 07 Mar 2023 15:20:11: #1 user defined the maximum fragments...
INFO  @ Tue, 07 Mar 2023 15:20:11: #1 filter out redundant fragments by allowing at most 1 identical fragment(s)
Traceback (most recent call last):
  File ""/public/software/genomics/unstable/MACS/stage/bin/macs2"", line 4, in <module>
    __import__('pkg_resources').run_script('MACS2==2.1.0.20150731', 'macs2')
  File ""/public/sugon/software/Python-2.7/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 699, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/public/sugon/software/Python-2.7/lib/python2.7/site-packages/pkg_resources/__init__.py"", line 1617, in run_script
    exec(code, namespace, namespace)
  File ""/public/software/genomics/unstable/MACS/stage/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 614, in <module>
    main()
  File ""/public/software/genomics/unstable/MACS/stage/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/EGG-INFO/scripts/macs2"", line 56, in main
    run( args )
  File ""/public/software/genomics/unstable/MACS/stage/lib/python2.7/site-packages/MACS2-2.1.0.20150731-py2.7-linux-x86_64.egg/MACS2/callpeak_cmd.py"", line 100, in run
    treat.separate_dups(treatment_max_dup_tags) # changed 5-29
  File ""MACS2/IO/PairedEndTrack.pyx"", line 354, in MACS2.IO.PairedEndTrack.PETrackI.separate_dups (MACS2/IO/PairedEndTrack.c:5871)
UnboundLocalError: local variable 'dup_locs' referenced before assignment
",DMHe98,https://github.com/macs3-project/MACS/issues/548
I_kwDOABXaI85g2RLG,Q: ,OPEN,2023-03-15T06:24:38Z,2023-03-15T06:24:38Z,,"my data is MeRIP-seq,When I used the parameter -f BAMPE for MACS2, I got the following error

1000 can't be smaller than 1144.54654656354

But when I looked at the fragment length of my data, the average length was only about 400, and most fragments were only about 300,I don't know why the error was reported, please help me to answer it




",hlldhy,https://github.com/macs3-project/MACS/issues/549
I_kwDOABXaI85hFYv1,"Q: I set -q 0.05,but the -log10(qvalue) less than 1.30103,why",OPEN,2023-03-17T06:57:46Z,2023-03-17T06:57:46Z,,"**Use case**
callpeak -t ../mapping/WK4me3_1.uni.dedup.bam -c ../mapping/W_INPUT.uni.dedup.bam -n WK4me3A -g 2554017838 -f AUTO -q 0.05 --nomodel --extsize 217 --broad --outdir .
**Describe the problem**
# This file is generated by MACS version 2.1.0.20150420
# Command line: callpeak -t ../mapping/WK4me3_1.uni.dedup.bam -c ../mapping/W_INPUT.uni.dedup.bam -n WK4me3A -g 2554017838 -f AUTO -q 0.05 --nomodel --extsize 217 --broad --outdir .
# ARGUMENTS LIST:
# name = WK4me3A
# format = AUTO
# ChIP-seq file = ['../mapping/WK4me3_1.uni.dedup.bam']
# control file = ['../mapping/W_INPUT.uni.dedup.bam']
# effective genome size = 2.55e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 5.00e-02
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is on

# tag size is determined as 149 bps
# total tags in treatment: 1950054
# tags after filtering in treatment: 1819076
# maximum duplicate tags at the same position in treatment = 1
# Redundant rate in treatment: 0.07
# total tags in control: 14158983
# tags after filtering in control: 13646391
# maximum duplicate tags at the same position in control = 1
# Redundant rate in control: 0.04
# d = 217
chr	start	end	length	pileup	-log10(pvalue)	fold_enrichment	-log10(qvalue)	name
Chr1	218548	218860	313	1.51	2.09345	1.87911	0.45593	WK4me3A_peak_1
Chr1	284416	284632	217	1.81	2.64674	2.25797	0.66505	WK4me3A_peak_2
Chr1	366085	366632	548	2.27	3.47965	2.74418	1.00715	WK4me3A_peak_3
Chr1	470805	471075	271	2.08	2.94191	2.42297	0.87842	WK4me3A_peak_4
Chr1	488368	488584	217	2.51	3.39730	2.82449	0.95935	WK4me3A_peak_5

**Describe the solution you tried**
A clear and concise description of any solutions you've tried.

**Additional context**
Add any other context or screenshots about your use case here.
",bieshuohuawenwo,https://github.com/macs3-project/MACS/issues/550
I_kwDOABXaI85hFjcM,"Q: Why is it that when I set the threshold q less than 0.05, some of the output -log10 (qvalue) in the result is less than 1.30103",OPEN,2023-03-17T07:39:10Z,2023-03-17T07:39:10Z,,"**Use case**

macs   callpeak -t ../mapping/WK4me3_1.uni.dedup.bam -c ../mapping/W_INPUT.uni.dedup.bam -n WK4me3A -g 2554017838 -f AUTO -q 0.1 --nomodel --extsize 217 --broad --outdir .

**Describe the problem**
# This file is generated by MACS version 2.1.0.20150420
# Command line: callpeak -t ../mapping/WK4me3_1.uni.dedup.bam -c ../mapping/W_INPUT.uni.dedup.bam -n WK4me3A -g 2554017838 -f AUTO -q 0.1 --nomodel --extsize 217 --broad --outdir .
# ARGUMENTS LIST:
# name = WK4me3A
# format = AUTO
# ChIP-seq file = ['../mapping/WK4me3_1.uni.dedup.bam']
# control file = ['../mapping/W_INPUT.uni.dedup.bam']
# effective genome size = 2.55e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 1.00e-01
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is on

# tag size is determined as 149 bps
# total tags in treatment: 1950054
# tags after filtering in treatment: 1819076
# maximum duplicate tags at the same position in treatment = 1
# Redundant rate in treatment: 0.07
# total tags in control: 14158983
# tags after filtering in control: 13646391
# maximum duplicate tags at the same position in control = 1
# Redundant rate in control: 0.04
# d = 217
chr	start	end	length	pileup	-log10(pvalue)	fold_enrichment	-log10(qvalue)	name
Chr1	218548	218860	313	1.51	2.09345	1.87911	**_0.45593_**	WK4me3A_peak_1
Chr1	284416	284632	217	1.81	2.64674	2.25797	**_0.66505_**	WK4me3A_peak_2
Chr1	366085	366632	548	2.27	3.47965	2.74418	1.00715	WK4me3A_peak_3
Chr1	470805	471075	271	2.08	2.94191	2.42297	0.87842	WK4me3A_peak_4

**Describe the solution you tried**
A clear and concise description of any solutions you've tried.

**Additional context**
Add any other context or screenshots about your use case here.
",bieshuohuawenwo,https://github.com/macs3-project/MACS/issues/551
I_kwDOABXaI85hFjnS,"Q: Why is it that when I set the threshold q less than 0.05, some of the output -log10 (qvalue) in the result is less than 1.30103",OPEN,2023-03-17T07:39:53Z,2023-03-17T07:59:51Z,,"**Use case**

macs   callpeak -t ../mapping/WK4me3_1.uni.dedup.bam -c ../mapping/W_INPUT.uni.dedup.bam -n WK4me3A -g 2554017838 -f AUTO -q 0.1 --nomodel --extsize 217 --broad --outdir .

**Describe the problem**
# This file is generated by MACS version 2.1.0.20150420
# Command line: callpeak -t ../mapping/WK4me3_1.uni.dedup.bam -c ../mapping/W_INPUT.uni.dedup.bam -n WK4me3A -g 2554017838 -f AUTO -q 0.1 --nomodel --extsize 217 --broad --outdir .
# ARGUMENTS LIST:
# name = WK4me3A
# format = AUTO
# ChIP-seq file = ['../mapping/WK4me3_1.uni.dedup.bam']
# control file = ['../mapping/W_INPUT.uni.dedup.bam']
# effective genome size = 2.55e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 1.00e-01
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 1000 bps and 10000 bps
# Broad region calling is on

# tag size is determined as 149 bps
# total tags in treatment: 1950054
# tags after filtering in treatment: 1819076
# maximum duplicate tags at the same position in treatment = 1
# Redundant rate in treatment: 0.07
# total tags in control: 14158983
# tags after filtering in control: 13646391
# maximum duplicate tags at the same position in control = 1
# Redundant rate in control: 0.04
# d = 217
chr	start	end	length	pileup	-log10(pvalue)	fold_enrichment	-log10(qvalue)	name
Chr1	218548	218860	313	1.51	2.09345	1.87911	**_0.45593_**	WK4me3A_peak_1
Chr1	284416	284632	217	1.81	2.64674	2.25797	**_0.66505_**	WK4me3A_peak_2
Chr1	366085	366632	548	2.27	3.47965	2.74418	1.00715	WK4me3A_peak_3
Chr1	470805	471075	271	2.08	2.94191	2.42297	0.87842	WK4me3A_peak_4

**Describe the solution you tried**
A clear and concise description of any solutions you've tried.

**Additional context**
Add any other context or screenshots about your use case here.
",bieshuohuawenwo,https://github.com/macs3-project/MACS/issues/552
I_kwDOABXaI85h4zsf,Q: Error running macs3 callpeak,OPEN,2023-03-27T15:05:31Z,2023-08-23T10:05:33Z,,"I have installed macs3 using pip. It is installed in a virtual environment. I tried to run this cmd:

macs3 callpeak -f BAMPE -t h2ak119ub_10A_R1.bam -g hs --broad

But I received the following error:

Traceback (most recent call last):
  File ""/slipstream/home/bbanerje/MyPythonEnv/bin/macs3"", line 861, in <module>
    main()
  File ""/slipstream/home/bbanerje/MyPythonEnv/bin/macs3"", line 48, in main
    from MACS3.Commands.callpeak_cmd import run
  File ""/slipstream/home/bbanerje/MyPythonEnv/lib/python3.8/site-packages/MACS3/Commands/callpeak_cmd.py"", line 24, in <module>
    from MACS3.Utilities.OptValidator import opt_validate_callpeak
  File ""/slipstream/home/bbanerje/MyPythonEnv/lib/python3.8/site-packages/MACS3/Utilities/OptValidator.py"", line 24, in <module>
    from MACS3.IO.Parser import BEDParser, ELANDResultParser, ELANDMultiParser, \
  File ""MACS3/IO/Parser.pyx"", line 32, in init MACS3.IO.Parser
  File ""MACS3/Signal/FixWidthTrack.pyx"", line 28, in init MACS3.Signal.FixWidthTrack
  File ""MACS3/Signal/Pileup.pyx"", line 22, in init MACS3.Signal.Pileup
  File ""MACS3/Signal/PairedEndTrack.pyx"", line 27, in init MACS3.Signal.PairedEndTrack
  File ""MACS3/Signal/BedGraph.pyx"", line 23, in init MACS3.Signal.BedGraph
ImportError: /slipstream/home/bbanerje/MyPythonEnv/lib/python3.8/site-packages/MACS3/Signal/ScoreTrack.cpython-38-x86_64-linux-gnu.so: undefined symbol: __log_finite

Could you please help me out with a solution for this?

",bodhi84,https://github.com/macs3-project/MACS/issues/554
I_kwDOABXaI85iXiPx,Q: MACS2 callpeak VS bdgdiff. How to trace back?,OPEN,2023-04-01T07:03:12Z,2023-04-01T07:03:12Z,,"Hi, 

As one part of the pipeline, I'm using MACS2 for MeRIP-seq differential peak calling.
First I used ""callpeak"" to generate a total of four bdg files (cond1 input, cond1 IP, cond2 input, and cond2 IP).
Then I used ""bdgdiff"" with these bdg files to find differentially enriched peaks.
I would like to use some statistics of differentially enriched peaks (e.g., fold changes, p/q-values). Since ""bdgdiff"" output BED files only provide likelihood ratio, I am currently comparing ""callpeak"" output and ""bdgdiff"" output to annotate overlapping peaks.

My criterion is to annotate ""callpeak"" peaks with cond1/cond2/common enrichment, when there's any ""bdgdiff"" peaks overlapping more than 50% of the ""callpeak"" peak region. I found a very small number of overlapping peaks: for example, callpeak=25000 peaks VS bdgdiff=200 peaks from three BED files. I've tweaked ""bdgdiff"" parameters (cutoff, min-len, and max-gap) but it does not seem to help.

My questions are following:
1) Is there any other way to calculate fold changes directly from ""bdgdiff"" output?
2)  Is there any other MACS2 tool to help this problem? ""bdgpeakcall"" seems to give a similar result to ""callpeak"".

Thanks in advance! 

Taehyung",TaehyungKwon,https://github.com/macs3-project/MACS/issues/556
I_kwDOABXaI85jBSuM,Bug: pip --no-deps is ignored,CLOSED,2023-04-10T20:01:51Z,2023-10-23T16:50:30Z,2023-10-23T16:50:30Z,"**Describe the bug**
can't install macs3 with pip without dependencies

**To Reproduce**
pip install macs3 --no-deps

**Expected behavior**
Installation of macs3 without building and installing dependencies

**Screenshots**

![Screenshot 2023-04-10 at 3 59 16 PM](https://user-images.githubusercontent.com/3075799/230986841-632dcfd8-7d44-4537-b5e6-19b15eb8ecff.png)

**System (please complete the following information):**
 - OS: ```
ProductName:		macOS (arm64)
          ProductVersion:		13.3.1
          BuildVersion:		22E261
```
 - Python version 3.10.10
 - Numpy version 1.24.2
 - MACS Version 3

**Additional context**
Add any other context about the problem here.
",akhst7,https://github.com/macs3-project/MACS/issues/557
I_kwDOABXaI85jFFTR,Bug: can't install macs3 in a virtual environment via pip,CLOSED,2023-04-11T11:22:09Z,2023-05-31T19:13:15Z,2023-05-31T19:13:15Z,"**Describe the bug**
A clear and concise description of what the bug is.

Hello, I am having trouble with downloading MACS3 via pip.
I met all of the requirements in the ""Install"" documents.
Also, I made a virtual environment in python and tried to install MACS3 via `pip install MACS3` and there was an error as below.
Also, I downloaded the whole files in github and performed `$ python setup.py install` but it also failed.

**To Reproduce**
Steps to reproduce the behavior. If possible, could you share the data with us?

> error code as below.
-------------------
(myenv) D:\Dev\macs>pip install MACS3
Collecting MACS3
  Using cached MACS3-3.0.0b1.tar.gz (634 kB)
      Traceback (most recent call last):
        File ""D:\Dev\macs\myenv\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py"", line 353, in <module>
          main()
        File ""D:\Dev\macs\myenv\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py"", line 335, in main
          json_out['return_val'] = hook(**hook_input['kwargs'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""D:\Dev\macs\myenv\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py"", line 118, in get_requires_for_build_wheel          return hook(config_settings)
                 ^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\yunju\AppData\Local\Temp\pip-build-env-v0i9wtin\overlay\Lib\site-packages\setuptools\build_meta.py"", line 338, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=['wheel'])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\yunju\AppData\Local\Temp\pip-build-env-v0i9wtin\overlay\Lib\site-packages\setuptools\build_meta.py"", line 320, in _get_build_requires
          self.run_setup()
        File ""C:\Users\yunju\AppData\Local\Temp\pip-build-env-v0i9wtin\overlay\Lib\site-packages\setuptools\build_meta.py"", line 485, in run_setup            self).run_setup(setup_script=setup_script)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\yunju\AppData\Local\Temp\pip-build-env-v0i9wtin\overlay\Lib\site-packages\setuptools\build_meta.py"", line 335, in run_setup  
          exec(code, locals())        File ""<string>"", line 155, in <module>
        File ""<string>"", line 91, in main
      KeyError: 'CC'
      [end of output]

  note: This error originates from a subprocess, and is likely not a problem with pip.
error: subprocess-exited-with-error

× Getting requirements to build wheel did not run successfully.
│ exit code: 1
╰─> See above for output.

note: This error originates from a subprocess, and is likely not a problem with pip.
-------------------
**Expected behavior**
A clear and concise description of what you expected to happen.
-> to install MACS3

**Screenshots**
If applicable, add screenshots to help explain your problem.
![image](https://user-images.githubusercontent.com/121819865/231142934-afbc9800-e65b-479d-a388-7db4e1552857.png)
![image](https://user-images.githubusercontent.com/121819865/231143058-a4b1bdc6-4e6b-48bd-be09-b9e60ed64923.png)

**System (please complete the following information):**
 - OS: Windows 11 (64bit)
 - Python version 3.11.2
 - Numpy version 1.24.2
 - MACS Version 3.0.0b1

**Additional context**
Add any other context about the problem here.
",yjhuh514,https://github.com/macs3-project/MACS/issues/558
I_kwDOABXaI85j1Ii1,Q: MACS - HMMRATAC - Index Out of Range,CLOSED,2023-04-19T13:08:56Z,2023-06-23T19:34:02Z,2023-06-23T19:34:02Z,"**Use case**
General Usage of the Method

**Describe the problem**
Running with default parameters and returning an error regarding Index out Range.

**Describe the solution you tried**
Tentative

**Additional context**
Please see attached logs. 
[HMM_RATAC_log.log](https://github.com/macs3-project/MACS/files/11273377/HMM_RATAC_log.log)

Anybody seen this error or know how to resolve it? 
Alignment files are from PE ATAC.",spirpinias,https://github.com/macs3-project/MACS/issues/559
I_kwDOABXaI85mZ-5k,Build local bias track from control with paired-end mode,OPEN,2023-05-20T07:35:54Z,2024-02-24T19:01:48Z,,"I'm using MACS2 (v2.2.7.1) to analyze ChIP-seq data. Both of the ChIP sample and the input control are sequenced with **paired-end** mode.

I ran `macs2 callpeak` with `-f BAMPE` and the program worked well. MACS2 was run in paired-end mode and the fragment size was detected based on the read pairs. But from the process information, I realized that the mean fragment size of control was ignored. Below is a part of process information I got:

```
#1 mean fragment size is determined as 282.9 bp from treatment 
#1 note: mean fragment size in control is 207.6 bp -- value ignored 
#1 fragment size = 282.9 
#1  total fragments in treatment: 114306603 
#1 user defined the maximum fragments... 
#1 filter out redundant fragments by allowing at most 1 identical fragment(s) 
#1  fragments after filtering in treatment: 114306603 
#1  Redundant rate of treatment: 0.00 
```
While I'm trying to figure out how exactly the program deal with the control sample, I found the Wiki page about MACS2 subcommands. [Advanced: Call peaks using MACS2 subcommands.](https://github.com/macs3-project/MACS/wiki/Advanced%3A-Call-peaks-using-MACS2-subcommands) This is very helpful, but unfortunately it does not work for paired-end data.

My question is, is lambda track for control sample still calculated in single-end mode even if `-f BAMPE` is set?
",xiaoxuanzhu,https://github.com/macs3-project/MACS/issues/560
I_kwDOABXaI85mygRF,Feat: xls output should have header line even if no peak has been detected,OPEN,2023-05-24T18:12:36Z,2023-06-07T18:30:10Z,,"#### Problem

Using macs 2.2.7.1 - If no peak is detected, the xls output file contains the comment lines prefixed `#` but it does not contain the header line:

```
chr     start   end     length  abs_summit      pileup  -log10(pvalue)  fold_enrichment -log10(qvalue)  name
```

#### Describe the solution you'd like

Output the comment lines AND the header line.

#### Describe alternatives you've considered

One can add the header line afterwards but it makes for clunky code. I would say the current behavior is inconsistent since getting no peaks is a possibility that should be reflected in a file with header and no records.",dariober,https://github.com/macs3-project/MACS/issues/561
I_kwDOABXaI85olcjP,Q: ChiP-seq of histone PTMs: Control Peaks not Aligned to Treatment Peaks,OPEN,2023-06-13T11:18:18Z,2023-06-13T11:18:18Z,,"**Use case**
I am processing ChiP-seq data of histone PTMs from yeast. The data comes with the input dataset for control. I have performed performed peak calling by executing MACS2 (v2.2.8) with the following command:

`macs2 callpeak -B -t treatment.bam -c control.bam -g 12157105 --keep-dup all -n output -q 0.05 --nomodel --shift 67 --extsize 43 --min-length 100 --max-gap 73`

The cross-correlation analysis shows the maximum peak value of 134 and the size of the tags is 60. Thus I decided to shift by 134/2=67 (rounded down). Assuming ideal nucleosome size of 147 and the middle of my tags are located at the peak, I extend the tags by 147/2 - (60/2) = 43 (rounded down).

**Describe the problem**
The pileup of the treatment data looks reasonable, however, the peaks of the background lambda derived from the control data are not aligned to the peaks from the treatment data:
<img src=""https://github.com/macs3-project/MACS/assets/2268615/e29287dc-c3a4-4e5e-9d5e-8833904ca24f"" width=20% height=20%>
The first track is my treatment and the second is the background lambda

**Describe the solution you tried**
After going through the MACS2 code, I find that the control data is not shifted at all:
https://github.com/macs3-project/MACS/blob/f350e8c3a7a4e5aa890dd31ad73cc7a4472e1d66/MACS2/IO/CallPeakUnit.pyx#L524-L526

I modified the code to become:

>                 ctrl_pv = self.ctrl.pileup_a_chromosome( chrom, self.ctrl_d_s, self.ctrl_scaling_factor_s,
>                                                          baseline_value = self.lambda_bg,
>                                                          directional = False,
>                                                          end_shift = self.end_shift )

And recompiled MACS2 and reran MASC2 on the data, this time I get:
<img src=""https://github.com/macs3-project/MACS/assets/2268615/bff8e41a-ff90-4cc7-9abf-7daf5981085a"" width=20% height=20%>
The first track is my treatment, second track is the previous background lambda and the third track is the latest background lambda

I am wondering if what I did here is reasonable?",capslockwizard,https://github.com/macs3-project/MACS/issues/562
I_kwDOABXaI85qN-yk,Bug: ,OPEN,2023-06-30T07:36:19Z,2023-06-30T16:31:56Z,,"**Describe the bug**
Bug in randsample

**To Reproduce**
A00679:511:HWJGJDSXY:4:2104:21847:12399 147     Chr1A   89      29      98M     =       113     -74     CCCTAACCTAAACCTACCTAAACCATACATTGTTCCATTGGCCAGAGGCTGTTCACCTTGGAGACCTGATGCGGTTATGAGTACGACCGGGCGTGAAC      FFFF::FFFF,FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF XA:Z:Chr1A_part1,-183855,6M1D92M,1;Chr1A_part1,-361405,6M1D92M,1;Chr1A_part1,+321535,90M1D8M,1;Chr1A_part1,-227337,6M1D92M,1;      MC:Z:25S73M     MD:Z:98 PG:Z:   NM:i:0  AS:i:98 XS:i:92
A00679:511:HWJGJDSXY:4:2104:21847:12399 99      Chr1A   113     29      25S73M  =       89      74      CACGTGAAGGACCAGAGCAACAGCTATACATTGTTCCATTGGCCAGAGGCTGTTCACCTTGGAGACCTGATGCGGTTATGAGTACGACCGGGCGTGAA      FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF:FFFFFFFFFFFFFFFFFFFFFFFFFFF MC:Z:98M        MD:Z:73 PG:Z:   NM:i:0  AS:i:73 XS:i:73

**Expected behavior**
Chr1A 88      186
But randsample give:
Chr1A 88      162

**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: Ubuntu 22.04.1
 - Python version 3.10.6
 - Numpy version 1.22.4
 - MACS Version macs3 3.0.0b2 @0c161d5

**Additional context**
The read pairs look outward. But a pysam-based script give 'Chr1A 88      186' which is consistent with manual check by IGV.
Where the '162' was calculated from? Was it related to the soft clipping?
I guess for a fragment, is it proper to just calculated minimum left and maximum right of the paired reads for each fragment?
",lufuhao,https://github.com/macs3-project/MACS/issues/564
I_kwDOABXaI85rq06O,NA,CLOSED,2023-07-16T01:10:54Z,2023-07-19T18:10:26Z,2023-07-19T18:10:26Z,,BenxiaHu,https://github.com/macs3-project/MACS/issues/566
I_kwDOABXaI85rtOZU,No effect on output called peaks by tuning nomodel+shift+extsize,OPEN,2023-07-17T05:41:51Z,2023-07-17T05:41:51Z,,"Dear Dr. Liu

I have two conditions for my ChIP-Seq experiment.
We observed ~10,000 called narrow peaks in 1 condition but ~1,000 in the other (FDR < 0.1)

So we asked if tuning some parameters of MACS2 (version 2.2.7) may affect the output called peaks.
I tried some different values of extsize with setting shift = 0 and used --nomodel. 
Then I also try different values of shift.

All results found same number of called narrow peaks (FDR < 0.1)

Is this a very expected outcome?
Are there any para should be examined first when users found too many or too few peaks are called?


Thanks!


Pei














",linpei26,https://github.com/macs3-project/MACS/issues/567
I_kwDOABXaI85sDloE,Q: The number of peaks,OPEN,2023-07-19T23:29:42Z,2023-07-19T23:29:42Z,,"Hi, 

When peak calling is applied to my chip-exo data, 100k to 400k peaks can be obtained. Can such a large number of peaks be considered normal? Adjusting the q-value still results in many peaks..

Thanks,
",jinheeeeee,https://github.com/macs3-project/MACS/issues/570
I_kwDOABXaI85sE4kD,Q: What is recommended command line for ATAC-Seq peak calling with bams from Paired End data,CLOSED,2023-07-20T06:00:55Z,2023-07-24T15:53:37Z,2023-07-24T15:53:37Z,"**Use case**
I have paired end ATACSeq data (hg38) and I would like to know the recommended command line for ATAC-Seq peak calling with bams from Paired End data

**Describe the problem**
There are too many threads, discussion topics etc and lack of a clearcut answer makes people take piecemeal command line arguments from different isuses, etc.  

Hence my questions: 

1. What's the recommended CLI for my use case? 
2. Should read shifting be compulsorily done (+4/-5) or is it purely optional 


**Describe the solution you tried**
Based on the above, I have tried this below and want to make sure with @EvanTarbell and @taoliu  if I am not missing anything
- _do not do any shifting before peak calling_ with the assumption that the macs2 callpeak defaults will take care of this
- _generate $no_chrM_and_mapq_filtered_blacklist_removed_bam_: start with bam after bwa-mem, remove chrM + filter for mapq < 5 + exclude blacklisted regions using data from here: https://mitra.stanford.edu/kundaje/akundaje/release/blacklists/hg38-human/
- **_Use this command line_**:   `macs2 callpeak -f BAMPE -g hs --keep-dup 1 --min-length 100 --call-summits -q 0.05 --bdg -t $no_chrM_and_mapq_filtered_blacklist_removed_bam`


**Additional context**
Based on reading many different sources, this seems to be the closest to a recommended answer - https://github.com/macs3-project/MACS/issues/145#issuecomment-248369119. However, 
-  https://twitter.com/XiChenUoM/status/1336658454866325506  suggests `convert paired BAM to simple BED file and use ""-f BED --shift -100 --extsize 200"" `
and then a counter to it from @EvanTarbell here
- https://twitter.com/epigeneticsnerd/status/1337081679589101576 suggests that `BAMPE and --call-summits` is enough with macs2 

I know there are many recommendations like ""switch to macs3, hmmratac, Genrich"" - I would still like to know how to use `macs2 callpeak` given what I describe above.

Thanks in advance.",tamuanand,https://github.com/macs3-project/MACS/issues/571
I_kwDOABXaI85sN_qU,Two lines in Signal/PeakVariants.pyx causing installation errors,CLOSED,2023-07-21T10:59:12Z,2024-02-24T20:45:29Z,2024-02-24T20:45:28Z,"Since I eventually managed to fix the bug, I will be brief in describing the problem itself.

When installing MACS3-3.0.0b2 via pip, the following error message occurred:

```
[14/25] Cythonizing MACS3/Signal/PeakVariants.pyx
      Traceback (most recent call last):
        File ""/home/user/envs/macs2/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py"", line 363, in <module>
          main()
        File ""/home/user/envs/macs2/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py"", line 345, in main
          json_out['return_val'] = hook(**hook_input['kwargs'])
        File ""/home/user/envs/macs2/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py"", line 130, in get_requires_for_build_wheel
          return hook(config_settings)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/setuptools/build_meta.py"", line 341, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=['wheel'])
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/setuptools/build_meta.py"", line 323, in _get_build_requires
          self.run_setup()
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/setuptools/build_meta.py"", line 487, in run_setup
          super(_BuildMetaLegacyBackend,
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/setuptools/build_meta.py"", line 338, in run_setup
          exec(code, locals())
        File ""<string>"", line 156, in <module>
        File ""<string>"", line 152, in main
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Build/Dependencies.py"", line 1134, in cythonize
          cythonize_one(*args)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Build/Dependencies.py"", line 1280, in cythonize_one
          result = compile_single(pyx_file, options, full_module_name=full_module_name)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Main.py"", line 615, in compile_single
          return run_pipeline(source, options, full_module_name)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Main.py"", line 539, in run_pipeline
          err, enddata = Pipeline.run_pipeline(pipeline, source)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Pipeline.py"", line 398, in run_pipeline
          data = run(phase, data)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Pipeline.py"", line 375, in run
          return phase(data)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Pipeline.py"", line 52, in generate_pyx_code_stage
          module_node.process_implementation(options, result)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ModuleNode.py"", line 222, in process_implementation
          self.generate_c_code(env, options, result)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ModuleNode.py"", line 516, in generate_c_code
          self.body.generate_function_definitions(env, code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 404, in generate_function_definitions
          stat.generate_function_definitions(env, code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 5497, in generate_function_definitions
          self.body.generate_function_definitions(self.scope, code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 404, in generate_function_definitions
          stat.generate_function_definitions(env, code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 404, in generate_function_definitions
          stat.generate_function_definitions(env, code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 2197, in generate_function_definitions
          self.generate_function_body(env, code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 1953, in generate_function_body
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 7528, in generate_execution_code
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 7109, in generate_execution_code
          if_clause.generate_execution_code(code, end_label, is_last=i == last)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 7156, in generate_execution_code
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 7109, in generate_execution_code
          if_clause.generate_execution_code(code, end_label, is_last=i == last)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 7156, in generate_execution_code
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 7109, in generate_execution_code
          if_clause.generate_execution_code(code, end_label, is_last=i == last)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 7156, in generate_execution_code
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 5998, in generate_execution_code
          self.generate_rhs_evaluation_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/Nodes.py"", line 6297, in generate_rhs_evaluation_code
          self.rhs.generate_evaluation_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ExprNodes.py"", line 11840, in generate_evaluation_code
          super(NumBinopNode, self).generate_evaluation_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ExprNodes.py"", line 831, in generate_evaluation_code
          self.generate_subexpr_evaluation_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ExprNodes.py"", line 846, in generate_subexpr_evaluation_code
          node.generate_evaluation_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ExprNodes.py"", line 831, in generate_evaluation_code
          self.generate_subexpr_evaluation_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ExprNodes.py"", line 846, in generate_subexpr_evaluation_code
          node.generate_evaluation_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ExprNodes.py"", line 837, in generate_evaluation_code
          self.generate_result_code(code)
        File ""/tmp/pip-build-env-axzar69u/overlay/lib/python3.10/site-packages/Cython/Compiler/ExprNodes.py"", line 4498, in generate_result_code
          assert False, ""unexpected type %s and base type %s for indexing (%s)"" % (
      AssertionError: unexpected type Py_UCS4 and base type Python object for indexing ((<FileSourceDescriptor:/home/user/envs/macs2/lib/python3.10/site-packages/MACS3-3.0.0b2/MACS3/Signal/PeakVariants.pyx>, 326, 79))
```

I asked ChatGPT to identify and fix the error, and eventually found out that changing lines 326 & 327 in PeakVariants.pyx into the following resolved the problem.

``` python
self.d_Variants[ p-1 ][""ref_allele""] = str(self.refseq).encode('ascii', 'ignore').decode()[ p - self.start ] + self.d_Variants[ p-1 ][""ref_allele""]
self.d_Variants[ p-1 ][""alt_allele""] = str(self.refseq).encode('ascii', 'ignore').decode()[ p - self.start ]
```

Since I have limited knowledge in programming, I don't know exactly what was the root cause of the problem. I am also perplexed that there seems to be virtually nobody that have faced a similar issue. Nevertheless, I decided to share my experiences just in case it could help someone in trouble.


**System (please complete the following information):**
 - OS: Linux
 - Python version: 3.11.4 (but the same phenomenon could be reproduced also in environments using 3.10 or 3.9)
 - Numpy version: 1.25.1
 - MACS Version: 3.0.0b2
",franciskim-yonsei,https://github.com/macs3-project/MACS/issues/572
I_kwDOABXaI85sXfZz,Bug:  MACS3 can't installed by pip,CLOSED,2023-07-24T10:13:49Z,2023-08-02T17:59:56Z,2023-08-02T17:59:56Z,"**Describe the bug**
A clear and concise description of what the bug is.
(atac3) [dengy@mu01 Signal]$ pip install cython==0.29.33
Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple
Collecting cython==0.29.33
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/1f/a7/0e28ae6605a3b79724eb0df6e48fd3a654e2bf059e5aacb5074b92258948/Cython-0.29.33-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (1.9 MB)
Installing collected packages: cython
  Attempting uninstall: cython
    Found existing installation: Cython 3.0.0
    Uninstalling Cython-3.0.0:
      Successfully uninstalled Cython-3.0.0
Successfully installed cython-0.29.33
(atac3) [dengy@mu01 Signal]$ pip install macs3
Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple
Collecting macs3
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/2a/3f/600ae5656310e4ba6861bfe53b985c424e0e0855a27c0962bb03b0df9970/MACS3-3.0.0b2.tar.gz (641 kB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... error
  error: subprocess-exited-with-error
  
  × Getting requirements to build wheel did not run successfully.
  │ exit code: 1
  ╰─> [140 lines of output]
      Compiling MACS3/Signal/HMMR_EM.pyx because it changed.
      Compiling MACS3/Signal/HMMR_Signal_Processing.pyx because it changed.
      Compiling MACS3/Signal/HMMR_HMM.pyx because it changed.
      Compiling MACS3/Signal/Prob.pyx because it changed.
      Compiling MACS3/Signal/Region.pyx because it changed.
      Compiling MACS3/Signal/Pileup.pyx because it changed.
      Compiling MACS3/Signal/PileupV2.pyx because it changed.
      Compiling MACS3/Signal/PeakModel.pyx because it changed.
      Compiling MACS3/Signal/PeakDetect.pyx because it changed.
      Compiling MACS3/Signal/SignalProcessing.pyx because it changed.
      Compiling MACS3/Signal/FixWidthTrack.pyx because it changed.
      Compiling MACS3/Signal/PairedEndTrack.pyx because it changed.
      Compiling MACS3/Signal/BedGraph.pyx because it changed.
      Compiling MACS3/Signal/ScoreTrack.pyx because it changed.
      Compiling MACS3/Signal/CallPeakUnit.pyx because it changed.
      Compiling MACS3/Signal/VariantStat.pyx because it changed.
      Compiling MACS3/Signal/ReadAlignment.pyx because it changed.
      Compiling MACS3/Signal/RACollection.pyx because it changed.
      Compiling MACS3/Signal/UnitigRACollection.pyx because it changed.
      Compiling MACS3/Signal/PosReadsInfo.pyx because it changed.
      Compiling MACS3/Signal/PeakVariants.pyx because it changed.
      Compiling MACS3/IO/Parser.pyx because it changed.
      Compiling MACS3/IO/PeakIO.pyx because it changed.
      Compiling MACS3/IO/BedGraphIO.pyx because it changed.
      Compiling MACS3/IO/BAM.pyx because it changed.
      [ 1/25] Cythonizing MACS3/IO/BAM.pyx
      [ 2/25] Cythonizing MACS3/IO/BedGraphIO.pyx
      [ 3/25] Cythonizing MACS3/IO/Parser.pyx
      [ 4/25] Cythonizing MACS3/IO/PeakIO.pyx
      [ 5/25] Cythonizing MACS3/Signal/BedGraph.pyx
      [ 6/25] Cythonizing MACS3/Signal/CallPeakUnit.pyx
      [ 7/25] Cythonizing MACS3/Signal/FixWidthTrack.pyx
      [ 8/25] Cythonizing MACS3/Signal/HMMR_EM.pyx
      [ 9/25] Cythonizing MACS3/Signal/HMMR_HMM.pyx
      [10/25] Cythonizing MACS3/Signal/HMMR_Signal_Processing.pyx
      [11/25] Cythonizing MACS3/Signal/PairedEndTrack.pyx
      [12/25] Cythonizing MACS3/Signal/PeakDetect.pyx
      [13/25] Cythonizing MACS3/Signal/PeakModel.pyx
      [14/25] Cythonizing MACS3/Signal/PeakVariants.pyx
      Traceback (most recent call last):
        File ""/home/dengy/miniconda3/envs/atac3/lib/python3.11/site-packages/pip/_vendor/pyproject_hooks/_in_process/_in_process.py"", line 353, in <module>
          main()
        File ""/home/dengy/miniconda3/envs/atac3/lib/python3.11/site-packages/pip/_vendor/pyproject_hooks/_in_process/_in_process.py"", line 335, in main
          json_out['return_val'] = hook(**hook_input['kwargs'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""/home/dengy/miniconda3/envs/atac3/lib/python3.11/site-packages/pip/_vendor/pyproject_hooks/_in_process/_in_process.py"", line 118, in get_requires_for_build_wheel
          return hook(config_settings)
                 ^^^^^^^^^^^^^^^^^^^^^
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/setuptools/build_meta.py"", line 341, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=['wheel'])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/setuptools/build_meta.py"", line 323, in _get_build_requires
          self.run_setup()
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/setuptools/build_meta.py"", line 488, in run_setup
          self).run_setup(setup_script=setup_script)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/setuptools/build_meta.py"", line 338, in run_setup
          exec(code, locals())
        File ""<string>"", line 156, in <module>
        File ""<string>"", line 152, in main
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Build/Dependencies.py"", line 1134, in cythonize
          cythonize_one(*args)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Build/Dependencies.py"", line 1280, in cythonize_one
          result = compile_single(pyx_file, options, full_module_name=full_module_name)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Main.py"", line 615, in compile_single
          return run_pipeline(source, options, full_module_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Main.py"", line 539, in run_pipeline
          err, enddata = Pipeline.run_pipeline(pipeline, source)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Pipeline.py"", line 398, in run_pipeline
          data = run(phase, data)
                 ^^^^^^^^^^^^^^^^
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Pipeline.py"", line 375, in run
          return phase(data)
                 ^^^^^^^^^^^
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Pipeline.py"", line 52, in generate_pyx_code_stage
          module_node.process_implementation(options, result)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ModuleNode.py"", line 222, in process_implementation
          self.generate_c_code(env, options, result)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ModuleNode.py"", line 516, in generate_c_code
          self.body.generate_function_definitions(env, code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 404, in generate_function_definitions
          stat.generate_function_definitions(env, code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 5497, in generate_function_definitions
          self.body.generate_function_definitions(self.scope, code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 404, in generate_function_definitions
          stat.generate_function_definitions(env, code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 404, in generate_function_definitions
          stat.generate_function_definitions(env, code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 2197, in generate_function_definitions
          self.generate_function_body(env, code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 1953, in generate_function_body
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 7528, in generate_execution_code
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 7109, in generate_execution_code
          if_clause.generate_execution_code(code, end_label, is_last=i == last)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 7156, in generate_execution_code
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 7109, in generate_execution_code
          if_clause.generate_execution_code(code, end_label, is_last=i == last)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 7156, in generate_execution_code
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 7109, in generate_execution_code
          if_clause.generate_execution_code(code, end_label, is_last=i == last)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 7156, in generate_execution_code
          self.body.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 410, in generate_execution_code
          stat.generate_execution_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 5998, in generate_execution_code
          self.generate_rhs_evaluation_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/Nodes.py"", line 6297, in generate_rhs_evaluation_code
          self.rhs.generate_evaluation_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ExprNodes.py"", line 11840, in generate_evaluation_code
          super(NumBinopNode, self).generate_evaluation_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ExprNodes.py"", line 831, in generate_evaluation_code
          self.generate_subexpr_evaluation_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ExprNodes.py"", line 846, in generate_subexpr_evaluation_code
          node.generate_evaluation_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ExprNodes.py"", line 831, in generate_evaluation_code
          self.generate_subexpr_evaluation_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ExprNodes.py"", line 846, in generate_subexpr_evaluation_code
          node.generate_evaluation_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ExprNodes.py"", line 837, in generate_evaluation_code
          self.generate_result_code(code)
        File ""/tmp/pip-build-env-eafvjtoy/overlay/lib/python3.11/site-packages/Cython/Compiler/ExprNodes.py"", line 4498, in generate_result_code
          assert False, ""unexpected type %s and base type %s for indexing (%s)"" % (
      AssertionError: unexpected type Py_UCS4 and base type Python object for indexing ((<FileSourceDescriptor:/tmp/pip-install-wurule1s/macs3_ffea73acdef3455e9ecd582c056e5553/MACS3/Signal/PeakVariants.pyx>, 326, 79))
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
error: subprocess-exited-with-error

× Getting requirements to build wheel did not run successfully.
│ exit code: 1
╰─> See above for output.

note: This error originates from a subprocess, and is likely not a problem with pip.

**To Reproduce**
Steps to reproduce the behavior. If possible, could you share the data with us?

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**System (please complete the following information):**
 - OS: Linux
 - Python version 3.11.0
 - Numpy version 1.24.2
 - MACS Version [e.g. 2.2.4]

**Additional context**
Add any other context about the problem here.
",dengyang111,https://github.com/macs3-project/MACS/issues/574
I_kwDOABXaI85s37y3,Bug: Overly large fragment causes zeroDivision error while calculating weights for four signal tracks.,CLOSED,2023-07-28T15:10:45Z,2023-08-01T17:57:40Z,2023-08-01T17:57:40Z,"Has this issue been solved? I've been using macs3 3.0.0b2 but still encounter that. I'm using this data from ENCODE: ENCFF346MIJ. You can get to the file by https://www.encodeproject.org/files/ENCFF346MIJ/   @philippadoherty 
Thank you!

_Originally posted by @StevenKrzysztof in https://github.com/macs3-project/MACS/issues/531#issuecomment-1654017952_
            ",taoliu,https://github.com/macs3-project/MACS/issues/577
I_kwDOABXaI85tSye3,Feat: Support for CRAM,OPEN,2023-08-02T17:47:39Z,2023-08-03T15:08:06Z,,"For genomes with long chromosomes (like Marsupials) one cannot create BAM index files -- only CRAM with CSI files.  For some commands like callpeak, these cram files can be converted into bed files, but for other commands like hmmratac, it seems like BAM is the only option.

",bcantarel,https://github.com/macs3-project/MACS/issues/578
I_kwDOABXaI85tY-Vx,Feat: Support to output multiple output formats when using hmmratac mode,OPEN,2023-08-03T15:14:59Z,2023-08-03T15:20:59Z,,"Hello, 

Thank you for adding additional parameters in hmmratac in the new version.

Could you please add multiple output formats files  when using macs3 hmmratac mode

1) peaks in bed or bedgraph output format would be good for downstream analysis since many tools either narrow peaks file , BED file or BEDgraph as input.

2) summits.bed based on https://github.com/LiuLabUB/HMMRATAC/blob/master/HMMRATAC_Guide.md#output-files since the summits tend to be better indicative of TF binding as opposed to peak centers,

Thankyou 
Regards
Ketaki",ketakibhide,https://github.com/macs3-project/MACS/issues/581
I_kwDOABXaI85tZzWz,Q: how do slocal amd llocal work with open/closed chromatin domains?,OPEN,2023-08-03T17:45:50Z,2023-08-03T17:45:50Z,,"Hello everyone,

I found this text from MACS2 document

> By default, MACS considers 1000bp for small local region(--slocal), and 10000bps for large local region(--llocal) which captures the bias from a long-range effect like an open chromatin domain.

Could anyone please help provide some more explanation?

I guess that this means that if an open chromatin domain was encountered, it would be better for MACS2 to compute a local lambda by scanning a larger local region, rather than a small one. If not an open chromatin, scanning a small local region should be good enough.

Am I right?

However, I feel that at the whole genome scale, one may find some regions within open chromatin domain while other regions not. But peaks could be found in both types of regions. How does MACS2 determine whether small or large local region should be invoked?

Thanks!
",linpei26,https://github.com/macs3-project/MACS/issues/582
I_kwDOABXaI85tauG0,Bug: Getting requirements to build wheel ... error,CLOSED,2023-08-03T20:52:49Z,2023-08-04T22:22:09Z,2023-08-04T22:22:09Z,"Hi All, I am having issue with installing MACS3.  Really appreciated to have your help. Thanks!


-> pip list
Package    Version
---------- -------
Cython     0.29.24
pip        23.2.1
setuptools 65.5.0
-> pip install macs3
Collecting macs3
  Using cached MACS3-3.0.0b3.tar.gz (648 kB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... error
  error: subprocess-exited-with-error

  × Getting requirements to build wheel did not run successfully.
  │ exit code: 1
  ╰─> [33 lines of output]
      Traceback (most recent call last):
        File ""C:\Users\bosun\my_envMACS3\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py"", line 353, in <module>
          main()
        File ""C:\Users\bosun\my_envMACS3\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py"", line 335, in main
          json_out['return_val'] = hook(**hook_input['kwargs'])
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\bosun\my_envMACS3\Lib\site-packages\pip\_vendor\pyproject_hooks\_in_process\_in_process.py"", line 118, in get_requires_for_build_wheel
          return hook(config_settings)
                 ^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\bosun\AppData\Local\Temp\pip-build-env-vs508use\overlay\Lib\site-packages\setuptools\build_meta.py"", line 341, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=['wheel'])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\bosun\AppData\Local\Temp\pip-build-env-vs508use\overlay\Lib\site-packages\setuptools\build_meta.py"", line 323, in _get_build_requires
          self.run_setup()
        File ""C:\Users\bosun\AppData\Local\Temp\pip-build-env-vs508use\overlay\Lib\site-packages\setuptools\build_meta.py"", line 488, in run_setup
          self).run_setup(setup_script=setup_script)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\bosun\AppData\Local\Temp\pip-build-env-vs508use\overlay\Lib\site-packages\setuptools\build_meta.py"", line 338, in run_setup
          exec(code, locals())
        File ""<string>"", line 156, in <module>
        File ""<string>"", line 72, in main
        File ""C:\Users\bosun\AppData\Local\anaconda3\Lib\subprocess.py"", line 466, in check_output
          return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\bosun\AppData\Local\anaconda3\Lib\subprocess.py"", line 548, in run
          with Popen(*popenargs, **kwargs) as process:
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File ""C:\Users\bosun\AppData\Local\anaconda3\Lib\subprocess.py"", line 1024, in __init__
          self._execute_child(args, executable, preexec_fn, close_fds,
        File ""C:\Users\bosun\AppData\Local\anaconda3\Lib\subprocess.py"", line 1509, in _execute_child
          hp, ht, pid, tid = _winapi.CreateProcess(executable, args,
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      FileNotFoundError: [WinError 2] The system cannot find the file specified
      [end of output]

  note: This error originates from a subprocess, and is likely not a problem with pip.
error: subprocess-exited-with-error

× Getting requirements to build wheel did not run successfully.
│ exit code: 1
╰─> See above for output.


**Additional context**
Add any other context about the problem here.
",bsunbo,https://github.com/macs3-project/MACS/issues/583
I_kwDOABXaI85trx1l,Bug: MACS3 ZeroDivisionError: float division,CLOSED,2023-08-07T20:54:00Z,2024-02-20T14:41:41Z,2024-02-20T14:41:41Z,"Hi All,

I am having issue with peak calling for my ATACseq data. Really appreciate for your help!

#macs3 callpeak -f BAMPE -t ATAC_50K_2.sorted_openRegions.bam_openRegions.bam -g hs -n test -B -q 0.01
INFO  @ 07 Aug 2023 13:49:10: [52 MB]
# Command line: callpeak -f BAMPE -t ATAC_50K_2.sorted_openRegions.bam_openRegions.bam -g hs -n test -B -q 0.01
# ARGUMENTS LIST:
# name = test
# format = BAMPE
# ChIP-seq file = ['ATAC_50K_2.sorted_openRegions.bam_openRegions.bam']
# control file = None
# effective genome size = 2.91e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 1.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length ""d"".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is on

INFO  @ 07 Aug 2023 13:49:10: [52 MB] #1 read fragment files...
INFO  @ 07 Aug 2023 13:49:10: [52 MB] #1 read treatment fragments...
INFO  @ 07 Aug 2023 13:49:10: [71 MB] 0 fragments have been read.
Traceback (most recent call last):
  File ""/usr/local/bin/macs3"", line 1010, in <module>
    main()
  File ""/usr/local/bin/macs3"", line 49, in main
    run( args )
  File ""/home/adduser/.local/lib/python3.10/site-packages/MACS3/Commands/callpeak_cmd.py"", line 68, in run
    (treat, control) = load_frag_files_options (options)
  File ""/home/adduser/.local/lib/python3.10/site-packages/MACS3/Commands/callpeak_cmd.py"", line 325, in load_frag_files_options
    treat = tp.build_petrack()
  File ""MACS3/IO/Parser.pyx"", line 1304, in MACS3.IO.Parser.BAMPEParser.build_petrack
  File ""MACS3/IO/Parser.pyx"", line 1348, in MACS3.IO.Parser.BAMPEParser.build_petrack
ZeroDivisionError: float division


**Here is my .bam file info**

#samtools flagstat ATAC_50K_2.sorted_openRegions.bam_openRegions.bam
209664 + 0 in total (QC-passed reads + QC-failed reads)
209664 + 0 primary
0 + 0 secondary
0 + 0 supplementary
0 + 0 duplicates
0 + 0 primary duplicates
209664 + 0 mapped (100.00% : N/A)
209664 + 0 primary mapped (100.00% : N/A)
209664 + 0 paired in sequencing
104832 + 0 read1
104832 + 0 read2
0 + 0 properly paired (0.00% : N/A)
209664 + 0 with itself and mate mapped
0 + 0 singletons (0.00% : N/A)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)

**System (please complete the following information):**
 - OS: [e.g. Linux, Mac OSX] Linux
 - Python version [e.g. 3.7.1] 3.10
 - Numpy version [e.g. 1.17.0]1.25.2
 - MACS Version [e.g. 2.2.4]3.0.0b3

**Additional context**
Add any other context about the problem here.
",bsunbo,https://github.com/macs3-project/MACS/issues/584
I_kwDOABXaI85tsoio,Q: multi sample comparison (scATAC),OPEN,2023-08-08T01:26:58Z,2023-08-08T01:26:58Z,,"Hi @taoliu 

Thanks for the wonderful tool!

I've been trying to use the tool (MACS2) for my ATAC data.
I have multiple scATAC samples and I would love to compare there general accessibility. 
For example, to see whether different levels of treatment of some sort or a natural developmental process changes the general accessibility of the overall chromosomes.

1. I've been trying to thoroughly study MACS setup and read through other discussions on the github, but I am still a bit unsure as to what would be the best way to compare these among different samples with different library depth.

2. What would you recommend as the best output to compare what I wanna compare. (callpeak -> -bdg, bedgraph files?)

3. Would you consider --SPMR necessary and sufficient for this purpose (comparing multiple samples) or some sort of extra normalization necessary considering how there would be no control data for ATAC-seq and thus --nolambda option used for the callpeak.

Best!

",revolvefire,https://github.com/macs3-project/MACS/issues/585
I_kwDOABXaI85ttIJJ,Q: Why peak region didn't appear with lower q-value than cut-off,OPEN,2023-08-08T04:33:34Z,2024-03-06T14:51:56Z,,"**Use case**
I run macs2 with below command per q-value cut-off 0.05, 0.1 and 0.5
`macs2 callpeak -f BAMPE -g hs -n sample_ID -t sample_remove_duplicate_mito.bam --outdir ./peak --min-length 100 --q 0.1`

**Describe the problem**
A clear and concise description of what happend.
When I visualize macs2 results (narrowPeak), some region is differ with q-value 0.05 and q-value 0.1 or 0.5.
Of course It is possible that some peaks couldn't be filtered strict cut-off 0.05. But in my case, that region was demonstrated that the q-value is lower that 0.0005 in narrowPeak file which was generated with q-value 0.1 and q-value 0.5.
Why this region didn't appeared with q-value 0.05 (default) option?

**Describe the solution you tried**
A clear and concise description of any solutions you've tried.
I use several options such as --nomodel, -B, --nolambda
But the specific region didn't appeared with q-value 0.05

**Additional context**
Add any other context or screenshots about your use case here.
The region that has problem is below
q-value 0.1
chr15   58203995        58204158        mHeart_RT1_DNA_peak_954 52      .       6.79179 10.0781 5.2493  42
![image](https://github.com/macs3-project/MACS/assets/109505999/6b8e3247-0023-4f59-a26a-4448e76b18d8)

q-value 0.5
chr15   58203994        58204167        mHeart_RT1_DNA_peak_7137        52      .       6.79179 10.0781 5.2493  43
![image](https://github.com/macs3-project/MACS/assets/109505999/b8e3e73e-8ae9-4076-9f22-fd3825888cc2)

q-value 0.05
The region didn't exist
![image](https://github.com/macs3-project/MACS/assets/109505999/8a20f583-a660-4ae2-bb09-c1e726c735ef)

The IGV screenshot that located in specific region is here.
There are bam coverage and bam file fragment information.
![image](https://github.com/macs3-project/MACS/assets/109505999/3b58011a-469e-4602-b449-91631aaba5fb)
",khsjh,https://github.com/macs3-project/MACS/issues/586
I_kwDOABXaI85vEJGn,Bug: ,CLOSED,2023-08-23T13:36:28Z,2023-08-28T15:40:47Z,2023-08-28T15:40:47Z,"**Describe the bug**
pip install MACS3 
or 
pip3 install git+https://github.com/macs3-project/MACS.git@v3.0.0b3
downgrade Cython to version 0.29

**To Reproduce**
pip install MACS3 
or
pip3 install git+https://github.com/macs3-project/MACS.git@v3.0.0b3

**Expected behavior**
dont touch Cython

```
-su-5.1$ pip3 install git+https://github.com/macs3-project/MACS.git@v3.0.0b3
Collecting git+https://github.com/macs3-project/MACS.git@v3.0.0b3
  Cloning https://github.com/macs3-project/MACS.git (to revision v3.0.0b3) to /scratch/local/pip-req-build-mhh76d2l
  Running command git clone --filter=blob:none --quiet https://github.com/macs3-project/MACS.git /scratch/local/pip-req-build-mhh76d2l
  Running command git checkout -q 076ee83c7c13ba61d570dc58e277d745dcad363f
  Resolved https://github.com/macs3-project/MACS.git to commit 076ee83c7c13ba61d570dc58e277d745dcad363f
  Running command git submodule update --init --recursive -q
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Requirement already satisfied: numpy>=1.19 in ./python-3.10.12-0/lib/python3.10/site-packages (from MACS3==3.0.0b3) (1.23.4)
Requirement already satisfied: hmmlearn>=0.3 in ./python-3.10.12-0/lib/python3.10/site-packages (from MACS3==3.0.0b3) (0.3.0)
Requirement already satisfied: cykhash<3.0,>=2.0 in ./python-3.10.12-0/lib/python3.10/site-packages (from MACS3==3.0.0b3) (2.0.1)
Collecting Cython~=0.29 (from MACS3==3.0.0b3)
  Obtaining dependency information for Cython~=0.29 from https://files.pythonhosted.org/packages/f8/26/ca0f1bb049b83c25cafa39f3fa5287c826a6ab36e665c906209e07f4deac/Cython-0.29.36-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata
  Using cached Cython-0.29.36-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata (3.1 kB)
Requirement already satisfied: scikit-learn!=0.22.0,>=0.16 in ./python-3.10.12-0/lib/python3.10/site-packages (from hmmlearn>=0.3->MACS3==3.0.0b3) (1.3.0)
Requirement already satisfied: scipy>=0.19 in ./python-3.10.12-0/lib/python3.10/site-packages (from hmmlearn>=0.3->MACS3==3.0.0b3) (1.11.2)
Requirement already satisfied: joblib>=1.1.1 in ./python-3.10.12-0/lib/python3.10/site-packages (from scikit-learn!=0.22.0,>=0.16->hmmlearn>=0.3->MACS3==3.0.0b3) (1.3.2)
Requirement already satisfied: threadpoolctl>=2.0.0 in ./python-3.10.12-0/lib/python3.10/site-packages (from scikit-learn!=0.22.0,>=0.16->hmmlearn>=0.3->MACS3==3.0.0b3) (3.2.0)
Using cached Cython-0.29.36-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (1.9 MB)
Installing collected packages: Cython
  Attempting uninstall: Cython
    Found existing installation: Cython 3.0.0
    Uninstalling Cython-3.0.0:
      Successfully uninstalled Cython-3.0.0
Successfully installed Cython-0.29.36
```

**System (please complete the following information):**
 - OS: [e.g. Linux, Mac OSX]
 - Python version 3.10.12
 - Numpy version 1.23.4
 - MACS Version 3.0.0b3

Comment
commit c3c81fb create the behavior",david2905,https://github.com/macs3-project/MACS/issues/591
I_kwDOABXaI85vSkBp,gapped peak column 13 through 15 ,OPEN,2023-08-25T14:15:38Z,2024-03-06T17:43:24Z,,"Hello,

I am using macs3 hmmratac mode for ATAC-Seq samples without control samples. I am getting 0 value for columns 13 through 15 in accessible peaks output. Is this related to no control samples? Also, could you please point me to column headers for all the columns in gappedpeak output file.


Regards
Ketaki Bhide",ketakibhide,https://github.com/macs3-project/MACS/issues/592
I_kwDOABXaI85vvvDE,hmmratac adjust means and standard deviation,OPEN,2023-08-31T04:54:36Z,2023-09-08T16:03:50Z,,"Hi all,

When running hmmratac for one of my samples, using --cutoff-analysis-only, I get this message:

""ValueError: adjust --means and --stddev options and re-run command.""

I'm not sure if this is intended behavior or not. Is it possible to get more clarity on this error message, such as why this is happening, and hopefully some general guidelines?
",LinearParadox,https://github.com/macs3-project/MACS/issues/593
I_kwDOABXaI85xDc4w,Bug: `LINK : fatal error LNK1181: cannot open input file 'm.lib'`,CLOSED,2023-09-14T14:43:47Z,2024-10-03T14:46:28Z,2024-10-03T14:46:28Z,"Hello 

When I install `macs2`

```
python -m pip install MACS2                                                                  1 09/14/2023 10:14:38 AM
Collecting MACS2
  Using cached MACS2-2.2.9.1.tar.gz (2.0 MB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Requirement already satisfied: numpy>=1.19 in c:\users\lidan\miniconda311\lib\site-packages (from MACS2) (1.24.4)
Collecting Cython~=0.29 (from MACS2)
  Using cached Cython-0.29.36-py2.py3-none-any.whl (988 kB)
Building wheels for collected packages: MACS2
  Building wheel for MACS2 (pyproject.toml) ... error
  error: subprocess-exited-with-error

  × Building wheel for MACS2 (pyproject.toml) did not run successfully.
  │ exit code: 1
  ╰─> [42 lines of output]
      running bdist_wheel
      running build
      running build_py
      creating build
      creating build\lib.win-amd64-cpython-311
      creating build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\bdgbroadcall_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\bdgcmp_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\bdgdiff_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\bdgopt_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\bdgpeakcall_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\callpeak_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\cmbreps_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\Constants.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\diffpeak_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\filterdup_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\OptValidator.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\OutputWriter.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\pileup_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\predictd_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\randsample_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\refinepeak_cmd.py -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\__init__.py -> build\lib.win-amd64-cpython-311\MACS2
      creating build\lib.win-amd64-cpython-311\MACS2\IO
      copying MACS2\IO\__init__.py -> build\lib.win-amd64-cpython-311\MACS2\IO
      copying MACS2\cPosValCalculation.pxd -> build\lib.win-amd64-cpython-311\MACS2
      copying MACS2\khash.pxd -> build\lib.win-amd64-cpython-311\MACS2
      running build_ext
      building 'MACS2.Prob' extension
      creating build\temp.win-amd64-cpython-311
      creating build\temp.win-amd64-cpython-311\Release
      creating build\temp.win-amd64-cpython-311\Release\MACS2
      ""C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\VC\Tools\MSVC\14.29.30133\bin\HostX86\x64\cl.exe"" /c /nologo /O2 /W3 /GL /DNDEBUG /MD -IC:\Users\lidan\AppData\Local\Temp\pip-build-env-a10kuf5n\overlay\Lib\site-packages\numpy\core\include -IC:\Users\lidan\miniconda311\include -IC:\Users\lidan\miniconda311\Include ""-IC:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\VC\Tools\MSVC\14.29.30133\include"" ""-IC:\Program Files (x86)\Windows Kits\NETFXSDK\4.8\include\um"" ""-IC:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\ucrt"" ""-IC:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\shared"" ""-IC:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\um"" ""-IC:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\winrt"" ""-IC:\Program Files (x86)\Windows Kits\10\include\10.0.19041.0\cppwinrt"" /TcMACS2/Prob.c /Fobuild\temp.win-amd64-cpython-311\Release\MACS2/Prob.obj -w -O3 -ffast-math -g0
      cl : Command line warning D9025 : overriding '/W3' with '/w'
      cl : Command line warning D9002 : ignoring unknown option '-O3'
      cl : Command line warning D9002 : ignoring unknown option '-ffast-math'
      cl : Command line warning D9002 : ignoring unknown option '-g0'
      Prob.c
      C:\Users\lidan\AppData\Local\Temp\pip-build-env-a10kuf5n\overlay\Lib\site-packages\numpy\core\include\numpy\npy_1_7_deprecated_api.h(14) : Warning Msg: Using deprecated NumPy API, disable it with #define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION
      ""C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\VC\Tools\MSVC\14.29.30133\bin\HostX86\x64\link.exe"" /nologo /INCREMENTAL:NO /LTCG /DLL /MANIFEST:EMBED,ID=2 /MANIFESTUAC:NO /LIBPATH:C:\Users\lidan\miniconda311\libs /LIBPATH:C:\Users\lidan\miniconda311 /LIBPATH:C:\Users\lidan\miniconda311\PCbuild\amd64 ""/LIBPATH:C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\VC\Tools\MSVC\14.29.30133\lib\x64"" ""/LIBPATH:C:\Program Files (x86)\Windows Kits\NETFXSDK\4.8\lib\um\x64"" ""/LIBPATH:C:\Program Files (x86)\Windows Kits\10\lib\10.0.19041.0\ucrt\x64"" ""/LIBPATH:C:\Program Files (x86)\Windows Kits\10\lib\10.0.19041.0\um\x64"" m.lib /EXPORT:PyInit_Prob build\temp.win-amd64-cpython-311\Release\MACS2/Prob.obj /OUT:build\lib.win-amd64-cpython-311\MACS2\Prob.cp311-win_amd64.pyd /IMPLIB:build\temp.win-amd64-cpython-311\Release\MACS2\Prob.cp311-win_amd64.lib
      LINK : fatal error LNK1181: cannot open input file 'm.lib'
      error: command 'C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\VC\\Tools\\MSVC\\14.29.30133\\bin\\HostX86\\x64\\link.exe' failed with exit code 1181
      [end of output]

  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for MACS2
Failed to build MACS2
ERROR: Could not build wheels for MACS2, which is required to install pyproject.toml-based projects
```

Can you please let me know how to fix it?
Thanks a lot",danli349,https://github.com/macs3-project/MACS/issues/594
I_kwDOABXaI85xqiM1,Bug: ,OPEN,2023-09-21T13:21:06Z,2023-09-26T19:00:43Z,,"**Describe the bug**
I think I have done the install successfully. when I test:
`macs3 -h`
It works well.
And I tried to use the callpeak funtion :
`macs3 callpeak -c OV-input-1_rmdup_picard.bam -t OV-E2F-1_rmdup_picard.bam -f BAM -B --outdir ../03_masc2 -g 2.9e9 -n OV-chip-1`
and it reported an error:

> Traceback (most recent call last):
  File ""/home/xujie/software/ENTER/envs/chip/bin/macs3"", line 727, in <module>
    main()
  File ""/home/xujie/software/ENTER/envs/chip/bin/macs3"", line 47, in main
    from MACS3.Commands.callpeak_cmd import run
  File ""/home/xujie/software/ENTER/envs/chip/lib/python3.8/site-packages/MACS3/Commands/callpeak_cmd.py"", line 24, in <module>
    from MACS3.Utilities.OptValidator import opt_validate_callpeak
  File ""/home/xujie/software/ENTER/envs/chip/lib/python3.8/site-packages/MACS3/Utilities/OptValidator.py"", line 24, in <module>
    from MACS3.IO.Parser import BEDParser, ELANDResultParser, ELANDMultiParser, \
  File ""MACS3/IO/Parser.pyx"", line 30, in init MACS3.IO.Parser
  File ""MACS3/Signal/FixWidthTrack.pyx"", line 28, in init MACS3.Signal.FixWidthTrack
  File ""MACS3/Signal/Pileup.pyx"", line 23, in init MACS3.Signal.Pileup
  File ""MACS3/Signal/BedGraph.pyx"", line 23, in init MACS3.Signal.BedGraph
  File ""MACS3/Signal/ScoreTrack.pyx"", line 23, in init MACS3.Signal.ScoreTrack
ImportError: /lib64/libm.so.6: version `GLIBC_2.29' not found (required by /home/xujie/software/ENTER/envs/chip/lib/python3.8/site-packages/MACS3/Signal/Prob.cpython-38-x86_64-linux-gnu.so)

**Expected behavior**
Can anybody give some advice for that?

**Screenshots**
**System (please complete the following information):**
 - Linux: [e.g. Linux, Mac OSX]
 - Python version [e.g. 3.8.17]
 - Numpy version [e.g. 1.23.5]
 - MACS Version [e.g. 3.0.0]

",XuJahcenia,https://github.com/macs3-project/MACS/issues/595
I_kwDOABXaI85x_hxP,Bug: BEDPE Format input for hmmratac,CLOSED,2023-09-26T00:28:20Z,2024-02-20T14:43:32Z,2024-02-20T14:43:32Z,"Thanks so much for adding the option to allow bedpe for hmmratac as a way to support CRAM -- unfortunately, when I am trying this command on a BED file, I am getting the following error 

**Describe the bug**

INFO  @ 26 Sep 2023 00:19:46: [95 MB] 
# Command line: hmmratac -i the_BEDPE_file.bed -f BEDPE -n temp
# Random seed selected as: 10151
 
INFO  @ 26 Sep 2023 00:19:46: [95 MB] #1 Read fragments from BAM file... 
Traceback (most recent call last):
  File ""/opt/conda/bin/macs3"", line 1026, in <module>
    main()
  File ""/opt/conda/bin/macs3"", line 101, in main
    run( args )
  File ""/opt/conda/lib/python3.10/site-packages/MACS3/Commands/hmmratac_cmd.py"", line 81, in run
    bam = BAMPEParser(options.bam_file[0], buffer_size=options.buffer_size)

**To Reproduce**
samtools view -@ 12 -1 --reference genome.fa -o file.bam file.cram
macs3 randsample -i file.bam -f BAMPE -p 100 -o the_BEDPE_file.bed
macs3 hmmratac -f BEDPE -i the_BEDPE_file.bed --outdir macs3out -n out --save-digested

**System (please complete the following information):**
 - OS: Linux
 - Python 3.10.12
 - Numpy version 1.23.5
 - macs3 3.0.0b3 (pulled from main last week)

",bcantarel,https://github.com/macs3-project/MACS/issues/596
I_kwDOABXaI852d2g2,Bug: python3.12 incompatible due to numpy<1.24 restriction,CLOSED,2023-11-10T12:29:41Z,2023-11-16T12:35:18Z,2023-11-16T12:35:18Z,"**Describe the bug**
numpy<1.26 does not work with python3.12 and macs3 needs numpy<1.24

Is it planned to upgrade the dependency of numpy so that macs3 can be used with python3.12? 
",jowodo,https://github.com/macs3-project/MACS/issues/598
I_kwDOABXaI853pYih,Use of IDR after running MACS3 for ATAC-seq data,CLOSED,2023-11-23T01:19:07Z,2023-11-28T05:47:48Z,2023-11-28T05:47:47Z,"**Use case**
I am analyzing ATAC-seq data from human cells. I am planning to performed the following as part of my pipeline:

1. Adapter and T-overhang trimming with Cutadapt
2. Mapping to reference genome with bowtie2
3. PCR duplicate removal (Picard), quality and blacklist filtering (sambamba or samtools)
4. Peak calling with MACS3

**Describe the problem**
Looking at online pipelines, the use of IDR post peak calling with **MACS2** seems to be recommended.
_Is this still the case with the recently released **MACS3** v3.0.0_ when used with either the
default: macs3 callpeak -f BAMPE -t ATAC.bam -g hs -n test -B -q 0.01, or
hmmratac: macs3 hmmratac

Also, when IDR is used, MACS2 seems to be run with p-value cutoff of 0.1. If the use of IDR is still recommended post MACS3, should it be run with -p 0.1 as well?

Thanks in advance for your help!
",OrangeyO2,https://github.com/macs3-project/MACS/issues/599
I_kwDOABXaI854MtIH,Q: the questions about calling broad peaks,OPEN,2023-11-29T13:29:13Z,2023-11-29T13:48:08Z,," **Hi, i want to call broad peaks for histone mark H3K27me3. but i am confused with the infomation about the broad parameters.**


   (1) In my opinion, i think this four parameters are important for calling broad peaks:

          - --max-gap 
          - --min-length 
          - --broad   
          - --broad-cutoff 

  Maybe you can tell me some other parameters I'm ignoring?

   (2) and i noticed ` The maximum gap is expanded to 4 * MAXGAP (--max-gap parameter)`.

so if i want to merge the peaks within 1000bp, i will set the `--max-gap` is 250. could you tell me if this's right?

   (3) and for my understanding: The bigger `max-gap` parameter will merge peaks within a bigger distance into one peak; so the bigger `max-gap` is , the fewer peaks there are. But in my test, there maybe a opposite trend in many times, exspecially in some small `max-gap`, such as: 250,375,500...  ; for example:

the number of peaks | max-gap
-   107705   |    250
-   110317    |   500
-   110558   |   750

  (4)and the default of `max-gap` parameter  is read length/tag size. I wonder if I set a value smaller than the fragment size, it will cause any wrong  effects?

could anyone can help me? thanks a lot!! 
YU
",liuyu988,https://github.com/macs3-project/MACS/issues/601
I_kwDOABXaI854hbT-,Q: about the 'max-gap 'parameter,OPEN,2023-12-02T12:48:40Z,2023-12-02T12:56:16Z,,"HI, I need to call broad peaks for histone mark. then i used `-broad` `-max-gap` parameters. but i met some questions.

**first:**
> macs2 callpeak -t A.sorted.bam -n A --nomodel -g hs -f BAMPE --outdir 250_0.001 --broad -p 0.001 --broad-cutoff 0.001 --max-gap 250


> macs2 callpeak -t A.sorted.bam -n A --nomodel -g hs -f BAMPE --outdir 250_0.001 --broad -p 0.001 --broad-cutoff 0.001 --max-gap 750

the difference between this two conditions is just `max-gap`. In my opinion, the `max-gap` won't influence the cutoff of calling peaks. but i found the number of peaks in 750 will be more than in 250. i'm so confused. when i saw the enrichment of histone mark in iGV, i noticed the peaks called by `max-gap 750` were not called by `max-gap 250`.

<img width=""513"" alt=""igv"" src=""https://github.com/macs3-project/MACS/assets/53420318/c6689517-d6fe-4780-b8a6-7a0f35c39ab9"">

could anyone can help me ? thanks a lot!!
YU
",liuyu988,https://github.com/macs3-project/MACS/issues/603
I_kwDOABXaI854l0J_,Q: question about the libmvec.so.1 error.,OPEN,2023-12-04T07:11:52Z,2024-09-30T13:49:35Z,,"Hi, 
The Macs3 callpeak reported the error below, how could I fix it?
```Traceback (most recent call last):
  File ""/share/home/zhou3lab/zhangxinpei/bioapp/miniconda3/envs/macs3/bin/macs3"", line 727, in <module>
    main()
  File ""/share/home/zhou3lab/zhangxinpei/bioapp/miniconda3/envs/macs3/bin/macs3"", line 47, in main
    from MACS3.Commands.callpeak_cmd import run
  File ""/share/home/zhou3lab/zhangxinpei/bioapp/miniconda3/envs/macs3/lib/python3.8/site-packages/MACS3/Commands
    from MACS3.Utilities.OptValidator import opt_validate_callpeak
  File ""/share/home/zhou3lab/zhangxinpei/bioapp/miniconda3/envs/macs3/lib/python3.8/site-packages/MACS3/Utilitie
    from MACS3.IO.Parser import BEDParser, ELANDResultParser, ELANDMultiParser, \
  File ""MACS3/IO/Parser.pyx"", line 30, in init MACS3.IO.Parser
  File ""MACS3/Signal/FixWidthTrack.pyx"", line 28, in init MACS3.Signal.FixWidthTrack
  File ""MACS3/Signal/Pileup.pyx"", line 23, in init MACS3.Signal.Pileup
  File ""MACS3/Signal/BedGraph.pyx"", line 23, in init MACS3.Signal.BedGraph
  File ""MACS3/Signal/ScoreTrack.pyx"", line 23, in init MACS3.Signal.ScoreTrack
ImportError: libmvec.so.1: cannot open shared object file: No such file or directory
```",Simple53,https://github.com/macs3-project/MACS/issues/604
I_kwDOABXaI855E8L1,Bug: HMMRATAC --save-digested outputs four identical signal tracks,CLOSED,2023-12-07T18:49:11Z,2024-01-10T20:23:29Z,2024-01-10T20:23:29Z,"**Describe the bug**
When running MACS3 in HMMRATAC mode, using the --save-digested flag writes the short signal to all four signal tracks.

**To Reproduce**
Use the --save-digested flag and then run `diff` on the resulting files.

**Additional context**
The problem is here:
https://github.com/macs3-project/MACS/blob/429f8f8b0114974b168900ba17d96467c27b550f/MACS3/Commands/hmmratac_cmd.py#L158C1-L170C21

**Solution**
The index of `digested_atac_signals` was mistakenly set to 0 in all four cases. The following block:  
```
if options.save_digested:
    fhd = open(short_bdgfile,""w"")
    digested_atac_signals[ 0 ].write_bedGraph(fhd, ""short"",""short"")
    fhd.close()
    fhd = open(mono_bdgfile,""w"")
    digested_atac_signals[ 0 ].write_bedGraph(fhd, ""mono"",""mono"")
    fhd.close()
    fhd = open(di_bdgfile,""w"")
    digested_atac_signals[ 0 ].write_bedGraph(fhd, ""di"",""di"")
    fhd.close()
    fhd = open(tri_bdgfile,""w"")
    digested_atac_signals[ 0 ].write_bedGraph(fhd, ""tri"",""tri"")
    fhd.close() 
```   
should actually be:
```
if options.save_digested:
    fhd = open(short_bdgfile,""w"")
    digested_atac_signals[ 0 ].write_bedGraph(fhd, ""short"",""short"")
    fhd.close()
    fhd = open(mono_bdgfile,""w"")
    digested_atac_signals[ 1 ].write_bedGraph(fhd, ""mono"",""mono"")
    fhd.close()
    fhd = open(di_bdgfile,""w"")
    digested_atac_signals[ 2 ].write_bedGraph(fhd, ""di"",""di"")
    fhd.close()
    fhd = open(tri_bdgfile,""w"")
    digested_atac_signals[ 3 ].write_bedGraph(fhd, ""tri"",""tri"")
    fhd.close() 
```
",mrendleman,https://github.com/macs3-project/MACS/issues/605
I_kwDOABXaI855Vo85,Bug: cython is required at build time but not install time,CLOSED,2023-12-11T13:45:13Z,2024-02-24T18:34:05Z,2024-02-24T18:34:05Z,"Hi,
as per some [Debian bug report](https://bugs.debian.org/1057991) cython is required to build the package but on the installed system it is not really needed.  I've fixed the Debian bug with this [patch](https://salsa.debian.org/med-team/macs/-/blob/master/debian/patches/no_install_depends_cython.patch) you might like to take over in your next release.
Kind regards, Andreas.",tillea,https://github.com/macs3-project/MACS/issues/606
I_kwDOABXaI855tT_c,Q: What context should be specified for the 'gsize' option with killifish mapping data?,OPEN,2023-12-14T15:19:45Z,2023-12-15T09:19:13Z,,"Hello,

I have a question that arose while using your module, and I'd like to briefly summarize and share it.

(Current Situation)
I intend to perform peak calling using the MACS3 module with mapping data from African turquoise killifish.

(Question)
I would like to ask you about the context I should provide for the ""-gsize"" option in the 'macs3 callpeak' command, considering the mapping data is from killifish.
* The genome size of killifish is 1.53GB.

Thank you.

Logan",LoganLHJ,https://github.com/macs3-project/MACS/issues/607
I_kwDOABXaI857U2e-,Q:  lambda estimation,OPEN,2024-01-07T09:53:19Z,2024-01-07T09:53:19Z,,"Hi 

I was wondering if there is a way to retrieve lambda of the estimated Poisson distribution of every peaks?

Thank you very much
",pegahtak,https://github.com/macs3-project/MACS/issues/608
I_kwDOABXaI857aaCW,Bug: Test scripts failing,CLOSED,2024-01-08T13:59:23Z,2024-01-08T14:43:01Z,2024-01-08T14:43:01Z,"Are the test scripts and data currently up-to-date?  I'm seeing failures with MACS 3.0.0 on multiple platforms (FreeBSD + python 3.9 + numpy 1.25.0, and Linux (Alma 8), macOS, and NetBSD all with python 3.11 and numpy 1.26.3.

Errors are different on different platforms, but here is a sample from macOS:

```
===> Testing for py311-macs3-3.0.0
(cd /Users/bacon/Pkgsrc/pkgsrc/wip/py-macs3/work/MACS-3.0.0/test && ./cmdlinetest tag)
1. callpeak
1.1 callpeak narrow
1.2 callpeak broad
1.3 callpeak on PE narrow/broad
2. pileup
3. filterdup
4. predictd
5. randsample
6. refinepeak
7. bdgcmp
8. bdgpeakcall
9. bdgbroadcall
10. bdgdiff
11. cmbreps
12. bdgopt
13. callvar
14. 50k contigs with buffersize
14.1 callpeak
14.2 filterdup
14.3 pileup
14.4 randsample
15. hmmratac save training regions bed file and model file
15.1 hmmratac load training regions from bedfile
15.2 hmmratac load hmm model file
16. search for errors or warnings in log files
 checking ../temp/tag_run_50kcontigs/run_callpeak_50kcontigs.log...
 ... clear!
 checking ../temp/tag_run_50kcontigs/run_filterdup_50kcontigs.log...
 ... clear!
 checking ../temp/tag_run_50kcontigs/run_pileup_ChIP.bed.log...
 ... clear!
 checking ../temp/tag_run_50kcontigs/run_randsample.log...
 ... clear!
 checking ../temp/tag_run_bdgbroadcall/run_bdgbroadcall_w_prefix.log...
 ... clear!
 checking ../temp/tag_run_bdgcmp/run_bdgcmp.log...
 ... clear!
 checking ../temp/tag_run_bdgdiff/run_bdgdiff_w_o_file.log...
 ... clear!
 checking ../temp/tag_run_bdgdiff/run_bdgdiff_w_prefix.log...
 ... clear!
 checking ../temp/tag_run_bdgopt/run_bdgopt_max.log...
 ... clear!
 checking ../temp/tag_run_bdgopt/run_bdgopt_min.log...
 ... clear!
 checking ../temp/tag_run_bdgpeakcall/run_bdgpeakcall_cutoff.log...
 ... clear!
 checking ../temp/tag_run_bdgpeakcall/run_bdgpeakcall_w_prefix.log...
 ... clear!
 checking ../temp/tag_run_callpeak_broad/run_callpeak_broad.log...
 ... clear!
 checking ../temp/tag_run_callpeak_narrow/run_callpeak_narrow0.log...
 ... clear!
 checking ../temp/tag_run_callpeak_narrow/run_callpeak_narrow1.log...
 ... clear!
 checking ../temp/tag_run_callpeak_narrow/run_callpeak_narrow2.log...
 ... clear!
 checking ../temp/tag_run_callpeak_narrow/run_callpeak_narrow3.log...
 ... clear!
 checking ../temp/tag_run_callpeak_narrow/run_callpeak_narrow4.log...
 ... clear!
 checking ../temp/tag_run_callpeak_narrow/run_callpeak_narrow5.log...
 ... clear!
 checking ../temp/tag_run_callpeak_narrow_revert/run_callpeak_narrow_revert.log...
 ... clear!
 checking ../temp/tag_run_callpeak_pe_broad/run_callpeak_bampe_broad.log...
 ... clear!
 checking ../temp/tag_run_callpeak_pe_broad/run_callpeak_bedpe_broad.log...
 ... clear!
 checking ../temp/tag_run_callpeak_pe_narrow/run_callpeak_bampe_narrow.log...
 ... clear!
 checking ../temp/tag_run_callpeak_pe_narrow/run_callpeak_bedpe_narrow.log...
 ... clear!
 checking ../temp/tag_run_callpeak_pe_narrow/run_callpeak_pe_narrow_onlychip.log...
 ... clear!
 checking ../temp/tag_run_callvar/run_callvar_PE.log...
 ... clear!
 checking ../temp/tag_run_cmbreps/run_cmbreps_fisher.log...
 ... clear!
 checking ../temp/tag_run_cmbreps/run_cmbreps_max.log...
 ... clear!
 checking ../temp/tag_run_cmbreps/run_cmbreps_mean.log...
 ... clear!
 checking ../temp/tag_run_filterdup/run_filterdup.log...
 ... clear!
 checking ../temp/tag_run_filterdup/run_filterdup_d.log...
 ... clear!
 checking ../temp/tag_run_filterdup/run_filterdup_pe.log...
 ... clear!
 checking ../temp/tag_run_filterdup/run_filterdup_pe_d.log...
 ... clear!
 checking ../temp/tag_run_hmmratac/run_hmmratac.log...
 ... clear!
 checking ../temp/tag_run_hmmratac/run_hmmratac_bedpe.log...
 ... clear!
 checking ../temp/tag_run_hmmratac/run_hmmratac_load_hmm_model.log...
 ... clear!
 checking ../temp/tag_run_hmmratac/run_hmmratac_load_training_regions.log...
 ... clear!
 checking ../temp/tag_run_pileup/run_pileup_CTRL.bed.log...
 ... clear!
 checking ../temp/tag_run_pileup/run_pileup_CTRLPE.bampe.log...
 ... clear!
 checking ../temp/tag_run_pileup/run_pileup_CTRLPE.bedpe.log...
 ... clear!
 checking ../temp/tag_run_pileup/run_pileup_ChIP.bed.log...
 ... clear!
 checking ../temp/tag_run_pileup/run_pileup_ChIPPE.bampe.log...
 ... clear!
 checking ../temp/tag_run_pileup/run_pileup_ChIPPE.bedpe.log...
 ... clear!
 checking ../temp/tag_run_predictd/run_predictd.log...
 ... clear!
 checking ../temp/tag_run_predictd/run_predictd_bampe.log...
 ... clear!
 checking ../temp/tag_run_predictd/run_predictd_bedpe.log...
 ... clear!
 checking ../temp/tag_run_randsample/run_randsample.log...
 ... clear!
 checking ../temp/tag_run_randsample/run_randsample_bampe.log...
 ... clear!
 checking ../temp/tag_run_randsample/run_randsample_bedpe.log...
 ... clear!
 checking ../temp/tag_run_refinepeak/run_refinepeak_w_ofile.log...
 ... clear!
 checking ../temp/tag_run_refinepeak/run_refinepeak_w_prefix.log...
 ... clear!
17. compare with standard outputs
16.1.1 checking 50kcontigs run_callpeak_50kcontigs_peaks.narrowPeak ...
sort: No such file or directory
 ... success!
16.1.2 checking 50kcontigs run_callpeak_50kcontigs_summits.bed ...
sort: No such file or directory
 ... success!
16.1.3 checking 50kcontigs run_filterdup_result.bed ...
sort: No such file or directory
 ... failed! Difference:
0a1,199981
> unitig0       15      115     .       .       +
> unitig0       15      115     .       .       +
> unitig0       43      143     .       .       +
> unitig0       87      187     .       .       +
> unitig1       1       101     .       .       +
> unitig1       56      156     .       .       +
> unitig1       79      179     .       .       +
> unitig1       82      182     .       .       +
> unitig10      12      112     .       .       +
16.1.4 checking 50kcontigs run_pileup_ChIP.bed.bdg ...
sort: No such file or directory
 ... failed! Difference:
```",outpaddling,https://github.com/macs3-project/MACS/issues/609
I_kwDOABXaI857qq4z,Mention alternative installation methods in install guide,OPEN,2024-01-10T16:55:21Z,2024-01-10T16:55:21Z,,"
It might be good to point users to various package managers besides pip that have a MACS3 package.

E.g., biology/py-macs3 has been committed to the FreeBSD ports collection.
It might be helpful to users if you could post a message like
the following on your website or add it to the install guide:

biology/py-macs3 can be installed on FreeBSD via the FreeBSD ports system.

To install via the binary package, simply run:

    pkg install py39-MACS3

This will very quickly install a prebuilt package and all run-time
dependencies using only highly-portable optimizations, much like apt, yum,
etc.

FreeBSD ports can just as easily be built and installed from source,
although it will take longer (for the computer, not for you):

    cd /usr/ports/biology/py-macs3
    make install

Building from source allows installing to a different prefix, compiling with
native optimizations, and in some cases, building with non-default options
such as different compilers or dependencies.  For example, adding

    CFLAGS+=-march=native

to /etc/make.conf will cause ports built from source to use all native
optimizations known to the compiler for the local CPU, resulting in faster
but less portable binaries.

It also allows building and installing compiled programs with debug flags
enabled so that gdb and lldb can locate issues in the source code:

    cd /usr/ports/category/port
    env WITH_DEBUG=yes make install

To report issues with a FreeBSD port, please submit a PR at:

    https://www.freebsd.org/support/bugreports.html

For more information, visit https://www.freebsd.org/ports/index.html.

A biology/py-macs3 package has also been added to pkgsrc, a package manager from NetBSD that works on any POSIX-compatible system, including most Linux distributions and macOS.   See https://pkgsrc.org for more info.",outpaddling,https://github.com/macs3-project/MACS/issues/610
I_kwDOABXaI858gpAX,Q: Is there a way to specify blacklisted regions in MACS2?,OPEN,2024-01-18T19:35:11Z,2024-01-18T19:35:11Z,,"in the generation of the bedgraph pileup when running `callpeak`, or when running `bdgcmp`, is there a way to input a bed file with regions to filter out from the analysis? 

I know deeptools has `--blackListFileName` as an argument  for bamcompare and other commands, and I was wondering if there is a similar feature in MACS2.",rikrdo89,https://github.com/macs3-project/MACS/issues/613
I_kwDOABXaI858gqHh,Q: Defining the bin size when generating bedgraphs.,OPEN,2024-01-18T19:38:42Z,2024-01-18T19:38:42Z,,"Usually the resulting bedgraph files that I get from running MACS `callpeak` and `bdgcmp` can be quite large in size. Is there a way to set the bin size of the final bedgraph (50bp, 100bp, etc) to change the resolution of the data?",rikrdo89,https://github.com/macs3-project/MACS/issues/614
I_kwDOABXaI859R11R,Bug: test suite failure in  MACS 3.0.0,CLOSED,2024-01-26T08:54:23Z,2024-02-24T16:38:45Z,2024-02-24T16:38:44Z,"**Describe the bug**
When trying to update the Debian package for MACS I get some test suite errors in test step `16.18`.

    ...
    16.17.1 checking callvar PEsample.vcf ...
     ... success!
    16.18.1 checking hmmratac hmmratac_yeast500k_accessible_regions.gappedPeak ...
     ... failed! Difference:
    1,283c1,919
    < chrI      0       700     peak_1  0       .       30      560     0       1       530     30      0       0       0
    < chrI      113420  114870  peak_5  0       .       113440  114700  0       1       1260    20      0       0       0
    < chrI      140480  142080  peak_6  0       .       140760  141740  0       1       980     280     0       0       0
    < chrI      165050  165900  peak_7  0       .       165330  165830  0       1       500     280     0       0       0
    < chrI      181160  181650  peak_8  0       .       181200  181610  0       1       410     40      0       0       0
    < chrI      198460  199140  peak_9  0       .       198660  199090  0       1       430     200     0       0       0
    < chrI      60130   62600   peak_2  0       .       60410   62150   0       1       1740    280     0       0       0
    < chrI      67960   69780   peak_3  0       .       68160   69260   0       1       1100    200     0       0       0
    < chrI      71790   73230   peak_4  0       .       72120   73000   0       1       880     330     0       0       0
    16.18.2 checking hmmratac hmmratac_yeast500k_bedpe_accessible_regions.gappedPeak ...
     ... failed! Difference:
    1,283c1,919
    < chrI      0       700     peak_1  0       .       30      560     0       1       530     30      0       0       0
    < chrI      113420  114870  peak_5  0       .       113440  114700  0       1       1260    20      0       0       0
    < chrI      140480  142080  peak_6  0       .       140760  141740  0       1       980     280     0       0       0
    < chrI      165050  165900  peak_7  0       .       165330  165830  0       1       500     280     0       0       0
    < chrI      181160  181650  peak_8  0       .       181200  181610  0       1       410     40      0       0       0
    < chrI      198460  199140  peak_9  0       .       198660  199090  0       1       430     200     0       0       0
    < chrI      60130   62600   peak_2  0       .       60410   62150   0       1       1740    280     0       0       0
    < chrI      67960   69780   peak_3  0       .       68160   69260   0       1       1100    200     0       0       0
    < chrI      71790   73230   peak_4  0       .       72120   73000   0       1       880     330     0       0       0
    16.18.3 checking hmmratac hmmratac_yeast500k_load_hmm_model_accessible_regions.gappedPeak ...
     ... failed! Difference:
    1,283c1,919
    < chrI      0       700     peak_1  0       .       30      560     0       1       530     30      0       0       0
    < chrI      113420  114870  peak_5  0       .       113440  114700  0       1       1260    20      0       0       0
    < chrI      140480  142080  peak_6  0       .       140760  141740  0       1       980     280     0       0       0
    < chrI      165050  165900  peak_7  0       .       165330  165830  0       1       500     280     0       0       0
    < chrI      181160  181650  peak_8  0       .       181200  181610  0       1       410     40      0       0       0
    < chrI      198460  199140  peak_9  0       .       198660  199090  0       1       430     200     0       0       0
    < chrI      60130   62600   peak_2  0       .       60410   62150   0       1       1740    280     0       0       0
    < chrI      67960   69780   peak_3  0       .       68160   69260   0       1       1100    200     0       0       0
    < chrI      71790   73230   peak_4  0       .       72120   73000   0       1       880     330     0       0       0
    16.18.4 checking hmmratac hmmratac_yeast500k_load_training_regions_accessible_regions.gappedPeak ...
     ... failed! Difference:
    1,283c1,919
    < chrI      0       700     peak_1  0       .       30      560     0       1       530     30      0       0       0
    < chrI      113420  114870  peak_5  0       .       113440  114700  0       1       1260    20      0       0       0
    < chrI      140480  142080  peak_6  0       .       140760  141740  0       1       980     280     0       0       0
    < chrI      165050  165900  peak_7  0       .       165330  165830  0       1       500     280     0       0       0
    < chrI      181160  181650  peak_8  0       .       181200  181610  0       1       410     40      0       0       0
    < chrI      198460  199140  peak_9  0       .       198660  199090  0       1       430     200     0       0       0
    < chrI      60130   62600   peak_2  0       .       60410   62150   0       1       1740    280     0       0       0
    < chrI      67960   69780   peak_3  0       .       68160   69260   0       1       1100    200     0       0       0
    < chrI      71790   73230   peak_4  0       .       72120   73000   0       1       880     330     0       0       0

**To Reproduce**
You might like to run

    cd test
    ./cmdlinetest macs3.0.0-1-3.12

(same with `macs3.0.0-1-3.11` which is macs3.0.0 built against Python3.11) on a Debian unstable system (container)

**Expected behavior**
I confirm

    python3.12 -m pytest test

(or `python3.11`) is working but the `cmdlinetest` shows these failures.  I wonder if just some data need to be justified due to some rounding errors?

**System (please complete the following information):**
 - OS: Debian unstable
 - Python version: 3.11 or 3.12
 - Numpy version: 1.24.2
 - MACS Version: 3.0.0
",tillea,https://github.com/macs3-project/MACS/issues/615
I_kwDOABXaI859ngfE,Bug: pip install error: subprocess-exited-with-error,CLOSED,2024-01-30T10:41:08Z,2024-02-05T11:16:49Z,2024-02-05T11:16:49Z,"**Describe the bug**
After creating a virtual environment using python -m venv myEnv and install MACS3 from pip, I get this subprocess-exited-with-error.

**To Reproduce**
1. Create a virtual environment using venv, i.e. python -m venv macs3
2. Run pip install MACS3

**Expected behavior**
I expect the software can be installed

**Screenshots**
Last lines in error message (see full file in attachement
[macs_install_error_log.txt](https://github.com/macs3-project/MACS/files/14096500/macs_install_error_log.txt)
):
```
       note: This error originates from a subprocess, and is likely not a problem with pip.
        ERROR: Failed building wheel for cykhash
      Failed to build cykhash
      ERROR: Could not build wheels for cykhash, which is required to install pyproject.toml-based projects
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
error: subprocess-exited-with-error

× pip subprocess to install build dependencies did not run successfully.
│ exit code: 1
╰─> See above for output.

note: This error originates from a subprocess, and is likely not a problem with pip.
```
**System (please complete the following information):**
 - OS: Debian12 (bookworm)
 - Python version 3.9.12
 - Numpy version No Numpy yet (due to fail installation of MACS3)
 - MACS Version MACS3

Thank you for your time and help! 
",ferygood,https://github.com/macs3-project/MACS/issues/616
I_kwDOABXaI8599D2c,"What is the difference between ""absolute peak summit"" and ""summit position"" in narrowPeak format?",OPEN,2024-02-01T18:25:23Z,2024-02-15T00:42:22Z,,"Hi, I want to understand the difference between 5 and 10 in macs3 narrowPeak output. They are different, but column 10, the ""relative summit position to peak start"", corresponds to what is found in the summits.bed file. In IGV, field 10 is labeled as the ""peak"", and field 5 is labeled as ""score"". Here is an example:

summits.bed
```
Chr1	13972	13973	peak_1	12.7509
```

narrowPeak

```
Chr1	13824	14257	peak_1	127	.	4.86034	15.5595	12.7509	148
```

148 = 13972 - 13824 

127 = ?

Thanks so much

BED field descriptions drawn from: https://github.com/macs3-project/MACS/blob/master/docs/callpeak.md",mcsimenc,https://github.com/macs3-project/MACS/issues/617
I_kwDOABXaI85__Jwd,Q: conversion of output files to UCSC track hub format?,OPEN,2024-02-21T17:04:22Z,2024-02-22T14:54:02Z,,"**Use case**
I work for UCSC and we sometimes get reports that MACS2 or MACS3 files are not valid to loading into our browser. I'd like to help write a converter from all the MACS2/3 output files to a UCSC track hub.

**Describe the problem**
I am looking for a directory with all the different output formats of an example run.

**Describe the solution you tried**
We have various command line programs and a conversion script that could be used here.

**Additional context**
The resulting track hub could also be loaded into IGV, NCBI and Ensembl. 
",maximilianh,https://github.com/macs3-project/MACS/issues/621
I_kwDOABXaI86AS5n3,Feat: Enhanced clarification of the specific definition of BEDPE as used by MACS,OPEN,2024-02-24T18:38:02Z,2024-02-25T01:25:17Z,,"**Intro**
Hi @taoliu,

First, I want to express my gratitude for your dedication to developing and maintaining such a valuable tool as MACS. It's been instrumental in advancing our research.

**Is your feature request related to a problem? Please describe.**
I recently encountered a bit of confusion regarding the terminology used for BED output from paired-end sequencing data. Specifically, the term ""BEDPE"" seems to conflict with an already established format closely associated with Hi-C data, as detailed [here](https://bedtools.readthedocs.io/en/latest/content/general-usage.html#bedpe-format).

For example, during my use of `macs3 filterdup`, I anticipated an output in the above-defined BEDPE format but received a three-column BED-like file instead. This discrepancy wasn't immediately clear from the `macs3 filterdup` documentation. Upon following the suggestion in the documentation,
```
-f {AUTO,BAM,SAM,BED,ELAND,ELANDMULTI,ELANDEXPORT,BOWTIE,BAMPE,BEDPE}, --format {AUTO,BAM,SAM,BED,ELAND,ELANDMULTI,ELANDEXPORT,BOWTIE,BAMPE,BEDPE}
                        Format of tag file, ""AUTO"", ""BED"" or ""ELAND"" or ""ELANDMULTI"" or ""ELANDEXPORT"" or ""SAM"" or ""BAM"" or ""BOWTIE"" or ""BAMPE"" or ""BEDPE"". The default AUTO option will let 'macs3 filterdup' decide which format the file is. Please check the definition in README file if you choose ELAND/ELANDMULTI/ELANDEXPORT/SAM/BAM/BOWTIE or BAMPE/BEDPE. DEFAULT: ""AUTO""
```
...I didn't find a specific definition of BEDPE as used by MACS in [the README Markdown file](https://github.com/macs3-project/MACS/blob/master/README.md). I did, however, find it in [the repo's callpeak Markdown file](https://github.com/macs3-project/MACS/blob/1b92238837de870019aacfeae1fb38f407f77903/docs/callpeak.md?plain=1#L93).

**Describe the solution you'd like**
For clarity and to help future users, it might be beneficial to explicitly define the BEDPE format as understood by MACS, possibly in the main README or within the tool's documentation text for `macs3 filterdup` and the various other functions. This small adjustment could enhance user experience and prevent similar confusion.

**Describe alternatives you've considered**
Alternatively, it might be good to explicitly refer to callpeak.md, instead of the term ""README file"", in the help documentation for the various functions.

**Outro**
Thank you again for your incredible work on this project. Your efforts are greatly appreciated by the scientific community.

Best,
Kris
",kalavattam,https://github.com/macs3-project/MACS/issues/626
I_kwDOABXaI86AUqYO,Feat: Reduction of memory consumption,OPEN,2024-02-25T19:10:36Z,2024-02-25T20:16:21Z,,"Hello,

I'm working with a single cell ATAC dataset in an organism with a very large genome (32 Gbp). Therefore, the number of reads is quite high ~300M and I have a lot of candidate peaks:

```
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #  The Hidden Markov Model for signals of binsize of 10 basepairs: 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #   open state index: state0 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #   nucleosomal state index: state2 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #   background state index: state1 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #   Starting probabilities of states: 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #                          open         bg        nuc 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #                         0.182     0.4838     0.3342 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #   HMM Transition probabilities: 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #                          open         bg        nuc 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #             open->      0.984   0.008203   0.007821 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #               bg->   0.004914     0.9406    0.05444 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #              nuc->   0.005975    0.06062     0.9334 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #   HMM Emissions (mean):  
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #                         short       mono         di        tri 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #             open:      0.4205      1.458      1.184     0.5775 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #               bg:    0.006671     0.8911   0.003568    0.00196 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #              nuc:      0.8497      1.735     0.2407   0.009357 
INFO  @ 25 Feb 2024 02:43:51: [35845 MB] #5 Decode with Viterbi to predict states 
INFO  @ 25 Feb 2024 02:45:29: [35845 MB] #5  Total candidate peaks : 1486723 
```

Unfortunately this means that the memory consumption is quite high and based on the current trend I guess I would need more than 1 Tb of memory to process using HMMRATAC:

```
INFO  @ 25 Feb 2024 19:33:03: [346296 MB] #    decoding 343000... 
INFO  @ 25 Feb 2024 19:39:18: [346623 MB] #    decoding 344000... 
INFO  @ 25 Feb 2024 19:45:37: [347801 MB] #    decoding 345000... 
INFO  @ 25 Feb 2024 19:53:59: [350527 MB] #    decoding 346000... 
INFO  @ 25 Feb 2024 20:00:37: [352610 MB] #    decoding 347000... 
```

Would be great if there was a way to decrease the memory consumption of this process. 

Thanks a lot!

",diego-rt,https://github.com/macs3-project/MACS/issues/628
I_kwDOABXaI86BcZUU,Q: HMMRATAC output  and options for _summit.bed,OPEN,2024-03-06T14:56:49Z,2024-03-06T17:42:27Z,,"Hi,

I have the same question as in (https://github.com/macs3-project/MACS/issues/592#issue-1867137129) 

1. and in general, are the columns generated here the same as in the original paper? (https://github.com/LiuLabUB/HMMRATAC/blob/master/HMMRATAC_Guide.md#commandline-options), 

2. Another question: In the original implementation, there is a Name_summits.bed output, is there a way I can also call summit in your implementation? 

Many thanks!

Best,
Kawai",kawairine,https://github.com/macs3-project/MACS/issues/633
I_kwDOABXaI86Bep-A,Feat: Built-in scoring for HMMRATAC,OPEN,2024-03-06T19:45:20Z,2024-03-11T19:17:06Z,,"**Describe the solution you'd like**
I'd like the option to calculate scores for peaks when running MACS3 HMMRATAC, similar to the original HMMRATAC implementation (the old command line option `--score <max || ave || med || fc || zscore || all>`). This would be useful for comparing peaks within a sample and enable downstream between-replicate reproducibility with methods like IDR.

**Describe alternatives you've considered**
An alternative would be any type of informative peak scoring. Another suggestion would be a different version of the ""fc"" option where instead of reporting fold-change relative to the whole genome's average coverage, it reports fold change relative to the chromosome's average or a sliding-window local average.

**Additional context**
Currently, the gappedPeak files output by `macs3 hmmratac` contain all zeros for the score/signalValue/pValue/qValue columns, giving the impression that no peaks are higher confidence than the others.
",mrendleman,https://github.com/macs3-project/MACS/issues/634
I_kwDOABXaI86Eglis,Q: HMMRATAC producing too many peaks,OPEN,2024-04-03T14:43:53Z,2024-04-22T13:38:47Z,,"I ran HMMRATAC on two samples that should be biological replicates. The quality difference between them is high, although the quality is far from ideal for both. However, the low quality sample produced more than 10x as many peaks (<10k versus >100k) with the default settings.

For comparison, the Java version of HMMRATAC produced <1k peaks for the first sample and no peaks for the second sample (score cutoff of 30).

Here is a genome browser screenshot to illustrate the situation:
<img width=""939"" alt=""image"" src=""https://github.com/macs3-project/MACS/assets/6363505/5ad480b5-7b4d-4991-970f-931602786840"">

The called peaks for the first sample look like peaks. Not so much for the second sample. Is this expected? Are there some guidelines to help avoid this?",igordot,https://github.com/macs3-project/MACS/issues/636
I_kwDOABXaI86EqmjO,Bug: undefined symbol: __pow_finite,OPEN,2024-04-04T15:01:37Z,2024-04-10T13:37:18Z,,"**Describe the bug**
callpeak function fails due to old glibc version during compilation of cython code (assumption)

**To Reproduce**
```
pip install macs3=3.0.1 
macs3 callpeak -t $BAMFILE -n 8h_3utr --nomodel --extsize 200 --broad --outdir $OUTDIR
```

**Expected behavior**
calculation to terminate successfully (macs3 version 3.0.0 works)

**stderr**
```
Traceback (most recent call last):
  File ""/app/macs3/3.0.1-3.12.2/bin/macs3"", line 1028, in <module>
    main()
  File ""/app/macs3/3.0.1-3.12.2/bin/macs3"", line 48, in main
    from MACS3.Commands.callpeak_cmd import run
  File ""/app/macs3/3.0.1-3.12.2/MACS3/Commands/callpeak_cmd.py"", line 23, in <module>
    from MACS3.Utilities.OptValidator import opt_validate_callpeak
  File ""/app/macs3/3.0.1-3.12.2/MACS3/Utilities/OptValidator.py"", line 24, in <module>
    from MACS3.IO.Parser import BEDParser, ELANDResultParser, ELANDMultiParser, \
  File ""MACS3/IO/Parser.pyx"", line 36, in init MACS3.IO.Parser
  File ""MACS3/Signal/FixWidthTrack.pyx"", line 25, in init MACS3.Signal.FixWidthTrack
ImportError: /app/macs3/3.0.1-3.12.2/MACS3/Signal/SignalProcessing.cpython-312-x86_64-linux-gnu.so: undefined symbol: __pow_finite
```

**System (please complete the following information):**
 - OS: Oracle Linux 9.3 
 - kernel: 5.14.0-362.24.1.el9_3.x86_64
 - clang: 16.0.6
 - Python version 3.12.2
 - Numpy version 1.26.4
 - MACS Version 3.0.1

**Additional context**
Add any other context about the problem here.
* [math-finite.h has been removed from glibc in 2019](https://sourceware.org/git/?p=glibc.git;a=commit;h=7bdb921d70bf9f93948e2e311fef9ef439314e41)
* [related SO question](https://stackoverflow.com/questions/63261220/link-errors-with-ffast-math-ffinite-math-only-and-glibc-2-31)

",jowodo,https://github.com/macs3-project/MACS/issues/637
I_kwDOABXaI86EsRt6,Q: HMMRATAC reproducibility,OPEN,2024-04-04T18:06:56Z,2024-04-08T21:47:15Z,,"I noticed that HMMRATAC does not seem to be deterministic. If I run it multiple times, sometimes I get a different number of peaks. I see that there is a `--randomSeed` parameter that is set by default. Is that not controlling for everything?",igordot,https://github.com/macs3-project/MACS/issues/638
I_kwDOABXaI86GXmD3,"Q: how to use MACS3 for ATAC seq with ""himmratac"" option?",OPEN,2024-04-20T02:29:26Z,2024-08-13T11:17:26Z,,"**Use case**
My data consist of BAM paired-end files already filtered by duplicates, mit reads, etc. (99% alingment)

**Describe the problem**
I tried to use this command in bash

macs3 hmmratac -i M1_dedup_noM_sorted.bam -f BAMPE -g hs -n test -B -q 0.01

and got this error:
usage: macs3 [-h] [--version]
             {callpeak,bdgpeakcall,bdgbroadcall,bdgcmp,bdgopt,cmbreps,bdgdiff,filterdup,predictd,pileup,randsample,refinepeak,callvar,hmmratac}
             ...
macs3: error: unrecognized arguments: -g hs -B -q 0.01


**Additional context**
macs2 works well, but i still want to learn MACS3.


Any help would be useful. Thank you.

",kbarrr,https://github.com/macs3-project/MACS/issues/639
I_kwDOABXaI86HkWVY,Bug: Callvar throws an error when run on broadPeak file,OPEN,2024-05-02T01:56:26Z,2024-05-15T06:14:47Z,,"When running on a broadpeak file, callvar does the following:
```
macs3 callvar -b Met.mRp.clN_peaks.broadPeak -t ~/results/chromap/merged_replicate/met_filtered.bam --outdir results/var -o variants.vcf
```
 File ""MACS3/Signal/RACollection.pyx"", line 358, in MACS3.Signal.RACollection.RACollection.get_PosReadsInfo_ref_pos
  File ""MACS3/Signal/RACollection.pyx"", line 382, in MACS3.Signal.RACollection.RACollection.get_PosReadsInfo_ref_pos
  File ""MACS3/Signal/ReadAlignment.pyx"", line 376, in MACS3.Signal.ReadAlignment.ReadAlignment.get_variant_bq_by_ref_pos
  File ""MACS3/Signal/ReadAlignment.pyx"", line 408, in MACS3.Signal.ReadAlignment.ReadAlignment.get_variant_bq_by_ref_pos
  File ""MACS3/Signal/ReadAlignment.pyx"", line 307, in MACS3.Signal.ReadAlignment.ReadAlignment.get_REFSEQ
ValueError: invalid literal for int() with base 10: b''
""""""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/miniconda3/envs/MACS3/bin/macs3"", line 1028, in <module>
    main()
  File ""/envs/MACS3/bin/macs3"", line 105, in main
    run( args )
  File ""/miniconda3/envs/MACS3/lib/python3.12/site-packages/MACS3/Commands/callvar_cmd.py"", line 235, in run
    results = mapresults.get(timeout=window_size*300)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/miniconda3/envs/MACS3/lib/python3.12/multiprocessing/pool.py"", line 774, in get
    raise self._value
ValueError: invalid literal for int() with base 10: b''",LinearParadox,https://github.com/macs3-project/MACS/issues/643
I_kwDOABXaI86Ius_w,Q: impact of sequencing throughput on peak calling,CLOSED,2024-05-13T22:21:14Z,2024-06-10T20:11:32Z,2024-06-10T20:11:31Z,"Dear @taoliu 

Thank you for macs and for the constant improvements you have been adding.

**Use case**
I have some histone chip data on cancer cell lines where they were sequenced extra deep by the sequencing service centre (>80M reads).

**Describe the problem**
Surprisingly, despite all cell lines being quite similar, the number of peaks called varied. A few deeply sequenced samples have significantly more peaks being called. Visually inspecting peak calling indicates that there are noticeably more small/noise-like peaks being called. It's also surprising since the input samples were sequenced deeply and would, in theory, help to mitigate the signal/noise problem.

**Describe the solution you tried**
QC results indicate all samples were successful, with an average RiP% > 15% ; RiBL% <5%. Down-sampling of the samples in question helped to lower the number of peaks being called. My question is: Are these behaviours expected and there is a recommended way to handle samples with uneven sequencing depths? Thanks!


",SplitInf,https://github.com/macs3-project/MACS/issues/644
I_kwDOABXaI86KcHUS,Setting cut-off when using logFE bigWig files from bdgcmp  ,OPEN,2024-05-29T07:51:04Z,2024-05-29T07:51:04Z,,"I have been using bigWig file from bdgcmp containing logFE values (compared ChIP signals against Input). As part of next step, I would like to use bdgpeakcall, where I am getting stuck in deciding the threshold. As suggested in the manual, I have tried the cut-off analysis step in bdgcallpeak, but ended up with an error.",manjumoorthy95,https://github.com/macs3-project/MACS/issues/646
I_kwDOABXaI86MI622,"Q: How to use HMMRATAC to give us a narrow peak file and have signalValue, p and q-value ?",OPEN,2024-06-13T13:23:23Z,2024-06-15T00:40:32Z,,"**Use case**
Hello I want to do peak calling on my ATAC seq data, and for that I use, callpeak and hmmratac.
 
**Describe the problem**
My problem here is with hmmratac; 

I use this command `macs3 hmmratac -f BAM -i RES/atac/try_1/04-NobiasedRegions/ATAC20_D0_rep1_hg38_sort_dedup_biasedRegions.bam  -u 15 -l 5 -c 100 -n RES/atac/try_1/06-PeakCalling/hmmratac_narrow/ATAC20_D0_rep1 `
I read in the doc that we should have a narrow peak file format but I have an *_accessible_regions.gappedPeak format which is not what I want. For the rest of my analysis I need a narrow peak format.

**Describe the solution you tried**
So I tried to create my narrow peak file from the gappedPeak, by hand, but the trouble I am now having is that for the signal value, p-value and q-value are equals to 0 (I think like this comment said it is intentional https://github.com/macs3-project/MACS/issues/592#issuecomment-1981383873 ). Here is what my file look like;

``` 
track name=""peak"" description=""peak"" type=gappedPeak nextItemButton=on
20	208210	220320	peak_1	0	.	208450	220210	0	3	1240,8820,1550	240,1520,10450	0	0	0
20	220410	267710	peak_2	0	.	220490	267640	0	1	47150	80	0	0	0
20	279100	302420	peak_3	0	.	279110	302390	0	8	890,9080,6700,310,240,3640,1240,660	10,1010,10140,17070,17420,17720,21380,22630	0	0	0
20	302430	314800	peak_4	0	.	302470	314780	0	4	8730,450,2840,130	40,8880,9350,12220	0	0	0
20	314890	342820	peak_5	0	.	314920	342760	0	7	7230,4790,1170,3260,2190,4780,4170	30,7400,12210,13400,16670,18880,23700	0	0	0
20	342840	365480	peak_6	0	.	342880	365440	0	6	5620,10270,120,1640,2240,2450	40,5690,15990,16150,17830,20150	0	0	0
20	368100	402600	peak_7	0	.	368140	402540	0	4	2600,3260,230,28060	40,2650,5950,6380	0	0	0
20	443320	447340	peak_8	0	.	443330	447170	0	2	2860,910	10,2940	0	0	0
20	447420	479680	peak_9	0	.	447440	479630	0	2	15710,16460	20,15750	0	0	0
20	479740	480080	peak_10	0	.	479850	480010	0	1	160	110	0	0	0
  ```

I don't really know what to do now, since signal Value p-value and q-value are important for the rest of my analysis.
Thank you in advance !",MinaMyr,https://github.com/macs3-project/MACS/issues/648
I_kwDOABXaI86M08nF,Bug: OverflowError when running hmmratac,OPEN,2024-06-19T15:45:42Z,2024-06-19T15:45:42Z,,"I'm trying to run hmmratac to call peaks from my bampe files the code I used is 
hmmratac -i Alignments/file.bam -f BAMPE --outdir Peaks/ -n name

It runs for a long time but I get an 'OverflowError: signed integer is greater than maximum' error

I tried to troubleshoot but unsure how to proceed - I can run the callpeak on the same bampe file without any issues. 

Thank you in advance!

The whole running code pasted below:
[...]
INFO  @ 19 Jun 2024 15:58:13: [428 MB]  37000000 fragments parsed
INFO  @ 19 Jun 2024 15:58:16: [434 MB]  38000000 fragments parsed
INFO  @ 19 Jun 2024 15:58:19: [441 MB] 38850552 fragments have been read.
INFO  @ 19 Jun 2024 15:58:50: [441 MB] #2 Use EM algorithm to estimate means and stddevs of fragment lengths
INFO  @ 19 Jun 2024 15:58:50: [441 MB] #  for mono-, di-, and tri-nucleosomal signals...
INFO  @ 19 Jun 2024 15:58:50: [441 MB] # A random seed 10151 has been used in the sampling function
INFO  @ 19 Jun 2024 15:58:54: [491 MB] # Downsampled 1336693 fragments will be used for EM training...
INFO  @ 19 Jun 2024 16:02:48: [491 MB] # Reached convergence after 11 iterations
INFO  @ 19 Jun 2024 16:02:48: [491 MB] #  The means and stddevs after EM:
INFO  @ 19 Jun 2024 16:02:48: [491 MB] #                         short       mono         di        tri
INFO  @ 19 Jun 2024 16:02:48: [491 MB] #             means:         50      173.9      381.2        600
INFO  @ 19 Jun 2024 16:02:48: [491 MB] #           stddevs:         20       53.6       51.4         20
INFO  @ 19 Jun 2024 16:02:48: [491 MB] #  Compute the weights for each fragment length for each of the four signal types
INFO  @ 19 Jun 2024 16:02:55: [491 MB] #  Generate short, mono-, di-, and tri-nucleosomal signals
Traceback (most recent call last):
  File ""/mnt/data/Utils/python_environ/macs3/bin/macs3"", line 1028, in <module>
    main()
  File ""/mnt/data/Utils/python_environ/macs3/bin/macs3"", line 101, in main
    run( args )
  File ""/mnt/data/Utils/python_environ/macs3/lib/python3.9/site-packages/MACS3/Commands/hmmratac_cmd.py"", line 155, in run
    digested_atac_signals = generate_digested_signals( petrack, weight_mapping )
  File ""MACS3/Signal/HMMR_Signal_Processing.pyx"", line 106, in MACS3.Signal.HMMR_Signal_Processing.generate_digested_signals
  File ""MACS3/Signal/HMMR_Signal_Processing.pyx"", line 129, in MACS3.Signal.HMMR_Signal_Processing.generate_digested_signals
  File ""MACS3/Signal/BedGraph.pyx"", line 219, in MACS3.Signal.BedGraph.bedGraphTrackI.add_chrom_data_hmmr_PV
  File ""MACS3/Signal/BedGraph.pyx"", line 232, in MACS3.Signal.BedGraph.bedGraphTrackI.add_chrom_data_hmmr_PV
OverflowError: signed integer is greater than maximum
",atj31,https://github.com/macs3-project/MACS/issues/649
I_kwDOABXaI86M5c3V,Number of de-duplicated reads indicated by filterdup log does not match number of lines in output BED file.,OPEN,2024-06-20T08:38:51Z,2024-06-20T08:38:51Z,,"Unsure if this should be listed as bug or question, but it feels like something isn't working properly to me so I listed it as bug.

From the docs:
""The filterdup command takes an input alignment file and produces an output file in BED format with duplicate reads removed according to the setting.""

I ran `macs3 filterdup -f BAM --keep-dup=1 -i my/file.bam -o my/file_filterdup.bed`

The logs indicate that there are 41436468 , but the output BED file is 41436476 lines long (using wc -l). As I understand, these two values should match.

BAM file used (expires 5th of July 2024): https://filesender.renater.fr/?s=download&token=4490ed9b-04d3-4e4a-aafa-60afca608c9c
Its index was generated with default params by samtools index.

Where are these 8 extra lines coming from?


 - OS: Ubuntu 20.04.6 LTS
 - Python version 3.10.14
 - Numpy version 1.26.4
 - MACS Version 3.0.1

PS: I just ran the command on two other BAM files, getting 6 and 8 lines difference respectively.",callum-b,https://github.com/macs3-project/MACS/issues/650
I_kwDOABXaI86NmEzK,Feat: Add --call-summits option in MACS3 bdgpeakcall?,OPEN,2024-06-26T14:47:44Z,2024-06-26T14:47:44Z,,"Is it possible to implement a --call-summits feature in MACS3 bdgpeakcall? Is it possible to deconvolve subpeaks within the narrowpeak called by the bdgpeakcall?

Thanks!
",alicewang19,https://github.com/macs3-project/MACS/issues/651
I_kwDOABXaI86ORFEt,Q: using macs3 to detect peaks on long-read readings ,OPEN,2024-07-02T17:58:03Z,2024-07-02T17:58:46Z,,"I wanted to test macs3 for genomic peaks detection. For that, a number of reads obtained from Pacbio, previously aligned and subsequently sorted and indexed has been provided for macs3. 
The line of code is that. 
`
macs3 callpeak -t /home/aligment/1A_.bam -g hs -f BAM --outdir /home/aligment/-n 1A_peaks
`

Traceback (most recent call last):
  File ""/conda/envs/macs3_env/bin/macs3"", line 1028, in <module>
    main()
  File ""/conda/envs/macs3_env/bin/macs3"", line 49, in main
    run( args )
  File ""/conda/envs/macs3_env/lib/python3.12/site-packages/MACS3/Commands/callpeak_cmd.py"", line 70, in run
    (treat, control) = load_tag_files_options  (options)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/conda/envs/macs3_env/lib/python3.12/site-packages/MACS3/Commands/callpeak_cmd.py"", line 364, in load_tag_files_options
    ttsize = tp.tsize()
             ^^^^^^^^^^
  File ""MACS3/IO/Parser.pyx"", line 1131, in MACS3.IO.Parser.BAMParser.tsize
  File ""MACS3/IO/Parser.pyx"", line 1160, in MACS3.IO.Parser.BAMParser.tsize
struct.error: unpack requires a buffer of 4 bytes",MJoseMo,https://github.com/macs3-project/MACS/issues/652
I_kwDOABXaI86PtqOu,MACS3 callpeak does not create UCSC Browser ready peak files,CLOSED,2024-07-16T13:13:05Z,2024-09-07T15:51:49Z,2024-09-07T15:51:49Z,"The [MACS3 docs](https://macs3-project.github.io/MACS/docs/callpeak.html) state that callpeaks create Peak files that are compatible with the UCSC browser, but when I try to upload mine, the 7th-10th values raise errors. From the docs it looks like callpeaks is supposed ot create a track header in the file, but this is not the case. 

Was this fixed in a later version? Did I miss an option for MACS3.0.0

command used: `macs3 callpeak -f BED -t DATA/BED/CTCF_H3K9ac/H3K9ac_T7_neg_3_filterdup_filterchr.bed -c DATA/BED/CTCF_H3K9ac/Input_T7_neg_filterdup_filterchr.bed -n H3K9ac_T7_neg_3 --outdir DATA/PEAKS/CTCF_H3K9ac/ --nomodel --extsize 121 -g hs -q 0.01 2>snakemake_logs/macs3_callpeak/CTCF_H3K9ac_H3K9ac_T7_neg_3.log`


 - MACS Version 3.0.0
 
![narrow peak no header](https://github.com/user-attachments/assets/b2874e60-8229-49f2-9a7a-50bba56a7a4d)


![narrow peak ucsc error](https://github.com/user-attachments/assets/769a0afd-5a9f-4df1-a277-5cf225c64844)


",callum-b,https://github.com/macs3-project/MACS/issues/653
I_kwDOABXaI86QaJk1,Better cutoff levels control for bdgcallpeak cutoff-analysis,OPEN,2024-07-22T12:38:01Z,2024-07-24T20:54:13Z,,"I'm running bdgcallpeak on a bedGraph file optained from an input normalised bigwig file (operation used was subtraction). The minimum value in the file is approximately -5000, and the maximum is approx 1600. Therefore, when running bdgcallpeak with cutoff-analysis to see how many peaks different thresholds yield, I get this output:

```
score	npeaks	lpeaks	avelpeak
1628.50	2	400	200.00
1537.51	3	600	200.00
1446.52	3	600	200.00
1355.53	6	1200	200.00
1264.54	7	1400	200.00
1173.55	8	1600	200.00
1082.56	8	1600	200.00
991.57	8	1600	200.00
900.58	8	1650	206.25
809.59	8	1800	225.00
718.60	8	1850	231.25
627.62	8	1950	243.75
536.63	12	2950	245.83
445.64	21	4800	228.57
354.65	64	13800	215.62
263.66	239	50350	210.67
172.67	1264	267400	211.55
81.68	8335	1857700	222.88
-9.31	8536	2980185963	349131.44
-100.30	497	1609818765	3239071.96
-191.29	322	1493852546	4639293.62
-282.28	250	1375339296	5501357.18
-373.27	241	1276799008	5297921.20
-464.26	215	1091708608	5077714.46
-555.24	203	962565827	4741703.58
-646.23	173	834599219	4824272.94
-737.22	157	833794369	5310792.16
-828.21	126	799328119	6343873.96
-919.20	103	799320255	7760390.83
-1010.19	89	799323455	8981162.42
-1101.18	84	787521955	9375261.37
-1192.17	72	787524255	10937836.88
-1283.16	55	742078594	13492338.07
-1374.15	51	742079994	14550588.12
-1465.14	42	606310444	14435962.95
-1556.13	33	465246139	14098367.85
-1647.12	32	465246489	14538952.78
-1738.11	32	465247089	14538971.53
-1829.09	31	465247139	15007972.23
-1920.08	26	465243889	17893995.73
-2011.07	23	465244139	20228006.04
-2102.06	24	465244389	19385182.88
-2193.05	23	465244639	20228027.78
-2284.04	22	465244839	21147492.68
-2375.03	22	465245589	21147526.77
-2466.02	22	465245989	21147544.95
-2557.01	19	465245439	24486602.05
-2648.00	16	465245639	29077852.44
-2738.99	15	465245689	31016379.27
-2829.98	13	333369089	25643776.08
-2920.97	13	333369089	25643776.08
-3011.96	13	333369089	25643776.08
-3102.95	12	333369339	27780778.25
-3193.94	12	333369439	27780786.58
-3284.92	11	333369489	30306317.18
-3375.91	10	333310289	33331028.90
-3466.90	10	333310289	33331028.90
-3557.89	8	124043389	15505423.62
-3648.88	8	124043389	15505423.62
-3739.87	6	123766200	20627700.00
-3830.86	6	123766250	20627708.33
-3921.85	6	123766250	20627708.33
-4012.84	6	123766300	20627716.67
-4103.83	6	123766300	20627716.67
-4194.82	6	123766350	20627725.00
-4285.81	5	123765950	24753190.00
-4376.80	5	123765950	24753190.00
-4467.79	5	123766000	24753200.00
-4558.77	4	123766050	30941512.50
-4649.76	4	123766050	30941512.50
-4740.75	4	123766050	30941512.50
-4831.74	3	123766100	41255366.67
-4922.73	2	123766200	61883100.00
-5013.72	1	123766250	123766250.00
-5104.71	1	123766250	123766250.00
```
A lot of these results are useless, as they explore negative cutoffs that end up lumping large amounts of the genomes together into ""peaks"". More control over the cutoffs tested by cutoff-analysis could give me better insight into the distribution of my data.

One basic solution would be to add a ""no-negative"" option, which prevents cutoff-analysis from considering negative thresholds, which seems relevant when dealing with data normalised like mine. A more in-depth approach would be to let the user specify the min, max and step to use to calculate the cutoffs (which I assume is what cutoff-analysis with cutoff-analysis-steps does, but using the min and max in the file) to allow full control, but I don't know how feasible that is.

Currently I'm rerunning the analysis with 500 cutoffs, but still more than half of them will be unusable.

",callum-b,https://github.com/macs3-project/MACS/issues/654
I_kwDOABXaI86UjQfe,Bug: Multiple errors trying to install MACS2 on a venv,CLOSED,2024-08-28T14:33:51Z,2024-08-28T14:53:35Z,2024-08-28T14:53:35Z,"Any help with install insues?

Running MacOsX Sonoma 14.6.1 on an M2 Pro

The follow was in a venv 

% python3 -m pip install MACS2 
Collecting MACS2
  Using cached MACS2-2.2.9.1.tar.gz (2.0 MB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Collecting numpy>=1.19 (from MACS2)
  Using cached numpy-2.1.0-cp312-cp312-macosx_14_0_arm64.whl.metadata (60 kB)
Collecting Cython~=0.29 (from MACS2)
  Using cached Cython-0.29.37-py2.py3-none-any.whl.metadata (3.1 kB)
Using cached Cython-0.29.37-py2.py3-none-any.whl (989 kB)
Using cached numpy-2.1.0-cp312-cp312-macosx_14_0_arm64.whl (5.1 MB)
Building wheels for collected packages: MACS2
  Building wheel for MACS2 (pyproject.toml) ... error
  error: subprocess-exited-with-error
  
  × Building wheel for MACS2 (pyproject.toml) did not run successfully.
  │ exit code: 1
  ╰─> [265 lines of output]
      /private/var/folders/j9/tf69qfb504s4sv7gcw5rztk80000gn/T/pip-build-env-4oyzu8pa/overlay/lib/python3.12/site-packages/setuptools/_distutils/dist.py:260: UserWarning: Unknown distribution option: 'tests_require'
        warnings.warn(msg)
      running bdist_wheel
      running build
      running build_py
      creating build
      creating build/lib.macosx-14.0-arm64-cpython-312
      creating build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/OutputWriter.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/refinepeak_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/cmbreps_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/pileup_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/bdgcmp_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/Constants.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/bdgdiff_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/predictd_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/filterdup_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/bdgopt_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/__init__.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/OptValidator.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/callpeak_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/bdgbroadcall_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/bdgpeakcall_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/randsample_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/diffpeak_cmd.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      creating build/lib.macosx-14.0-arm64-cpython-312/MACS2/IO
      copying MACS2/IO/__init__.py -> build/lib.macosx-14.0-arm64-cpython-312/MACS2/IO
      copying MACS2/khash.pxd -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      copying MACS2/cPosValCalculation.pxd -> build/lib.macosx-14.0-arm64-cpython-312/MACS2
      running build_ext
      building 'MACS2.Prob' extension
      creating build/temp.macosx-14.0-arm64-cpython-312
      creating build/temp.macosx-14.0-arm64-cpython-312/MACS2
      clang -fno-strict-overflow -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -O3 -Wall -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX14.sdk -I/private/var/folders/j9/tf69qfb504s4sv7gcw5rztk80000gn/T/pip-build-env-4oyzu8pa/overlay/lib/python3.12/site-packages/numpy/_core/include -I/Volumes/LaCie/include -I/opt/homebrew/opt/python@3.12/Frameworks/Python.framework/Versions/3.12/include/python3.12 -c MACS2/Prob.c -o build/temp.macosx-14.0-arm64-cpython-312/MACS2/Prob.o -w -O3 -ffast-math -g0
      MACS2/Prob.c:2452:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2452 |   __Pyx_TraceCall(""pnorm"", __pyx_f[0], 44, 0, __PYX_ERR(0, 44, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1553:15: note: expanded from macro '__Pyx_TraceCall'
       1553 |           if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2452:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2452 |   __Pyx_TraceCall(""pnorm"", __pyx_f[0], 44, 0, __PYX_ERR(0, 44, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1561:11: note: expanded from macro '__Pyx_TraceCall'
       1561 |       if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2519:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2519 |   __Pyx_TraceReturn(__pyx_r, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1612:19: note: expanded from macro '__Pyx_TraceReturn'
       1612 |               if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2519:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2519 |   __Pyx_TraceReturn(__pyx_r, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1619:15: note: expanded from macro '__Pyx_TraceReturn'
       1619 |           if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2609:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2609 |   __Pyx_TraceCall(""pnorm (wrapper)"", __pyx_f[0], 44, 0, __PYX_ERR(0, 44, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1553:15: note: expanded from macro '__Pyx_TraceCall'
       1553 |           if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2609:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2609 |   __Pyx_TraceCall(""pnorm (wrapper)"", __pyx_f[0], 44, 0, __PYX_ERR(0, 44, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1561:11: note: expanded from macro '__Pyx_TraceCall'
       1561 |       if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2624:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2624 |   __Pyx_TraceReturn(__pyx_r, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1612:19: note: expanded from macro '__Pyx_TraceReturn'
       1612 |               if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2624:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2624 |   __Pyx_TraceReturn(__pyx_r, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1619:15: note: expanded from macro '__Pyx_TraceReturn'
       1619 |           if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2653:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2653 |   __Pyx_TraceCall(""factorial"", __pyx_f[0], 53, 0, __PYX_ERR(0, 53, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1553:15: note: expanded from macro '__Pyx_TraceCall'
       1553 |           if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2653:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2653 |   __Pyx_TraceCall(""factorial"", __pyx_f[0], 53, 0, __PYX_ERR(0, 53, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1561:11: note: expanded from macro '__Pyx_TraceCall'
       1561 |       if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2746:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2746 |   __Pyx_TraceReturn(__pyx_r, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1612:19: note: expanded from macro '__Pyx_TraceReturn'
       1612 |               if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2746:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2746 |   __Pyx_TraceReturn(__pyx_r, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1619:15: note: expanded from macro '__Pyx_TraceReturn'
       1619 |           if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2787:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2787 |   __Pyx_TraceCall(""factorial (wrapper)"", __pyx_f[0], 53, 0, __PYX_ERR(0, 53, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1553:15: note: expanded from macro '__Pyx_TraceCall'
       1553 |           if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2787:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2787 |   __Pyx_TraceCall(""factorial (wrapper)"", __pyx_f[0], 53, 0, __PYX_ERR(0, 53, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1561:11: note: expanded from macro '__Pyx_TraceCall'
       1561 |       if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2802:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2802 |   __Pyx_TraceReturn(__pyx_r, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1612:19: note: expanded from macro '__Pyx_TraceReturn'
       1612 |               if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2802:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2802 |   __Pyx_TraceReturn(__pyx_r, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1619:15: note: expanded from macro '__Pyx_TraceReturn'
       1619 |           if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2833:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2833 |   __Pyx_TraceCall(""poz"", __pyx_f[0], 65, 0, __PYX_ERR(0, 65, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1553:15: note: expanded from macro '__Pyx_TraceCall'
       1553 |           if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:2833:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       2833 |   __Pyx_TraceCall(""poz"", __pyx_f[0], 65, 0, __PYX_ERR(0, 65, __pyx_L1_error));
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1561:11: note: expanded from macro '__Pyx_TraceCall'
       1561 |       if (__Pyx_IsTracing(tstate, 1, 1)) {\
            |           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      MACS2/Prob.c:3056:3: error: no member named 'use_tracing' in 'struct _PyCFrame'
       3056 |   __Pyx_TraceReturn(Py_None, 0);
            |   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1612:19: note: expanded from macro '__Pyx_TraceReturn'
       1612 |               if (__Pyx_IsTracing(tstate, 0, 0)) {\
            |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      MACS2/Prob.c:1514:34: note: expanded from macro '__Pyx_IsTracing'
       1514 |      (unlikely((tstate)->cframe->use_tracing) &&\
            |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
      MACS2/Prob.c:981:43: note: expanded from macro 'unlikely'
        981 |   #define unlikely(x) __builtin_expect(!!(x), 0)
            |                                           ^
      fatal error: too many errors emitted, stopping now [-ferror-limit=]
      20 errors generated.
      error: command '/opt/homebrew/opt/llvm/bin/clang' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for MACS2
Failed to build MACS2
ERROR: ERROR: Failed to build installable wheels for some pyproject.toml based projects (MACS2)
",fionafitzz,https://github.com/macs3-project/MACS/issues/655
I_kwDOABXaI86VCw3C,Q: What parameters should I need to tweak for viral ChipSeq,OPEN,2024-09-02T09:58:00Z,2024-09-08T01:23:37Z,,"I came across several posts that the MACS is not fine-tuned for Viral ChipSeq (eg SARS-CoV2) (See [Post1](https://www.biostars.org/p/348105/), [Post2](https://biostar.galaxyproject.org/p/17895/). What parameters do you think needs to be adjusted to get reliable peaks?",Rohit-Satyam,https://github.com/macs3-project/MACS/issues/656
I_kwDOABXaI86WFU5o,Bug: Are requirements stated correctly?,CLOSED,2024-09-10T22:03:09Z,2024-09-12T16:26:47Z,2024-09-12T16:26:46Z,"I'm wondering if the requirements stated in requirements.txt and pyproject.toml are accurate.

Under FreeBSD ports, MACS3 seems to build and run fine using Cython 0.29.37, scipy 1.11.1, and setuptools 63.0.  Just giving a heads-up because overstating the requirements might delay or prevent addition of MACS3 to some package managers, where dependencies lag behind the latest due to other dependent packages. 

Below is one of the patches I incorporated into the FreeBSD port to get MACS 3.0.2 running.

```
--- requirements.txt.orig       2024-09-07 16:11:35 UTC
+++ requirements.txt
@@ -1,8 +1,8 @@
-Cython>=3.0,<3.1
+Cython>0
 numpy>=1.25,<2.0.0
-scipy>=1.12
+scipy>=1.11.1
 scikit-learn>=1.3
 hmmlearn>=0.3.2
 cykhash>=2.0,<3.0 
 pytest>=7.0
-setuptools>=68.0
+setuptools>=63.0
```",outpaddling,https://github.com/macs3-project/MACS/issues/658
I_kwDOABXaI86YCQah,Q: does BAMPE format require a name-sorted BAM or coordinate-sorted bam or it does not matter? ,CLOSED,2024-09-26T14:14:11Z,2024-10-02T14:22:28Z,2024-10-02T14:22:28Z,"Hello, 

I have a general question about the BAMPE format run for peakcall using MACS3. It seems like the document doesnot indicate the specific format for BAMPE as either name-sorted or coordinate-sorted. Could you clarify it here? 

Many thanks!

Best,",sotuamax,https://github.com/macs3-project/MACS/issues/661
I_kwDOABXaI86ZMSBJ,Bug: Illegal instruction     (core dumped),OPEN,2024-10-07T11:18:51Z,2024-10-07T15:12:47Z,,"**Describe the bug**
I updated to the last version of MACS3 (3.0.2) and now I get this error whenever I run the program: /tmp/slurmd/job1000362/slurm_script: line 105: 138001 Illegal instruction     (core dumped) macs3 callpeak -t ${bamFiles[@]} --outdir ${PEAK_DIR}/MACS/BAMPE/group -n ${GROUP} -f BAMPE -g 2.9e9 -q 5e-2 --keep-dup all --nomodel --broad --broad-cutoff 5e-2

**To Reproduce**
The command line I am using is: macs3 callpeak -t  ${bamFiles[@]} --outdir ${PEAK_DIR}/MACS/BAMPE/group -n ${GROUP} -f BAMPE -g 2.9e9 -q 5e-2 --keep-dup all --nomodel --broad --broad-cutoff 5e-2 

**Expected behavior**
This command line was working with MACS3 v3.0.0 until I got the same error as in issue #[637]  and I updated to the latest version.

**System (please complete the following information):**
 - OS: Red Hat Enterprise Linux 9.4 (Plow)
 - Python version 3.9.6
 - MACS Version 3.0.2 and 3.0.1

",marinafloresp,https://github.com/macs3-project/MACS/issues/663
I_kwDOABXaI86Zd3cR,Feat: Multiprocessing for calling peaks (1 process per chromosome),OPEN,2024-10-09T04:46:02Z,2024-10-09T04:46:02Z,,"AFAIK the peak caller operates sequentially on each chromosome.
I believe the process can be parallelized by calling peaks in a separate process for each chromosome (up to a certain number of processes, parametrized).  Can this feature be introduced?",jeanmonet,https://github.com/macs3-project/MACS/issues/665
I_kwDOABXaI86bFYyi,Bug: Runtime error pybind11::handle::inc_ref() PyGILState_Check() failure.,OPEN,2024-10-21T09:11:46Z,2024-10-22T04:56:15Z,,"Error message below (bottom):
INFO  @ 21 Oct 2024 16:38:48: [107 MB] 
# Command line: hmmratac -i BED_files_sorted/9.bedpe -f BEDPE -n macs3_output/9
# Random seed selected as: 10151
# Use --hmm-type to select a Gaussian ('gaussian') or Poisson ('poisson') model for the hidden markov model in HMMRATAC. Default: 'gaussian'. 
 
INFO  @ 21 Oct 2024 16:38:48: [107 MB] #1 Read fragments from BEDPE file... 
INFO  @ 21 Oct 2024 16:38:49: [197 MB]  1000000 fragments parsed 
INFO  @ 21 Oct 2024 16:38:50: [213 MB]  2000000 fragments parsed 
INFO  @ 21 Oct 2024 16:38:51: [222 MB]  3000000 fragments parsed 
INFO  @ 21 Oct 2024 16:38:52: [226 MB]  4000000 fragments parsed 
INFO  @ 21 Oct 2024 16:38:54: [226 MB]  5000000 fragments parsed 
INFO  @ 21 Oct 2024 16:38:55: [227 MB]  6000000 fragments parsed 
INFO  @ 21 Oct 2024 16:38:56: [228 MB]  7000000 fragments parsed 
INFO  @ 21 Oct 2024 16:38:57: [229 MB]  8000000 fragments parsed 
INFO  @ 21 Oct 2024 16:38:58: [239 MB]  9000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:00: [245 MB]  10000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:01: [259 MB]  11000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:02: [263 MB]  12000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:03: [263 MB]  13000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:04: [273 MB]  14000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:06: [273 MB]  15000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:07: [279 MB]  16000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:08: [279 MB]  17000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:09: [289 MB]  18000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:10: [305 MB]  19000000 fragments parsed 
INFO  @ 21 Oct 2024 16:39:24: [358 MB] #2 Use EM algorithm to estimate means and stddevs of fragment lengths 
INFO  @ 21 Oct 2024 16:39:24: [358 MB] #  for mono-, di-, and tri-nucleosomal signals... 
INFO  @ 21 Oct 2024 16:39:24: [359 MB] # A random seed 10151 has been used in the sampling function 
INFO  @ 21 Oct 2024 16:39:26: [428 MB] # Downsampled 1904083 fragments will be used for EM training... 
INFO  @ 21 Oct 2024 16:45:35: [428 MB] # Reached convergence after 14 iterations 
INFO  @ 21 Oct 2024 16:45:35: [428 MB] #  The means and stddevs after EM: 
INFO  @ 21 Oct 2024 16:45:35: [428 MB] #                         short       mono         di        tri 
INFO  @ 21 Oct 2024 16:45:35: [428 MB] #             means:         50      210.1      382.4      611.7 
INFO  @ 21 Oct 2024 16:45:35: [428 MB] #           stddevs:         20       45.8       45.7      101.8 
INFO  @ 21 Oct 2024 16:45:35: [428 MB] #  Compute the weights for each fragment length for each of the four signal types 
INFO  @ 21 Oct 2024 16:45:42: [428 MB] #  Generate short, mono-, di-, and tri-nucleosomal signals 
INFO  @ 21 Oct 2024 16:56:22: [928 MB] #  Pile up all fragments 
INFO  @ 21 Oct 2024 16:56:43: [928 MB] #  Convert pileup to fold-change over average signal 
INFO  @ 21 Oct 2024 16:56:49: [928 MB] #3 Look for training set from 19146841 fragments 
INFO  @ 21 Oct 2024 16:56:49: [928 MB] #  Call peak above within fold-change range of 10 and 20. 
INFO  @ 21 Oct 2024 16:56:49: [928 MB] #   The minimum length of the region is set as the average template/fragment length in the dataset: 592 
INFO  @ 21 Oct 2024 16:56:49: [928 MB] #   The maximum gap to merge nearby significant regions is set as the flanking size to extend training regions: 1000 
INFO  @ 21 Oct 2024 16:56:53: [928 MB] #  Total training regions called after applying the lower cutoff 10: 12930 
INFO  @ 21 Oct 2024 16:56:53: [928 MB] #  Total training regions after filtering with upper cutoff 20: 3820 
INFO  @ 21 Oct 2024 16:56:53: [928 MB] #  **IMPORTANT** 
INFO  @ 21 Oct 2024 16:56:53: [928 MB] #  Please review the cutoff analysis result in macs3_output/9_cutoff_analysis.tsv to verify 
INFO  @ 21 Oct 2024 16:56:53: [928 MB] #   if the choices of lower, upper and prescanning cutoff are appropriate. 
INFO  @ 21 Oct 2024 16:56:53: [928 MB] #   Please read the message in the section 'Choices of cutoff values' by running 
INFO  @ 21 Oct 2024 16:56:53: [928 MB] #   `macs3 hmmratac -h` for detail. 
INFO  @ 21 Oct 2024 16:56:53: [928 MB] #  **** 
INFO  @ 21 Oct 2024 16:57:39: [928 MB] #  We randomly pick 1000 regions for training 
INFO  @ 21 Oct 2024 16:57:39: [928 MB] #  We expand the training regions with 1000 basepairs and merge overlap 
INFO  @ 21 Oct 2024 16:57:39: [928 MB] #4 Train Hidden Markov Model with Multivariate Gaussian Emission 
INFO  @ 21 Oct 2024 16:57:39: [928 MB] #  Extract signals in training regions with bin size of 10 
INFO  @ 21 Oct 2024 16:57:50: [1116 MB] #  Use Baum-Welch algorithm to train the HMM 
pybind11::handle::inc_ref() is being called while the GIL is either not held or invalid. Please see https://pybind11.readthedocs.io/en/stable/advanced/misc.html#common-sources-of-global-interpreter-lock-errors for debugging advice.
If you are convinced there is no bug in your code, you can #define PYBIND11_NO_ASSERT_GIL_HELD_INCREF_DECREF to disable this check. In that case you have to ensure this #define is consistently used for all translation units linked into a given pybind11 extension, otherwise there will be ODR violations. The failing pybind11::handle::inc_ref() call was triggered on a numpy.ndarray object.
Traceback (most recent call last):
  File ""/Users/kiliankleemann/anaconda3/envs/macs3/bin/macs3"", line 983, in <module>
    main()
  File ""/Users/kiliankleemann/anaconda3/envs/macs3/bin/macs3"", line 97, in main
    run( args )
  File ""/Users/kiliankleemann/anaconda3/envs/macs3/lib/python3.12/site-packages/MACS3/Commands/hmmratac_cmd.py"", line 305, in run
    hmm_model = hmm_training( training_data, training_data_lengths, random_seed = options.hmm_randomSeed, hmm_type = options.hmm_type )
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""MACS3/Signal/HMMR_HMM.pyx"", line 60, in MACS3.Signal.HMMR_HMM.hmm_training
  File ""MACS3/Signal/HMMR_HMM.pyx"", line 70, in MACS3.Signal.HMMR_HMM.hmm_training
  File ""/Users/kiliankleemann/anaconda3/envs/macs3/lib/python3.12/site-packages/hmmlearn/base.py"", line 485, in fit
    stats, curr_logprob = self._do_estep(X, lengths)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/Users/kiliankleemann/anaconda3/envs/macs3/lib/python3.12/site-packages/hmmlearn/base.py"", line 764, in _do_estep
    lattice, logprob, posteriors, fwdlattice, bwdlattice = impl(sub_X)
                                                           ^^^^^^^^^^^
  File ""/Users/kiliankleemann/anaconda3/envs/macs3/lib/python3.12/site-packages/hmmlearn/base.py"", line 884, in _fit_log
    log_prob, fwdlattice = _hmmc.forward_log(
                           ^^^^^^^^^^^^^^^^^^
RuntimeError: pybind11::handle::inc_ref() PyGILState_Check() failure.



**System (please complete the following information):**
 - OS:  Mac OSX
 - Python version: Python 3.11.4 
 - MACS Version macs3 3.0.1

",Kiliankleemann,https://github.com/macs3-project/MACS/issues/666
I_kwDOABXaI86bRBM-,Bug: Overflow error when using Poisson law for bdgcmp,OPEN,2024-10-22T09:58:49Z,2024-10-22T21:22:17Z,,"I'm trying to run bdgcmp on some spike-in normalised bedGraphs I've generated used MACS3 tools. Here is the command line I'm running:
`macs3 bdgcmp -m qpois -t DATA/BED/TEAD1/TEAD1_T1_pos_1_pileup_GRCh38_sort_spikeBDGP6.32_pe.bedGraph -c DATA/BED/TEAD1/Input_T1_pos_pe_pileup_sort_norm10M_nozero.bedGraph -o DATA/BED/TEAD1/TEAD1_T1_pos_1_pileup_GRCh38_sort_spikeBDGP6.32_pe_qval.bedGraph`

Here's the output from MACS3:

```
INFO
@ 21 Oct 2024 17:49:30: [38 MB] Read and build treatment bedGraph...
INFO
@ 21 Oct 2024 17:49:32: [65 MB] Read and build control bedGraph...
INFO
@ 21 Oct 2024 17:49:35: [96 MB] Build ScoreTrackII...
INFO
@ 21 Oct 2024 17:49:38: [154 MB] Calculate scores comparing treatment and control by 'qpois'...
Traceback (most recent call last):
File ""MACS3/Signal/ScoreTrack.pyx"", line 67, in MACS3.Signal.ScoreTrack.get_pscore
File ""src/cykhash/maps/map_impl.pxi"", line 2448, in cykhash.khashmaps.PyObjectMap.__getitem__
File ""src/cykhash/maps/map_impl.pxi"", line 2445, in cykhash.khashmaps.PyObjectMap.cget
KeyError: (-2147483648, 0.009999999776482582)
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
File ""/usr/local/bioinfo/src/MACS/MACS-v3.0.0/MACS-v3.0.0_venv/bin/macs3"", line 1028, in <module>
main()
File ""/usr/local/bioinfo/src/MACS/MACS-v3.0.0/MACS-v3.0.0_venv/bin/macs3"", line 65, in main
run( args )
File ""/usr/local/bioinfo/src/MACS/MACS-v3.0.0/MACS-v3.0.0_venv/lib/python3.11/site-packages/MACS3/Commands/bdgcmp_cmd.py"", line 72, in run
sbtrack.change_score_method( ord('q') )
File ""MACS3/Signal/ScoreTrack.pyx"", line 354, in MACS3.Signal.ScoreTrack.ScoreTrackII.change_score_method
File ""MACS3/Signal/ScoreTrack.pyx"", line 371, in MACS3.Signal.ScoreTrack.ScoreTrackII.change_score_method
File ""MACS3/Signal/ScoreTrack.pyx"", line 407, in MACS3.Signal.ScoreTrack.ScoreTrackII.compute_pvalue
File ""MACS3/Signal/ScoreTrack.pyx"", line 69, in MACS3.Signal.ScoreTrack.get_pscore
File ""MACS3/Signal/Prob.pyx"", line 209, in MACS3.Signal.Prob.poisson_cdf
OverflowError: can't convert negative value to npy_uint32
```
I tried running the same command on a subset of the bedGraphs (chr15) and got the same behaviour, so I don't think it's tied to the size of the file/number of reads, which was my first thought given the Overflow error. These files can be downloaded [here](https://drive.google.com/file/d/1HRv7BjGYiXTFfosZ1ACZ62oI3U4gOk9k/view?usp=sharing) and [here](https://drive.google.com/file/d/1VAxM-vkkhRGqVGk_AARAg-0HpI4JSfwq/view?usp=sharing) in gzipped format.

bdgcmp does however work when using `-m subtract`, so it probably isn't coming from the data files I'm processing.

What's happening with the Poisson law in bdgcmp? Why is it failing?

**System**
 - OS: Ubuntu 20.04.6 LTS
 - Python version: 3.10.14
 - Numpy version: 1.23.5
 - MACS Version: 3.0.1

",callum-b,https://github.com/macs3-project/MACS/issues/667
I_kwDOABXaI86bs8PA,Q: Filtering blacklisted regions when using macs3 hmmeratac,OPEN,2024-10-24T18:01:30Z,2024-10-28T15:56:10Z,,"Hello,

I do not see an option to filter out blacklisted regions when using hmmeratac. In the original hmmratac paper they state that this is a crucial step.

Should I remove the reads mapping to these regions beforehand ?",eggrandio,https://github.com/macs3-project/MACS/issues/669
I_kwDOABXaI86cQ6yA,Q: gappedPeak instead of narrow peak on HMMRATAC output,OPEN,2024-10-29T15:52:00Z,2024-11-04T21:03:24Z,,"**Use case**
I'm using the hmmratac implementation within MACS3 but it does not output narrowPeak.

**Describe the problem**
I'm using the hmmratac implementation within MACS3 but it does not output narrowPeak. Instead it outputs a gappedPeak file. The description of the columns for the original HMMRATAC gappedPeak output () do not match the MACS3 output.

**Describe the solution you tried**
I'm using the gappedPeak column descriptors provided by ENCODE (https://genome.ucsc.edu/FAQ/FAQformat.html#format14), but it's not clear if this is correct. The ""score"" column is all 0. Would it be possible to either output narrowPeak using macs3 hmmratac or to provide a better description for the columns on the gappedPeak output? Could the documentation please be changed? It currently says the output is narrowPeak. 

",jffpviana,https://github.com/macs3-project/MACS/issues/670
I_kwDOABXaI86d7iOF,Q: MACS3 hmmratac for single-cell ATAC-seq,OPEN,2024-11-11T15:14:51Z,2024-11-11T15:14:51Z,,"Hello,

I would like to use the MACS3 hmmratac tool to peak call my 10x multiome (single-cell ATAC-seq) dataset. I firstly ran the cutoff analysis as follows:
`macs3 hmmratac -i file.bam -n file -f BAMPE --outdir ./dir --cutoff-analysis-only`

I am attaching two output files, from two separate samples:
[sample2_cutoff_analysis.txt](https://github.com/user-attachments/files/17704188/sample2_cutoff_analysis.txt)
[sample1_cutoff_analysis.txt](https://github.com/user-attachments/files/17704189/sample1_cutoff_analysis.txt)

I have two questions:

1. The documentation suggests that the lower cutoff should capture a moderate number (10k) of normal-sized peaks (500-1000 bp), whilst the upper cutoff should capture typically hundreds of very high fold change, abnormally large peaks. Looking at my outputs, it seems like my lower cutoff should be higher than the upper cutoff. E.g. in sample 1 I would set the lower cutoff around the 600 bp average peak length mark (so -l = 77), and the upper cutoff around the 2000 bp average peak length mark (so -u = 4). Shouldn't these numbers be the opposite way around (-l being smaller than -u)? Which cutoffs would you suggest selecting for my samples?
2. These two samples are part of a group of multiple samples that I would need to analyse together and compare to each other. However, as you can see, the outputs from the cutoff analysis are quite different, and I would pick different thresholds for these two samples. Should I attempt to pick the same cutoffs for both, for downstream analyses e.g. differential accessibility, etc., or is it fine to pick different, sample-specific cutoffs?

Thanks for your time!
",acv21,https://github.com/macs3-project/MACS/issues/671
I_kwDOABXaI86eUaWa,Bug: NameError: name 'BedGraphIO' is not defined. Did you mean: 'bedGraphIO'?,OPEN,2024-11-13T16:54:02Z,2024-11-13T20:11:36Z,,"Hello,

I am using MACS3 v. 3.0.2 with Python v. 3.9.20 and Numpy v. 2.0.2.  I tried running the following code from the folder containing my .bam files:
```
for i in ./*.bam; do 
 macs3 hmmratac -i $i -n ${i%.bam} --outdir ./out -u 20 -l 10 -c 1.2 --save-digested --save-states --save-likelihoods -e /dir/mm10-blacklist.v2.bed
done
```

I get the following error message for each sample:

> Traceback (most recent call last):
>   File ""/package/python-cbrg/current/3.11/bin/macs3"", line 983, in <module>
>     main()
>   File ""/package/python-cbrg/current/3.11/bin/macs3"", line 97, in main
>     run( args )
>   File ""/package/python-cbrg/current/3.11/lib/python3.11/site-packages/MACS3/Commands/hmmratac_cmd.py"", line 168, in run
>     bdgshort = BedGraphIO( short_bdgfile, data = digested_atac_signals[ 0 ] )
>                ^^^^^^^^^^
> NameError: name 'BedGraphIO' is not defined. Did you mean: 'bedGraphIO'?

I think this may have been fixed on main branch (https://github.com/macs3-project/MACS/commit/8b4fbe09a04f49669e2454ad75f31ecab3d60a92#diff-12485f39398e04990a47b92449150ec60f8a87fdf2cbadbbc58bb3869c57a471R34). Is there anything I can do to be able to run the analysis before the next MACS3 version is released, with the fix for this bug?

Thank you!
",acv21,https://github.com/macs3-project/MACS/issues/672
I_kwDOABXaI86eZTRs,Q: There's a huge difference between my peak number and the bio company's peak number,OPEN,2024-11-14T03:27:05Z,2024-11-28T04:16:43Z,,"When I use macs3 call peak(for atac), I only get 5500 peaks, But when I checked the bio company's report, they got a peak of 30,000.
I want to know the possible reasons。
Here's my code：
macs3 callpeak -g 762311306 -t MF-1-A.final.bam --name ./MF1A -B --format BAM --qvalue 0.075 --cutoff-analysis --broad --nomodel --shift -75 --extsize 150

",bigshark12345,https://github.com/macs3-project/MACS/issues/673
I_kwDOABXaI86ec2YN,"Docs: ""Install from source"" guide is broken",CLOSED,2024-11-14T10:34:50Z,2024-11-19T10:29:29Z,2024-11-19T10:29:29Z,"In [Install from source through pip](https://macs3-project.github.io/MACS/docs/INSTALL.html#install-from-source-through-pip) you say to run:

> git clone --recurse-submodules git@github.com:macs3-project/MACS.git

Fails for me:

```
Cloning into 'MACS'...
The authenticity of host 'github.com (20.26.156.215)' can't be established.
ED25519 key fingerprint is SHA256:+<redacted>.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'github.com' (ED25519) to the list of known hosts.
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.
```

Why not just do this?
> git clone --recurse-submodules https://github.com/macs3-project/MACS.git",aowenson-imm,https://github.com/macs3-project/MACS/issues/674
I_kwDOABXaI86fSp_S,About ATAC-seq call peak (hmmratac) and differential analysis via MACS3,OPEN,2024-11-19T14:52:04Z,2024-11-19T14:52:04Z,,"### Discussed in https://github.com/macs3-project/MACS/discussions/675

<div type='discussions-op-text'>

<sup>Originally posted by **DayTimeMouse** November 19, 2024</sup>
Hi，

Thanks for developing this function to call peaks for ATAC-Seq.

I ran` macs3 hmmratac -i final.bam -n treat --cutoff-analysis-only`. Then, I got the report(see the attachment), according to the document, -l may set to `45` (that can capture moderate number ( about 10k ) of peaks with normal width ( average length 500-1000bps long)), but I'm confused about setting `-u` and `-c `parameter.
The report:
[treat_cutoff_analysis.txt](https://github.com/user-attachments/files/17816797/treat_cutoff_analysis.txt)

Another question, I have control and treatment, which are no repeats. So, can I use MASC3 to do differential analysis? Could you give me a detail approach？

Thanks in advance.</div>",DayTimeMouse,https://github.com/macs3-project/MACS/issues/676
I_kwDOABXaI86f5pEc,Q: AssertionError: No proper d can be found! Tweak --mfold?,OPEN,2024-11-22T10:04:36Z,2024-11-22T10:04:36Z,,"Dear MACS2 team,

Thank you for providing this excellent tool! However, I encountered an issue when running the following command:

`
macs2 callpeak \
  -t /DataM/hhl/task/24_11_analysis/rqh_new/06remove_duplication_call_peak/01remove_duplication/EEEE/remove_duplication/E1IP.sorted.markdup.bam \
  -c /DataM/hhl/task/24_11_analysis/rqh_new/06remove_duplication_call_peak/01remove_duplication/EEEE/remove_duplication/E2ku.sorted.markdup.bam \
  -n E1_IP_E2_input \
  -g hs \
  --outdir /DataM/hhl/task/24_11_analysis/rqh_new/06remove_duplication_call_peak/02mapping/E1_IP_E2_input/ \
  -B `
When executing this, I encountered the following error:

`Traceback (most recent call last):
  File ""/DataC/miniconda3/bin/macs2"", line 653, in <module>
    main()
  File ""/DataC/miniconda3/bin/macs2"", line 51, in main
    run(args)
  File ""/DataC/miniconda3/lib/python3.10/site-packages/MACS2/callpeak_cmd.py"", line 168, in run
    peakmodel = PeakModel(treatment = treat,
  File ""MACS2/PeakModel.pyx"", line 105, in MACS2.PeakModel.PeakModel.__init__
  File ""MACS2/PeakModel.pyx"", line 147, in MACS2.PeakModel.PeakModel.build
  File ""MACS2/PeakModel.pyx"", line 229, in MACS2.PeakModel.PeakModel.__paired_peak_model
AssertionError: No proper d can be found! Tweak --mfold?`
I’m wondering why this error occurs. Could it be related to my input BAM files or parameter settings? Additionally, how can I resolve this issue?

Any guidance on properly adjusting the --mfold parameter or addressing this problem would be greatly appreciated.

Thank you in advance for your support!

Best regards,
Nanu

",nanu23333,https://github.com/macs3-project/MACS/issues/677
I_kwDOABXaI86h7c76,Q: Haplotype genomes have no peak,OPEN,2024-12-04T06:50:23Z,2024-12-04T06:50:23Z,,"I got a plant genome, and I call peak with nine mixed chromosomes and two haplotype assembled chromosomes(x1x2),
But the x1x2 barely got a peak.
What I gave to the company was 10 mixed genomes, and when I compared the same data to the 10 mixed chromosomes, every chromosome had basically normal peaks
I wonder why? (Because of x1x2?)
<img width=""1136"" alt=""屏幕截图 2024-12-04 144949"" src=""https://github.com/user-attachments/assets/a0afb26d-bdc5-4cdb-bb9a-6fcb0fdc11eb"">


",bigshark12345,https://github.com/macs3-project/MACS/issues/679
I_kwDOABXaI86iIISs,Bug: No peaks detected in not-blacklisted regions when a blacklist is given to macs3 hmmratac,OPEN,2024-12-05T10:40:14Z,2024-12-05T10:40:14Z,,"Hi,
I have run macs3 hmmratac with and without a blacklist and I have realised that even small blacklisted regions (~1kb long can lead to huge gaps in the peak calling, but only in some samples. Not giving the black list fixed the issue. 

These gaps seem more frequent in samples with worse signal-to-noise ratio, but the peak calling is overall very good except for the gaps.

Also, hmmratac was run on bams already filtered for the blacklisted regions, so it was probably unnecessary to run it with the black list, but I thought you would want to know that this can happen. 

Kind regards

![Screenshot 2024-12-05 at 11 36 24](https://github.com/user-attachments/assets/b6932a9f-569a-4d22-a92f-bc312b053fa4)",MariaRig,https://github.com/macs3-project/MACS/issues/680
I_kwDOABXaI86jO8lk,Q: the likelihood of bdgdiff,OPEN,2024-12-13T15:06:46Z,2024-12-13T15:07:41Z,,"hello Tao, @taoliu 
   I was just wondering how to derive this LR formula. Can you please explain it in more details?
![image](https://github.com/user-attachments/assets/35119651-422b-40c8-b19f-5fb791797b2d)

https://macs3-project.github.io/MACS/docs/bdgdiff.html

Best,

",BenxiaHu,https://github.com/macs3-project/MACS/issues/681
