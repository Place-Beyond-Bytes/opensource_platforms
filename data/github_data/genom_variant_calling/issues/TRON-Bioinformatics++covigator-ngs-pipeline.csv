id,title,state,created_at,updated_at,closed_at,body,user,url
MDU6SXNzdWU5ODA4ODYzOTg=,VCF isn't created when running pipeline,CLOSED,2021-08-27T05:25:13Z,2021-09-03T08:26:54Z,2021-09-03T08:26:54Z,"Running covigator-ngs-pipeline with 2 fastq files returns error message and does not create vcf file.
It does create these 5 files as expected: 
4014963632_S9.coverage.tsv
4014963632_S9.deduplication_metrics.txt
4014963632_S9.depth.tsv
4014963632_S9.fastp_stats.html
4014963632_S9.fastp_stats.json

0. all files were added to the covigator-ngs-pipeline generated by the git clone 
(added reference files NC_045512.fa,  NC_045512.sorted.gff3, and NC_045512.dict and the indexed files that were processed with bwa and samtools previously)

Steps to reproduce the behavior.
1.
$ git clone https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline.git
$ cd covigator-ngs-pipeline 
$ nextflow main.nf -profile conda --initialize
$ conda info --envs 
$ conda activate /Users/mokrobial/covigator-ngs-pipeline/work/conda/covigator-pipeline-7bbe89a37e1b4f3ad6e1a1a7fb6a53e5

2.
Re-ran commands for ref fasta just in case: 
$ bwa index NC_045512.fa
$ samtools faidx NC_045512.fa

3.
$ nextflow run tron-bioinformatics/covigator-ngs-pipeline --fastq1 4014963632_S9_L001_R1_001.fastq --fastq2 4014963632_S9_L001_R2_001.fastq --name 4014963632_S9 --output covigator-output --reference NC_045512.fa --gff NC_045512.sorted.gff3

Result: Error message - see below. The NC_045512.fa.fai file is present in the directory.

Error executing process > 'variantNormalization (4014963632_S9)'
Caused by:
  Process `variantNormalization (4014963632_S9)` terminated with an error exit status (255)

Command executed:
 initial sort of the VCF
  bcftools sort 4014963632_S9.bcftools.bcf | 
   checks reference genome, decompose multiallelics, trim and left align indels
  bcftools norm --multiallelics -any --check-ref e --fasta-ref NC_045512.fa     --old-rec-tag OLD_CLUMPED - | 
  decompose complex variants
  vt decompose_blocksub -a -p - | 
   remove duplicates after normalisation
  bcftools norm --rm-dup exact -o 4014963632_S9.bcftools.normalized.vcf -

Command exit status:
  255

Command output:
  (empty)

Command error:
 Writing to /tmp/bcftools-sort.zWnXi8
  Merging 1 temporary files
  Cleaning
  Done
  [E::fai_build3_core] Failed to open the file NC_045512.fa
  Failed to load the fai index: NC_045512.fa
  decompose_blocksub v0.5
  
  options:     input VCF file          -
           [o] output VCF file         -
           [a] align/aggressive mode   true
           [p] output phased genotypes true
  
  [bcf_ordered_reader.cpp:71 BCFOrderedReader] Not a VCF/BCF file: -
  Failed to read from standard input: unknown file type


Environment:
 - OS: macOS BigSur 11.4
 - nextflow version 21.04.1.5556
 - samtools 1.12, Using htslib 1.12
 - openjdk version ""1.8.0_282""
- OpenJDK Runtime Environment (Zulu 8.52.0.23-CA-macosx) (build 1.8.0_282-b08)
- OpenJDK 64-Bit Server VM (Zulu 8.52.0.23-CA-macosx) (build 25.282-b08, mixed mode)
- 
<img width=""1028"" alt=""Screen Shot 2021-08-26 at 10 24 26 PM"" src=""https://user-images.githubusercontent.com/35383549/131076253-84137182-682d-481f-8569-6d8f9dcab877.png"">
",mokrobial,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/1
I_kwDOFlUBMc48s9_5,Support processing batches of samples,CLOSED,2021-10-06T14:16:14Z,2021-10-14T07:17:14Z,2021-10-13T12:26:57Z,"I'm a little bit confused on running the pipeline on multiple samples.
Is there a way to run the pipeline once with multiple samples such as putting multiple reads in the fastq parameter (ie. --fastq1 /pathtofastq/*_1.fastq) and nextflow can parallelize the computation?

OR I have to run pipeline for each sample?


Thanks!",faustincombe,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/5
I_kwDOFlUBMc5FQO0U,Is there a way to save the original bam files?,CLOSED,2022-03-07T20:22:50Z,2022-03-15T15:13:13Z,2022-03-15T15:13:13Z,"Great tool.
I was wondering if it is possible to save the bams after running the pipeline. I suspect that in my data we have two sars-cov-2 lineages in a sample, and I want to plot a stacked barplot using the count data of the nucleotides per position.
It would be a time saver if I had the bam files.",fhsantanna,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/14
I_kwDOFlUBMc5FSuBT,"In relation to the GATK variant call, is there a quality score recalibration step?",CLOSED,2022-03-08T11:20:16Z,2022-04-01T13:12:28Z,2022-04-01T13:12:27Z,"In relation to the GATK variant call, is there a quality score recalibration step (https://theme.zdassets.com/theme_assets/2378360/93dea832e3bf97f306b79d50032af8d9baa64df5.png)?
Thanks.
",fhsantanna,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/15
I_kwDOFlUBMc5FTpvN,ARTIC primer masking,CLOSED,2022-03-08T15:15:31Z,2022-04-29T07:58:12Z,2022-04-01T13:10:43Z,"Pablo, thank you very much for the quick responses.
Another question, does the pipeline mask or remove the ARTIC primers in the reads? I had a look at the fastp step code, but I could not find a parameter that would permit this procedure.
My sequence data was obtained using the kit QIAseq for Illumina, which is based on the ARTIC protocol (https://artic.network/resources/ncov/ncov-amplicon-v3.pdf). In the following pipeline, they remove the ARTIC primers using ""ivar trim"": https://github.com/CDCgov/SARS-CoV-2_Sequencing/tree/master/protocols/BFX-UT_ARTIC_Illumina",fhsantanna,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/17
I_kwDOFlUBMc5Grw9p,Dependency for gtfparse python package is not managed from within the conda environment,CLOSED,2022-03-30T05:00:55Z,2023-10-16T09:04:59Z,2023-10-16T09:04:59Z,"When the python package gtfparse is not installed in the base the pipeline fails in the phasing step.
",priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/20
I_kwDOFlUBMc5Pw-PB,No signature of method: java.lang.Boolean.getFileSystem() is applicable for argument types: () values: [],CLOSED,2022-08-14T12:54:57Z,2022-08-14T13:10:42Z,2022-08-14T13:07:15Z,"**Describe the bug**
The pipeline works fine on test fastq files but not on my real data

**Code Used**
I am using following command (the complete path was given however here it has been replaced woth `<path>`).

```
nextflow run tron-bioinformatics/covigator-ngs-pipeline  -profile conda  --input_fastqs_list --library paired --output inhouse_data \
--primers '<path>illumina/covigatorTest/resources/SARS-CoV-2.primer.bed' --reference '<path>/illumina/covigatorTest/resources/covigator-ngs-pipeline/reference/Sars_cov_2.ASM985889v3.dna.toplevel.fa' \
--gff '<path>/illumina/covigatorTest/resources/covigator-ngs-pipeline/reference/Sars_cov_2.ASM985889v3.101.gff3'
```

It gives me the following error:

```bash
N E X T F L O W  ~  version 22.04.5
Launching `https://github.com/tron-bioinformatics/covigator-ngs-pipeline` [wise_kimura] DSL2 - revision: 650ae3e685 [master]
Using custom reference genome: <path>/illumina/covigatorTest/resources/covigator-ngs-pipeline/reference/Sars_cov_2.ASM985889v3.dna.toplevel.fa
Skipping SnpEff annotation as either --snpeff_data, --snpeff_config or --snpeff_organism was not provided
[-        ] process > READ_TRIMMING_PAIRED_END -
[-        ] process > ALIGNMENT_PAIRED_END     -
[-        ] process > BAM_PREPROCESSING        -
[-        ] process > PRIMER_TRIMMING_IVAR     -
[-        ] process > COVERAGE_ANALYSIS        -
[-        ] process > VARIANT_CALLING_BCFTOOLS -
[-        ] process > VARIANT_CALLING_LOFREQ   -
[-        ] process > VARIANT_CALLING_GATK     -
[-        ] process > VARIANT_CALLING_IVAR     -
[-        ] process > IVAR2VCF                 -
[-        ] process > VCF2FASTA                -
[-        ] process > PANGOLIN_LINEAGE         -
[-        ] process > VARIANT_NORMALIZATION    -
[-        ] process > VAFATOR                  -
[-        ] process > VARIANT_VAF_ANNOTATION   -
[-        ] process > PHASING                  -
[-        ] process > BGZIP                    -
No signature of method: java.lang.Boolean.getFileSystem() is applicable for argument types: () values: []
```",Rohit-Satyam,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/23
I_kwDOFlUBMc5TafMZ,In which step exactly are homoplasmic mutations taken care of,CLOSED,2022-10-06T11:50:46Z,2023-01-04T14:33:35Z,2023-01-04T14:33:35Z,"HI @priesgo 

I was reading the following posts: [Post 1](https://virological.org/t/issues-with-sars-cov-2-sequencing-data/473) and [Post2](https://virological.org/t/masking-strategies-for-sars-cov-2-alignments/480) that suggest few regions to be masked before alignment step. I can see that in your pipeline there is a vcf file named [problematic_sites](https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/blob/master/reference/problematic_sites_sarsCov2.vcf.gz) which I think highlights these regions. But I can't figure out in which module you use this file to mask the regions. Can you point me to that module?

Maybe this is a naive question but will it be appropriate to use this `problematic_sites` vcf file to mask regions assembllies generated using Nanopore data as well? ",Rohit-Satyam,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/26
I_kwDOFlUBMc5U3FBO,Improvement in Variant calling,CLOSED,2022-10-26T09:33:25Z,2022-11-05T23:51:09Z,2022-11-05T23:51:09Z,"@priesgo 
@ibn-salem 
@ozlemmuslu 

I am using COVIGATOR as a reference to build my own Nextflow pipeline and thanks for doing a wonderful job. Your code is clean and comprehensible. I have few queries and suggestions that I need your insight on

## Suggestion 
I stumbled upon [this post](https://www.biostars.org/p/9466154/), that recommends use of `-x` in `bcftools mpileup` flag to disable read-pair overlap detection, following an [issue on bcftools](https://github.com/samtools/bcftools/issues/1475) and use of `-h500` flag for not missing deletions of high coverage, [see](https://github.com/samtools/bcftools/issues/1459).

Also, maybe `-m 10`

**EDIT 1:** There is also some issue with IVAR related to spanning deletions that can be temporarily taken care of by using `--ignore-overlaps`. See [issue1](https://github.com/BU-ISCIII/viralrecon/issues/14) and [issue2](https://github.com/andersen-lab/ivar/issues/104)

**EDIT2:** I also observe a weird trend of more variants being reported by ivar when we don't use `--reference` option in `samtools pileup`. Attaching the results obtained on same sample with the only difference of `--reference Sars_cov_2.ASM985889v3.dna.toplevel.fa`. Can you tell me what's happening?



[ivar-results.xlsx](https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/files/9873992/ivar-results.xlsx)
",Rohit-Satyam,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/28
I_kwDOFlUBMc5VNdnx,Use the reference in mpileup to reduce FPs,CLOSED,2022-10-31T10:13:37Z,2022-11-19T17:23:27Z,2022-11-19T17:23:27Z,This is spinned off #28 ,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/29
I_kwDOFlUBMc5VNexv,Add optional --ignore-overlaps to ivar,CLOSED,2022-10-31T10:17:05Z,2022-11-19T17:23:10Z,2022-11-19T17:23:10Z,Spin off feature request from #28 ,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/30
I_kwDOFlUBMc5VNfbu,Add optional arguments to BCFtools,CLOSED,2022-10-31T10:19:06Z,2022-11-19T17:22:53Z,2022-11-19T17:22:53Z,Spin off request from #28 ,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/31
I_kwDOFlUBMc5VRTrw, AttributeError: 'str' object has no attribute 'name',CLOSED,2022-10-31T22:55:51Z,2023-01-04T14:38:42Z,2023-01-04T14:38:42Z,"**Describe the bug**
Getting error at Pangolin Step. I made a completely new environment and still getting this error.

```
Error executing process > 'PANGOLIN_LINEAGE (23_S2)'

Caused by:
  Process `PANGOLIN_LINEAGE (23_S2)` terminated with an error exit status (1)

Command executed:

  mkdir tmp
  
  #--decompress-model
  pangolin     23_S2.lofreq.fasta     --outfile 23_S2.lofreq.pangolin.csv     --tempdir ./tmp     --threads 1

Command exit status:
  1

Command output:
  All dependencies satisfied.
  The query file is:23_S2.lofreq.fasta
  ** Running sequence QC **
  Number of sequences detected: 1
  Total passing QC: 1
  
  Data files found:
  Trained model:	/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/pangoLEARN/data/decisionTree_v1.joblib
  Header file:	/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/pangoLEARN/data/decisionTreeHeaders_v1.joblib
  Designated hash:	/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/pangoLEARN/data/lineages.hash.csv

Command error:
  Traceback (most recent call last):
    File ""/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/snakemake/__init__.py"", line 699, in snakemake
      success = workflow.execute(
    File ""/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/snakemake/workflow.py"", line 1043, in execute
      logger.run_info(""\n"".join(dag.stats()))
    File ""/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/snakemake/dag.py"", line 2176, in stats
      yield tabulate(rows, headers=""keys"")
    File ""/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/tabulate/__init__.py"", line 2048, in tabulate
      list_of_lists, headers = _normalize_tabular_data(
    File ""/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/tabulate/__init__.py"", line 1471, in _normalize_tabular_data
      rows = list(map(lambda r: r if _is_separating_line(r) else list(r), rows))
    File ""/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/tabulate/__init__.py"", line 1471, in <lambda>
      rows = list(map(lambda r: r if _is_separating_line(r) else list(r), rows))
    File ""/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/tabulate/__init__.py"", line 107, in _is_separating_line
      (len(row) >= 1 and row[0] == SEPARATING_LINE)
    File ""/home/subudhak/Documents/COVID_Project/nextCov/covigator/work/conda/env-5845bf8b576de5c186debf2a42754a48/lib/python3.8/site-packages/snakemake/rules.py"", line 1127, in __eq__
      return self.name == other.name and self.output == other.output
  AttributeError: 'str' object has no attribute 'name'

Work dir:
  /home/subudhak/Documents/COVID_Project/nextCov/covigator/work/4e/0ebd32d5b6dc9c09cfaaa8ab782283

Tip: you can replicate the issue by changing to the process work dir and entering the command `bash .command.run`


```

**To Reproduce**

```
nextflow run tron-bioinformatics/covigator-ngs-pipeline [-r v0.13.0] -profile conda --fastq1 dana_covid_data/23_S23_L001_R1_001.fastq.gz --fastq2 dana_covid_data/23_S23_L001_R2_001.fastq.gz --name 23_S2 --output S2_23_results --primers ~/Documents/COVID_Project/nextCov/resources/primers.bed --keep_intermediate -resume
```




",Rohit-Satyam,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/32
I_kwDOFlUBMc5VVzaf,Apply normalization of VCFs before `bcftools consensus` in preparation for Pangolin,CLOSED,2022-11-01T17:08:10Z,2022-11-19T17:22:38Z,2022-11-19T17:22:38Z,This is derived from #28 ,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/33
I_kwDOFlUBMc5VWTYW,Python tests are failing and CI environment does not capture the error,CLOSED,2022-11-01T18:47:25Z,2022-11-19T17:22:26Z,2022-11-19T17:22:26Z,,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/34
I_kwDOFlUBMc5WEE8H,Discussion on Masking the regions with coverage less than 20X,OPEN,2022-11-10T13:26:13Z,2023-10-10T06:34:01Z,,"Dear @priesgo 

While going through the pipeline, I realized that the VCF2FASTA does not masks the regions of low coverage. In amplicon sequencing data, there might be regions deprived of reads. I think it make sense to mask such regions with Ns that we know are covered by less than 20 reads as we can't say about variant status in that region. Using the reference sequence in such regions might indicate that there is no variant in that region. 

Besides, could you enable the pipeline to copy these fasta assemblies as well to the result directory. I tried using `--keep_intermediate` but it didn't help. I can see there is no `publishDir ""${params.output}"", mode: ""copy""` for `VCF2FASTA` process.

EDIT 1: Also, I think the code take the normalized VCFs and without filtering the Low Frequency and Subclonal variants, it includes all of them in the assembly. Is this assembly good for GISAID submission? Because as you say in your documentation `Other low quality mutations are removed from the output.`",Rohit-Satyam,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/35
I_kwDOFlUBMc5WkiM8,A special variant case which phasing.py is unable to resolve ,CLOSED,2022-11-16T23:11:50Z,2022-11-22T06:41:17Z,2022-11-21T14:38:52Z,"The script `phasing.py` is unable to resolve these two variants and throws error 

```
    result = parse_gtf(
  /home/subudhak/miniconda3/envs/temp/lib/python3.9/site-packages/gtfparse/read_gtf.py:151: FutureWarning: The error_bad_lines argument has been depr
ecated and will be removed in a future version.


    result = parse_gtf(
  INFO:root:Extracted GTF attributes: ['description=ORF1a', 'description=surface', 'description=ORF3a', 'description=envelope', 'description=membrane
', 'description=ORF6', 'description=ORF7a', 'description=ORF7b', 'description=ORF8', 'description=nucleocapsid', 'description=ORF10']
  WARNING: --discard-invalid-alignments in the future will be activated by default.
  Note: the --sample option not given, applying all records regardless of the genotype
  The fasta sequence does not match the REF allele at MN908947.3:28361:
     REF .vcf: [GGAGAACGCAGAGAACGCA]
     ALT .vcf: [GG]
     REF .fa : [GGAGAACGCAGTGGGGCGC]G


```
```
MN908947.3      28361   .       GGAGAACGCA      G       177.149 PASS    DP=191;DPS=87,104;Pool=1;vafator_af=0.65021;vafator_ac=158;vafator_dp=243;vaf
ator_eaf=0.5;vafator_pu=1;vafator_pw=1;vafator_k=5;vafator_bq=0,0;vafator_mq=60,60;vafator_pos=157,175.5;vafator_rsmq=0.993;vafator_rsmq_pv=0.32086;v
afator_rspos=0.766;vafator_rspos_pv=0.44359   GT:GQ   1:177
MN908947.3      28362   .       GAGAACGCA       G       146.658 PASS    DP=49;DPS=40,9;Pool=2;vafator_af=0.0125;vafator_ac=3;vafator_dp=240;vafator_e
af=0.5;vafator_pu=0;vafator_pw=1;vafator_k=5;vafator_bq=0,0;vafator_mq=60,60;vafator_pos=164,140;vafator_rsmq=-0.481;vafator_rsmq_pv=0.63073;vafator_
rspos=-1.828;vafator_rspos_pv=0.06749 GT:GQ   1:147
```

After running `phasing.py`

```
MN908947.3      28361   .       GGAGAACGCAGAGAACGCA     GG      177.149 PASS    DP=191;DPS=87,104;Pool=1;vafator_af=0.65021;vafator_ac=158;vafator_dp
=243;vafator_eaf=0.5;vafator_pu=1;vafator_pw=1;vafator_k=5;vafator_bq=0,0;vafator_mq=60,60;vafator_pos=157,175.5;vafator_rsmq=0.993;vafator_rsmq_pv=0
.32086;vafator_rspos=0.766;vafator_rspos_pv=0.44359     GT:GQ   1:177
```",Rohit-Satyam,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/36
I_kwDOFlUBMc5ZB--6,Filter out indels at ends of genome (especially relevant for FASTAs... use homoplasmic regions from DeMaio),CLOSED,2022-12-13T08:30:04Z,2023-01-04T14:33:03Z,2023-01-04T14:33:03Z,,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/41
I_kwDOFlUBMc5ghEEX,ONT sequencing data,CLOSED,2023-03-10T16:46:05Z,2024-01-25T12:48:54Z,2024-01-25T12:48:53Z,"In the section ""Future work"" of the README file it's stated that you would like to add a feature for analyse also ONT sequencing data. I would like to know if you are working on this and if you have some idea of when this feature is going to be available.
Many thanks, 
Sara",smanfri,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/45
I_kwDOFlUBMc5osnUY,Update documentation for custom reference to BWA mem2,CLOSED,2023-06-14T10:06:18Z,2024-01-25T12:46:52Z,2024-01-25T12:46:51Z,,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/46
I_kwDOFlUBMc5osn7X,Add documentation for setting up SnpEff for custom reference,CLOSED,2023-06-14T10:07:37Z,2024-01-25T12:46:26Z,2024-01-25T12:46:25Z,,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/47
I_kwDOFlUBMc5ou7VV,Update documentation with need of providing GFF file for phasing,CLOSED,2023-06-14T15:10:33Z,2024-01-25T12:46:09Z,2024-01-25T12:46:09Z,,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/48
I_kwDOFlUBMc5o0Ima,Create a nextflow subworkflow that prepares a given reference given a FASTA and a GFF (indexing + snpEff),CLOSED,2023-06-15T10:12:22Z,2024-01-25T12:45:50Z,2024-01-25T12:45:50Z,,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/49
I_kwDOFlUBMc5xJPBb,Pangolin only mode,CLOSED,2023-09-15T11:36:06Z,2023-10-10T16:11:57Z,2023-10-10T16:11:57Z,,johausmann,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/51
I_kwDOFlUBMc5xwMLx,Support for conda,CLOSED,2023-09-22T08:41:17Z,2023-09-22T12:00:57Z,2023-09-22T12:00:57Z,"The current conda profile in nextflow.config is not compatible with newer nextflow versions. The pipeline could not use conda when nextflow version 23.04.3 was used. However, it is compatible with 20.10.0.",johausmann,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/52
I_kwDOFlUBMc5zTqB3,ENH: Add Nextclade for phylogenetic informed QC,OPEN,2023-10-10T06:52:04Z,2023-10-10T11:18:31Z,,"**Is your feature request related to a problem? Please describe.**
This looks like a great pipeline that includes a lot of useful tools. I've noticed that you're still adding things to it.

One thing that could make it even better is to integrate Nextclade (disclosure: I work on it)

Besides providing an alternative way to call Pango lineages for SARS-CoV-2, Nextclade generalizes clade calling beyond SARS-CoV-2, e.g. Influenza, mpox, etc.

It also outputs helpful QC metrics of the final consensus genome output:
- Reversion mutations relative to nearest neighbor from reference tree(if many this indicates artefacts due to pipeline misconfiguration or contamination or recombination)
- frameshifts -> frameshifts are often a sign of pipeline making an off-by-one indel errors
- stop codons -> indicative of artefacts if in essential genomes
- ambiguous mutations -> can indicate contamination

Nextclade also places a sequence on a phylogenetic tree, which should be appreciated by end users.

**Describe the solution you'd like**
Include Nextclade into the pipeline

**Additional context**
I'd be happy to assist with development of this feature.",corneliusroemer,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/55
I_kwDOFlUBMc5zU2FC,Mamba support,CLOSED,2023-10-10T09:07:05Z,2023-11-21T08:37:35Z,2023-11-21T08:37:34Z,Software dependencies are currently managed by conda. Managing these dependencies with Mamba could be a significant speed improvement,johausmann,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/56
I_kwDOFlUBMc50wP-7,Produced VCFs are claimed to be malformed by IGV,OPEN,2023-10-24T08:56:24Z,2023-10-24T09:05:30Z,,"When trying to load a VCF in IGV it gives the following error message:
```
The provided VCF file is malformed at approximately line number 69: The VCF specification does not allow for whitespace in the INFO field. Offending field value was ""DP=29;AF=0.103448;SB=0;DP4=13,13,1,2;INDEL;HRUN=5;ANN=C|frameshift_variant|HIGH|ORF1ab|gene-GU280_gp01|transcript|TRANSCRIPT_gene-GU280_gp01|protein_coding|1/1|c.10122delT|p.S3376fs|10122/21290|10122/21290|3374/7095||WARNING_TRANSCRIPT_MULTIPLE_STOP_CODONS;LOF=(ORF1ab|gene-GU280_gp01|1|1.00);CONS_HMM_SARS_COV_2=0.57215;CONS_HMM_SARBECOVIRUS=0.57215;CONS_HMM_VERTEBRATE_COV=0;PFAM_NAME=Peptidase_C30_CoV;PFAM_DESCRIPTION=Peptidase C30,coronavirus;vafator_af=0.103448;vafator_ac=3;vafator_dp=29"",
```

Apparently, the PFAM_DESCRIPTION field does contain white spaces. A possible solution would affect both the pipeline and the processor. The pipeline would need to generate valid VCF. For instance replacing white spaces by under scores. The processor would need to replace back the under scores into white spaces when loading the data into the database. One possible problem in this implementation is that there may be other under scores in INFO fields that we don't want to replace by white spaces.",priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/57
I_kwDOFlUBMc50wV1d,Check PR on nanopore in pipeline,OPEN,2023-10-24T09:10:57Z,2023-10-24T09:10:58Z,,,priesgo,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/58
I_kwDOFlUBMc51Ar-P,Update pangolin version in pipeline,CLOSED,2023-10-26T09:38:55Z,2023-11-21T08:37:35Z,2023-11-21T08:37:35Z,We use a relatively old version of pangolin. We should update to version 4.3. ,johausmann,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/60
I_kwDOFlUBMc54xptX,Different pangolin lineages given variant caller,OPEN,2023-12-05T14:05:00Z,2023-12-05T14:05:00Z,,"Hi,

First, thank you for this great tool. I have a list of different pipelines to test, and yours is the only one that got installed and runs easily!

I ran your pipeline on my fastq files and in the results directory I got different fasta files, one for each VCF file as explained. All of them except for the lofreq resulted as a BA.2 lineage et the lofreq one was B.1.1.529.

How do I know which tool's results I should keep?

Thanks,
Best",GoncheDanesh,https://github.com/TRON-Bioinformatics/covigator-ngs-pipeline/issues/63
