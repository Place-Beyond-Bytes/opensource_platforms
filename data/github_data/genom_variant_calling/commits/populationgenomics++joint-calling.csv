commit_sha,commit_author_name,commit_author_email,commit_message,commit_date,login
0520237cbc78a59fca407b4d2781b53344365c2e,Michael Franklin,michael.franklin@populationgenomics.org.au,Renames get_sequences_by_sample_ids to *_for_sample_ids (#92),2022-10-17T06:07:24Z,illusional
832133d9b8e3ddfe4e436aa067a63719c6bb33cd,Leonhard Gruenschloss,leonhard.gruenschloss@populationgenomics.org.au,Fix license description (#90),2022-03-27T23:12:13Z,lgruen
01e407d2b3b710cc2e82a785978ae9113a85b9c1,Vlad Savelyev,vladislav.sav@gmail.com,"Make release VCF. Nagim. Support relateds. SM 4.0.0. Add X het/hom ratio and freqs (#85)

* Support read input from tsv file

* Add nagim

* Fix check pedigree

* Fix merge: sql-config in ci/deployment.yaml

* Add topostproc_gvcf field

* Improve scripts/make_nagim_tsv.py

* Bump version: 0.3.30 → 0.3.31

* Add flag to skip adding validation samples

* Add flag to skip excesshet filter. Reuse excesshet filter outputs.

* Fix job dependencies

* Fix save tmp files for hard_filter

* Bump version: 0.3.31 → 0.3.32

* --keep-scratch by default

* VQSR ApplyVQSR: write temporary VCF to /io/batch

* Fix making ped file

* Fix making ped file - 2

* When missing input QC stats, dont fail sample

* Fix

* Fix generating ped from df

* Fix

* Bump version: 0.3.32 → 0.3.33

* Fix VQSR

* Ped fixes

* Update nagim script

* VQSR disk sizes: add comments

* Add --asume-gvcfs-are-ready option. Adjust parsing QC from seq meta for old and new format

* Parse multiple metadata files

* Annotate matrix table with freqs. Put variant qc hts into the analysis bucket.

* Add chrx_r_het_hom_var into the sex annotations

* Export final vcf

* Bump version: 0.3.33 → 0.3.34

* Put chrx hot hem ration into custom_qc

* Bump version: 0.3.34 → 0.3.35

* Custom metrics

* Add --source-tag to support nagim. Update for SM 4.0.0.

* Bump version: 0.3.35 → 0.4.0

* Clean up makefile

* Clean up makefile

* Clean up

* Fix

* Fix

* Bump version: 0.4.0 → 0.4.1

* Fix

* Fix

* assume_gvcf_exists affects somalier file checks too

* get_mt(): add option to remove related. For freq, use unrelated samples only

* Bump version: 0.4.1 → 0.4.2

* Add script to write release VCF

* Bump version: 0.4.2 → 0.4.3

* Make executble

* Bump version: 0.4.3 → 0.4.4

* Fix

* Split scripts/prepare_vcf_data_release.py into release_vcf_prepare_ht.py and elease_vcf_export_chrom.py

* Bump version: 0.4.4 → 0.4.5

* Clean up (mt.info should be added in make_finaL_mt)

* Fix scripts/release_vcf_export_chrom.py

* Change vcf ext back to gz

* Change vcf ext back to gz - 2

* Change vcf ext back to gz - 3

* Bump version: 0.4.5 → 0.4.6",2021-12-09T07:17:38Z,vladsavelyev
febb518fcbf20ebcd98c4c50813f1e45c8adc29b,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Fix no value for param  (#83)

* Switch sample_ids with request_body

* fix project name",2021-11-03T05:52:55Z,vivbak
74a43b97e85c48f637712cd0cdf2e610dcd05ef9,Vlad Savelyev,vladislav.sav@gmail.com,"PCA plots: use external IDs, fix double counting (#82)

* Plots: use external sample ids

* Reuse somalier relate results to avoid cluttering with somalier per-sample jobs

* --meta-csv -> --meta-tsv

* Fix

* Fix

* Fix

* PCA: only generate HTML

* Fix PCA plot",2021-10-25T07:05:15Z,vladsavelyev
5b6904b608e3075939388c90775f9391945a91fb,Vlad Savelyev,vladislav.sav@gmail.com,"Update PCA plots, fix PED file, check existence flags (#81)

* Add --check-existence flag to control whether to check input gvcf existence

* Fix dependencies

* PCA plot legend

* Check fam stats before reuse generate_variant_qc_annotations

* Pass generated ped file to variant qc

* Ancestry plots fix markers size

* More room for the pca plot

* Fix defaults for pedigree

* Dont print out somalier pairs result for big datasets

* Remove ` from check_pedigree script for bash doesnt try to parse it

* Fix PED file in pedigree checks

* Fix

* Fix

* Fix

* Fix

* Fix

* Fix

* Fix

* Provide age and sex through command line

* Separate with ::

* Fix

* Fix parsing ped

* Fix parsing ped

* Default ped fields in samples_df to - to avoid erros parsing",2021-10-13T22:54:35Z,vladsavelyev
0b5612b421ae27a4c78691fc5056f232aa7200f0,Vlad Savelyev,vladislav.sav@gmail.com,"Add Somalier for relatedness checks (#79)

* Add somalier

* Clean up

* Fix

* Fix

* Bump version: 0.3.24 → 0.3.25

* Fix

* Fix pedigree checker

* Fix

* Pass somalier results to sample_qc_flag_related.py

* Bump version: 0.3.25 → 0.3.26

* Fix

* Return somalier job instead of check job

* Fix

* Fix

* Add fam info

* use 90k sites

* Use v5

* Key sites by locus only

* Use v4

* Use v3-90k

* PCA plot: add study to the legend, use different markers

* Use 90k sites for PCA

* Define cluster object outside of functions

* Buckets rename

* Bump version: 0.3.26 → 0.3.27

* Refactor plotting

* Fix

* Fix

* Fix

* Fix

* Bump version: 0.3.27 → 0.3.28

* Fix

* Bump version: 0.3.28 → 0.3.29

* Use gencode gtf from hail-common bucket because our doesnt conform to bgz

* Bump version: 0.3.29 → 0.3.30

* Put somalier into project-level buckets",2021-10-07T10:56:11Z,vladsavelyev
501fff336d79266156766febba6aa96c20877a49,Katalina Bobowik,katalina.bobowik@populationgenomics.org.au,Incorporate gene names into hover tools. (#80),2021-10-07T09:05:13Z,KatalinaBobowik
6ef204e71c37f6ad514c16f7fc9285caa06d0cd5,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Fix Unit Tests (#77)

* add sm_environment env var + switch project

* Fix Teardown

* WIP testing

* Update project to fewgenomes-test

* Remove SM_ENVIRONMENT var

* skip variant_qc_plotting lint

* Remove testing artifacts",2021-10-05T02:59:40Z,vivbak
89629e0c8328ea418c595c0a6ff98e3a6c6b32d8,Vlad Savelyev,vladislav.sav@gmail.com,"Move more requester-pay files & fix in PCA plot (#78)

* Move more gnomad files to AU

* For PCA, use purcell sites

* Fix

* PCA sites: add gnomAD v2

* PCA sites: save sites separately

* Fix

* Bump version: 0.3.19 → 0.3.20

* Use PCA sites from purcell + gnomad-v2

* Bump version: 0.3.20 → 0.3.21

* On test runs, output gvcf and crams to project-level -test instead of -test-tmp

* Fix

* Fix

* Fix

* Move fore files from requester-pays. Introduce resources package

* Bump version: 0.3.21 → 0.3.22

* Parametrise score_bin_agg with refernece hts

* Support variant calling from bam input

* Fix

* Subset hgdp: use somalier sites

* Use Somalier sites

* Bump version: 0.3.22 → 0.3.23

* Fix

* Bump version: 0.3.23 → 0.3.24

* Fix

* 3h for long dataproc job

* Add legend

* Fix",2021-09-26T02:28:15Z,vladsavelyev
6796f6a059015dda17d00e937aec646441e495f6,Vlad Savelyev,vladislav.sav@gmail.com,"Move requester-pays ref files (#76)

* Fix alignment resource group

* thousandgenomes: write to test

* Fix align du -sh

* Use GATK 4.2.1.0

* Move requester-pay gnomad resources to cpg

* Update version

* Bump version: 0.3.18 → 0.3.19

* Fix

* Alignment: more storage when BAM input",2021-09-21T09:18:56Z,vladsavelyev
0a9945c2566e5a5914a7f9f2d4caeec40ddc6f22,Vlad Savelyev,vladislav.sav@gmail.com,"Add validation samples. Add alignment and haplotypecaller. (#75)

* test_upload.yaml: update image

* Add alignment and haplotype caller

* Use hgdp subset

* Fix

* Fix

* Fix

* Fix

* Fix dependencies

* Alignment: 750G

* Reusing only raw sample TSV

* Use pre-computed HGDP subsets

* Localize CRAMs with wget if pulling from HTTPs

* Validation samples in gs://cpg-reference/validation

* HC - stream?

* HC - stream?

* HC - stream fix

* Point HaplotypeCaller to index explicitly (otherise it looks for sample.crai)

* Fix converting metadata from pandas to ht (replacing all NA with - to help type convertion)

* Pass TSV around instead of input-metadata-ht

* Bump version: 0.3.10 → 0.3.11

* Fix

* Bump version: 0.3.11 → 0.3.12

* Fix

* Bump version: 0.3.12 → 0.3.13

* Fix provided pop ht

* Bump version: 0.3.13 → 0.3.14

* Remove LD prunning for generating subset because the sites are already ld-prunned

* Fix

* Dont generate nonref. Put hts into the analysis bucket.

* Fix: set_index for pd

* Fix

* Fix

* Update Makefile

* Fix reuse

* Fix

* Move gnomad subsets to gs://cpg-reference/hg38/ancestry/gnomad_sites

* Clean up

* Reuse cluster between jobs

* Put properties of clusters into name

* Fix

* Cluster ID cant be longer than 49 characters

* Fix dependencies

* Fix

* pylint: allow 200 statements

* Fix VarQC job deps

* Fixes. Debug subsetting hgdp

* Fix

* Update version

* Bump version: 0.3.14 → 0.3.15

* subset_hgdp in one job. Version the result bucket

* Fix ancestry - subset twice for all and nfe

* Fix ancestry - subset twice for all and nfe

* Subset for pca - use v0

* Subset for pca - use v0

* Bump version: 0.3.15 → 0.3.16

* Refactor. Add dataproc.get_cluster

* Version

* Bump version: 0.3.16 → 0.3.17

* Fewer workers for pc_relate

* Fix

* Bump version: 0.3.17 → 0.3.18

* Fix

* Fix linting",2021-09-17T05:18:44Z,vladsavelyev
8ec57acf7d395dff5470c18d542f7d5dfc200a79,Vlad Savelyev,vladislav.sav@gmail.com,"Integrate ancestry (#74)

* Fix dependencies

* Some refactoring. Add library data into the table

* Rename metadata bucket to analysis

* Add combine with hgdp, subset for pca, and calculate pca

* Fix

* Update reading from SM

* Fix yaml.load->yamlsafe_load

* Querying analyses for all samples in one request

* Update version

* Bump version: 0.3.6 → 0.3.7

* Fix

* Fix

* Fix

* Fix

* Fix

* Matrix for pc-relate already have GT and not END

* Fix

* pcrelate to assume GT annotated mt

* Subset hgdp to 20 samples for test

* Add pca_pop.py to produce pca specifically for one pop

* Move file path definitions to utils making sure sample_qc module is only imported in hail scripts

* Drop find_inputs from fs, rename find_inputs_from_db->find_inputs

* Integrate PCA plots

* Rename pca mts

* Fix

* Fix

* Fix

* Fix

* Use pre-computed hgdp union

* Temproary fix

* Fix

* Fix

* Fix

* Fix

* Bump version: 0.3.7 → 0.3.8

* Fix

* Fix

* Fix

* Bump version: 0.3.8 → 0.3.9

* Add install_common.sh for plot pca job

* Fix

* Fix

* Fix

* Bump version: 0.3.9 → 0.3.10

* Fix

* utils.can_reuse to take a list

* Add test dataproc with pyfiles

* Use pyfiles instead of package

* Fix ancestry plot

* Use joint-calling package for dataproc until this is merged and official package is released https://github.com/populationgenomics/hail/pull/71

* PCA plot: fix label

* min_pop_prob 0.5

* Add subset_hgdp

* subset hgdp job dependencies

* Add README

* subset_hgdp.py: allow reusing

* subset_hgdp.py fix

* subset_hgdp.py fix

* Linting",2021-09-13T02:55:14Z,vladsavelyev
10b40d40d385ef010b1307722dcad2e494446b97,Vlad Savelyev,vladislav.sav@gmail.com,"Sample QC refactoring (mostly `pc_relate`) (#73)

* Separate pc-relate into standalone script

* Replace writes with checkpoints

* Add comment

* Bump version: 0.3.5 → 0.3.6",2021-08-31T00:47:54Z,vladsavelyev
b5520573b475ea894fbb3ed513c81a1557dcfaa6,Vlad Savelyev,vladislav.sav@gmail.com,"Split `sample_qc.py` into `sample_qc_calculate.py` and `sample_qc_write_metadata.py` (#72)

* Split sample_qc.py into sample_qc_calculate.py and sample_qc_write_metadata.py

* Update test version

* Bump version: 0.3.4 → 0.3.5

* Fix

* Fix

* Fix",2021-08-29T04:10:55Z,vladsavelyev
e3295ccae7c8867e2fffe901e1f4306d2a534bcc,Vlad Savelyev,vladislav.sav@gmail.com,"Sample QC: use non-preemptible workers (#71)

* Use non-preemptible workers for sample qc

* Fix conda github workflow",2021-08-26T13:40:41Z,vladsavelyev
953340980a9c466c32229eeecc3de5235b00f560,Vlad Savelyev,vladislav.sav@gmail.com,Fix setting up workers disk (#70),2021-08-26T13:09:32Z,vladsavelyev
8db1f1709debd07574260dc2a68b7db7b28a3a13,Vlad Savelyev,vladislav.sav@gmail.com,"More disk for sample_qc (#69)

* More disk for sample_qc

* Fix linting",2021-08-26T11:55:44Z,vladsavelyev
017ed3de09121437dda09f93744842016c40300b,Vlad Savelyev,vladislav.sav@gmail.com,Add tmp dir for VQSR (#68),2021-08-25T10:24:58Z,vladsavelyev
4326448add1dc96208bd50028f1617e8906671c8,Vlad Savelyev,vladislav.sav@gmail.com,More space for applyrecalibrator (#67),2021-08-25T04:41:03Z,vladsavelyev
a2f155469a5117aa32d6ad8ba9125e6e611e69e7,Vlad Savelyev,vladislav.sav@gmail.com,"Various SM communication fixes (#66)

* Add reading samples debug info. Add --use-gnarly-genotyper option

* Bump version: 0.3.3 → 0.3.4

* Support test data from SM

* Use only batch1 for test

* Fix

* Fix

* gvcfs are named after external ids

* Fix logging

* Fix testing

* Fix testing

* Fix testing

* Reblock debug prints

* Fix building samples DF

* Pass samples names to combiner

* Fix sample names (use internal IDs in mt, external in age)

* Rename external id to internal in subset noalts job

* Fix annotating age",2021-08-24T10:17:56Z,vladsavelyev
529162c9aa56c8b4e8eb7d0d06e90fc23e6f4595,Vlad Savelyev,vladislav.sav@gmail.com,"Run joint-calling from this repo rather than tob-wgs (#65)

* Drop --batches argument

* Move the batch_workflow.py script to root dir

* Fix scripts dir",2021-08-17T08:08:22Z,vladsavelyev
c0a0684c66b986b2256166a99da53fe4c4d235ee,Vlad Savelyev,vladislav.sav@gmail.com,"Read data from the SM server (#64)

* Add flag --input-projects and read from db

* Fix

* Remove the direct buckets input fidning approach

* Make --meta-csv required for combine_gvcfs

* Use can_reuse function

* Make workflows/batch_workflow.py executable",2021-08-17T06:42:39Z,vladsavelyev
31ba519e8448cc7259c16d98661181fa9b61ce16,Vlad Savelyev,vladislav.sav@gmail.com,"Split mt, add `snps_not_on_gnomad`, move ref files (#59)

* Move ref data to cpg ref bucket

* Calculate non-gnomad SNPs

* Fix

* Run sample_qc for a filtered mt

* Fix counting in gnomad

* Keep only NA12787 in truth samples

* Evaluation fixes

* Fix truth evaluation

* VQSR: upload the indel tranches plots and RScripts

* Create README locally and copy to the bucket

* WIP

* Fix

* When making finalized MT, split multiallics and anno with GT to make sure final-filter is applied

* SampleQC: filter non-PASS and filter LCR. Run after VQSR again

* Fix choosing passing sites

* Bump version: 0.2.12 → 0.3.0

* When filtering for passing variants, workout when filters field dont exist

* Bump version: 0.3.0 → 0.3.1

* Fix

* Fix

* Set contamination cutoff to 4%

* No need to run sample_qc after variant QC

* Fix counting variants not in gnomad

* Fix linting

* Move the gnomad ref files to cpg-reference

* Try-catch add analysis

* Bump version: 0.3.1 → 0.3.2

* Move SM utils into sm_utils.py

* Bump version: 0.3.2 → 0.3.3

* Fix",2021-08-16T13:33:14Z,vladsavelyev
5a470843902070c06e46aac4bff5addcf84ecf48,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Pull latest inputs using SM API (#57)

* Pull latest inputs using SM API

* Fix calculation of new and deleted

* Update in line with latest API changes

* Pull latest inputs using SM API

* remove 20 limit",2021-08-15T23:38:36Z,vivbak
422531d327def484977acfeb660b64f2fe0ab74b,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,Fix merge (#63),2021-08-13T07:38:21Z,vivbak
a86f1c1642e793926ee1dca4a0490e153fb3684a,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,Fix reads (#62),2021-08-13T07:33:26Z,vivbak
c10c1dd1a2d998d9584b4d39e66f58d93bb6b9b6,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,Fix request body arg (#61),2021-08-13T07:20:36Z,vivbak
8103e6ffce56046c5b2372de2305471ee33b6bf9,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,Add 300 cap (#60),2021-08-13T07:05:11Z,vivbak
bbd28a025f9c07874dc00ead38b0361c9db2513a,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"remove sm_project, replace with project (#58)",2021-08-13T04:41:08Z,vivbak
f41afd01686996d8679e09bf86aeff812948f583,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Integrate sample metadata API (#51)

* Modify Upload Processor Implementation
* Updates process_uploads to include API calls to return the samples, rather than pulling from the CSV
* Updates upload_processor to move the files according to their internal ID rather than external

* Clean up python_job condition

* Ingest csv data
* A separate upload_samples file was created that handles the csv files that are periodically added. This csv file identifies the newly added samples, as well as associated metadata.

* Apply changes from review
* Refactor for efficiency.
* Fix sample_id bug.
* Rename functions for clarity

* Modify update_samples
* Replace get_latest_uploads with get_samples_with_gvcfs in line with feedback

* Modify upload samples
* Creates analysis objects

* Replace sample_id with sample_id_external to add clarity

* Clean up comments

* Update variable names and comments

* Map back to internal IDs

* Replace updating sample status with sample sequence status

* Combine Process Uploads and Upload Samples
* Removes the need for intermediate status
* Removes the need for get samples from db function

* Update function calls

* Update API calls

* Refactor code & update calls
* Split create_analysis function into two -- update the sample metadata API after a successful move rather than before.
* Update API calls in line with correct syntax

* Modify test script
* Tests upload processor functionality with latest sample metadata integration

* Fix Analysis Runner Call

* Remove comment

* Update function call + project name

* get_sample_id_map --> get_sample_id_map_by_external

* Add new logic for removing csv dependency

* Update determine_samples logic

* Remove API Dependency + Add batch_number

* Add Multi-Batch Processing + Streamline + Refactor
* Store Internal ID in SampleGroup - significantly reduces API calls.
* Collapse upload_crams and upload_gvcfs --> upload_analysis
* Pull batch number from SM_DB rather than command line var.
* Calculate path per sample (multi-batch processing)

* Update according to code review changes

* Fix file name

* apis -> apis

* model -> models

* model -> models

* tmp remove try except

* tmp sm_project hard code.

* get_sequence_id_from_sample_id -> get_sequence

* revert back to get_sequence_by_id

* TMP add debug print statements for AR

* AnalysisStatus('completed')-> AnalysisStatus.COMPLETED

* Fix file_extension

* Fix file extension

* Update test script

* modify upload_files

* fix api call

* WIP debugging.

* Update files_to_move

* WIP further debug.

* WIP further debug

* Fix batch!

* Clean up

* Clean up

* Refactor in line with code review

* update sm_project for testing

* update sequence call

* remove invalid arguments

* update variable

* WIP debug

* Fix arguments

* WIP Debug

* Fix get sample_id

* debug type

* Fix invocation

* Add debug statements

* Create FileGroup NamedTuple
* Defines the path and basename separately
* Allows file extension to be calculated
* Removes the need for the upload path as it's pulled from db
* Define data_file, index_file and md5 as FileGroup object.
* Modify population of SampleGroup in determine samples accordingly.
* Modify md5 file path calculation.
* Removed outdated functions

* Fix Sample_group.data_file -> sample_group.data_file.basename

* Update API calls

* Fix test function in line with upload_processor changes.

* Remove TODO

* Clean up

* clean up

* Add sequence update

* Remove sequencing update

* clean up

* Apply changes in line with code review

* add testing var

* Remove testing var

* Fix file path

* Remove testing variable",2021-08-13T02:40:15Z,vivbak
ed388067cb3b69b5ac588825a89058420010a377,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Pull only the md5 hash, remove filename (#55)",2021-07-07T04:35:08Z,vivbak
7795abe9072bd0c88eed29a673b3cd0820c381dc,Vlad Savelyev,vladislav.sav@gmail.com,"Matrix table output updates (#53)

* Make nonref mt

* Write readme file

* Write raw mt to tmp bucket

* Final MT job to depend on conbiner job

* Fix linting",2021-07-06T15:08:43Z,vladsavelyev
22d5dd3704a3104a3f7eeebf9e348bfdd08ad531,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,Remove gs:// from output dir (#54),2021-07-06T15:02:36Z,vivbak
3dd8947a917140dd30dde499511570a9b862a66c,Vlad Savelyev,vladislav.sav@gmail.com,"Add storage for hl.export_vcf (#52)

* Do not make info-split VCF version (errors https://batch.hail.populationgenomics.org.au/batches/3025/jobs/3)

* Fix docstrings

* Add script to test mt2vcf storage

* Move batch_mt2vcf.py

* Fix

* Fix

* Test

* Test

* Clean up

* Set huge_disk to worker_boot_disk_size for export_vcf

* Clean up",2021-07-01T09:34:17Z,vladsavelyev
301d4d05f9570a671e5f98aa4ed1e776e7b549da,Vlad Savelyev,vladislav.sav@gmail.com,"Refactor docstrings (#50)

* Do not make info-split VCF version (errors https://batch.hail.populationgenomics.org.au/batches/3025/jobs/3)

* Fix docstrings",2021-06-29T07:24:16Z,vladsavelyev
e3207aab8656959b169e21093fdb3c4e364a1be8,Vlad Savelyev,vladislav.sav@gmail.com,"ReblockGVCFs: keep low quals (#49)

* Remove ReblockGVCF

* Keep ReblockGVCF, but drop the --drop-low-quals option",2021-06-23T12:06:51Z,vladsavelyev
eb82d3656e2eec18aa26b4f60e08a3f6a2c14d69,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Validate MD5  (#48)

* Create further sink/gather structure
* Updated generate_file_list to produce files divided according to sample, so each set of files related to a sample can be processed separately
* Updated run_processor to iterate over each sample group
* Created a skeleton structure for the validate_md5 job.

* Add MD5 Validation Script

* Catch unprovided docker image

* Remove local testing artefacts

* Fix variable names

* Apply code review suggestions
* Adding type hints, fixing comments, creating a SampleGroup NamedTuple, fixed unspotted path error

* Apply suggestions from code review

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

* Fix SampleGroup Attribute

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>",2021-06-23T05:00:23Z,vivbak
e7142ce49d260ba2207bb63a524e2ff6e749e7f3,Vlad Savelyev,vladislav.sav@gmail.com,"Add comment about spanning del, fix `AS_SB_TABLE` parsing, fix overwriting (#47)

* Add comment about spanning deletions when filtering mt_to_vcf.py:_filter_rows_and_add_tags

* Fix parsing AS_SB_TABLE: keep empty fields as NA to allow subsetting with a_index downstream

* Make_finalised_mt.py: overwrite existing mt

* Update scripts/make_finalised_mt.py

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>",2021-06-16T08:26:58Z,vladsavelyev
8adf6e5b3c45eae874f997803da401e0d4b29fe1,Vlad Savelyev,vladislav.sav@gmail.com,"Refactor mt_to_vcf (#46)

* Refactor mt_to_vcf. No need to make site-only mt as export_vcf supports ht (see https://github.com/broadinstitute/gnomad_methods/pull/365/commits/57ac5e4d709570140a36f05d50b513b47a1dd0e4)

* Bump version: 0.2.11 → 0.2.12

* Replace ht_to_vcf_mt with adjust_vcf_incompatible_types in generate_info_ht.py",2021-06-07T07:18:25Z,vladsavelyev
f72d24d612700099fea427da9a2087d6fddc0fbd,Vlad Savelyev,vladislav.sav@gmail.com,Fix combining with existing table (mts need to be keyed by locus only) (#45),2021-06-06T22:50:43Z,vladsavelyev
e78215e910ce553cbc5ac58062332be83b405af9,Vlad Savelyev,vladislav.sav@gmail.com,"Write metadata to new metadata buckets (#44)

* Drop repartitioning. See https://hail.zulipchat.com/\#narrow/stream/123010-Hail-0.2E2.20support/topic/repartition.20issue

* Write meta.tsv into the metadata bucket

* Metadata bucket fix

* gs://cpg-tob-wgs-main-metadata is not readable with test

* Fix overwrite subset_noalt

* Overwrite mt_to_vcf

* Revert ""Drop repartitioning. See https://hail.zulipchat.com/\#narrow/stream/123010-Hail-0.2E2.20support/topic/repartition.20issue""

This reverts commit c38634bfe44bdc5a507cbb176fa21ae2e71b3f42.

* Drop parsing AS_SB_TABLE. See problem https://hail.zulipchat.com/\#narrow/stream/123010-Hail-0.2E2.20support/topic/repartition.20issue

* Exclude recidual filters from frequencies calculation

* Drop cutoffs from readme as they are described in a separate file

* Add filter for parsing AS_SB_TABLE (see https://hail.zulipchat.com/\#narrow/stream/123010-Hail-0.2E2.20support/topic/repartition.20issue)

* Add input_meta_ht fields into the meta.ht

* Bump version: 0.2.7 → 0.2.8

* Fix

* Bump version: 0.2.8 → 0.2.9

* Avoid duplicated fields

* Bump version: 0.2.9 → 0.2.10

* Write relatedness metadata

* Bump version: 0.2.10 → 0.2.11

* Rename suffix to namespace. Use web bucket for plots

* Fix readme",2021-06-05T07:19:14Z,vladsavelyev
023396fb1f198ff5d9ed9ae35cabfab142f7c5a2,Leonhard Gruenschloss,leonhard.gruenschloss@populationgenomics.org.au,"Adapt upload processor to new metadata buckets (#43)

* Adapt upload processor to new metadata buckets

* Remove unused var

* Simplify",2021-06-03T02:09:08Z,lgruen
0a44f640e136f1d5661c64907f333c37ef06bc77,Vlad Savelyev,vladislav.sav@gmail.com,"Be explicit about the number of partitions. Make --scatter-count required (#42)

* Be explicit about the number of partitions used. Make --scatter-count argument required

* Bump version: 0.2.5 → 0.2.6

* Consistent n-partitions

* Add comment why densify mt for frequencies calculation

* Fix click type

* Fix singleton number

* Bump version: 0.2.6 → 0.2.7",2021-06-01T10:25:07Z,vladsavelyev
b7ccdd98a6d971846923e1fa07cdbbe652b535f0,Vlad Savelyev,vladislav.sav@gmail.com,More fix bucket suffixes (#41),2021-06-01T05:58:05Z,vladsavelyev
ebb2930da92895a5faf9aeb335da3ab6e7eb440d,Vlad Savelyev,vladislav.sav@gmail.com,Update bucket pointers following the new policies. Write meta tsv to main. (#40),2021-06-01T05:25:39Z,vladsavelyev
43ec16dd08c4beb130766aecc92282d16287dd6b,Vlad Savelyev,vladislav.sav@gmail.com,"Add option to set the number of workers for dataproc (#39)

* Bump version: 0.2.4 → 0.2.5

* Limit the worker number

* Add option to override the scatter count

* Fix",2021-05-31T15:34:47Z,vladsavelyev
aafceef64ebca61ab5ef3e5cfb4da2b433ae43d1,Vlad Savelyev,vladislav.sav@gmail.com,Start counting batch from 1 (#38),2021-05-31T06:59:46Z,vladsavelyev
808159acf0aaab50bc269d40efee75220b088d3e,Vlad Savelyev,vladislav.sav@gmail.com,"Disable trios, make tests pass (#37)

* Bump version: 0.2.1 → 0.2.2

* Fix making qc ht when metadata not available

* Slight refactor initializing batch chunk

* Make ped data optional

* Bump version: 0.2.2 → 0.2.3

* VQSR: filter INFO/SB field out broken by GATK recalibration process

* Give batch more descriptive name

* Add picard qc metrics into the metadata

* SplitIntervals: use INTERVAL_SUBDIVISION to make sure predictable interval number is created

* Drop vep

* Tabix VCF after bcftools annotate -x INFO/SB

* Bump version: 0.2.3 → 0.2.4

* Fix

* Fix

* Fix

* Tmp reuse VQSR

* Revert

* Update joint_calling/vqsr.py

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>",2021-05-31T06:49:33Z,vladsavelyev
6cf41552b743f5aaa53e6ef59293058c8857435b,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Generalise processor (#33)

* Rename file

* Generalise upload processor
* Generates list of files to be moved based off CSV file

* Add comment

* Fix quotes

* Remove hard-coded project

* Remove unnecessary input variable

* Add batch variable

* TEMP path change for testing

* Fix duplicate variable
* Batch in the context of hail vs batch in the context of a subdirectory within GCP

* Fix variable

* Catch failed batch

* move csv file after successful batch

* TEMP add batch for testing

* Fix csv file path

* Create job to move csv

* Add docker image and key

* modify gsa key input

* TEMP update batch number

* Add csv job as dependency, remove sep batch

* Fix typo depends --> depends_on

* Collect jobs before passing to depends_on

* Add image + gsa key

* Remove testing artefacts

* Remove outdated function, add comments

* Add execution

* Handle CSV file
* Considers previous batch CSV so that only new files are moved

* Update function name

* TEMP path change for test

* Remove temp paths

* Update comments

* Fix comment

* WIP Use GCS Client Library

* WIP Fix Path

* Fix type error

* WIP Fix Path

* WIP Fix Path

* WIP Fix Variable Duplication Error

* WIP Fix Path

* WIP Fix Path

* WIP Fix Path

* WIP Fix Path

* WIP Fix Path

* WIP modify samples_from_csv - path fix

* WIP Fix Variable

* WIP Fix .csv find

* Add comments + clean up

* WIP Add click argument

* Remove testing artifacts

* Replace subprocess, remove command line arg

* Update comment

* Update scripts/process_uploads.py

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

* Remove hl.init

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>",2021-05-31T00:40:53Z,vivbak
4c1d1355de44653bc3547f6fdeca65dfd495f160,Vlad Savelyev,vladislav.sav@gmail.com,"VQSR: filter INFO/SB field out broken by GATK (#36)

* VQSR: filter INFO/SB field out broken by GATK recalibration process

* Add comment",2021-05-30T16:03:02Z,vladsavelyev
c42e966d17a67dffebb24125e32fbe64dc3a7e02,Vlad Savelyev,vladislav.sav@gmail.com,"Extract `create_rf_annotations.py` from `random_forest.py` (#35)

* Run create_rf_annotations for VQSR export (as create_score_bins depends on those annotations)

* Add overwrite param

* Bump version: 0.2.0 → 0.2.1

* Fix job dependencies

* Add adj fam stats

* Rerun generate_variant_qc_annotations.py if fam stats missing

* Fix create_rf_annotations.py

* Rename job for clarify",2021-05-25T08:20:22Z,vladsavelyev
65cf09cf1cb18a504f36169592dc677c13b197f9,Vlad Savelyev,vladislav.sav@gmail.com,"Support run to test. Fix filtering cutoffs. Fix exporting VQSR to Hail. (#34)

* Fix passing the thresholds file

* Bump version: 0.1.94 → 0.1.95

* Makefile: add rules

* Bump version: 0.1.95 → 0.2.0

* Fix

* Fix2

* Fix

* Remove Gnarly (breaks the SB INFO field in VCF)

* Clean up

* Remove ac_raw filter (works for RF only)

* Add ac_raw to fix vqsr post-annotation. Update from gnomad_qc

* Fixes

* Fix

* Rename metrics to reflect pct vs rate; Add dup rate

* Support writing to test bucket. Fix Makefile.

* Add more workers for heavy steps

* Add signleton field

* Check if score_bin_agg_ht_path exists

* Fix

* Add ac_qc_samples_unrelated_raw",2021-05-24T22:12:27Z,vladsavelyev
4cca72684f6473d8d6d1ba73d7bdea709e79ea1a,Vlad Savelyev,vladislav.sav@gmail.com,Add batch workflow,2021-05-21T00:15:06Z,vladsavelyev
c40803a19f01d251aa27901e06261dc800c2e53c,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,Update docker image (#32),2021-05-13T12:40:42Z,vivbak
189ef35b369a5587a9776604bdc5d5e4bc901318,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Add service backend (#31)

* Add service backend

* Adjust comment

* Update scripts/process_tob_wgs.py

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>",2021-05-13T12:13:30Z,vivbak
977dbc22d8f93cd2dfd1ea41a58b4d134fa28f4f,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Initialise Hail (#30)

* Initialise Hail

* Update scripts/process_tob_wgs.py

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>",2021-05-13T11:55:10Z,vivbak
bbb72aba4855e571ba11d897e61e5bf03569e5f2,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,fix file path (#29),2021-05-13T10:24:02Z,vivbak
2f58ee4c19b79199b1dd8a226c77a400faa0c734,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,Add shebang (#27),2021-05-13T08:52:10Z,vivbak
0ba7b5d2e6400cf1ac51284dfd5d2f797f0cf542,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Run upload processor on TOB-WGS uploads (#26)

* Run upload processor on TOB-WGS uploads

* Fix archive path and file read

* combine main and archive batches

* fix file paths",2021-05-13T07:23:35Z,vivbak
3103295264dde38839b362a462503114b9c62439,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Move Files (#20)

* Add copy and delete function
* Created function to copy files from one GCS bucket to another, when given a list of file names
* Created function to delete files from a specified GCS bucket, when given a list of file names
* Includes basic test file
* Functions validate action before returning a boolean to indicate failure or success.

* Minor change to text

* Fix formatting, quotes, imports, etc.

* Fix imports and docstrings

* Update test_copy to test invalid input

* Modify delete function to check crc32c
* Delete function modified to match copy function
* Checks crc32c to match objects rather than simply a name match.
* Updated comments to add more depth
* Fixed bug in test_delete function which passed variable that wasn't used

* Edit comments for further clarity

* Fix typo

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

* Fix comment

* Update delete and copy functions
* Removed quadratic check for samples, replaced with try - except
* Checks crc32c before copying files
* Updated type hints
* Returned two lists rather than a boolean true or false
* Updated comments

* Create move_files function
* Handles several cases including previous failures or outdated copies

* Add path param + incl. rename blob
* Copy and delete blob functions replaced by rename_blob which performs the move

* Removed copy and delete

* Add move test. Remove copy and delete test

* Add comments

* Create batch move function
* Standard case implemented.
* Case handling, testing and validation to come

* Update move batch function
* Passes batch in as input, rather than generating in function
* Handles case where a previous run was terminated early
* Added a multi-threaded move

* Add upload_sink return value

* Add image parameter

* Remove service backend dependency
* Previously, the move function relied on the hail batch service backend.
* Now, a sa-key can optionally be provided, which removes this dependency.
* The option to use the service backend still exists

* Remove source job and update path
* Remove source job and return list of jobs instead
* Use os.path.join rather than + to create paths

* Remove outdated move function

* WIP Update tests for batch
* Update test suite for compatibility with new move function
* Includes an upload function to create dummy files to be used in subsequent tests
* Standard move test, valid files to valid address.
* Recovery test, considers files that were moved in previous successful run
* Invalid test run, invalid ID's.

* Add partial recovery test and refactor
* Added test case for partial recover scenario
* Created validate move function to assist with refactoring code
* Replaced concat with os.path.join

* Add clean up function

* Handle FileNotFound
* Prior to running the batch, in the case of an invalid file, the program will raise an error and exit

* Add comments

* Fix comments, re-name param

* Adjust comment

* Fix typo

* Update comment

* Update comment

* Remove path param, update bucket param
* Takes in a path rather than a bucket
* This change makes the function more versatile + removes the need for the additional batch_path param as this can be included within the path provided for the destination

* Update env variable
* Updated KEY environment variable to make it more descriptive

* Update comment

* Restructure case handling to add clarity

* Restructure case handling to add clarity

* Make docker_image optional
* Allows for no docker image to be provided, using default

* Enable cleanup

* Implement assertRaises FileNotFoundError

* Add comment

* Apply suggestions from code review

* Fix comments 
* Fix style and clean up code

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

* Optional type added

* Remove unneeded -m flag

* Add quotations to handle file names with spaces

* Add absolute path for key

* Update paths

* Shorten comment

* Implement tearDown method

* Remove cleanUp function

* Check batch successfully run

* Perform checks during execution
* Rather than performing a gsutil stat check before creating a job, this check is performed as part of executing the job now.
* Updated test file to catch a CalledProcessError to accommodate for change
* Removed unnecessary try-except's while running batch

* Add shebang

* Update file locations for testing

* Remove __name__ condition

* Update joint_calling/upload_processor.py

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

* Fix line length

* Fix Typo

* Fix cwd

* Fix URL

* Add timestamp

* Update URL

* Add comment

* Update comment

* Update project

* Update comment

* Add missing quote

* Update repo

* Update module call

* Remove subdirectory

* Bring back subdirectory

* pass script params as list

* add unittest

* WIP test docker image

* Update comment

* Apply suggestions from code review

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

* Add main

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>",2021-04-28T00:52:02Z,vivbak
67646e53b1ddaf502b99f2c1229eb7ac5a9dad71,Vlad Savelyev,vladislav.sav@gmail.com,"CI refactoring (#21)

* CI: build pkg on push. Clean up old. Rename to joint-calling. Separate lint wfl

* Remove hail pin

* Fix .bumpversion.cfg

* Gitignore .vscode",2021-03-26T03:36:47Z,vladsavelyev
4f8e41d36b58640f06e4465a95b67c01244f414d,Michael Franklin,michael@illusional.net,"Add framework for VQSR (#8)

* Add initial skeleton based entirely on ukbb-200k framework

* Add testing code

* ADd testing code

* Update VQSR WDL -> Janis conversion

* Minor improvements to VQSR workflows

* Update VQSR workflows

* Add temp folders to .gitignore

* Minor improvements to FileSize parsing

* Update VQSR janis workflow with minor examples

* Tabix and defaukt parameters

* Fixes to vqsr - WIP

* Fir MODEL_REPORT

* Drop model_report and dynamic mem inputs

* Fix scatters

* WIP

* Fix resource groups

* Version that submits

* Fixes and add SplitIntervals

* Review recalibration parameters. Fix intervals. Review mem/cpu/disk resources. Add collect metrics.

* Batch wfl clean up

* Replace CollectVariantCallingMetrics with VariantEval

* Output recalibrator rscript files

* Remove the patch

* mt_to_vcf: fixes and add click

* Rename variant_qc.py -> mt_to_vcf.py

* Downgrade GATK to 4.1.4.0 to avoid NullPointerException

* Fix & use separate image for Gnarly

* Return job objects rather than outputs

* Fix

* Move mt_to_vcf.py

* Fix linting for scripts/mt_to_vcf.py

* Fix linting for workflows/vqsr_batch.py (WIP)

* Add docstrings

* Fix

* Write Rscripts

* Fix mypy linting. Set defautls for disk sizes

* Fix and add test_batch.sh

* Trailing whitespace

Co-authored-by: vladsaveliev <vladislav.savelyev@populationgenomics.org.au>
Co-authored-by: Vlad Savelyev <vladislav.sav@gmail.com>",2021-03-22T09:04:17Z,illusional
0299da75a09b05d17197400d8a9a5d029005ae2e,Vlad Savelyev,vladislav.sav@gmail.com,"Add filter-callrate (#19)

* Add filter-callrate

* Add mypy for static analysis and fix types

* Add comment about mypy",2021-03-12T04:10:25Z,vladsavelyev
e5670fd82f1d98dcae7ae4b10a018e2d61df0269,Vlad Savelyev,vladislav.sav@gmail.com,Rename to joint-calling (#18),2021-03-10T10:06:04Z,vladsavelyev
1d60085d5d9daf68f5f7fab101c7179ec9d7a010,Vlad Savelyev,vladislav.sav@gmail.com,"Update usage with dataproc in README. Fix typos. Reuse in combiner. (#15)

* Use --packages parameter to add deps to dataproc

* Allow reusing the mt and regenerating the metadata

* Snakefile: remove ReblockGVCF and subset to toy

* Fixing minor typos (#16)

* typos

* split line to satisfy linter

* Update readme

Co-authored-by: Peter Diakumis <peterdiakumis@gmail.com>",2021-03-10T07:44:04Z,vladsavelyev
e565490852623b89b1e19a53359e1923fb7cde5b,Vivian Bakiris,79084890+vivbak@users.noreply.github.com,"Update git clone (#12)

Update git clone step to reflect changes to repo name",2021-03-03T07:30:53Z,vivbak
a313d6e71adcf151da7e5c0be27e0149abb8490d,Vlad Savelyev,vladislav.sav@gmail.com,"Combiner: support extending (#5)

* Test data: move sample maps to a separate folder

* Add iterative combiner

* Add --target-bed option to support exomes

* Gitignore test data

* Update README (iterative combiner)

* Clean up environment and conda packages

* Clean up test data

* Update test scripts

* Update test data generation Snakefile

* Add bumpversion to env

* Generating test data: add a rule to generate one on GCS

* Add PED files for each test project separately

* Fix python shebang

* Update Snakefile to generate custom test datasets

* Removed test data ped files (pulled from fewgenomes)

* Sripts: add .py ext, lint

* Add missing dev dependencies

* Example how to submit script to dataproc

* Fix conda package tests

* Linting: install with pip

* Add standard combiner for first iterative round

* Disable combiner in chunks and add service backend

* Update .markdownlint.json

* install conda dependencies first (#7)

* Add billing_project option. Change f_stat_cutoff cutoff back to 0.5

* Add dockerfile

* Update readme

* Sex check: using default thresholds

* Use csv module to write sample maps

* Add hail blogpost

* Remove hail_init_service

* Update test scripts to use dataproc

Co-authored-by: Peter Diakumis <peterdiakumis@gmail.com>",2021-03-03T03:45:49Z,vladsavelyev
6b20caa3a5fbe1d374133ecd496b56765fd26adf,Vlad Savelyev,vladislav.sav@gmail.com,"Add linting & refactor (#4)

* Add linting and refactor code

* Temporarily disable tests

* Linting all files

* Add dependencies to environment-dev.yml

* Add channels to environment-dev.yml

* Disable the CI

* Linting: disable import checks

* Pylint: exclude unsubscriptable-object

* CI on tags only",2021-02-03T05:31:27Z,vladsavelyev
5d359e341b699a222363432a6971925c1c32df70,Vlad Savelyev,vladislav.sav@gmail.com,"Add sample QC, CI, tests (#3)

* Clean up the script. Add WDL skeleton

* Workflow: use .mt/_SUCCESS files as checkpoints

* Add sex QC, resources.BUCKET, constants

* Gitignore .idea

* Workflow: add local backend

* requirements: point to git gnomad_methods, add click

* Gitignore DS_Store

* Sample QC WIP: add sex imputation and hard filters

* Sample QC WIP: hard filter fixes

* Sample QC WIP: add safe_mkdir, cache gs_cache_file

* Sample QC WIP: fixes to hard filters

* Add compute_qc_mt and run_pc_relate

* Add pop-stratified QC. Refactoring.

* Add SampleQC.wdl. Add 3 more samples to test input

* Refactoring and clean up

* Add tests, package and CI

* Update README

* Remove cpg_qc/resources.py

* Clean up env and package

* CI: add gcloud setup

* CI: pin Miniconda version. Use cpg conda channel.

* Conda package: use original fork of gnomad_methods

* Linting: fix long lines

* Separate a combine_gvcfs script

* Validate command line arguments

* Skip validating optional arguments if missing

* Add docstrings. Use checkpoints everywhere. Remove path maps.

* Refactoring: simplify workflow

* Pin python version

* Requirements: use gnomad_methods gnomad fork

* Rename cpg_qc to sample_qc. Update tests

* Update cpg_qc/hard_filtering.py

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

* Conda and CI fixes. Add gnomad and gsutil pkgs

* Clean up checkpoints

* Add separate tests for combine and sample-qc

* Conda pkg: add versionpy, and fsspec and gcsfs for GCS reading

* combine_gvcfs generates a ht, and sample_qc takes a ht instead of a csv file

* Add hail and asyncinit conda recipies

* Tests: add gvcfs and picard files, and data generation Snakefile

* Un-ignore test data

* Update test scripts

* CI: do no need GCP

* Use bumpversion instead of versionpy

* Fix bumpversion cfg

* Bumpversion: commit and tag

* Remove git tag from _version.p

* Bump version: 0.1.1 → 0.1.2

* Drop versionpy

* Update README.md

Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>

* Get rid of a hail warning

* Move gnomad_qc.md into a docs subfolder

* Clarify assign_pops docstring

* Overwrite in test scripts

* Fix CI

* Snakemake to make test data: make picard files and csv

* Rename conda package with dash

* CI: install into a test env

* CI: install GCS connector

* Fix test csv

* CI: use miniconda action. Build for macos

* Fix CI

Co-authored-by: vladsaveliev-eviltwin <vladislav.sav-eviltwin@gmail.com>
Co-authored-by: Leonhard Gruenschloss <leonhard.gruenschloss@populationgenomics.org.au>",2021-01-11T07:45:32Z,vladsavelyev
942db7fd454d341441a5b9151acc2a3d9b9514dd,vladsaveliev,vladislav.sav@gmail.com,Add QC summary,2020-11-09T07:00:23Z,vladsavelyev
39dd6574be83eada98f9951ee5c6f5bb74b0ed09,vladsaveliev,vladislav.sav@gmail.com,Document inputs/outputs in gnomAD QC scripts,2020-11-08T23:13:03Z,vladsavelyev
aa19affab1ee9aabe262eb8fe8cb6bffdd0f9928,vladsaveliev,vladislav.sav@gmail.com,Document QC inputs,2020-10-30T02:09:03Z,vladsavelyev
42e67fbae0ff16ec8e76055fa68ed26653eba4ad,vladsaveliev,vladislav.sav@gmail.com,"Initial skeleton: loading VCF, making .mt and notifying in Slack",2020-10-23T02:52:48Z,vladsavelyev
b95d760bf1fb69bcc7627cb11eb773d4cd136c6f,Vlad Savelyev,vladislav.sav@gmail.com,Initial commit,2020-10-22T10:28:13Z,vladsavelyev
