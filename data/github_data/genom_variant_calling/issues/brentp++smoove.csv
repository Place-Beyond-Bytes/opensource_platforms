id,title,state,created_at,updated_at,closed_at,body,user,url
MDU6SXNzdWUyOTIyNzc2MDE=,move exclude from lumpy into lumpy-smoother,CLOSED,2018-01-29T03:55:47Z,2018-01-29T04:33:08Z,2018-01-29T04:33:08Z,"presumably, lumpy checking every alignment to see if it falls in an exclude region from the BED file is moderately expensive.

this can instead be done in lumpy-smoother in the depth-filter section where we already are using an interval tree to filter and where it can be done in parallel.",brentp,https://github.com/brentp/smoove/issues/2
MDU6SXNzdWUyOTIyODI0MTY=,filter on  mapping quality in lumpy-smoother,CLOSED,2018-01-29T04:37:37Z,2018-01-29T04:59:43Z,2018-01-29T04:59:43Z,we can do this in lumpy-smoother in parallel to send less work to single-threaded lumpy.,brentp,https://github.com/brentp/smoove/issues/3
MDU6SXNzdWUyOTI0MjQ5Nzg=,remove orphaned reads,CLOSED,2018-01-29T14:24:26Z,2018-01-30T03:54:55Z,2018-01-30T03:54:55Z,after applying all previous filters there will be orphaned reads. make an additional pass to remove these.,brentp,https://github.com/brentp/smoove/issues/4
MDU6SXNzdWUyOTMyMDA0MDk=,depth-based genotyping,CLOSED,2018-01-31T15:29:25Z,2019-10-04T22:20:27Z,2019-10-04T22:20:27Z,"cnvnator has a genotyping script. we should use this for CNVs without a splitter or discordant signal.

here's how svtools does this:
https://github.com/hall-lab/svtools/blob/master/svtools/copynumber.py",brentp,https://github.com/brentp/smoove/issues/5
MDU6SXNzdWUyOTQ1NDA0MDA=,sort cnvnator output,CLOSED,2018-02-05T21:00:09Z,2018-03-09T17:22:43Z,2018-03-09T17:22:43Z,@ryanlayer says it must be sorted.,brentp,https://github.com/brentp/smoove/issues/6
MDU6SXNzdWUyOTUzODMwOTI=,split fasta chromosome names on space,CLOSED,2018-02-08T04:37:56Z,2018-03-28T17:51:33Z,2018-03-28T17:51:33Z,,brentp,https://github.com/brentp/smoove/issues/7
MDU6SXNzdWUyOTk0MTU3ODM=,exclude any mates that overlap by $n bases,CLOSED,2018-02-22T16:18:44Z,2018-03-21T16:07:02Z,2018-03-21T16:07:02Z,"matches lumpy's min-non-overlap. for both splitters and discordants. 

check exactly what min-non-overlap does.",brentp,https://github.com/brentp/smoove/issues/8
MDU6SXNzdWUzMDQyNzA5NDQ=,bash: line 1:  2758 Broken pipe             gsort /dev/stdi,CLOSED,2018-03-12T07:56:50Z,2018-03-13T15:11:30Z,2018-03-13T12:58:39Z,"This tool looks interesting. Unfortunately I have got a broken pipe here. Any ideas? 

cheers


```
smoove call --name my-cohort --fasta mm10.fa -p 24 --genotype 2018/*.bam


smoove
smoove version: 0.1.1

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools [only required for CRAM input]

  [ ] cnvnator [per-sample CNV calls]
  [Y] mosdepth [extra filtering of split and discordant files for better scaling]
  [Y] svtyper [required to genotype SV calls]
  [ ] only needed for large cohorts.

Available sub-commands are below. Each can be run with -h for additional help.

call     : call lumpy (and optionally svtyper) after filtering bams
cnvnator : call cnvnator and make bedpe files needed by lumpy
genotype : parallelize svtyper on an input VCF
merge    : merge and sort (using svtools) calls from multiple samples



chr1    3499500 10_1    N       N]chr1:3502382] 803.17  .       SVTYPE=BND;STRANDS=++:28;IMPRECISE;CIPOS=-30,493;CIEND=-30,440;CIPOS95=0,65;CIEND95=-6,49;MATEID=10_2;EVENT=10;SU=28;PE=28;SR=0;PRPOS=2.70159e-114,1.46202e-110,7.912e-107,4.28173e-103,2.31714e-99,1.25397e-95,6.78609e-92,3.67242e-88,1.9874e-84,1.07552e-80,5.8204e-77,3.14982e-73,1.70459e-69,9.22471e-66,4.99213e-62,2.70159e-58,1.46202e-54,7.912e-51,4.28173e-47,2.31714e-43,1.25397e-39,6.78609e-36,3.67242e-32,1.9874e-28,1.07552e-24,5.8204e-21,3.14982e-17,1.70459e-13,9.22471e-10,4.99213e-06,0.0270159,0.0268671,0.0264696,0.0260316,0.0255955,0.0251392,0.0246599,0.0242488,0.023836,0.0234309,0.0230691,0.0226806,0.0222766,0.0218454,0.0214265,0.0210461,0.0206284,0.0202198,0.0198055,0.0194162,0.0189595,0.0185523,0.0181619,0.0177404,0.0173078,0.0168982,0.016479,0.016064,0.0156542,0.015261,0.0148371,0.014441,0.0140658,0.0136267,0.0132059,0.0128246,0.0124325,0.0120775,0.0117239,0.011377,0.0110161,0.0106586,0.0103091,0.00995568,0.00959137,0.00925548,0.00890342,0.00857818,0.00825755,0.00794713,0.00764008,0.00732881,0.00702068,0.00673065,0.00643526,0.00615398,0.00587929,0.00560019,0.00532831,0.00506626,0.00480944,0.00456869,0.0043298,0.00410166,0.00388139,0.00367075,0.00347533,0.00328142,0.00309962,0.00292223,0.00275228,0.0025791,0.00242519,0.00227027,0.0021241,0.00198483,0.001854,0.00172882,0.00160979,0.00149507,0.00139487,0.00129264,0.00119918,0.00110738,0.00101756,0.000936398,0.00086104,0.000792708,0.000726921,0.000664278,0.000606374,0.000552343,0.000503382,0.000458068,0.000415701,0.000376475,0.000339617,0.000305637,0.000274844,0.000247198,0.000221861,0.000199165,0.000177372,0.000157974,0.000141232,0.000125699,0.000111399,9.85373e-05,8.70645e-05,7.66083e-05,6.78187e-05,5.93595e-05,5.20847e-05,4.55676e-05,3.96626e-05,3.45641e-05,2.99867e-05,2.59841e-05,2.23284e-05,1.93263e-05,1.67073e-05,1.43628e-05,1.22903e-05,1.05346e-05,8.96253e-06,7.6346e-06,6.4986e-06,5.4744e-06,4.60133e-06,3.87705e-06,3.24366e-06,2.70822e-06,2.25683e-06,1.8925e-06,1.57752e-06,1.30833e-06,1.08108e-06,8.96271e-07,7.3432e-07,6.02916e-07,4.97674e-07,4.09085e-07,3.34632e-07,2.71163e-07,2.21535e-07,1.80124e-07,1.45624e-07,1.17969e-07,9.4471e-08,7.58373e-08,6.09299e-08,4.91589e-08,3.90797e-08,3.11977e-08,2.4714e-08,1.94699e-08,1.5365e-08,1.2223e-08,9.60779e-09,7.51215e-09,5.86979e-09,4.58549e-09,3.5866e-09,2.79164e-09,2.15689e-09,1.65507e-09,1.28573e-09,9.88158e-10,7.57412e-10,5.81571e-10,4.4047e-10,3.34414e-10,2.52372e-10,1.91394e-10,1.44873e-10,1.09316e-10,8.23134e-11,6.21852e-11,4.65345e-11,3.44572e-11,2.59412e-11,1.94634e-11,1.44291e-11,1.07885e-11,8.0525e-12,5.89042e-12,4.30916e-12,3.17853e-12,2.35175e-12,1.71309e-12,1.25475e-12,9.19597e-13,6.59802e-13,4.79813e-13,3.47029e-13,2.49125e-13,1.80384e-13,1.31155e-13,9.55025e-14,6.82948e-14,4.88779e-14,3.53156e-14,2.52632e-14,1.79468e-14,1.27578e-14,9.05813e-15,6.3348e-15,4.46943e-15,3.18047e-15,2.21115e-15,1.5293e-15,1.07217e-15,7.56342e-16,5.30031e-16,3.67055e-16,2.55774e-16,1.77899e-16,1.23089e-16,8.5249e-17,5.84118e-17,3.97219e-17,2.76493e-17,1.91236e-17,1.30787e-17,8.8759e-18,6.00032e-18,4.09378e-18,2.78746e-18,1.88011e-18,1.29156e-18,8.77123e-19,5.96473e-19,4.04114e-19,2.70977e-19,1.8264e-19,1.21861e-19,8.20197e-20,5.47005e-20,3.67335e-20,2.45787e-20,1.64415e-20,1.12316e-20,7.57422e-21,5.08122e-21,3.32812e-21,2.12035e-21,1.39523e-21,9.13988e-22,5.89313e-22,3.84421e-22,2.50529e-22,1.61229e-22,1.04243e-22,6.77332e-23,4.44397e-23,2.87998e-23,1.864e-23,1.20721e-23,7.81875e-24,5.05281e-24,3.27369e-24,2.08861e-24,1.33695e-24,8.49138e-25,5.56715e-25,3.53268e-25,2.29337e-25,1.4481e-25,9.16542e-26,5.76367e-26,3.66592e-26,2.33962e-26,1.5041e-26,9.58166e-27,6.01159e-27,3.83888e-27,2.39269e-27,1.49849e-27,9.34062e-28,5.89613e-28,3.63813e-28,2.24041e-28,1.39429e-28,8.57417e-29,5.33821e-29,3.33541e-29,2.06218e-29,1.30687e-29,7.90124e-30,4.84726e-30,2.95614e-30,1.84175e-30,1.11221e-30,6.78982e-31,4.0479e-31,2.49917e-31,1.54855e-31,9.51268e-32,5.91251e-32,3.61051e-32,2.17973e-32,1.32788e-32,7.71139e-33,4.58227e-33,2.80185e-33,1.71461e-33,1.02039e-33,6.04231e-34,3.55505e-34,2.13246e-34,1.30972e-34,7.66151e-35,4.65575e-35,2.86602e-35,1.70858e-35,1.0097e-35,6.0321e-36,3.567e-36,2.1412e-36,1.27041e-36,7.77967e-37,4.7062e-37,2.85298e-37,1.68192e-37,9.84941e-38,5.70223e-38,3.41127e-38,1.99364e-38,1.21009e-38,6.75695e-39,4.05855e-39,2.40418e-39,1.40459e-39,7.77761e-40,4.58138e-40,2.64714e-40,1.56773e-40,9.37389e-41,5.32638e-41,2.98002e-41,1.73222e-41,9.70192e-42,5.51008e-42,3.22889e-42,1.89011e-42,1.03528e-42,5.8241e-43,3.3663e-43,1.9572e-43,1.11378e-43,6.29898e-44,3.56341e-44,1.94292e-44,1.10666e-44,6.70378e-45,3.92749e-45,2.24267e-45,1.22399e-45,6.45122e-46,3.40928e-46,1.94801e-46,1.14199e-46,6.05034e-47,3.39284e-47,1.96506e-47,1.07935e-47,6.11379e-48,3.41676e-48,1.96721e-48,1.10485e-48,6.29622e-49,3.40607e-49,1.92051e-49,1.05206e-49,5.75393e-50,2.77991e-50,1.55241e-50,8.60034e-51,4.69738e-51,2.54025e-51,1.37124e-51,7.53411e-52,4.30459e-52,2.19281e-52,1.16873e-52,6.02522e-53,3.26204e-53,1.69353e-53,9.17354e-54,4.62996e-54,2.43701e-54,1.25143e-54,6.89171e-55,3.6873e-55,2.02414e-55,1.04648e-55,5.94477e-56,3.02977e-56,1.62637e-56,8.70896e-57,4.90973e-57,2.97553e-57,1.50816e-57,8.02432e-58,4.20941e-58,2.18565e-58,1.13857e-58,6.06832e-59,2.99054e-59,1.59267e-59,8.35459e-60,3.80918e-60,1.94796e-60,1.0327e-60,4.80546e-61,2.75697e-61,1.2978e-61,6.96713e-62,3.47509e-62,1.66729e-62,9.29273e-63,4.52757e-63,2.38359e-63,1.20478e-63,6.54023e-64,2.94425e-64,1.52629e-64,8.03573e-65,3.83115e-65,1.72679e-65,8.27078e-66,4.52162e-66,1.75739e-66,8.60736e-67,3.64952e-67,1.631e-67,7.63064e-68,2.9823e-68,1.54076e-68,6.77978e-69,2.77773e-69,1.44071e-69,6.84503e-70,2.73053e-70,1.10171e-70,4.84263e-71,1.6907e-71,7.42761e-72,3.37494e-72,1.57597e-72,6.6578e-73,3.19639e-73,1.65667e-73,7.4782e-74,3.82449e-74,1.54125e-74,5.00027e-75,1.91676e-75,8.27232e-76,2.85997e-76,1.18907e-76,4.23783e-77,2.01108e-77,8.13915e-78,2.65897e-78,1.01583e-78,3.57505e-79,1.25144e-79,5.69484e-80,1.71414e-80,4.16864e-81,1.33078e-81,5.37647e-82,1.37037e-82,6.2516e-83,1.94264e-83,3.64449e-84,1.52038e-84,5.02664e-85,1.3682e-85,2.30661e-86,3.57336e-87,9.59131e-88,2.01688e-88,6.33426e-89,2.03271e-89,4.08016e-90,9.23883e-91,4.76595e-92,5.3842e-93,3.56941e-94,2.45476e-95,8.8035e-96,3.13466e-97;PREND=4.45834e-36,4.41788e-34,4.3783e-32,4.33623e-30,4.29391e-28,4.24877e-26,4.20477e-24,3.05892e-22,2.2245e-20,1.61766e-18,1.17627e-16,6.28403e-15,1.81533e-13,5.24051e-12,1.51224e-10,3.20896e-09,6.80511e-08,1.44289e-06,2.24996e-05,0.000102605,0.000252666,0.000621229,0.00152678,0.00374898,0.00676908,0.00898792,0.0119246,0.0158225,0.0209727,0.0277981,0.0368104,0.0358233,0.0348283,0.0338461,0.0328908,0.0319298,0.0309809,0.0300339,0.0291085,0.0281601,0.0272545,0.0263437,0.0254329,0.0245556,0.023688,0.0228339,0.0220011,0.0211732,0.0203614,0.0195778,0.0188067,0.0180354,0.0172848,0.0165653,0.0158621,0.0151778,0.0145079,0.0138473,0.0132001,0.0125749,0.0119684,0.0113737,0.0108046,0.0102432,0.00971361,0.00919891,0.00869377,0.00821732,0.00775369,0.00730278,0.00686538,0.00645562,0.00606171,0.00567947,0.00531849,0.0049725,0.00464347,0.00433003,0.00402928,0.00374985,0.00348041,0.00323139,0.00299021,0.0027678,0.00255398,0.00235725,0.00217045,0.00199829,0.00183326,0.00168068,0.00153764,0.00140525,0.00128378,0.00116977,0.00106399,0.000964716,0.000873784,0.00079125,0.000714981,0.000643893,0.00057938,0.00052004,0.000465579,0.000416318,0.000371812,0.000331451,0.000294822,0.0002618,0.000231736,0.000204779,0.00018083,0.000159322,0.000139951,0.000122726,0.000107434,9.38303e-05,8.17858e-05,7.12031e-05,6.18305e-05,5.35717e-05,4.62646e-05,3.99468e-05,3.43725e-05,2.94957e-05,2.52733e-05,2.16149e-05,1.84424e-05,1.57056e-05,1.33585e-05,1.13133e-05,9.55771e-06,8.0696e-06,6.79223e-06,5.70182e-06,4.78311e-06,4.00013e-06,3.33376e-06,2.77036e-06,2.30041e-06,1.90304e-06,1.57341e-06,1.29609e-06,1.06465e-06,8.74737e-07,7.15732e-07,5.84027e-07,4.75165e-07,3.85879e-07,3.12355e-07,2.51798e-07,2.03277e-07,1.64196e-07,1.31754e-07,1.05519e-07,8.40543e-08,6.7072e-08,5.33244e-08,4.22676e-08,3.34159e-08,2.64049e-08,2.07746e-08,1.63294e-08,1.2828e-08,1.00368e-08,7.84364e-09,6.1159e-09,4.74665e-09,3.68023e-09,2.85934e-09,2.20835e-09,1.70042e-09,1.3081e-09,1.00154e-09,7.64654e-10,5.83504e-10,4.45059e-10,3.37188e-10,2.55243e-10,1.92911e-10,1.45384e-10,1.09468e-10,8.22507e-11,6.14436e-11,4.60103e-11,3.42652e-11,2.55185e-11,1.88973e-11,1.4011e-11,1.03581e-11,7.62938e-12,5.60471e-12,4.11141e-12,3.01175e-12,2.20371e-12,1.60818e-12,1.17081e-12,8.52383e-13,6.17941e-13,4.48153e-13,3.24963e-13,2.33773e-13,1.68601e-13,1.20912e-13,8.65785e-14,6.15664e-14,4.39551e-14,3.14304e-14,2.23873e-14,1.58975e-14,1.12896e-14,7.94128e-15,5.60483e-15,3.94439e-15,2.76595e-15,1.94235e-15,1.36476e-15,9.562e-16,6.66899e-16,4.65738e-16,3.23848e-16,2.24669e-16,1.55995e-16,1.07374e-16,7.43394e-17,5.11429e-17,3.49742e-17,2.40583e-17,1.6449e-17,1.11567e-17,7.58066e-18,5.13799e-18,3.48819e-18,2.36546e-18,1.60831e-18,1.08567e-18,7.31393e-19,4.91808e-19,3.29992e-19,2.21197e-19,1.48315e-19,9.96787e-20,6.68446e-20,4.44311e-20,2.95854e-20,1.9696e-20,1.29799e-20,8.61495e-21,5.67615e-21,3.78277e-21,2.49046e-21,1.64334e-21,1.07669e-21,7.10148e-22,4.63627e-22,3.04304e-22,1.97772e-22,1.29228e-22,8.40285e-23,5.44364e-23,3.55323e-23,2.3178e-23,1.49812e-23,9.59056e-24,6.15472e-24,3.97134e-24,2.55994e-24,1.64149e-24,1.04445e-24,6.66063e-25,4.2456e-25,2.67554e-25,1.70632e-25,1.08476e-25,6.87793e-26,4.34471e-26,2.76494e-26,1.73658e-26,1.08743e-26,6.87557e-27,4.29366e-27,2.69174e-27,1.68526e-27,1.05672e-27,6.56516e-28,4.10511e-28,2.54617e-28,1.58758e-28,9.83615e-29,6.10502e-29,3.78869e-29,2.35513e-29,1.45729e-29,8.95966e-30,5.54046e-30,3.39524e-30,2.08891e-30,1.28294e-30,7.90921e-31,4.84012e-31,2.9699e-31,1.81483e-31,1.10577e-31,6.72238e-32,4.09153e-32,2.50394e-32,1.52807e-32,9.18585e-33,5.54179e-33,3.3393e-33,2.02859e-33,1.21836e-33,7.32747e-34,4.39005e-34,2.61692e-34,1.56539e-34,9.41528e-35,5.63287e-35,3.33179e-35,1.98998e-35,1.1748e-35,6.96911e-36,4.13814e-36,2.44282e-36,1.45018e-36,8.66321e-37,5.14264e-37,3.02252e-37,1.78553e-37,1.05276e-37,6.16818e-38,3.61817e-38,2.16177e-38,1.26358e-38,7.38388e-39,4.28408e-39,2.45869e-39,1.43391e-39,8.43122e-40,4.96384e-40,2.87811e-40,1.67021e-40,9.5613e-41,5.49981e-41,3.1678e-41,1.80507e-41,1.04075e-41,5.95349e-42,3.43131e-42,1.99708e-42,1.15705e-42,6.53998e-43,3.75085e-43,2.10506e-43,1.18398e-43,6.88284e-44,3.94602e-44,2.2029e-44,1.23156e-44,6.94408e-45,3.87499e-45,2.19445e-45,1.25206e-45,7.08411e-46,3.92727e-46,2.16573e-46,1.1889e-46,6.63872e-47,3.67504e-47,2.05934e-47,1.11934e-47,6.25941e-48,3.39538e-48,1.86786e-48,1.01871e-48,5.48621e-49,2.95089e-49,1.61833e-49,8.74393e-50,4.94153e-50,2.76602e-50,1.51244e-50,8.30418e-51,4.55601e-51,2.50646e-51,1.37819e-51,7.60339e-52,4.12585e-52,2.2608e-52,1.23263e-52,6.57713e-53,3.55803e-53,1.87072e-53,1.01751e-53,5.29188e-54,2.86189e-54,1.54814e-54,7.976e-55,4.24675e-55,2.20381e-55,1.15012e-55,6.11432e-56,3.28796e-56,1.69132e-56,8.99595e-57,4.69e-57,2.49705e-57,1.30173e-57,6.81003e-58,3.46962e-58,1.76637e-58,9.07159e-59,4.6845e-59,2.35649e-59,1.18164e-59,5.93361e-60,3.10282e-60,1.59481e-60,7.93719e-61,4.06168e-61,1.9837e-61,1.0014e-61,4.65718e-62,2.34747e-62,1.13407e-62,5.75075e-63,2.8102e-63,1.39941e-63,6.45351e-64,2.92099e-64,1.4493e-64,6.7742e-65,3.34522e-65,1.55114e-65,7.65084e-66,3.36129e-66,1.70629e-66,7.66659e-67,3.61074e-67,1.6835e-67,8.38001e-68,3.67998e-68,1.7328e-68,8.20021e-69,3.52684e-69,1.51966e-69,7.02756e-70,2.98728e-70,1.29586e-70,5.71568e-71,2.58514e-71,1.07373e-71,4.63064e-72,1.97913e-72,7.45166e-73,2.89976e-73,1.12215e-73,4.63372e-74,1.6443e-74,5.84683e-75,2.35303e-75,8.15094e-76,2.96375e-76,1.16028e-76,4.0161e-77,1.19286e-77,3.65092e-78,1.13302e-78,3.26066e-79,1.02307e-79,3.61296e-80,8.93781e-81  GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB   0/1:83:248.79:-26,-1,-9:28:16:11:16:11:16:11:0:0:0:0.41 0/1:119:155.80:-18,-2,-14:29:20:8:20:8:20:8:0:0:0:0.29  0/1:200:398.58:-42,-2,-24:58:38:19:38:19:38:19:0:0:0:0.33       0/0:200:0.00:-0,-17,-55:56:56:0:55:0:34:0:0:21:0:0
chr1    3502382 10_2    N       N]chr1:3499500] 803.17  .       SVTYPE=BND;STRANDS=++:28;IMPRECISE;CIPOS=-30,440;CIEND=-30,493;CIPOS95=-6,49;CIEND95=0,65;MATEID=10_1;EVENT=10;SECONDARY;SU=28;PE=28;SR=0;PRPOS=4.45834e-36,4.41788e-34,4.3783e-32,4.33623e-30,4.29391e-28,4.24877e-26,4.20477e-24,3.05892e-22,2.2245e-20,1.61766e-18,1.17627e-16,6.28403e-15,1.81533e-13,5.24051e-12,1.51224e-10,3.20896e-09,6.80511e-08,1.44289e-06,2.24996e-05,0.000102605,0.000252666,0.000621229,0.00152678,0.00374898,0.00676908,0.00898792,0.0119246,0.0158225,0.0209727,0.0277981,0.0368104,0.0358233,0.0348283,0.0338461,0.0328908,0.0319298,0.0309809,0.0300339,0.0291085,0.0281601,0.0272545,0.0263437,0.0254329,0.0245556,0.023688,0.0228339,0.0220011,0.0211732,0.0203614,0.0195778,0.0188067,0.0180354,0.0172848,0.0165653,0.0158621,0.0151778,0.0145079,0.0138473,0.0132001,0.0125749,0.0119684,0.0113737,0.0108046,0.0102432,0.00971361,0.00919891,0.00869377,0.00821732,0.00775369,0.00730278,0.00686538,0.00645562,0.00606171,0.00567947,0.00531849,0.0049725,0.00464347,0.00433003,0.00402928,0.00374985,0.00348041,0.00323139,0.00299021,0.0027678,0.00255398,0.00235725,0.00217045,0.00199829,0.00183326,0.00168068,0.00153764,0.00140525,0.00128378,0.00116977,0.00106399,0.000964716,0.000873784,0.00079125,0.000714981,0.000643893,0.00057938,0.00052004,0.000465579,0.000416318,0.000371812,0.000331451,0.000294822,0.0002618,0.000231736,0.000204779,0.00018083,0.000159322,0.000139951,0.000122726,0.000107434,9.38303e-05,8.17858e-05,7.12031e-05,6.18305e-05,5.35717e-05,4.62646e-05,3.99468e-05,3.43725e-05,2.94957e-05,2.52733e-05,2.16149e-05,1.84424e-05,1.57056e-05,1.33585e-05,1.13133e-05,9.55771e-06,8.0696e-06,6.79223e-06,5.70182e-06,4.78311e-06,4.00013e-06,3.33376e-06,2.77036e-06,2.30041e-06,1.90304e-06,1.57341e-06,1.29609e-06,1.06465e-06,8.74737e-07,7.15732e-07,5.84027e-07,4.75165e-07,3.85879e-07,3.12355e-07,2.51798e-07,2.03277e-07,1.64196e-07,1.31754e-07,1.05519e-07,8.40543e-08,6.7072e-08,5.33244e-08,4.22676e-08,3.34159e-08,2.64049e-08,2.07746e-08,1.63294e-08,1.2828e-08,1.00368e-08,7.84364e-09,6.1159e-09,4.74665e-09,3.68023e-09,2.85934e-09,2.20835e-09,1.70042e-09,1.3081e-09,1.00154e-09,7.64654e-10,5.83504e-10,4.45059e-10,3.37188e-10,2.55243e-10,1.92911e-10,1.45384e-10,1.09468e-10,8.22507e-11,6.14436e-11,4.60103e-11,3.42652e-11,2.55185e-11,1.88973e-11,1.4011e-11,1.03581e-11,7.62938e-12,5.60471e-12,4.11141e-12,3.01175e-12,2.20371e-12,1.60818e-12,1.17081e-12,8.52383e-13,6.17941e-13,4.48153e-13,3.24963e-13,2.33773e-13,1.68601e-13,1.20912e-13,8.65785e-14,6.15664e-14,4.39551e-14,3.14304e-14,2.23873e-14,1.58975e-14,1.12896e-14,7.94128e-15,5.60483e-15,3.94439e-15,2.76595e-15,1.94235e-15,1.36476e-15,9.562e-16,6.66899e-16,4.65738e-16,3.23848e-16,2.24669e-16,1.55995e-16,1.07374e-16,7.43394e-17,5.11429e-17,3.49742e-17,2.40583e-17,1.6449e-17,1.11567e-17,7.58066e-18,5.13799e-18,3.48819e-18,2.36546e-18,1.60831e-18,1.08567e-18,7.31393e-19,4.91808e-19,3.29992e-19,2.21197e-19,1.48315e-19,9.96787e-20,6.68446e-20,4.44311e-20,2.95854e-20,1.9696e-20,1.29799e-20,8.61495e-21,5.67615e-21,3.78277e-21,2.49046e-21,1.64334e-21,1.07669e-21,7.10148e-22,4.63627e-22,3.04304e-22,1.97772e-22,1.29228e-22,8.40285e-23,5.44364e-23,3.55323e-23,2.3178e-23,1.49812e-23,9.59056e-24,6.15472e-24,3.97134e-24,2.55994e-24,1.64149e-24,1.04445e-24,6.66063e-25,4.2456e-25,2.67554e-25,1.70632e-25,1.08476e-25,6.87793e-26,4.34471e-26,2.76494e-26,1.73658e-26,1.08743e-26,6.87557e-27,4.29366e-27,2.69174e-27,1.68526e-27,1.05672e-27,6.56516e-28,4.10511e-28,2.54617e-28,1.58758e-28,9.83615e-29,6.10502e-29,3.78869e-29,2.35513e-29,1.45729e-29,8.95966e-30,5.54046e-30,3.39524e-30,2.08891e-30,1.28294e-30,7.90921e-31,4.84012e-31,2.9699e-31,1.81483e-31,1.10577e-31,6.72238e-32,4.09153e-32,2.50394e-32,1.52807e-32,9.18585e-33,5.54179e-33,3.3393e-33,2.02859e-33,1.21836e-33,7.32747e-34,4.39005e-34,2.61692e-34,1.56539e-34,9.41528e-35,5.63287e-35,3.33179e-35,1.98998e-35,1.1748e-35,6.96911e-36,4.13814e-36,2.44282e-36,1.45018e-36,8.66321e-37,5.14264e-37,3.02252e-37,1.78553e-37,1.05276e-37,6.16818e-38,3.61817e-38,2.16177e-38,1.26358e-38,7.38388e-39,4.28408e-39,2.45869e-39,1.43391e-39,8.43122e-40,4.96384e-40,2.87811e-40,1.67021e-40,9.5613e-41,5.49981e-41,3.1678e-41,1.80507e-41,1.04075e-41,5.95349e-42,3.43131e-42,1.99708e-42,1.15705e-42,6.53998e-43,3.75085e-43,2.10506e-43,1.18398e-43,6.88284e-44,3.94602e-44,2.2029e-44,1.23156e-44,6.94408e-45,3.87499e-45,2.19445e-45,1.25206e-45,7.08411e-46,3.92727e-46,2.16573e-46,1.1889e-46,6.63872e-47,3.67504e-47,2.05934e-47,1.11934e-47,6.25941e-48,3.39538e-48,1.86786e-48,1.01871e-48,5.48621e-49,2.95089e-49,1.61833e-49,8.74393e-50,4.94153e-50,2.76602e-50,1.51244e-50,8.30418e-51,4.55601e-51,2.50646e-51,1.37819e-51,7.60339e-52,4.12585e-52,2.2608e-52,1.23263e-52,6.57713e-53,3.55803e-53,1.87072e-53,1.01751e-53,5.29188e-54,2.86189e-54,1.54814e-54,7.976e-55,4.24675e-55,2.20381e-55,1.15012e-55,6.11432e-56,3.28796e-56,1.69132e-56,8.99595e-57,4.69e-57,2.49705e-57,1.30173e-57,6.81003e-58,3.46962e-58,1.76637e-58,9.07159e-59,4.6845e-59,2.35649e-59,1.18164e-59,5.93361e-60,3.10282e-60,1.59481e-60,7.93719e-61,4.06168e-61,1.9837e-61,1.0014e-61,4.65718e-62,2.34747e-62,1.13407e-62,5.75075e-63,2.8102e-63,1.39941e-63,6.45351e-64,2.92099e-64,1.4493e-64,6.7742e-65,3.34522e-65,1.55114e-65,7.65084e-66,3.36129e-66,1.70629e-66,7.66659e-67,3.61074e-67,1.6835e-67,8.38001e-68,3.67998e-68,1.7328e-68,8.20021e-69,3.52684e-69,1.51966e-69,7.02756e-70,2.98728e-70,1.29586e-70,5.71568e-71,2.58514e-71,1.07373e-71,4.63064e-72,1.97913e-72,7.45166e-73,2.89976e-73,1.12215e-73,4.63372e-74,1.6443e-74,5.84683e-75,2.35303e-75,8.15094e-76,2.96375e-76,1.16028e-76,4.0161e-77,1.19286e-77,3.65092e-78,1.13302e-78,3.26066e-79,1.02307e-79,3.61296e-80,8.93781e-81;PREND=2.70159e-114,1.46202e-110,7.912e-107,4.28173e-103,2.31714e-99,1.25397e-95,[smoove] 2018/03/11 22:22:40 bash: line 1:  2758 Broken pipe             gsort /dev/stdin /lager2/rcug/seqres/MM/mm10.fa.fai
      2759 Segmentation fault      (core dumped) | bcftools view -O z -c 1 -o my-cohort.genotyped.vcf.gz
[smoove] 2018/03/11 22:23:01 Reading library metrics from /working2/rcug/scratch/tmp/tempclean-664002246/647993002svtype-lib...
[smoove] 2018/03/11 22:23:01 Reading library metrics from /working2/rcug/scratch/tmp/tempclean-664002246/647993002svtype-lib...
[smoove] 2018/03/11 22:23:01 Reading library metrics from /working2/rcug/scratch/tmp/tempclean-664002246/647993002svtype-lib...
[smoove] 2018/03/11 22:23:01 Reading library metrics from /working2/rcug/scratch/tmp/tempclean-664002246/647993002svtype-lib...
[smoove] 2018/03/11 22:23:01  done
[smoove] 2018/03/11 22:23:02 Reading library metrics from /working2/rcug/scratch/tmp/tempclean-664002246/647993002svtype-lib...
[smoove] 2018/03/11 22:23:02 Reading library metrics from /working2/rcug/scratch/tmp/tempclean-664002246/647993002svtype-lib...
[smoove] 2018/03/11 22:23:02 Reading library metrics from /working2/rcug/scratch/tmp/tempclean-664002246/647993002svtype-lib...
[smoove] 2018/03/11 22:23:02 Reading library metrics from /working2/rcug/scratch/tmp/tempclean-664002246/647993002svtype-lib...
[smoove] 2018/03/11 22:23:02  done
[smoove] 2018/03/11 22:23:04 chr2       1000000
chr2    2000000
chr2    4000000
panic: write |1: broken pipe

goroutine 3451837 [running]:
github.com/brentp/smoove/svtyper.checkWrite(0x0, 0x9e84a0, 0xc596569560)
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:38 +0x4a
github.com/brentp/smoove/svtyper.Svtyper.func2(0xc509b4b740, 0xc4201be300, 0x4, 0x4, 0x7ffc40210697, 0x1e, 0xc4201b9130, 0xc4378701f8, 0xc437870220, 0xc4203fc1f8, ...)
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:185 +0xb9
created by github.com/brentp/smoove/svtyper.Svtyper
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:155 +0x5e5

```",colindaven,https://github.com/brentp/smoove/issues/10
MDU6SXNzdWUzMDQ0NzIyNTU=,ENH: annotation,CLOSED,2018-03-12T17:40:21Z,2018-10-10T02:07:39Z,2018-10-10T02:07:39Z,"a new sub-command `annotation`. [vcfanno](https://github.com/brentp/vcfanno) can be use to annotate with any BED/VCF files in a single command. 

`smoove` can use that and some custom lua and conf to make gene annotation useful and easy. This won't replace VEP/SnpEff, but can be a quick first-pass to see which genes / features are affected.

The annotation command will take a VCF (presumably from `smoove paste` or `smoove call` and a GFF (presumably from ensembl).

```
smoove annotation $gff $vcf | bgzip -c > $anno_vcf_gz
```

## Output

the output in the INFO field would look like: `smoove_gene=$gene_name|[$feature:$nfeatures:$nbases|...],[gene2|...` e.g.

`smoove_gene=BRCA1|exon:3:240|intron:2:555|5_prime_UTR:1:2,GENEX|exon:1:222...`


## Internals

This will call vcfanno. It will write a custom vcfanno conf file like:

```
[[annotation]]
file=""Homo_sapiens.GRCh37.82.gff3.gz""
names=[""smoove_gene""]
ops=[""lua:gff_overlap""]
columns=[1,3,4,5,9]
```

gff_overlap is TBD.

cc: @kmsteinberg",brentp,https://github.com/brentp/smoove/issues/11
MDU6SXNzdWUzMDkyNjg4NDQ=,lumpy.check pointing to incorrect location.,CLOSED,2018-03-28T08:32:26Z,2023-08-14T08:59:44Z,2018-03-29T13:13:45Z,"HI Brent,

I am getting this error while running smoove. I just downloaded latest binaries from https://github.com/brentp/smoove/releases  . Do you have any idea why I am getting below error ?  For some reason its directing towards some wrong location for lumpy.
$ smoove call -x --name QMD89 --exclude /gpfs/projects/bioinfo/najeeb/withKhalid/SVtoolsCompare/speedseq/PMC01/SV_Geno/ceph18.b37.lumpy.exclude.2014-01-15.bed --fasta hs37d5.fa -p 32 --genotype QMD-89/*.bam --outdir /SVAnalysis/smoove
[smoove] 2018/03/28 11:21:56 calculating bam stats for 6 bams
[smoove] 2018/03/28 11:22:00 done calculating bam stats
Usage: mosdepth [options] <BAM-or-CRAM>
rm: cannot remove ‘/tmp/smoove-mosdepth-902265688.quantized.bed.gz.csi’: No such file or directory
panic: exit status 1

goroutine 19069 [running]:
github.com/brentp/smoove/lumpy.check(0x9e74e0, 0xc421d5e080)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:50 +0x4a
github.com/brentp/smoove/lumpy.remove_sketchy(0xc420250a80, 0x5b, 0x3e8, 0x7fffed63d907, 0x47, 0x7fffed63d888, 0x76, 0xc42021c340, 0x4, 0x4, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:197 +0x13d9
github.com/brentp/smoove/lumpy.remove_sketchy_all.func1(0xc420195c20, 0x3e8, 0x7fffed63d907, 0x47, 0x7fffed63d888, 0x76, 0xc42021c340, 0x4, 0x4, 0x1, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:322 +0x144
created by github.com/brentp/smoove/lumpy.remove_sketchy_all
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:320 +0x163",snashraf,https://github.com/brentp/smoove/issues/13
MDU6SXNzdWUzMDkzODEyOTY=,tag not defined error in 0.1.3,CLOSED,2018-03-28T14:03:36Z,2018-03-29T17:23:01Z,2018-03-28T17:34:39Z,"Brent;
Thanks for the latest update. I've been working on getting smoove integrated with bcbio and running into an issue where it dies after finishing up calling and I'm not totally sure what is happening:
```
[smoove] 2018/03/28 12:34:40 Reading library metrics from /mnt/work/cwl/bcbio_validation_workflows/NA24385-sv/debug_smoove/tempclean-604417735/360058017svtype-lib...
[smoove] 2018/03/28 12:34:40  done
[smoove] 2018/03/28 12:47:26 The tag ""1"" is not defined in (null)
[smoove] 2018/03/28 12:47:26 wrote sorted, indexed file to /mnt/work/cwl/bcbio_validation_workflows/NA24385-sv/debug_smoove/NA24385-svs-smoove.genotyped.vcf.gz
panic: exit status 255

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(0x9e74e0, 0xc420194080)
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:32 +0x4a
github.com/brentp/smoove/svtyper.Svtyper(0x9e7000, 0xc42000e108, 0x7ffd9997f1cb, 0x5c, 0xc42011e590, 0x1, 0x1, 0x7ffd9997f244, 0x40, 0x7ffd9997f22f, ...)
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:209 +0xbc1
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:286 +0x3fb
main.main()
        /home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:106 +0x17f
```
`The tag ""1"" is not defined` error seems most diagnostic but I'm not sure what do do about it. I put together a reproducible test case here that demonstrates the problem for me:

https://s3.amazonaws.com/chapmanb/testcases/smoove_tagdefined.tar.gz

Thanks so much for any suggestions/tips to debug.",chapmanb,https://github.com/brentp/smoove/issues/14
MDU6SXNzdWUzMTA4ODE0OTU=,smoove germline validations with Genome in a Bottle NA24385,OPEN,2018-04-03T15:17:43Z,2018-04-10T13:52:05Z,,"Brent;
Thanks again for all the help getting smoove working. I've got a branch that includes it and have been running validations comparing to the lumpyexpress based approach using the Genome in a Bottle NA24385 germline callset. Here are my numbers so far:

https://github.com/bcbio/bcbio_validations/tree/master/NA24385_sv#smoove-validation

smoove does similar to the custom approach with lumpyexpress and svtyper we had in bcbio earlier so looks good from that perspective. I also compared against manta on this dataset and found that we're not as sensitive, especially on insertions. Relaxing comparisons to not require genotypes recovers a lot of insertion sensitivity, but adds a ton of false positives.

I wanted to sanity check if these results match your expectations and also brainstorm to see if we could improve sensitivity with svtyper. I'm psyched to have the improved specificity as it will make lumpy outputs much more useful for folks and want to keep iterating and improving on these now that we've got some automated tests in place. I'd also love to incorporate additional SV validation data, especially somatic calls, so if there are other truth sets you recommend and use.",chapmanb,https://github.com/brentp/smoove/issues/16
MDU6SXNzdWUzMTQyODc1MTk=,re-check support after genotyping,OPEN,2018-04-14T01:12:01Z,2018-04-14T01:12:01Z,,"lumpy gives ths SU of 5. svtyper gives it only 3 so it should be removed. This is the case for a lot of false positives.
```
1       865249  1       N       <INV>   41.89   .       SVTYPE=INV;SVLEN=230;END=865479;STRANDS=++:3,--:2;IMPRECISE;CIPOS=-89,59;CIEND=-34,29;CIPOS95=-59,30;CIEND95=-12,8;SU=5;PE=5;SR=0;AC=1;AN=2
     GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB   0/1:41:41.89:-6,-2,-10:17:13:3:13:3:0:0:0:13:3:0.19
```

this is probably related to the CI value.
",brentp,https://github.com/brentp/smoove/issues/17
MDU6SXNzdWUzMTU1ODQ5NzE=,Additional SV callers at merge step,OPEN,2018-04-18T18:05:19Z,2018-04-18T19:16:35Z,,"Hello there,

I just incorporated your tools into my SV calling pipeline and it is working great. I did run into a panic error that was a bit confusing, but just re-ran the pipeline and it worked fine. I saved the error then deleted it once the pipeline finished... sorry about that, if it comes up again I'll send it your way.

My question is regarding the merge step of the population calling pipeline. Can this step handle multiple SV callers? I am currently running Delly2, Manta, TIDDIT, and now smoove/LUMPY. My thought was to call sample variants with each of these callers, merge at the sample level to have one VCF per sample, then merge samples to generate a site list with smoove, then recall with smoove and Delly2 because these are the only ones with recall capabilities as far as I can tell. 

I am not sure if this will add anything to the smoove/LUMPY or Delly2 calls due to the differences in SV detection among the software packages, but I'm curious to know your thoughts on this prior to attempting to incorporating it into my pipeline.

Best,
Stefan

",Thatguy027,https://github.com/brentp/smoove/issues/18
MDU6SXNzdWUzMzgwNTU5MzI=,"lumpy_filter must be in default PATH, regardless of current env",CLOSED,2018-07-03T21:11:22Z,2019-04-11T20:11:13Z,2018-07-11T20:15:55Z,"I'm seeing an issue on macOS and REHL where `smoove call`, is not able to execute `lumpy_filter`  because it's missing from `PATH` in the shell env created by `shpool`. In these cases, I have `lumpy_filter` symlinked into a directory that I added to PATH in `.bash_profile`. `lumpy_filter` passes the `HasProg` check.

I've only had success after symlinking `lumpy_filter` into the current directory or into a location in the system-defined PATH. Changes to PATH exported in the current env or at login are not effective. 

The issue occurrs when the filter process is submitted to `shpool.Pool` and eventually executed. shpool runs each filter in a separate, non-interactive, non-login shell with an env of two k-v pairs ([shpool.go:L158-182](https://github.com/brentp/go-athenaeum/blob/master/shpool/shpool.go#L158-L182)). While those two k-v pairs are added via `p.c.Env = append(p.c.Env, fmt.Sprintf(""CPUs=%d"", p.p.CPUs))` , the initial `p.c.Env` is empty. Appending the k-v pairs to `p.c.Env` overrides the [default behavior](https://golang.org/pkg/os/exec/#Cmd) for Env, where Env is set to the Env of the parent process iff Env is nil.

I don't see shpool used elsewhere in smoove. Other `exec.Command(""bash"", ""-c"", cmd)` invocations don't seem to have a problem as they leave `Env` untouched.

Invocations like `exec.Command(""samtools"", ...)` work fine since the first arg is passed on to `exec.LookPath`, much like the checks done by `HasProg()`.

I've submitted a pull request that resolves lumpy_filter prior to submitting the process to the pool. 

Another approach may be modifying `shpool` to establish the default env (either the parent env at pool creation or per-process at process submission). This seems a bit more troublesome if `shpool` is being used in places that might be altering and responding to env variables.


---

### HasProg checks

```{bash}
$ smoove
smoove version: 0.1.10

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools [only required for CRAM input]

  [Y] mosdepth [extra filtering of split and discordant files for better scaling]
  [Y] svtyper [required to genotype SV calls]
  [Y] svtools [only needed for large cohorts].

...
```

### Can't find lumpy_filter
```{bash}
$ smoove call --name samp1 --fasta hg19.fa --outdir smoove_output input.bam
[smoove] 2018/07/03 17:10:40 starting with version 0.1.10
[smoove] 2018/07/03 17:10:40 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2018/07/03 17:10:40 /bin/bash: lumpy_filter: command not found
[smoove]:2018/07/03 17:10:40 finished process: lumpy-filter (lumpy_filter -f hg19.fa input.bam smoove_output/LP6005118-DNA_A10.split.bam.tmp.bam smoove_output/LP) in user-time:2.169ms system-time:4.477ms
[smoove]:2018/07/03 17:10:40 error running command: lumpy_filter -f hg19.fa input.bam smoove_output/LP6005118-DNA_A10.split.bam.tmp.bam smoove_output/LP6005118-DNA_A10.disc.bam.tmp.bam 2 && mv smoove_output/LP6005118-DNA_A10.split.bam.tmp.bam smoove_output/LP6005118-DNA_A10.split.bam && mv smoove_output/LP6005118-DNA_A10.disc.bam.tmp.bam smoove_output/LP6005118-DNA_A10.disc.bam -> exit status 127
[smoove] 2018/07/03 17:10:42 done calculating bam stats
panic: exit status 127

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.Lumpy(0x7ffeefbff8b3, 0x5, 0x7ffeefbff8c1, 0x7, 0x7ffeefbff8d2, 0xd, 0xc4200a74c0, 0x1, 0x1, 0xc420198140, ...)
	/Users/dave/local/go/src/github.com/brentp/smoove/lumpy/lumpy.go:115 +0x556
github.com/brentp/smoove/lumpy.Main()
	/Users/dave/local/go/src/github.com/brentp/smoove/lumpy/lumpy.go:275 +0x23a
main.main()
	/Users/dave/local/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:115 +0x1dd
```",dmckean,https://github.com/brentp/smoove/issues/19
MDU6SXNzdWUzNTA2MzI2ODU=,smoove output where SV END is < POS,CLOSED,2018-08-14T23:30:16Z,2018-08-15T19:51:29Z,2018-08-15T19:51:29Z,"There seem to be some occurrences of SVs (primarily DELs, I think) from smoove where the SV's END position is less than the POS position. This is causing downstream processing errors. 

Some examples:
```
1	1116265	3510	N	<DEL>	0	.	SVTYPE=DEL;SVLEN=7;END=1116258
1	46025127	23046	N	<DEL>	0	.	SVTYPE=DEL;SVLEN=5;END=46025122 
```",fakedrtom,https://github.com/brentp/smoove/issues/21
MDU6SXNzdWUzNTM5MjcxNTM=,fasta files input error,CLOSED,2018-08-24T21:04:13Z,2024-06-13T19:34:08Z,2018-08-27T14:59:16Z,"Hi
- I am guessing this error is somewhat trivial but I can't seem to work it out, I am running smoove call and getting and error ""panic: no fai for fasta""  during the ""writing sorted, indexed file to..."" stage.

I've checked to see if there is a labeling difference in the genome file prefix and bam file - I see that gsort ""will error if your genome file has 'chr' prefix and your file does not (or vice-versa)"" - and I don't think this is the issue, could you explain what this means in more detail? Any other suggestions?
Thanks
",zlye,https://github.com/brentp/smoove/issues/22
MDU6SXNzdWUzNTczMTI5NjM=,add z-score for depth on DEL/DUPs,CLOSED,2018-09-05T16:41:37Z,2018-09-26T15:14:26Z,2018-09-26T15:14:26Z,"This would require running mosdepth and getting mean/sd by chromosome.

This would add ~ 0.75 hours of CPU time (to run mosdepth) and would be used to post-filter or annotate after lumpy has run.",brentp,https://github.com/brentp/smoove/issues/23
MDU6SXNzdWUzNjczMTM1OTY=,smoove genotype with -d leaves an orphaned .csi,CLOSED,2018-10-05T18:07:04Z,2018-10-06T16:55:36Z,2018-10-06T16:55:36Z,this should be removed.,brentp,https://github.com/brentp/smoove/issues/24
MDU6SXNzdWUzNjc0NzE4NzM=,smoove does not remove splitters where the split is to an excluded chrom,CLOSED,2018-10-06T16:18:28Z,2018-10-06T23:28:53Z,2018-10-06T23:28:53Z,"this will remove more bad splitters to excluded chroms. 
use `shared.Contains(filter_chroms, SA[:SA.find("","")])`",brentp,https://github.com/brentp/smoove/issues/25
MDU6SXNzdWUzNjk2NDI4NTg=,smoove on tumor-normal pairs,CLOSED,2018-10-12T17:30:11Z,2021-04-12T05:33:05Z,2018-10-25T21:34:31Z,"Hi @brentp ,

Thanks for sharing this tool, and indeed makes things easier for using lumpy and related tools. I am using it to call SVs for canine genome. We have tumor-normal pairs on >40 cases. I am thinking of doing joint genotype if in set of 40 bams or so. However, we are primarily interested in somatic SVs and so, I am trying to make a workflow optimized to filter putative somatic SVs from final genotypes vcf. Here is something I can think of:

1. Joint genotype each of tumor-normal pair, and then merge resulting 40 genotyped vcfs to make final vcf with common variants, and then annotate those. Later, I can filter based on genotype in tumor and normal cases, and relevant INFO/FORMAT fields (SHQ, SR, SU, ...??) to identify potential somatic (vs germline) SVs.

or 

2. Joint genotype 40 normals together in first run, and 40 tumors in second run. Instead of merging two merged vcfs, I can intersect these two vcfs and also consider genotype calls in merged normal and tumor vcfs to identify potential somatic vs germline SVs.

or 

3. Alternate workflow design that you may suggest.

Thanks a lot,
Samir



",sbamin,https://github.com/brentp/smoove/issues/26
MDU6SXNzdWUzNjk2ODcyMjY=,smoove input,CLOSED,2018-10-12T19:45:40Z,2019-01-17T17:12:39Z,2019-01-17T17:12:39Z,I understand that smoove call command requires a 'path to bam' input where the .bai file is in the same folder. Is it possible to specify the bai file separately? (I am trying to use smoove as part of a nextflow pipeline),zlye,https://github.com/brentp/smoove/issues/27
MDU6SXNzdWUzNzAzMjY5OTY=,Incorporating cnvnator data into lumpy/smoove,OPEN,2018-10-15T20:18:14Z,2018-10-15T21:57:49Z,,"Hello,

I notice that there appears to be some cnvnator scripts in smoove, including a 'smoove cnvnator' command.  How do I got about running these and incorporating them into a run?

-David",dminkley,https://github.com/brentp/smoove/issues/28
MDU6SXNzdWUzNzA3ODAzMjI=,invalid coodinates star: start > stop,CLOSED,2018-10-16T20:12:58Z,2019-01-07T23:46:28Z,2019-01-07T23:46:28Z,"Hi @brentp,

While running `smoove call` using two samples (tumor-normal), I get exit 0 for most but a few samples having following error:

```
[smoove] 2018/10/16 09:22:28 AAEX03026072.1	1000000
[smoove] 2018/10/16 15:16:38 Traceback (most recent call last):
  File ""/projects/verhaak-lab/verhaak_env/anaconda/v4.2.0/bin/svtyper"", line 11, in <module>
[smoove] 2018/10/16 15:16:38     load_entry_point('svtyper==0.7.0', 'console_scripts', 'svtyper')()
  File ""/projects/verhaak-lab/verhaak_env/anaconda/v4.2.0/lib/python2.7/site-packages/svtyper/classic.py"", line 575, in cli
    sys.exit(main())
  File ""/projects/verhaak-lab/verhaak_env/anaconda/v4.2.0/lib/python2.7/site-packages/svtyper/classic.py"", line 568, in main
    args.max_ci_dist)
  File ""/projects/verhaak-lab/verhaak_env/anaconda/v4.2.0/lib/python2.7/site-packages/svtyper/classic.py"", line 281, in sv_genotype
    read_batch, many = gather_all_reads(sample, chromA, posA, ciA, chromB, posB, ciB, z, max_reads)
  File ""/projects/verhaak-lab/verhaak_env/anaconda/v4.2.0/lib/python2.7/site-packages/svtyper/classic.py"", line 61, in gather_all_reads
    read_batch, many = gather_reads(sample, chromB, posB, ciB, z, read_batch, max_reads)
  File ""/projects/verhaak-lab/verhaak_env/anaconda/v4.2.0/lib/python2.7/site-packages/svtyper/classic.py"", line 81, in gather_reads
    min(pos + ci[1] + fetch_flank, chrom_length))):
  File ""pysam/libcalignmentfile.pyx"", line 1074, in pysam.libcalignmentfile.AlignmentFile.fetch
  File ""pysam/libchtslib.pyx"", line 690, in pysam.libchtslib.HTSFile.parse_region
[smoove] 2018/10/16 15:16:38 ValueError: invalid coordinates: start (8766133) > stop (16727)
panic: exit status 1

goroutine 11201382 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper.func2(0xc3dfae4a80, 0xc00000af60, 0x2, 0x2, 0x7ffdf7eb2835, 0x32, 0xc00017a0b0, 0xc0001801b8, 0xc000180230, 0xc0000c8040, ...)
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:175 +0x5ed
created by github.com/brentp/smoove/svtyper.Svtyper
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:166 +0xb70
LOGGER	16Oct18_151639EDT	smoove_paired_runner	END	S01-FCD0-A2_paired	/gpfs/ctgs0/fastscratch/amins/svcalls/smoove/paired_runner/S01-FCD0-A2_paired	2
END at Tue Oct 16 15:16:39 EDT 2018
```

Command I'd executed:

```sh
smoove call \
--removepr \
--support 3 \
--processes 3 \
--genotype \
--name S01-FCD0-A2_paired \
--outdir /fastscratch/amins/svcalls/smoove/paired_genotyped_calls \
--exclude gaps_ucsc_table_canfam3.1.sorted.bed \
--excludechroms '~^AA,~^JH' \
--fasta /projects/verhaak-lab/DogWGSReference/CanFam3_1.fa \
/projects/verhaak-lab/L1SEQ/cgp_level1_bams/CGP-S01-FCD0-05212240-T6-A2-J01.aln.dup.realn.recal.rp.bam /projects/verhaak-lab/L1SEQ/cgp_level1_bams/CGP-S01-FCD0-B797658F-T1-A2-J01.aln.dup.realn.recal.rp.bam
```

I checked resulting vcf.gz from two cases with error and case with exit 0. For a case without any error, looks like `--excludechroms '~^AA,~^JH'` did not work for me as I see a few (1-5) SV calls from non-canonical chromosomes/scaffolds. For two cases with above error,  I see sv calls for all of canonical chromosomes for one case while no SV calls at all for an another case.

Since I am only interested in canonical chromosomes, I think I can safely ignore this error for cases where I have SV calls from canonical chromosomes while rerun samples where smoove ouptut zero calls. I don't see smoove running more steps after emitting calls to vcf but just want to make sure that error was emitted **after** (~ 6 hr runtime) traversing all of canonical chromosomes, and so I have error-free smoove run from canonical chromosomes.

```
[smoove] 2018/10/16 09:22:28 AAEX03026072.1	1000000
[smoove] 2018/10/16 15:16:38 Traceback (most recent call last):
```

Thanks,
Samir

[detailed log](https://gist.github.com/sbamin/7af42588b6eba3243d6b2135d1eb2a3f)
",sbamin,https://github.com/brentp/smoove/issues/29
MDU6SXNzdWUzNzQxOTM1MjQ=,"samtools index: ""bam"" is in a format that cannot be usefully indexed",CLOSED,2018-10-26T01:34:27Z,2018-12-11T23:38:28Z,2018-12-11T23:38:28Z,"Hello,

I am getting this err with some test samples as well as some real data. Here's the output on a test sample:

```
$ sh run_smoove.sh
[smoove] 2018/10/26 10:57:36 starting with version 0.2.1
[smoove] 2018/10/26 10:57:36 calculating bam stats for 2 bams
[smoove]: 2018/10/26 10:57:41 finished process: lumpy-filter (set -eu; lumpy_filter -f /researchers/ahwan.pandey/references/Homo_sapiens/DNAseq/GRCh37.92/b37/huma) in user-time:6.936149s system-time:506.684ms
[smoove]: 2018/10/26 10:57:45 finished process: lumpy-filter (set -eu; lumpy_filter -f /researchers/ahwan.pandey/references/Homo_sapiens/DNAseq/GRCh37.92/b37/huma) in user-time:12.487109s system-time:851.652ms
[smoove] 2018/10/26 10:57:46 done calculating bam stats
[smoove] 2018/10/26 10:58:03 removed 17082 alignments out of 20345 (83.96%) with low mapq, depth > 1000, or from excluded chroms from NormalA.split.bam in 17 seconds
[smoove] 2018/10/26 10:58:03 removed 215 alignments out of 20345 (1.06%) that were bad interchromosomals or flanked-splitters from NormalA.split.bam
[smoove] 2018/10/26 10:58:03 removed 1004 singletons of 3048 reads (32.94%) from NormalA.split.bam in 0 seconds
[smoove] 2018/10/26 10:58:03 2044 reads (10.05%) of the original 20345 remain from NormalA.split.bam
[smoove] 2018/10/26 10:58:04 removed 35045 alignments out of 51228 (68.41%) with low mapq, depth > 1000, or from excluded chroms from NormalA.disc.bam in 18 seconds
[smoove] 2018/10/26 10:58:04 removed 3549 alignments out of 51228 (6.93%) that were bad interchromosomals or flanked-splitters from NormalA.disc.bam
[smoove] 2018/10/26 10:58:04 removed 3872 singletons of 12634 reads (30.65%) from NormalA.disc.bam in 0 seconds
[smoove] 2018/10/26 10:58:04 8762 reads (17.10%) of the original 51228 remain from NormalA.disc.bam
[smoove] 2018/10/26 10:58:04 removed 29484 alignments out of 38248 (77.09%) with low mapq, depth > 1000, or from excluded chroms from TumorA.split.bam in 18 seconds
[smoove] 2018/10/26 10:58:04 removed 503 alignments out of 38248 (1.32%) that were bad interchromosomals or flanked-splitters from TumorA.split.bam
[smoove] 2018/10/26 10:58:04 removed 2280 singletons of 8261 reads (27.60%) from TumorA.split.bam in 0 seconds
[smoove] 2018/10/26 10:58:04 5981 reads (15.64%) of the original 38248 remain from TumorA.split.bam
[smoove] 2018/10/26 10:58:05 removed 64675 alignments out of 109968 (58.81%) with low mapq, depth > 1000, or from excluded chroms from TumorA.disc.bam in 19 seconds
[smoove] 2018/10/26 10:58:05 removed 8639 alignments out of 109968 (7.86%) that were bad interchromosomals or flanked-splitters from TumorA.disc.bam
[smoove] 2018/10/26 10:58:06 removed 10615 singletons of 36654 reads (28.96%) from TumorA.disc.bam in 1 seconds
[smoove] 2018/10/26 10:58:06 26039 reads (23.68%) of the original 109968 remain from TumorA.disc.bam
samtools index: "".//TumorA.disc.bam"" is in a format that cannot be usefully indexed
panic: exit status 1

goroutine 28898 [running]:
github.com/brentp/smoove/lumpy.check(...)
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.remove_sketchy_all.func1(0xc00019c2a0, 0x3e8, 0x7ffe0535ab4d, 0x5a, 0x7ffe0535aad4, 0x70, 0xc0001c43c0, 0x4, 0x4, 0xc0003dd701, ...)
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:335 +0x221
created by github.com/brentp/smoove/lumpy.remove_sketchy_all
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:329 +0x17f

```

The command used was:

```
SMOOVE=/researchers/ahwan.pandey/Tools/omics_tools/smoove/smoove/v0.2.1
GSORT=/researchers/ahwan.pandey/Tools/omics_tools/smoove/gsort/v0.0.6
MOSDEPTH=/researchers/ahwan.pandey/Tools/omics_tools/smoove/mosdepth/v0.2.3
DUPHOLD=/researchers/ahwan.pandey/Tools/omics_tools/smoove/duphold/v0.0.9

PATH=$SMOOVE:$GSORT:$MOSDEPTH:$DUPHOLD:$PATH

smoove call \
        --outdir results-smoove/ \
        -x --name TumorA_NormalA \
        --exclude /researchers/ahwan.pandey/references/Homo_sapiens/DNAseq/GRCh37.92/Lumpy/ceph18.b37.lumpy.exclude.2014-01-15.bed \
        --fasta /researchers/ahwan.pandey/references/Homo_sapiens/DNAseq/GRCh37.92/b37/human_g1k_v37.fasta \
        -p 8 \
        --genotype \
        --duphold \
	/researchers/ahwan.pandey/Projects/WholeGenome/Project_DG/tests/pipeline_test_tn_paired/analysis/Sample_TumorA/Alignments/TumorA.dups_marked.sorted.bam \
	/researchers/ahwan.pandey/Projects/WholeGenome/Project_DG/tests/pipeline_test_tn_paired/analysis/Sample_NormalA/Alignments/NormalA.dups_marked.sorted.bam
```",ahwanpandey,https://github.com/brentp/smoove/issues/30
MDU6SXNzdWUzODA0MzA4OTU=,Q about Input *,CLOSED,2018-11-13T21:26:08Z,2018-11-13T22:07:42Z,2018-11-13T22:04:16Z,"Your examples make liberal use of *.FILE_ENDING. Is it possible to feed smoove comma separated input? Or space separated? 

I'll be integrating this into a Snakemake pipeline which tracks all the files, so there's little issue with wordiness. ",davemcg,https://github.com/brentp/smoove/issues/32
MDU6SXNzdWUzODA1MDY3OTg=,Suggestion: Fail more gracefully if folder not given,CLOSED,2018-11-14T02:19:41Z,2018-11-14T03:01:46Z,2018-11-14T02:58:26Z,"Definitely in the ""minor"" category, but makes for a jarring experience. 
```
[mcgaugheyd@cn3211 2018-09-24]$ smoove call --name 1238 --fasta /fdb/GATK_resource_bundle/b37-2.8/human_g1k_v37_decoy.fasta --excludechroms hs37d5 -p 2 --outdir TEST_1238 --genotype --duphold sample_cram/1238.cram
[smoove] 2018/11/14 01:30:15 starting with version 0.1.11
[smoove] 2018/11/14 01:30:15 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2018/11/14 01:30:16 [E::hts_open_format] fail to open file 'TEST_1238/1238.disc.bam.tmp.bam'
[smoove]:([E]lumpy-filter) 2018/11/14 01:30:16 [E::hts_open_format] fail to open file 'TEST_1238/1238.split.bam.tmp.bam'
[smoove]:([E]lumpy-filter) 2018/11/14 01:30:16 /bin/bash: line 1: 33749 Segmentation fault      lumpy_filter -f /fdb/GATK_resource_bundle/b37-2.8/human_g1k_v37_decoy.fasta sample_cram/1238.cram TEST_1238/1238.split.bam.tmp.bam TEST_1238/1238.disc.bam.tmp.bam 2
[smoove]:2018/11/14 01:30:16 finished process: lumpy-filter (lumpy_filter -f /fdb/GATK_resource_bundle/b37-2.8/human_g1k_v37_decoy.fasta sample_cram/1238.cram TE) in user-time:11.854ms system-time:99.86ms
[smoove]:2018/11/14 01:30:16 error running command: lumpy_filter -f /fdb/GATK_resource_bundle/b37-2.8/human_g1k_v37_decoy.fasta sample_cram/1238.cram TEST_1238/1238.split.bam.tmp.bam TEST_1238/1238.disc.bam.tmp.bam 2 && mv TEST_1238/1238.split.bam.tmp.bam TEST_1238/1238.split.bam && mv TEST_1238/1238.disc.bam.tmp.bam TEST_1238/1238.disc.bam -> exit status 139

panic: open TEST_1238/1238.histo: no such file or directory

goroutine 27 [running]:
github.com/brentp/smoove/lumpy.check(...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:53
github.com/brentp/smoove/lumpy.filter.write_hist(0x7fffffffc79e, 0x15, 0xc0001743a0, 0x18, 0xc0001743c0, 0x17, 0xc0001ae000, 0x122, 0x7fffffffc7aa, 0x4, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:72 +0x219
github.com/brentp/smoove/lumpy.bam_stats.func1(0x1)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:192 +0x25a
created by github.com/brentp/smoove/lumpy.bam_stats
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:198 +0x1a2
```

After doing `mkdir TEST_1238` it is running fine. 

Perhaps create the folder or check if folder exists?",davemcg,https://github.com/brentp/smoove/issues/33
MDU6SXNzdWUzODA3OTY2NTQ=,Docker latest isn't the latest,CLOSED,2018-11-14T17:02:51Z,2018-11-19T19:56:09Z,2018-11-19T19:56:09Z,"I think I figured out why the HPC folks got confused (they thought they were installing 0.2.1 and 0.1.11 got installed)

If you run `docker pull brentp/smoove` you get 0.1.11

Running `docker pull brentp/smoove:v0.2.1` gets you 0.2.1

Of course now I can't verify as running `docker run brentp/smoove:latest smoove -version` throws an error (`docker run brentp/smoove:v0.2.1 smoove -version` works), but I'm pretty sure this was our issue. 

",davemcg,https://github.com/brentp/smoove/issues/34
MDU6SXNzdWUzODA4NTM3NjQ=,"""-p"" doesn't work?",CLOSED,2018-11-14T19:34:49Z,2019-01-07T23:45:49Z,2019-01-07T23:45:49Z,"Hi,
I was trying to speed up the smoove by increasing the threads number using ""-p"". However, so far ""-p 8"" on a 8 core machine and ""-p 16"" on a 16 core machine had the same runtime. I was running a single bam with the a command looking like this:
`smoove call -x --name  $name --exclude $exclude_bed_name --fasta $fasta_file_name -p $nts  --genotype  $bam_file`
The bam is 150bp pair end reads mapping on hg38, with ~50x coverage.
Any thoughts on this? Thanks a lot!

Yue",arkyl,https://github.com/brentp/smoove/issues/35
MDU6SXNzdWUzODE5NTM2MjY=,Error: The INFO field is not defined in the header: PREND,CLOSED,2018-11-18T12:00:43Z,2019-01-08T12:28:29Z,2019-01-08T12:28:29Z,"```
$ smoove -v
smoove version: 0.2.1
```

The call
```
smoove paste --name cohort smoove/reGenotype/CTNS.21-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.30-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.190-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.224-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.225-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.191-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.69-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.203-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.140-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.7-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.196-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.179-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.246-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.128-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.215-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.188-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.207-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.84-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.220-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.32-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.214-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.37-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.42-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.48-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.216-smoove.genotyped.vcf.gz smoove/reGenotype/CTNS.217-smoove.genotyped.vcf.gz smoove/reGenotype/OCA.24-smoove.genotyped.vcf.gz smoove/reGenotype/OCA.25-smoove.genotyped.vcf.gz smoove/reGenotype/OCAP.42-smoove.genotyped.vcf.gz smoove/reGenotype/OCA.72-smoove.genotyped.vcf.gz smoove/reGenotype/OCAP.140-smoove.genotyped.vcf.gz smoove/reGenotype/OCAP.141-smoove.genotyped.vcf.gz --outdir smoove
```
The error (cutting off most of the complaints about the index age)
```
...
[W::hts_idx_load2] The index file is older than the data file: smoove/reGenotype/OCA.72-smoove.genotyped.vcf.gz.csi
[smoove] 2018/11/18 11:45:27 [W::hts_idx_load2] The index file is older than the data file: smoove/reGenotype/OCAP.140-smoove.genotyped.vcf.gz.csi
[W::hts_idx_load2] The index file is older than the data file: smoove/reGenotype/OCAP.140-smoove.genotyped.vcf.gz.csi
[smoove] 2018/11/18 11:45:27 [W::hts_idx_load2] The index file is older than the data file: smoove/reGenotype/OCAP.141-smoove.genotyped.vcf.gz.csi
[W::hts_idx_load2] The index file is older than the data file: smoove/reGenotype/OCAP.141-smoove.genotyped.vcf.gz.csi
[smoove] 2018/11/18 11:45:34 all files had 43510 variants
[smoove] 2018/11/18 11:45:37 [W::vcf_parse] INFO 'PREND' is not defined in the header, assuming Type=String
[smoove] 2018/11/18 11:45:37 Error: The INFO field is not defined in the header: PREND
2018/11/18 11:45:37 exit status 255
```

A couple of the samples do indeed have  the PREND info (but not in the header). 
```
$ for i in smoove/reGenotype/*.vcf.gz; do echo $i; zcat $i | grep ""PREND=""; done
smoove/reGenotype/CTNS.128-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.140-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.179-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.188-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.190-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.191-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.196-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.203-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.207-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.214-smoove.genotyped.vcf.gz
smoove/reGenotype/CTNS.215-smoove.genotyped.vcf.gz
5	38233673	30223_1	N	N]5:38237482]	0	.	SVTYPE=BND;STRANDS=++:11;IMPRECISE;CIPOS=-30,634;CIEND=-9,427;CIPOS95=-4,170;CIEND95=0,179;MATEID=30223_2;EVENT=30223;SU=11;PE=11;SR=0;PREND=4.28368e-16...
```

The previous (re)genotype call
```
smoove genotype -p 16                   --name CTNS.37                  --outdir smoove/reGenotype/
                --duphold --removepr                    --fasta /fdb/GATK_resource_bundle/b37-2.8/human_g1k_v37_decoy.fasta                     --vcf smoove/cohort.sites.vcf.gz                        sample_bam/CTNS.37.bam
```
What should I check now? I think for now I'll just re-run the genotype and remove the `--removpr` flag.

Thanks,
David",davemcg,https://github.com/brentp/smoove/issues/36
MDU6SXNzdWUzODU0NzU3OTI=,Smoove over-writes bam files,CLOSED,2018-11-28T22:02:31Z,2018-11-29T01:40:25Z,2018-11-29T01:39:21Z,"Hello, 
I'm having trouble getting smoove to work, and I don't know how to debug this issue. Essentially, it looks like smoove is over-writing my bam file as soon as it starts, and then throws an EOF error. The error I get is:

[smoove] 2018/11/28 13:53:27 starting with version 0.2.2
[smoove] 2018/11/28 13:53:27 calculating bam stats for 1 bams
panic: unexpected EOF

goroutine 30 [running]:
github.com/brentp/goleft/covstats.pcheck(...)
	/home/brentp/go/src/github.com/brentp/goleft/covstats/covstats.go:30
github.com/brentp/goleft/covstats.BamStats(0xc000138960, 0x1312d0, 0x186a0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)
	/home/brentp/go/src/github.com/brentp/goleft/covstats/covstats.go:143 +0xc8c
github.com/brentp/smoove/lumpy.bam_stats.func1(0x1)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:197 +0x1f6
created by github.com/brentp/smoove/lumpy.bam_stats
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:211 +0x1a2

My actual command that I run with is:

`BAM=T014-1_BWAmem_dupremoved_realigned.sorted.bam
NAME=T014-1
OUTDIR=/mnt/causes-vnx2/TIDE/PROCESS/TIDE_GEL/T014/SMOOVE/
PROCS=16
GENOME_FASTA=/mnt/causes-vnx1/GENOMES/GSC/GRCh37-lite.fa

mkdir $OUTDIR

/opt/tools/smoove-0.2.2/smoove call \
        --name $NAME -p $PROCS \
        --outdir $OUTDIR \
        --genotype -f $GENOME_FASTA \
        $BAM
`

I thought it may be a samtools issue, but I'm using samtools v1.5. Do I need to use v1.9? I don't think I'm running the tool wrong since I followed exactly the code for a single bam file. Thanks for any help.

-Phil


",Phillip-a-richmond,https://github.com/brentp/smoove/issues/37
MDU6SXNzdWUzODc1MjY0NTk=,"ENH: smoove annotate, report genes within X KB.",CLOSED,2018-12-04T23:31:56Z,2018-12-06T03:47:05Z,2018-12-06T03:47:05Z,this is useful to remove stuff that's in no-man's land.,brentp,https://github.com/brentp/smoove/issues/39
MDU6SXNzdWUzODc1MjY2MjQ=,ENH: run new samplot_vcf.py script on output.,OPEN,2018-12-04T23:32:33Z,2018-12-04T23:32:33Z,,this is difficult for cloud as it requires accessing the BAM/CRAM files directly.,brentp,https://github.com/brentp/smoove/issues/40
MDU6SXNzdWUzODc1MjY3MzM=,"ENH: save+report number of discordant, splits before and after filtering.",CLOSED,2018-12-04T23:33:03Z,2018-12-06T03:46:47Z,2018-12-06T03:46:47Z,this is a good QC metric.,brentp,https://github.com/brentp/smoove/issues/41
MDU6SXNzdWUzODg4NDYwODc=,Filtering SV Calls,CLOSED,2018-12-07T23:09:40Z,2018-12-08T14:48:39Z,2018-12-08T14:48:39Z,"So I'm using Smoove in our pipeline for rare disease diagnosis, but most of the calls are difficult to filter. 

I really liked the analysis within https://www.nature.com/articles/s41525-018-0061-8 (EIEE WGS paper 2018), and specifically I was wondering, from smoove output, what's the best way to apply this filter?

""Candidate de novo structural mutations were identified by screening the LUMPY SV predictions in each family for variants where the proband had a variant genotype, and both parents had homozygous reference genotypes. We further required the proband to have at least 15 alignments (paired-end or split-read) supporting the de novo SV and each parent to have zero supporting reads. We then removed SVs where either end overlapped a simple repeat defined by the UCSC genome browser for build 37 of the human genome. After these steps, only two SVs remained: the translocation in family 42,610, and the duplication in family 44,133.""

Is this something that is done with vcftools on the resulting VCF file from Smoove?

Thanks,
Phil
",Phillip-a-richmond,https://github.com/brentp/smoove/issues/42
MDU6SXNzdWUzODk4MjE3MjA=,index: unrecognized option '--threads',CLOSED,2018-12-11T15:35:56Z,2018-12-12T16:09:50Z,2018-12-12T16:09:49Z,"Hello.
I just got smoove installed on our system but I'm unable to get through a test case.
I'm running the whole pipeline on just chromosome 22 for testing purposes.

Here is the output of the smoove command:
<pre>

smoove version: 0.2.2

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools
 *[Y] svtyper
 *[Y] mosdepth [extra filtering of split and discordant files for better scaling]

  [Y] duphold [(optional) annotate calls with depth changes]
  [Y] svtools [only needed for large cohorts].
</pre>

Then execute these commands:
<pre>
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:~/smoove/bin ## for libhts.so
smoove call --outdir results-smoove/ --name samp_001.chr22 --fasta /nfs/conf/hs37d5.fa --genotype bam.files/samp_001.chr22.bam
</pre>

This is the output I get:
<pre>
[smoove] 2018/12/11 10:26:38 starting with version 0.2.2
[smoove] 2018/12/11 10:26:38 calculating bam stats for 1 bams
[smoove] 2018/12/11 10:26:49 done calculating bam stats
[smoove] 2018/12/11 10:26:50 removed 0 alignments out of 7639 (0.00%) with low mapq, depth > 1000, or from excluded chroms from samp_001.split.bam in 1 seconds
[smoove] 2018/12/11 10:26:50 removed 0 alignments out of 7639 (0.00%) that were bad interchromosomals or flanked-splitters from samp_001.split.bam
[smoove] 2018/12/11 10:26:50 removed 0 singletons of 7639 reads (0.00%) from samp_001.split.bam in 0 seconds
[smoove] 2018/12/11 10:26:50 7639 reads (100.00%) of the original 7639 remain from samp_001.split.bam
[smoove] 2018/12/11 10:26:50 removed 0 alignments out of 5893 (0.00%) with low mapq, depth > 1000, or from excluded chroms from samp_001.disc.bam in 1 seconds
[smoove] 2018/12/11 10:26:50 removed 0 alignments out of 5893 (0.00%) that were bad interchromosomals or flanked-splitters from samp_001.disc.bam
[smoove] 2018/12/11 10:26:50 removed 0 singletons and isolated interchromosomals of 5893 reads (0.00%) from samp_001.disc.bam in 0 seconds
[smoove] 2018/12/11 10:26:50 5893 reads (100.00%) of the original 5893 remain from samp_001.disc.bam
[smoove] 2018/12/11 10:26:50 starting lumpy
[smoove] 2018/12/11 10:26:50 wrote lumpy command to results-smoove//samp_001_chr22-lumpy-cmd.sh
[smoove] 2018/12/11 10:26:50 writing sorted, indexed file to results-smoove/samp_001_chr22-smoove.genotyped.vcf.gz
[smoove] 2018/12/11 10:26:50 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2018/12/11 10:26:51 > gsort version 0.0.6
[smoove] 2018/12/11 10:26:51 22	1000000
[smoove] 2018/12/11 10:26:51 22	2000000
22	4000000
22	8000000
22	16000000
22	32000000
[smoove] 2018/12/11 10:27:10 index: unrecognized option '--threads'

About:   Index bgzip compressed VCF/BCF files for random access.
Usage:   bcftools index [options] <in.bcf>|<in.vcf.gz>

Indexing options:
    -c, --csi            generate CSI-format index for VCF/BCF files [default]
    -f, --force          overwrite index if it already exists
    -m, --min-shift INT  set minimal interval size for CSI indices to 2^INT [14]
    -t, --tbi            generate TBI-format index for VCF files

Stats options:
    -n, --nrecords       print number of records based on existing index file
    -s, --stats   print per contig stats based on existing index file

panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xa840c0, 0xc00000c110, 0x7ffe50e533b6, 0x23, 0xc00016e640, 0x1, 0x1, 0x7ffe50e53387, 0xf, 0x7ffe50e5339e, ...)
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:224 +0x18c6
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:332 +0x433
main.main()
	/home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:123 +0x1d7
</pre>

I'm not sure what is wrong. Obviously it's choking at a bcftools command and elsewhere but I can't find the source.

The bam file I'm giving it looks fine. It runs to completion through lumpy with no issues.

Any suggests would be welcome.
Thanks!
",dfermin,https://github.com/brentp/smoove/issues/44
MDU6SXNzdWUzOTA3MzcxNTM=,Number of variants differ between merge and genotyped files,CLOSED,2018-12-13T15:44:00Z,2019-01-07T18:01:45Z,2018-12-14T15:18:46Z,"Hello.

I'm able to run smoove call, merge and then genotype.
When I try to run the `smoove paste` function I hit this error:

```
[smoove] 2018/12/13 08:46:43 starting with version 0.2.2
[smoove] 2018/12/13 08:46:43 squaring 613 files to smoove/results-pasted/cohort1.smoove.square.vcf.gz
[smoove] 2018/12/13 08:47:25 613 files had 9363 variants
[smoove] 2018/12/13 08:47:25 files: smoove/results-genotyped/samp_123.genotyped.vcf.gz had 9365 variants
[smoove] 2018/12/13 08:47:25 files: smoove/results-genotyped/samp_918.genotyped.vcf.gz,smoove/results-genotyped/samp_332.genotyped.vcf.gz  had 9364 variants
[smoove] 2018/12/13 08:47:25 please make sure that all files have the same number of variants
```

The merge output (call it `merge.sites.vcf.gz`) contains 9363 variants. 
One of the samples in my data set (call it `samp_123.genotyped.vcf.gz`) contains 936**5** variants.

A quick check with 
```
vcftools --gzvcf merge.sites.vcf.gz --gzdiff samp_123.genotyped.vcf.gz --diff-sites --stdout | grep -w '\.' -A1 -B1
``` 

shows me this output:

```
1       70107418        70107418        B       N       N       <DUP>   <DUP>
1       .       70107418        2       .       N       .       <DUP>
1       70259625        70259625        B       N       N       <DEL>   <DEL>
--
1       70375190        70375190        B       N       N       <DUP>   <DUP>
1       .       70375190        2       .       N       .       <DUP>
1       70375403        70375403        B       N       N       <DEL>   <DEL>
```

So 2 variants have two entries in `samp_123.genotyped.vcf.gz` 

I know what the problem is but I'm not sure how fix it. I could filter on the sites in the merge.sites.vcf.gz file but I'm wondering why the `smoove merge` step didn't catch and address this. Perhaps it can and I just don't know the command.
Is there an smoove-specific command/option/function I can use to fix this?

Thanks,
Damian
",dfermin,https://github.com/brentp/smoove/issues/45
MDU6SXNzdWUzOTExMTU4NjE=,Segfault running smoove annotate,CLOSED,2018-12-14T13:41:51Z,2018-12-18T14:18:56Z,2018-12-18T13:44:46Z,"Last hurdle!
I'm running the final step after `smoove paste` to annotate the final VCF and I'm getting a segfault. 
This error seems reproducible. I consistently get this message when I run `smoove paste`.

```
smoove annotate --gff ~/ref_files/gencode.v28lift37.annotation.gff3.gz results-pasted/chr1.smoove.square.vcf.gz | bgzip -c > final_vcfs/chr1.smoove.square.annot.vcf.gz
[smoove] 2018/12/14 08:33:10 starting with version 0.2.2
panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x8 pc=0x6d5213]

goroutine 1 [running]:
github.com/brentp/smoove/annotate.setSmooveQuality(0xc000190340, 0xc000190340)
	/home/brentp/go/src/github.com/brentp/smoove/annotate/annotate.go:355 +0x113
github.com/brentp/smoove/annotate.annotate(0xc0042a8940, 0xc004111f20, 0xc000166de0)
	/home/brentp/go/src/github.com/brentp/smoove/annotate/annotate.go:380 +0xe1
github.com/brentp/smoove/annotate.Main()
	/home/brentp/go/src/github.com/brentp/smoove/annotate/annotate.go:439 +0x467
main.main()
	/home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:123 +0x1d7
```

I know the annotation step is optional so this might not be necessary. However I would like to get the **MSHQ** score for the calls to work with. If this could be obtained some other way I'll happily go that root.

Thanks!",dfermin,https://github.com/brentp/smoove/issues/46
MDU6SXNzdWUzOTE4Njk4MTc=,output total reads of bam during `smoove call`,CLOSED,2018-12-17T20:05:08Z,2019-01-15T19:22:35Z,2019-01-15T19:22:35Z,Total included in the bam or total mapped. Something to stdout with a simple key:value pair would be ideal.,brwnj,https://github.com/brentp/smoove/issues/47
MDU6SXNzdWUzOTQ5MTU0NjY=,Errors when run with large number of samples,OPEN,2018-12-31T01:01:14Z,2019-03-20T04:50:35Z,,"Hi @brentp,

I ran smoove v0.2.2 using singularity and I run it as part of a nextflow process. When I execute with small sample size (i.e. 30, 100, and 300), all the smoove commands work perfectly and the whole process is able to complete.
However, when I increase my sample size to 654 samples, I kept getting errors that are not reproducible.

One of the errors that I get is: 
  [smoove] 2018/12/20 04:18:13 starting with version 0.2.2
  [smoove] 2018/12/20 04:18:13 squaring 654 files to 654sample.smoove.square.vcf.gz
  [smoove] 2018/12/20 04:19:38 files: WHH443_joint-smoove.genotyped.vcf.gz had 65509 variants
  [smoove] 2018/12/20 04:19:38 653 files had 65507 variants
  [smoove] 2018/12/20 04:19:38 please make sure that all files have the same number of variants

But when I execute the smoove genotype command on singularity shell for the file, it has 66507 variants.
I checked the original file with 66509 variants and noticed that 2 of the variants were repeated in the file. 

Another error which I get is:
  [smoove] 2018/12/19 03:52:57 starting with version 0.2.2
  [smoove] 2018/12/19 03:52:57 merging 654 files
  [smoove] 2018/12/19 03:52:57 finished sorting 654 files; merge starting.
  [smoove] 2018/12/19 03:58:11 Required tag PREND not found. Please ensure you've run lumpy with the -P option to emit breakpoint probabilities.
  2018/12/19 03:58:11 exit status 1

I noticed that the process always break either at the smoove merge or smoove paste step. 

Thank you.

Best regards,
Joanna



 



",JoannaTan,https://github.com/brentp/smoove/issues/48
MDU6SXNzdWUzOTU0MzE5MTU=,Behaviour of the --exclude option,CLOSED,2019-01-03T01:23:03Z,2019-01-07T19:25:37Z,2019-01-07T19:25:37Z,"Hello,

I'm curious what the exact behaviour of the --exclude option is.  The documentation says it can be used to 'remove problematic regions' - how does it do this?  Does it ignore evidence from problematic regions (ie reads mapping in these regions can't offer support for a variant), or does it remove variants which span such a region?

Thanks,

David",dminkley,https://github.com/brentp/smoove/issues/49
MDU6SXNzdWUzOTY1OTE4MTc=,Smoove filling up TMP space and not listening to TMPDIR,CLOSED,2019-01-07T18:07:33Z,2019-01-07T18:18:00Z,2019-01-07T18:17:59Z,"Hello!

I've been using smoove (genotype, specifically) recently, and had an issue with it filling up my default tmp space during a large run.  I tried setting the TMPDIR environment variable (as well as TEMP and TMP) to point a location with more space, but smoove appears to be ignoring it.  Is there a way to set the tmp directory used by smoove?  If not, could this be added in a future release (either respecting TMPDIR or a --tmp option)?

Thanks!

-David",dminkley,https://github.com/brentp/smoove/issues/50
MDU6SXNzdWU0MDA5Njk4ODE=,Is there any way to modify the parameters used by lumpy?,CLOSED,2019-01-19T07:16:54Z,2021-10-19T03:04:57Z,2019-01-20T14:25:55Z,"Hi @brentp,
I'm wondering if there is any way to modify the parameters used by lumpy? 
I noticed that there was a shell script named `$sample-lumpy-cmd.sh` under the running path, but this script will be overwritten every time I ran `smoove call`.
I'm using  smoove 0.1.9 from bioconda, and it seems to be a single file program, without any configure files.",SilenWang,https://github.com/brentp/smoove/issues/51
MDU6SXNzdWU0MDEwNDM0NTI=,Comparison to GRIDSS,CLOSED,2019-01-19T23:00:10Z,2019-01-19T23:17:42Z,2019-01-19T23:17:42Z,"Smoove is a post-processing tool that improves specificity of Lumpy results. I found a more recent tool from 2017, [GRIDSS](https://genome.cshlp.org/content/27/12/2050), which did benchmarking against Lumpy and appeared to have superior performance. Now I'm wondering how the combination on Lumpy and smoove performs in comparison to GRIDSS. Is there any benchmarking available to help decide? Looking at the Latest Releases of Lumpy, the last one, 0.2.13, was almost 3 years ago, so I'd naively tend to choose something more recently updated if there was no benchmarking. But, in another smoove issue, you mentioned that you processed over 50000 samples using Lumpy, so that makes it appealing on the other hand.",DarioS,https://github.com/brentp/smoove/issues/52
MDU6SXNzdWU0MDIzMzAwNzE=,Why doesn't AS + AP = SU?,CLOSED,2019-01-23T16:43:59Z,2019-04-30T19:59:38Z,2019-04-30T19:59:38Z," have run smoove then duphold on 46 individuals, then pasted the duphold output back into a squared vcf with all 46 samples. I have been using SU/AC as one of my filters, looking for variants that have a minimum threshold of support per alternate allele called. Now I'm confused by some of the variants that are getting filtered out, and wonder why SU (number of pieces of evidence supporting the variant) is not calculated as I had expected.

For one variant, if I sum the AS values (split-read observation counts) and the AP values (paired-end observation counts) over all 46 individuals, I get AS=24 and AP=15, so 39 total reads supporting the variant in the population. However, SU is only 14 (PE=5 + SR=9).

Can anyone tell me why the values for SU, PE, SR are so much lower than the total AS & AP counts? Thank you!",JoWhi,https://github.com/brentp/smoove/issues/53
MDU6SXNzdWU0MDIzNDc0NzE=,ENH: add clinvar disease name during smoove annotate,CLOSED,2019-01-23T17:22:46Z,2019-04-30T20:00:26Z,2019-04-30T20:00:26Z,add an extra argument --clinvar that will pull CLNDN for the gene name added from the GTF.,brentp,https://github.com/brentp/smoove/issues/54
MDU6SXNzdWU0MDQ1MTUxMTc=,gsort (actually lumpy),CLOSED,2019-01-29T22:27:20Z,2019-04-30T19:59:21Z,2019-04-30T19:58:55Z,"Running smoove on 200 samples. Almost everything running smoove'ly.  For a small subset, ~15%. gsort seems to run forever and get jobs killed by memory limits I think.  Most calls are using  10gb +/-2 of memory but some of the failing ones are pushing 44gb any ideas what might be happening? Attaching the tail of the STDERR for a successful vs unsucessful.  

successful (job log suggests maxvmem      6.772G)
```[smoove] 2019/01/29 01:37:01 	1000000
[smoove] 2019/01/29 01:37:01 chrY
[smoove] 2019/01/29 01:37:01
[smoove] 2019/01/29 01:37:01 2000000
[smoove] 2019/01/29 01:37:01
[smoove] 2019/01/29 01:37:01 chrY
[smoove] 2019/01/29 01:37:01
[smoove] 2019/01/29 01:37:01 4000000
[smoove] 2019/01/29 01:37:01
[smoove] 2019/01/29 01:40:14 wrote sorted, indexed file to /broad/sankaranlab/Thai_HPFH/10_ARQ/02_out/C1001_1-smoove.genotyped.vcf.gz
```
unsuccessful (job log suggests maxvmem      43.450G)
```
smoove] 2019/01/29 08:04:03
[smoove] 2019/01/29 08:04:03 1000000
[smoove] 2019/01/29 08:04:03
[smoove] 2019/01/29 11:38:15 chr4
[smoove] 2019/01/29 11:38:15
[smoove] 2019/01/29 11:38:15 1000000
[smoove] 2019/01/29 11:38:15
[smoove] 2019/01/29 12:38:35 bash: line 1: 17805 Killed                  lumpy -msw 4 -mw 4 -t $(mktemp) -tt 0 -P -pe id:F0410_1,bam_file:/broad/sankaranlab/Thai_HPFH/10_ARQ/02_out/F0410_1.disc.bam,histo_file:/broad/sankaranlab/Thai_HPFH/10_ARQ/02_out/F0410_1.histo,mean:378.25,stdev:115.59,read_length:151,min_non_overlap:151,discordant_z:4,back_distance:30,weight:1,min_mapping_threshold:20 -sr id:F0410_1,bam_file:/broad/sankaranlab/Thai_HPFH/10_ARQ/02_out/F0410_1.split.bam,back_distance:10,weight:1,min_mapping_threshold:20
[smoove] 2019/01/29 12:40:17 2019/01/29 12:40:17 time to merge 3 files: 59.680
[smoove] 2019/01/29 12:40:20 wrote sorted, indexed file to /broad/sankaranlab/Thai_HPFH/10_ARQ/02_out/F0410_1-smoove.genotyped.vcf.gz```

",jeffverboon,https://github.com/brentp/smoove/issues/55
MDU6SXNzdWU0MDY4MDA3OTM=,INFO field 'END' is before varaint's 'POS' for variant created via Smoove SV population calling,OPEN,2019-02-05T14:12:09Z,2019-08-26T06:31:42Z,,"Hi, 

I was able to use the Smoove population SV calling pipeline to SV call 200+ samples.
SVs that we are interested in were also included in the results.  
So the pipeline worked fast and the results are good based on our first experience with Smoove.

I ran into one issue while trying to annotate the SV's via SnpEff.
```
java.lang.RuntimeException: java.lang.RuntimeException: INFO field 'END' is before varaint's 'POS'
        END : 3869
        POS : 3923
        at org.snpeff.fileIterator.VcfFileIterator.parseVcfLine(VcfFileIterator.java:115)
        at org.snpeff.fileIterator.VcfFileIterator.readNext(VcfFileIterator.java:166)
        at org.snpeff.fileIterator.VcfFileIterator.readNext(VcfFileIterator.java:56)
        at org.snpeff.fileIterator.FileIterator.hasNext(FileIterator.java:123)
        at org.snpeff.snpEffect.commandLine.SnpEffCmdEff.annotateVcf(SnpEffCmdEff.java:449)
        at org.snpeff.snpEffect.commandLine.SnpEffCmdEff.annotate(SnpEffCmdEff.java:140)
        at org.snpeff.snpEffect.commandLine.SnpEffCmdEff.run(SnpEffCmdEff.java:992)
        at org.snpeff.snpEffect.commandLine.SnpEffCmdEff.run(SnpEffCmdEff.java:947)
        at org.snpeff.SnpEff.run(SnpEff.java:1009)
        at org.snpeff.SnpEff.main(SnpEff.java:155)
Caused by: java.lang.RuntimeException: INFO field 'END' is before varaint's 'POS'
        END : 3869
        POS : 3923
        at org.snpeff.vcf.VcfEntry.parseEnd(VcfEntry.java:1092)
        at org.snpeff.vcf.VcfEntry.parse(VcfEntry.java:961)
        at org.snpeff.vcf.VcfEntry.<init>(VcfEntry.java:220)
        at org.snpeff.fileIterator.VcfFileIterator.parseVcfLine(VcfFileIterator.java:112)
```
https://github.com/pcingola/SnpEff/blob/87976d2c63fc2590408cc40f41b96818079324b9/src/main/java/org/snpeff/vcf/VcfEntry.java#1159

I could trace this back to this record in the final VCF file produced via Smoove paste.  In this record END is indeed before POS.
```
Chr_01  3924 92939   N       <DEL>   29.87   .       SVTYPE=DEL;SVLEN=54;END=3870;STRANDS=+-:31;IMPRECISE;CIPOS=-182,109;CIEND=-120,194;CIPOS95=-157,109;CIEND95=-120,153;SU=31;PE=31;SR=0;SNAME=Sample_46:149,Sample_79:52;ALG=SUM;AN=462;AC=1
```

For Sample_79 I could find back this records in the result from smoove call. This variants has the same start position, but length 48 instead of 54 and END is after POS.
```
Chr_01  3924 52      N       <DEL>   89.31   .       SVTYPE=DEL;SVLEN=-48;END=3972;STRANDS=+-:11;IMPRECISE;CIPOS=-30,105;CIEND=-47,88;CIPOS95=0,104;CIEND=-47,88;CIPOS95=0,104;CIEND95=-45,59;SU=11;PE=11;SR=0
```

In the `merged.sites.vcf.gz` VCF file produced with smoove the END before POS issue can first be found:
```
Chr_01  3924 92939   N       <DEL>   0       .       SVTYPE=DEL;SVLEN=54;END=3870;STRANDS=+-:31;IMPRECISE;CIPOS=-182,109;CIEND=-120,194;CIPOS95=-157,109;CIEND=-120,194;CIPOS95=-157,109;CIEND95=-120,153;SU=31;PE=31;SR=0
```

I could not find in the VCF spec if END is always required to be after POS. 
https://samtools.github.io/hts-specs/VCFv4.2.pdf

SnpEff seems to take this strict. As far as I know at least (small) variants including indels are always reported on the positive strand with END after than POS.  Do you know if this is/should also be the case for SV's?

And maybe check if this issue can be fixed in the smoove merge code. 

Thank you. 







",WimSpee,https://github.com/brentp/smoove/issues/56
MDU6SXNzdWU0MDczNzkwMTQ=,How specifically does one satisfy lumpy_filter dependency?,CLOSED,2019-02-06T18:50:07Z,2019-02-12T13:56:54Z,2019-02-12T13:56:54Z,"Greetings. I tried to install smoove-0.2.3. All dependencies are met, except one. When calling smoove, lumpy_filter is missing. The build instructions here and for lumpy-sv v0.2.13 make no direct allowance for ""lumpy_filter.""

How is the user supposed to build or include such a dependency? Thanks for any leads.",jbsysadmin,https://github.com/brentp/smoove/issues/57
MDU6SXNzdWU0MDkxODQ2ODY=,Empty VCF header reference attribute in VCF files produced via Smoove commands,CLOSED,2019-02-12T08:50:17Z,2019-02-12T15:36:50Z,2019-02-12T15:36:50Z,"I get this downstream error when trying to read a SV VCF file created with Smoove.
```
    raise ValueError(""Empty VCF header reference attribute is not allowed. Check VCF/BCF header for the 'reference' value."")
ValueError: Empty VCF header reference attribute is not allowed. Check VCF/BCF header for the 'reference' value.
```

In the final pasted square VCF the reference attribute is indeed empty.  
This also the case in all the intermediate VCF files (each call VCF, the merged sites VCF, each genotype VCF)
```
##reference=
```

The  Smoove call, merge and genotype commands require the fasta on the command line. So it should be possible to set this attribute in the header for the intermediate and the final pasted VCF. 

",WimSpee,https://github.com/brentp/smoove/issues/58
MDU6SXNzdWU0MTIwMDc4NjI=,Error in lumpy_filter step,CLOSED,2019-02-19T16:20:32Z,2019-02-20T00:44:45Z,2019-02-19T16:34:20Z,"I'm trying to run smoove on a set of tumor-normal pairs as outlined here: https://github.com/brentp/smoove/issues/26

My call is:
```shell
smoove call \
        -x \
        --name sample_name \
        --outdir structural_variants/smoove \
        --exclude ceph18.b37.lumpy.exclude.2014-01-15.bed \
        --fasta ref.fa \
        --processes 6 \
        --support 3 \
        --duphold \
        --genotype normal.bam tumor.bam""
```

After the bam stats step, smoove exits with this error message:
```
smoove]:2019/02/19 10:39:50 error running command: set -eu; lumpy_filter -f ref.fa normal.bam structural_variants/smoove/normal.split.bam.tmp.bam structural_variants/smoove/normal.disc.bam.tmp.bam 2 && mv structural_variants/smoove/normal.split.bam.tmp.bam structural_variants/smoove/normal.split.bam && mv structural_variants/smoove/normal.disc.bam.tmp.bam structural_variants/smoove/normal.disc.bam && cp structural_variants/smoove/normal.split.bam structural_variants/smoove/normal.split.bam.orig.bam && cp structural_variants/smoove/normal.disc.bam structural_variants/smoove/normal.disc.bam.orig.bam -> exit status 83
[smoove]:([E]lumpy-filter) 2019/02/19 11:04:23 [lumpy_filter] extracted splits and discordants from 1978285232 total aligned reads
[smoove]:2019/02/19 11:04:23 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/jonssonp/work/ref/b37/b37.fasta bam/tumor.bam structu) in user-time:1h28m10.742684s system-time:5m39.635367s
[smoove]:2019/02/19 11:04:23 error running command: set -eu; lumpy_filter -f ref.fa tumor.bam structural_variants/smoove/tumor.split.bam.tmp.bam structural_variants/smoove/tumor.disc.bam.tmp.bam 2 && mv structural_variants/smoove/tumor.split.bam.tmp.bam structural_variants/smoove/tumor.split.bam && mv structural_variants/smoove/tumor.disc.bam.tmp.bam structural_variants/smoove/tumor.disc.bam && cp structural_variants/smoove/tumor.split.bam structural_variants/smoove/tumor.split.bam.orig.bam && cp structural_variants/smoove/tumor.disc.bam structural_variants/smoove/tumor.disc.bam.orig.bam -> exit status 84
panic: exit status 84

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.Lumpy(0x7ffe2b6579f2, 0x1b, 0x7ffe2b657a72, 0x25, 0x7ffe2b657a17, 0x1a, 0xc00016a940, 0x2, 0x2, 0xc000170f00, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:127 +0x5c9
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:334 +0x277
main.main()
	/home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1d7
```

The `lumpy_filter` call finishes and produces the `*tmp.bam` files. The individual `mv` and `cp` calls work when I run them after the process exits. Any clue what could be the issue?",kpjonsson,https://github.com/brentp/smoove/issues/59
MDU6SXNzdWU0MTIwMTE0NzI=,tumour normal call,CLOSED,2019-02-19T16:27:42Z,2019-02-19T16:55:12Z,2019-02-19T16:32:41Z,"Hi, 
Im using smoove to call SVs in tumour material, great tool easy to use. I would like to call somatic SVs
Im not exactly sure what the correct procedure is. I have read the previous post regarding a similar problem and the documentation from smoove and Lumpy and these didn't quite cover the issue, I was hoping you could help.
Following the scheme in Lumpy express of listing the two files (tumour/normal) sequentially, I executed the the smoove command ; 

smoove call --outdir smoove_output --exclude exclude_regions.bed --name INF001 --fasta $ref_genome -p `nproc` --genotype $tumour_bam $normal_bam

This outputs a file ""INF001-smoove.genotyped.vcf.gz""  which appears to be a cohort bam but I'm unsure how on the basis of this to extract the somatic calls?

thanks 

jamie ",Sames-Jtudd,https://github.com/brentp/smoove/issues/60
MDU6SXNzdWU0MTQyMjMyNDI=,difference in the number of variants called depending on whether samples are called individually or in pairs,CLOSED,2019-02-25T17:38:09Z,2019-04-30T19:58:08Z,2019-04-30T19:58:08Z,"Hi, great tool, sorry to bother.
I've been playing around with different ways of calling SVs. I'm interested in somatic variants so I compared the results obtained by 1) joint calling a tumour/normal pairs and 2) calling the normal from the merge of the tumour. In either case filtering for those variants with evidence only in the tumor sample (ie the matched normal has AO=0).  
ie  1) joint call 
$smoove call --name BLAH --exclude exclude.bed --fasta ref.fa -p $(nproc) --genotype normal.bam tumour.bam

2) tumor call first then merge and call the normal  
$smoove call --name BLAH --exclude exclude.bed --fasta ref.fa -p $(nproc) --genotype tumour.bam
$smoove merge --name merged --fasta ref.fa --outdir ./ results-smoove/tumour.genotyped.vcf.gz
$smoove genotype -d -x -p 1 --name joint --outdir results-genotped/ --fasta ref.fa --vcf merged.sites.vcf.gz normal.bam 

When I do this I get a different number of variants with evidence only in the tumour sample. 
All of those SVs called by the (2) sequential method are called by joint calling (1) method. But there are additional SVs called only by the joint method. Unless I've missed something, which is defo possible, this should not be true?  
As for why I don't just joint call and filter, Im using cloud based computing and its about 10x the cost to joint call due to resource requirements. 

many thanks 

jamie",Sames-Jtudd,https://github.com/brentp/smoove/issues/61
MDU6SXNzdWU0MjIyNzUxNDI=,Merge issue,CLOSED,2019-03-18T15:15:40Z,2022-07-12T19:26:33Z,2019-03-19T04:23:33Z,"Hi there,

I'm in the process of re-running our SV calling pipeline with the latest version of a few callers... smoove got updated to 0.2.3. I'm getting this error when attempting to merge individual VCFs from the first call step:

Command run:
```
smoove merge --fasta /projects/b1059/data/genomes/c_elegans/WS245/WS245.fa --name merged_smoove --outdir . vcf1 vcf2....vcf330
```

Command error:
```
[smoove] 2019/03/17 23:35:30 starting with version 0.2.3
[smoove] 2019/03/17 23:35:30 merging 330 files
[smoove] 2019/03/17 23:35:30 finished sorting 330 files; merge starting.
[smoove] 2019/03/17 23:48:17 Traceback (most recent call last):
  File ""/home/szs315/.pyenv/versions/py2-2018-03-09/bin/svtools"", line 11, in <module>
[smoove] 2019/03/17 23:48:17     sys.exit(main())
[smoove] 2019/03/17 23:48:17   File ""/home/szs315/.pyenv/versions/miniconda3-4.3.27/envs/py2-2018-03-09/lib/python2.7/site-packages/svtools/cli.py"", line 79, in main
[smoove] 2019/03/17 23:48:17     sys.exit(args.entry_point(args))
[smoove] 2019/03/17 23:48:17   File ""/home/szs315/.pyenv/versions/miniconda3-4.3.27/envs/py2-2018-03-09/lib/python2.7/site-packages/svtools/lmerge.py"", line 622, in run_from_args
[smoove] 2019/03/17 23:48:17     weighting_scheme=args.weighting_scheme)
[smoove] 2019/03/17 23:48:17   File ""/home/szs315/.pyenv/versions/miniconda3-4.3.27/envs/py2-2018-03-09/lib/python2.7/site-packages/svtools/lmerge.py"", line 587, in l_cluster_by_line
[smoove] 2019/03/17 23:48:17     v_id = r_cluster(BP_l, sample_order, v_id, use_product, vcf, vcf_out, include_genotypes, weighting_scheme)
[smoove] 2019/03/17 23:48:17   File ""/home/szs315/.pyenv/versions/miniconda3-4.3.27/envs/py2-2018-03-09/lib/python2.7/site-packages/svtools/lmerge.py"", line 518, in r_cluster
[smoove] 2019/03/17 23:48:17     v_id = merge(BP_r, sample_order, v_id, use_product, vcf, vcf_out, include_genotypes, weighting_scheme)
[smoove] 2019/03/17 23:48:17   File ""/home/szs315/.pyenv/versions/miniconda3-4.3.27/envs/py2-2018-03-09/lib/python2.7/site-packages/svtools/lmerge.py"", line 493, in merge
[smoove] 2019/03/17 23:48:17     var=create_merged_variant(BP, cliq, v_id, vcf, use_product, weighting_scheme)
[smoove] 2019/03/17 23:48:17   File ""/home/szs315/.pyenv/versions/miniconda3-4.3.27/envs/py2-2018-03-09/lib/python2.7/site-packages/svtools/lmerge.py"", line 236, in create_merged_variant
[smoove] 2019/03/17 23:48:17     new_start_L, new_start_R, p_L , p_R, ALG = combine_pdfs(BP, c, use_product, weighting_scheme)
[smoove] 2019/03/17 23:48:17   File ""/home/szs315/.pyenv/versions/miniconda3-4.3.27/envs/py2-2018-03-09/lib/python2.7/site-packages/svtools/lmerge.py"", line 171, in combine_pdfs
[smoove] 2019/03/17 23:48:17     p_R[i] += a_R[c_i][i]
[smoove] 2019/03/17 23:48:17 IndexError: 
[smoove] 2019/03/17 23:48:17 list index out of range
```

Any thoughts as to what the issue might be? I ran into a conda/pyenv issue at the call step that I had to sort out, I am wondering if this might be a similar situation.

smoove can find all dependencies:

```
smoove version: 0.2.3

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools
 *[Y] svtyper
 *[Y] mosdepth [extra filtering of split and discordant files for better scaling]

  [Y] duphold [(optional) annotate calls with depth changes]
  [Y] svtools [only needed for large cohorts].
```

Thanks for your feedback!",Thatguy027,https://github.com/brentp/smoove/issues/62
MDU6SXNzdWU0MjIzMDg3MDk=,confusion with running ,CLOSED,2019-03-18T16:16:53Z,2019-03-20T17:25:57Z,2019-03-20T17:25:57Z,"Hi 
I am trying to run LUMPY and after hitting issues with lumpyexpress I wanted to try smoove. However, as I am running it I am not getting any results and the following console output: 

```
bethlett@dyn-144-92-95-223 LUMPY -> docker run -it brentp/smoove smoove call --name JERUSAM000000662737_dedup_recal --fasta ref/ARS-UCD1.2_Btau5.0.1Y.fa ./
[smoove] 2019/03/18 16:10:29 starting with version 0.2.3
panic: read ./: is a directory

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.check(...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7ffdaf8e4f71, 0x2, 0x9eb544, 0x2, 0x7ffdaf8e4f54, 0x1c, 0x0, 0x0, 0x0, 0x0, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:83 +0x134b
github.com/brentp/smoove/lumpy.Lumpy(0x7ffdaf8e4f2c, 0x1f, 0x7ffdaf8e4f54, 0x1c, 0x9eb544, 0x2, 0xc000178630, 0x1, 0x1, 0xc000182e60, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:119 +0x145
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:334 +0x277
main.main()
	/home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1d7

```
I have done export TMPDIR. I am unsure what the exact issue is. Any insight would be greatly appreciated. 

Thanks, 
Beth",bmlett,https://github.com/brentp/smoove/issues/63
MDU6SXNzdWU0MjMzODM0ODg=,"ENH: add annotation with gnomad, CCGD SVs",OPEN,2019-03-20T17:33:26Z,2019-03-20T17:33:26Z,,this can take CI into account and allow the user to know the population frequency of a given SV.,brentp,https://github.com/brentp/smoove/issues/64
MDU6SXNzdWU0MjU0ODM5NjE=,add AD field to output VCF,OPEN,2019-03-26T15:21:34Z,2019-03-26T15:21:34Z,,"currently the VCF still has AO, RO from svtyper. The spec now has AD as the field to store the ref and alt alleles.",brentp,https://github.com/brentp/smoove/issues/65
MDU6SXNzdWU0Mzg5NTM5MzA=,reclassify BNDs as DUP/DEL where appropriate,CLOSED,2019-04-30T20:04:44Z,2019-06-05T15:32:00Z,2019-06-05T15:32:00Z,"some variants are called as BNDs by lumpy but are clearly DELs (and I assume DUPs).
we can have smoove reclassify that changes BNDs to DEL/DUP given a sufficient change in DHFFC and proper supporting read orientations.
here is an example of a variant that I'd expect to be reclassified as DEL:
![image (3)](https://user-images.githubusercontent.com/1739/56990519-8555e500-6b52-11e9-969a-d193c423d3ab.png)
",brentp,https://github.com/brentp/smoove/issues/67
MDU6SXNzdWU0MzkxMjE2NzU=,Runtime Error - Index out of range,CLOSED,2019-05-01T10:16:50Z,2019-07-18T13:24:18Z,2019-05-02T20:29:10Z,"Hi Brent, 

Thanks for your work on Smoove, and other tools, it's much appreciated! I've got the following error with Smoove and was hoping you could give me a pointer or two as to anything I can do to identifiy the cause?

Any feel for if this could be a problem with the sample coming after 42-1.bam, or with 42-1.bam itself?

Ran Using Docker:
```
docker run -v /home/dnanexus/Working/:/home/ \
                -it brentp/smoove  smoove call -x \
                                               --name SmooveTest \
                                               --exclude /home/ceph18.b37.lumpy.exclude.2014-01-15.bed \
                                               --fasta /home/hs37d5.fa \
                                               -p 16 \
                                               --genotype `ls Bams/*.bam | awk '{print ""/home/""$0}' | tr '\n' ' '`
```

The following error comes through: 

```

[smoove] 2019/05/01 09:22:09 removed 5646407 alignments out of 9096282 (62.07%) with low mapq, depth > 1000, or from excluded chroms from 47-1.disc.bam in 595 seconds
[smoove] 2019/05/01 09:22:09 removed 615792 alignments out of 9096282 (6.77%) that were bad interchromosomals or flanked-splitters from 47-1.disc.bam
[smoove] 2019/05/01 09:22:10 removed 2277133 singletons and isolated interchromosomals of 2558025 reads (89.02%) from 11-1.disc.bam in 39 seconds
[smoove] 2019/05/01 09:22:10 280892 reads (3.23%) of the original 8700896 remain from 11-1.disc.bam
[smoove] 2019/05/01 09:22:12 removed 2267394 singletons and isolated interchromosomals of 3019582 reads (75.09%) from 42-1.disc.bam in 47 seconds
[smoove] 2019/05/01 09:22:12 752188 reads (8.81%) of the original 8536642 remain from 42-1.disc.bam
panic: runtime error: index out of range

goroutine 386439 [running]:
github.com/brentp/smoove/lumpy.countBases(0xc01b77f710, 0x2, 0x2, 0x7e, 0x2, 0x0, 0x72fd00)
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/badsplit.go:54 +0x152
github.com/brentp/smoove/lumpy.badSplitter(0xc1011e0840, 0xdc1200)
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/badsplit.go:121 +0x6e
github.com/brentp/smoove/lumpy.remove_sketchy(0xc0001a0be0, 0x11, 0x3e8, 0x7ffd9aa1cd87, 0xf, 0x7ffd9aa1cd51, 0x2d, 0xc000150480, 0x4, 0x4, ...)
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:293 +0x588
github.com/brentp/smoove/lumpy.remove_sketchy_all.func1(0xc0000a5e60, 0x3e8, 0x7ffd9aa1cd87, 0xf, 0x7ffd9aa1cd51, 0x2d, 0xc000150480, 0x4, 0x4, 0x1, ...)
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:373 +0x234
created by github.com/brentp/smoove/lumpy.remove_sketchy_all
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:371 +0x191
```

Cheers, Andrew",AndrewSkelton,https://github.com/brentp/smoove/issues/68
MDU6SXNzdWU0NDAxMDUyNjk=,Cannot run smoove from docker,CLOSED,2019-05-03T15:44:56Z,2019-05-04T07:53:39Z,2019-05-03T15:47:19Z,"Hello, I'm new to smoove. I've pulled the docker image and tried to run it locally.
That's an error as follows. But the ""missing file"" is obviously inside the same folder. Am I having a wrong syntax? Please kindly help. Thank you!

nelson@Ubuntu-testing ~/OPERATION/RedCellNGS/Processed_bam_vcf_1/bam

$ ls HBD1.bam
HBD1.bam
(base) 
nelson@Ubuntu-testing ~/OPERATION/RedCellNGS/Processed_bam_vcf_1/bam
$ docker run -it brentp/smoove smoove call -x --name RBC --fasta ~/OPERATION/RedCellNGS/ref/Homo_sapiens_assembly38.fasta -p 20 --genotype ./HBD1.bam
[smoove] 2019/05/03 15:41:35 starting with version 0.2.3
panic: open ./HBD1.bam: no such file or directory

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.check(...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7fffeab05f69, 0xa, 0x9eb544, 0x2, 0x7fffeab05f14, 0x43, 0x0, 0x0, 0x0, 0x0, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:83 +0x134b
github.com/brentp/smoove/lumpy.Lumpy(0x7fffeab05f08, 0x3, 0x7fffeab05f14, 0x43, 0x9eb544, 0x2, 0xc0000995d0, 0x1, 0x1, 0xc0001941e0, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:119 +0x145
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:334 +0x277
main.main()
	/home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1d7
(base) 
",nelsonchanhk,https://github.com/brentp/smoove/issues/69
MDU6SXNzdWU0NDAzNjg5NTc=,"Problem with ""missing pair end parameters:mean stdev""",OPEN,2019-05-04T20:39:11Z,2019-05-04T21:56:36Z,,"Hello, I have several BAMs from the same capture and pre-processing was the same for all of them. For some of the BAMs, they are fine with smoove but for some of them the follow error comes up. May I what's the problem? Thanks a lot!

[smoove] 2019/05/04 20:32:56 starting with version 0.2.3
[smoove] 2019/05/04 20:32:56 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2019/05/04 20:33:01 [lumpy_filter] extracted splits and discordants from 2581973 total aligned reads
[smoove]:2019/05/04 20:33:01 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/nelson/OPERATION/RedCellNGS/ref/Homo_sapiens_assembly38.fasta /home/n) in user-time:8.934404s system-time:1.509696s
[smoove] 2019/05/04 20:33:02 done calculating bam stats
[smoove] 2019/05/04 20:33:18 removed 8807 alignments out of 39644 (22.22%) with low mapq, depth > 1000, or from excluded chroms from 16H28412-3.split.bam in 16 seconds
[smoove] 2019/05/04 20:33:18 removed 2587 alignments out of 39644 (6.53%) that were bad interchromosomals or flanked-splitters from 16H28412-3.split.bam
[smoove] 2019/05/04 20:33:19 removed 24 singletons of 28250 reads (0.08%) from 16H28412-3.split.bam in 0 seconds
[smoove] 2019/05/04 20:33:19 28226 reads (71.20%) of the original 39644 remain from 16H28412-3.split.bam
[smoove] 2019/05/04 20:33:28 removed 61609 alignments out of 2554480 (2.41%) with low mapq, depth > 1000, or from excluded chroms from 16H28412-3.disc.bam in 25 seconds
[smoove] 2019/05/04 20:33:28 removed 1 alignments out of 2554480 (0.00%) that were bad interchromosomals or flanked-splitters from 16H28412-3.disc.bam
[smoove] 2019/05/04 20:33:41 removed 68 singletons and isolated interchromosomals of 2492870 reads (0.00%) from 16H28412-3.disc.bam in 13 seconds
[smoove] 2019/05/04 20:33:41 2492802 reads (97.59%) of the original 2554480 remain from 16H28412-3.disc.bam
[smoove] 2019/05/04 20:33:41 starting lumpy
[smoove] 2019/05/04 20:33:41 wrote lumpy command to /home/nelson/OPERATION/RedCellNGS/Processed_bam_vcf_1/smoove/16H28412-3-lumpy-cmd.sh
[smoove] 2019/05/04 20:33:41 writing sorted, indexed file to /home/nelson/OPERATION/RedCellNGS/Processed_bam_vcf_1/smoove/16H28412-3-smoove.genotyped.vcf.gz
[smoove] 2019/05/04 20:33:41 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2019/05/04 20:33:41 missing pair end parameters:mean stdev 

[smoove] 2019/05/04 20:33:41 Program: ********** (v 0.2.13)
Author:  Ryan Layer (rl6sf@virginia.edu)
Summary: Find structural variations in various signals.

Usage:   ********** [OPTIONS] 

Options: 
	-g	Genome file (defines chromosome order)
	-e	Show evidence for each call
	-w	File read windows size (default 1000000)
	-mw	minimum weight for a call
	-msw	minimum per-sample weight for a call
	-tt	trim threshold
	-x	exclude file bed file
	-t	temp file prefix, must be to a writeable directory
	-P	output probability curve for each variant
	-b	output BEDPE instead of VCF
	-sr	bam_file:<file name>,
		id:<sample name>,
		back_distance:<distance>,
		min_mapping_threshold:<mapping quality>,
[smoove] 2019/05/04 20:33:41 
		weight:<sample weight>,
		min_clip:<minimum clip length>,
		read_group:<string>

	-pe	bam_file:<file name>,
		id:<sample name>,
		histo_file:<file name>,
		mean:<value>,
		stdev:<value>,
[smoove] 2019/05/04 20:33:41 		read_length:<length>,
		min_non_overlap:<length>,
		discordant_z:<z value>,
		back_distance:<distance>,
		min_mapping_threshold:<mapping quality>,
[smoove] 2019/05/04 20:33:41 
		weight:<sample weight>,
		read_group:<string>

[smoove] 2019/05/04 20:33:41 	-bedpe	bedpe_file:<bedpe file>,
		id:<sample name>,
		weight:<sample weight>

[smoove] 2019/05/04 20:33:41 > gsort version 0.0.6
[smoove] 2019/05/04 20:33:48 2019/05/04 20:33:48 EOF
[smoove] 2019/05/04 20:33:48 Failed to open -: unknown file type
[smoove] 2019/05/04 20:33:48 Failed to open -: unknown file type
panic: exit status 255

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xa88960, 0xc0001bc140, 0x7fff3beabed6, 0x43, 0xc000190670, 0x1, 0x1, 0x7fff3beabe91, 0x3c, 0x7fff3beabe7d, ...)
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:226 +0x18c5
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:346 +0x468
main.main()
	/home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1d7",nelsonchanhk,https://github.com/brentp/smoove/issues/70
MDU6SXNzdWU0NDEyMzA0MTE=,panic: exit status 84 on lumpy_filter,CLOSED,2019-05-07T13:23:12Z,2019-05-07T13:30:41Z,2019-05-07T13:30:40Z,"Hello,

I am getting panic: exit status 84 in the lumpy_filter step (full error below). I am confident it is not due to disk space and/or the tmp dir.

Any help to fix the error will be much appreciated.

Thanks
Jorge

```
[smoove]:2019/05/07 11:40:30 error running command: set -eu; lumpy_filter -f genome.fa sample.bam sample/sample.split.bam.tmp.bam sample/sample.disc.bam.tmp.bam 2 && mv sample/sample.split.bam.tmp.bam sample/sample.split.bam && mv sample/sample.disc.bam.tmp.bam sample/sample.disc.bam && cp sample/sample.split.bam sample/sample.split.bam.orig.bam && cp sample/sample.disc.bam sample/sample.disc.bam.orig.bam -> exit status 84
panic: exit status 84

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.Lumpy(0x7ffee1d3d5f3, 0x24, 0x7ffee1d3d67a, 0x2a, 0x7ffee1d3d6bf, 0x24, 0xc00008d600, 0x1, 0x1, 0xc0001920a0, ...)
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:127 +0x5c9
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:334 +0x277
main.main()
	/home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1d7```",jazberna1,https://github.com/brentp/smoove/issues/71
MDU6SXNzdWU0NDc0MDU5NDQ=,smoove call ends earlier than expected,OPEN,2019-05-23T01:12:23Z,2019-05-30T16:06:13Z,,"Hi,
I am using smoove to call SVs in ~170 samples. I ran through the whole pipeline and the final ""square"" file only contains variants up to chr 2. I went back to check per-sample calls from the smoove call output and found 11 samples with calls only for the first few chromosomes. I thought this was odd because most of the other samples have calls ending at chromosome MT or Y. I checked the bam files for these samples using samtools quickcheck and samtools view and they appear fine to me, there are reads across the whole genome. 

I don't get any error messages for these samples. When I re-run the smoove call step for these 11 samples, the output looks something like this:

[smoove] 2019/05/23 00:22:36 starting with version 0.2.2
[smoove] 2019/05/23 00:22:36 calculating bam stats for 1 bams
[smoove] 2019/05/23 00:22:51 done calculating bam stats
[smoove] 2019/05/23 00:23:12 removed 0 alignments out of 255359 (0.00%) with low mapq, depth > 1000, or from excluded chroms from FD01115731.split.bam in 21 seconds
[smoove] 2019/05/23 00:23:12 removed 0 alignments out of 255359 (0.00%) that were bad interchromosomals or flanked-splitters from FD01115731.split.bam
[smoove] 2019/05/23 00:23:15 removed 0 alignments out of 525047 (0.00%) with low mapq, depth > 1000, or from excluded chroms from FD01115731.disc.bam in 24 seconds
[smoove] 2019/05/23 00:23:15 removed 0 alignments out of 525047 (0.00%) that were bad interchromosomals or flanked-splitters from FD01115731.disc.bam
[smoove] 2019/05/23 00:23:18 removed 0 singletons of 255359 reads (0.00%) from FD01115731.split.bam in 7 seconds
[smoove] 2019/05/23 00:23:18 255359 reads (100.00%) of the original 255359 remain from FD01115731.split.bam
[smoove] 2019/05/23 00:23:26 removed 1590 singletons and isolated interchromosomals of 525047 reads (0.30%) from FD01115731.disc.bam in 11 seconds
[smoove] 2019/05/23 00:23:26 523457 reads (99.70%) of the original 525047 remain from FD01115731.disc.bam
[smoove] 2019/05/23 00:23:26 starting lumpy
[smoove] 2019/05/23 00:23:26 wrote lumpy command to /scratch/skeldys/167_samples/smoove/results-smoove/FD01115731-lumpy-cmd.sh
[smoove] 2019/05/23 00:23:26 writing sorted, indexed file to /scratch/skeldys/167_samples/smoove/results-smoove/FD01115731-smoove.genotyped.vcf.gz
[smoove] 2019/05/23 00:23:26 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2019/05/23 00:23:27 1	1000000
[smoove] 2019/05/23 00:23:27 > gsort version 0.0.6
[smoove] 2019/05/23 00:23:29 2	1000000
[smoove] 2019/05/23 00:23:31 3	1000000
[smoove] 2019/05/23 00:23:34 4	1000000
[smoove] 2019/05/23 00:23:37 5
[smoove] 2019/05/23 00:23:37
[smoove] 2019/05/23 00:23:37 1000000
[smoove] 2019/05/23 00:23:37
[smoove] 2019/05/23 00:23:39 6
[smoove] 2019/05/23 00:23:39
[smoove] 2019/05/23 00:23:39 1000000
[smoove] 2019/05/23 00:23:39
[smoove] 2019/05/23 00:23:42 7	1000000
[smoove] 2019/05/23 00:25:51 wrote sorted, indexed file to /smoove/results-smoove/1115731-smoove.genotyped.vcf.gz

I checked the split/disc files created by smoove and it seems either 1 or both also end where the VCFs end, but I can't figure out why this is so. Any ideas? 

Thanks.",tracychew,https://github.com/brentp/smoove/issues/72
MDU6SXNzdWU0NTE2OTYyOTU=,smoove requires bash to be default SHELL. should just use bash instead of assuming.,OPEN,2019-06-03T21:24:21Z,2019-06-03T22:26:37Z,,"I just got smoove installed today and tried running it for the first time.  I downloaded some bam files and a reference from a galaxy history where I'd already analyzed SVs.  Here's what I see when I run smoove...

```
>smoove call --name testcb15 --removepr --duphold --fasta CB15_reference.fasta -p 1 --genotype --support 1 --noextrafilters Caulobacter_crescentus_strain_CB15.bam Caulobacter_spp.bam NA1000.bam
[smoove] 2019/06/03 17:16:31 starting with version 0.2.3
[smoove]: ([E]lumpy-filter) 2019/06/03 17:16:31 set: Variable name must begin with a letter.
[smoove]:2019/06/03 17:16:31 finished process: lumpy-filter (set -eu; lumpy_filter -f CB15_reference.fasta Caulobacter_crescentus_strain_CB15.bam .//Caulobacter_) in user-time:57.991ms system-time:52.991ms
[smoove]:2019/06/03 17:16:31 error running command: set -eu; lumpy_filter -f CB15_reference.fasta Caulobacter_crescentus_strain_CB15.bam .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.tmp.bam .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.tmp.bam 2 && mv .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.tmp.bam .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam && mv .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.tmp.bam .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam && cp .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.orig.bam && cp .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam .//Caulobacter_crescentus_strain_CB15_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.orig.bam -> exit status 1
[smoove]:([E]lumpy-filter) 2019/06/03 17:16:31 set: Variable name must begin with a letter.
[smoove]:2019/06/03 17:16:31 finished process: lumpy-filter (set -eu; lumpy_filter -f CB15_reference.fasta Caulobacter_spp.bam .//Caulobacter_spp_Demultiplexed-f) in user-time:62.99ms system-time:41.993ms
[smoove]:2019/06/03 17:16:31 error running command: set -eu; lumpy_filter -f CB15_reference.fasta Caulobacter_spp.bam .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.tmp.bam .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.tmp.bam 2 && mv .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.tmp.bam .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam && mv .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.tmp.bam .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam && cp .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.orig.bam && cp .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam .//Caulobacter_spp_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.orig.bam -> exit status 1
[smoove] 2019/06/03 17:16:31 calculating bam stats for 3 bams
[smoove]:([E]lumpy-filter) 2019/06/03 17:16:31 set: Variable name must begin with a letter.
[smoove]:2019/06/03 17:16:31 finished process: lumpy-filter (set -eu; lumpy_filter -f CB15_reference.fasta NA1000.bam .//NA1000_Demultiplexed-fastq-fileset-sampl) in user-time:60.99ms system-time:43.993ms
[smoove]:2019/06/03 17:16:31 error running command: set -eu; lumpy_filter -f CB15_reference.fasta NA1000.bam .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.tmp.bam .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.tmp.bam 2 && mv .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.tmp.bam .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam && mv .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.tmp.bam .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam && cp .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.split.bam.orig.bam && cp .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam .//NA1000_Demultiplexed-fastq-fileset-sample-20161014_GM3PlasmidPool-from-flowcell-000000000-ANC0P-on-2017-03-29_Read_passed_filter.disc.bam.orig.bam -> exit status 1
```",hepcat72,https://github.com/brentp/smoove/issues/73
MDU6SXNzdWU0NTI1NzAxNTg=,add score to prioritize BND variants,OPEN,2019-06-05T15:33:01Z,2019-06-05T15:33:01Z,,"duphold does well for annotating+prioritizing DUPs and DELs, we also need a way to prioritize BND variants.",brentp,https://github.com/brentp/smoove/issues/74
MDU6SXNzdWU0NTUxNjkyODk=,report error panic: open /store/gchen/smoove/100.bam: no such file or directory,CLOSED,2019-06-12T11:53:12Z,2019-06-13T03:18:43Z,2019-06-12T13:47:43Z,"![QQ截图20190612195218](https://user-images.githubusercontent.com/48479509/59349190-985ff580-8d4b-11e9-8f12-56fa84895e4f.png)
can you tell me how to solve it ,thank you very much!",ChenDepp,https://github.com/brentp/smoove/issues/75
MDU6SXNzdWU0NTYwMjc4Njk=,merge tissue,CLOSED,2019-06-14T02:07:15Z,2019-06-14T02:36:39Z,2019-06-14T02:36:28Z,"![QQ截图20190614095942](https://user-images.githubusercontent.com/48479509/59478497-0dd2df80-8e8c-11e9-8e92-a7d29547bbd6.png)
hello brentp!
    when i merge the vcf file,it report the error ,can you tell me how to solve it? thank your ",ChenDepp,https://github.com/brentp/smoove/issues/76
MDU6SXNzdWU0NTY2MDMyODU=,a question output of  smoove genotype command ,CLOSED,2019-06-16T05:15:59Z,2019-06-16T13:42:03Z,2019-06-16T13:42:03Z,"hello brentp!,
    when i running smoove genotype ,i get only  one output file ,it is true? ",chenBYR,https://github.com/brentp/smoove/issues/77
MDU6SXNzdWU0NTk0NDI0NDI=,smoove paste problem ,CLOSED,2019-06-22T06:17:35Z,2019-08-21T16:34:15Z,2019-08-21T16:34:15Z,"hello,brentp
      
![微信截图_20190622141325](https://user-images.githubusercontent.com/48479509/59960241-414ee300-94f8-11e9-82a8-75f6d5fdffb4.png)
    running the command smoove paste,the input file is the output file of smoove call? 
![微信截图_20190622141358](https://user-images.githubusercontent.com/48479509/59960250-7824f900-94f8-11e9-8ca9-76504de6d912.png)
",ChenDepp,https://github.com/brentp/smoove/issues/78
MDU6SXNzdWU0NjMyMjcyOTQ=,"samtools index: ""./out.bam"" is in a format that cannot be usefully indexed",CLOSED,2019-07-02T13:23:19Z,2019-07-02T13:24:49Z,2019-07-02T13:24:39Z,"Hi,

I want to delete a specific read in a BAM file, and I'm experiencing the following problem.
Starting from a very simple BAM file (attached):
```
$ samtools view toy.bam 
r1      0       chr1    7       30      8M4I4M1D3M      =       37      39      TTAGATAAAGAGGATACTG     *       XX:B:S,12561,2,20,112
x1      0       chr2    1       30      20M     *       0       0       AGGTTTTATAAAACAAATAA    ????????????????????
```

I use the following code:
```
import pysam

infile = './toy.bam'
outfile = './out.bam'

pysam.index(infile)  # this works as expected
align_file = pysam.AlignmentFile(infile, 'rb')

deleted = pysam.AlignmentFile(outfile, ""wb"", template=align_file)
for read in align_file.fetch():
    if read.query_name != 'x1':
        deleted.write(read)

pysam.index(outfile)
```
And I get:
```
Traceback (most recent call last):
  File ""cli.py"", line 14, in <module>
    pysam.index(outfile)
  File ""/usr/local/lib64/python3.6/site-packages/pysam/utils.py"", line 75, in __call__
    stderr))
pysam.utils.SamtoolsError: 'samtools returned with error 1: stdout=, stderr=samtools index: ""./out.bam"" is in a format that cannot be usefully indexed\n'
```

However:
```
$ samtools index out.bam
```
Works without any problem, giving me access to the indexed version of the file.

```
$ samtools idxstats out.bam 
chr1    100     1       0
chr2    100     0       0
*       0       0       0
```
I attach the code and the toy.bam file.
[issue.zip](https://github.com/brentp/smoove/files/3350243/issue.zip)

Thanks",marcomilanesio,https://github.com/brentp/smoove/issues/79
MDU6SXNzdWU0NzI3NzgzMjQ=,lumpy-filter: fail to open file,OPEN,2019-07-25T10:06:14Z,2019-07-30T09:53:07Z,,"Hello,

I'm executing `smoove call` to process a pair of WGS bam files. I'm following instructions provided in the documentation, however, the tool fails early when executing `lumpy-filter`:

```
[smoove] 2019/07/24 15:05:12 starting with version 0.2.3
[smoove] 2019/07/24 15:05:12 calculating bam stats for 2 bams
[smoove]: ([E]lumpy-filter) 2019/07/24 15:05:12 [E::hts_open_format] fail to open file '/scratch/3/dortiz/EGA/MELA-AU/tests/lumpy_smoove_test/smoove/http://purl.org/net/grafli/collectedsample#24fed977-8b67-43ca-8b2b-31be4dd47243.disc.bam.tmp.bam'
[smoove]: ([E]lumpy-filter) 2019/07/24 15:05:12 [E::hts_open_format] fail to open file '/scratch/3/dortiz/EGA/MELA-AU/tests/lumpy_smoove_test/smoove/http://purl.org/net/grafli/collectedsample#24fed977-8b67-43ca-8b2b-31be4dd47243.split.bam.tmp.bam'
[smoove]:([E]lumpy-filter) 2019/07/24 15:05:12 [E::hts_open_format] fail to open file '/scratch/3/dortiz/EGA/MELA-AU/tests/lumpy_smoove_test/smoove/http://purl.org/net/grafli/collectedsample#681e2301-2057-40e4-ab63-934775d63faa.disc.bam.tmp.bam'
[smoove]:([E]lumpy-filter) 2019/07/24 15:05:12 [E::hts_open_format] fail to open file '/scratch/3/dortiz/EGA/MELA-AU/tests/lumpy_smoove_test/smoove/http://purl.org/net/grafli/collectedsample#681e2301-2057-40e4-ab63-934775d63faa.split.bam.tmp.bam'
[smoove]:([E]lumpy-filter) 2019/07/24 15:05:12 /bin/bash: line 1: 72939 Segmentation fault      lumpy_filter -f /scratch/3/dortiz/EGA/MELA-AU/tests/lumpy_smoove_test/data/genref.fa data/tumor.bam /scratch/3/dortiz/EGA/MELA-AU/tests/lumpy_smoove_test/smoove/http://purl.org/net/grafli/collectedsample#681e2301-2057-40e4-ab63-934775d63faa.split.bam.tmp.bam /scratch/3/dortiz/EGA/MELA-AU/tests/lumpy_smoove_test/smoove/http://purl.org/net/grafli/collectedsample#681e2301-2057-40e4-ab63-934775d63faa.disc.bam.tmp.bam 2
...
```
I've found that the directories causing the problems contain a string appearing in the header of the bam files I need to process. Here I show some lines of the bam files:
```
...
@RG     ID:306bc1e3-5a46-41e6-b8a2-246773607c65 zc:0:/mnt/lustre/working/genomeinfo/data/20160328_Melanoma/MELA_0257/seq_final/Melanoma_MELA0257_1DNA_16TumourMetastasisToDistantLocation_EXTERNMELA20140924121_Unknown0_NoCapture_Bwa_HiSeq/306bc1e3-5a46-41e6-b8a2-246773607c65.aln.bam       SM:http://purl.org/net/grafli/collectedsample#681e2301-2057-40e4-ab63-934775d63faa
@RG     ID:b16137c7-21a4-495e-b5ca-ac256f6c3bc4 zc:1:/mnt/lustre/working/genomeinfo/data/20160328_Melanoma/MELA_0257/seq_final/Melanoma_MELA0257_1DNA_16TumourMetastasisToDistantLocation_EXTERNMELA20140924121_Unknown0_NoCapture_Bwa_HiSeq/b16137c7-21a4-495e-b5ca-ac256f6c3bc4.aln.bam       SM:http://purl.org/net/grafli/collectedsample#681e2301-2057-40e4-ab63-934775d63faa
...
```
Thanks in advance for your help.",daormar,https://github.com/brentp/smoove/issues/80
MDU6SXNzdWU0NzU1ODg3MzU=,BND,CLOSED,2019-08-01T09:57:50Z,2019-08-13T13:56:34Z,2019-08-13T13:56:33Z,"Hello, I am a newcomer to smoove, it is a good tool. When I was using smoove call, I couldn't understand the results it returned to me. What does BND mean?

#CHROM POS ID REF ALT QUAL FILTER INFO FORMAT T1 N1
Chr1 216981736 38_1 N ]CHR2:63550226]N 105.51 . SVTYPE=BND;STRANDS=- :6;IMPRECISE;CIPOS=-10,9;CIEND=-9,8;CIPOS95=0,0;CIEND95=-1,1 ;MATEID=38_2;EVENT=38;SU=6;PE=2;SR=4;PRPOS=9.5249e-17,3.79675e-15,1.51329e-13,6.03128e-12,2.4039e-10,9.58017e -09,3.81765e-07,1.52142e-05,0.00060631,0.024163,0.961958,0.0130764,0.000177755,2.41633e-06,3.28465e-08,4.46502e-10,6.06955e-12,8.25068e-14,1.12156e -15,1.5246e-17;PREND=4.20369e-16,3.09242e-14,2.27491e-12,1.67352e-10,1.23111e-08,9.05658e-07,6.66241e-05,0.00490115,0.265233,0.360357 ,0.36017,0.0090376,0.000226787,5.69068e-06,1.42791e-07,3.58284e-09,8.98915e-11,2.25528e-12;AC=1;AN=4 GT:GQ:SQ:GL:DP:RO :AO:QR:QA:RS:AS:ASC:RP:AP:AB 0/1:3:103.47:-11,-1,-1:9:3:5:2:4:1:3:0 :1:1:0.67 0/0:3:2.04:-0,-0,-1:2:2:0:1:0:0:0:0:1:0:0

Chr10 61190401 76_1 N N[CHR16:69581033[ 0 . SVTYPE=BND;STRANDS= -:6;CIPOS=-8,8;CIEND=-10,9;CIPOS95=0,0;CIEND95=0,0;MATEID= 76_2; EVENT=76; SU=6; PE=2; SR=4; PRPOS=2.04952e-15, 1.50771e-13, 1.10914e-11, 8.15928e-10, 6.00231e-08, 4.41556e-06, 0.000324827,0.0238956,0.95129,0.0238702,0.000598978,1.503e-05,3.77168e-07,9.46407e-09,2.3745e-10,5.95779e-12,1.49477e-13;PREND=9.5249e-17,3.79675e- 15,1.51329e-13,6.03128e-12,2.4039e-10,9.58017e-09,3.81765e-07,1.52142e-05,0.00060631,0.024163,0.961958,0.0130764,0.000177755,2.41633e-06,3.28465e- 08,4.46502e-10,6.06955e-12,8.25068e-14,1.12156e-15,1.5246e-17;AC=2;AN=2 GT:GQ:SQ:GL:DP:RO:AO:QR: QA: RS: AS: ASC: RP: AP: AB 1/1: 2: 31.46: -3, -0, -0: 2:0:1:0:1:0:0:0:0:1: 1 ./.:.:.:.:0:0:0:0:0:0:0:0:0:0:.

What do “] CHR2:63550226]N” and “N[CHR16:69581033[” in these two examples stand for?
And what does normal GT=./. mean?
I hope to get your help, thank you.",tyyiyi,https://github.com/brentp/smoove/issues/81
MDU6SXNzdWU0Nzk4NDkyMzM=,"error message ""couldn't get region from line""",CLOSED,2019-08-12T21:03:14Z,2019-08-13T15:48:33Z,2019-08-13T13:55:21Z,"Hi Guys,
   I am using smoove recently on targeted DNAseq files.

My code: 
smoove call -x \
--name Lumpy \
--outdir $out \
--exclude $ExcludeBed \
--fasta $hg19_fasta \
-p 1 \
--genotype $testBam

Output file:
[smoove] 2019/08/08 18:37:57 starting with version 0.2.3
[smoove] 2019/08/08 18:37:57 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2019/08/08 18:39:18 [lumpy_filter] extracted splits and discordants from 2564470 total aligned reads
[smoove]:2019/08/08 18:39:18 finished process: lumpy-filter (set -eu; lumpy_filter -f /bgfs/soesterreich/pan_data/soesterreich/Tendo/Projects/Project2_cfDNA_fusi) in user-time:1m42.137273s system-time:12.3704s
[smoove] 2019/08/08 18:42:52 done calculating bam stats
2019/08/08 18:43:12 couldn't get region from line

Does anybody know what kind of error is this and how to fix it?
Appreciate it a lot.


[Lumpy.txt](https://github.com/brentp/smoove/files/3494336/Lumpy.txt)
[LumpyOut.txt](https://github.com/brentp/smoove/files/3494337/LumpyOut.txt)

",TendoLiu,https://github.com/brentp/smoove/issues/82
MDU6SXNzdWU0ODAwMTM5NDM=,RG handeling ,CLOSED,2019-08-13T08:00:19Z,2019-08-16T07:00:01Z,2019-08-13T13:54:41Z,"So, I have multiple samples with multiple lanes and libraries - some samples just have a simple design: one lane or more lanes. 

```
@RG ID:FLOWCELL1.LANE1  PL:ILLUMINA LB:Lib1 SM:Sample1
@RG ID:FLOWCELL1.LANE2  PL:ILLUMINA LB:Lib1 SM:Sample1
```

Some samples have a more complex design: multiple libraries with different insert sizes with multiple lanes each. 

```
@RG ID:FLOWCELL1.LANE1  PL:ILLUMINA LB:Lib1 SM:Sample2
@RG ID:FLOWCELL1.LANE2  PL:ILLUMINA LB:Lib2 SM:Sample2
@RG ID:FLOWCELL1.LANE3  PL:ILLUMINA LB:Lib2 SM:Sample2
``` 

I have mapped each read group separately with `bwa mem -M -R` and defined the read groups as well as I could (it's public data) in the bam file, resulting in 

```
FLOWCELL1.LANE1.sample1.bam
FLOWCELL1.LANE2.sample1.bam
FLOWCELL1.LANE1.sample2.bam
FLOWCELL1.LANE2.sample2.bam
FLOWCELL1.LANE3.sample2.bam
```

Then I've fed the bam files that belong to the same individual sample to MarkDuplicates which not only marks the duplicates but also merges the bam file (keeping the RG tags). So I now have 

```
sample1.bam
sample2.bam
```

In this [thread](https://github.com/arq5x/lumpy-sv/issues/312) you mentioned I should try smoove and do the following steps when using smoove. 

> Then
> - call each sample separately
> - merge the calls into one set of SV sites
> - genotype those sites for each sample

So how do I go about this now concerning different RG? 
In the other thread you also mentioned that I should NOT merge things. 
> Each “-pe” will get its own histogram, so separating out the different libraries with different properties is a good move. Do not merge thing back together. Each sample should have its down “-pe” and “-sr”.

I am not merging anything across samples. I am only merging RGs that belong to the same sample (multiple libs and lanes). But yes - in some cases I do merge different libs but from the same biosample (it's SRA data). 

If I understood correctly, I cannot feed in the merged bam files (I created them as GATK needs that in contrast) but the individual RG level bam files. So, I feed all the RG level bam files over all samples to smoove in one go? (I have a small cohort (way below 40 samples)).

`smoove call -x --name my-cohort --exclude $bed --fasta $fasta -p $threads --genotype /path/to/*.bam`

so *.bam would be

```
FLOWCELL1.LANE1.sample1.bam
FLOWCELL1.LANE2.sample1.bam
FLOWCELL1.LANE1.sample2.bam
FLOWCELL1.LANE2.sample2.bam
FLOWCELL1.LANE3.sample2.bam
```

 Does the tool recognise the different RG belonging to the same sample and then produces a multi-sample file containing only sample 1 and sample 2 (and not the RG levels)? 

Sorry for the long post... 
Thanks so much!! I very much appreciate your help!
",JJBio,https://github.com/brentp/smoove/issues/83
MDU6SXNzdWU0ODE3MDEyNzk=,Docker update?,CLOSED,2019-08-16T17:05:39Z,2019-08-17T03:43:10Z,2019-08-17T01:39:19Z,"The smoove docker release is really helpful. Is this going to be updated going forward? I just checked https://hub.docker.com/r/brentp/smoove and it looks like this is still on v0.2.3. Thanks!

",ctsa,https://github.com/brentp/smoove/issues/84
MDU6SXNzdWU0ODI5NzUxMTI=,docker image python version conflict,CLOSED,2019-08-20T16:56:47Z,2019-08-21T21:22:23Z,2019-08-21T17:39:06Z,"I'm running smoove using the docker image (pulled yesterday), and there seems to be a problem with conflicting python versions when running svtyper. This may be a problem with svtyper rather than the docker image, but I still wanted to let you know about it.

Command (from within docker image):
```
smoove call -x --name [name] --fasta ref.fa -p 16 --genotype [a bunch of bams]
```

Output:
```
...
[smoove] 2019/08/19 23:33:36 Traceback (most recent call last):
    File ""/usr/local/bin/svtyper"", line 11, in <module>
      load_entry_point('svtyper==0.7.0', 'console_scripts', 'svtyper')()
    File ""/usr/local/lib/python3.7/dist-packages/pkg_resources/__init__.py"", line 489, in load_entry_point
      return get_distribution(dist).load_entry_point(group, name)
    File ""/usr/local/lib/python3.7/dist-packages/pkg_resources/__init__.py"", line 2852, in load_entry_point
      return ep.load()
    File ""/usr/local/lib/python3.7/dist-packages/pkg_resources/__init__.py"", line 2443, in load
      return self.resolve()
    File ""/usr/local/lib/python3.7/dist-packages/pkg_resources/__init__.py"", line 2449, in resolve
      module = __import__(self.module_name, fromlist=['__name__'], level=0)
    File ""<frozen importlib._bootstrap>"", line 983, in _find_and_load
    File ""<frozen importlib._bootstrap>"", line 963, in _find_and_load_unlocked
    File ""<frozen importlib._bootstrap>"", line 906, in _find_spec
    File ""<frozen importlib._bootstrap_external>"", line 1280, in find_spec
    File ""<frozen importlib._bootstrap_external>"", line 1254, in _get_spec
    File ""<frozen importlib._bootstrap_external>"", line 1235, in _legacy_get_spec
    File ""<frozen importlib._bootstrap>"", line 441, in spec_from_loader
    File ""<frozen importlib._bootstrap_external>"", line 594, in spec_from_file_location
    File ""/usr/local/lib/python3.7/dist-packages/svtyper-0.7.0-py3.7.egg/svtyper/classic.py"", line 416
      print '--------------------------'
                                       ^
  SyntaxError: Missing parentheses in call to 'print'. Did you mean print('--------------------------')?
  panic: exit status 1
```",esrice,https://github.com/brentp/smoove/issues/85
MDU6SXNzdWU0ODQ3NjkxNzA=,redo SHQ,OPEN,2019-08-24T02:43:13Z,2019-08-24T02:43:13Z,,SHQ was written before duphold existed an it is much less reliable. should look into this again and use extra annotations to override duphold in rare cases.,brentp,https://github.com/brentp/smoove/issues/86
MDU6SXNzdWU0OTc1MzQxOTI=,svtyper missing in Docker image,CLOSED,2019-09-24T08:22:20Z,2019-10-15T14:57:36Z,2019-10-15T14:57:35Z,"svtyper is not in the Docker image. 

from brentp/smoove :

root@e825e74f3bd9:/# smoove 
smoove version: 0.2.4

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools
 *[ ] svtyper
 *[Y] mosdepth [extra filtering of split and discordant files for better scaling]
",calkan,https://github.com/brentp/smoove/issues/87
MDU6SXNzdWU0OTc2NjIwMzA=,docker merged层的目录损坏无法访问,CLOSED,2019-09-24T12:39:02Z,2019-11-12T18:20:12Z,2019-11-12T18:20:12Z,"访问损坏的目录提示：No such file or dir 
在容器层目录和镜像层目录都能够 正确访问，但是镜像挂载层无法访问。
重启docker之后损坏的目录在容器里可以被访问到。
",pengmhm,https://github.com/brentp/smoove/issues/88
MDU6SXNzdWU1MDUxMDMwMzI=,WES,CLOSED,2019-10-10T07:59:45Z,2019-10-10T15:59:20Z,2019-10-10T15:59:20Z,"Hi, I am using smoove to call SVs. I have about 50 samples, which are tumor-normal pairs of human. Their sequencing depth is about 500X, which is Whole-exome sequencing. I want to know if I can use smoove to call SVs on my data. Do I need to add -x to exclude locations other than Whole-exome sequencing?
smoove call --outdir $output --name $fname --exclude $noexonic --fasta $ref -p 1 --genotype $tumor.sorted.bam $normal.sorted.bam",tyyiyi,https://github.com/brentp/smoove/issues/89
MDU6SXNzdWU1MTE0OTg5MTA=,Unknown error when running smoove docker file.,CLOSED,2019-10-23T18:31:44Z,2019-10-23T19:02:03Z,2019-10-23T19:02:03Z,"testbam=/bgfs/soesterreich/pan_data/soesterreich/Tendo/Projects/Project2_cfDNA_fusion_capture/SecondPanel/0_Illumina_UMI_Error_Corrected_bam/Sample1.collapsed.bam

out=/bgfs/soesterreich/pan_data/soesterreich/Tendo/Projects/Project2_cfDNA_fusion_capture/SecondPanel/1_SVcalling/Lumpy/Results/

ExcludeBed=/bgfs/soesterreich/pan_data/soesterreich/Tendo/InstalledTools/Smoove/ceph18.b37.lumpy.exclude.2014-01-15.bed

#################### Run package ####################
Command line:
singularity exec -B /bgfs:/bgfs /ihome/crc/install/smoove/smoove_v0.2.3.img \
smoove call -x \
--name Lumpy \
--outdir $out \
--exclude $ExcludeBed \
--fasta $hg19_fasta \
-p 1 \
--genotype $testbam


Error: 
[smoove] 2019/10/23 18:25:43 done calculating bam stats
[smoove] 2019/10/23 18:25:44 removed 0 alignments out of 98 (0.00%) with low mapq, depth > 1000, or from excluded chroms from Sample1.disc.bam in 1 seconds
[smoove] 2019/10/23 18:25:44 removed 1 alignments out of 98 (1.02%) that were bad interchromosomals or flanked-splitters from Sample1.disc.bam
[smoove] 2019/10/23 18:25:44 removed 1 singletons and isolated interchromosomals of 97 reads (1.03%) from Sample1.disc.bam in 0 seconds
[smoove] 2019/10/23 18:25:44 96 reads (97.96%) of the original 98 remain from Sample1.disc.bam
[smoove] 2019/10/23 18:25:44 removed 0 alignments out of 0 (NaN%) with low mapq, depth > 1000, or from excluded chroms from Sample1.split.bam in 0 seconds
[smoove] 2019/10/23 18:25:44 removed 0 alignments out of 0 (NaN%) that were bad interchromosomals or flanked-splitters from Sample1.split.bam
[smoove] 2019/10/23 18:25:44 removed 0 singletons of 0 reads (NaN%) from Sample1.split.bam in 0 seconds
[smoove] 2019/10/23 18:25:44 0 reads (NaN%) of the original 0 remain from Sample1.split.bam
[smoove] 2019/10/23 18:25:44 starting lumpy
[smoove] 2019/10/23 18:25:44 wrote lumpy command to /bgfs/soesterreich/pan_data/soesterreich/Tendo/Projects/Project2_cfDNA_fusion_capture/SecondPanel/1_SVcalling/Lumpy/Results//Lumpy-lumpy-cmd.sh
[smoove] 2019/10/23 18:25:44 writing sorted, indexed file to /bgfs/soesterreich/pan_data/soesterreich/Tendo/Projects/Project2_cfDNA_fusion_capture/SecondPanel/1_SVcalling/Lumpy/Results/Lumpy-smoove.genotyped.vcf.gz
[smoove] 2019/10/23 18:25:44 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2019/10/23 18:25:45 chr6	1000000
chr6	2000000
chr6	4000000
chr6	8000000
chr6	16000000
chr6	32000000
chr6	64000000
chr6	128000000
chr6	256000000
[smoove] 2019/10/23 18:25:45 chr17	1000000
chr17	
[smoove] 2019/10/23 18:25:45 2000000
chr17	4000000
chr17	8000000
chr17	16000000
chr17	32000000
chr17	64000000
[smoove] 2019/10/23 18:25:45 > gsort version 0.0.6
[smoove] 2019/10/23 18:25:50 2019/10/23 18:25:50 EOF
[smoove] 2019/10/23 18:25:50 Failed to open -: unknown file type
[smoove] 2019/10/23 18:25:50 Failed to open -: unknown file type
panic: exit status 255

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xa88960, 0xc00000c118, 0x7ffd568659a0, 0x60, 0xc00016a670, 0x1, 0x1, 0x7ffd568658a4, 0x7c, 0x7ffd56865895, ...)
	/home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:226 +0x18c5
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:346 +0x468
main.main()",TendoLiu,https://github.com/brentp/smoove/issues/91
MDU6SXNzdWU1MTIwMzI0NDM=,slow samples,CLOSED,2019-10-24T15:49:27Z,2019-11-12T18:19:52Z,2019-11-12T18:19:52Z,"for low quality samples, smoove call can be quite slow. this is driven by the current method for finding isolated signals.

needs to be changed to use this: https://github.com/kyroy/kdtree",brentp,https://github.com/brentp/smoove/issues/92
MDU6SXNzdWU1MTUyMjc2MTQ=,question about  ”run cnvnator in parallel”？,CLOSED,2019-10-31T07:40:02Z,2019-10-31T12:13:26Z,2019-10-31T12:13:25Z,"Hi, dear brentp,
 I have run the ""smoove call"" with 8 samples. This is a small cohorts. I don't know the meaning about the  ""cnvnator    : run cnvnator in parallel"" and ""hipstr      : run hipSTR in parallel""; Could I run ""smoove cnvnator -f ... bam bam bam"" instead of running the  CNVNator pipline?

And, I could run the ""smoove cnvnator "" directly ? Without another steps?

Thank you very much
Zhangyi",zyworship,https://github.com/brentp/smoove/issues/93
MDU6SXNzdWU1MjE2ODk2ODY=,create tagged release on hub.docker for v0.2.5,CLOSED,2019-11-12T17:23:09Z,2019-11-12T17:46:29Z,2019-11-12T17:46:29Z,:whale:,brwnj,https://github.com/brentp/smoove/issues/94
MDU6SXNzdWU1MjQ1MDExNDc=,Higher heterozygosity than expected,OPEN,2019-11-18T17:10:33Z,2019-11-18T18:43:11Z,,"My results are giving higher heterozygosity that I expected. I am working with a selfing plant species (rice). I am genotyping with the population genotyper method in the lumpy pipeline (svtyper). All my samples have >10x sequencing coverage.  As far as I can tell svtyper was developed for use in humans, and therefore has a prior set for human rates of heterozygosity. Is there any recommendation for how to use svtyper with inbred individuals? Is it it possible to change the prior? I am planning to assume all heterozygous calls to be alternates but was curious if you'd have any suggestions for this problem. ",zlye,https://github.com/brentp/smoove/issues/95
MDU6SXNzdWU1Mjg2MDUyMDc=,SU change after SVtyper,OPEN,2019-11-26T09:45:22Z,2019-11-26T13:59:37Z,,"Hi, could you please help me understanding how SU is counted in Lumpy and SVtyper?

I run smoove with the following steps:
1. samblaster -> 2.smoove call -> 3.smoove merge -> 4.smoove genotype ->5.smoove paste

I was inspecting output file from ""smoove paste"" step to see what is the minimum SU to call SVs. 
In my data, the minimum seems like SU=4 (i.e. PE=3, SR=1, or PE=4, SR=0).
##The example is:
chr6    37085977        7483    N       <DEL>   812.44  .       SVTYPE=DEL;SVLEN=-707;END=37086684;STRANDS=+-:4;IMPRECISE;CIPOS=-30,705;CIEND=-619,29;CIPOS95=-5,243;CIEND95=-203,7;SU=4;PE=4;SR=0;GCF=0.514124;SNAME=sample_1:1671;ALG=PROD;AN=6;AC=3        GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB:DHFC:DHFFC:DHBFC:DHSP     0/1:157:812.44:-82,-1,-17:71:36:35:35:34:13:0:7:22:27:0.49:0:0:0:44     0/1:86:86.53:-18,-10,-50:73:61:11:61:10:23:0:0:38:10:0.14:0.461538:0.428571:0.571429:21  0/1:200:341.46:-39,-5,-40:78:58:19:57:19:20:0:3:37:16:0.25:0.407407:0.354839:0.478261:26


Then, I checked this site in the individual vcf files from ""2.smoove call"" step.
This is the site from sample_1:
chr6    37085977        1671    N       <DEL>   812.44  .       SVTYPE=DEL;SVLEN=-707;END=37086684;STRANDS=+-:4;IMPRECISE;CIPOS=-30,705;CIEND=-619,29;CIPOS95=-5,243;CIEND95=-203,7;SU=4;PE=4;SR=0;PRPOS=(too long to paste all the PRPOS values, so I skip) AC=1;AN=2;GCF=0.514124     GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB:DHFC:DHFFC:DHBFC:DHSP      0/1:157:812.44:-82,-1,-17:71:36:35:35:34:13:0:7:22:27:0.49:0:0:0:44
The other two samples do not have this site called.

My questions are: 
1.
This site was detected by one sample based on SU=4 (PE=4, SR=0) and AP was 22. To my understanding, in an individual vcf file, generated from ""smoove call"", PE and AP should be the same or the difference should not be this large. Or am I getting something wrong here?

2.
For the site I showed above, SVTyper gave 0/1 to the other two samples as well. Yet SU is still SU=4 in the population vcf. Then how does SVtyper genotyped without collecting any SU from the two samples?

3. 
When I look at the site using igv, giving disc.bams and split.bams as input, I see the following:
![image](https://user-images.githubusercontent.com/23212146/69617507-9ad3b480-1038-11ea-910c-67e2e4ef97a5.png)
So, actually sample 2 and sample 3 seem to have PEs that support this site. I am puzzled why these reads are not counted by SVtyper.

Thanks a lot in advance for your comments! :)

Lim
",lee039,https://github.com/brentp/smoove/issues/96
MDU6SXNzdWU1MzE1NDg5MzI=,Too many samples to use smoove merge,OPEN,2019-12-02T21:25:24Z,2019-12-03T10:48:13Z,,"Hi, 

I use smoove to call SVs in a population of ~ 1400 subjects.
At the ""smoove merge"" step I get an error ""argument list too long""
Is there a way to give a file containing the path to the vcf files to merge? (I have not found it in the doc nor in the -h)

Best
Amaury",avaysse,https://github.com/brentp/smoove/issues/97
MDU6SXNzdWU1MzE1NTQ1NDM=,pass smoove split and disc bams from samblaster,CLOSED,2019-12-02T21:36:33Z,2019-12-02T22:58:02Z,2019-12-02T22:58:02Z,"Hi Brent,

Thanks so much for smoove! Is it possible to directly pass smoove split and disc bams out of samblaster, similar to lumpyExpress?

Thanks!

Ben",biobenkj,https://github.com/brentp/smoove/issues/98
MDU6SXNzdWU1MzU2OTY4NDI=,error can't find hipstr executable,OPEN,2019-12-10T12:25:55Z,2019-12-10T16:33:03Z,,"Hi there,

I'm trying to use hipSTR using smoove using docker, like that:

`smoove hipstr --regions /data/GRCh38.hipstr_reference.bed --fasta /reference/hg38.fasta /data/x.hg38.bam`

but I got:
```
[smoove] 2019/12/10 12:22:23 starting with version 0.2.5
panic: error can't find hipstr executable

goroutine 1 [running]:
github.com/brentp/smoove/hipstr.HipStr(0xc000185580, 0xbd6ea0, 0xc0001855c0)
        /home/brentp/go/go/src/github.com/brentp/smoove/hipstr/hipstr.go:118 +0x1b3
github.com/brentp/smoove/hipstr.Main()
        /home/brentp/go/go/src/github.com/brentp/smoove/hipstr/hipstr.go:35 +0x17d
main.main()
        /home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1ce
```

Is hipSTR not included in the docker image on purpose or do I miss something?

I use `brentp/smoove` docker image.

",znikasz,https://github.com/brentp/smoove/issues/99
MDU6SXNzdWU1NDYxNTc2NTk=,How to distinguish between INV and BND,OPEN,2020-01-07T08:52:17Z,2020-01-07T14:18:08Z,,"Hi, I am using smoove to call SVs.
I want to know why some mutations in the chromosome are INV and some are BND. There are some results, for example:

chr2 29225539 471_1 N N] CHR2: 42271404] 2064.84. SVTYPE = BND; STRANDS = ++: 80; CIPOS = 0,0; CIEND = 0,0; CIPOS95 = 0,0; CIEND95 = 0,0; MATEID = 471_2 ; EVENT = 471; SU = 80; PE = 41; SR = 39; PRPOS = 1; PREND = 1; AC = 1; AN = 4 GT: GQ: SQ: GL: DP: RO: AO: QR: QA: RS: AS: ASC: RP: AP: AB 0/1: 200: 2064.84: -215, -8, -118: 294: 194: 99: 193: 98: 112: 39: 0: 81: 59: 0.34 0 / 0: 200: 0: -0, -74, -247: 248: 248: 0: 247: 0: 138: 0: 0: 109: 0: 0

chr2 42271404 471_2 N N] CHR2: 29225539] 2064.84. SVTYPE = BND; STRANDS = ++: 80; CIPOS = 0,0; CIEND = 0,0; CIPOS95 = 0,0; CIEND95 = 0,0; MATEID = 471_1 ; EVENT = 471; SECONDARY; SU = 80; PE = 41; SR = 39; PRPOS = 1; PREND = 1; AC = 1; AN = 4 GT: GQ: SQ: GL: DP: RO: AO: QR: QA: RS: AS: ASC: RP: AP: AB 0/1: 200: 2064.84: -215, -8, -118: 294: 194: 99: 193: 98: 112: 39: 0: 81: 59: 0.34 0/0: 200: 0: -0, -74, -247: 248: 248: 0: 247: 0: 138: 0: 0: 109: 0: 0

Isn't it an inversion? How does smoove decide that a mutation similar to this is BND instead of INV? And when I used Delly, I encountered this mutation, but it reported INV.

chr2 29225539 INV00001098 G <INV>. PASS PRECISE; SVTYPE = INV; SVMETHOD = EMBL.DELLYv0.8.1; CHR2 = chr2; END = 42271405; PE = 60; MAPQ = 60; CT = 3to3; CIPOS = -3,3; CIEND = -3,3; SRMAPQ = 60; INSLEN = 0; HOMLEN = 2; SR = 20; SRQ = 0.995455; CONSENSUS = GGAGTCCCTGGGGCTCTGTGCACTCACCAATCATGATGCCGGAGAAAGCCAGGACCAGGGCGGCCACGAGGGCAGAGGTCACCACAGAGAGGATCAGCGAGAGTGGTAGAGGAAAGGTCCCCTTTTTTGGGTCTCCTTTTAAAATACAGATGGCGAGACCAGCGGCCTGGCGGGCCTGCTGTCCTTGGCAGTGCCTTCTCTACCCTCTTAAATAAAATAA; CE = 1.985; RDRATIO = 0.804132; SOMATIC GT: GL: GQ: FT: RCL: RC: RCR: CN: DR: DV: RR: RV 0/1: -192.382,0, -198.582: 10000: PASS: 407784: 264216: 188845: 1: 71: 60: 61: 60 0/0: 0, -22.5654, -278.288: 10000: PASS: 334062: 279857: 174108: 1: 95: 0: 75: 0

Can you give me some instructions?  I'm confused about this.
Thank you！
tang",tyyiyi,https://github.com/brentp/smoove/issues/100
MDU6SXNzdWU1NDcyMjA0NTM=,[E]lumpy-filter,OPEN,2020-01-09T03:06:36Z,2024-06-02T03:03:39Z,,"Hi, I use multi-sample to call SVs just like:
~~~
$ smoove call -x --name my_sv --exclude ceph18.b37.lumpy.exclude.2014-01-15.bed --fasta ucsc.hg19.fasta -p 12 --genotype sample1.sorted.merged.markdup.bam sample2.sorted.merged.markdup.bam sample3.sorted.merged.markdup.bam
~~~
and something wrong:
...
[smoove]: ([E]lumpy-filter) 2020/01/09 02:51:37 [lumpy_filter] extracted splits and discordants from 507593409 total aligned reads
...
[smoove]:([E]lumpy-filter) 2020/01/09 02:51:58 [lumpy_filter] extracted splits and discordants from 549288136 total aligned reads
...
[smoove]:([E]lumpy-filter) 2020/01/09 02:52:17 [lumpy_filter] extracted splits and discordants from 556449148 total aligned reads
",tongshiyuan,https://github.com/brentp/smoove/issues/101
MDU6SXNzdWU1NTY3OTc3NTU=,lumpy_filter seeks for libcrypto on the system lib PATH insted of LD_LIBRARY_PATH,CLOSED,2020-01-29T11:21:00Z,2020-01-29T14:12:51Z,2020-01-29T14:12:51Z,"Hi, 
I am struggling to get smoove to run (openSUSE 15.0, install with all dependencies via conda in a separate env);
The error is on the lumpy_filter step:

[smoove]:([E]lumpy-filter) 2020/01/29 12:06:09 lumpy_filter: /usr/lib64/libcrypto.so.1.0.0: version `OPENSSL_1_1_1' not found (required by /home/myuser/anaconda3/envs/sv/bin/../lib/./libssl.so.1.1)

The needed libcrypto is in the conda lib, but lumpy insists on looking into the system PATh even though I explicitly set LD_LIBRARY_PATH to point to conda lib. How can I fix this? 
Thanks in advance! ",aksenia,https://github.com/brentp/smoove/issues/102
MDU6SXNzdWU1Njk2ODMwMzE=,svtools merge issue,OPEN,2020-02-24T07:40:47Z,2020-02-25T10:22:42Z,,"Hi,

I tried to merge files from 206 samples, and encountered this error.
Do you have any idea where should I look at?
The merging job ends prematurely, and left ""merged.lsort.vcf"" and ""merged.sites.vcf.gz""

""merged.lsort.vcf"" is the file that contains all the variants from 206 samples, and ""merged.sites.vcf.gz"" is the sorted file. I could see where it stops.

###error messege###
[smoove] 2020/02/23 12:14:38 starting with version 0.2.5
[smoove] 2020/02/23 12:14:38 merging 206 files
[smoove] 2020/02/23 12:14:38 finished sorting 206 files; merge starting.
[smoove] 2020/02/23 12:37:37 Traceback (most recent call last):
File ""/home/u/f056598/miniconda2/bin/svtools"", line 11, in
[smoove] 2020/02/23 12:37:37 sys.exit(main())
File ""/home/u/f056598/miniconda2/lib/python2.7/site-packages/svtools/cli.py"", line 79, in main
[smoove] 2020/02/23 12:37:37 sys.exit(args.entry_point(args))
File ""/home/u/f056598/miniconda2/lib/python2.7/site-packages/svtools/lmerge.py"", line 622, in run_from_args
[smoove] 2020/02/23 12:37:37 weighting_scheme=args.weighting_scheme)
File ""/home/u/f056598/miniconda2/lib/python2.7/site-packages/svtools/lmerge.py"", line 587, in l_cluster_by_line
[smoove] 2020/02/23 12:37:37 v_id = r_cluster(BP_l, sample_order, v_id, use_product, vcf, vcf_out, include_genotypes, weighting_scheme)
File ""/home/u/f056598/miniconda2/lib/python2.7/site-packages/svtools/lmerge.py"", line 524, in r_cluster
[smoove] 2020/02/23 12:37:37 v_id = merge(BP_r, sample_order, v_id, use_product, vcf, vcf_out, include_genotypes, weighting_scheme)
File ""/home/u/f056598/miniconda2/lib/python2.7/site-packages/svtools/lmerge.py"", line 493, in merge
[smoove] 2020/02/23 12:37:37 var=create_merged_variant(BP, cliq, v_id, vcf, use_product, weighting_scheme)
File ""/home/u/f056598/miniconda2/lib/python2.7/site-packages/svtools/lmerge.py"", line 236, in create_merged_variant
[smoove] 2020/02/23 12:37:37 new_start_L, new_start_R, p_L , p_R, ALG = combine_pdfs(BP, c, use_product, weighting_scheme)
File ""/home/u/f056598/miniconda2/lib/python2.7/site-packages/svtools/lmerge.py"", line 180, in combine_pdfs
[smoove] 2020/02/23 12:37:37 if (a_L[c_i][pmax_i_L] == 0) or (a_R[c_i][pmax_i_R] == 0):
IndexError: list index out of range
2020/02/23 12:37:37 exit status 1

Thanks a lot for your help! :)",lee039,https://github.com/brentp/smoove/issues/103
MDU6SXNzdWU1NzI5NjU4ODk=,Running LUMPY with -e option,OPEN,2020-02-28T19:43:39Z,2020-02-28T19:43:39Z,,"We would need to use the option: 
```
-e       Show evidence for each call
```
which has been fixed in the most recent version of LUMPY (commit: 8f93887). Would be possible for `smoove` to provide the option to use this flag `-e` when running LUMPY?

Thank you",simozacca,https://github.com/brentp/smoove/issues/104
MDU6SXNzdWU2MDI1MDkwNDE=,"How does smoove detect availability of the ""several programs"" it calls?",OPEN,2020-04-18T17:25:01Z,2020-04-19T18:02:57Z,,"I am having an issue with duphold phase of smoove genotye run.  Every run has the exact same error (see ERROR report).  duphold is reported to be available by smoove (see SMOOVE report).  What troubles me is duphold is **not** on the path though smoove reports it as so!  So I'm wondering if the check  smoove uses to find the components is only an existence check, a la bash [[ -e $pathElement/duphold ]]  vs a test of executability [[ -x $pathElement/duphold ]]?  It so happens that duphold is _almost_ on the path, but the owner only set it user executable, not group nor world.

# SMOOVE report
smoove
smoove version: 0.2.5

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are re\
quired.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools
 *[Y] svtyper
 *[Y] mosdepth [extra filtering of split and discordant files for better scaling]

  [Y] duphold [(optional) annotate calls with depth changes]
  [Y] svtools [only needed for large cohorts].

# ERROR report
[smoove] 2020/04/17 23:35:21 running duphold on 1 files in 16 processes                           
[smoove] 2020/04/17 23:35:21 panic: runtime error: invalid memory address or nil pointer derefere\
nce                                                                                               
[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x4cc541]                            
                                                                                                  
goroutine                                                                                         
[smoove] 2020/04/17 23:35:21 20 [running]:                                                        
os.(*Process).signal(0x0, 0xbdc380, 0xf552f0, 0x0, 0x0)                                           
        /home/brentp/go/src/os/exec_unix.go:56 +0x31                                              
os.(*Process).Signal(...)                                                                         
        /home/brentp/go/src/os/exec.go:131                                                        
os.(*Process).kill(...)                                                                           
        /home/brentp/go/src/os/exec_posix.go:                                                     
[smoove] 2020/04/17 23:35:21 59                                                                   
os.(*Process).Kill(...)                                                                           
        /home/brentp/go/src/os/exec.go:116                                                        
github.com/brentp/smoove/duphold.Main.func2(0xc000172120, 0xc000150c00, 0xc000141510, 0xc00013e1e\
0, 0xc000166080, 0xc000150c20,                                                                    
[smoove] 2020/04/17 23:35:21 0xc00014fb10)                                                        
        /home/brentp/go/go/src/github.com/brentp/smoove/duphold/duphold.go:96 +0x48d
[smoove] 2020/04/17 23:35:21
created by github.com/brentp/smoove/duphold.Main
        /home/brentp/go/go/src/github.com/brentp/smoove/duphold/duphold.go:
[smoove] 2020/04/17 23:35:21 79 +0x4e1
2020/04/17 23:35:21 exit status 2
",iceback,https://github.com/brentp/smoove/issues/105
MDU6SXNzdWU2MDI4NzU3ODA=,subcommand help doesn't mention subcommand,OPEN,2020-04-20T01:20:48Z,2020-04-20T01:20:48Z,,"Is it intentional that the example command line for the sub-command specific help doesn't contain the sub-command?
### example
$ smoove duphold --help
[smoove] 2020/04/19 19:13:06 starting with version 0.2.5
Usage: smoove --fasta FASTA --vcf VCF [--processes PROCESSES] [--snps SNPS] --outvcf OUTVCF BAMS [BAMS ...]

",iceback,https://github.com/brentp/smoove/issues/106
MDU6SXNzdWU2MDMxNTQ2MTk=,QUAL score scaling,CLOSED,2020-04-20T11:12:23Z,2020-04-20T13:21:45Z,2020-04-20T13:21:45Z,"Hello,

How is exactly the QUAL score scaled? In my cohort vcf I get 

```
summary(DT$QUAL)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
     0.0    840.9   3353.7   5101.1   8436.3 234784.0 
```

Is this expected, that the range of values is so wide? 

thank you",N/A,https://github.com/brentp/smoove/issues/107
MDU6SXNzdWU2MDM5OTU4NDE=,How to cite,OPEN,2020-04-21T13:24:52Z,2020-04-21T13:27:38Z,,"Hello, do you have a preferred way for citing smoove? As far as I know there is currently no publication right? ",N/A,https://github.com/brentp/smoove/issues/108
MDU6SXNzdWU2MDQ2NzA3NTI=,Filtering output SVs,CLOSED,2020-04-22T11:12:36Z,2020-04-22T16:47:26Z,2020-04-22T16:47:26Z,"I have entered 12 samples (each derived from pooled tissue from clonal populations) into Smoove and, following filtering using bcftools, have successfully output a VCF file of HQ variants.

`smoove call --name BMH_clones_CNVs --exclude BMH21_Round3.repeats_only.bed --fasta BMH21_Flye_60x_assembly.fasta -p 1 --genotype Coverage_Depth/*.bam --outdir Coverage_Depth/ --duphold;`

`bcftools view -i '(SVTYPE = ""DEL"" & FMT/DHFFC[0] < 0.7) | (SVTYPE = ""DUP"" & FMT/DHBFC[0] > 1.3)' BMH_clones_CNVs-smoove.genotyped.vcf.gz > BMH_clones_CNVs-smoove.genotyped.HQ.vcf;`

Do you have any recommendations as to how to further filter out any calls with dubious genotypes, please? From what I can tell, filtering by QUAL or average SQ may help, but I am wary, for example, of calls consisting only of heterozygous calls, and wondered what methods you suggest for dealing with such uncertain calls?",iwilson-liv,https://github.com/brentp/smoove/issues/109
MDU6SXNzdWU2MDgxNzU3NDM=,Failed to open -: unknown file type panic: exit status 255,CLOSED,2020-04-28T09:44:26Z,2020-04-29T02:00:26Z,2020-04-29T02:00:26Z,"Hi, I'm trying Smoove/Lumpy on my sample in Large cohort mode, my command:

```
    docker run -v `pwd`:`pwd` -it brentp/smoove smoove call \
        --exclude $ex_target \
        --outdir /home/nguyen/RB1/Smoove/ \
        --name $sample \
        --fasta $ref_fasta -p 1 --genotype $final_bam
```

in the first half, it runs smoothly to produce and filter discordant and split reads, however, it fails at the genotyping step:
```
[smoove] 2020/04/28 09:39:43 2020/04/28 09:39:43 EOF
[smoove] 2020/04/28 09:39:43 Failed to open -: unknown file type
panic: exit status 255

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
        /home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xbd75a0, 0xc000154568, 0x7ffdc0d3fe68, 0x1b, 0xc0001575e0, 0x1, 0x1, 0x7ffdc0d3fe35, 0x18, 0x7ffdc0d3fe55, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:226 +0x17f8
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:347 +0x44f
main.main()
        /home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1ce
```

When I run the command with out `exclude` parameter, it runs fine. Because my interesting region is quite small, only a part of chr13, so the ex_target file cover most of the chromosome.

Please guide me on this problem, thank you",NTNguyen13,https://github.com/brentp/smoove/issues/110
MDU6SXNzdWU2MTcyNDQwMDg=,Unbound variable SAMPLE when running smoove docker,CLOSED,2020-05-13T08:18:42Z,2020-05-13T22:01:16Z,2020-05-13T22:01:16Z,"I have the following docker command:

 ```
docker run -it \
    --mount=type=bind,source=/blue/project/gridssTest/data/bams,target=/data \
    --mount=type=bind,source=/blue/project/cancer-seq-pipeline/data/references/hg19/,target=/reference brentp/smoove \
     smoove call \
    --name trio003 \
    --fasta /reference/ucsc.hg19.fasta 
   /data/trio003_mother.bam
```
which generates the following error:
```
[smoove] 2020/05/13 07:29:23 starting with version 0.2.5
[smoove] 2020/05/13 07:29:23 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2020/05/13 07:29:23 /bin/bash: SAMPLE: unbound variable
[smoove]:2020/05/13 07:29:23 finished process: lumpy-filter (set -eu; lumpy_filter -f /reference/ucsc.hg19.fasta /data/trio003_mother.bam .//$SAMPLE.split.bam.tm) in user-time:0s system-time:8.206ms
[smoove]:2020/05/13 07:29:23 error running command: set -eu; lumpy_filter -f /reference/ucsc.hg19.fasta /data/trio003_mother.bam .//$SAMPLE.split.bam.tmp.bam .//$SAMPLE.disc.bam.tmp.bam 2 && mv .//$SAMPLE.split.bam.tmp.bam .//$SAMPLE.split.bam && mv .//$SAMPLE.disc.bam.tmp.bam .//$SAMPLE.disc.bam && cp .//$SAMPLE.split.bam .//$SAMPLE.split.bam.orig.bam && cp .//$SAMPLE.disc.bam .//$SAMPLE.disc.bam.orig.bam -> exit status 1
[smoove] 2020/05/13 07:29:43 done calculating bam stats
panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.Lumpy(0x7ffdcdaf2ea1, 0x7, 0x7ffdcdaf2eb1, 0x1a, 0xaf76c4, 0x2, 0xc00018e580, 0x1, 0x1, 0xc0000f5cc0, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:127 +0x57e
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
        /home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1ce

```

It's looking for a variable called SAMPLE. There's nothing that I can see in the documentation regarding a variable of that name, and indeed when I try and add it in (just to see what happens) it throws an error. 
From the line that prints out the command that it executes, it very much looks like it's used as a placeholder for temporarily generated discordant and split reads file that hasn't been generated at some point? ",tirohia,https://github.com/brentp/smoove/issues/111
MDU6SXNzdWU2MjI4MjM3NjE=,single end reads,CLOSED,2020-05-21T22:15:40Z,2020-05-21T22:18:44Z,2020-05-21T22:18:44Z,"Hi,

Does smoove also works with single end reads?
I would like to try it on a BAM file with short single end reads (40-50 bp)

Thanks,

Nicolas",ndierckx,https://github.com/brentp/smoove/issues/112
MDU6SXNzdWU2MzA0MjE2MTk=,smoove failed at lumpy_filter,OPEN,2020-06-04T00:35:39Z,2020-06-09T09:57:04Z,,"Dear @brentp 

The BAM file was generated by BWA-MEM (alignment without -M) and picard (remove duplication). When using it to detect CNV using smoove using following command, the program failed at lumpy-filter. I also tried to run lumpy-filter alone, the same error persists. Hope you can give me some suggestion. Thank you. Also, this issue has also been mentioned [before](https://github.com/arq5x/lumpy-sv/issues/335#issuecomment-638278093) .
```
./smoove call --name chicken --fasta /home/test/Gallus_gallus.GRCg6a.dna.chromosome.total.fa --processes 4 --outdir 03DJ13 --genotype --duphold /home/test/03DJ13.sorted.markdup.bam
[smoove] 2020/06/04 08:11:20 starting with version 0.2.5
[smoove] 2020/06/04 08:11:20 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2020/06/04 08:11:21 /bin/bash: line 1: 175548 Segmentation fault      (core dumped) lumpy_filter -f /home/test/Gallus_gallus.GRCg6a.dna.chromosome.total.fa /home/test/03DJ13.sorted.markdup.bam 03DJ13/DJ13.split.bam.tmp.bam 03DJ13/DJ13.disc.bam.tmp.bam 2
[smoove]:2020/06/04 08:11:21 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/test/Gallus_gallus.GRCg6a.dna.chromosome.total.fa /home/test/03DJ13.s) in user-time:2.974ms system-time:18.914ms
[smoove]:2020/06/04 08:11:21 error running command: set -eu; lumpy_filter -f /home/test/Gallus_gallus.GRCg6a.dna.chromosome.total.fa /home/test/03DJ13.sorted.markdup.bam 03DJ13/DJ13.split.bam.tmp.bam 03DJ13/DJ13.disc.bam.tmp.bam 2 && mv 03DJ13/DJ13.split.bam.tmp.bam 03DJ13/DJ13.split.bam && mv 03DJ13/DJ13.disc.bam.tmp.bam 03DJ13/DJ13.disc.bam && cp 03DJ13/DJ13.split.bam 03DJ13/DJ13.split.bam.orig.bam && cp 03DJ13/DJ13.disc.bam 03DJ13/DJ13.disc.bam.orig.bam -> exit status 139
[smoove] 2020/06/04 08:11:31 done calculating bam stats
panic: exit status 139

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.Lumpy(0x7fff536e531c, 0x7, 0x7fff536e532c, 0x37, 0x7fff536e537b, 0x6, 0xc0001a35b0, 0x1, 0x1, 0xc0001ac960, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:127 +0x57e
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1ce
```
Sincerely.
Zhuqing

",biozzq,https://github.com/brentp/smoove/issues/113
MDU6SXNzdWU2MzEwMDU2NzQ=,panic: bam reagroup: more than one RG for,CLOSED,2020-06-04T17:11:11Z,2020-06-08T16:17:01Z,2020-06-06T17:03:37Z,"Hello,

Is this error because I have merged samples into a single bam? If I'm trying to run smoove on a pool of samples, would you recommend re-mapping of all individuals from a population at once?

Thanks,
Jon",jonathan-velotta,https://github.com/brentp/smoove/issues/114
MDU6SXNzdWU2MzQ3NDYwMzk=,Smoove on pools,CLOSED,2020-06-08T16:05:14Z,2020-06-08T16:07:17Z,2020-06-08T16:07:17Z,"How would one best run smoove on a pool of samples? I have ~50 low coverage whole-genome samples in each of 14 wild populations. Would you suggest concatenating read files, mapping, and then running smoove?",jonathan-velotta,https://github.com/brentp/smoove/issues/115
MDU6SXNzdWU2MzY0NTUxMjQ=,Joint tumor/normal call fails at filter stage (but single sample calls work),OPEN,2020-06-10T18:22:06Z,2020-06-10T19:34:29Z,,"Dear all,

I'm having difficulties getting smoove to run specifically for joint tumor/normal pairs, using the following command on sub-sampled bams (however, same is true for the full bams):
```sh
smoove call -x --name minimal_test_joint --fasta hs38d1_no_alt.fa -p 4 --genotype sub
_control.bam sub_sample.bam --outdir ./minimal_test_joint2
```

For context: 
* I am using the latest smoove docker image
* smoove runs through without issues when called for each bam individually, as in:
```sh
smoove call -x --name minimal_test_single --fasta hs38d1_no_alt.fa -p 4 --genotype sub_control.bam --outdir ./minimal_test_single_control
```
* lumpyexpress runs the joint call without issues (this is off my own image, the smoove image doesn't seem to have all dependencies for the express version), like this:
```sh
lumpyexpress -B sub_sample.bam,sub_control.bam -o lumpyexpresstest.vcf
```


This is again the call + the output I'm getting for joint calling with smoove:

```sh
smoove call -x --name minimal_test_joint --fasta hs38d1_no_alt.fa -p 4 --genotype sub
_control.bam sub_sample.bam --outdir ./minimal_test_joint2
[smoove] 2020/06/10 17:49:14 starting with version 0.2.5
[smoove] 2020/06/10 17:49:14 calculating bam stats for 2 bams
[smoove]: ([E]lumpy-filter) 2020/06/10 17:49:15 [lumpy_filter] extracted splits and discordants from 592829 total aligned reads
[smoove]:2020/06/10 17:49:15 finished process: lumpy-filter (set -eu; lumpy_filter -f hs38d1_no_alt.fa sub_control.bam ./minimal_test_joint2/sample.split.bam.tmp) in user-time:1.543034s system-time:184.73ms
[smoove]:([E]lumpy-filter) 2020/06/10 17:49:16 [lumpy_filter] extracted splits and discordants from 1023800 total aligned reads
[smoove]:([E]lumpy-filter) 2020/06/10 17:49:16 mv: cannot stat './minimal_test_joint2/sample.split.bam.tmp.bam': No such file or directory
[smoove]:2020/06/10 17:49:16 finished process: lumpy-filter (set -eu; lumpy_filter -f hs38d1_no_alt.fa sub_sample.bam ./minimal_test_joint2/sample.split.bam.tmp.) in user-time:2.490548s system-time:264.267ms
[smoove]:2020/06/10 17:49:16 error running command: set -eu; lumpy_filter -f hs38d1_no_alt.fa sub_sample.bam ./minimal_test_joint2/sample.split.bam.tmp.bam ./minimal_test_joint2/sample.disc.bam.tmp.bam 2 && mv ./minimal_test_joint2/sample.split.bam.tmp.bam ./minimal_test_joint2/sample.split.bam && mv ./minimal_test_joint2/sample.disc.bam.tmp.bam ./minimal_test_joint2/sample.disc.bam && cp ./minimal_test_joint2/sample.split.bam ./minimal_test_joint2/sample.split.bam.orig.bam && cp ./minimal_test_joint2/sample.disc.bam ./minimal_test_joint2/sample.disc.bam.orig.bam -> exit status 1
[smoove] 2020/06/10 17:49:17 done calculating bam stats
panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.Lumpy(0x7ffc4761ad6b, 0x12, 0x7ffc4761ad86, 0x10, 0x7ffc4761adcf, 0x15, 0xc0000a53a0, 0x2, 0x2, 0xc0000c1d60, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:127 +0x57e
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
        /home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1ce
```

This seemed somewhat similar to a recent issue (https://github.com/brentp/smoove/issues/113) - I tried setting TMPDIR and also the bioconda version, but this didn't change anything; lumpy_filter works fine on its own. And in any case, the single sample case works fine for me.

As a possible alternative: are there appreciable downsides to calling individually and then merging, in this case?

Smoove looks like a great tool, I hopefully just missed some basic detail. Thanks in advance!

",robertsehlke,https://github.com/brentp/smoove/issues/116
MDU6SXNzdWU2NTE4OTgxMzY=,Many more DUPS than DELS across most samples,CLOSED,2020-07-07T00:25:41Z,2020-07-09T13:59:23Z,2020-07-09T13:59:23Z,"Hi Brent,

Thank you for making smoove, it's a great method! I am using an older version (v0.1.7) to compare with 10X's longranger caller (which came out around the same time as v0.1.7). So far smoove performs very well in comparison. I am however finding that smoove calls a drastically larger number of duplications and inversions compared to deletions. This seems to still hold, even when retaining only MSHQ=4 variants. For example, in one vcf there were 27,196 DUP, 27,311 INV, and 2,840 DEL (this only considers MSHQ=4 variants) and this is typical of the samples I have run. I am wondering if this is just a feature of duplications and inversions being more difficult to call with confidence and if you have noticed this previously. I do think think the majority of these duplications are spurious, although they often have high quality (>100 GQ/SQ). v0.1.7 was before you included duphold, so I haven't been able to use that to filter further. This analysis is being done on 150 bp paired end linked-reads (10x Genomics) at about 60x depth with the barcode trimmed off the forward read. Just want to get your perspective on how unusual this ratio of DUPS to DELS is.

Best, Andrew",andrewSharo,https://github.com/brentp/smoove/issues/117
MDU6SXNzdWU2NTgwMzk3Njk=,excluding variants with all unknown or homozygous reference genotypes,OPEN,2020-07-16T09:50:43Z,2020-07-17T04:50:23Z,,"Command line:
$smoove call --outdir $smooveout --name ${tumor}_${normal} --fasta $ref -p 1 --genotype $tdata/$tumor.MarkDuplicates.bam $ndata/$normal.MarkDuplicates.bam

error:
[smoove] 2020/07/16 16:40:21 starting with version 0.2.3
[smoove] 2020/07/16 16:40:21 calculating bam stats for 2 bams
[smoove]: ([E]lumpy-filter) 2020/07/16 16:41:40 [lumpy_filter] extracted splits and discordants from 63424
894 total aligned reads
[smoove]:2020/07/16 16:41:41 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/cmding/02_data
base/01_ref_genome/UCSC_hg38.fa /home/cmding/06_tangyin) in user-time:2m11.538315s system-time:18.338641s
[smoove]:([E]lumpy-filter) 2020/07/16 16:42:04 [lumpy_filter] extracted splits and discordants from 559760
05 total aligned reads
[smoove]:2020/07/16 16:42:04 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/cmding/02_data
base/01_ref_genome/UCSC_hg38.fa /home/cmding/06_tangyin) in user-time:48.568677s system-time:5.56409s
[smoove] 2020/07/16 16:45:02 done calculating bam stats
[smoove] 2020/07/16 16:47:49 removed 535150 alignments out of 8461480 (6.32%) with low mapq, depth > 1000,
 or from excluded chroms from 12-0RP.disc.bam in 167 seconds
[smoove] 2020/07/16 16:47:49 removed 101176 alignments out of 8461480 (1.20%) that were bad interchromosom
als or flanked-splitters from 12-0RP.disc.bam
[smoove] 2020/07/16 16:50:21 removed 310346 singletons and isolated interchromosomals of 7825154 reads (3.
97%) from 12-0RP.disc.bam in 152 seconds
[smoove] 2020/07/16 16:50:21 7514808 reads (88.81%) of the original 8461480 remain from 12-0RP.disc.bam
[smoove] 2020/07/16 16:51:28 removed 78302 alignments out of 211441 (37.03%) with low mapq, depth > 1000,
or from excluded chroms from 229N_S1_L002.disc.bam in 50 seconds
[smoove] 2020/07/16 16:51:28 removed 17759 alignments out of 211441 (8.40%) that were bad interchromosomal
s or flanked-splitters from 229N_S1_L002.disc.bam
[smoove] 2020/07/16 16:51:29 removed 96390 singletons and isolated interchromosomals of 115380 reads (83.5
4%) from 229N_S1_L002.disc.bam in 1 seconds
[smoove] 2020/07/16 16:51:29 18990 reads (8.98%) of the original 211441 remain from 229N_S1_L002.disc.bam
[smoove] 2020/07/16 16:52:13 removed 4306 alignments out of 14410 (29.88%) with low mapq, depth > 1000, or
 from excluded chroms from 12-0RP.split.bam in 43 seconds
[smoove] 2020/07/16 16:52:13 removed 3356 alignments out of 14410 (23.29%) that were bad interchromosomals
 or flanked-splitters from 12-0RP.split.bam
[smoove] 2020/07/16 16:52:13 removed 4675 singletons of 6748 reads (69.28%) from 12-0RP.split.bam in 0 sec
onds
[smoove] 2020/07/16 16:52:13 2073 reads (14.39%) of the original 14410 remain from 12-0RP.split.bam
[smoove] 2020/07/16 16:52:59 removed 71577 alignments out of 150480 (47.57%) with low mapq, depth > 1000,
or from excluded chroms from 229N_S1_L002.split.bam in 46 seconds
[smoove] 2020/07/16 16:52:59 removed 21191 alignments out of 150480 (14.08%) that were bad interchromosoma
ls or flanked-splitters from 229N_S1_L002.split.bam
[smoove] 2020/07/16 16:52:59 removed 20439 singletons of 57712 reads (35.42%) from 229N_S1_L002.split.bam
in 1 seconds
[smoove] 2020/07/16 16:52:59 37273 reads (24.77%) of the original 150480 remain from 229N_S1_L002.split.ba
m
[smoove] 2020/07/16 16:53:00 starting lumpy
[smoove] 2020/07/16 16:53:00 wrote lumpy command to /home/cmding/06_tangying/01_SFG_CRC/05_smoove_out/12-0
RP_229N_S1_L002-lumpy-cmd.sh
[smoove] 2020/07/16 16:53:00 writing sorted, indexed file to /home/cmding/06_tangying/01_SFG_CRC/05_smoove
_out/12-0RP_229N_S1_L002-smoove.genotyped.vcf.gz
[smoove] 2020/07/16 16:53:00 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2020/07/16 16:53:00 > gsort version 0.1.4
[smoove] 2020/07/16 16:53:00 chr1       1000000
[smoove] 2020/07/16 16:53:00 Traceback (most recent call last):
  File ""/home/cmding/03_software/01_anaconda3/anaconda3/envs/bcftools19/bin/svtyper"", line 1806, in <modul
e>
[smoove] 2020/07/16 16:53:00     sys.exit(main())
[smoove] 2020/07/16 16:53:00   File ""/home/cmding/03_software/01_anaconda3/anaconda3/envs/bcftools19/bin/svtyper"", line 1801, in main
[smoove] 2020/07/16 16:53:00     args.max_reads)
  File ""/home/cmding/03_software/01_anaconda3/anaconda3/envs/bcftools19/bin/svtyper"", line 1357, in sv_genotype
    bam_list.append(pysam.AlignmentFile(b, mode='rb'))
AttributeError: 'module' object has no attribute 'AlignmentFile'
panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xa88960, 0xc00000c1b0, 0x7ffcb3222d81, 0x33, 0xc000150880, 0x2, 0x2, 0x7ffcb3222d2c, 0x31, 0x7ffcb3222d65, ...)
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:159 +0x18e5
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:346 +0x468
main.main()
        /home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1d7
Exception in thread ""main"" java.lang.RuntimeException: File not found '/home/cmding/06_tangying/01_SFG_CRC/05_smoove_out/12-0RP_229N_S1_L002-smoove.genotyped.vcf.gz'
        at org.snpeff.util.Gpr.reader(Gpr.java:524)
        at org.snpeff.util.Gpr.reader(Gpr.java:507)
        at org.snpeff.fileIterator.MarkerFileIterator.init(MarkerFileIterator.java:63)
        at org.snpeff.fileIterator.FileIterator.<init>(FileIterator.java:39)
        at org.snpeff.fileIterator.MarkerFileIterator.<init>(MarkerFileIterator.java:36)
        at org.snpeff.fileIterator.VcfFileIterator.<init>(VcfFileIterator.java:81)
        at org.snpsift.SnpSift.openVcfInputFile(SnpSift.java:455)
        at org.snpsift.SnpSiftCmdFilter.run(SnpSiftCmdFilter.java:349)
        at org.snpsift.SnpSiftCmdFilter.run(SnpSiftCmdFilter.java:331)
        at org.snpsift.SnpSift.run(SnpSift.java:588)
        at org.snpsift.SnpSift.main(SnpSift.java:76)

I don't know what's wrong, can you give me some advice.
Thanks.
tang",tyyiyi,https://github.com/brentp/smoove/issues/118
MDU6SXNzdWU2NjQxNzU0Mjk=,svtyper error ,CLOSED,2020-07-23T03:19:31Z,2021-10-12T08:10:26Z,2021-10-12T07:48:47Z,"Hi,

When running smoove, I get an error with svtyper.

Here's my command:
` docker run  -v /data:/data brentp/smoove smoove call --name NA24385_b38_smoov   --fasta /data/SV/ref_fasta/GRCh38/GRCh38_full_analysis_set_plus_decoy_hla.fa -p 12 --excludechroms '~^GL,~^HLA,~_random,~^chrUn,~alt,~decoy' --genotype /data/SV/NA24385/samblaster_38/na24385.samblaster.sorted.hg38.bam  --outdir /data/SV `

I should note that I'm running build 38, which uses ""chr1"", ""chr2"" (has ""chr"" in front of the string.) Also, I was able to run smoove with a build 37 bam (no ""chr"" in front).

[smoove] 2020/07/23 02:42:04 20	1000000
[smoove] 2020/07/23 02:42:05 21	1000000
21	2000000
21	4000000
21	8000000
21	16000000
[smoove] 2020/07/23 02:42:05 22	1000000
22	2000000
22	4000000
22
[smoove] 2020/07/23 02:42:05 	8000000
22	16000000
22	32000000
[smoove] 2020/07/23 02:42:05 X	1000000
[smoove] 2020/07/23 02:42:06 Y	1000000
Y	2000000
Y	4000000
[smoove] 2020/07/23 02:51:33 Traceback (most recent call last):
  File ""/opt/conda/envs/smoove-env/bin/svtyper"", line 11, in <module>
    load_entry_point('svtyper==0.7.0', 'console_scripts', 'svtyper')()
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 575, in cli
[smoove] 2020/07/23 02:51:33     sys.exit(main())
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 568, in main
[smoove] 2020/07/23 02:51:33     args.max_ci_dist)
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 281, in sv_genotype
[smoove] 2020/07/23 02:51:33     read_batch, many = gather_all_reads(sample, chromA, posA, ciA, chromB, posB, ciB, z, max_reads)
[smoove] 2020/07/23 02:51:33   File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 57, in gather_all_reads
[smoove] 2020/07/23 02:51:33     read_batch, many = gather_reads(sample, chromA, posA, ciA, z, read_batch, max_reads)
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 81, in gather_reads
[smoove] 2020/07/23 02:51:33     min(pos + ci[1] + fetch_flank, chrom_length))):
  File ""pysam/libcalignmentfile.pyx"", line 1081, in pysam.libcalignmentfile.AlignmentFile.fetch
  File ""pysam/libchtslib.pyx"", line 686, in pysam.libchtslib.HTSFile.parse_region
[smoove] 2020/07/23 02:51:33 ValueError: invalid contig `1`
[smoove] 2020/07/23 02:51:33 Traceback (most recent call last):
  File ""/opt/conda/envs/smoove-env/bin/svtyper"", line 11, in <module>
    load_entry_point('svtyper==0.7.0', 'console_scripts', 'svtyper')()
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 575, in cli
[smoove] 2020/07/23 02:51:33     sys.exit(main())
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 568, in main
[smoove] 2020/07/23 02:51:33     args.max_ci_dist)
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 281, in sv_genotype
[smoove] 2020/07/23 02:51:33     read_batch, many = gather_all_reads(sample, chromA, posA, ciA, chromB, posB, ciB, z, max_reads)
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 57, in gather_all_reads
    read_batch, many = gather_reads(sample, chromA, posA, ciA, z, read_batch, max_reads)
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 81, in gather_reads
    min(pos + ci[1] + fetch_flank, chrom_length))):
  File ""pysam/libcalignmentfile.pyx"", line 1081, in pysam.libcalignmentfile.AlignmentFile.fetch
[smoove] 2020/07/23 02:51:33   File ""pysam/libchtslib.pyx"", line 686, in pysam.libchtslib.HTSFile.parse_region
[smoove] 2020/07/23 02:51:33 ValueError: invalid contig `4`
panic: exit status 1

goroutine 51094 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper.func2(0xc000c9cae0, 0xc00012d5f0, 0x1, 0x1, 0x7ffc6bf69e03, 0x44, 0xc0024f9aa0, 0x2c, 0xc002cb9fa8, 0xc002cb9fc0, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:179 +0x90b
created by github.com/brentp/smoove/svtyper.Svtyper
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:165 +0xaae



Thanks!
Pauline
",pauline-ng,https://github.com/brentp/smoove/issues/119
MDU6SXNzdWU2NzI4MjYwNjc=,smoove paste error,CLOSED,2020-08-04T14:13:38Z,2020-08-06T11:30:34Z,2020-08-06T11:30:34Z,"I am running smoove pipeline for SV calling in multiple samples. Note that these samples have different insert sizes, i.e. some samples have 2 x 100 bp Illumina paired-end sequencing data , while some have 2 x 150 bp Illumina paired-end sequencing data. I successfully installed the dependencies and run the first two steps of smoove pipeline. However, in the third step (smoove paste) it generated the following message: ""please make sure that all files have the same number of variants""

![Screenshot from 2020-08-04 16-01-21](https://user-images.githubusercontent.com/58446112/89303902-188e9c00-d66d-11ea-9342-3392b245eacc.png)

does this message mean that something went wrong in the previous two steps? And does this difference in insert sizes between the samples produce correct SV genotypes?",BioInf2305,https://github.com/brentp/smoove/issues/120
MDU6SXNzdWU2NzQyNjAxODM=,seeking a clarification concerning smoove genotype steps ,CLOSED,2020-08-06T12:03:24Z,2020-08-06T13:12:57Z,2020-08-06T13:12:57Z,"First of all thank you very much for this Structural variation (SV) calling tool which is really smooth. 

I have a question concerning a third step, ""smoove genotype"". In this step, smoove genotypes all the samples at all the sites (present in the merged vcf file, generated using ""merge"" step) present in the ""merged"" vcf file. However, after this step, I get SV genotypes (which is not homozygous reference) for sites which were not identified as encompassing SVs in particular samples after the first step--""smoove call"". Let me elaborate this in details: 

for instance, ""smoove call"" identified a heterozygous deletion encompassing these genomic co-ordinates: 1: 136,215-137,161 in Sample A but not in Sample B. Now after ""smoove merge"" and ""smoove genotype"", the genotype for sample B at the above mentioned co-ordinates is also heterozygous deletion. Now my question is, how is it possible? coz there was no SV called at these positions in sample B in the first step itself, but now this sample has SV genotypes after ""smoove genotype"" step?  I would really appreciate it if you clarify this. Thank you in advance. ",BioInf2305,https://github.com/brentp/smoove/issues/121
MDU6SXNzdWU2Nzg4MzA1OTU=,"how to solve: ""couldn't find sample from bam: or ENV in vcf which had SRRxxxxxx""",CLOSED,2020-08-14T01:17:43Z,2020-08-14T13:12:32Z,2020-08-14T13:12:32Z,"the error came when I ran duphold in the smoove environment, but the bam and vcf were correct",Zhao-Zhangyi,https://github.com/brentp/smoove/issues/122
MDU6SXNzdWU2Nzk0NTE2Mzc=,"""out of memory"" when running small cohorts",CLOSED,2020-08-14T23:36:59Z,2020-08-17T00:50:22Z,2020-08-17T00:50:22Z,"Hi Brent,

Thanks for writing smoov, it has made my life a lot ""smoover""!

I can successfully run 5 .bam files using the small-cohort command, but when I try 6, I get an out of memory error. 

The error is below:

`docker run -it -v /data:/data brentp/smoove smoove call -x --name smoov_cohort --exclude /data/SV/ceph18.b37.lumpy.exclude.2014-01-15.bed --fasta  /data/SV/ref_fasta/hs37d5.fa.gz -p 12 --genotype /data/SV/bam/*.bam  --outdir /data/SV/

[smoove] 2020/08/14 23:28:43 starting with version 0.2.5
[smoove] 2020/08/14 23:28:43 calculating bam stats for 6 bams
[smoove] 2020/08/14 23:29:07 done calculating bam stats
out of memorypanic: exit status 1

goroutine 112142 [running]:
github.com/brentp/smoove/lumpy.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.remove_sketchy(0xc0000ee9a0, 0x1a, 0x3e8, 0x7fffd6059d88, 0x1f, 0x7fffd6059d4f, 0x30, 0xc0000bdb80, 0x4, 0x4, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:232 +0x1818
github.com/brentp/smoove/lumpy.remove_sketchy_all.func1(0xc0000b8a20, 0x3e8, 0x7fffd6059d88, 0x1f, 0x7fffd6059d4f, 0x30, 0xc0000bdb80, 0x4, 0x4, 0x1, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:399 +0x231
created by github.com/brentp/smoove/lumpy.remove_sketchy_all
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:397 +0x191
`

Any hints on how to get it to run with a larger number of samples? (The README page said up to 40 can be run). 

Thank you,
Pauline",pauline-ng,https://github.com/brentp/smoove/issues/123
MDU6SXNzdWU2ODAwNzkzMTk=,inputfile,CLOSED,2020-08-17T09:16:42Z,2020-08-17T13:15:22Z,2020-08-17T13:15:22Z,"hi,

I'm going to test my normal tumor sample for structural variation. I want to know, should I use the sorted bam files as input files or should I use the files after removing duplicates as input files? I tried them, and they don't get the same results.


thank you!
Tang",tyyiyi,https://github.com/brentp/smoove/issues/124
MDU6SXNzdWU2ODA2MjY3Mzk=,how to filter the output,OPEN,2020-08-18T01:44:38Z,2020-08-18T01:44:38Z,,"I am testing structural variations on my samples, and their depth is about 1000x. I tested a pair of normal tumor samples,using sorted.bam and markduplicates.bam as input files respectively, the results obtained, one of the SV is like this:

A: sorted.bam as input file:
#CHROM POS ID REF ALT QUAL FILTER INFO FORMAT 256T_S8_L002 256N_S7_L002
chr3 41224322 403 N <DEL> 90372.2. SVTYPE=DEL;SVLEN=-607;END=41224929;STRANDS=+- :1498;CIPOS=0,0;CIEND=0,0;CIPOS95=0,0;CIEND95=0 ,0;SU=1498;PE=1;SR=1497;PRPOS=1;PREND=1;AC=1;AN=2 GT:GQ :SQ:GL:DP:RO:AO:QR:QA:RS: AS:ASC:RP:AP:AB 0/1:200:90372.2:-9234,-197,-4283:11540:7369:4170:7368:4169:40 83:1500:463:3285:2206:0.36 ./ .:.:.:.:.:.:.:.:.:.:.:.:.:.:.

B:markduplicates.bam as input file:
#CHROM POS ID REF ALT QUAL FILTER INFO FORMAT 256T_S8_L002 256N_S7_L002
chr3 41224322 324 N <DEL> 63802.1. SVTYPE=DEL;SVLEN=-607;END=41224929;STRANDS=+-:1875;CIPOS=0,0;CIEND=0,0;CIPOS95=0,0;CIEND95=0 ,0;SU=1875;PE=799;SR=1076;PRPOS=1;PREND=1;AC=1;AN=4 GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS: AS:ASC:RP:AP:AB 0/1:200:63802.1:-6528,-148,-3091:8245:5290:2954:5289:2953:2924:1079:328:2365:1546:0.36 0/0 :200:0:-2,-3029,-10093:10113:10108:5:10107:4:5538:1:0:4569:2:0.0004

This deletion is correct when verified.
Why are their SU, PE, SR so different? 
And, when I filter the output file, I see such a suggestion on biostar (https://www.biostars.org/p/276431/) that is, it is recommended to use:
SnpSift.jar filter --file in.vcf ""( isVariant( GEN[0]) && (GEN[1].AO == 0) )""> out.vcf

But if I choose AO=0 here,  the mutation in B will be filtered out, which is obviously wrong. So, can you give me some suggestions on filtering?

Thank you
Tang",tyyiyi,https://github.com/brentp/smoove/issues/125
MDU6SXNzdWU2ODI1NjIxMTA=,The meaning of the parameters,CLOSED,2020-08-20T09:24:14Z,2020-08-20T13:44:41Z,2020-08-20T13:44:41Z,"Hello, smoove is really a great software. It helps me detect structural variation in the data. I have some doubts about its output. I hope you can explain it to me:
Look at a record:
#CHROM POS ID REF ALT QUAL FILTER INFO FORMAT 256T_S8_L002 256N_S7_L002
chr3 41224322 324 N <DEL> 63802.1. SVTYPE=DEL;SVLEN=-607;END=41224929;STRANDS=+-:1875;CIPOS=0,0;CIEND=0,0;CIPOS95=0,0;CIEND95=0 ,0;SU=1875;PE=799;SR=1076;PRPOS=1;PREND=1;AC=1;AN=4 GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS: AS:ASC:RP:AP:AB 0/1:200:63802.1:-6528,-148,-3091:8245:5290:2954:5289:2953:2924:1079:328:2365:1546:0.36 0/0 :200:0:-2,-3029,-10093:10113:10108:5:10107:4:5538:1:0:4569:2:0.0004

problem:
1. Shouldn't DP be the sum of AO and RO? Why is AO+RO always 1 smaller than DP?
2. What exactly does QR, QA, RS, AS, ASC, RP, AP mean? Can you explain it based on the record above?
3. How should I calculate the ALT allele frequency of the tumor?  if I want to get a variation with the frequency greater than 0.2 in the tumor and less than 0.01 in the paired normal sample, What should I do?

Thanks a lot
Tang",tyyiyi,https://github.com/brentp/smoove/issues/126
MDU6SXNzdWU2ODU1OTIwMjc=,panic: open sample.bam: no such file or directory,CLOSED,2020-08-25T15:41:32Z,2020-08-25T16:11:51Z,2020-08-25T16:11:50Z,"Hello dear
When I run smoove by docker, process terminated by this error: ""panic: open NGS/row/bbbb.bam: no such file or directory"".
I'm new user of linux operating system, and will be happy if you help me to solve this issue.
My command is:

> sudo docker run -it brentp/smoove smoove call --name dddd --fasta NGS/gr/GRef-BWA/gr.fa --exclude NGS/soft/smoove/exclude.bed --processes 1 --outdir NGS/result-smoove --genotype --duphold --removepr NGS/row/bbbb.bam

I execute this command at home directory. 
- Operating system: Ubuntu 20

best regard
![Screenshot from 2020-08-25 20-08-41](https://user-images.githubusercontent.com/62819104/91196018-e245b900-e70e-11ea-8db5-7567ac349c17.png)
",faramarzgsm,https://github.com/brentp/smoove/issues/127
MDU6SXNzdWU2OTQzMDU1MDk=,"""couldn't get region from line"" ERROR",OPEN,2020-09-06T09:13:43Z,2020-09-07T07:47:33Z,,"Hi, I get this ""couldn't get region from line"" error when running smoove.

Here is my command:

sudo docker run -v /media/zengyiheng/FJYKDX-ZYH-2:/media/zengyiheng/FJYKDX-ZYH-2 -it brentp/smoove smoove call -x --name s18943 --exclude /media/zengyiheng/FJYKDX-ZYH-2/ceph18.b37.lumpy.exclude.2014-01-15.bed --fasta /media/zengyiheng/FJYKDX-ZYH-2/hg19_deHap.fa -p 15 --genotype /media/zengyiheng/FJYKDX-ZYH-2/s18943.final.bam --outdir /media/zengyiheng/FJYKDX-ZYH-2/smoove-18943

After a few minutes, it responded:

[smoove] 2020/09/06 08:55:45 starting with version 0.2.5
[smoove] 2020/09/06 08:55:45 calculating bam stats for 1 bams
[smoove] 2020/09/06 08:55:49 done calculating bam stats
**2020/09/06 08:56:10 couldn't get region from line**

I can't figure it out. Could someone help me?
Thanks a lot.
Yi-Heng Zeng


",fjmuzengyiheng,https://github.com/brentp/smoove/issues/128
MDU6SXNzdWU2OTQ4NTM3NDg=,Why is the normal sample not filtered for the tumor sample?,CLOSED,2020-09-07T08:21:46Z,2020-09-07T13:03:30Z,2020-09-07T13:03:29Z,"Hello, I have encountered some problems in detecting structural variation. I hope you can help me. First of all, I have about 50 pairs of samples (NT), all of which have been sequenced by WES. My script is:
      
      $smoove call --outdir $output --name ${tumor}_${normal} --fasta $ref -p 1 --genotype ~/$tumor.MarkDuplicates.bam ~/$normal.MarkDuplicates.bam

Then I filtered the sample:
      
      $bcftools filter -O z -i'FMT/AO[0:0]/FMT/DP[0]>=0.05 && (FMT/AO[1:0]/FMT/DP[1]<0.01 || FMT/ DP[1]=0)' $output/${tumor}_${normal}-smoove.vaf.genotyped.vcf.gz> $smoovefilter/${tumor}_${normal}-smoove.vaf.genotyped. vcf.gz
      $snpsift filter --file $smoovefilter/${tumor}_${normal}-smoove.vaf.genotyped.vcf.gz ""(isVariant(GEN[0]))""> $smoovefilter/${tumor}_${ `normal}-smoove.vaf.genotyped.filter.vcf

In the result, I saw a duplicate detected in multiple samples:
An example:
chr16   25055247        398     N       <DUP>   36.47   PASS    SVTYPE=DUP;SVLEN=71161;END=25126408;STRANDS=-+:8;IMPRECISE;CIPOS=-383,29;CIEND=-30,433;CIPOS95=-111,6;CIEND95=-8,74;SU=8;PE=8;SR=0;PRPOS=
3.23627e-15,3.79881e-15,4.4481e-15,5.23987e-15,6.14303e-15,7.21027e-15,8.4526e-15,9.93647e-15,1.16022e-14,1.36108e-14,1.59205e-14,1.86348e-14,2.1821e-14,2.55038e-14,2.97082e-14,3.46619e-14,4.04171e-14,
4.72548e-14,5.51494e-14,6.42427e-14,7.48487e-14,8.70863e-14,1.01181e-13,1.17915e-13,1.37039e-13,1.59549e-13,1.84815e-13,2.14648e-13,2.48592e-13,2.87789e-13,3.33667e-13,3.86242e-13,4.45441e-13,5.13512e-
13,5.93481e-13,6.84284e-13,7.90667e-13,9.1278e-13,1.05341e-12,1.21196e-12,1.3956e-12,1.60521e-12,1.84415e-12,2.12461e-12,2.43945e-12,2.81015e-12,3.22869e-12,3.7116e-12,4.27208e-12,4.90714e-12,5.62766e-
12,6.44689e-12,7.37448e-12,8.44269e-12,9.67163e-12,1.10774e-11,1.26537e-11,1.44869e-11,1.65777e-11,1.89262e-11,2.16834e-11,2.47806e-11,2.83205e-11,3.23597e-11,3.69166e-11,4.21223e-11,4.7932e-11,5.47202
e-11,6.22696e-11,7.09321e-11,8.06301e-11,9.1782e-11,1.04481e-10,1.1889e-10,1.35039e-10,1.53522e-10,1.74153e-10,1.97779e-10,2.24339e-10,2.54307e-10,2.88295e-10,3.26899e-10,3.69978e-10,4.18275e-10,4.7290
9e-10,5.3355e-10,6.01758e-10,6.78515e-10,7.64477e-10,8.62264e-10,9.72982e-10,1.09677e-09,1.23624e-09,1.39138e-09,1.56715e-09,1.76443e-09,1.98333e-09,2.22992e-09,2.50968e-09,2.81888e-09,3.16739e-09,3.55
282e-09,3.97923e-09,4.46063e-09,4.99736e-09,5.60427e-09,6.27879e-09,7.03849e-09,7.87826e-09,8.81363e-09,9.85481e-09,1.10206e-08,1.23205e-08,1.37609e-08,1.53792e-08,1.71636e-08,1.91604e-08,2.14135e-08,2
.38599e-08,2.65747e-08,2.96478e-08,3.29731e-08,3.67475e-08,4.09216e-08,4.55391e-08,5.06636e-08,5.6297e-08,6.2566e-08,6.9377e-08,7.70248e-08,8.54268e-08,9.4739e-08,1.05117e-07,1.16486e-07,1.29025e-07,1.
42659e-07,1.5779e-07,1.74388e-07,1.92602e-07,2.12947e-07,2.35084e-07,2.59442e-07,2.86341e-07,3.16e-07,3.48562e-07,3.84541e-07,4.23453e-07,4.66445e-07,5.13478e-07,5.64971e-07,6.21863e-07,6.84074e-07,7.5
2889e-07,8.27286e-07,9.08527e-07,9.98447e-07,1.09528e-06,1.2023e-06,1.31705e-06,1.4446e-06,1.58114e-06,1.73342e-06,1.8986e-06,2.07632e-06,2.27078e-06,2.48262e-06,2.71314e-06,2.96495e-06,3.23768e-06,3.5
3511e-06,3.85446e-06,4.20274e-06,4.58005e-06,4.98835e-06,5.43577e-06,5.91559e-06,6.43926e-06,7.00065e-06,7.6099e-06,8.26939e-06,8.97418e-06,9.73937e-06,1.05709e-05,1.14592e-05,1.24214e-05,1.3455e-05,1.
45608e-05,1.57556e-05,1.70373e-05,1.84325e-05,1.99075e-05,2.15018e-05,2.32106e-05,2.50452e-05,2.70168e-05,2.91194e-05,3.13505e-05,3.37385e-05,3.63044e-05,3.90446e-05,4.20025e-05,4.51504e-05,4.85262e-05
,5.20902e-05,5.59154e-05,5.99772e-05,6.43011e-05,6.89212e-05,7.38302e-05,7.90491e-05,8.45431e-05,9.04698e-05,9.67377e-05,0.000103288,0.000110309,0.000117694,0.000125565,0.000133927,0.000142658,0.000151
966,0.000161753,0.000172177,0.000183077,0.000194636,0.000206823,0.000219658,0.00023313,0.000247371,0.000262342,0.000277817,0.000294359,0.000311525,0.000329524,0.000348312,0.000368173,0.00038865,0.00041
0294,0.000432817,0.000456459,0.000481192,0.000506837,0.000533547,0.000561404,0.000590615,0.000621293,0.000652962,0.000685814,0.000719938,0.000755302,0.000792021,0.000830324,0.000869733,0.000910567,0.00
0952839,0.000996792,0.00104209,0.00108935,0.00113772,0.00118804,0.00123975,0.0012932,0.00134862,0.00140562,0.00146356,0.00152421,0.00158536,0.00164991,0.00171516,0.00178265,0.00185157,0.00192248,0.0019
9544,0.00206952,0.00214609,0.00222373,0.00230394,0.00238614,0.0024697,0.00255496,0.00264171,0.00273065,0.00282099,0.00291298,0.00300704,0.00310239,0.00319922,0.00329801,0.00339737,0.00349927,0.00360215
,0.0037073,0.00381307,0.00392108,0.0040306,0.0041417,0.00425535,0.00436935,0.00448401,0.0046011,0.00471927,0.00483894,0.00495972,0.00508082,0.00520329,0.00532726,0.00545332,0.00557966,0.00570684,0.0058
3255,0.00595976,0.00608611,0.00621453,0.00634282,0.00647212,0.00660129,0.00673113,0.0068621,0.00699237,0.00712309,0.00725418,0.00738545,0.0075163,0.00764721,0.00777798,0.00790811,0.00803994,0.00817094,
0.00830196,0.00843076,0.00855918,0.00868594,0.00881494,0.00894076,0.00906884,0.00919289,0.00931899,0.00944065,0.00956438,0.00968659,0.0098084,0.00992892,0.0100485,0.0101646,0.0102818,0.0103969,0.010512
5,0.0106265,0.0107373,0.0108476,0.0109555,0.0110654,0.0111724,0.0112787,0.0113828,0.0114846,0.0115877,0.0116883,0.011789,0.0118858,0.0119822,0.0120763,0.0121694,0.01226,0.0123494,0.0124371,0.0125232,0.
0126069,0.0126901,0.0127699,0.0128518,0.0129293,0.0130086,0.0130839,0.0131583,0.0132296,0.0133014,0.013369,0.0134378,0.0135041,0.013569,0.0136323,0.0136953,0.0137548,0.0138146,0.0102043,0.00753731,0.00
556656,0.00411096,0.00303552,0.00224115,0.00165451,0.00122131,0.000901411,0.000665249,0.000490892,0.000266465,0.000144617,7.84858e-05,4.25896e-05,2.31089e-05,1.25387e-05,6.80272e-06,3.69046e-06,2.00189
e-06,7.98705e-07,3.18676e-07,1.27137e-07,5.07197e-08,2.02333e-08,8.07062e-09,3.2192e-09,1.28394e-09,5.12061e-10;PREND=1.60439e-10,3.99092e-10,9.92257e-10,2.46633e-09,6.12905e-09,1.52283e-08,3.78232e-08
,9.39286e-08,2.33178e-07,5.7881e-07,1.43604e-06,3.56215e-06,8.8328e-06,2.18973e-05,5.42667e-05,0.000134454,0.000333059,0.000606647,0.000812602,0.00108812,0.00145652,0.00194926,0.00260749,0.00348749,0.0
0466232,0.0062314,0.00832515,0.0111203,0.0148489,0.0198166,0.0264388,0.0259408,0.0254503,0.0249566,0.0244611,0.0239672,0.0234773,0.0229904,0.0225027,0.0220183,0.0215372,0.0210571,0.0205772,0.020104,0.0
19633,0.0191661,0.0187,0.0182441,0.0177892,0.0173376,0.0168892,0.0164499,0.0160145,0.0155815,0.015154,0.0147378,0.0143286,0.0139204,0.0135153,0.0131197,0.0127344,0.0123539,0.0119809,0.0116123,0.0112537
,0.0109014,0.0105571,0.0102174,0.00988341,0.00955747,0.0092384,0.00892678,0.00862182,0.00832537,0.00803633,0.00775236,0.00747365,0.00720342,0.00694164,0.00668565,0.00643526,0.00619261,0.0059592,0.00573
333,0.00551212,0.00529703,0.00508957,0.00488924,0.00469543,0.00450745,0.00432541,0.0041484,0.00397809,0.0038134,0.00365421,0.00350032,0.00335153,0.00320731,0.0030681,0.00293378,0.00280481,0.00268006,0.
00256017,0.00244451,0.0023334,0.00222665,0.0021232,0.00202423,0.00192867,0.00183765,0.00175024,0.00166706,0.00158721,0.00150943,0.00143577,0.00136497,0.00129757,0.00123237,0.00117026,0.00111148,0.00105
543,0.00100174,0.000950165,0.000901152,0.000854487,0.000809499,0.000766804,0.00072632,0.000687942,0.000651119,0.000615757,0.000582269,0.000550556,0.000520349,0.000491519,0.000464106,0.000438171,0.00041
35,0.000390027,0.000367776,0.000346576,0.000326493,0.000307467,0.000289577,0.000272628,0.00025645,0.000241082,0.00022655,0.000212925,0.000199922,0.000187622,0.000176053,0.000165124,0.000154748,0.000144
952,0.000135771,0.000127138,0.000119005,0.000111304,0.000104073,9.73037e-05,9.09807e-05,8.49595e-05,7.92964e-05,7.3998e-05,6.90847e-05,6.44803e-05,6.01094e-05,5.60102e-05,5.21687e-05,4.85871e-05,4.5232
4e-05,4.20507e-05,3.91103e-05,3.63514e-05,3.37811e-05,3.13741e-05,2.91421e-05,2.70699e-05,2.51261e-05,2.3303e-05,2.15889e-05,1.99984e-05,1.8525e-05,1.71523e-05,1.58687e-05,1.46794e-05,1.35801e-05,1.255
24e-05,1.15941e-05,1.07019e-05,9.87824e-06,9.10902e-06,8.39607e-06,7.73358e-06,7.12164e-06,6.55853e-06,6.0334e-06,5.54776e-06,5.10003e-06,4.68354e-06,4.29826e-06,3.94302e-06,3.61734e-06,3.31959e-06,3.0
4469e-06,2.78981e-06,2.5517e-06,2.33384e-06,2.13506e-06,1.95205e-06,1.78474e-06,1.6299e-06,1.48901e-06,1.36024e-06,1.24073e-06,1.13056e-06,1.02985e-06,9.3817e-07,8.54097e-07,7.7681e-07,7.06718e-07,6.42
333e-07,5.83692e-07,5.29531e-07,4.8043e-07,4.36045e-07,3.95474e-07,3.58448e-07,3.24514e-07,2.93755e-07,2.65888e-07,2.40612e-07,2.17628e-07,1.96644e-07,1.77707e-07,1.60585e-07,1.45166e-07,1.31042e-07,1.
18207e-07,1.06603e-07,9.61544e-08,8.66397e-08,7.79728e-08,7.01976e-08,6.31762e-08,5.68726e-08,5.11106e-08,4.59202e-08,4.12437e-08,3.70317e-08,3.31975e-08,2.96998e-08,2.66022e-08,2.38102e-08,2.13193e-08
,1.90723e-08,1.7045e-08,1.52424e-08,1.36029e-08,1.21377e-08,1.082e-08,9.65653e-09,8.60706e-09,7.66215e-09,6.82778e-09,6.07913e-09,5.41555e-09,4.81811e-09,4.28382e-09,3.80972e-09,3.38647e-09,3.00877e-09
,2.67391e-09,2.3793e-09,2.11288e-09,1.87199e-09,1.65977e-09,1.47275e-09,1.30674e-09,1.15718e-09,1.02325e-09,9.06229e-10,8.02461e-10,7.09685e-10,6.25895e-10,5.52506e-10,4.87842e-10,4.31063e-10,3.81032e-
10,3.36574e-10,2.96556e-10,2.61199e-10,2.29877e-10,2.02021e-10,1.77439e-10,1.55817e-10,1.36931e-10,1.20367e-10,1.05634e-10,9.24086e-11,8.08284e-11,7.06861e-11,6.17425e-11,5.38869e-11,4.70363e-11,4.1096
7e-11,3.58926e-11,3.1248e-11,2.72345e-11,2.37454e-11,2.06946e-11,1.79912e-11,1.56577e-11,1.3617e-11,1.18792e-11,1.03227e-11,8.94996e-12,7.77631e-12,6.76339e-12,5.87484e-12,5.0948e-12,4.42524e-12,3.8458
9e-12,3.33789e-12,2.89382e-12,2.50448e-12,2.16902e-12,1.87924e-12,1.62714e-12,1.40794e-12,1.21724e-12,1.05299e-12,9.11473e-13,7.87983e-13,6.8171e-13,5.86677e-13,5.06352e-13,4.36786e-13,3.75828e-13,3.22
497e-13,2.77298e-13,2.39977e-13,2.07222e-13,1.78443e-13,1.53179e-13,1.317e-13,1.13543e-13,9.76624e-14,8.34951e-14,7.1299e-14,6.1106e-14,5.24044e-14,4.49001e-14,3.83415e-14,3.28285e-14,2.80893e-14,2.400
36e-14,2.03981e-14,1.73285e-14,1.47945e-14,1.26414e-14,1.07425e-14,9.11817e-15,7.75994e-15,6.60031e-15,5.61197e-15,4.75339e-15,4.03157e-15,3.4233e-15,2.9064e-15,2.46223e-15,2.07768e-15,1.75786e-15,1.48
294e-15,1.25569e-15,1.06334e-15,8.99631e-16,7.57114e-16,6.36187e-16,5.32517e-16,4.45182e-16,3.71631e-16,3.10198e-16,2.60445e-16,2.19343e-16,1.83764e-16,1.52933e-16,1.27116e-16,1.05408e-16,8.69052e-17,7
.24141e-17,6.04394e-17,5.0597e-17,4.2122e-17,3.48879e-17,2.9099e-17,2.41829e-17,1.99903e-17,1.64535e-17,1.36878e-17,1.14343e-17,9.45112e-18,7.82826e-18,6.40981e-18,5.2449e-18,4.28598e-18,3.5367e-18,2.9
1237e-18,2.3678e-18,1.90721e-18,1.55151e-18,1.28172e-18,1.05206e-18,8.47163e-19,6.88024e-19,5.62443e-19,4.62397e-19,3.70763e-19,2.95075e-19,2.39651e-19,1.95192e-19,1.57711e-19,1.25233e-19,1.00059e-19,8
.02665e-20,6.39775e-20,4.99895e-20,3.84306e-20,3.02951e-20,2.38686e-20,1.84738e-20,1.40705e-20,1.07422e-20,8.22356e-21,6.2723e-21,4.6933e-21,3.54745e-21,2.69503e-21,2.05344e-21,1.52553e-21,1.13157e-21,
8.56492e-22,6.20815e-22,4.4753e-22,3.18789e-22,2.34818e-22,1.70987e-22,1.23879e-22,8.66922e-23,5.94317e-23,4.06397e-23,2.6715e-23,1.78902e-23,1.16772e-23,7.47814e-24,4.57743e-24,2.89175e-24,1.74691e-24
,9.44682e-25,4.83423e-25,2.21815e-25,9.50043e-26,3.19909e-26;AC=1;AN=4       GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB   0/1:31:36.47:-5,-2,-5:67:59:7:59:7:0:0:0:59:7:0.11      0/0:112:0:-1,-12,-21
:123:123:0:122:0:76:0:0:46:0:0

However, when I verified this structural variation, I found that it was not a repeat. The nine hundred bases before and after the two breakpoints were similar sequences, which caused alignment problems.Why didn't the normal samples here filter the tumor samples to remove this false positive structural variation?
chr16   25055251        311     N       <DUP>   46.69   PASS    SVTYPE=DUP;SVLEN=71202;END=25126453;STRANDS=-+:7;IMPRECISE;CIPOS=-453,29;CIEND=-30,390;CIPOS95=-130,3;CIEND95=-9,67;SU=7;PE=7;SR=0;PRPOS=……（too long, not pasted）
;AC=1;AN=4
       GT:GQ:SQ:GL:**DP:RO:AO**:QR:QA:RS:AS:ASC:RP:AP:AB   0/1:5:46.69:-5,-1,-1:**27:21:5**:21:5:0:0:0:21:5:0.19       0/0:55:0:-0,-6,-11:**62:61:0**:60:0:35:0:0:25:0:0

And, in another pair of samples where this duplication was detected, the AO of the normal sample was 0, but when I used IGV visualization, there was a pair_end reads that supported the duplication. Why was the AO not 1?

![image](https://user-images.githubusercontent.com/48273651/92363995-f6cd7c80-f124-11ea-81c7-c77c8a18da21.png)

Thank you!
Tang


",tyyiyi,https://github.com/brentp/smoove/issues/129
MDU6SXNzdWU3MDU5NDYzMjM=,Filtering multisample with duphold,OPEN,2020-09-21T22:04:39Z,2020-09-21T22:20:16Z,,"Brent, do you have any suggestions for filtering a multisample smoove VCF for duphold? Just filtering the first sample will extraneously exclude some samples, and including any sites (FMT/DHFFC[*], e.g.) that have one sample passing this metric might be too inclusive? Just wondering if you have a better solution. Thanks!",karynne7,https://github.com/brentp/smoove/issues/130
MDU6SXNzdWU3MDcxODkwNjg=,targeted sequencing call SV,OPEN,2020-09-23T09:11:55Z,2020-09-23T15:13:05Z,,"Hi, I am using smoove to call SVs. I have about 50 samples, which are tumor-normal pairs of human. Their sequencing depth is about 1000X, which is targeted sequencing. I want to know if I can use smoove to call SVs on my data, should I construct an exclude file based on my own targeted sequencing bed file?
smoove call --outdir $output --name $fname --exclude $offtarget_region --fasta $ref -p 1 --genotype $tumor.MarkDuplicates.bam $normal.MarkDuplicates.bam",tyyiyi,https://github.com/brentp/smoove/issues/131
MDU6SXNzdWU3MTczNjg1NDY=,index error,OPEN,2020-10-08T13:54:48Z,2021-12-20T12:02:37Z,,"Hi,
I'm running smoove from docker (in wdl). 
With large bam files everything goes smoothly  (and so fast!), but I get the following error (from times to times) when the input bam is rather small and an empty vcf file is created
```bash
[smoove] 2020/10/08 13:21:01 [smoove] 2020/10/08 13:21:01 [duphold] finished
[smoove] 2020/10/08 13:21:01 [smoove] 2020/10/08 13:21:01 finished duphold
[smoove] 2020/10/08 13:21:01 [E::main_vcfindex] the index file exists. Please use '-f' to overwrite no-id-smoove.genotyped.vcf.gz.csi
2020/10/08 13:21:01 exit status 1
```
My command is:
```bash
smoove call my.bam  --fasta hg38.fa  --name name --genotype --duphold  --genotype --removepr  \
         --excludechroms chrM,~chrUn,~random,~:,~decoy --exclude exclude.cnvnator_100bp.GRCh38.20170403.bed -p 4
```

What should I change for smaller input files?

All the best,
Kasia",kasiatom,https://github.com/brentp/smoove/issues/132
MDU6SXNzdWU3MTgwOTY2NDI=,panic: exit status 1,OPEN,2020-10-09T12:13:33Z,2020-11-12T15:51:07Z,,"goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xbd75a0, 0xc00000e110, 0x7ffe7794fd7d, 0x27, 0xc0002895e0, 0x1, 0x1, 0x7ffe7794fd06, 0x22, 0x7ffe7794fd30, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:159 +0x1814
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:347 +0x44f
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:124 +0x1ce",ZexiChen502,https://github.com/brentp/smoove/issues/133
MDU6SXNzdWU3MjQ3MjU1MjY=,mv: cannot stat './/20201012.split.bam.tmp.bam': No such file or directory,CLOSED,2020-10-19T15:18:44Z,2020-10-20T17:40:05Z,2020-10-20T17:19:21Z,"Hi @brentp , I'm trying to run smoove with singularity and the image from `""docker://brentp/smoove""`. A set of two **CRAMs** on **GRCh38** . I tested various combinations of parameters (set workdir/home, etc...) but it always raises the same kind of error:

```
cd /sandbox/shares/u1087/lindenb/work/NEXTFLOW/20201019.SND.GRCh38 && singularity exec\
        --workdir /sandbox/shares/u1087/lindenb/work/NEXTFLOW/20201019.SND.GRCh38 \
        --home /sandbox/shares/u1087/lindenb/work/NEXTFLOW/20201019.SND.GRCh38 \
        --bind  /sandbox/shares/u1087/lindenb/work/20201014.testmap/samples/B00I4CH/mapping/:/data1 \
        --bind  /sandbox/shares/u1087/lindenb/work/20201014.testmap/samples/B00I4CI/mapping/:/data2 \
        --bind /sandbox/resources/species/human/broadinstitute.org/bundle/hg38/v0/:/ref \
        --bind /sandbox/shares/u1087/lindenb/work/NEXTFLOW/20201019.SND.GRCh38/:/outdir \
        /sandbox/shares/u1087/lindenb/work/NEXTFLOW/20201019.SND.GRCh38/smoove.simg \
        smoove call -x --name 20201019.SND.GRCh38 \  
        --fasta /ref/Homo_sapiens_assembly38.fasta \ 
        --duphold \
        -p 16 --genotype /data1/20201012.testmap.B00I4CH.cram /data2/20201012.testmap.B00I4CI.cram
[smoove] 2020/10/19 16:43:44 starting with version 0.2.5
[smoove] 2020/10/19 16:43:44 calculating bam stats for 2 bams
[smoove] 2020/10/19 16:43:49 done calculating bam stats
[smoove]: ([E]lumpy-filter) 2020/10/19 16:57:15 Failed to populate reference for id 166
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:31 Failed to populate reference for id 552
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:31 Failed to populate reference for id 576
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:31 Failed to populate reference for id 602
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:39 Failed to populate reference for id 804
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:39 Failed to populate reference for id 850
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 871
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 890
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 919
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 940
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 954
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 968
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 978
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 995
[smoove]:([E]lumpy-filter) 2020/10/19 16:57:40 Failed to populate reference for id 1010
(....)
[smoove]:([E]lumpy-filter) 2020/10/19 17:08:30 Failed to populate reference for id 2700
[smoove]:([E]lumpy-filter) 2020/10/19 17:08:31 Failed to populate reference for id 2770
[smoove]:([E]lumpy-filter) 2020/10/19 17:08:41 [lumpy_filter] extracted splits and discordants from 746074924 total aligned reads
[smoove]:([E]lumpy-filter) 2020/10/19 17:08:41 mv: cannot stat './/20201012.split.bam.tmp.bam': No such file or directory
[smoove]:2020/10/19 17:08:41 finished process: lumpy-filter (set -eu; lumpy_filter -f /ref/Homo_sapiens_assembly38.fasta /data1/20201012.testmap.B00I4CH.cram .//) in user-time:49m44.575705s system-time:1m5.422232s
[smoove]:2020/10/19 17:08:41 error running command: set -eu; lumpy_filter -f /ref/Homo_sapiens_assembly38.fasta /data1/20201012.testmap.B00I4CH.cram .//20201012.split.bam.tmp.bam .//20201012.disc.bam.tmp.bam 2 && mv .//20201012.split.bam.tmp.bam .//20201012.split.bam && mv .//20201012.disc.bam.tmp.bam .//20201012.disc.bam && cp .//20201012.split.bam .//20201012.split.bam.orig.bam && cp .//20201012.disc.bam .//20201012.disc.bam.orig.bam -> exit status 1
panic: exit status 1
```

can you help me please ?",lindenb,https://github.com/brentp/smoove/issues/134
MDU6SXNzdWU3NDE0MDk5NTg=,panic: read |0: file already closed (+ many small cram files),CLOSED,2020-11-12T08:56:58Z,2020-11-12T15:40:55Z,2020-11-12T15:40:55Z,"Hi @brentp ,

I'm trying to run smoove with a *large* (~1000)  number of *small* (~3M bases) CRAM files. I understand that it is an unusual condition and I might get an error like ""too many files open"".

I got the following error:

```
(...)
[smoove] 2020/11/12 09:50:30 starting lumpy
[smoove] 2020/11/12 09:50:30 wrote lumpy command to .//prefix-lumpy-cmd.sh
panic: read |0: file already closed

goroutine 560216 [running]:
github.com/brentp/smoove/lumpy.check(...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.bndFilter.func1(0xc0031461f8, 0xc0007248c0, 0xc0009c7ce0, 0xc0021382e8, 0x7ffe496e8a7a, 0x19, 0xc00096b380, 0x6)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:307 +0x7ae
created by github.com/brentp/smoove/lumpy.bndFilter
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:266 +0x29f
(...)
```

with the latest docker, launched with singularity:
```

singularity exec\
        --workdir /sandbox/shares/u1087/lindenb/work/NEXTFLOW/prefix \
        --home /sandbox/shares/u1087/lindenb/work/NEXTFLOW/prefix \
        --bind /sandbox/shares/u1087/lindenb/work/prefix/:/data1 \
        --bind /sandbox/resources/species/human/cng.fr/hs37d5/:/ref \
        --bind /sandbox/shares/u1087/lindenb/work/NEXTFLOW/prefix/:/outdir \
        /sandbox/shares/u1087/lindenb/work/NEXTFLOW/prefix/smoove.simg \
        smoove call -x --name prefix \
        --exclude /outdir/exclude.bed  \
        --fasta /ref/hs37d5_all_chr.fasta \
        --duphold \
        -p 16 --genotype /data1/file1.cram (....)

```",lindenb,https://github.com/brentp/smoove/issues/135
MDU6SXNzdWU3NDE0NjgwNTg=,Too many DEL in merge vcf ,OPEN,2020-11-12T10:16:26Z,2022-03-16T14:39:42Z,,"Hi，

I ran smoove pipeline on ~4500 WGS samples and I found 102980 SV including 71367 DEL. The percentage of DEL is too high.  I found the percentage of DEL is ~50%~60% in many published papers.  So I want to filter SV which may be false positive. How could  I filter SV using SU, PE,SR ?   I do not know whether the  result in my study is correct.

Thanks a lot for comments in advance! 
Yi",y1025i,https://github.com/brentp/smoove/issues/136
MDU6SXNzdWU3NDg5NDkyNTE=,"Error ""exit status 83"" for lumpy-filter",OPEN,2020-11-23T16:31:31Z,2022-08-05T06:50:22Z,,"Hello, 
I am trying to run Smoove following instructions and really basic paramètres and just one bam file but I am running into an issue at lumpy-filter stage called ""exit status 83"". Has anyone had this problem (and a solution)? 
Thanks a lot
Claire

 error running command: set -eu; lumpy_filter
[..]
exit status 83
panic: exit status 83
",clairemerot,https://github.com/brentp/smoove/issues/137
MDU6SXNzdWU3NTk0MjA2MTQ=,Filter out low quality calls,CLOSED,2020-12-08T12:51:54Z,2020-12-10T15:14:24Z,2020-12-10T12:49:11Z,"Hello, 

Thank you for developing smoove. 
I am trying to merge calls from different callers, including smoove. 
I'd like to know how I can filter calls that are of low quality/false positives before merging. 
Looking at the output VCF header, I don't see any filtering done. 
I only see Phred score in the QUAL field. Should I be using this instead, e.g. >30? 

I ran smoove as follow: 

```
smoove call \
--outdir ~{outputDir} \
--name ~{sample} \
--fasta ~{referenceFasta} \
--removepr \
--genotype \
~{bamFile}
```



",cagaser,https://github.com/brentp/smoove/issues/138
MDU6SXNzdWU3NzI2MTM2NDM=,"panic if outdir contains ""+""",OPEN,2020-12-22T03:44:39Z,2020-12-22T04:19:28Z,,"Hello,
I met a minor bug: soomve call may translate ""+"" in into \&#43;, which leads to a panic.
It happens in soomve call --outdir , but no problem with BAMS path. The problematic command can be found in *lumpy-cmd.sh
Thanks a lot

CMD: smoove call --outdir /path/with+/  ... /path/with+/1.bam
panic: exit status 255",plmsuper8,https://github.com/brentp/smoove/issues/139
MDU6SXNzdWU3NzU4Nzk1MDc=,VEP problems,OPEN,2020-12-29T12:57:17Z,2020-12-30T09:01:08Z,,"When I try to annotate the results with VEP I get:

```
WARNING: variant 259 on line 280 is too long to annotate: (78162751)
WARNING: variant 260 on line 281 is too long to annotate: (78180620)
WARNING: variant 398 on line 422 is too long to annotate: (11790044)
...
WARNING: variant 416 on line 442 is too long to annotate: (66354472)
Exiting the program. The input file appears to be unsorted. Please sort by chromosome and by location and re-submit.
```
Is smoove supposed to be VEP friendly? Are there any additional steps of post-proccessing  (or some specific VEP parameters) needed to make it work?",antonkulaga,https://github.com/brentp/smoove/issues/140
MDU6SXNzdWU3Nzg2MjgxOTA=,Error: sample CXL_FDSW202345319-1r not found in JSON library file.,OPEN,2021-01-05T06:30:20Z,2021-01-07T04:02:12Z,,"@brentp 
  hi , it report a error when i running smoove. the command is：smoove call -x --name CXL --fasta ../Ref/CXL-1.build.chr.fa --processes 10 --genotype CXL.sort.fixmate.rmdup.bam。
     the error is :
       
![QQ截图20210105142813](https://user-images.githubusercontent.com/48479509/103613834-43558700-4f62-11eb-8769-01d1fa4bc8c8.png)

Is this problem caused by the sample name containing Chinese ?（my sample name is 穿心莲_FDSW202345319-1r) ",ChenDepp,https://github.com/brentp/smoove/issues/141
MDU6SXNzdWU3OTA4NjkyNDA=,"smoove failed with ""panic: exit status 1""",OPEN,2021-01-21T09:34:51Z,2021-01-24T11:55:03Z,,"Hello, everyone! I have some strange error while I run smoove.
At begeinning, I run smoove for a sample and it succeeded. But after that, I run smoove for the rest of samples and it had errors. While I can alse run succeed for that previous sucessful sample. 
The bam files was get from bwa mem, and remove duplicated reads by samtools and GATK (MarkDuplicates).
It confused me deeply. Any helps with most appreciation.


Here is the command what I run:
smoove call --outdir . --name ERR4133368.sort --fasta ../../ARS1/ARS1_2175.fa -p 1 --genotype ERR4133368.markdup_samAndGATK.bam


And here is the error massages:

[smoove] 2021/01/21 16:38:40 starting with version 0.2.6
[smoove] 2021/01/21 16:38:40 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2021/01/21 16:38:40 /bin/bash: a: unbound variable
[smoove]:2021/01/21 16:38:40 finished process: lumpy-filter (set -eu; lumpy_filter -f ../../ARS1/ARS1_2175.fa ERR4133368.markdup_samAndGATK.bam ./${a}.split.bam.) in user-time:0s system-time:3.917ms
[smoove]:2021/01/21 16:38:40 error running command: set -eu; lumpy_filter -f ../../ARS1/ARS1_2175.fa ERR4133368.markdup_samAndGATK.bam ./${a}.split.bam.tmp.bam ./${a}.disc.bam.tmp.bam 2 && mv ./${a}.split.bam.tmp.bam ./${a}.split.bam && mv ./${a}.disc.bam.tmp.bam ./${a}.disc.bam && cp ./${a}.split.bam ./${a}.split.bam.orig.bam && cp ./${a}.disc.bam ./${a}.disc.bam.orig.bam -> exit status 1
[smoove] 2021/01/21 16:38:52 done calculating bam stats
panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.Lumpy(0x7fff3079763a, 0xf, 0x7fff30797652, 0x17, 0x7fff30797631, 0x1, 0xc000145600, 0x1, 0x1, 0xc0001012c0, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:127 +0x57e
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
        /home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce",QianghuiZhu,https://github.com/brentp/smoove/issues/142
MDU6SXNzdWU3OTI1NDA4NDg=,"smoove failed with ""panic: exit status 1"",bam.header['RG'][0]['SM'], KeyError: 'RG'",OPEN,2021-01-23T12:03:23Z,2021-12-24T17:53:52Z,,"Hello, I run smoove v.0.2.6 within a pipeline https://github.com/antonkulaga/dna-seq, in a container.
To the moment I got two different samples ended up with the same error result. Input bam sequence is assembled by gencore 0.15.0 (https://github.com/OpenGene/gencore)

Any help would be most appreciated.

Here is the call:
`smoove call \
--genotype \
--duphold \
--outdir ./smoove \
--name newtonwinter \
--fasta /cromwell-executions/simple_variant_calling/f07e572a-f716-49bf-880b-f21b1e5e9f3f/call-smoove/inputs/-2130065579/Homo_sapiens.GRCh38.dna.primary_assembly.fa \
/cromwell-executions/simple_variant_calling/f07e572a-f716-49bf-880b-f21b1e5e9f3f/call-smoove/inputs/635203113/newtonwinter.bam`

And below are two results 
`[smoove] 2021/01/21 18:23:01 starting with version 0.2.6
[smoove] 2021/01/21 18:23:01 calculating bam stats for 1 bams
[smoove] 2021/01/21 18:23:06 done calculating bam stats
[smoove]: ([E]lumpy-filter) 2021/01/21 19:42:23 [lumpy_filter] extracted splits and discordants from 791026571 total aligned reads
[smoove]:2021/01/21 19:42:34 finished process: lumpy-filter (set -eu; lumpy_filter -f /cromwell-executions/simple_variant_calling/f07e572a-f716-49bf-880b-f21b1e5) in user-time:7m53.20496s system-time:13m51.817111s
2021/01/21 19:43:04 short read
2021/01/21 19:43:06 short read
[smoove] 2021/01/21 19:43:09 removed 686122 alignments out of 900303 (76.21%) with low mapq, depth > 1000, or from excluded chroms from newtonwinter.split.bam in 35 seconds
[smoove] 2021/01/21 19:43:09 removed 63384 alignments out of 900303 (7.04%) that were bad interchromosomals or flanked-splitters from newtonwinter.split.bam
[smoove] 2021/01/21 19:43:11 kept 1610 putative orphans
[smoove] 2021/01/21 19:43:11 removed 39 split orphans in 1 seconds
[smoove] 2021/01/21 19:43:11 removed 147915 singletons of 150797 reads (98.09%) from newtonwinter.split.bam in 3 seconds
[smoove] 2021/01/21 19:43:11 2882 reads (0.32%) of the original 900303 remain from newtonwinter.split.bam
[smoove] 2021/01/21 19:44:42 removed 6620396 alignments out of 14351288 (46.13%) with low mapq, depth > 1000, or from excluded chroms from newtonwinter.disc.bam in 128 seconds
[smoove] 2021/01/21 19:44:42 removed 95432 alignments out of 14351288 (0.66%) that were bad interchromosomals or flanked-splitters from newtonwinter.disc.bam
[smoove] 2021/01/21 19:45:56 kept 19144 putative orphans
[smoove] 2021/01/21 19:45:56 removed 300382 discordant orphans in 39 seconds
[smoove] 2021/01/21 19:46:31 removed 2183633 singletons and isolated interchromosomals of 7635460 reads (28.60%) from newtonwinter.disc.bam in 109 seconds
[smoove] 2021/01/21 19:46:31 5451827 reads (37.99%) of the original 14351288 remain from newtonwinter.disc.bam
[smoove] 2021/01/21 19:46:33 starting lumpy
[smoove] 2021/01/21 19:46:34 wrote lumpy command to ./smoove/newtonwinter-lumpy-cmd.sh
[smoove] 2021/01/21 19:46:34 writing sorted, indexed file to smoove/newtonwinter-smoove.genotyped.vcf.gz
[smoove] 2021/01/21 19:46:34 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2021/01/21 19:46:36 > gsort version 0.0.6
[smoove] 2021/01/21 19:46:36 684
[smoove] 2021/01/21 19:46:36 	
[smoove] 2021/01/21 19:46:36 0
[smoove] 2021/01/21 19:46:36 
[smoove] 2021/01/21 19:46:36 1
[smoove] 2021/01/21 19:46:36 	
[smoove] 2021/01/21 19:46:36 1000000
[smoove] 2021/01/21 19:46:36 
[smoove] 2021/01/21 19:46:42 Traceback (most recent call last):
[smoove] 2021/01/21 19:46:42   File ""/opt/conda/envs/smoove-env/bin/svtyper"", line 11, in <module>
    load_entry_point('svtyper==0.7.0', 'console_scripts', 'svtyper')()
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 575, in cli
[smoove] 2021/01/21 19:46:42     
[smoove] 2021/01/21 19:46:42 sys.exit(main())
[smoove] 2021/01/21 19:46:42   File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 568, in main
[smoove] 2021/01/21 19:46:42     
[smoove] 2021/01/21 19:46:42 args.max_ci_dist)
[smoove] 2021/01/21 19:46:42   File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 150, in sv_genotype
[smoove] 2021/01/21 19:46:42     
[smoove] 2021/01/21 19:46:42 sample = Sample.from_bam(bam_list[i], num_samp, min_lib_prevalence)
[smoove] 2021/01/21 19:46:42   File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/parsers.py"", line 665, in from_bam
[smoove] 2021/01/21 19:46:42     
[smoove] 2021/01/21 19:46:42 name = bam.header['RG'][0]['SM']
[smoove] 2021/01/21 19:46:42   File ""pysam/libcalignmentfile.pyx"", line 548, in pysam.libcalignmentfile.AlignmentHeader.__getitem__
[smoove] 2021/01/21 19:46:42 KeyError
[smoove] 2021/01/21 19:46:42 : 
[smoove] 2021/01/21 19:46:42 'RG'
[smoove] 2021/01/21 19:46:42 
panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xbd6ec0, 0xc0000ca0b0, 0x7ffcbee8dbe8, 0x9b, 0xc0001a8240, 0x1, 0x1, 0x7ffcbee8dbc3, 0x8, 0x7ffcbee8dbd3, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:159 +0x1818
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:347 +0x44f
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce`

And the same ""bam.header['RG'][0]['SM']"" issue with the second one at he same processing step:

`[smoove] 2021/01/22 22:24:24 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2021/01/22 22:24:24 716	
[smoove] 2021/01/22 22:24:24 0
[smoove] 2021/01/22 22:24:25 1	1000000
[smoove] 2021/01/22 22:24:25 > gsort version 0.0.6
[smoove] 2021/01/22 22:24:37 Traceback (most recent call last):
[smoove] 2021/01/22 22:24:37   File ""/opt/conda/envs/smoove-env/bin/svtyper"", line 11, in <module>
    load_entry_point('svtyper==0.7.0', 'console_scripts', 'svtyper')()
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 575, in cli
    sys.exit(main())
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 568, in main
    args.max_ci_dist)
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 150, in sv_genotype
    sample = Sample.from_bam(bam_list[i], num_samp, min_lib_prevalence)
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/parsers.py"", line 665, in from_bam
    name = bam.header['RG'][0]['SM']
  File ""pysam/libcalignmentfile.pyx"", line 548, in pysam.libcalignmentfile.AlignmentHeader.__getitem__
KeyError: 'RG'
panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xbd6ec0, 0xc00013c550, 0x7ffc1b6419ee, 0xed, 0xc0001a6240, 0x1, 0x1, 0x7ffc1b6419bd, 0x8, 0x7ffc1b6419cd, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:159 +0x1818
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:347 +0x44f
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce`

",winternewt,https://github.com/brentp/smoove/issues/143
MDU6SXNzdWU4MDE5NzkwOTA=,Samtools CSI index,OPEN,2021-02-05T08:54:40Z,2022-04-05T23:24:39Z,,"Hi,

thanks a lot for the development of this tool. I am trying to use smoove for a triticum genome and the program give an error saying that it cannot create a bai index for such genome size and to create a csi index instead.

` cannot be stored in a bai index. Try using a csi index with min_shift = 14, n_lvls >= 6`

I am aware of this problem and usually for indexing I use the -c option of samtools index, but it cannot be customized from the smoove command line. I also have ready-made csi index but smoove seems to ignore them.

lumpyexpress works fine instead
Thanks a lot!!",aariani,https://github.com/brentp/smoove/issues/144
MDU6SXNzdWU4MjQ5MjYwNTA=,lumpy_filter: command not found,OPEN,2021-03-08T20:30:53Z,2021-03-09T05:54:32Z,,"Hi 
I installed smoove by conda on linux, but when running it, there are some errors 

[smoove]: ([E]lumpy-filter) 2021/03/08 15:28:07 /bin/bash: lumpy_filter: command not found

Do you know how to fix it?

",fengpku,https://github.com/brentp/smoove/issues/145
MDU6SXNzdWU4NTU0NzY3MjA=,"error when starting lumpy, panic: runtime error: invalid memory address or nil pointer dereference",CLOSED,2021-04-12T01:56:02Z,2021-04-12T09:27:51Z,2021-04-12T06:59:38Z,"Whether -p 1 or others will get same error.
I had run it at other linux HPC, but this one can't do it.
Please help me fix it.
Thanks a lot.

Installed smoove by conda, 
```{shell}
conda create -n smoove -c bioconda smoove
```

Run code
```{shell}
smoove call \
	-p 1 \
	--outdir ${wd} \
	--exclude $gap \
	--name ${wd}/${id}.part1 \
	--fasta $ref_fa \
	--genotype ${id}.rmdup.bam
```

Logs
```{shell}
[smoove] 2021/04/12 09:32:41 starting with version 0.2.6
[smoove] 2021/04/12 09:32:41 calculating bam stats for 1 bams
[smoove] 2021/04/12 09:33:18 done calculating bam stats
[smoove] 2021/04/12 09:34:43 removed 0 alignments out of 150976 (0.00%) with low mapq, depth > 1000, or from excluded chroms from GLGS30.disc.bam in 85 seconds
[smoove] 2021/04/12 09:34:43 removed 0 alignments out of 150976 (0.00%) that were bad interchromosomals or flanked-splitters from GLGS30.disc.bam
[smoove] 2021/04/12 09:34:46 kept 5985 putative orphans
[smoove] 2021/04/12 09:34:46 removed 580 discordant orphans in 2 seconds
[smoove] 2021/04/12 09:34:50 removed 1160 singletons and isolated interchromosomals of 150976 reads (0.77%) from GLGS30.disc.bam in 7 seconds
[smoove] 2021/04/12 09:34:50 149816 reads (99.23%) of the original 150976 remain from GLGS30.disc.bam
[smoove] 2021/04/12 09:36:08 removed 0 alignments out of 224804 (0.00%) with low mapq, depth > 1000, or from excluded chroms from GLGS30.split.bam in 78 seconds
[smoove] 2021/04/12 09:36:08 removed 0 alignments out of 224804 (0.00%) that were bad interchromosomals or flanked-splitters from GLGS30.split.bam
[smoove] 2021/04/12 09:38:20 kept 122864 putative orphans
[smoove] 2021/04/12 09:38:20 removed 1269 split orphans in 115 seconds
[smoove] 2021/04/12 09:38:25 removed 2538 singletons of 224804 reads (1.13%) from GLGS30.split.bam in 137 seconds
[smoove] 2021/04/12 09:38:25 222266 reads (98.87%) of the original 224804 remain from GLGS30.split.bam
[smoove] 2021/04/12 09:38:27 starting lumpy
panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x9cc780]

goroutine 1 [running]:
os.(*File).Name(...)
        /home/brentp/go/src/os/file.go:54
github.com/brentp/smoove/lumpy.run_lumpy(0xc0001ada00, 0x1, 0x1, 0x7fff5d342a1d, 0x4c, 0x7fff5d34292b, 0x3d, 0x0, 0x7fff5d3429ca, 0x4a, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:163 +0x5f0
github.com/brentp/smoove/lumpy.Lumpy(0x7fff5d3429ca, 0x4a, 0x7fff5d342a1d, 0x4c, 0x7fff5d34292b, 0x3d, 0xc000187610, 0x1, 0x1, 0xc000190a00, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:132 +0x39b
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
        /home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce
```",xyxss,https://github.com/brentp/smoove/issues/146
MDU6SXNzdWU4NjM3ODE2MzU=,lumpy_filter: error while loading shared libraries: libcrypto.so.1.0.0,CLOSED,2021-04-21T11:48:09Z,2021-04-30T15:52:39Z,2021-04-30T15:52:39Z,"Hi, 

I downloaded Smoove using miniconda3 onto my local user space due to not having access to docker on my institution's system. When I run Smoove I get the error message: 

lumpy_filter: error while loading shared libraries: libcrypto.so.1.0.0: cannot open shared object file: No such file or directory

After some searching around I've tried locally installing openSSH v1.0.0 and calling that in my bash script but still get the same error message. I've also tried installing smoove locally from the binaries but can't seem to get the package built from the smoove.go file. 

If you'd be able to offer a solution to the libcrypto error or instructions on installing from binaries then I'd be most grateful! 

Thank you in advance for the time, Dan. ",DanielOsmond,https://github.com/brentp/smoove/issues/147
MDU6SXNzdWU4NjQ5OTM5ODQ=,"""Missing pair end parameters:mean stdev"" - different read lengths creating problems?",OPEN,2021-04-22T14:06:08Z,2021-10-10T22:30:52Z,,"Hi,

I'm trying to run smoove using the docker container. I have 12 BAM files with different read length (50 and 86). 0 reads were removed during the filtering phase.

As you can see in the log, I have a similar output as this issue: https://github.com/brentp/smoove/issues/70

However, when doing samtools flagstat, I have 0 issue with my BAM files, everything passes the QC. 

In the command file created by smoove, I can read some stuff about read length, back distance (?) and discordant z (?) that I don't understand. Does the difference in read length keep me from getting the results?

Any help would be appreciated :)

Best,
Mas.

---------------------------------------------------------------------------------------------------------
[smoove] 2021/04/22 15:35:56 starting lumpy
[smoove] 2021/04/22 15:35:56 wrote lumpy command to output/1st_SV-lumpy-cmd.sh
[smoove] 2021/04/22 15:35:56 writing sorted, indexed file to output/1st_SV-smoove.genotyped.vcf.gz
[smoove] 2021/04/22 15:35:56 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2021/04/22 15:35:56 missing pair end parameters:mean stdev 
[smoove] 2021/04/22 15:35:56 

Program: ********** (v 0.2.13)
Author:  Ryan Layer (rl6sf@virginia.edu)
Summary: Find structural variations in various signals.
[smoove] 2021/04/22 15:35:56 
Usage:   ********** [OPTIONS] 

Options: 
        -g      Genome file (defines chromosome order)
[smoove] 2021/04/22 15:35:56 
        -e      Show evidence for each call
[smoove] 2021/04/22 15:35:56    -w      File read windows size (default 1000000)
        -mw     minimum weight for a call
[smoove] 2021/04/22 15:35:56 
        -msw    minimum per-sample weight for a call
        -tt     trim threshold
[smoove] 2021/04/22 15:35:56 
        -x      exclude file bed file
[smoove] 2021/04/22 15:35:56    -t      temp file prefix, must be to a writeable directory
        -P      output probability curve for each variant
[smoove] 2021/04/22 15:35:56    -b      output BEDPE instead of VCF
        -sr     bam_file:<file name>,
                id:<sample name>,
[smoove] 2021/04/22 15:35:56            back_distance:<distance>,
                min_mapping_threshold:<mapping quality>,
[smoove] 2021/04/22 15:35:56 
                weight:<sample weight>,
                min_clip:<minimum clip length>,
[smoove] 2021/04/22 15:35:56 
                read_group:<string>
[smoove] 2021/04/22 15:35:56 
        -pe     bam_file:<file name>,
[smoove] 2021/04/22 15:35:56            id:<sample name>,
                histo_file:<file name>,
                mean:<value>,
                stdev:<value>,
[smoove] 2021/04/22 15:35:56            read_length:<length>,
                min_non_overlap:<length>,
[smoove] 2021/04/22 15:35:56 
                discordant_z:<z value>,
[smoove] 2021/04/22 15:35:56 
                back_distance:<distance>,
[smoove] 2021/04/22 15:35:56            min_mapping_threshold:<mapping quality>,
                weight:<sample weight>,
[smoove] 2021/04/22 15:35:56 
                read_group:<string>
[smoove] 2021/04/22 15:35:56 
        -bedpe  bedpe_file:<bedpe file>,
[smoove] 2021/04/22 15:35:56            id:<sample name>,
                weight:<sample weight>
[smoove] 2021/04/22 15:35:56 

[smoove] 2021/04/22 15:35:56 > gsort version 0.0.6
[smoove] 2021/04/22 15:35:59 Traceback (most recent call last):
  File ""/opt/conda/envs/smoove-env/bin/svtyper"", line 11, in <module>
[smoove] 2021/04/22 15:35:59     load_entry_point('svtyper==0.7.0', 'console_scripts', 'svtyper')()
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 575, in cli
[smoove] 2021/04/22 15:35:59     sys.exit(main())
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 568, in main
[smoove] 2021/04/22 15:35:59     args.max_ci_dist)
  File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/classic.py"", line 150, in sv_genotype
[smoove] 2021/04/22 15:35:59     sample = Sample.from_bam(bam_list[i], num_samp, min_lib_prevalence)
[smoove] 2021/04/22 15:35:59   File ""/opt/conda/envs/smoove-env/lib/python2.7/site-packages/svtyper/parsers.py"", line 665, in from_bam
[smoove] 2021/04/22 15:35:59     name = bam.header['RG'][0]['SM']
  File ""pysam/libcalignmentfile.pyx"", line 548, in pysam.libcalignmentfile.AlignmentHeader.__getitem__
[smoove] 2021/04/22 15:35:59 KeyError: 'RG'
panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
        /home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xbd6ec0, 0xc001aa4440, 0x7ffe7303ffdc, 0xd, 0xc0001ac300, 0xc, 0x10, 0x7ffe730402bd, 0x6, 0x7ffe7303ff92, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:159 +0x1818
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:347 +0x44f
main.main()
        /home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce

",JSegueni,https://github.com/brentp/smoove/issues/148
MDU6SXNzdWU4NjYzOTMxMzE=,Question about a particular deletion call,CLOSED,2021-04-23T19:59:13Z,2021-05-09T17:35:43Z,2021-05-09T17:35:42Z,"Hi Brent,

Thanks for making this excellent tool!  I've got a question about evaluating some of the quality of my SV calling results.  I ran smoove to call SVs on 4 high coverage plant samples with the following:

```
smoove call \
-x \
--name oenothera \
--fasta ref/elata_reference_assembly.fasta \
-p 24 \
--outdir smoove \
--duphold \
--genotype bams/*.bam 2>&1 | tee smoove.log
```

I then filtered based on the duphold annotations with:

```
bcftools view \
-i '(SVTYPE = ""DEL"" & FMT/DHFFC[0] < 0.7) | (SVTYPE = ""DUP"" & FMT/DHBFC[0] > 1.3 )' oenothera-smoove.genotyped.duphold.vcf  > oenothera-smoove.genotyped.duphold.filtered.vcf
```

I'm now in the process of visualizing the read support for the SV calls using [svviz2](https://svviz2.readthedocs.io/en/latest/)

So far, most of the SV's that I've taken a look at seem well supported.  However, there is one fairly large (~ 128 Kb) deletion I looked at that svviz2 suggests does not have much read support.  Here is the line in the vcf:

`HiC_scaffold_1  698736  26      N       <DEL>   1366.07 .       SVTYPE=DEL;SVLEN=-127936;END=826672;STRANDS=+-:19;IMPRECISE;CIPOS=-30,195;CIEND=-88,4;CIPOS95=0,28;CIEND95=-27,0;SU=19;PE=19;SR=0;GCF=0.488193;AN=8;AC=3   GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB:DHFC:DHFFC:DHBFC:DHSP:DHGT        1/1:107:1240.78:-126,-13,-2:43:0:43:0:42:0:0:26:0:16:1:0:0:0:17:7,5,7,63,27     0/0:200:0:-0,-23,-78:79:79:0:78:0:38:0:0:40:0:0:0.884615:0.766667:0.958333:0:106,1,0,0,2   0/0:200:0:-0,-29,-95:96:96:0:95:0:68:0:0:27:0:0:0.0217391:0.0217391:0.0322581:0:9,1,66,11,22    0/1:125:125.29:-27,-15,-76:111:94:16:93:15:69:0:11:24:4:0.14:0.596154:0.5:0.775:5:61,1,0,0,47`

And here is the visualization:

![image](https://user-images.githubusercontent.com/25590156/115922588-182c7000-a44b-11eb-8dea-ea75071ab0f0.png)

There are almost no reads found in this region, although the VCF suggests there are 19 PE reads that support the variant.

This might not be an easy question to answer, but do you have any idea what could result in the discrepancy between these two results?  Is there any information in the INFO or FORMAT fields of the vcf entry that would suggest that this is an unreliable call?

I'm trying to be fairly conservative, so I'd ideally like to do some more downstream filtering to remove additional spurious SVs.  Any suggestions or insights you might have would be useful!
Thanks,
Dave

",davidecarlson,https://github.com/brentp/smoove/issues/149
MDU6SXNzdWU4Nzc3MjAzMzA=, error opening fasta file: ref/hg38.fasta: no fai for fasta,CLOSED,2021-05-06T16:43:53Z,2024-06-13T19:07:20Z,2021-05-06T16:52:00Z,"I ran the following command : 

```
docker run -it -v ${PWD}:/input -v /mnt/R60/bioinformatique/hg38/:/ref brentp/smoove smoove call -x --name test --exclude /ref/exclude.cnvnator_100bp.GRCh38.20170403.bed --fasta ref/hg38.fasta -p 10 --genotype /input/OneSegHumanFemale1.dedup.bam /input/OneSegHumanFemale2.dedup.bam /input/OneSegHumanFemale3.dedup.bam /input/OneSegHumanFemale4.dedup.bam /input/SGT152803pur1.dedup.bam /input/SGT152803pur2.dedup.bam /input/SGT153103nonpur1.dedup.bam /input/SGT153103nonpur2.dedup.bam
```

I get this error : 


```

[smoove] 2021/05/06 16:15:32 starting lumpy
[smoove] 2021/05/06 16:15:32 wrote lumpy command to .//test-lumpy-cmd.sh
[smoove] 2021/05/06 16:15:32 writing sorted, indexed file to test-smoove.genotyped.vcf.gz
[smoove] 2021/05/06 16:15:32 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2021/05/06 16:15:32 > gsort version 0.0.6
[smoove] 2021/05/06 16:15:32 chr1       1000000
panic: error opening fasta file: ref/hg38.fasta: no fai for fasta

goroutine 196547 [running]:
github.com/brentp/smoove/lumpy.check(...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.writeContigs(0xc000147dc0, 0x7ffec56c4db3, 0xe)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:223 +0x558
github.com/brentp/smoove/lumpy.bndFilter.func1(0xc0057462e8, 0xc000147dc0, 0xc00d579500, 0xc008fe3aea, 0x7ffec56c4db3, 0xe, 0xc000db1260, 0x6)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:275 +0x1e9
created by github.com/brentp/smoove/lumpy.bndFilter
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:266 +0x29f
```

But I am sure I have the FAI file  ( generated with samtools faidx ) 

```
(gatk) ➜  output ls /mnt/R60/bioinformatique/hg38/hg38.fasta*
/mnt/R60/bioinformatique/hg38/hg38.fasta      /mnt/R60/bioinformatique/hg38/hg38.fasta.ann  /mnt/R60/bioinformatique/hg38/hg38.fasta.fai  /mnt/R60/bioinformatique/hg38/hg38.fasta.sa
/mnt/R60/bioinformatique/hg38/hg38.fasta.amb  /mnt/R60/bioinformatique/hg38/hg38.fasta.bwt  /mnt/R60/bioinformatique/hg38/hg38.fasta.pac
```

I have no idea... which file name it is looking for ? 
",dridk,https://github.com/brentp/smoove/issues/150
MDU6SXNzdWU4OTE5ODgxNTc=,smoove/paste + singularty + 1185 vcfs: argument list too long,CLOSED,2021-05-14T14:52:16Z,2021-05-19T12:52:14Z,2021-05-18T19:31:11Z,"Hi @brentp 

I'm trying to use smoove/paste with singularity and 1185 bams. I got an error 

> argument list too long

it's not clear to me if the problem comes from bash/singularity/smoove.

1) is it possible to use a divide-and-conquer strategy with `paste` ? :  paste vcfs 1-100, paste vcfs 101-200, paste vcfs 201-300, etc... and then paste the merged vcfs ?

2)  Am I wrong ? smoove doesn't support a `.list` extension like you did here : https://github.com/brentp/somalier/issues/37#issuecomment-550502468 ?

thank you again for your help :-)

",lindenb,https://github.com/brentp/smoove/issues/151
MDU6SXNzdWU5MDgwNTg3NTI=,INFO/END< POS,OPEN,2021-06-01T08:46:08Z,2021-08-27T08:23:34Z,,"Hi,

FYI, when using /smoove-0.2.6 + singularity. With  `smoove genotype ` , some variants have POS>INFO/END.

command:

```
        singularity exec\
                --home \${PWD} \
                --bind ${bam.getParent()}:/bamdir \
                --bind ${vcf0.getParent()}:/mergeddir \
                --bind ${ref.getParent()}:/ref \
                --bind \${PWD}/TMP:/outdir \
                ${img} \
                smoove genotype -x  \
                        --vcf /mergeddir/${vcf0.name} \
                        --outdir /outdir \
                        --name ${sample} \
                        --fasta /ref/${ref.name} \
                        -p ${task.cpus} \
                        /bamdir/${bam.name}
```

log:
```
(..)
[smoove] 2021/06/01 10:16:57 Unpaired breakends found in file. These will not be present in output.
[smoove] 2021/06/01 10:17:21 [W::vcf_parse_info] INFO/END=60694778 is smaller than POS at chr2:60694786
[smoove] 2021/06/01 10:17:38 [W::tbx_parse1] VCF INFO/END=60694778 is smaller than POS at chr2:60694785
This tag will be ignored. Note: only one invalid END tag will be reported.
```

example:
```
chr2	60694786	23097	N	<DEL>	0	.	SVTYPE=DEL;SVLEN=8;END=60694778;STRANDS=+-:19;IMPRECISE;CIPOS=-342,65;CIEND=-31,228;CIPOS95=-299,65;CIEND95=-31,184;SU=19;PE=19;SR=0;SNAME=C001Q1M:404,C001KCJ:430;ALG=SUM	GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB	0/0:69:0:-0,-7,-23:23:23:0:23:0:23:0:0:0:0:0
```

the variant was already present in the 'merge' vcf:
```
chr2	60694786	23097	N	<DEL>	0	.	SVTYPE=DEL;SVLEN=8;END=60694778;STRA
NDS=+-:19;IMPRECISE;CIPOS=-342,65;CIEND=-31,228;CIPOS95=-299,65;CIEND95=-31,184;SU=19;PE=19;SR=0;PRP
OS=5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.
00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.00000
004629e-101,5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.0000000462
9e-101,5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,5.00000004629e-101,1.29049001195e-14
,1.48594501376e-13,1.71036001583e-12,1.4477650134e-11,1.22533001134e-10,1.0367600096e-09,8.772550081
21e-09,7.4207000687e-08,4.61517504273e-07,2.86851502656e-06,1.78328001651e-05,0.000110799001026,0.00
0201623001867,0.000366606003394,0.000666555006171,0.00121138001121,0.00220115502038,0.00294220002724
,0.00393070003639,0.00525145004862,0.00701510006494,0.00936785008673,0.0125010001157,0.0122675501136
,0.0120353001114,0.0118050501093,0.0115775001072,0.0113507001051,0.011124100103,0.0109008001009,0.01
06827000989,0.0104616000969,0.0102479500949,0.0100391500929,0.00982850009099,0.00961885008905,0.0094
1200008713,0.00920950008526,0.00900580008337,0.00880205008149,0.00860295007964,0.00841000007786,0.00
82196000761,0.00802755007432,0.00783575007254,0.00764660007079,0.00746275006909,0.00727920006739,0.0
0709835006572,0.00692030006407,0.00674400006243,0.00657360006086,0.00640310005928,0.00623425005772,0
.00607285005622,0.00591025005472,0.00575125005324,0.00559325005178,0.00543675005033,0.00528535004893
(...)
```
",lindenb,https://github.com/brentp/smoove/issues/152
MDU6SXNzdWU5MTMwMDQxOTM=,Using CRAM instead of BAM when genotyping samples for SVs?,CLOSED,2021-06-07T00:59:39Z,2021-06-07T06:45:51Z,2021-06-07T06:45:51Z,"Hello.

I have done SV calling using smoove but I do not have enough disk space for storing BAM files for a large number of samples I am working with (12,500 samples). Is it possible to use CRAM files instead when genotyping them for SVs?

Thank you in advance,
Best,
Saeideh ",Saeideh-Ashouri,https://github.com/brentp/smoove/issues/153
MDU6SXNzdWU5MjY1NDUzMjY=,Docker fails on conda create,CLOSED,2021-06-21T19:54:48Z,2021-06-21T20:25:09Z,2021-06-21T20:25:09Z,"Test docker build of new smoove version yields the following errors:

```
 => ERROR [5/9] RUN conda create -n smoove-env -c conda-forge -c bioconda python=2.7 click awscli numpy scipy cython pysam toolshed pyvcf pyfaidx cyvcf2 svtyper svtools                                                                                97.8s
------
 > [5/9] RUN conda create -n smoove-env -c conda-forge -c bioconda python=2.7 click awscli numpy scipy cython pysam toolshed pyvcf pyfaidx cyvcf2 svtyper svtools:
#8 0.690 Collecting package metadata (current_repodata.json): ...working... done
#8 10.05 Solving environment: ...working... failed with repodata from current_repodata.json, will retry with next repodata source.
#8 13.30 Collecting package metadata (repodata.json): ...working... done
#8 46.25 Solving environment: ...working... Killed
------
executor failed running [/bin/sh -c conda create -n smoove-env -c conda-forge -c bioconda python=2.7 click awscli numpy scipy cython pysam toolshed pyvcf pyfaidx cyvcf2 svtyper svtools]: exit code: 137
```",srynobio,https://github.com/brentp/smoove/issues/154
MDU6SXNzdWU5Mjc1MzU4NzQ=,Specifying multiple BAM files in singularity command,CLOSED,2021-06-22T18:47:51Z,2021-06-25T17:33:35Z,2021-06-25T16:56:45Z,"Hey Brent,

Loving smoove for SV calling, and I'm using singularity to work with your docker container (latest as of 2021-06-21). 

The container works great, but when I specify *bam in the singularity command, it throws an error that it can't find the file. Perhaps this is a simple fix but I couldn't find much about using wildcards for files in singularity. 

This works:

```
# Go to the submission directory (where the sbatch was entered)
cd $SLURM_SUBMIT_DIR
WORKING_DIR=/mnt/scratch/Precision/EPGEN/PROCESS/EPGEN029/

## Set working space
mkdir -p $WORKING_DIR
cd $WORKING_DIR

#### GRCh38 #### 
echo ""GRCh38 genome""
GENOME=GRCh38
FASTA_DIR=/mnt/common/DATABASES/REFERENCES/GRCh38/GENOME/1000G/
FASTA_FILE=GRCh38_full_analysis_set_plus_decoy_hla.fa

SEQ_TYPE=WGS
BAM_DIR=$WORKING_DIR
FAMILY_ID=EPGEN029
PROBAND_ID=EPGEN029-01
MOTHER_ID=EPGEN029-02
FATHER_ID=EPGEN029-03
PED=$FAMILY_ID.ped

PROBAND_BAM=${PROBAND_ID}_${GENOME}.dupremoved.sorted.bam
FATHER_BAM=${FATHER_ID}_${GENOME}.dupremoved.sorted.bam
MOTHER_BAM=${MOTHER_ID}_${GENOME}.dupremoved.sorted.bam

# Smooooooove 
singularity run \
        -B /usr/lib/locale/:/usr/lib/locale/ \
        -B ""${BAM_DIR}"":""/bamdir/"" \
        -B ""${FASTA_DIR}"":""/genomedir/"" \
        -B ""${OUTPUT_DIR}"":""/output/"" \
        /mnt/common/Precision/Smoove/smoove_latest.sif \
        smoove call \
        --outdir ""/output/results-smoove/"" \
        -p $NSLOTS \
        -x --name ${FAMILY_ID} \
        --fasta ""/genomedir/$FASTA_FILE"" \
        --genotype \
        ""/bamdir/$PROBAND_BAM"" \
        ""/bamdir/$MOTHER_BAM"" \
        ""/bamdir/$FATHER_BAM"" \
```

And is blazing fast, love it. 

But this does not work:


```
# Go to the submission directory (where the sbatch was entered)
cd $SLURM_SUBMIT_DIR
WORKING_DIR=/mnt/scratch/Precision/EPGEN/PROCESS/EPGEN029/

## Set working space
mkdir -p $WORKING_DIR
cd $WORKING_DIR

#### GRCh38 #### 
echo ""GRCh38 genome""
GENOME=GRCh38
FASTA_DIR=/mnt/common/DATABASES/REFERENCES/GRCh38/GENOME/1000G/
FASTA_FILE=GRCh38_full_analysis_set_plus_decoy_hla.fa

SEQ_TYPE=WGS
BAM_DIR=$WORKING_DIR
FAMILY_ID=EPGEN029
PROBAND_ID=EPGEN029-01
MOTHER_ID=EPGEN029-02
FATHER_ID=EPGEN029-03
PED=$FAMILY_ID.ped

PROBAND_BAM=${PROBAND_ID}_${GENOME}.dupremoved.sorted.bam
FATHER_BAM=${FATHER_ID}_${GENOME}.dupremoved.sorted.bam
MOTHER_BAM=${MOTHER_ID}_${GENOME}.dupremoved.sorted.bam


# Smooooooove 

singularity run \
        -B /usr/lib/locale/:/usr/lib/locale/ \
        -B ""${BAM_DIR}"":""/bamdir/"" \
        -B ""${FASTA_DIR}"":""/genomedir/"" \
        -B ""${OUTPUT_DIR}"":""/output/"" \
        /mnt/common/Precision/Smoove/smoove_latest.sif \
        smoove call \
        --outdir ""/output/results-smoove/"" \
        -p $NSLOTS \
        -x --name ${FAMILY_ID} \
        --fasta ""/genomedir/$FASTA_FILE"" \
        --genotype \
        ""/bamdir/*.dupremoved.sorted.bam""
```

Error:
```
[smoove] 2021/06/22 16:08:52 starting with version 0.2.6
panic: open /bamdir/*.dupremoved.sorted.bam: no such file or directory

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7fffffffacf1, 0x1f, 0x7fffffffac77, 0x17, 0x7fffffffacb0, 0x35, 0x0, 0x0, 0x0, 0x0, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:83 +0x105b
github.com/brentp/smoove/lumpy.Lumpy(0x7fffffffac9f, 0x8, 0x7fffffffacb0, 0x35, 0x7fffffffac77, 0x17, 0xc00020d600, 0x1, 0x1, 0xc000214aa0, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:119 +0x12b
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce
```

Any tips?

Thanks!
Phil

",Phillip-a-richmond,https://github.com/brentp/smoove/issues/155
MDU6SXNzdWU5MzM0MjIyODI=,smoove docker version:  ([E]lumpy-filter),CLOSED,2021-06-30T08:07:15Z,2021-06-30T08:36:48Z,2021-06-30T08:36:48Z,"@brentp 
I'm running lumpy via smoove in docker version for SV calling (short reads). For test run I had taken 4 bam  files and executed smoove using following command. 

`smoove call -x --name my_cohort -exclude ../exclude_reg/exclude.cnvnator_100bp.GRCh38.20170403.bed --fasta ../ref-gen/GRCh38_full_analysis_set_plus_decoy_hla.fa -p 36 --genotype *.bam --outdir /root/work_output/`

I have two questions:

1. I get to see this line in output run  **([E]lumpy-filter)**  is  this anything to worry, what does this indicates?  
But the job had completed by generating output (my_cohort-smoove.genotyped.vcf.gz)  

![lumpy_filter_smoove](https://user-images.githubusercontent.com/29456358/123921100-49be3c00-d9a4-11eb-9eb9-2100982cf22d.png)

2. While doing population level or with few samples (lets say 1-5 samples), in which step I can retrieve sample level (individual) SVcalled vcf files. I would like to check types and counts of  SVs for each samples (before consensus file)? Because  while running traditional lumpy, we get  individual samples VCF, then we do mergeing.  

Could you please help me how to use smoove efficiently. Thanks.",nitha26,https://github.com/brentp/smoove/issues/156
MDU6SXNzdWU5MzQ2MTk0NTc=,Required tag PRPOS not found,OPEN,2021-07-01T09:19:51Z,2021-07-09T08:12:27Z,,"Dear @brentp 
I used the following command to run Smoove on my several thousands of samples:
$SMOOVE call --outdir $OUTDIR --exclude $BED --name $ID -f $REF -p 1 --genotype $BAM

but when merging Smoove SV calls of all samples, the program exited with exit status 1 and this error message:
Required tag PRPOS not found. Please ensure you've run lumpy withthe -P option to emit breakpoint probabilities.

Is there anything I forgot to do in SV calling step?
I hope I won't have to do calling SVs again as the number of samples is quite high.
Any help would be highly appreciated. 

Best,
Saeideh",Saeideh-Ashouri,https://github.com/brentp/smoove/issues/157
MDU6SXNzdWU5MzY4MzI2OTg=,([E]lumpy-filter) mv: cannot stat ‘SmooveTest_out/001MS.split.bam.tmp.bam’: No such file or directory,CLOSED,2021-07-05T08:27:49Z,2021-07-09T04:39:46Z,2021-07-07T09:57:13Z,"Hi @brentp, I am running smoove in conda version in cluster. When I try to do test run for 10 samples (CRAM file ) in parallel getting following error   

Command used in python:
`smoove call --outdir SmooveTest_out --exclude exclude_reg/exclude.cnvnator_100bp.GRCh38.20170403.bed --name ""+x[int]+"" --fasta ref-gen/GRCh38_full_analysis_set_plus_decoy_hla.fa -p 1 --genotype CRAM/""+x[int]+"".cram `  

`[smoove] 2021/07/05 12:39:25 calculating bam stats for 1 bams
[smoove] 2021/07/05 12:39:29 done calculating bam stats
[smoove]: ([E]lumpy-filter) 2021/07/05 13:27:07 mv: cannot stat ‘SmooveTest_out/001MS.split.bam.tmp.bam’: No such file or directory
[smoove]:2021/07/05 13:27:07 finished process: lumpy-filter (lumpy_filter -f ref-gen/GRCh38_full_analysis_set_plus_decoy_hla.fa CRAM/001MS.cram SmooveTest_out/00) in user-time:47m18.254711s system-time:21.227666s
[smoove]:2021/07/05 13:27:07 error running command: lumpy_filter -f ref-gen/GRCh38_full_analysis_set_plus_decoy_hla.fa CRAM/001MS.cram SmooveTest_out/001MS.split.bam.tmp.bam SmooveTest_out/001MS.disc.bam.tmp.bam 2 && mv SmooveTest_out/001MS.split.bam.tmp.bam SmooveTest_out/001MS.split.bam && mv SmooveTest_out/001MS.disc.bam.tmp.bam SmooveTest_out/001MS.disc.bam -> exit status 1
panic: exit status 1

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.Lumpy(0x7fffa7423c68, 0x5, 0x7fffa7423c76, 0x32, 0x7fffa7423c11, 0xe, 0xc420131430, 0x1, 0x1, 0xc420197f40, ...)
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:115 +0x556
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:275 +0x23a
main.main()
        /home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:115 +0x1dd
m/brentp/smoove/cmd/smoove/smoove.go:115 +0x1dd`

Could you please help me?
Thanks!",nitha26,https://github.com/brentp/smoove/issues/158
MDU6SXNzdWU5Mzc3MDY2NzY=,Splitting the sample across node for parallel ?,OPEN,2021-07-06T09:37:07Z,2021-07-06T10:00:48Z,,"@brentp Tried splitting the sample across the nodes using python mpi4py to do the task but on a single node/cross node I do find only one sample is running across the node a help would be best to sort this issue out.

**used command for population :** 
**_x = [ 's1', 's2', 's3']
def wper (int):
 os .system( ""time smoove call --outdir /gpfs/data/user/n_smoove/output --exclude /gpfs/data/user/n_smoove/exclude_region/exclude.cnvnator_101bp.GRCh38.20170403.bed --name ""+x[int]+""  --fasta /gpfs/data/user/n_smoove/ref-gen/GRCh38_full_analysis_set_plus_decoy_hla.fa -p 1 --genotype /gpfs/data/user/n_smoove/cram/""+x[int]+"".cram"")

comm = MPI.COMM_WORLD
rank = comm.Get_rank()
if rank < 4:
        wper(rank)_**

",Navin-techi,https://github.com/brentp/smoove/issues/159
MDU6SXNzdWU5Mzg2MjEyNDA=,lumpy executable not found in PATH ?,OPEN,2021-07-07T08:16:55Z,2021-07-14T07:41:29Z,,"hi @brentp tried recompiling the Smoove package with all the dependency found these issues and help on this would be great
```

smoove version: 0.2.7

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools
 *[Y] svtyper
 *[Y] mosdepth [extra filtering of split and discordant files for better scaling]

  [Y] duphold [(optional) annotate calls with depth changes]
  [Y] svtools [only needed for large cohorts].

Available sub-commands are below. Each can be run with -h for additional help.

call        : call lumpy (and optionally svtyper)
merge       : merge and sort (using svtools) calls from multiple samples
genotype    : parallelize svtyper on an input VCF
paste       : square final calls from multiple samples (each with same number of variants)
plot-counts : plot counts of split, discordant reads before, after smoove filtering
annotate    : annotate a VCF with gene and quality of SV call
hipstr      : run hipSTR in parallel
duphold     : run duphold in parallel (this can be done by adding a flag to call or genotype)

```
Even though the package is available while running the below code in gnu parallel I find this error -
`echo 004_F1.cram | parallel -j 2 -S node28 smoove call --outdir /gpfs/data/user/n_smoove/output --exclude /gpfs/data/user/n_smoove/exclude_reg/exclude.cnvnator_100bp.GRCh38.20170403.bed --name 004_F1.cram --fasta /gpfs/data/user/n_smoove/ref-gen/GRCh38_full_analysis_set_plus_decoy_hla.fa -p 1 --genotype 004_F1.cram
`
**[smoove] 2021/07/07 13:41:13 starting with version 0.1.9
[smoove] 2021/07/07 13:41:13 lumpy executable not found in PATH**
",Navin-techi,https://github.com/brentp/smoove/issues/160
MDU6SXNzdWU5NDA0MjgzNzk=,Is there any installation guide for this smoove package ?,CLOSED,2021-07-09T05:22:14Z,2024-06-17T22:30:55Z,2024-06-15T03:09:52Z,"hi @brentp,
Is there any installation guide where I can implement this on the cluster for parallel processing on centos?


Thanks in advance.",Navin-techi,https://github.com/brentp/smoove/issues/161
MDU6SXNzdWU5NDUyODI0MjU=,smoove call running out of memory (65 G) with small WGS cohort ,OPEN,2021-07-15T11:28:28Z,2021-07-29T14:21:07Z,,"Hello,

I'm trying to run smoove call on a cohort of 10-25 WGS samples sequenced to 20X coverage. Species is disploid and genome size ~2G.

I have 65G memory. Memory usage is 2-4 G at the start and then starts to expand quickly and eventually things get killed. I've included the log file below, ending with the ""Killed"" message. 

I don't know why this is happening and thought that someone might be able to identify the problem.

I'm rerunning it now with a subset of samples (~5 samples) to see if this works. Does running smoove for each sample separately make any difference in terms of the output than joint calling over all samples simultaneously?   

 Thank You. - Robert 


/home/robert/tools/smoove call -x --name RHF --fasta /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa -p 8 --genotype /data/BAMS/northern/*.bam
[smoove] 2021/07/15 07:43:46 starting with version 0.2.7
[smoove] 2021/07/15 07:43:48 calculating bam stats for 10 bams
[smoove] 2021/07/15 07:46:49 done calculating bam stats
[smoove]: ([E]lumpy-filter) 2021/07/15 07:53:50 [lumpy_filter] extracted splits and discordants from 172392782 total aligned reads
[smoove]:2021/07/15 07:54:36 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:3m19.388178s system-time:14.901339s
[smoove]:([E]lumpy-filter) 2021/07/15 07:54:49 [lumpy_filter] extracted splits and discordants from 176415567 total aligned reads
[smoove]:2021/07/15 07:55:07 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:3m33.242629s system-time:15.519828s
[smoove]:([E]lumpy-filter) 2021/07/15 07:55:38 [lumpy_filter] extracted splits and discordants from 192361201 total aligned reads
[smoove]:2021/07/15 07:56:18 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:3m53.041825s system-time:17.127914s
[smoove]:([E]lumpy-filter) 2021/07/15 07:56:59 [lumpy_filter] extracted splits and discordants from 189846067 total aligned reads
[smoove]:2021/07/15 07:57:30 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:3m49.645732s system-time:17.792674s
[smoove]:([E]lumpy-filter) 2021/07/15 08:00:39 [lumpy_filter] extracted splits and discordants from 179446169 total aligned reads
[smoove]:2021/07/15 08:00:41 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:3m20.532419s system-time:15.603252s
[smoove]:([E]lumpy-filter) 2021/07/15 08:02:07 [lumpy_filter] extracted splits and discordants from 130316442 total aligned reads
[smoove]:([E]lumpy-filter) 2021/07/15 08:02:26 [lumpy_filter] extracted splits and discordants from 139819568 total aligned reads
[smoove]:2021/07/15 08:03:55 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:5m41.094005s system-time:39.022714s
[smoove]:2021/07/15 08:03:57 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:5m23.992311s system-time:37.995755s
[smoove]:([E]lumpy-filter) 2021/07/15 08:04:42 [lumpy_filter] extracted splits and discordants from 171057162 total aligned reads
[smoove]:([E]lumpy-filter) 2021/07/15 08:04:48 [lumpy_filter] extracted splits and discordants from 156353946 total aligned reads
[smoove]:2021/07/15 08:06:17 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:6m54.871156s system-time:49.157644s
[smoove]:2021/07/15 08:06:23 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:6m18.103409s system-time:45.441519s
[smoove]:([E]lumpy-filter) 2021/07/15 08:06:24 [lumpy_filter] extracted splits and discordants from 153337745 total aligned reads
[smoove]:2021/07/15 08:06:37 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/robert/assembly/GCF_014851395.1_ASM1485139v1_genomic.fa /data/BAMS/no) in user-time:5m43.032757s system-time:42.752931s
[smoove] 2021/07/15 08:08:02 removed 3031945 alignments out of 4222370 (71.81%) with low mapq, depth > 1000, or from excluded chroms from RHF05338.disc.bam in 85 seconds
[smoove] 2021/07/15 08:08:02 removed 194472 alignments out of 4222370 (4.61%) that were bad interchromosomals or flanked-splitters from RHF05338.disc.bam
[smoove] 2021/07/15 08:08:09 kept 34487 putative orphans
[smoove] 2021/07/15 08:08:09 removed 24040 discordant orphans in 3 seconds
[smoove] 2021/07/15 08:08:12 removed 697556 singletons and isolated interchromosomals of 995953 reads (70.04%) from RHF05338.disc.bam in 9 seconds
[smoove] 2021/07/15 08:08:12 298397 reads (7.07%) of the original 4222370 remain from RHF05338.disc.bam
[smoove] 2021/07/15 08:08:13 removed 3529103 alignments out of 4856216 (72.67%) with low mapq, depth > 1000, or from excluded chroms from RHF05342.disc.bam in 95 seconds
[smoove] 2021/07/15 08:08:13 removed 222032 alignments out of 4856216 (4.57%) that were bad interchromosomals or flanked-splitters from RHF05342.disc.bam
[smoove] 2021/07/15 08:08:13 removed 2900126 alignments out of 4093323 (70.85%) with low mapq, depth > 1000, or from excluded chroms from RHF05347.disc.bam in 96 seconds
[smoove] 2021/07/15 08:08:13 removed 201299 alignments out of 4093323 (4.92%) that were bad interchromosomals or flanked-splitters from RHF05347.disc.bam
[smoove] 2021/07/15 08:08:15 removed 3335111 alignments out of 4664424 (71.50%) with low mapq, depth > 1000, or from excluded chroms from RHF05358.disc.bam in 98 seconds
[smoove] 2021/07/15 08:08:15 removed 217337 alignments out of 4664424 (4.66%) that were bad interchromosomals or flanked-splitters from RHF05358.disc.bam
[smoove] 2021/07/15 08:08:18 kept 32732 putative orphans
[smoove] 2021/07/15 08:08:18 removed 27903 discordant orphans in 3 seconds
[smoove] 2021/07/15 08:08:19 kept 37088 putative orphans
[smoove] 2021/07/15 08:08:19 removed 32878 discordant orphans in 3 seconds
[smoove] 2021/07/15 08:08:21 removed 690221 singletons and isolated interchromosomals of 991898 reads (69.59%) from RHF05347.disc.bam in 8 seconds
[smoove] 2021/07/15 08:08:21 301677 reads (7.37%) of the original 4093323 remain from RHF05347.disc.bam
[smoove] 2021/07/15 08:08:21 kept 37887 putative orphans
[smoove] 2021/07/15 08:08:21 removed 26274 discordant orphans in 3 seconds
[smoove] 2021/07/15 08:08:22 removed 772487 singletons and isolated interchromosomals of 1105081 reads (69.90%) from RHF05342.disc.bam in 9 seconds
[smoove] 2021/07/15 08:08:22 332594 reads (6.85%) of the original 4856216 remain from RHF05342.disc.bam
[smoove] 2021/07/15 08:08:24 removed 780588 singletons and isolated interchromosomals of 1111976 reads (70.20%) from RHF05358.disc.bam in 9 seconds
[smoove] 2021/07/15 08:08:24 331388 reads (7.10%) of the original 4664424 remain from RHF05358.disc.bam
[smoove] 2021/07/15 08:08:42 removed 1355068 alignments out of 1998885 (67.79%) with low mapq, depth > 1000, or from excluded chroms from RHF05301.split.bam in 20 seconds
[smoove] 2021/07/15 08:08:42 removed 150502 alignments out of 1998885 (7.53%) that were bad interchromosomals or flanked-splitters from RHF05301.split.bam
[smoove] 2021/07/15 08:08:43 removed 1207362 alignments out of 1794274 (67.29%) with low mapq, depth > 1000, or from excluded chroms from RHF05302.split.bam in 19 seconds
[smoove] 2021/07/15 08:08:43 removed 137231 alignments out of 1794274 (7.65%) that were bad interchromosomals or flanked-splitters from RHF05302.split.bam
[smoove] 2021/07/15 08:08:48 removed 3203001 alignments out of 4412465 (72.59%) with low mapq, depth > 1000, or from excluded chroms from RHF05397.disc.bam in 35 seconds
[smoove] 2021/07/15 08:08:48 removed 203693 alignments out of 4412465 (4.62%) that were bad interchromosomals or flanked-splitters from RHF05397.disc.bam
[smoove] 2021/07/15 08:08:52 kept 34684 putative orphans
[smoove] 2021/07/15 08:08:52 removed 24746 discordant orphans in 2 seconds
[smoove] 2021/07/15 08:08:55 removed 704585 singletons and isolated interchromosomals of 1005771 reads (70.05%) from RHF05397.disc.bam in 7 seconds
[smoove] 2021/07/15 08:08:55 301186 reads (6.83%) of the original 4412465 remain from RHF05397.disc.bam
[smoove] 2021/07/15 08:09:17 removed 1428862 alignments out of 2106456 (67.83%) with low mapq, depth > 1000, or from excluded chroms from RHF05338.split.bam in 22 seconds
[smoove] 2021/07/15 08:09:17 removed 185289 alignments out of 2106456 (8.80%) that were bad interchromosomals or flanked-splitters from RHF05338.split.bam
[smoove] 2021/07/15 08:09:28 kept 28017 putative orphans
[smoove] 2021/07/15 08:09:28 removed 10363 split orphans in 6 seconds
[smoove] 2021/07/15 08:09:30 removed 208083 singletons of 492305 reads (42.27%) from RHF05338.split.bam in 12 seconds
[smoove] 2021/07/15 08:09:30 284222 reads (13.49%) of the original 2106456 remain from RHF05338.split.bam
[smoove] 2021/07/15 08:09:57 removed 1677377 alignments out of 2472764 (67.83%) with low mapq, depth > 1000, or from excluded chroms from RHF05342.split.bam in 27 seconds
[smoove] 2021/07/15 08:09:57 removed 211424 alignments out of 2472764 (8.55%) that were bad interchromosomals or flanked-splitters from RHF05342.split.bam
[smoove] 2021/07/15 08:10:11 kept 35357 putative orphans
[smoove] 2021/07/15 08:10:11 removed 14547 split orphans in 8 seconds
[smoove] 2021/07/15 08:10:13 removed 244133 singletons of 583963 reads (41.81%) from RHF05342.split.bam in 16 seconds
[smoove] 2021/07/15 08:10:13 339830 reads (13.74%) of the original 2472764 remain from RHF05342.split.bam
[smoove] 2021/07/15 08:10:31 kept 164385 putative orphans
[smoove] 2021/07/15 08:10:31 removed 668 split orphans in 94 seconds
[smoove] 2021/07/15 08:10:33 removed 2601 singletons of 449681 reads (0.58%) from RHF05302.split.bam in 110 seconds
[smoove] 2021/07/15 08:10:33 447080 reads (24.92%) of the original 1794274 remain from RHF05302.split.bam
[smoove] 2021/07/15 08:10:36 kept 168436 putative orphans
[smoove] 2021/07/15 08:10:36 removed 762 split orphans in 99 seconds
[smoove] 2021/07/15 08:10:38 removed 2879 singletons of 493315 reads (0.58%) from RHF05301.split.bam in 116 seconds
[smoove] 2021/07/15 08:10:38 490436 reads (24.54%) of the original 1998885 remain from RHF05301.split.bam
[smoove] 2021/07/15 08:10:38 removed 1393084 alignments out of 2069913 (67.30%) with low mapq, depth > 1000, or from excluded chroms from RHF05347.split.bam in 24 seconds
[smoove] 2021/07/15 08:10:38 removed 181545 alignments out of 2069913 (8.77%) that were bad interchromosomals or flanked-splitters from RHF05347.split.bam
[smoove] 2021/07/15 08:10:50 kept 30517 putative orphans
[smoove] 2021/07/15 08:10:50 removed 12489 split orphans in 7 seconds
[smoove] 2021/07/15 08:10:52 removed 212202 singletons of 495284 reads (42.84%) from RHF05347.split.bam in 14 seconds
[smoove] 2021/07/15 08:10:52 283082 reads (13.68%) of the original 2069913 remain from RHF05347.split.bam
[smoove] 2021/07/15 08:10:55 removed 1205923 alignments out of 1797653 (67.08%) with low mapq, depth > 1000, or from excluded chroms from RHF05350.split.bam in 21 seconds
[smoove] 2021/07/15 08:10:55 removed 137216 alignments out of 1797653 (7.63%) that were bad interchromosomals or flanked-splitters from RHF05350.split.bam
[smoove] 2021/07/15 08:11:02 removed 1687161 alignments out of 2485258 (67.89%) with low mapq, depth > 1000, or from excluded chroms from RHF05357.split.bam in 23 seconds
[smoove] 2021/07/15 08:11:02 removed 182539 alignments out of 2485258 (7.34%) that were bad interchromosomals or flanked-splitters from RHF05357.split.bam
[smoove] 2021/07/15 08:11:17 removed 1547185 alignments out of 2273613 (68.05%) with low mapq, depth > 1000, or from excluded chroms from RHF05358.split.bam in 24 seconds
[smoove] 2021/07/15 08:11:17 removed 199322 alignments out of 2273613 (8.77%) that were bad interchromosomals or flanked-splitters from RHF05358.split.bam
[smoove] 2021/07/15 08:11:27 kept 29793 putative orphans
[smoove] 2021/07/15 08:11:27 removed 10617 split orphans in 5 seconds
[smoove] 2021/07/15 08:11:29 removed 226579 singletons of 527106 reads (42.99%) from RHF05358.split.bam in 12 seconds
[smoove] 2021/07/15 08:11:29 300527 reads (13.22%) of the original 2273613 remain from RHF05358.split.bam
[smoove] 2021/07/15 08:11:53 removed 1444973 alignments out of 2126656 (67.95%) with low mapq, depth > 1000, or from excluded chroms from RHF05397.split.bam in 23 seconds
[smoove] 2021/07/15 08:11:53 removed 186961 alignments out of 2126656 (8.79%) that were bad interchromosomals or flanked-splitters from RHF05397.split.bam
[smoove] 2021/07/15 08:12:03 kept 28504 putative orphans
[smoove] 2021/07/15 08:12:03 removed 10645 split orphans in 6 seconds
[smoove] 2021/07/15 08:12:06 removed 210393 singletons of 494722 reads (42.53%) from RHF05397.split.bam in 13 seconds
[smoove] 2021/07/15 08:12:06 284329 reads (13.37%) of the original 2126656 remain from RHF05397.split.bam
[smoove] 2021/07/15 08:12:27 removed 1374656 alignments out of 2045653 (67.20%) with low mapq, depth > 1000, or from excluded chroms from RHF05398.split.bam in 21 seconds
[smoove] 2021/07/15 08:12:27 removed 157085 alignments out of 2045653 (7.68%) that were bad interchromosomals or flanked-splitters from RHF05398.split.bam
[smoove] 2021/07/15 08:12:35 kept 163490 putative orphans
[smoove] 2021/07/15 08:12:35 removed 793 split orphans in 84 seconds
[smoove] 2021/07/15 08:12:37 removed 2840 singletons of 454514 reads (0.62%) from RHF05350.split.bam in 102 seconds
[smoove] 2021/07/15 08:12:37 451674 reads (25.13%) of the original 1797653 remain from RHF05350.split.bam
[smoove] 2021/07/15 08:13:57 kept 219280 putative orphans
[smoove] 2021/07/15 08:13:57 removed 875 split orphans in 150 seconds
[smoove] 2021/07/15 08:14:00 removed 3462 singletons of 615558 reads (0.56%) from RHF05357.split.bam in 178 seconds
[smoove] 2021/07/15 08:14:00 612096 reads (24.63%) of the original 2485258 remain from RHF05357.split.bam
[smoove] 2021/07/15 08:14:19 kept 174179 putative orphans
[smoove] 2021/07/15 08:14:19 removed 755 split orphans in 95 seconds
[smoove] 2021/07/15 08:14:20 removed 3012 singletons of 513912 reads (0.59%) from RHF05398.split.bam in 114 seconds
[smoove] 2021/07/15 08:14:20 510900 reads (24.97%) of the original 2045653 remain from RHF05398.split.bam
[smoove] 2021/07/15 08:15:44 removed 30539654 alignments out of 130316442 (23.43%) with low mapq, depth > 1000, or from excluded chroms from RHF05350.disc.bam in 547 seconds
[smoove] 2021/07/15 08:15:44 removed 629811 alignments out of 130316442 (0.48%) that were bad interchromosomals or flanked-splitters from RHF05350.disc.bam
[smoove] 2021/07/15 08:16:07 removed 37055508 alignments out of 156353946 (23.70%) with low mapq, depth > 1000, or from excluded chroms from RHF05301.disc.bam in 570 seconds
[smoove] 2021/07/15 08:16:07 removed 637914 alignments out of 156353946 (0.41%) that were bad interchromosomals or flanked-splitters from RHF05301.disc.bam
[smoove] 2021/07/15 08:16:14 removed 32425137 alignments out of 139819568 (23.19%) with low mapq, depth > 1000, or from excluded chroms from RHF05302.disc.bam in 576 seconds
[smoove] 2021/07/15 08:16:14 removed 578778 alignments out of 139819568 (0.41%) that were bad interchromosomals or flanked-splitters from RHF05302.disc.bam
[smoove] 2021/07/15 08:16:38 removed 40399593 alignments out of 171057162 (23.62%) with low mapq, depth > 1000, or from excluded chroms from RHF05357.disc.bam in 601 seconds
[smoove] 2021/07/15 08:16:38 removed 732772 alignments out of 171057162 (0.43%) that were bad interchromosomals or flanked-splitters from RHF05357.disc.bam
[smoove] 2021/07/15 08:17:11 removed 35358941 alignments out of 153337745 (23.06%) with low mapq, depth > 1000, or from excluded chroms from RHF05398.disc.bam in 530 seconds
[smoove] 2021/07/15 08:17:11 removed 619711 alignments out of 153337745 (0.40%) that were bad interchromosomals or flanked-splitters from RHF05398.disc.bam
Killed
",robertwhbaldwin,https://github.com/brentp/smoove/issues/162
MDU6SXNzdWU5NDYwMTA1MjM=,Population level caling: Genotype Step concept & Merging step,CLOSED,2021-07-16T07:11:27Z,2021-07-16T08:29:28Z,2021-07-16T08:29:27Z,"Hi @brentp could you please explain 1. how this #160 squaring concept is applied in **population level** or when we don't use trios  (I understand squaring concept in trios)? 

2. And how can I filter out only PASS variants from end VCF file (completion of all steps in population level calling) ? could  you help me to filter out PASS variants for next level analysis?

3. Whether smoove **support genotyping**  of other tools SVs VCF file (Manta VCF, GRIDSS VCF)?

4. Can smoove do merging step for creating consensus file? eg (Delly VCF + smoove VCF = ConsensusSVcall?  

Thanks a lot!",nitha26,https://github.com/brentp/smoove/issues/163
MDU6SXNzdWU5NDk2MjI2MTQ=,smoove genotype step taking a very long time for some samples,OPEN,2021-07-21T11:45:44Z,2021-07-22T16:07:51Z,,"Hi,

I'm doing population calling and made it to the genotype step. There's 25 samples, similar coverage (20X). The first handful of samples finished quickly (1hr). This is the command I used:

smoove genotype -d -x -p 1 --name ${i}-joint --outdir ./ --fasta /assembly/GCF_014851395.1_ASM1485139v1_genomic.fa --vcf merged.sites.vcf.gz /bams/${i}.bam

But then I hit a sample that took a very long time (see log file below). After ~20 hrs the sample was still running so I just stopped it thinking that there must be a problem.  

I then noticed that the sample that was taking a long time had no ...smoove.genotype.vcf.gz. For the earlier population calling step that produced the ...smooved.genotyped.vcf.gz files only 13/25 samples actually got these VCF files. For the rest I got the EOF can't read from std input warning which was the topic of another ticket. So it seems to me that the long time it it is taking for the genotyping step to finish may be related to the fact these samples had no ...smoove.genotyped.vcf.gz file. Can someone explain this? Is joint genotyping only meant for samples with the intermediate ...smoove.genotyped.vcf.gz files? 

Thank You - Robert  


 



 2021/07/20 16:35:04 [W::hts_idx_load3] The index file is older than the data file: /bams/G0620_M02.bam.bai
[smoove] 2021/07/20 16:35:36 [smoove] 2021/07/20 16:35:36 starting with version 0.2.6
[smoove] 2021/07/20 16:35:36 [smoove] 2021/07/20 16:35:36 running duphold on 1 files in 16 processes
[smoove] 2021/07/20 16:35:36 [smoove] 2021/07/20 16:35:36 [W::hts_idx_load2] The index file is older than the data file: /bams/G0620_M02.bam.bai
[smoove] 2021/07/20 16:37:29 [smoove] 2021/07/20 16:37:29 [duphold] finished
[smoove] 2021/07/20 16:37:29 [smoove] 2021/07/20 16:37:29 finished duphold
[smoove] 2021/07/20 16:37:29 wrote sorted, indexed file to G0620_M02-joint-smoove.genotyped.vcf.gz
RHF05301
[smoove] 2021/07/20 16:37:29 starting with version 0.2.6
[smoove] 2021/07/20 16:37:29 writing sorted, indexed file to RHF05301-joint-smoove.genotyped.vcf.gz
[smoove] 2021/07/20 16:37:29 > gsort version 0.0.6
[smoove] 2021/07/20 16:37:29 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 16:54:24 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 17:12:19 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 17:29:36 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 17:47:50 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 18:04:28 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 18:22:17 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 18:39:21 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 18:55:59 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 19:14:42 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 19:30:15 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 19:48:43 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 20:06:24 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 20:22:22 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 20:40:15 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 20:56:57 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 21:13:31 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 21:33:23 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 21:48:45 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 22:06:37 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 22:23:04 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 22:40:23 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 22:59:03 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 23:14:21 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 23:33:33 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/20 23:49:42 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 00:07:04 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 00:24:53 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 00:41:29 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 01:00:39 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 01:21:06 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 01:37:23 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 01:53:16 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 02:09:04 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 02:25:21 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 02:41:30 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 02:57:28 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 03:13:23 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 03:29:13 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 03:45:08 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 04:00:52 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 04:16:32 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 04:32:14 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 04:47:49 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 05:03:39 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 05:19:19 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 05:35:15 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 05:50:55 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 06:06:37 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 06:22:41 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 06:38:33 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 06:54:05 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 07:09:55 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 07:25:34 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 07:41:21 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 07:56:49 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 08:12:47 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 08:28:31 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 08:44:18 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 09:00:12 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 09:16:03 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 09:32:20 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 09:48:09 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 10:03:54 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 10:19:42 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 10:35:54 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 10:51:35 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 11:07:18 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai
[smoove] 2021/07/21 11:23:00 [W::hts_idx_load3] The index file is older than the data file: /bams/RHF05301.bam.bai




  ",robertwhbaldwin,https://github.com/brentp/smoove/issues/164
MDU6SXNzdWU5NTI5NDgzODM=,Smoove population SV calling support for Illumina Dragen SV VCF files,OPEN,2021-07-26T14:10:50Z,2021-07-26T14:33:53Z,,"Hi Brent, 

We have a collection of Structural Variant VCF files produced by Illumina Dragen. 
These are per sample, not yet in a multi-sample ""squared off"" format. 

I tried to run Smoove population SV calling to create a multi-sample ""squared off"" SV VCF file. 

This however runs into an error about CIEND being missing for some input SV variants. 
CIEND and also CIPOS indeed seem to be missing for some input variants.  I am not sure how important these attributes/values really are to Smoove population SV calling. 

This breaks this VCF parse line in SV Tools
https://github.com/hall-lab/svtools/blob/master/svtools/l_bp.py#L136

Do you think it might work and make sense for Smoove to also work for single sample SV VCF files created by other SV callers?
e.g. Dragen, provided the SV VCF files contain a certain set of VCF attributes?

Not sure if the missing CIEND or CIPOS attributes/values would be the only issue. or that Smoove population SV calling really tied to Lumpy for creating the per sample SV VCF files?

Thank you for your thought on this. 

Wim

```
smoove merge -name merged -f ../../ref/my_genome.fa --outdir ./ *dragen*sv.vcf.gz
[smoove] 2021/07/20 15:30:36 starting with version 0.2.3
[smoove] 2021/07/20 15:30:36 merging 98 files
[smoove] 2021/07/20 15:30:36 finished sorting 98 files; merge starting.
[smoove] 2021/07/20 15:31:06 Traceback (most recent call last):
  File ""/Tools/bcbio/1.1.5/anaconda/envs/python2/bin/svtools"", line 11, in <module>
    sys.exit(main())
  File ""/Tools/bcbio/1.1.5/anaconda/envs/python2/lib/python2.7/site-packages/svtools/cli.py"", line 79, in main
[smoove] 2021/07/20 15:31:06     sys.exit(args.entry_point(args))
[smoove] 2021/07/20 15:31:06   File ""/Tools/bcbio/1.1.5/anaconda/envs/python2/lib/python2.7/site-packages/svtools/lsort.py"", line 123, in run_from_args
[smoove] 2021/07/20 15:31:06     sorter.execute()
[smoove] 2021/07/20 15:31:06   File ""/Tools/bcbio/1.1.5/anaconda/envs/python2/lib/python2.7/site-packages/svtools/lsort.py"", line 58, in execute
[smoove] 2021/07/20 15:31:06     self.vcf_lines.sort(key=l_bp.vcf_line_key)
  File ""/Tools/bcbio/1.1.5/anaconda/envs/python2/lib/python2.7/site-packages/svtools/l_bp.py"", line 150, in vcf_line_key
[smoove] 2021/07/20 15:31:06     v1 = split_v(l1)[:8]
  File ""/Tools/bcbio/1.1.5/anaconda/envs/python2/lib/python2.7/site-packages/svtools/l_bp.py"", line 128, in split_v
[smoove] 2021/07/20 15:31:06     start_r = pos_r + int(m['CIEND'].split(',')[0])
[smoove] 2021/07/20 15:31:06 KeyError: 'CIEND'
2021/07/20 15:31:06 exit status 1
```




",WimSpee,https://github.com/brentp/smoove/issues/165
MDU6SXNzdWU5NTQ4NDgxNDE=,"smoove annotate error ""panic: runtime error: invalid memory address or nil pointer dereference"" is it a problem? ",OPEN,2021-07-28T13:19:37Z,2021-07-29T14:22:21Z,,"I ran smoove annotate and got this error (below). But the smoove.square.anno.vcf.gz was generated. When I ran bcftools stats the anno file had 1 less record than the input vcf. Not sure what to make of this. The annotations look like they were added. Aside from the 1 missing record everything looks o.k. I noticed that someone else posted a message about this error to this board and that the ticker got closed. Was the problem resolved? It seemed to be related to missing samples. That's doesn't seem applicable here.  

I did notice that the number of variants was few. The smoove.genotyped.vcf.gz were much larger (~60mb) than the joint genotyped VCF files (11-12 mb) and the final squared file had 73801 records. 



Here's the input ""suared"" vcf stats:

 SN	[2]id	[3]key	[4]value
SN	0	number of samples:	25
SN	0	number of records:	73801
SN	0	number of no-ALTs:	0
SN	0	number of SNPs:	0
SN	0	number of MNPs:	0
SN	0	number of indels:	9399
SN	0	number of others:	53007
SN	0	number of multiallelic sites:	0
SN	0	number of multiallelic SNP sites:	0

Here's for the anno VCF:

SN	[2]id	[3]key	[4]value
SN	0	number of samples:	25
SN	0	number of records:	73800
SN	0	number of no-ALTs:	0
SN	0	number of SNPs:	0
SN	0	number of MNPs:	0
SN	0	number of indels:	9399
SN	0	number of others:	53006
SN	0	number of multiallelic sites:	0
SN	0	number of multiallelic SNP sites:	0



Here's the error message (someone posted this error before to this board): 

docker run -v /home/robert/assembly:/assembly -v /data/BAMS/results:/data -it brentp/smoove
(smoove-env) root@d4fdaf368702:/work# cd ..
(smoove-env) root@d4fdaf368702:/# cd data
(smoove-env) root@d4fdaf368702:/data# smoove annotate --gff /assembly/GCF_014851395.1_ASM1485139v1_genomic.gff RHF.smoove.square.vcf.gz | bgzip -c >RHF.smoove.square.anno.vcf.gz
[smoove] 2021/07/28 13:11:11 starting with version 0.2.6
panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x8 pc=0x728eb3]

goroutine 1 [running]:
github.com/brentp/smoove/annotate.setSmooveQuality(0xc000d9d790, 0xc000d9d790)
	/home/brentp/go/go/src/github.com/brentp/smoove/annotate/annotate.go:384 +0x113
github.com/brentp/smoove/annotate.annotate(0xc001d1cc00, 0xc00082e400, 0xc00015b560)
	/home/brentp/go/go/src/github.com/brentp/smoove/annotate/annotate.go:409 +0xa9
github.com/brentp/smoove/annotate.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/annotate/annotate.go:468 +0x46a
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce
",robertwhbaldwin,https://github.com/brentp/smoove/issues/166
MDU6SXNzdWU5NTU5ODE5Nzg=,Smoove missed small duplications,OPEN,2021-07-29T15:53:11Z,2021-07-29T15:53:11Z,,"Hi,
 I am calling CNVs at sequence depth of ~10X.  There are almost no small duplications (~100bp) in callset . But I could find small deletions. Is it normal? I do not know whether there are some errors in my pipeline. 

Thanks!

",y1025i,https://github.com/brentp/smoove/issues/167
MDU6SXNzdWU5NTcyNDgxMTg=,smoove paste error; files with different number of variants; how to fix?,CLOSED,2021-07-31T13:43:29Z,2021-08-02T12:38:46Z,2021-08-02T12:38:46Z,"Hi,

Almost there !!!

I've got 25 files from the genotyping step (...smoove.genotyped.vcf) but only 22 have the same number of variants. I already reran from step 1 to try and fix the problem. Can someone suggest what to do? thanks. 



(smoove-env) root@cbd7831c8e25:/data# smoove paste --name RHF *.vcf.gz
[smoove] 2021/07/31 13:34:32 starting with version 0.2.6
[smoove] 2021/07/31 13:34:32 squaring 25 files to RHF.smoove.square.vcf.gz
[smoove] 2021/07/31 13:34:34 22 files had 123573 variants
[smoove] 2021/07/31 13:34:34 files: G0319-20-B0074-joint-smoove.genotyped.vcf.gz,RHF05338-joint-smoove.genotyped.vcf.gz had 123574 variants
[smoove] 2021/07/31 13:34:34 files: RHF05350-joint-smoove.genotyped.vcf.gz had 123575 variants
[smoove] 2021/07/31 13:34:34 please make sure that all files have the same number of variants
",robertwhbaldwin,https://github.com/brentp/smoove/issues/168
MDU6SXNzdWU5NTgxMzA4Nzc=,smoove paste error: PREND not defined in header reindexing did not help  ,OPEN,2021-08-02T13:12:31Z,2021-08-04T11:58:39Z,,"Hi, 
I ran into a problem with smoove paste

# smoove paste --name RHF *joint-smoove.genotyped.vcf.gz
[smoove] 2021/08/02 12:52:45 starting with version 0.2.6
[smoove] 2021/08/02 12:52:45 squaring 25 files to RHF.smoove.square.vcf.gz
[smoove] 2021/08/02 12:52:46 all files had 123573 variants
[smoove] 2021/08/02 12:53:53 [W::vcf_parse_info] INFO 'PREND' is not defined in the header, assuming Type=String
[smoove] 2021/08/02 12:53:53 Error: The INFO field is not defined in the header: PREND
2021/08/02 12:53:53 exit status 255


The reason for this error is that I followed the joint genotype command posted in the smoove README doc. This uses the -x option which removes PREND annotations. Why would the README state to use this command if it's not compatible with the paste command? Why state to remove PREND anno if smoove is going to error out at the paste step for not including it?  

I'm now doing joint genotyping all over again so that the joint.smoove vcf files carry the PREND anno. I'm just using this command:

smoove genotype -d -p 10 --name ${i}-joint --outdir /data --fasta /assembly/GCF_014851395.1_ASM1485139v1_genomic.fa --vcf /data/merged.sites.vcf.gz /data/${i}.bam

which is what the README stated except the -x option is removed. 
",robertwhbaldwin,https://github.com/brentp/smoove/issues/169
MDU6SXNzdWU5NTg4NDgxNzg=,How to run without high-coverage regions filter,CLOSED,2021-08-03T08:07:58Z,2021-08-03T08:59:45Z,2021-08-03T08:59:45Z,"Hi,
  
Smoove run with further filter lumpy_filter calls to remove high-coverage regions, but my data just with true SVs on hign-coverage regions(ctDNA samples sequenced with >20,000X coverage), so, to avoid being filtered out, how can I run soomve without lumpy_filter? or how to set parameters to allow high-coverage data? 

Best!",ducerer,https://github.com/brentp/smoove/issues/170
MDU6SXNzdWU5ODc5NTkwNzU=,smoove annotate not adding exonic overlaps,CLOSED,2021-09-03T17:06:34Z,2021-10-27T20:13:33Z,2021-10-27T20:03:37Z,"Hey Brent,

I've noticed for a while now that when I try to use smoove annotate on a Manta VCF it runs completely and adds smoove_gene annotations, but never exonic overlaps. It will add gene, downstream, and upstream, but I never see exon. I can compare SV calls from the same samples generated with Smoove and even when there are seemingly the same event called by Smoove and Manta, only the Smoove call will include ""exon"" in the smoove_gene annotation (if there is indeed an exonic overlap). Any idea why Manta calls would have this problem? I am running smoove annotate like so:

smoove annotate --gff $GFF manta.vcf.gz | bgzip -c > annotated.vcf.gz

And I'm using the same reference GRCh38 GFF file that I also use when running Smoove: 

Homo_sapiens.chr.GRCh38.97.gff3.gz

Thanks",fakedrtom,https://github.com/brentp/smoove/issues/171
I_kwDOBxm8lM48XfHf,Feature Request: allow tmpdir specification,CLOSED,2021-10-01T01:49:46Z,2021-10-01T10:33:57Z,2021-10-01T10:33:57Z,"Hi all,

Thanks for the great program. Super easy to use. Seriously.

I ran into a problem with a large BAM file.

```

panic: write /tmp/smoove-mosdepth-bam175073159: no space left on device

goroutine 11151 [running]:
github.com/brentp/smoove/lumpy.check(...)
	/home/brentp/src/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.remove_sketchy(0xc000030340, 0x33, 0x3e8, 0x7fffaace6523, 0x53, 0x0, 0x0, 0xc000189900, 0x4, 0x4, ...)
	/home/brentp/src/smoove/lumpy/depthfilter.go:323 +0x17dd
github.com/brentp/smoove/lumpy.remove_sketchy_all.func1(0xc00013a5a0, 0x3e8, 0x7fffaace6523, 0x53, 0x0, 0x0, 0xc000189900, 0x4, 0x4, 0x1, ...)
	/home/brentp/src/smoove/lumpy/depthfilter.go:399 +0x231
created by github.com/brentp/smoove/lumpy.remove_sketchy_all
	/home/brentp/src/smoove/lumpy/depthfilter.go:397 +0x194
```

I've seen this kind of error before with other software/programs on the cluster I'm using. Specifically:
```
panic: write /tmp/smoove-mosdepth-bam175073159: no space left on device
```

Apparently this is because the IT in charge of maintaining the cluster has allotted very little space to /tmp. 

Sometimes programs have an option like `--tmpdir` that allows the user to specify a directory explicitly for tmp files. Tjhat would probably solve my issue here.

If you see a work-around, please let me know. The obvious one would be use a different system. Let's pretend that's not possible at the moment.

Thanks for reading. 

Best,

John
",JohnUrban,https://github.com/brentp/smoove/issues/172
I_kwDOBxm8lM48Y_FK,Missing libcrypto.so.1.0.0 hack.,CLOSED,2021-10-01T10:32:02Z,2021-10-01T10:44:38Z,2021-10-01T10:32:12Z,"This is just a helpful tip for future googlers and issue searchers.

I installed smoove via conda on two different systems:
```
conda create -n smoove -c bioconda -y smoove
```

It worked like a charm on one, but raised an error on the other. The error (cleaned up a bit):
```
[smoove] 2021/10/01 03:10:40 starting with version 0.2.8
[smoove] 2021/10/01 03:10:40 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2021/10/01 03:10:40 lumpy_filter: error while loading shared libraries: libcrypto.so.1.0.0: cannot open shared object file: No such file or directory

....

[smoove] 2021/10/01 03:10:44 done calculating bam stats
panic: exit status 127
```

I tried a few workarounds with conda, but nothing worked.

This did though.

Step 1: Locate libcrypto.so.1.0.0 on your system.
```
locate libcrypto.so.1.0.0

#or 
sudo locate libcrypto.so.1.0.0
```

Step 2: copy it into your `smoove` ENV `lib` folder
```
cp /var/lib/snapd/snap/core/11606/lib/x86_64-linux-gnu/libcrypto.so.1.0.0 ~/software/conda/anaconda3/envs/smoove/lib/
```

Step 3: Run smoove and smile as it now works.

Note - my system had 3 locations for `libcrypto.so.1.0.0`. I just picked one to copy.
This solved the issue for me.
Hope it works for you as well.

Best,

John

p.s. feel free to close any time.",JohnUrban,https://github.com/brentp/smoove/issues/173
I_kwDOBxm8lM485Xuk,smoove merge error :svtools: error: unrecognized arguments: -r,OPEN,2021-10-09T10:27:22Z,2021-11-03T13:42:39Z,,"Hi,
I ran into a problem with smoove merge


smoove merge --name merged -f /public/home/reference_fa/LYC_chr.fasta --outdir /public/home/smoove_test/merged_vcf /public/home/smoove_test/bam/*.vcf.gz


[smoove] 2021/10/09 18:25:38 starting with version 0.2.8
[smoove] 2021/10/09 18:25:38 merging 2 files
[smoove] 2021/10/09 18:25:38 finished sorting 2 files; merge starting.
[smoove] 2021/10/09 18:25:44 usage: svtools [-h] [--version] [--support] subcommand ...
[smoove] 2021/10/09 18:25:44 svtools: error: unrecognized arguments: -r
2021/10/09 18:25:44 exit status 2
",sulinq,https://github.com/brentp/smoove/issues/174
I_kwDOBxm8lM485X58,smoove paste --that all files have the same number of variants,CLOSED,2021-10-09T10:31:11Z,2024-12-01T17:33:21Z,2021-10-11T11:14:43Z,"smoove paste --name NAME /public/home/smoove_test/bam_old/*.vcf.gz


[smoove] 2021/10/09 18:29:01 starting with version 0.2.8
[smoove] 2021/10/09 18:29:01 squaring 2 files to NAME.smoove.square.vcf.gz
[smoove] 2021/10/09 18:29:01 files: /public/home/smoove_test/bam_old/DNA10_FDSW202463712-1r_sort.bam-smoove.vcf.gz had 5487 variants
[smoove] 2021/10/09 18:29:01 files: /public/home/smoove_test/bam_old/DNA9_FDSW202463711-1r_sort.bam-smoove.vcf.gz had 4908 variants
[smoove] 2021/10/09 18:29:01 please make sure that all files have the same number of variants",sulinq,https://github.com/brentp/smoove/issues/175
I_kwDOBxm8lM49OA5l,SVTyper Unknown argument,CLOSED,2021-10-15T05:01:49Z,2022-10-13T09:07:55Z,2021-10-16T03:10:17Z,"Hello, 
I have installed smoove through the bioconda repo. I used to run v2.6, but started having some merge issues and decided to upgrade. However, I now get the error below across the 3 latest versions of smoove. 

An example of the error is below:
`smoove call --name AU01 --outdir smoove/SVcalls/ --fasta reference/bSteHir1.pri.cur.20190820.fasta --genotype alignments/merged_bam/AU01.bam`

[smoove] 2021/10/15 17:54:46 Super_scaffold_1   1000000
[smoove] 2021/10/15 17:54:46 > gsort version 0.1.4
[smoove] 2021/10/15 17:54:46 Calculating library metrics from alignments/merged_bam/AU01.bam...
[smoove] 2021/10/15 17:54:58 Super_scaffold_2   1000000
[smoove] 2021/10/15 17:55:11  done
Writing library metrics to /tmp/tempclean-366548679/333575853svtype-lib...
[smoove] 2021/10/15 17:55:11  done
[smoove] 2021/10/15 17:55:11 usage: svtyper [-h] [-i FILE] [-o FILE] -B FILE [-T FILE] [-l FILE] [-m INT]
               [-n INT] [-q] [--max_reads INT] [--split_weight FLOAT]
               [--disc_weight FLOAT] [-w FILE]
[smoove] 2021/10/15 17:55:11 usage: svtyper [-h] [-i FILE] [-o FILE] -B FILE [-T FILE] [-l FILE] [-m INT]
               [-n INT] [-q] [--max_reads INT] [--split_weight FLOAT]
               [--disc_weight FLOAT] [-w FILE]
[smoove] 2021/10/15 17:55:11 svtyper: error: unrecognized arguments: --max_ci_dist 0
[smoove] 2021/10/15 17:55:11 svtyper: error: unrecognized arguments: --max_ci_dist 0
[smoove] 2021/10/15 17:55:11 usage: svtyper [-h] [-i FILE] [-o FILE] -B FILE [-T FILE] [-l FILE] [-m INT]
               [-n INT] [-q] [--max_reads INT] [--split_weight FLOAT]
               [--disc_weight FLOAT] [-w FILE]
[smoove] 2021/10/15 17:55:11 svtyper: error: unrecognized arguments: --max_ci_dist 0
panic: exit status 2

goroutine 31081 [running]:
github.com/brentp/smoove/svtyper.check(...)
        /home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper.func2(0xc001e7a000, 0xc000121600, 0x1, 0x1, 0x7ffe15c2227e, 0x29, 0xc001e7c0c0, 0x2c, 0xc001d7ab48, 0xc001d7ab60, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:179 +0x90b
created by github.com/brentp/smoove/svtyper.Svtyper
        /home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:165 +0xab2
",janawold1,https://github.com/brentp/smoove/issues/176
I_kwDOBxm8lM49bJf1,Use of smoove in haploid organisms,OPEN,2021-10-19T16:40:36Z,2021-10-20T10:57:50Z,,"Hello,

I would like to use this tool in an haploid organism. It would be possible? If so, what parameters should I modify?

Thanks

Pablo",pabloangulo7,https://github.com/brentp/smoove/issues/177
I_kwDOBxm8lM4-aoOj,False negative duplication due to low MAPQ,OPEN,2021-11-08T08:42:14Z,2021-11-08T15:41:45Z,,"Hi, 

I ran Smoove using a population calling mode. 
There is a duplication shared by >10 samples however, Smoove detected this in none of the samples likely due to low mapping quality (Breakpoints are flanked by repeats). 
This is how the duplication looks like in IGV:

![image](https://user-images.githubusercontent.com/23212146/140709826-4efea78a-60f4-4008-adbe-867cbbc79a28.png)
The green reads support the duplication. The depth is also elevated compared to the flanking region which also supports duplication. However, when I only visualize reads with MAPQ > 40:

![image](https://user-images.githubusercontent.com/23212146/140710208-686ecffc-6831-4306-90de-512116b5430c.png)
Then I am left with only one discordant read-pair which is not sufficient for Lumpy to call a duplication.
Do you have any advice on how can I force Lumpy to detect this duplication?

Thank you very much in advance!
",lee039,https://github.com/brentp/smoove/issues/178
I_kwDOBxm8lM4-qtkJ,"unknown chromosome, Could not parse the header, sample line not found",CLOSED,2021-11-11T21:41:38Z,2021-11-12T12:11:49Z,2021-11-12T12:11:49Z,"Hi Brent,
I've successfully run smoove on a subset of my data (chr22). When running on the full genome, it fails at the last step of VCF creation. Below are the most informative parts of the error messages. The ""unknown chromosome: chrUn_gl000232"" is present in the BAM headers. 
```
[smoove] 2021/11/11 15:37:32 starting lumpy
[smoove] 2021/11/11 15:37:32 wrote lumpy command to results-smoove_WGS//UCD52-lumpy-cmd.sh
[smoove] 2021/11/11 15:37:32 writing sorted, indexed file to results-smoove_WGS/UCD52-smoove.genotyped.vcf.gz
[smoove] 2021/11/11 15:37:32 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2021/11/11 15:37:32 > gsort version 0.1.4
[smoove] 2021/11/11 15:37:32 chrM	1000000
[smoove] 2021/11/11 15:37:33 chr1	1000000
...
[smoove] 2021/11/11 15:52:37 chrUn_gl000243	1000000
[smoove] 2021/11/11 15:52:37 chrUn_gl000247	1000000
[smoove] 2021/11/11 15:58:00 2021/11/11 15:58:00 unknown chromosome: chrUn_gl000232 (known: map[chr1:0 chr10:9 chr11:10 chr12:11 chr13:12 chr14:13 chr15:14 chr16:15 chr17:16 chr18:17 chr19:18 chr2:1 chr20:19 chr21:20 chr22:21 chr3:2 chr4:3 chr5:4 chr6:5 chr7:6 chr8:7 chr9:8 chrM:24 chrX:22 chrY:23]) in line: chrUn_gl000232	20413	4364_2	N	N[chr3:197859051[	0.00	.	SVTYPE=BND;...
[smoove] 2021/11/11 15:58:00 [E::bcf_hdr_parse] Could not parse the header, sample line not found
[smoove] 2021/11/11 15:58:00 
[smoove] 2021/11/11 15:58:00 Failed to open -: could not parse header
[smoove] 2021/11/11 15:58:00 Failed to open -: unknown file type
panic: exit status 255

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/src/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xc14cc0, 0xc006f5c0f0, 0x7ffd84f02203, 0x2f, 0xc0001122c0, 0x2, 0x2, 0x7ffd84f022c0, 0x13, 0x7ffd84f021c3, ...)
	/home/brentp/src/smoove/svtyper/svtyper.go:226 +0x190a
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/src/smoove/lumpy/lumpy.go:363 +0x4ab
main.main()
	/home/brentp/src/smoove/cmd/smoove/smoove.go:121 +0x1c4
```
I cannot seem to find issues similar to this. What to do?
Thanks,
Mikhail",mdozmorov,https://github.com/brentp/smoove/issues/179
I_kwDOBxm8lM4-1lKS,lumpy_filter slower with 2 threads than 1,OPEN,2021-11-15T23:13:47Z,2021-11-17T06:54:46Z,,"The lumpy_filter command used by `smoove call` uses 2 threads, regardless of the `--processes` argument given to `smoove call`. Observing the running processes shows around 5-10% cpu utilisation. Testing the same lumpy_filter command outside of smooth with 1 thread instead of 2 yields ~100% cpu utilisation and much faster split and discordant bam generation.

Tested on both docker container 'quay.io/biocontainers/smoove:0.2.5--0' and  a conda environment with smoove version 0.2.8.",jemunro,https://github.com/brentp/smoove/issues/180
I_kwDOBxm8lM5A9nIT,smoove exits with panic: exit status 1,OPEN,2021-12-28T13:21:35Z,2021-12-28T14:45:16Z,,"Hello @brentp, 

I ran smoove like this ---

`smoove call --name ${sample} -x --exclude ${blist_region} --fasta ${FASTA} -p 3 --outdir ${sample}_smoove --genotype ${bam_path} `

and the following logs were generated while running:
                    
```
[smoove] 2021/12/28 07:01:59 starting with version 0.2.8
[smoove] 2021/12/28 07:01:59 calculating bam stats for 1 bams
[smoove] 2021/12/28 07:02:08 done calculating bam stats
[smoove]: ([E]lumpy-filter) 2021/12/28 07:18:36 [lumpy_filter] extracted splits and discordants from 998304035 total aligned reads
[smoove]:2021/12/28 07:19:13 finished process: lumpy-filter (set -eu; lumpy_filter -f /nfs/goldsteindata/refDB/HS_Build37/BWA_INDEX_hs37d5/hs37d5.fa /nfs/archive) in user-time:36m28.463383s system-time:2m31.014701s
could not load: libhts.so
compile with -d:nimDebugDlOpen for more information
panic: exit status 1

goroutine 24612 [running]:
github.com/brentp/smoove/lumpy.check(...)
        /home/brentp/src/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.remove_sketchy(0xc0000224e0, 0x27, 0x3e8, 0x7fff26af12bf, 0x3e, 0x7fff26af126c, 0x4a, 0xc000188480, 0x4, 0x4, ...)
        /home/brentp/src/smoove/lumpy/depthfilter.go:232 +0x1825
github.com/brentp/smoove/lumpy.remove_sketchy_all.func1(0xc0000daa80, 0x3e8, 0x7fff26af12bf, 0x3e, 0x7fff26af126c, 0x4a, 0xc000188480, 0x4, 0x4, 0x1, ...)
        /home/brentp/src/smoove/lumpy/depthfilter.go:399 +0x231
created by github.com/brentp/smoove/lumpy.remove_sketchy_all
        /home/brentp/src/smoove/lumpy/depthfilter.go:397 +0x194
(base) dev1:LUMPY$ could not load: libhts.so
compile with -d:nimDebugDlOpen for more information
```

Is this has to do with loading library `libhts.so`?

Would really appreciate resolution to this issue and please let me know if you need more information.

Note:
smoove generated these files successfully -- ${sample}.histo, ${sample}.disc.bam, ${sample}.split.bam (and *.split.bam.orig.bam and *disc.bam.orig.bam).

Thanks !




",am8265,https://github.com/brentp/smoove/issues/181
I_kwDOBxm8lM5BNw4i,Smoove for WES,CLOSED,2022-01-05T09:03:03Z,2022-01-05T15:49:21Z,2022-01-05T15:49:20Z,"Hello

I want to use Smoove for whole exome sequencing data. It is mentioned that Smoove could be used for exome data https://github.com/brentp/smoove/issues/89 

However, the author of Lumpy has mentioned that Lumpy is not designed for exome data: https://github.com/arq5x/lumpy-sv/issues/225#issuecomment-355760390

Overall, do you recommend using Smoove for exome data? If no, can you recommend other tools?

Thank you for the amazing tools!
Ali 
",alisaadat922,https://github.com/brentp/smoove/issues/182
I_kwDOBxm8lM5BcdK_,smoove duphold error during merge,CLOSED,2022-01-10T14:39:18Z,2022-01-14T19:57:18Z,2022-01-14T17:39:47Z,"When running the following command on 22,847 crams, I am getting an ""could not load index"" from bcftools. See output below.

`cat cram_22847.list|xargs -s 2080845  smoove duphold --processes $NSLOTS --fasta /restricted/projectnb/casa/ref/GRCh38_full_analysis_set_plus_decoy_hla.fa --vcf pVCF.ont/ont.graphtyper.chr$N.vcf.gz  --outvcf pVCF.ont/ont.graphtyper.chr$N.duphold.vcf.gz`

This is the beginning of the output:
[smoove] 2022/01/09 00:08:14 starting with version 0.2.6
[smoove] 2022/01/09 00:08:14 running duphold on 22847 files in 32 processes
[smoove] 2022/01/09 00:09:24 [duphold] finished
[smoove] 2022/01/09 00:09:25 [duphold] finished

This is the error message at the end:

tail smoove_duphold_ont.sh.o1742754
[smoove] 2022/01/09 05:09:00 [duphold] finished
[smoove] 2022/01/09 05:09:01 [duphold] finished
[smoove] 2022/01/09 05:09:02 [duphold] finished
[smoove] 2022/01/09 05:09:02 [duphold] finished
[smoove] 2022/01/09 05:09:03 [duphold] finished
[smoove] 2022/01/09 05:09:04 [duphold] finished
[smoove] 2022/01/09 05:09:04 starting bcftools merge
[smoove] 2022/01/09 11:37:48 [E::hts_idx_load3] Could not load local index file 'tmp.22/tempclean-606560922/dh009936222smoove-duphold.bcf.csi'
Failed to open tmp.22/tempclean-606560922/dh009936222smoove-duphold.bcf: could not load index
2022/01/09 11:38:53 exit status 255

The temp files are cleaned up on exiting so I am not able to look at the bcf files to see what may be happening.  

Any suggestions for this?  
",jjfarrell,https://github.com/brentp/smoove/issues/183
I_kwDOBxm8lM5B6xFr,sent empty file-name to xopen.Ropen or no records found with 'gene' type in gff,OPEN,2022-01-17T14:27:00Z,2023-06-12T13:22:16Z,,"Dear professor,
Thanks  a lot for such a good comprehensive tool. can you help to me to look at this question?
with or without gff both does not work; I have done successfully with call command
![image](https://user-images.githubusercontent.com/50854682/149787385-bd08fda1-ee52-4b67-b3d7-3f493645de06.png)
",asmlgkj,https://github.com/brentp/smoove/issues/184
I_kwDOBxm8lM5CF3Gv,smoove annotation,OPEN,2022-01-20T04:01:24Z,2022-01-20T12:15:13Z,,"Hi, @brentp, @lindenb 

Thanks for your great work !
There was a problem with the annotation
```
smoove annotate --gff silkie_end.gff3.gz 26indiv_ZW-smoove.genotyped.vcf.gz | bgzip -c > 26indiv_ZW-smoove.genotyped.anno.vcf.gz

(smoove) [poultrylab1@pbsnode01 sk_as_ref_118_indev_bam]$ sh smoove.sh
[smoove] 2022/01/20 11:23:25 starting with version 0.2.8
panic: runtime error: index out of range [2] with length 1

goroutine 1 [running]:
github.com/brentp/smoove/annotate.passOne(0x7fff46237edb, 0x12, 0xc00026fdc8, 0x1, 0x1, 0xc0003b2160)
        /home/brentp/src/smoove/annotate/annotate.go:156 +0x52f
github.com/brentp/smoove/annotate.readGff(0x7fff46237edb, 0x12, 0x1)
        /home/brentp/src/smoove/annotate/annotate.go:185 +0xc5
github.com/brentp/smoove/annotate.Main()
        /home/brentp/src/smoove/annotate/annotate.go:449 +0xa8
main.main()
        /home/brentp/src/smoove/cmd/smoove/smoove.go:121 +0x1c4

```

I don't know what happen.
Appreciate it !",Johnsonzcode,https://github.com/brentp/smoove/issues/185
I_kwDOBxm8lM5DE2P4,cannot rm quantized.bed.gz.csi,CLOSED,2022-02-06T23:04:21Z,2022-02-07T20:48:24Z,2022-02-07T20:48:24Z,"Hi there, 

Thanks so much for this software. Truly impressive!

I'm repeatedly running into the following error even when starting with a clean results folder. I've exported a tmp for which I have read and write error, but it seems like the issue might be with mosdepth which seems to get called without options.

The call is:
`ohta1/apps/smoove call --outdir female_smoove --name 342 --fasta $reference_fasta -p 1 --genotype ../female_bams/342.dd.bam`

Out to screen:
```
[smoove] 2022/02/06 17:56:40 starting with version 0.2.8
[smoove] 2022/02/06 17:56:40 calculating bam stats for 1 bams
[smoove] 2022/02/06 17:56:57 done calculating bam stats
[smoove]: ([E]lumpy-filter) 2022/02/06 17:59:36 [lumpy_filter] extracted splits and discordants from 126866930 total aligned reads
[smoove]:2022/02/06 17:59:37 finished process: lumpy-filter (set -eu; lumpy_filter -f ~/waterhemp/data/fixed_assembly/reveal_psuedoassembly/toshare/AMATA_finishe) in user-time:6m10.864391s system-time:29.195357s
Usage: mosdepth [options] <prefix> <BAM-or-CRAM>
rm: cannot remove ‘/ohta2/julia.kreiner/commongarden_results/female_bams/secondhalf/lumpy_sv/female_smoove/tmp/smoove-mosdepth-493136642.quantized.bed.gz.csi’: No such file or directory
panic: exit status 1

goroutine 28006 [running]:
github.com/brentp/smoove/lumpy.check(...)
        /home/brentp/src/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.remove_sketchy(0xc00002c240, 0x1a, 0x3e8, 0x7ffc2f284596, 0x65, 0x0, 0x0, 0xc000288480, 0x4, 0x4, ...)
        /home/brentp/src/smoove/lumpy/depthfilter.go:232 +0x1825
github.com/brentp/smoove/lumpy.remove_sketchy_all.func1(0xc0001b6120, 0x3e8, 0x7ffc2f284596, 0x65, 0x0, 0x0, 0xc000288480, 0x4, 0x4, 0x1, ...)
        /home/brentp/src/smoove/lumpy/depthfilter.go:399 +0x231
created by github.com/brentp/smoove/lumpy.remove_sketchy_all
        /home/brentp/src/smoove/lumpy/depthfilter.go:397 +0x194
```

Thanks,
Julia",jkreinz,https://github.com/brentp/smoove/issues/186
I_kwDOBxm8lM5DQyTg,SV lengths,CLOSED,2022-02-09T12:23:44Z,2022-02-14T14:11:36Z,2022-02-09T16:43:15Z,"Hi!When i check the smoove result. I find the DUP length is so large! I don't know why! 
Could somebody HELP me!
`chr1LG6 13106184        1330202 N       <DUP>   23.44   .       SVTYPE=DUP;SVLEN=251422240;END=264528424;STRANDS=-+:242;CIPOS=-2,2;CIEND=-2,2;CIPOS95=0,0;CIEND95=0,0;SU=242;PE=0;SR=242;SNAME=JI1539:9601,JI1093:5324,JI1980:3252,JI2348:2994,JI0058:2905,JI0328:7438,JI0015:4584,JI2083:6297,JI1092:5342,JI1794:5544,JI0083:3926,JI1094:5078,JI1088:5669,JI2517:7324,JI1491:5591,JI0132:5445,JI2548:5525,JI2350:5435,JI1585:4140,JI2530:6907,JI1587:3901,JI3511:4328,JI1313:4199,JI3604:3388,JI0932:5457,JI1542:7941,JI1469:5915,JI3148:5486,JI1132:3599,JI3159:5834,JI1626:3375,JI3157:5419,JI1395:3143,JI2115:5358,JI2698:6670,JI3156:5585,JI0554:3308,JI1084:3914,JI0268:3841;ALG=PROD;GCF=0.309327    GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB:DHFC:DHFFC:DHBFC  0/1:23:23.44:-4,-2,-4:53:46:6:45:5:28:2:0:17:2:0.1:0.764706:0.8125:0.764706`
Thank you very  much!",cfz1998,https://github.com/brentp/smoove/issues/187
I_kwDOBxm8lM5EAVHb,"""hangup"" error",OPEN,2022-02-17T06:42:28Z,2022-02-17T15:33:55Z,,"When i try:
[smoove annotate --gff $gff3 join_call.smoove.square.vcf.gz | bgzip -c > join_call.smoove.square.anno.vcf.gz ]

It always give me:
[smoove] 2022/02/17 11:08:27 starting with version 0.2.5
hangup

I don't know the reasons. Is it because I don't have enough memory?  Or caused by other reasons?
Thanks for your reply.
",cfz1998,https://github.com/brentp/smoove/issues/188
I_kwDOBxm8lM5ESKV7,panic: parsing time during smoove call,OPEN,2022-02-21T10:31:26Z,2022-02-23T14:19:49Z,,"Hi,

I'm having a weird parsing time issue when running smoove call on individual WGS cram (same on converted bam) samples (running it on population cohort):

```
singularity run /dcsrsoft/singularity/containers/smoove-0.2.7.sif smoove call   --outdir ./ --exclude /data/exclude.cnvnator_100bp.GRCh38.20170403.bed   --name GVA_VZV_01 --fasta /data/Homo_sapiens_assembly38.fasta   -p 1 --genotype /users/GVA_VZV_01.bam
WARNING: group: unknown groupid 124638
[smoove] 2022/02/21 11:26:26 starting with version 0.2.7
panic: parsing time ""201123-01-01T010000+0100"" as ""2006-01-02T150405"": cannot parse ""23-01-01T010000+0100"" as ""-"": line 3368: ""@RG\tID:GVA_VZV_01.HLCLYDSXY.1\tSM:GVA_VZV_01\tLB:NGS000002043\tPL:illumina\tPU:HLCLYDSXY.1.CCTTCACC+GGAGCGTC\tCN:H2030GC\tDT:201123-01-01T01:00:00+0100""

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7ffd8dcf4319, 0xad, 0x7ffd8dcf4202, 0x2, 0x7ffd8dcf42a6, 0x62, 0x0, 0x0, 0x0, 0x0, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:83 +0x105b
github.com/brentp/smoove/lumpy.Lumpy(0x7ffd8dcf4293, 0xa, 0x7ffd8dcf42a6, 0x62, 0x7ffd8dcf4202, 0x2, 0xc0001447a0, 0x1, 0x1, 0xc000178140, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:119 +0x12b
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce
```

Any idea how to fix this? It does create 2 files: GVA_VZV_01.disc.bam.tmp.bam and GVA_VZV_01.split.bam.tmp.bam
But I guess these are truncated.

Thanks a lot for your help,

Claire",redincla,https://github.com/brentp/smoove/issues/189
I_kwDOBxm8lM5FTbqj,gff format for GRCh38,OPEN,2022-03-08T14:26:38Z,2022-03-09T09:02:26Z,,"Good afternoon,

I've been trying desperately to annotate my final vcf file as the last step for smoove, using genome version hg38.
However, when I use the gencode gff3 file, I get the following error:
```
singularity run smoove  annotate --gff gencode.v39.annotation.gff3.gz test.smoove.square.vcf.gz | bgzip -c > test.smoove.square.anno.vcf.gz
WARNING: group: unknown groupid 124638
[smoove] 2022/03/08 15:09:37 starting with version 0.2.7
2022/03/08 15:09:49 no records found with 'gene' type in gff
```

And when I use the gff file from NCBI, I get the following:
```
singularity run smoove annotate --gff GCA_000001405.28_GRCh38.p13_genomic.gff.gz test.smoove.square.vcf.gz | bgzip -c > test.smoove.square.anno.vcf.gz
WARNING: group: unknown groupid 124638
[smoove] 2022/03/08 14:54:34 starting with version 0.2.7
2022/03/08 14:54:34 no records found with 'transcript' or 'mRNA' type in gff
```

I'm guessing the file I'm using is not the one smoove expects as an input (even though the Gencode file does contain gene type entries). Is smoove not accepting gff3 formats? Or any idea why I get this error? Alternatively, where can I download the appropriate gff/gff3 file for GRCH38/hg38?

Thanks a ton,

Claire",redincla,https://github.com/brentp/smoove/issues/190
I_kwDOBxm8lM5FdI5n,Error in lumpy-filter,CLOSED,2022-03-10T14:02:27Z,2022-03-11T10:54:04Z,2022-03-11T10:54:04Z,"Helllo,

I have been using smoove for a while, but now I got a error message that I do not understand:
```
[smoove]: ([E]lumpy-filter) 2022/03/10 13:28:03 [lumpy_filter] extracted splits and discordants from 596720214 total aligned reads
[smoove]:2022/03/10 13:28:08 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/mferreira/WGS_RM/reference_genome/Homo_sapiens.GRCh38.dna_sm.primary_) in user-time:30m8.25846s system-time:1m54.642271s
[smoove]:([E]lumpy-filter) 2022/03/10 13:28:49 [lumpy_filter] extracted splits and discordants from 590530375 total aligned reads
[smoove]:([E]lumpy-filter) 2022/03/10 13:28:49 mv: cannot stat 'teste/SAMPLE1.split.bam.tmp.bam'
[smoove]:([E]lumpy-filter) 2022/03/10 13:28:49 : No such file or directory
[smoove]:2022/03/10 13:28:49 finished process: lumpy-filter (set -eu; lumpy_filter -f /home/mferreira/WGS_RM/reference_genome/Homo_sapiens.GRCh38.dna_sm.primary_) in user-time:27m58.363001s system-time:1m43.333499s
[smoove]:2022/03/10 13:28:49 error running command: set -eu; lumpy_filter -f /home/mferreira/WGS_RM/reference_genome/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa /home/mferreira/WGS_RM/alignments/post_processed/others/11.postprocessed.bam teste/SAMPLE1.split.bam.tmp.bam teste/SAMPLE1.disc.bam.tmp.bam 2 && mv teste/SAMPLE1.split.bam.tmp.bam teste/SAMPLE1.split.bam && mv teste/SAMPLE1.disc.bam.tmp.bam teste/SAMPLE1.disc.bam && cp teste/SAMPLE1.split.bam teste/SAMPLE1.split.bam.orig.bam && cp teste/SAMPLE1.disc.bam teste/SAMPLE1.disc.bam.orig.bam -> exit status 1
```

My command line is :
`/home/mferreira/programs/smoove-0.2.8/smoove call -x --name sample_10 --fasta  /home/mferreira/WGS_RM/reference_genome/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa -p 10 --outdir teste --genotype /home/mferreira/WGS_RM/alignments/post_processed/others/10.postprocessed.bam`

Someone can help me to understand what I am made wrong?

Thanks
Marta

",Martaprf,https://github.com/brentp/smoove/issues/191
I_kwDOBxm8lM5F7Eh1,mosdepth error,CLOSED,2022-03-18T02:22:46Z,2022-03-21T06:00:53Z,2022-03-21T06:00:52Z,"Hi Brent,

I'm running smoove with a small reference cohort:

`smoove call -x --outdir /home/pauline/cnv_problem_files/1-0041-003/go_debug --name 1-0041-003_recal --fasta /myome/share/references/hs37d5/hs37d5.fa -p 12 --genotype /home/pauline/cnv_problem_files/1-0041-003/smoove_ref_cohort_tmdir_intern/HG01710.bam /home/pauline/cnv_problem_files/1-0041-003/smoove_ref_cohort_tmdir_intern/HG01709.bam /home/pauline/cnv_problem_files/1-0041-003/smoove_ref_cohort_tmdir_intern/HG00733.bam /home/pauline/cnv_problem_files/1-0041-003/smoove_ref_cohort_tmdir_intern/HG01695.bam /home/pauline/cnv_problem_files/1-0041-003/1-0041-003_recal.bam`

and getting the error: 
```
[smoove] 2022/03/18 02:18:14 starting with version 0.2.6
[smoove] 2022/03/18 02:18:14 calculating bam stats for 5 bams
[smoove] 2022/03/18 02:18:24 done calculating bam stats
bash: line 5:  3860 Killed                  mosdepth -f /myome/share/references/hs37d5/hs37d5.fa --fast-mode -n --quantize 1001: /home/pauline/smoove-mosdepth-862318781 /home/pauline/cnv_problem_files/1-0041-003/go_debug/HG01709.split.bam
panic: exit status 137


goroutine 81881 [running]:
github.com/brentp/smoove/lumpy.check(...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.remove_sketchy(0xc00023e320, 0x45, 0x3e8, 0x7fff7f3d0baa, 0x28, 0x0, 0x0, 0xc00018d640, 0x4, 0x4, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:232 +0x1818
github.com/brentp/smoove/lumpy.remove_sketchy_all.func1(0xc0017c8b40, 0x3e8, 0x7fff7f3d0baa, 0x28, 0x0, 0x0, 0xc00018d640, 0x4, 0x4, 0x1, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:399 +0x231
created by github.com/brentp/smoove/lumpy.remove_sketchy_all
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/depthfilter.go:397 +0x191
```
I saw there was an[ OOM issue ](https://github.com/brentp/mosdepth/issues/161)on your mosdepth repo, is there a way to specify memory with mosdepth inside smoove so this error doesn't occur?

Other information that may be relevant:
It's 1 particular bam that's causing the problem (1-0041-003). I can run 1-0041-003 individually and with a few other reference samples, but when it's run with all the reference files fails. 1-0041-003 is the sample file -- the others are my reference files and have run successfully with lots of other samples. 

Thanks,
Pauline",pauline-ng,https://github.com/brentp/smoove/issues/192
I_kwDOBxm8lM5GCB4s,libcrypto.so.1.0.0: cannot open shared object file error with biocontainers,CLOSED,2022-03-21T06:21:47Z,2022-10-12T12:00:09Z,2022-03-25T03:06:36Z,"Hi, 

Like previous users (#173, #147, #102, #13) I've run into the cannot find/open libcrypto error, this time while using Singularity and biocontainers (docker://quay.io/biocontainers/smoove:0.2.8--h9ee0642_0 and docker://quay.io/biocontainers/smoove:0.2.7--h9ee0642_0). I attempted to resolve the issue using the workarounds similar to that suggested by #173, but wasn't successful. Running both containers on two different systems I get the following error: 

```
[smoove] 2022/03/21 05:23:16 starting with version 0.2.8
[smoove] 2022/03/21 05:23:16 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2022/03/21 05:23:16 lumpy_filter: error while loading shared libraries: libcrypto.so.1.0.0: cannot open shared object file: No such file or directory
```

Cheers,
Georgie ",georgiesamaha,https://github.com/brentp/smoove/issues/193
I_kwDOBxm8lM5Gljoe,IMPRECISE Confuse,CLOSED,2022-03-29T03:30:08Z,2022-03-30T03:10:31Z,2022-03-30T03:10:31Z,"Hi！@brentp.
1. My sv files go through slivar annotations. For the annotated files, for DEL and DUP, I only keep those loci that have HQHET and HQHA samples, although this locus may also have LQHET. For other variant types, I only keep sites with MSHQ >= 3. I don't know if this method is possible.
2. I found that there are still many INFO ""IMPRECISE"" sites after filtering in the above way. Should these sites be retained or removed? Or should it be discarded as long as it is marked as ""IMPRECISE""?
Like this?
<chr1A_part1 141759 2120698_1 N [chr1A_part1:141900[N 233.8 .SVTYPE=BND;STRANDS=--:6;IMPRECISE;CIPOS=0,29;CIEND=-739,29;CIPOS95=0,9;CIEND95=-153,1 ;MATEID=2120698_2;EVENT=2120698;SU=6;PE=6;SR=0;SNAME=WATDE0978:1_1;ALG=PROD;GCF=0.514286;AN=1476;AC=3;MSHQ=4>
Or this?
<chr1A_part1 3418221 205622 N <DEL> 1477.1 . SVTYPE=DEL;SVLEN=-252;END=3418473;STRANDS=+-:11;IMPRECISE;CIPOS=-49,248;CIEND=-271,49;CIPOS95=-49,94; CIEND95=-121,49;SU=11;PE=11;SR=0;SNAME=Chinese_Spring:11,landmark:25;ALG=PROD;GCF=0;AN=1916;AC=1055;MSHQ=3.9746;HQHET =so many samples,HQHA=so many samples.>
NO LQHET! But is ""IMPRECIS"".

Thanks!
--zcf",cfz1998,https://github.com/brentp/smoove/issues/194
I_kwDOBxm8lM5HFM5J,"""Missing pair end parameters:mean stdev"" and histo files are empty.",CLOSED,2022-04-05T03:05:24Z,2022-04-06T08:12:59Z,2022-04-06T08:01:22Z,"Hello @brentp,

I ran smoove like this ---
smoove call --outdir results-smoove/ --name $sample --fasta $reference -p 1 --genotype ../${sample}.bam

For each BAM file, I have a ""disc.bam"", ""disc.bam.bai"", ""disc.bam.orig.bam"" and a ""histo"" file created. However, the histo files are empty.
I check the bam file and there was nothing wrong. Meanwhile, when I ran like this ---
samtools view -r ${sample} ${sample}.bam \
    | tail -n+100000 \
    | pairend_distro.py \
    -r 150 \
    -X 4 \
    -N 10000 \
    -o sample.lib1.histo
The ""histo"" file was created and the mean value was calculated.

Could you please give me some advice to solve this problem?

Best wishes,
Liu
",ggoodstudydaydayup,https://github.com/brentp/smoove/issues/195
I_kwDOBxm8lM5Ig8RU,Error reading index file from S3 bucket,OPEN,2022-04-26T23:30:00Z,2022-05-01T13:45:43Z,,"Hi all,

I'm trying to run this command (from inside a docker container):
```
smoove call --outdir /work/home/results-smoove-chr1/ --exclude /work/home/exclude.cnvnator_100bp.GRCh38.20170403.bed --name SP0184750 --fasta /work/home/GRCh38_full_analysis_set_plus_decoy_hla.fa -p 1 --excludechroms '~^GL,~^HLA,~_random,~^chrUn,~alt,~decoy,chr2,chr3,chr4,chr5,chr6,chr7,chr8,chr9,chr10,chr11,chr12,chr13,chr14,chr15,chr16,chr17,chr18,chr19,chr20,chr21,chr22,chrX,chrY,chrM' --genotype s3://<folder>/<filename.cram>
```

But I get this error:
```
[smoove] 2022/04/26 23:08:22 [E::idx_test_and_fetch] 
[smoove] 2022/04/26 23:08:22 Error reading ""s3://<folder>/<filename.cram>""
[smoove] 2022/04/26 23:08:22 
panic: signal: segmentation fault (core dumped)

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xbd6ec0, 0xc0000920f0, 0x7fffc62cec07, 0x35, 0xc00002d810, 0x1, 0x1, 0x7fffc62ceb8e, 0x1f, 0x7fffc62cebf5, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:159 +0x1818
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:347 +0x44f
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce
```

So it appears that smoove doesn't have a problem reading the alignment file directly, but it can't fetch the corresponding index file (which is also inside the S3 bucket). I'm wondering if that is the problem. If so, is there a practical solution to handle this? (I'm thinking I can download the index file for this CRAM, and I should be able to specify the location of this index file. It looks like this feature was added in the most recent version of mosdepth.)

Sincerely,
James",james-guevara,https://github.com/brentp/smoove/issues/196
I_kwDOBxm8lM5Il2E_,"panic: sam: duplicate program name: line 3430: ""@PG\tID:SAMBLASTER\tVN:0.1.24\tCL:samblaster -i dummy.cram.readsorted.sam -o dummy.cram.samblster.sam --addMateTags""",OPEN,2022-04-27T21:03:11Z,2022-05-04T19:21:22Z,,"> [smoove] 2022/04/27 15:54:53 starting with version 0.2.8
> panic: sam: duplicate program name: line 3430: ""@PG\tID:SAMBLASTER\tVN:0.1.24\tCL:samblaster -i dummy.cram.readsorted.sam -o dummy.cram.samblster.sam --addMateTags""
> 
> goroutine 1 [running]:
> github.com/brentp/smoove/lumpy.check(...)
>         /home/brentp/src/smoove/lumpy/lumpy.go:54
> github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7ffe572f8dc8, 0x11, 0x7ffe572f8dba, 0x3, 0x7ffe572f8d58, 0x58, 0x0, 0x0, 0x0, 0x0, ...)
>         /home/brentp/src/smoove/lumpy/lumpy.go:83 +0xfc5
> github.com/brentp/smoove/lumpy.Lumpy(0x7ffe572f8dc5, 0x2, 0x7ffe572f8d58, 0x58, 0x7ffe572f8dba, 0x3, 0xc00016a7b0, 0x1, 0x1, 0xc0000c79a0, ...)
>         /home/brentp/src/smoove/lumpy/lumpy.go:133 +0x131
> github.com/brentp/smoove/lumpy.Main()
>         /home/brentp/src/smoove/lumpy/lumpy.go:351 +0x29b
> main.main()
>         /home/brentp/src/smoove/cmd/smoove/smoove.go:121 +0x1c4

Running into this error when attempting to use smoove. Not quite sure how our data was generated, as it's far older than I've been working (and the generation process for this is new to me), but it appears to be related to SAMBLASTER. Any clues? I can submit a sample bam file via email if necessary.",AlecBayliff,https://github.com/brentp/smoove/issues/197
I_kwDOBxm8lM5JAona,panic:gzip: invalid header ,OPEN,2022-05-04T04:11:48Z,2022-05-12T06:42:07Z,,"I used singullarity to run smoove, but met below info and the job was killed.  Do you konw the reason?  something wrong with bam header?  how to fix this?  Thanks in advance. 

```
singularity exec \
smoove_latest.sif smoove call \
-x \
--name smoove.sv.vcf\
--exclude /smoove/exclude.b37.bed \
--fasta /homo_sapiens/GRCh37d5/genome/gr37.fasta \
-p 1 \
--outdir smoove/output \
--genotype \
N01_01_WG01.bam

```

Output: 
[smoove] 2022/05/04 00:07:40 starting with version 0.2.6
panic: gzip: invalid header

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7ffc9f88e482, 0x2d, 0x7ffc9f88e4fe, 0x24, 0x7ffc9f88e4b8, 0x37, 0x0, 0x0, 0x0, 0x0, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:83 +0x105b
github.com/brentp/smoove/lumpy.Lumpy(0x7ffc9f88e453, 0x2e, 0x7ffc9f88e4b8, 0x37, 0x7ffc9f88e4fe, 0x24, 0xc000126f00, 0x2, 0x2, 0xc000099360, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:119 +0x12b
github.com/brentp/smoove/lumpy.Main()
	/home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
	/home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce",gaom001,https://github.com/brentp/smoove/issues/198
I_kwDOBxm8lM5MIlgm,Smoove Call panic exit segmentation violation followed by unknown file type ,CLOSED,2022-06-20T19:38:24Z,2022-07-11T16:49:08Z,2022-07-11T16:48:30Z,"```     
        smoove call --genotype \
                    --duphold \
                    --processes 1 \
                    --fasta ref.fa \
                    --exclude ERR4083547.exclude.bed \
                    --name ERR4083547 \
                    --outdir ERR4083547 \
                    ERR4083547.sorted.bam
```
```
[smoove] 2022/06/20 13:19:48 > gsort version 0.1.4
[smoove] 2022/06/20 13:19:48 295	
[smoove] 2022/06/20 13:19:48 0
[smoove] 2022/06/20 13:19:59 panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x8 pc=0x546d43]

goroutine 1 [running]:
[smoove] 2022/06/20 13:19:59 bufio.NewReaderSize(...)
	/home/brentp/go/src/bufio/bufio.go:49
bufio.NewReader(...)
	/home/brentp/go/src/bufio/bufio.go:62
github.com/brentp/gsort.Sort(0x7ad380, 0x0, 0x7ad3a0, 0xc00038cf00, 0xc00038cec0, 0xaf0, 0x0, 0x0, 0x0)
	/home/brentp/go/go/src/github.com/brentp/gsort/gsort.go:116 +0x63
main.main()
	/home/brentp/go/go/src/github.com/brentp/gsort/cmd/gsort/gsort.go:373 +0x513
[smoove] 2022/06/20 13:19:59 Failed to open -: unknown file type
panic: exit status 255
```

Im getting a exit code I have not yet to come across using Smoove.  It appears that Im getting a simultaneous seg fault and unknown file type error. Its unclear which error is triggering the other. The bam and fa file look to be in working order. ",mrburke00,https://github.com/brentp/smoove/issues/199
I_kwDOBxm8lM5NPgV0,Smoove not working !!!!!! Failed to read from standard input: unknown file type panic: write |1: broken pipe,OPEN,2022-07-06T14:16:43Z,2023-01-25T23:37:45Z,,"@brentp Smoove is not working even after my bam size is quite good.
Command used:
smoove call --outdir test_mansi/SRR6745447_output/smoove_output/ --name SRR6745447 --fasta part_II/references/hg38.fa -p 1 --genotype part_II/output/fq2bam_no_indels/SRR6745447_sorted.bam

The size of bam is : 72 GB(WGS bam )

smoove --help
output:
smoove version: 0.2.8

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools
 *[Y] svtyper
 *[Y] mosdepth [extra filtering of split and discordant files for better scaling]

  [ ] duphold [(optional) annotate calls with depth changes]
  [ ] svtools [only needed for large cohorts].

Available sub-commands are below. Each can be run with -h for additional help.

call        : call lumpy (and optionally svtyper)
merge       : merge and sort (using svtools) calls from multiple samples
genotype    : parallelize svtyper on an input VCF
paste       : square final calls from multiple samples (each with same number of variants)
plot-counts : plot counts of split, discordant reads before, after smoove filtering
annotate    : annotate a VCF with gene and quality of SV call
hipstr      : run hipSTR in parallel
duphold     : run duphold in parallel (this can be done by adding a flag to call or genotype)
Error log:
[smoove] 2022/07/06 19:24:11 starting with version 0.2.8
[smoove] 2022/07/06 19:24:11 calculating bam stats for 1 bams
[smoove] 2022/07/06 19:24:20 done calculating bam stats
[smoove] 2022/07/06 19:24:20 removed 0 alignments out of 3232 (0.00%) with low mapq, depth > 1000, or from excluded chroms from sample.disc.bam in 1 seconds
[smoove] 2022/07/06 19:24:20 removed 0 alignments out of 3232 (0.00%) that were bad interchromosomals or flanked-splitters from sample.disc.bam
[smoove] 2022/07/06 19:24:20 kept 0 putative orphans
[smoove] 2022/07/06 19:24:20 removed 0 discordant orphans in 0 seconds
[smoove] 2022/07/06 19:24:20 removed 0 singletons and isolated interchromosomals of 3232 reads (0.00%) from sample.disc.bam in 0 seconds
[smoove] 2022/07/06 19:24:20 3232 reads (100.00%) of the original 3232 remain from sample.disc.bam
[smoove] 2022/07/06 19:24:21 removed 0 alignments out of 6258 (0.00%) with low mapq, depth > 1000, or from excluded chroms from sample.split.bam in 1 seconds
[smoove] 2022/07/06 19:24:21 removed 0 alignments out of 6258 (0.00%) that were bad interchromosomals or flanked-splitters from sample.split.bam
[smoove] 2022/07/06 19:24:21 kept 555 putative orphans
[smoove] 2022/07/06 19:24:21 removed 22 split orphans in 0 seconds
[smoove] 2022/07/06 19:24:21 removed 0 singletons of 6258 reads (0.00%) from sample.split.bam in 0 seconds
[smoove] 2022/07/06 19:24:21 6258 reads (100.00%) of the original 6258 remain from sample.split.bam
[smoove] 2022/07/06 19:24:21 starting lumpy
[smoove] 2022/07/06 19:24:21 wrote lumpy command to /mnt/ST160/part_II/test_mansi/SRR6745447_output/smoove_output//SRR6745447-lumpy-cmd.sh
[smoove] 2022/07/06 19:24:21 writing sorted, indexed file to /mnt/ST160/part_II/test_mansi/SRR6745447_output/smoove_output/SRR6745447-smoove.genotyped.vcf.gz
[smoove] 2022/07/06 19:24:21 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2022/07/06 19:24:21 chr22      1000000
chr22   2000000
chr22   4000000
chr22   8000000
chr22   16000000
[smoove] 2022/07/06 19:24:21 Failed to read from standard input: unknown file type
panic: write |1: broken pipe

goroutine 20112 [running]:
github.com/brentp/smoove/svtyper.check(...)
        /home/brentp/src/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper.func2(0xc0007a8a20, 0xc0002317d0, 0x1, 0x1, 0x7ffc34697ca7, 0x40, 0xc000027830, 0x2c, 0xc001464000, 0xc001464008, ...)
        /home/brentp/src/smoove/svtyper/svtyper.go:189 +0xa85
created by github.com/brentp/smoove/svtyper.Svtyper
        /home/brentp/src/smoove/svtyper/svtyper.go:165 +0xb87

please help me out as soon as possible
Thanks in Advance",mansi800,https://github.com/brentp/smoove/issues/200
I_kwDOBxm8lM5Ngvv-,"Error while running smoove genotype: ""panic: fork/exec $PATH/bin/svtyper: too many open files""",CLOSED,2022-07-11T09:14:25Z,2022-07-18T15:00:07Z,2022-07-18T14:59:17Z,"Hi,
I am using smoove genotype on a set of matched normal-tumor SV vcf (generated with smoove call). Now, while for the greatest majority of samples I properly run the complete pipeline (smoove call + smoove genotype), for some of them I'm getting an error I cannot figure out. The command is the following:
`smoove genotype --name $SAMPLE --fasta $REFERENCE --removepr --vcf $MYDIR/LumpyDir/$SAMPLE/$SAMPLE-smoove.vcf.gz --outdir $MYDIR/LumpyDir/$SAMPLE/ $BAM_NORMAL $BAM_TUMOR`
where:
$SAMPLE is the name of the sample, simply;
$REFERENCE is the reference genome where the raw reads have been mapped to;
$MYDIR specifies a directory (not relevant);
$BAM_NORMAL and  $BAM_TUMOR are the normal and the tumor sample bam files, respectively.

Well, when I run the command above I get this standard error on the terminal

> [smoove] 2022/07/11 09:04:07 starting with version 0.2.8
> [smoove] 2022/07/11 09:04:07 writing sorted, indexed file to $MYDIR/LumpyDir/$SAMPLE/$SAMPLE-smoove.genotyped.vcf.gz
> [smoove] 2022/07/11 09:04:09 > gsort version 0.1.4
> panic: fork/exec $PATH/bin/svtyper: too many open files
> 
> goroutine 5 [running]:
> github.com/brentp/smoove/svtyper.check(...)
> 	/home/brentp/src/smoove/svtyper/svtyper.go:33
> github.com/brentp/smoove/svtyper.Svtyper.func2(0xc00021a2a0, 0xc000222220, 0x2, 0x2, 0x7ffe1970e329, 0x61, 0xc000242270, 0x2c, 0xc000358070, 0xc000358078, ...)
> 	/home/brentp/src/smoove/svtyper/svtyper.go:179 +0xaa6
> created by github.com/brentp/smoove/svtyper.Svtyper
> 	/home/brentp/src/smoove/svtyper/svtyper.go:165 +0xb87
> 

Unluckily, coming from a biological background I guess I'm not skilled enough to get what's the problem, but what puzzles me is the fact that I properly run it on the majority of samples.

Thank you in advance, 
Giuseppe
",Giuseppe1995,https://github.com/brentp/smoove/issues/201
I_kwDOBxm8lM5N-GPB,Error while running smoove call: panic: sam: reference already used,OPEN,2022-07-18T15:23:01Z,2022-07-19T16:32:00Z,,"Hi, 
I am trying to run `smoove call` on a set of matched normal-tumor bam files.
I've properly run it on more than 100 WGS samples belonging to a dataset, but I' came up with a problem with the current dataset.
The command i run is the same, with basically the same options:
`smoove call --name $SAMPLE --fasta $REFERENCE --outdir ./LumpyDir/$SAMPLE excludechroms hs37d5,~^gi -p 4  $BAM_NORMAL $BAM_TUMOR`, where:
SAMPLE is the individual ID sample name;
REFERENCE is the reference genome (I'm using hs37d5_virus.fa, which is properly indexed);
BAM_NORMAL is the bam file for the control sample
BAM_TUMOR is the bam file for the tumor sample
in particular, I have this error (that appears immediately):

> [smoove] 2022/07/18 17:17:57 starting with version 0.2.8
> panic: sam: reference already used
> 
> goroutine 1 [running]:
> github.com/brentp/smoove/lumpy.check(...)
>         /home/brentp/src/smoove/lumpy/lumpy.go:54
> github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7ffee35f6f8f, 0x40, 0x7ffee35f6f5d, 0x10, 0x7ffee35f6eec, 0x67, 0x0, 0x0, 0x0, 0x0, ...)
>         /home/brentp/src/smoove/lumpy/lumpy.go:83 +0xfc5
> github.com/brentp/smoove/lumpy.Lumpy(0x7ffee35f6ede, 0x5, 0x7ffee35f6eec, 0x67, 0x7ffee35f6f5d, 0x10, 0xc0002b22a0, 0x2, 0x2, 0xc0002b8640, ...)
>         /home/brentp/src/smoove/lumpy/lumpy.go:133 +0x131
> github.com/brentp/smoove/lumpy.Main()
>         /home/brentp/src/smoove/lumpy/lumpy.go:351 +0x29b
> main.main()
>         /home/brentp/src/smoove/cmd/smoove/smoove.go:121 +0x1c4
> 
 
NOTE: the only thing that changed from the ""old"" dataset where everything worked fine is right the REFERENCE (but on this dataset I used correctly also other SV callers, without problems).
I've looked up the Issues section, but did not find anything useful. 

Thanks in advance, 
Giuseppe
",Giuseppe1995,https://github.com/brentp/smoove/issues/202
I_kwDOBxm8lM5QWbUc,important_regions bed,CLOSED,2022-08-23T14:31:15Z,2022-08-23T15:24:28Z,2022-08-23T15:24:28Z,"Hi there,

I have a few questions running smoove/Lumpy for the first time. 

1. For the following command in samplot vcf: 

samplot vcf --filter ""SVTYPE == 'DEL' & SU >= 8"" --filter ""SVTYPE == 'INV' & SU >= 5"" --vcf example.vcf -d test -O png --important_regions regions.bed -b sample1.bam sample2.bam sample3.bam > samplot_commands.sh

Is the important regions bed required? Is this the same as the exclude bed file found here: 
https://github.com/hall-lab/speedseq/blob/master/annotations/exclude.cnvnator_100bp.GRCh38.20170403.bed

2. If not is there a recommended bed file to use for this? 

3. Is there any further information as to why SU is set to >= 8 and INV >= 5?

Many thanks
",skose82,https://github.com/brentp/smoove/issues/203
I_kwDOBxm8lM5SvWB1,smoove duphold error,OPEN,2022-09-27T17:49:25Z,2022-09-27T19:25:34Z,,"Hi,

I am using the latest version of smoove and I am getting an error which I am unable to assess. I would be grateful if I could be helped with this. I have a trio VCF file which I have created/genotyped using sniffles2 using ONT long reads data and I want to add duphold annotations. This is the error I am getting and how do I deal with this? -

`[smoove] 2022/09/27 18:40:44 starting with version 0.2.8
[smoove] 2022/09/27 18:40:44 running duphold on 3 files in 32 processes
[smoove] 2022/09/27 18:44:08 [duphold] finished
I, [2022-09-27T18:40:45] -- duphold: no mates found. assuming single end reads
[smoove] 2022/09/27 18:44:08 [duphold] finished
I, [2022-09-27T18:40:45] -- duphold: no mates found. assuming single end reads
[smoove] 2022/09/27 18:44:09 [duphold] finished
I, [2022-09-27T18:40:45] -- duphold: no mates found. assuming single end reads
[smoove] 2022/09/27 18:44:09 starting bcftools merge
[smoove] 2022/09/27 18:44:09 The REF prefixes differ: GGGGCTCCTAAGGGAATAGGTTCAGGGAGCAAGGCAGGTTTTAGGGATGGTTTAGGGAGTTCTGGGGAAATGGGGTCAATGGATGAGGCAGGTTATAGGAAGAATT vs N (106,1)
Failed to merge alleles at chr1:201209820 in /tmp/tempclean-129135191/dh737826153smoove-duphold.bcf
`

Regards,
Prasun",prasundutta87,https://github.com/brentp/smoove/issues/204
I_kwDOBxm8lM5TmIwr,lumpy filter remove too much reads,OPEN,2022-10-10T02:18:16Z,2023-04-02T05:53:08Z,,"Hi,
when I ran the first code, the lumpy-filter removed more than 90% reads of my bam files. Are there something wrong with my original bam file? Is it possible to change the parameters of filtering? The process log is as follows:
$ smoove call --outdir results/ --name ZWG7 --fasta GCA_001704415.1_ARS1_genomic.fna -p 1 --genotype ZWG7.sorted.uniqe.dedup.bam
[smoove] 2022/10/10 09:20:44 starting with version 0.2.8
[smoove] 2022/10/10 09:20:50 calculating bam stats for 1 bams
[smoove] 2022/10/10 09:21:54 done calculating bam stats
[smoove]: 2022/10/10 09:26:57 finished process: lumpy-filter (set -eu; lumpy_filter -f /data/liyf/reference/GCA_001704415.1_ARS1_genomic.fna /data/liyf/data) in user-time:10m19.856767s system-time:46.940863s
[smoove] 2022/10/10 09:49:14 removed 287488 alignments out of 2188411 (13.14%) with low mapq, depth > 1000, or from excluded chroms from ZWG7.disc.bam in 1337 seconds
[smoove] 2022/10/10 09:49:14 removed 341630 alignments out of 2188411 (15.61%) that were bad interchromosomals or flanked-splitters from ZWG7.disc.bam
[smoove] 2022/10/10 09:50:02 kept 8787 putative orphans
[smoove] 2022/10/10 09:50:02 removed 499606 discordant orphans in 28 seconds
[smoove] 2022/10/10 09:50:18 removed 1469059 singletons and isolated interchromosomals of 1559293 reads (94.21%) from ZWG7.disc.bam in 64 seconds
[smoove] 2022/10/10 09:50:18 90234 reads (4.12%) of the original 2188411 remain from ZWG7.disc.bam
[smoove] 2022/10/10 09:59:40 removed 16755 alignments out of 141102 (11.87%) with low mapq, depth > 1000, or from excluded chroms from ZWG7.split.bam in 560 seconds
[smoove] 2022/10/10 09:59:41 removed 32891 alignments out of 141102 (23.31%) that were bad interchromosomals or flanked-splitters from ZWG7.split.bam
[smoove] 2022/10/10 09:59:44 kept 777 putative orphans
[smoove] 2022/10/10 09:59:44 removed 86 split orphans in 1 seconds
[smoove] 2022/10/10 09:59:52 removed 88760 singletons of 91456 reads (97.05%) from ZWG7.split.bam in 11 seconds
[smoove] 2022/10/10 09:59:52 2696 reads (1.91%) of the original 141102 remain from ZWG7.split.bam
[smoove] 2022/10/10 09:59:57 starting lumpy
[smoove] 2022/10/10 09:59:57 wrote lumpy command to results//ZWG7-lumpy-cmd.sh
[smoove] 2022/10/10 09:59:57 writing sorted, indexed file to results/ZWG7-smoove.genotyped.vcf.gz
[smoove] 2022/10/10 09:59:57 excluding variants with all unknown or homozygous reference genotypes",yefanglee,https://github.com/brentp/smoove/issues/205
I_kwDOBxm8lM5TyJkt,Question about Exclude region ,CLOSED,2022-10-12T06:38:51Z,2022-10-17T15:39:40Z,2022-10-12T19:56:16Z,"Hi :)

I tried to use smoove. And my code is below

`smoove call  --name $sample_id  --exclude dir/to/ceph18.b37.lumpy.exclude.2014-01-15.bed  --fasta $ref_hg19_fa  --outdir $out_path  --genotype  --duphold -p 1 $in_bam_file`

But, when I got result, some variant contained 'exclude region'

For example,
in ceph18.b37.lumpy.exclude.2014-01-15.bed
`1	70027377	70027675`

`4	49633314	52668449`

and one of my result

`chr1    70027324        4367    N       <DEL>   1085.3  . SVTYPE=DEL;SVLEN=-352;END=70027676;STRANDS=+-:38;IMPRECISE;CIPOS=-21,92;CIEND=-108,29;CIPOS95=-2,27;CIEND95=-31,5;SU=38;PE=38;SR=0;PRPOS=3.28842e-14,1.48926e-13,6.7368e-13,3.04501e-12,1.37487e-11,6.2025 ........................... 22,1.80397e-24,2.59285e-26,3.71925e-28,2.88433e-30,1.64223e-32,9.33575e-35,5.30169e-37,3.00445e-39,1.70081e-41,9.61207e-44;AC=1;AN=2;GCF=0.507082;MSHQ=4     GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB:DHFC:DHFFC:DHBFC:DHSP:SHQ 0/1:125:1085.34:-110,-1,-14:80:35:45:34:44:6:0:6:28:38:0.56:0.25:0.232877:0.283333:39:4`

`chr4    49634039        55109   N       <DEL>   16470.1 .       SVTYPE=DEL;SVLEN=-23809;END=49657848;STRANDS=+-:4;IMPRECISE;CIPOS=-30,449;CIEND=-450,29;CIPOS95=0,257;CIEND95=-257,0;SU=4;PE=4;SR=0;PRPOS=3.89606e-19,1.33033e-18,4.54247e-18,1.55105e-17,5.29613e-17,1.80839e-16,6.17484e-16,2.10843e-15,7.19933e-15,2.45825e-14,8.39381e-14,2.86611e-13,9.78646e-13,3.34163e-12,1.14102e-11,3.89606e-11,1.330 ......................... 63,9.78646e-05,2.86611e-05,8.39381e-06,2.45825e-06,7.19933e-07,2.10843e-07,6.17484e-08,1.80839e-08,5.29613e-09,1.55105e-09,4.54247e-10,1.33033e-10,3.89606e-11,1.14102e-11,3.34163e-12,9.78646e-13,2.86611e-13,8.39381e-14,2.45825e-14,7.19933e-15,2.10843e-15,6.17484e-16,1.80839e-16,5.29613e-17,1.55105e-17,4.54247e-18,1.33033e-18;AC=1;AN=2;GCF=0.407644;MSHQ=4      GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB:DHFC:DHFFC:DHBFC:DHSP:SHQ      0/1:200:16470.1:-1674,-27,-688:1968:1220:747:1219:746:865:4:722:354:20:0.38:4.94366:1.57399:4.875:25:4`

I don't know why I get this result.
Help me 

Thank you!",hayeon-pak,https://github.com/brentp/smoove/issues/206
I_kwDOBxm8lM5UwYXV,runtime: failed to create new OS thread,CLOSED,2022-10-25T07:06:25Z,2022-10-26T07:56:34Z,2022-10-26T07:56:34Z,"Hello,

I'm running smoke on docker and get the following error. Do you have any suggestion?

Thank you,
Arda


docker run -v /Users/asoylev/genomes:/inp -it brentp/smoove smoove call -name dnm --fasta /inp/hg38.fasta --genotype /inp/hg00733_grch38_realigned.bam
WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
[smoove] 2022/10/24 21:36:09 starting with version 0.2.6
[smoove] 2022/10/24 21:36:09 calculating bam stats for 1 bams
[smoove] 2022/10/24 21:36:40 done calculating bam stats



[smoove]: ([E]lumpy-filter) 2022/10/24 22:19:14 [lumpy_filter] extracted splits and discordants from 696974278 total aligned reads
[smoove]:2022/10/24 22:19:17 finished process: lumpy-filter (set -eu; lumpy_filter -f /inp/hg38.fasta /inp/hg00733_grch38_realigned.bam .//sample.split.bam.tmp.b) in user-time:56m8.612767s system-time:15m5.577029s

[smoove] 2022/10/24 22:24:19 removed 5858450 alignments out of 7295943 (80.30%) with low mapq, depth > 1000, or from excluded chroms from sample.split.bam in 303 seconds
[smoove] 2022/10/24 22:24:19 removed 388849 alignments out of 7295943 (5.33%) that were bad interchromosomals or flanked-splitters from sample.split.bam

[smoove] 2022/10/24 22:28:50 removed 10477804 alignments out of 15968796 (65.61%) with low mapq, depth > 1000, or from excluded chroms from sample.disc.bam in 573 seconds
[smoove] 2022/10/24 22:28:50 removed 452679 alignments out of 15968796 (2.83%) that were bad interchromosomals or flanked-splitters from sample.disc.bam

[smoove] 2022/10/24 22:36:01 kept 9248 putative orphans
[smoove] 2022/10/24 22:36:01 removed 1228327 discordant orphans in 306 seconds
[smoove] 2022/10/24 22:36:57 removed 4738501 singletons and isolated interchromosomals of 5038313 reads (94.05%) from sample.disc.bam in 488 seconds
[smoove] 2022/10/24 22:36:57 299812 reads (1.88%) of the original 15968796 remain from sample.disc.bam

[smoove] 2022/10/24 22:37:48 kept 100685 putative orphans
[smoove] 2022/10/24 22:37:48 removed 172600 split orphans in 704 seconds
[smoove] 2022/10/24 22:38:04 removed 661586 singletons of 1048644 reads (63.09%) from sample.split.bam in 824 seconds
[smoove] 2022/10/24 22:38:04 387058 reads (5.31%) of the original 7295943 remain from sample.split.bam
[smoove] 2022/10/24 22:38:04 starting lumpy
[smoove] 2022/10/24 22:38:04 wrote lumpy command to .//dnm-lumpy-cmd.sh
[smoove] 2022/10/24 22:38:04 writing sorted, indexed file to dnm-smoove.genotyped.vcf.gz
[smoove] 2022/10/24 22:38:04 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2022/10/24 22:38:05 runtime: failed to create new OS thread (have 2
[smoove] 2022/10/24 22:38:05  already; errno=22)
fatal error: newosproc
[smoove] 2022/10/24 22:38:05 
runtime stack:
[smoove] 2022/10/24 22:38:05 runtime.throw(
[smoove] 2022/10/24 22:38:05 0x6cb13d
[smoove] 2022/10/24 22:38:05 , 
[smoove] 2022/10/24 22:38:05 0x9)
[smoove] 2022/10/24 22:38:05 	/home/brentp/go/go1.8/src/runtime/panic.go:596 +0x95
runtime.newosproc(0xc420024000, 0xc420034000)
	/home/brentp/go/go1.8/src/runtime/os_linux.go:163 +0x18c
runtime.newm(0x6d9d28, 0x0)
	/home/brentp/go/go1.8/src/runtime/proc.go:1628 +0x137
runtime.main.func1()
	/home/brentp/go/go1.8/src/runtime/proc.go:126 +0x36
runtime.systemstack(0x815400)
	
[smoove] 2022/10/24 22:38:05 /home/brentp/go/go1.8/src/runtime/asm_amd64.s:327 +0x79
runtime.mstart()
	/home/brentp/go/go1.8/src/runtime/proc.go:1132

goroutine 1 [running]:
[smoove] 2022/10/24 22:38:05 runtime.systemstack_switch()
	/home/brentp/go/go1.8/src/runtime/asm_amd64.s:281 fp=0xc420020788 sp=
[smoove] 2022/10/24 22:38:05 0xc420020780
runtime.main()
	/home/brentp/go/go1.8/src/runtime/proc.go:127 +0x6c fp=0xc4200207e0 sp=0xc420020788
[smoove] 2022/10/24 22:38:05 runtime.goexit()
	/home/brentp/go/go1.8/src/runtime/asm_amd64.s:2197 +0x1 fp=0xc4200207e8 sp=0xc4200207e0
[smoove] 2022/10/24 22:38:05 Failed to read from standard input: unknown file type
[smoove] 2022/10/24 22:38:05 chr1	1000000
[smoove] 2022/10/24 22:38:05 [W::hts_idx_load3] 
[smoove] 2022/10/24 22:38:05 The index file is older than the data file: /inp/hg00733_grch38_realigned.bai
[smoove] 2022/10/24 22:38:05 
[smoove] 2022/10/24 22:38:37 chr10	1000000
[smoove] 2022/10/24 22:38:55 chr11	1000000
[smoove] 2022/10/24 22:38:59 [W::hts_idx_load3] The index file is older than the data file: /inp/hg00733_grch38_realigned.bai
[smoove] 2022/10/24 22:38:59 
[smoove] 2022/10/24 22:39:11 chr12	1000000
[smoove] 2022/10/24 22:39:29 chr13	1000000
[smoove] 2022/10/24 22:39:29 chr13	2000000
chr13	4000000
chr13	8000000
chr13	16000000
chr13	32000000
[smoove] 2022/10/24 22:39:41 chr14	1000000
chr14	2000000
chr14	4000000
chr14	8000000
chr14	16000000
[smoove] 2022/10/24 22:39:41 chr14	32000000
[smoove] 2022/10/24 22:39:46 [W::hts_idx_load3] 
[smoove] 2022/10/24 22:39:46 The index file is older than the data file: /inp/hg00733_grch38_realigned.bai
[smoove] 2022/10/24 22:39:46 
[smoove] 2022/10/24 22:39:52 chr14_GL000009v2_random	1000000
[smoove] 2022/10/24 22:39:52 chr14_GL000225v1_random	1000000
[smoove] 2022/10/24 22:39:52 chr14_KI270722v1_random	1000000
[smoove] 2022/10/24 22:39:52 chr14_GL000194v1_random	1000000
[smoove] 2022/10/24 22:39:52 chr14_KI270723v1_random	1000000
[smoove] 2022/10/24 22:39:52 chr14_KI270724v1_random	1000000
[smoove] 2022/10/24 22:39:52 chr14_KI270725v1_random	1000000
[smoove] 2022/10/24 22:39:52 chr14_KI270726v1_random	1000000
[smoove] 2022/10/24 22:39:53 chr15	1000000
chr15	2000000
chr15	4000000
[smoove] 2022/10/24 22:39:53 chr15	8000000
chr15	16000000
chr15	32000000
[smoove] 2022/10/24 22:40:03 chr16	1000000
[smoove] 2022/10/24 22:40:17 chr16_KI270728v1_random	1000000
[smoove] 2022/10/24 22:40:17 chr17	1000000
[smoove] 2022/10/24 22:40:30 chr17_GL000205v2_random	1000000
[smoove] 2022/10/24 22:40:30 chr17_KI270729v1_random	1000000
panic: write |1: broken pipe

goroutine 117394 [running]:
github.com/brentp/smoove/svtyper.check(...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper.func2(0xc000a826c0, 0xc000148590, 0x1, 0x1, 0x4000800ea8, 0xf, 0xc000a90300, 0x2c, 0xc0044eae18, 0xc0044eae30, ...)
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:189 +0x8e7
created by github.com/brentp/smoove/svtyper.Svtyper
	/home/brentp/go/go/src/github.com/brentp/smoove/svtyper/svtyper.go:165 +0xab2",asylvz,https://github.com/brentp/smoove/issues/207
I_kwDOBxm8lM5WNgO9,smoove calls huge number of calls,CLOSED,2022-11-12T10:17:40Z,2022-12-18T14:15:13Z,2022-12-18T14:15:13Z,"Hi

I developed a pipeline for Short Read WGS data and I included smoove calls using the follow command:

`smoove call --name $sample_id --exclude $excluded_regions_smoove --fasta $reference_file -p 8 $alignment_file`

Running the pipeline in a cohort of samples I have some weird results, 
basically smoove calls a huge number of variants compared to other tools in some samples: for examples it calls 134237 variants of which 130095 have `SU `< 8 and in the same sample, other tools calls 6623/5900 variants. 
Since each smoove-variants have a FILTER equals to `"".""` so I was wondering if I could use `SU` value for filtering out low quality variants or if I can use some other metrics in vcf file.

Thanks 
 ",Manuelaio,https://github.com/brentp/smoove/issues/208
I_kwDOBxm8lM5WZOdS,[smoove] 2022/11/15 10:20:53 starting with version 0.2.8 [smoove] 2022/11/15 10:20:53 lumpy executable not found in PATH,CLOSED,2022-11-15T09:27:28Z,2022-11-26T04:27:19Z,2022-11-26T04:27:19Z,,assane-mbodj,https://github.com/brentp/smoove/issues/209
I_kwDOBxm8lM5W-7cJ,missing pair end parameters:mean stdev ,CLOSED,2022-11-22T07:58:42Z,2022-11-22T16:31:23Z,2022-11-22T16:31:23Z,"Hi,

I was trying to run lumpy (lumpy express) with my BAM file from linked-read (10X genomics), I got the error, **missing pair end parameters:mean stdev** 
I ran samtools flagstat of the BAM file, and the result is like this.

1229732610 + 0 in total (QC-passed reads + QC-failed reads)
71294644 + 0 secondary
0 + 0 supplementary
99357616 + 0 duplicates
1196357481 + 0 mapped (97.29% : N/A)
1158437966 + 0 paired in sequencing
579218983 + 0 read1
579218983 + 0 read2
942995218 + 0 properly paired (81.40% : N/A)
1107682081 + 0 with itself and mate mapped
17380756 + 0 singletons (1.50% : N/A)
82945640 + 0 with mate mapped to a different chr
67312618 + 0 with mate mapped to a different chr (mapQ>=5)

It looks not bad, and could you give me some guidance for successful running the tool please?",distilledchild,https://github.com/brentp/smoove/issues/210
I_kwDOBxm8lM5ZEztS,bcftools: error while loading shared libraries: libopenblas.so.0: cannot open shared object file: No such file or directory > gsort version 0.1.4,CLOSED,2022-12-13T14:58:44Z,2022-12-15T15:02:23Z,2022-12-15T15:02:23Z,"Hi, I'm using smoove inside a pipeline written with Nextflow. In order to run smoove I'm using singularity with the https://depot.galaxyproject.org/singularity/smoove/0.2.8--h9ee0642_1 image. While smoove was running it stops showing the error in the title. How can I fix this? ",FrancescaMiccolis,https://github.com/brentp/smoove/issues/211
I_kwDOBxm8lM5ZTRKo, samtools index: failed to create index for *mybamfile*  panic: exit status 1,CLOSED,2022-12-15T10:58:52Z,2022-12-15T16:12:51Z,2022-12-15T16:12:50Z,"Hi, while running smoove this error occurs. 
` WARNING: underlay of /usr/share/zoneinfo/Etc/UTC required more than 50 (81) bind mounts
  [smoove] 2022/12/14 01:18:54 starting with version 0.2.6
  [smoove] 2022/12/14 01:18:54 calculating bam stats for 1 bams
  [smoove] 2022/12/14 01:20:03 done calculating bam stats
  [smoove]: ([E]lumpy-filter) 2022/12/14 03:01:44 [lumpy_filter] extracted splits and discordants from 780902882 total aligned reads
  [smoove]:2022/12/14 03:02:07 finished process: lumpy-filter (set -eu; lumpy_filter -f GRCh38.d1.vd1.fa sorted_DNA.bam .//sorted_DNA.split.bam.tm) in user-time:1h34m1.018034s system-time:13m56.817703s
  [E::hts_idx_push] Chromosome blocks not continuous
  [E::sam_index] Read 'V300042162L2C001R0010000456' with ref_name='chr4', ref_length=190214555, flags=97, pos=85001647 cannot be indexed
  samtools index: failed to create index for ""./sorted_DNA.disc.bam""
  panic: exit status 1
  `
The BAM input file is sorted by name and not by coordinate. Could be this the problem causing this error? Should I run smoove without previous sorting the file?",FrancescaMiccolis,https://github.com/brentp/smoove/issues/212
I_kwDOBxm8lM5chcQR,Docker image missing svtyper,OPEN,2023-01-22T20:23:37Z,2023-01-22T20:23:37Z,,"I ran this in the latest docker image and got the following error:

`panic: exec: ""svtyper"": executable file not found in $PATH`

When I reload the docker image, and run smoove without arguments, it confirms that svtyper is indeed missing from the path:

```
Using default tag: latest
latest: Pulling from brentp/smoove
Digest: sha256:d0d6977dcd636e8ed048ae21199674f625108be26d0d0acd39db4446a0bbdced
Status: Image is up to date for brentp/smoove:latest
docker.io/brentp/smoove:latest

mcv053$ smoove
smoove version: 0.2.6

smoove calls several programs. Those with 'Y' are found on your $PATH. Only those with '*' are required.

 *[Y] bgzip [ sort   -> (compress) ->   index ]
 *[Y] gsort [(sort)  ->  compress   ->  index ]
 *[Y] tabix [ sort   ->  compress   -> (index)]
 *[Y] lumpy
 *[Y] lumpy_filter
 *[Y] samtools
 *[ ] svtyper
 *[Y] mosdepth [extra filtering of split and discordant files for better scaling]

  [Y] duphold [(optional) annotate calls with depth changes]
  [ ] svtools [only needed for large cohorts].

...
```



Looking through the docker file, it seems like svtyper should be available. Is this a problem anyone else has encountered?",mcv053,https://github.com/brentp/smoove/issues/213
I_kwDOBxm8lM5exbTS,sanity checks for sorted and RGs,OPEN,2023-02-17T22:07:41Z,2023-02-18T00:50:56Z,,"Hey there!

I've noticed some less-than-informative errors when running smoove with bam files not sorted by position files, those without read groups, and particularly with read groups without the SM tag. I don't see anywhere in the documentation that these are required, so figuring. Are sanity checks for these possible?

Thanks!",hemstrow,https://github.com/brentp/smoove/issues/214
I_kwDOBxm8lM5fuKZl,non-SV filtering,OPEN,2023-03-02T00:59:13Z,2023-03-29T10:10:13Z,,"Hi,

After using smoove to extract SVs for the trio, we attempt to use slivar on them to extract denovo-SVs.
For example, mom:0/0, dad:0/0 -> kid:0/1 or 1/1 as denovo-SV. I use DHFFC < 0.7 for filtering DEL and DHFFC > 1.25 for filtering DUP. Is there any filtering for the part without SV (the 0/0 part)?
I would appreciate it if you could enlighten me.

best,
tora",torakichi1219,https://github.com/brentp/smoove/issues/215
I_kwDOBxm8lM5gJF9m,No INS records,CLOSED,2023-03-07T08:55:23Z,2023-03-07T15:53:34Z,2023-03-07T15:53:34Z,"Thank you for your awesome tool for calling and genotyping SVs! 
It is really smooth and user-friendly!

I had problems about the insertion records in results. 
I tested two real data sets to call SVs with commands:
```shell
sample=SampleA # or sampleB

# bwa map
echo ""# BWA map""
bwa mem -t 8 -M ~/ref/Chr.fa ${sample}_1.fq.gz ${sample}_2.fq.gz > ${sample}.sam 2> ./${sample}.mem-pe.log

# samtools sort index
samtools sort -o ${sample}.bam ${sample}.sam
samtools index ${sample}.bam
rm -rf ${sample}.sam

# smoove 0.2.8, call SVs
singularity exec ~/tools/smoove_latest.sif smoove call --outdir ${sample}_smoove --name $sample --fasta ~/ref/Chr.fa -p 1 --genotype ${sample}.bam

# count ins records
cat ${sample}_smoove/${sample}-smoove.genotyped.vcf.gz| grep 'SVTYPE=INS'|wc -l
# 0

# check ins in annotation lines
cat ${sample}_smoove/${sample}-smoove.genotyped.vcf.gz| grep 'INS'
# ##ALT=<ID=INS,Description=""Insertion of novel sequence"">
```
but I got no INS records in both of two data sets.

Files could be downloaded here:
[SampleA-smoove.genotyped.vcf.gz](https://cgm.sjtu.edu.cn/test/hzxue/SampleA-smoove.genotyped.vcf.gz) and [SampleB-smoove.genotyped.vcf.gz](https://cgm.sjtu.edu.cn/test/hzxue/SampleB-smoove.genotyped.vcf.gz).

I noticed that ''excluding variants with all unknown or homozygous reference genotypes'' existed in log. So INS is defined as unknown? Is it correct? 
",zhixue,https://github.com/brentp/smoove/issues/216
I_kwDOBxm8lM5jUls7,Run smoove for single sample?,CLOSED,2023-04-13T12:39:46Z,2023-04-13T15:43:36Z,2023-04-13T14:16:18Z,"Hi,

Many thanks for the many awesome tools! I'm currently running structural variant validation for GIAB hg002 sample, which was sequenced with our cohort of samples. My plan is to detect SVs with various tools (e.g. Smoove, Manta, CNVnator, GATK gCNV) and merge the results. So far the recall is very low with any tool. E.g. Smoove results in overall ~ 20% recall. Is this because I was running it for the hg002 sample alone, is smoove only meant for cohort analysis?

The data was sequenced with NovaSeq 6000 with 50X coverage and aligned to hg38 with bwa-mem. I have validated the SNVs (called with DeepVariant) with very good precision / recall, and thus doubt there's a problem with the data. 

I lifted the HG002_SVs_Tier1_v0.6.vcf.gz to hg38 using UCSC liftover, and I'm using Truvari to validate the data with tier1 regions bed (also lifted over). The liftover is my next suspect for the poor sensitivity, since all tools seem to perform equally bad.

Sorry to be rambling a bit, my main question is:

Can I run smoove for a single sample, or is it only applicable in cohort -mode?

Best,
Karoliina",karoliinas,https://github.com/brentp/smoove/issues/217
I_kwDOBxm8lM5mA2NX,panic: open /path/to/*.bam: no such file or directory,CLOSED,2023-05-16T08:17:46Z,2023-05-16T19:55:07Z,2023-05-16T11:19:45Z,"Hi, 

I try to use docker to run smoove, but I meet a problem on smoove call.
I do have my bam file in that directory, and I checked that the paths and names are correct, so I don't know how to fix this.

Below is the command I use.
`docker run -it brentp/smoove smoove call -x --support 3 --duphold --genotype -p 40 \
--name AS_01 \
--outdir /home/data2/TVGH_project/ASC_WES/Welgene/NGS1110946/AS_01/smoove/ \
--fasta /home/data/data_thousand/gatk_index/Homo_sapiens_assembly38.fasta \
/home/data2/TVGH_project/ASC_WES/Welgene/NGS1110946/AS_01/AS_01T_sorted_du_bqsr.bam`

And this is the error message I get.
`[smoove] 2023/05/16 08:10:13 starting with version 0.2.6
panic: open /home/data2/TVGH_project/ASC_WES/Welgene/NGS1110946/AS_01/AS_01T_sorted_du_bqsr.bam: no such file or directory

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.check(...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7ffee0ec6e91, 0x53, 0x7ffee0ec6e05, 0x41, 0x7ffee0ec6e4f, 0x41, 0x0, 0x0, 0x0, 0x0, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:83 +0x105b
github.com/brentp/smoove/lumpy.Lumpy(0x7ffee0ec6df6, 0x5, 0x7ffee0ec6e4f, 0x41, 0x7ffee0ec6e05, 0x41, 0xc000173610, 0x1, 0x1, 0xc0001a6960, ...)
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:119 +0x12b
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/go/src/github.com/brentp/smoove/lumpy/lumpy.go:335 +0x261
main.main()
        /home/brentp/go/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:121 +0x1ce`

Thank you!",Gummy89,https://github.com/brentp/smoove/issues/218
I_kwDOBxm8lM5pE_VW,Different genotype of SV for the same sample in different batch,OPEN,2023-06-19T07:20:44Z,2023-06-19T07:20:44Z,,"I am using smoove for SV calling for population-level calling, Using smoove merge to get the union of sites across all samples, and for the genotype step, I used the different strategs 1) genotype each sample and paste all the single sample VCFs togather; 2) extract some samples to genotype and paste all the single sample VCFs togather. And I find there are some differences in genotypes for SV with different batches. I don't know what results in the different genotypes. ",lemon-latte,https://github.com/brentp/smoove/issues/219
I_kwDOBxm8lM5qhKAs,Polyploidy,OPEN,2023-07-04T03:25:49Z,2023-07-07T17:11:15Z,,"Hi Brentp, 

I have a sample that's triploid. Any plans to allow smoove to be able to given a ploidy before calling? ",goeckeritz,https://github.com/brentp/smoove/issues/220
I_kwDOBxm8lM5rdFyZ,【need help】An error occurred when running to Merge,OPEN,2023-07-13T11:11:29Z,2023-10-14T04:29:36Z,,"Hi Brentp,I am very grateful for using your work，and an error occurred while I was running this step

#smoove merge --name merged -f $reference_fasta --outdir ./ results-smoove/*.genotyped.vcf.gz

I ran the program in the format provided by README.md ,But the program exited
smoove merge --name merged --fasta ./ARS-UCD1.2_Btau5.0.1Y.fa --outdir outdir/ ./*genotyped.vcf.gz

[smoove] 2023/07/13 18:57:24 starting with version 0.2.8
[smoove] 2023/07/13 18:57:24 merging 3 files
[smoove] 2023/07/13 18:57:24 finished sorting 3 files; merge starting.
2023/07/13 18:57:24 exit status 1

Generated a file named “merged.lsort.vcf” , The content is as follows:

Traceback (most recent call last):
  File ""/home/miniconda3/envs/smoove/bin/lsort"", line 70, in <module>
    sys.exit(main())
  File ""/home/miniconda3/envs/smoove/bin/lsort"", line 27, in main
    samples = l_bp.parse_vcf(vcf_file_name, vcf_lines, vcf_headers)
  File ""/home/miniconda3/envs/smoove/bin/l_bp.py"", line 16, in parse_vcf
    f = open(vcf_file_name, 'r')
IOError: [Errno 2] No such file or directory: '-r'



I tried to modify “l_bp.py” script did not solve the problem


Is it possible that the format of the command I entered was incorrect, which caused me to be unable to read the file correctly？",SolarQuiltc,https://github.com/brentp/smoove/issues/221
I_kwDOBxm8lM5rn7P2,smoove call fails immediately with Panic: unexpected EOF,OPEN,2023-07-14T21:51:21Z,2023-07-17T15:51:54Z,,"I am trying to get smoove to run on some guppy sequences. However, it always fails immediately, and it is not clear where to even begin debugging.

I run: 

```
smoove call \
        --outdir lumpy/results_smoove \
        --name test \
        --excludechroms NC_024342.1,~NW \
        --fasta reference/GCF_000633615.1/GCF_000633615.1_Guppy_female_1.0_MT_genomic.fna \
        -p 1 \
        --genotype \
        bam_dedup_test/test.bam
```

It always fails with this error:

```
[smoove] 2023/07/14 14:42:44 starting with version 0.2.8
[smoove] 2023/07/14 14:42:44 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2023/07/14 14:42:44 set: Variable name must begin with a letter.
panic: unexpected EOF

goroutine 16 [running]:
github.com/brentp/goleft/covstats.pcheck(...)
	/home/brentp/go/go/pkg/mod/github.com/brentp/goleft@v0.2.5/covstats/covstats.go:30
github.com/brentp/goleft/covstats.BamStats(0xc000176c00, 0x1312d0, 0x186a0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)
	/home/brentp/go/go/pkg/mod/github.com/brentp/goleft@v0.2.5/covstats/covstats.go:143 +0xcdd
github.com/brentp/smoove/lumpy.bam_stats.func1(0x1)
	/home/brentp/src/smoove/lumpy/lumpy.go:218 +0x209
created by github.com/brentp/smoove/lumpy.bam_stats
	/home/brentp/src/smoove/lumpy/lumpy.go:232 +0x19d
```

Frustratingly, whenever it errors it also overwrites my .bam file with a 0 byte file. Perhaps that is what is generating the EOF error, but not sure why it is overwriting the .bam file.

Running e.g. `samtools quickcheck bam_dedup_test/test.bam` indicates no issues. Any idea what could be going on?

Thanks so much!",Ax3man,https://github.com/brentp/smoove/issues/222
I_kwDOBxm8lM5sLFvl,pre-processing for split & discordant read-pairs?,CLOSED,2023-07-20T21:53:59Z,2023-07-21T08:07:05Z,2023-07-21T08:07:05Z,"Hi, I was wondering if I would still need to do the pre-processing require by lumpy? Or if that is part of the workflow of smoove to extract the split and discordant read-pairs? Thanks!",heidihyang,https://github.com/brentp/smoove/issues/223
I_kwDOBxm8lM5sy4Gd,using multiple bams from same sample - does not finish running & trims the sequencing run number from the sample name,CLOSED,2023-07-27T21:54:12Z,2023-08-21T20:40:40Z,2023-08-21T20:40:40Z,"Hi,

I am running an array job on my cluster to run my samples in parallel. I have multiple sequencing runs of the same sample, but only some of the samples with multiple bams will go to completion while others do not. I get a few different kinds of errors:

```
[E::bgzf_read_block] Invalid BGZF header at offset 39243705
[E::bgzf_read] Read block operation failed with error 2 after 0 of 4 bytes
samtools index: failed to create index for ""/u/scratch/h/hyangg/smoove_output/Qlob.PEN.5.00F.disc.bam""
panic: exit status 1

[smoove]:2023/07/24 15:19:40 finished process: lumpy-filter (set -eu; lumpy_filter -f /u/home/h/hyangg/project-vlsork/ref/Qlob.ref.v3.2.fasta Qlob.CTW.6.00F.w1.m) in user-time:58.249006s system-time:4.801623s
[W::bam_hdr_read] EOF marker is absent. The input is probably truncated
[E::bgzf_uncompress] Inflate operation failed: 1
[E::bgzf_read] Read block operation failed with error 1 after 0 of 4 bytes
samtools index: failed to create index for ""/u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.disc.bam""
panic: exit status 1

[smoove]:([E]lumpy-filter) 2023/07/24 15:19:41 [lumpy_filter] extracted splits and discordants from 60296764 total aligned reads
[smoove]:([E]lumpy-filter) 2023/07/24 15:19:41 mv: cannot stat '/u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.split.bam.tmp.bam': No such file or directory
[smoove]:2023/07/24 15:19:41 finished process: lumpy-filter (set -eu; lumpy_filter -f /u/home/h/hyangg/project-vlsork/ref/Qlob.ref.v3.2.fasta Qlob.CTW.6.00F.w6.m) in user-time:57.198962s system-time:4.708654s
[smoove]:2023/07/24 15:19:41 error running command: set -eu; lumpy_filter -f /u/home/h/hyangg/project-vlsork/ref/Qlob.ref.v3.2.fasta Qlob.CTW.6.00F.w6.markdup.bam /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.split.bam.tmp.bam /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.disc.bam.tmp.bam 2 && mv /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.split.bam.tmp.bam /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.split.bam && mv /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.disc.bam.tmp.bam /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.disc.bam && cp /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.split.bam /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.split.bam.orig.bam && cp /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.disc.bam /u/scratch/h/hyangg/smoove_output/Qlob.CTW.6.00F.disc.bam.orig.bam -> exit status 1
panic: exit status 1
```

These errors are recurrent for the samples that didn't run successfully in the array job. However, when I run them in isolation these samples do not throw these errors and will produce the final vcf. I was wondering if you have thoughts on what the underlying issue might be, and how I should treat multiple bams from the same sample. They have different IDs (such as Qlob.CTW.6.00F.w1 and Qlob.CTW.6.00F.w4) but have the same SM (Qlob.CTW.6.00F) in the bams – I don't know if this is an issue. Thanks!

Heidi",heidihyang,https://github.com/brentp/smoove/issues/224
I_kwDOBxm8lM5uCRjp,"When I use smoove annotate, I just receive a MSHQ/SHQ of -1",OPEN,2023-08-11T01:49:18Z,2023-08-15T09:29:47Z,,"using smoove 0.2.7

GFF=""Homo_sapiens.GRCh38.105.gff3.gz"" # http://ftp.ensembl.org/pub/release-105/gff3/homo_sapiens/Homo_sapiens.GRCh38.105.gff3.gz

smoove annotate --gff ${GFF} ${outdir}/${SAMPLE}.vcf.gz | bgzip -c > ${outdir}/${SAMPLE}.annotated.vcf.gz""

Do you know why I just receive for MSHQ/SHQ -1? I am just using a single sample. Therefore, I asuume MSHQ and SHQ should be the same.  

I will try the docker version next, but I am not sure if that will fix my issue. 

Currently, I am using the RP+SR values in the VCF, but filtering on the calculated sum does not make sense. 
![image](https://github.com/brentp/smoove/assets/73748542/533fde33-d195-4cf0-b5e6-09fec5cc819e)

My goal is to filter for high quality deletions. 

Help is much appreciated. 
",robertzeibich,https://github.com/brentp/smoove/issues/225
I_kwDOBxm8lM5ukdsO,`--name` parameter does not work,CLOSED,2023-08-17T13:52:05Z,2023-08-18T01:36:24Z,2023-08-18T01:36:24Z,"Here are my variables:

```
threads=32
mount_dir=""/data/omeran""
out_dir=""sv_calling""

normal_bam=""LC_AC_normal.bam""
tumor_bam=""LC_AC_tumor.bam""
```


Here is my command line:

```
smoove call -x \
	--name LC_AC \
	--exclude $mount_dir/$out_dir/ref/exclude.cnvnator_100bp.GRCh38.20170403.bed \
	--fasta $mount_dir/genome.fa \
	--outdir $mount_dir/$out_dir/smoove \
	--genotype \
	--duphold \
	$mount_dir/$out_dir/biscuit/$normal_bam \
	$mount_dir/$out_dir/biscuit/$tumor_bam
```

Here is the output:

```
$ ls -a smoove/
-rw-r--r-- 1 omeran omeran  32M Aug 17 21:42 .disc.bam.tmp.bam
-rw-r--r-- 1 omeran omeran 6.0K Aug 17 21:40 .histo
-rw-r--r-- 1 omeran omeran  22M Aug 17 21:42 .split.bam.tmp.bam
```",bounlu,https://github.com/brentp/smoove/issues/227
I_kwDOBxm8lM5vRbfG,Why REF = N?,OPEN,2023-08-25T11:04:23Z,2024-06-02T07:14:50Z,,"Do you know why for the REF N is displayed? Is there also a way to obtain the ALT sequence? 

#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  GALF003
chr1    789502  440     N       <DUP>   87.49   .       SVTYPE=DUP;SVLEN=223225049;END=224014551;STRANDS=-+:9;IMPRECISE;CIPOS=-407,29;CIEND=-30,342;CIPOS95=-100,7;CIEND95=-9,72;SU=9;PE=9;SR=0;PRPOS=3.61176e-16,4.1447e-16,4.74956e-16,5.44
769e-16,6.24786e-16,7.14135e-16,8.18997e-16,9.37485e-16,1.07223e-15,1.23006e-15,1.40581e-15,1.60444e-15,1.83034e-15,2.0893e-15,2.38585e-15,2.73204e-15,3.11754e-15,3.55584e-15,4.07309e-15,4.66368e-15,5.30318e-15,6.04938e-15,6.89666e-15,7.
84477e-15,8.9712e-15,1.02639e-14,1.16718e-14,1.33188e-14,1.51842e-14,1.73273e-14,1.97681e-14,2.24816e-14,2.56338e-14,2.92283e-14,3.31236e-14,3.76362e-14,4.27849e-14,4.87925e-14,5.54265e-14,6.29927e-14,7.17939e-14,8.16114e-14,9.29521e-14,
1.05538e-13,1.19858e-13,1.3633e-13,1.54996e-13,1.7624e-13,2.00383e-13,2.27962e-13,2.58967e-13,2.94094e-13,3.34295e-13,3.79576e-13,4.30449e-13,4.88936e-13,5.54634e-13,6.28493e-13,7.12433e-13,8.06341e-13,9.14775e-13,1.03816e-12,1.17942e-12
,1.33588e-12,1.51284e-12,1.71588e-12,1.94014e-12,2.19536e-12,2.48849e-12,2.8176e-12,3.19156e-12,3.61295e-12,4.09749e-12,4.63506e-12,5.23569e-12,5.90984e-12,6.66949e-12,7.53358e-12,8.50361e-12,9.58996e-12,1.08349e-11,1.22514e-11,1.38513e-
11,1.56106e-11,1.75759e-11,1.98029e-11,2.23272e-11,2.51982e-11,2.84035e-11,3.20029e-11,3.6102e-11,4.07211e-11,4.57662e-11,5.16214e-11,5.8198e-11,6.55702e-11,7.38379e-11,8.30524e-11,9.35058e-11,1.05157e-10,1.18174e-10,1.32631e-10,1.49218e
-10,1.67506e-10,1.88088e-10,2.10759e-10,2.36248e-10,2.64904e-10,2.9696e-10,3.33462e-10,3.74279e-10,4.20026e-10,4.72008e-10,5.29035e-10,5.91764e-10,6.62178e-10,7.40784e-10,8.30626e-10,9.29138e-10,1.03966e-09,1.164e-09,1.30251e-09,1.45577e
-09,1.62608e-09,1.81718e-09,2.02931e-09,2.26863e-09,2.53223e-09,2.82628e-09,3.15087e-09,3.5125e-09,3.91974e-09,4.36553e-09,4.87152e-09,5.43103e-09,6.04468e-09,6.72957e-09,7.4896e-09,8.32004e-09,9.25559e-09,1.02913e-08,1.14478e-08,1.27413
e-08,1.41467e-08,1.57108e-08,1.74288e-08,1.93361e-08,2.14579e-08,2.37482e-08,2.63339e-08,2.91842e-08,3.23291e-08,3.58087e-08,3.96582e-08,4.39173e-08,4.86081e-08,5.38182e-08,5.94971e-08,6.57946e-08,7.26647e-08,8.0325e-08,8.87347e-08,9.795
97e-08,1.07967e-07,1.19279e-07,1.31607e-07,1.45188e-07,1.60131e-07,1.76448e-07,1.94381e-07,2.13763e-07,2.35198e-07,2.58562e-07,2.8413e-07,3.12611e-07,3.43549e-07,3.7768e-07,4.14696e-07,4.54849e-07,4.9918e-07,5.47651e-07,6.01038e-07,6.584
74e-07,7.21179e-07,7.89896e-07,8.65879e-07,9.48594e-07,1.03712e-06,1.13256e-06,1.23853e-06,1.35299e-06,1.47761e-06,1.61226e-06,1.75903e-06,1.91839e-06,2.09334e-06,2.28295e-06,2.48822e-06,2.71128e-06,2.95126e-06,3.20845e-06,3.48639e-06,3.
7888e-06,4.1147e-06,4.47091e-06,4.85626e-06,5.2748e-06,5.72447e-06,6.21155e-06,6.73021e-06,7.29079e-06,7.89311e-06,8.54353e-06,9.24185e-06,9.9887e-06,1.07971e-05,1.1675e-05,1.26072e-05,1.36167e-05,1.46903e-05,1.58406e-05,1.70856e-05,1.83
927e-05,1.98104e-05,2.131e-05,2.29243e-05,2.4674e-05,2.65282e-05,2.84976e-05,3.06317e-05,3.28748e-05,3.52793e-05,3.78224e-05,4.05117e-05,4.33912e-05,4.64374e-05,4.9707e-05,5.31926e-05,5.69078e-05,6.08353e-05,6.49653e-05,6.93284e-05,7.401
19e-05,7.89789e-05,8.42232e-05,8.97375e-05,9.55925e-05,0.000101789,0.000108471,0.00011543,0.000122766,0.000130536,0.000138579,0.000147094,0.000156098,0.000165527,0.000175615,0.000186187,0.000197188,0.000208763,0.000221019,0.000233878,0.0
00247356,0.000261312,0.000276207,0.000291507,0.000307761,0.000324712,0.000342364,0.00036121,0.000380501,0.000400555,0.000421519,0.000443804,0.000466721,0.00049053,0.000515402,0.00054154,0.000569068,0.00059741,0.000626901,0.000657476,0.00
0689234,0.000722091,0.000756564,0.000792274,0.000829153,0.000867633,0.000907816,0.000949561,0.000992297,0.00103698,0.00108272,0.00113011,0.00117965,0.0012298,0.00128233,0.00133644,0.00139219,0.00144985,0.00150914,0.00157076,0.0016341,0.0
0169893,0.00176572,0.00183505,0.00190604,0.00197849,0.00205368,0.00213198,0.00221258,0.00229426,0.00237776,0.00246492,0.00255305,0.0026435,0.00273666,0.00283237,0.00292979,0.00303047,0.00313313,0.00323913,0.00334737,0.00345735,0.00356825
,0.00368173,0.00379801,0.00391568,0.00403717,0.00416067,0.00428632,0.00441581,0.00454542,0.00467785,0.00481304,0.00495118,0.00509041,0.00523101,0.00537412,0.00551889,0.00566833,0.0058193,0.00597374,0.00612914,0.00628634,0.00644548,0.0066
0766,0.00677086,0.00693499,0.00710248,0.00727294,0.00744573,0.00761905,0.00779529,0.00797086,0.00814758,0.00832652,0.00850617,0.00868607,0.00886919,0.00905285,0.00923939,0.00942782,0.00961457,0.00980094,0.00998996,0.0101773,0.0103638,0.0
105532,0.010742,0.0109339,0.0111259,0.0113175,0.0115107,0.011704,0.0118972,0.0120908,0.012281,0.0124716,0.0126608,0.0128505,0.0130428,0.0132351,0.0134266,0.0136173,0.0138048,0.0139936,0.0141807,0.0143651,0.0145482,0.0147292,0.0149081,0.0
150864,0.0152648,0.0154444,0.0156191,0.0157927,0.0159669,0.0161369,0.0163032,0.0164712,0.0166379,0.0168019,0.0169616,0.0171198,0.0172794,0.017435,0.0175878,0.0130494,0.00968088,0.00717864,0.00532287,0.00394662,0.00292602,0.00216877,0.001
60704,0.00119074,0.000882033,0.000653317,0.000483776,0.000263488,0.000143486,7.81259e-05,4.253e-05,2.31517e-05,1.26021e-05,6.85862e-06,3.73198e-06,1.49351e-06,5.97619e-07,2.39116e-07,9.56484e-08,3.82587e-08,1.53021e-08,6.11971e-09,2.4471
1e-09,9.78429e-10;PREND=5.36587e-06,7.16389e-06,9.56719e-06,1.27735e-05,1.70482e-05,2.27495e-05,3.03568e-05,4.05006e-05,5.40226e-05,7.20381e-05,9.60398e-05,0.000127996,0.000170534,0.00022709,0.000302425,0.000402782,0.000536295,0.00071409
2,0.000950311,0.00126395,0.00168103,0.00223589,0.0029718,0.00394893,0.00524633,0.00697082,0.00925984,0.0122998,0.0163354,0.0216814,0.0287724,0.0280738,0.0273884,0.0267124,0.0260538,0.0254035,0.0247661,0.0241375,0.023506,0.0228962,0.02228
63,0.0216852,0.0211025,0.0205224,0.0199607,0.0193993,0.0188583,0.0183219,0.0178008,0.0172918,0.0167917,0.016295,0.0158082,0.0153288,0.0148614,0.0144068,0.0139595,0.0135223,0.0130952,0.0126749,0.0122662,0.0118745,0.0114884,0.0111055,0.010
7322,0.0103688,0.0100186,0.00967532,0.00933965,0.00901685,0.00870031,0.00839453,0.00808941,0.00779345,0.00750763,0.00722911,0.00695828,0.00669712,0.00644401,0.00619804,0.00596105,0.00572738,0.00550191,0.00528584,0.00507362,0.00486757,0.0
0466619,0.00447514,0.00429028,0.00411176,0.00394034,0.00377302,0.00361025,0.00345255,0.00330167,0.00315745,0.00301719,0.0028836,0.00275518,0.00263005,0.00251024,0.00239538,0.00228382,0.00217625,0.00207349,0.00197451,0.00187968,0.00178902
,0.00170363,0.0016208,0.00154157,0.00146569,0.00139248,0.00132268,0.00125586,0.00119099,0.00112929,0.00107041,0.0010145,0.000961953,0.00091078,0.00086238,0.000816503,0.000772849,0.000730519,0.000690024,0.000651269,0.000614694,0.000580047
,0.00054759,0.000516865,0.000488057,0.000460495,0.000433758,0.000408518,0.000384555,0.000361563,0.00033981,0.000319494,0.000300212,0.000282052,0.00026502,0.000249008,0.000233739,0.000219376,0.000205801,0.000192805,0.000180559,0.000168989
,0.000158252,0.000148098,0.000138509,0.000129569,0.000121205,0.000113309,0.000105894,9.88867e-05,9.23368e-05,8.61122e-05,8.03595e-05,7.48394e-05,6.96976e-05,6.49231e-05,6.04876e-05,5.63523e-05,5.23928e-05,4.87459e-05,4.53227e-05,4.20825e
-05,3.90993e-05,3.62931e-05,3.36723e-05,3.12406e-05,2.89835e-05,2.68425e-05,2.48946e-05,2.30242e-05,2.13049e-05,1.97283e-05,1.82477e-05,1.68647e-05,1.55782e-05,1.4383e-05,1.32867e-05,1.22801e-05,1.13333e-05,1.04685e-05,9.65008e-06,8.9038
2e-06,8.19636e-06,7.53966e-06,6.94665e-06,6.3897e-06,5.8837e-06,5.41065e-06,4.9758e-06,4.5755e-06,4.20499e-06,3.86016e-06,3.53972e-06,3.24836e-06,2.9813e-06,2.73458e-06,2.50892e-06,2.30096e-06,2.10778e-06,1.93024e-06,1.76705e-06,1.61557e
-06,1.47617e-06,1.3493e-06,1.23175e-06,1.12545e-06,1.02652e-06,9.37995e-07,8.56817e-07,7.8232e-07,7.13498e-07,6.50859e-07,5.92359e-07,5.39216e-07,4.90548e-07,4.46371e-07,4.05935e-07,3.69546e-07,3.36242e-07,3.05832e-07,2.78107e-07,2.52464
e-07,2.2938e-07,2.0803e-07,1.88952e-07,1.71149e-07,1.55276e-07,1.40687e-07,1.27456e-07,1.15693e-07,1.04851e-07,9.48102e-08,8.57512e-08,7.74587e-08,7.00348e-08,6.31858e-08,5.71125e-08,5.16287e-08,4.66095e-08,4.20858e-08,3.80766e-08,3.4393
1e-08,3.1019e-08,2.80018e-08,2.52491e-08,2.27594e-08,2.05057e-08,1.84337e-08,1.65903e-08,1.49392e-08,1.34583e-08,1.21413e-08,1.09349e-08,9.84008e-09,8.83815e-09,7.93515e-09,7.13822e-09,6.40898e-09,5.76769e-09,5.18088e-09,4.65729e-09,4.18
502e-09,3.74832e-09,3.36255e-09,3.00933e-09,2.69453e-09,2.41625e-09,2.16576e-09,1.93976e-09,1.73603e-09,1.55305e-09,1.39006e-09,1.24587e-09,1.11254e-09,9.95514e-10,8.89999e-10,7.93964e-10,7.08922e-10,6.33194e-10,5.65692e-10,5.04947e-10,4
.49874e-10,4.01197e-10,3.57682e-10,3.1938e-10,2.85048e-10,2.54196e-10,2.26946e-10,2.02038e-10,1.79384e-10,1.59841e-10,1.42608e-10,1.26802e-10,1.12775e-10,1.00272e-10,8.92358e-11,7.93657e-11,7.04809e-11,6.27029e-11,5.56967e-11,4.93595e-11
,4.39144e-11,3.90816e-11,3.48062e-11,3.0878e-11,2.7369e-11,2.43019e-11,2.14653e-11,1.90549e-11,1.69098e-11,1.49124e-11,1.32037e-11,1.1713e-11,1.03702e-11,9.1627e-12,8.09731e-12,7.137e-12,6.31599e-12,5.58015e-12,4.91209e-12,4.33341e-12,3.
81779e-12,3.36531e-12,2.96827e-12,2.62004e-12,2.30837e-12,2.02598e-12,1.78541e-12,1.57553e-12,1.39274e-12,1.22958e-12,1.08252e-12,9.54385e-13,8.37725e-13,7.35656e-13,6.46523e-13,5.68482e-13,4.98281e-13,4.38134e-13,3.84385e-13,3.35822e-13
,2.93054e-13,2.57514e-13,2.25816e-13,1.97535e-13,1.72186e-13,1.51964e-13,1.33552e-13,1.16865e-13,1.02073e-13,8.85409e-14,7.71834e-14,6.73974e-14,5.86775e-14,5.12343e-14,4.46918e-14,3.90221e-14,3.40168e-14,2.95843e-14,2.57152e-14,2.22386e
-14,1.94111e-14,1.68357e-14,1.47332e-14,1.28086e-14,1.11338e-14;AC=1;AN=2       GT:GQ:SQ:GL:DP:RO:AO:QR:QA:RS:AS:ASC:RP:AP:AB   0/1:6:87.49:-9,-1,-1:43:33:9:33:9:0:0:0:33:9:0.21
",robertzeibich,https://github.com/brentp/smoove/issues/228
I_kwDOBxm8lM5wUS4E,Multiple issues,OPEN,2023-09-06T16:31:08Z,2023-09-06T16:31:08Z,,"Hey Brent this is Carson,

Just opening an issue to help track these.

Multiple issues:
1. Duplicate features (i.e. same variant but two lines)
2. PREND in header but missing from feature line
3. Alternately PREND in feature line but missing from header
4. END is less than start position in feature line

Right now I have a script that just removes the line when any of these happen. I can show you the specific projects where these happen, just let me know when you are ready to look at these",carsonhh,https://github.com/brentp/smoove/issues/229
I_kwDOBxm8lM5wWVkE,smoove genotype - could not import: bam_hdr_destroy,OPEN,2023-09-07T00:03:00Z,2024-08-08T23:48:26Z,,"Hi, 

I get this error for a lot of the samples I'm running, although I do seem to have a complete genotyped file for each bam I have. 

```
[smoove] 2023/09/06 14:45:21 [W::vcf_parse_info] INFO/END=60935357 is smaller than POS at CM012294.1:60935394
[smoove] 2023/09/06 14:45:48 2023/09/06 14:45:48 time to merge 2 files: 31.395
[smoove] 2023/09/06 14:45:49 [W::tbx_parse1] VCF INFO/END=60935357 is smaller than POS at CM012294.1:60935393
This tag will be ignored. Note: only one invalid END tag will be reported.
[smoove] 2023/09/06 14:45:49 [smoove] 2023/09/06 14:45:49 starting with version 0.2.8
[smoove] 2023/09/06 14:45:49 [smoove] 2023/09/06 14:45:49 running duphold on 1 files in 36 processes
[smoove] 2023/09/06 14:45:49 [smoove] 2023/09/06 14:45:49 **could not import: bam_hdr_destroy**
[smoove] 2023/09/06 14:45:49 2023/09/06 14:45:49 exit status 1
2023/09/06 14:45:49 exit status 1
```

I ran this command:
```
smoove genotype -d -x -p 1 --name ${sample}-joint --outdir \
$SCRATCH/smoove_output_test/results_genotyped/ --fasta $HOME/ref/Qlob.ref.v3.2.fasta \
--vcf merged.test.sites.vcf.gz $SCRATCH/merged_bams/${sample}
```

I was wondering what the bam_hdr_destroy file is and why it's not importing? Or if the issue is related to the former part of the joblog about the end position being smaller. Thanks!

Heidi",heidihyang,https://github.com/brentp/smoove/issues/230
I_kwDOBxm8lM5zA3pW,smoove paste error,OPEN,2023-10-06T07:36:55Z,2023-10-06T10:02:42Z,,"I'd like to know if anyone has encountered such a problem when using the smoove paste command? （after population calling，about 4000 samples）I allocate the same resources, but it seems to be successful sometimes and error sometimes. I don't know what the problem is, the smoove or my server. Looking forward to your reply, thank you!
example 1 #error
[smoove] 2023/10/06 01:07:29 starting with version 0.2.8
[smoove] 2023/10/06 01:07:29 squaring 3647 files to DUP.smoove.square.vcf.gz
[smoove] 2023/10/06 01:13:31 all files had 23207 variants
2023/10/06 04:22:15 signal: killed
example 2 #worked successfully
[smoove] 2023/10/06 04:22:16 starting with version 0.2.8
[smoove] 2023/10/06 04:22:16 squaring 3154 files to DUP.smoove.square.vcf.gz
[smoove] 2023/10/06 04:27:22 all files had 23207 variants
[smoove] 2023/10/06 07:00:49 wrote squared file to DUP.smoove.square.vcf.gz
example 3 #another error #actually the index file has no error and No such errors were reported in other previous runs.
[smoove] 2023/10/06 01:07:09 starting with version 0.2.8
[smoove] 2023/10/06 01:07:09 squaring 3647 files to INV.smoove.square.vcf.gz
[smoove] 2023/10/06 01:10:39 Failed to open /INVs/XH4042/XH4042-smoove.genotyped.vcf.gz: could not load index
2023/10/06 01:10:42 exit status 255
[smoove] 2023/10/06 01:10:42 starting with version 0.2.8
[smoove] 2023/10/06 01:10:42 squaring 3154 files to INV.smoove.square.vcf.gz
[smoove] 2023/10/06 01:14:21 Failed to open /INVs/CN5780/CN5780-smoove.genotyped.vcf.gz: could not load index
2023/10/06 01:14:24 exit status 255",ygwang1,https://github.com/brentp/smoove/issues/231
I_kwDOBxm8lM5zd2a3,A bug when installing smoove with conda,CLOSED,2023-10-11T08:44:03Z,2023-10-11T14:36:25Z,2023-10-11T12:13:19Z,"Hi Brent, I installed smoove by mamba and performed population calling of more than 200 plant samples.  However, I met the warning messages like: ""bash: line 1: 37699 Segmentation fault (core dumped)"" which appears to happen in the old versions of lumpy due to the existence of scaffolds in the reference genome. I directly ran lumpy and found the version is 0.2.13. Then I tried to update lumpy using ""mamba install -c bioconda lumpy-sv=0.3.1"" and ""conda install -c bioconda lumpy-sv=0.3.1"". At the pre-installation stage, the lumpy version in the package list is 0.3.1 but after the installation, the version came back to 0.2.13. I wonder if it is a bug of conda and do you have suggestions to fix this? Looking forward to your reply. Thank you so much!!!
![图片](https://github.com/brentp/smoove/assets/75994304/cf492dab-1591-4ea7-b34a-405460fdd218)
![图片](https://github.com/brentp/smoove/assets/75994304/96d95f3d-7b23-4c7a-bef3-223a947c8fa4)
",Ceonham,https://github.com/brentp/smoove/issues/232
I_kwDOBxm8lM52W7Xd,"Failed to open -: unknown file type, panic",OPEN,2023-11-09T14:16:48Z,2023-11-17T14:14:03Z,,"Hi @brentp,

I am getting a strange error when I try to run smoove call:

[smoove] 2023/11/03 15:37:14 starting with version 0.1.9
[smoove] 2023/11/03 15:37:14 calculating bam stats for 1 bams
[smoove] 2023/11/03 15:37:16 done calculating bam stats
[smoove]: 2023/11/03 15:48:09 finished process: lumpy-filter (lumpy_filter -f Oed.genome.c) in user-time:1m31.88s system-time:12.34s
[smoove] 2023/11/03 15:48:10 removed 0 alignments out of 0 (NaN%) with depth > 800 or from excluded chroms from BZH_04.disc.bam in 0 seconds
[smoove] 2023/11/03 15:48:10 removed 0 alignments out of 0 (NaN%) that were bad interchromosomals or flanked-splitters from BZH_04.disc.bam
[smoove] 2023/11/03 15:48:10 removed 0 singletons out of 0 reads (NaN%) from BZH_04.disc.bam in 0 seconds
[smoove] 2023/11/03 15:48:10 removed 0 alignments out of 0 (NaN%) with depth > 800 or from excluded chroms from BZH_04.split.bam in 0 seconds
[smoove] 2023/11/03 15:48:10 removed 0 alignments out of 0 (NaN%) that were bad interchromosomals or flanked-splitters from BZH_04.split.bam
[smoove] 2023/11/03 15:48:10 removed 0 singletons out of 0 reads (NaN%) from BZH_04.split.bam in 0 seconds
[smoove] 2023/11/03 15:48:10 starting lumpy
[smoove] 2023/11/03 15:48:10 wrote lumpy command to /home1/svcalling/lumpy/results-smoove/BZH_04-lumpy-cmd.sh
[smoove] 2023/11/03 15:48:10 writing sorted, indexed file to /home1/svcalling/lumpy/results-smoove/BZH_04-smoove.genotyped.vcf.gz
[smoove] 2023/11/03 15:48:10 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2023/11/03 15:48:10 > gsort version 0.0.6
[smoove] 2023/11/03 15:48:11 Calculating library metrics from /BZH_04_SS.bam...
[smoove] 2023/11/03 15:48:15  done
[smoove] 2023/11/03 15:48:15 Writing library metrics to /dev/shm/pbs.7263022[3].datarmor0/tempclean-988305349/086946291svtype-lib...
[smoove] 2023/11/03 15:48:15  done
[smoove] 2023/11/03 15:48:15 2023/11/03 15:48:15 EOF
[smoove] 2023/11/03 15:48:15 Failed to open -: unknown file type
[smoove] 2023/11/03 15:48:15 wrote sorted, indexed file to /home1/svcalling/lumpy/results-smoove/BZH_04-smoove.genotyped.vcf.gz
panic: exit status 255

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(0x9f3060, 0xc420282920)
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:32 +0x4a
github.com/brentp/smoove/svtyper.Svtyper(0x9f2b80, 0xc42000c110, 0x7fffffffe017, 0x5c, 0xc4200b5280, 0x1, 0x1, 0x7fffffffdfbe, 0x42, 0x7fffffffe008, ...)
        /home/brentp/go/src/github.com/brentp/smoove/svtyper/svtyper.go:215 +0xbee
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/go/src/github.com/brentp/smoove/lumpy/lumpy.go:287 +0x3fb
main.main()
        /home/brentp/go/src/github.com/brentp/smoove/cmd/smoove/smoove.go:115 +0x1dd

This error pops up for every individual file that I have. I have been scouring the Issues tab but I haven't found anything that matches this problem.

Do you have any suggestions? Thank you so much in advance!",lilymaya,https://github.com/brentp/smoove/issues/233
I_kwDOBxm8lM53sQ2J,lumpy_filter not on $PATH,OPEN,2023-11-23T12:02:19Z,2023-12-08T01:29:21Z,,"I tried installing smoove through conda. All programs are within the $PATH except for lumpy_filter.
![image](https://github.com/brentp/smoove/assets/100692647/6944ae8a-1882-4467-a48d-9de3deba961e)

I saw in one of the issues that if this happens it means that lumpy isnt installed properly. But I dont understand how is it possible, as we are not doing it manually, and also every other required programs are there.
How shall I proceed with this?
",Sreelekshmi-291,https://github.com/brentp/smoove/issues/234
I_kwDOBxm8lM54z5bu,only histo file outputs from smoove call ,OPEN,2023-12-05T18:30:15Z,2023-12-08T01:24:45Z,,"Hello developers,
I have started running smoove 
This is my running command:

`smoove call --outdir ${OUT_DIR} --exclude ${BED} --name ${SAMPLE_ID} --fasta ${FASTA} -p 1 --genotype ${INPUT_DIR}/${SAMPLE_ID}.rmdup1.bam`

However the only output I get is just ${sample}.histo files as outputs.
I think I am running the right command but I do not get any vcf files.
Am I doing something wrong?

Thanks",Ana1335,https://github.com/brentp/smoove/issues/235
I_kwDOBxm8lM55gCro,issue with installation smoove via conda,CLOSED,2023-12-12T19:44:06Z,2023-12-20T17:16:13Z,2023-12-20T17:16:13Z,"Hi Brent,
I am reaching out regarding the smoove installation via conda.
It seems a very fantastic tool but I am having a very tough time installing it. It keeps complaining about lumpy-filter which seems to be related to samtools. I also tried to install samtools separately but it does not work.
Is there any updated conda version that can help with the successful installation?
I have seen some other people have had the same issue.
I really appreciate your help on this matter, so we can using this awesome tool. Thanks a lot",Ana1335,https://github.com/brentp/smoove/issues/236
I_kwDOBxm8lM58W8bF,library error in smoove,OPEN,2024-01-17T15:05:49Z,2024-01-18T09:26:25Z,,"![Screenshot from 2024-01-15 14-53-37](https://github.com/brentp/smoove/assets/45700858/d0bb3004-f898-44ae-9a27-88ea72fcc542)
Hello, I am facing this error while running smoove on conda environment could you please add some suggestions to solve this issue.
Thanks in advance.
",poddarharsh15,https://github.com/brentp/smoove/issues/237
I_kwDOBxm8lM59WhIy,svtyper: error: unrecognized arguments: --max_ci_dist 0 error,CLOSED,2024-01-26T23:29:04Z,2024-01-27T22:00:21Z,2024-01-27T22:00:21Z,"Hi,
I ran into a a couple of new issues when trying to run smoove.
I installed smoove through conda and ended up having `svtyper 0.1.4 `. However when I run the following command 
`smoove call -o ${OUT_DIR} --exclude ${BED} --name ${SAMPLE_ID} --fasta ${FASTA} -p 10 --genotype ${INPUT_DIR}/${SAMPLE_ID}.rmdup1.RG.bam `

I keep getting the error:

`svtyper: error: unrecognized arguments: --max_ci_dist 0`

This is all of the flags I have when I run svtyper:
```
$svtyper
usage: svtyper [-h] [-i FILE] [-o FILE] -B FILE [-T FILE] [-l FILE] [-m INT]
               [-n INT] [-q] [--max_reads INT] [--split_weight FLOAT]
               [--disc_weight FLOAT] [-w FILE]
svtyper: error: argument -B/--bam is required
```

So it seems there is no `--max_ci_dist` argument.

When I exclude the `svtyper` from the smoove call **without** `--genotype` flag I get the output vcfs. However the weird thing is that I get no insertion in the vcf files in my samples. 
Can you please help me to sort out this issue to be able to proceed with my analysis? no insertion in the vcf can be due to the fact that I exclude `--genotype` flag?
Then how can I fix the `svtype` error? I believe I installed the latest version from conda.


Thank you




",shaghayeghsoudi,https://github.com/brentp/smoove/issues/238
I_kwDOBxm8lM6CE4x5,"Outdated version of bcftools in dockerfile: ""Unsorted positions"", position 0 vs. 4294967296",OPEN,2024-03-12T17:49:21Z,2024-03-12T17:49:21Z,,"Version 1.11 of bcftools in the `brentp/smoove:bdf809472b6a` docker image doesn't support 0 coordinates in bcf properly.  It produces the `0` coordinate in the bcf correctly during `bcftools annotate`, but `bcftools view` then emits 4294967296 (ie. max uint32) when writing out the final vcf.  This then snags on `gsort`, which gives an ""Unsorted positions"" error. 

This bug of bcftools is documented here:

* https://github.com/samtools/bcftools/issues/1753
* https://github.com/samtools/htslib/issues/1475

And is resolved by https://github.com/samtools/htslib/pull/1476.",bartgrantham,https://github.com/brentp/smoove/issues/239
I_kwDOBxm8lM6I4kx5,does smoove take other sv caller genotypes into account?,OPEN,2024-05-14T22:40:53Z,2024-05-14T22:42:54Z,,"Hi, 
I am currently running smoove on manta outputs and wanted to know if smoove genotypes based on lumpy or does it only consider the existing genotyping generated by manta?
Thank you!",olivia-gc,https://github.com/brentp/smoove/issues/240
I_kwDOBxm8lM6MKeNN,how is option '--support' (mininum support required to report a variant) defined?,OPEN,2024-06-13T16:19:52Z,2024-06-13T16:19:52Z,,"how is option '--support' (mininum support required to report a variant) defined? are there differences between '--support' and option '-m' (minimum sample weight for a call), '-mw' (minimum weight across all samples for a call) and '-msw' (minimum per-sample weight for a call) in lumpy?

I think I need to change these parameters for samples with different sequencing depth.",yqlan,https://github.com/brentp/smoove/issues/241
I_kwDOBxm8lM6MT2ks,export SMOOVE_MAX_DEPTH=20000 doesn't work,CLOSED,2024-06-14T20:07:03Z,2024-06-15T04:17:02Z,2024-06-15T04:16:37Z,"command:
`export SMOOVE_MAX_DEPTH=5000`
`smoove call ...`

log file output:
[smoove] 2024/06/14 14:20:10 starting with version 0.2.8
[smoove] 2024/06/14 14:20:11 calculating bam stats for 8 bams
[smoove] 2024/06/14 14:20:43 done calculating bam stats
[smoove] 2024/06/14 14:20:43 couldn't set max depth to 5000",yqlan,https://github.com/brentp/smoove/issues/242
I_kwDOBxm8lM6NWtoR, smoove call for tumor/normal pairs,OPEN,2024-06-25T03:13:35Z,2024-06-25T03:31:42Z,,"Hi, I want to make sure that when  I use smoove call for tumor/normal pairs.
Is there a requirement for the order of two bam files?
Which command is correct ?
The command is as follows:
`smoove call -x --name sample --fasta genome.fa -p 4 --genotype --outdir ./  path/normal.bam path/tumor.bam `
`smoove call -x --name sample --fasta genome.fa -p 4 --genotype --outdir ./  path/tumor.bam path/normal.bam `

 Thanks in advance!",TLyan-ze,https://github.com/brentp/smoove/issues/243
I_kwDOBxm8lM6NmO9I,smoove paste error for DEL,OPEN,2024-06-26T15:04:56Z,2024-06-26T16:05:56Z,,"Hi Brent! I am experiencing the following command error using smoove paste (directly after processing through smoove genotype): 
```
Command error:
[smoove] 2024/06/26 01:33:55 starting with version 0.2.6
[smoove] 2024/06/26 01:33:55 squaring 9 files to DEL.smoove.square.vcf.gz
[smoove] 2024/06/26 01:34:54 all files had 127089 variants
[smoove] 2024/06/26 01:35:04 The REF prefixes differ: GTTACCTACCGCTGCGACCAGTTGATTACTGAGTGG vs GTTACCTACCGCTGCGACCAGTTGATTACTGAGTGG  (56,56)
[smoove] 2024/06/26 01:35:04 Failed to merge alleles at chr9:132825235 in DEL.sample1-smoove.genotyped.vcf.gz
  2024/06/26 01:35:05 exit status 255
```
Do you have any ideas on how to solve this error or where it comes from? Thank you! ",olivia-gc,https://github.com/brentp/smoove/issues/244
I_kwDOBxm8lM6PDejv,bam_hdr_destroy,CLOSED,2024-07-10T08:07:34Z,2024-07-10T18:37:48Z,2024-07-10T18:37:48Z,"When running smoove, duphold reports an error: could not import: bam_hdr_destroy",C-YONG,https://github.com/brentp/smoove/issues/245
I_kwDOBxm8lM6PdZmW,problem “Could not parse the header line”,OPEN,2024-07-13T11:06:12Z,2024-07-15T21:21:44Z,,"![image](https://github.com/user-attachments/assets/bca74c12-3bc9-4ad2-9fff-28342ccf6df9)
code：smoove genotype -d -x -p 20 --name 432-joint --outdir ./ --fasta ../../03_genome/genome1.3.fna --vcf merged.sites.vcf.gz ../.
./04_bam/432.sort.bam
When i run the above code, i get this report, does it affetc the results? Is it an error?  In fact, it can out put the results.",C-YONG,https://github.com/brentp/smoove/issues/246
I_kwDOBxm8lM6PtKd3,smoove genotype issue,CLOSED,2024-07-16T12:11:08Z,2024-07-16T17:37:17Z,2024-07-16T17:19:17Z,"smoove] 2024/07/16 13:07:58 starting with version 0.2.8
[smoove] 2024/07/16 13:07:58 writing sorted, indexed file to results-genotyped/sample-joint-smoove.genotyped.vcf.gz
[smoove] 2024/07/16 13:07:58 > gsort version 0.1.4
[smoove] 2024/07/16 13:08:01 Error: failed to build insert size histogram for paired-end reads.
Please ensure BAM file (BU189_B2.disc.bam) has inward facing, paired-end reads.
panic: exit status 1

",Shannan-Summers,https://github.com/brentp/smoove/issues/247
I_kwDOBxm8lM6RFg9Q,Smoove filters out almost all reads when using BAMs of a 1.5 Mb region of the genome ,OPEN,2024-07-28T22:31:03Z,2024-07-28T22:33:33Z,,"Hi,

My understanding is that the error below is caused by only having 22 reads after smoove filtering (starting with 1349 reads). I am trying to call SVs using BAMs which correspond to a 1.5 Mb region of the genome. Is it still possible to use smoove with these size BAMs? Is there a way to reduce the stringency of the filtering process?

Many thanks,

Alex

```
[smoove] 2024/07/28 23:07:20 starting with version 0.2.8
[smoove] 2024/07/28 23:07:20 calculating bam stats for 1 bams
[smoove]: ([E]lumpy-filter) 2024/07/28 23:07:21 [lumpy_filter] extracted splits and discordants from 394784 total aligned reads
[smoove]:2024/07/28 23:07:21 finished process: lumpy-filter (set -eu; lumpy_filter -f /projects/0/brugada/Realingment/brugada-realign/reference/hs37d5_all_chr.fa) in user-time:432.07
2ms system-time:134.567ms
[smoove] 2024/07/28 23:07:21 done calculating bam stats
[smoove] 2024/07/28 23:07:22 removed 859 alignments out of 1869 (45.96%) with low mapq, depth > 1000, or from excluded chroms from 20231124-SCN5A-THORAX-u1087-chr3_38000000_39500000-
hs37d5-D000Q53-FRENCHWGGAZEL.disc.bam in 2 seconds
[smoove] 2024/07/28 23:07:22 removed 169 alignments out of 1869 (9.04%) that were bad interchromosomals or flanked-splitters from 20231124-SCN5A-THORAX-u1087-chr3_38000000_39500000-h
s37d5-D000Q53-FRENCHWGGAZEL.disc.bam
[smoove] 2024/07/28 23:07:22 kept 2 putative orphans
[smoove] 2024/07/28 23:07:22 removed 4 discordant orphans in 0 seconds
[smoove] 2024/07/28 23:07:22 removed 653 singletons and isolated interchromosomals of 841 reads (77.65%) from 20231124-SCN5A-THORAX-u1087-chr3_38000000_39500000-hs37d5-D000Q53-FRENCH
WGGAZEL.disc.bam in 0 seconds
[smoove] 2024/07/28 23:07:22 188 reads (10.06%) of the original 1869 remain from 20231124-SCN5A-THORAX-u1087-chr3_38000000_39500000-hs37d5-D000Q53-FRENCHWGGAZEL.disc.bam
[smoove] 2024/07/28 23:07:24 removed 810 alignments out of 1349 (60.04%) with low mapq, depth > 1000, or from excluded chroms from 20231124-SCN5A-THORAX-u1087-chr3_38000000_39500000-
hs37d5-D000Q53-FRENCHWGGAZEL.split.bam in 2 seconds
[smoove] 2024/07/28 23:07:24 removed 320 alignments out of 1349 (23.72%) that were bad interchromosomals or flanked-splitters from 20231124-SCN5A-THORAX-u1087-chr3_38000000_39500000-
hs37d5-D000Q53-FRENCHWGGAZEL.split.bam
[smoove] 2024/07/28 23:07:24 kept 2 putative orphans
[smoove] 2024/07/28 23:07:24 removed 0 split orphans in 0 seconds
[smoove] 2024/07/28 23:07:24 removed 197 singletons of 219 reads (89.95%) from 20231124-SCN5A-THORAX-u1087-chr3_38000000_39500000-hs37d5-D000Q53-FRENCHWGGAZEL.split.bam in 0 seconds
[smoove] 2024/07/28 23:07:24 22 reads (1.63%) of the original 1349 remain from 20231124-SCN5A-THORAX-u1087-chr3_38000000_39500000-hs37d5-D000Q53-FRENCHWGGAZEL.split.bam
[smoove] 2024/07/28 23:07:24 starting lumpy
[smoove] 2024/07/28 23:07:24 wrote lumpy command to results-smoove//D000Q53-lumpy-cmd.sh
[smoove] 2024/07/28 23:07:24 writing sorted, indexed file to results-smoove/D000Q53-smoove.genotyped.vcf.gz
[smoove] 2024/07/28 23:07:24 excluding variants with all unknown or homozygous reference genotypes
[smoove] 2024/07/28 23:07:24 > gsort version 0.1.4
[smoove] 2024/07/28 23:07:24 chr3       1000000
chr3    2000000
chr3    4000000
chr3    8000000
chr3    16000000
chr3    32000000
chr3    64000000
[smoove] 2024/07/28 23:07:24 Calculating library metrics from /projects/0/brugada/NantesBrS/SCN5AregionNantesCRAMs/20231124.SCN5A.THORAX.u1087.chr3_38000000_39500000.hs37d5/20231124.
SCN5A.THORAX.u1087.chr3_38000000_39500000.hs37d5.D000Q53.FRENCHWGGAZEL.cram...
[smoove] 2024/07/28 23:07:27  done
[smoove] 2024/07/28 23:07:27 Writing library metrics to /scratch-local/lipova.7212697/tempclean-557976186/835475816svtype-lib...
[smoove] 2024/07/28 23:07:27  done
[smoove] 2024/07/28 23:07:27 panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation
[smoove] 2024/07/28 23:07:27  code=0x1 addr=0x8 pc=0x546d43]

goroutine
[smoove] 2024/07/28 23:07:27 1 [running
[smoove] 2024/07/28 23:07:27 ]:
[smoove] 2024/07/28 23:07:27 bufio.NewReaderSize(...)
        /home/brentp/go/src/bufio/bufio.go:49
bufio.NewReader(...)
        /home/brentp/go/src/bufio/bufio.go:62
[smoove] 2024/07/28 23:07:27 github.com/brentp/gsort.Sort(0x7ad380, 0x0,
[smoove] 2024/07/28 23:07:27 0x7ad3a0, 0xc0000af900
[smoove] 2024/07/28 23:07:27 , 0xc0000af8c0, 0xaf0
[smoove] 2024/07/28 23:07:27 , 0x0, 0x0
[smoove] 2024/07/28 23:07:27 , 0x0)
[smoove] 2024/07/28 23:07:27    /home/brentp/go/go/src/github.com/brentp/gsort/gsort.go:116
[smoove] 2024/07/28 23:07:27  +0x63
[smoove] 2024/07/28 23:07:27 main.main
[smoove] 2024/07/28 23:07:27 ()

[smoove] 2024/07/28 23:07:27 /home/brentp/go/go/src/github.com/brentp/gsort/cmd/gsort/gsort.go:373 +
[smoove] 2024/07/28 23:07:27 0x513
[smoove] 2024/07/28 23:07:27 Failed to read from standard input: unknown file type
panic: exit status 255

goroutine 1 [running]:
github.com/brentp/smoove/svtyper.check(...)
        /home/brentp/src/smoove/svtyper/svtyper.go:33
github.com/brentp/smoove/svtyper.Svtyper(0xc14cc0, 0xc0041ce0e0, 0x7ffe858c18b6, 0x4e, 0xc0001d25e0, 0x1, 0x1, 0x7ffe858c188f, 0xf, 0x7ffe858c18a6, ...)
        /home/brentp/src/smoove/svtyper/svtyper.go:226 +0x190a
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/src/smoove/lumpy/lumpy.go:363 +0x4ab
main.main()
        /home/brentp/src/smoove/cmd/smoove/smoove.go:121 +0x1c4""
```

",Alexei-Lipov,https://github.com/brentp/smoove/issues/248
I_kwDOBxm8lM6YInk7,Smoove docker cannot access files!,OPEN,2024-09-27T08:59:45Z,2024-10-01T15:30:49Z,,"I am runing the docker like this:
```
docker run --cpus=20 --memory=25g  --memory-swap=30g \
    -v ""/home/mferreira"":""/input"" \
    -v ""/home/mferreira"":""/output"" \
    brentp/smoove smoove call -x \
    --name /output/all.samples.lumpy --outdir /output/teste_smoove/ \
	--fasta /input/genomeinabotle/HG002_son/SNVs_new/references_genomeinabotle/GCA_000001405.15_GRCh38_no_alt_analysis_set.fasta \
	-p 20 --genotype /input/genomeinabotle/HG002_son/alignments_joined/post_processed/*.bam

```
But then I get:

```
[smoove] 2024/09/27 08:48:30 starting with version 0.2.8
panic: open /input/genomeinabotle/HG002_son/alignments_joined/post_processed/*.bam: no such file or directory

goroutine 1 [running]:
github.com/brentp/smoove/lumpy.check(...)
        /home/brentp/src/smoove/lumpy/lumpy.go:54
github.com/brentp/smoove/lumpy.lumpy_filter_cmd(0x7fff6d91be95, 0x46, 0x7fff6d91bdf1, 0x15, 0x7fff6d91be0f, 0x74, 0x0, 0x0, 0x0, 0x0, ...)
        /home/brentp/src/smoove/lumpy/lumpy.go:83 +0xfc5
github.com/brentp/smoove/lumpy.Lumpy(0x7fff6d91bdce, 0x19, 0x7fff6d91be0f, 0x74, 0x7fff6d91bdf1, 0x15, 0xc0001fe7d0, 0x1, 0x1, 0xc0000f79a0, ...)
        /home/brentp/src/smoove/lumpy/lumpy.go:133 +0x131
github.com/brentp/smoove/lumpy.Main()
        /home/brentp/src/smoove/lumpy/lumpy.go:351 +0x29b
main.main()
        /home/brentp/src/smoove/cmd/smoove/smoove.go:121 +0x1c4

```
Can someone help me understand why this happen? What am I doing wrong?

Thanks",Martaprf,https://github.com/brentp/smoove/issues/249
I_kwDOBxm8lM6ZdFRT,"smoove genotype error, panic: runtime error: invalid memory address or nil pointer dereference",OPEN,2024-10-09T01:45:23Z,2024-10-09T02:06:43Z,,"[smoove] 2024/10/09 09:14:26 starting with version 0.2.8
[smoove] 2024/10/09 09:14:26 writing sorted, indexed file to smoove.genotyped/CE2.joint-smoove.genotyped.vcf.gz
[smoove] 2024/10/09 09:14:26 > gsort version 0.1.4
[smoove] 2024/10/09 09:21:21 [smoove] 2024/10/09 09:21:21 starting with version 0.2.8
[smoove] 2024/10/09 09:21:21 [smoove] 2024/10/09 09:21:21 running duphold on 1 files in 160 processes
[smoove] 2024/10/09 09:21:21 panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=
[smoove] 2024/10/09 09:21:21 0x1 addr=0x0 pc=0x4de7fb]

goroutine 37 [running]:
[smoove] 2024/10/09 09:21:21 os.(*Process).signal(0x0, 0xc196f8, 0xef2300, 0x0, 0x0)
	/home/brentp/go/go/src/os/exec_unix.go:63 +0x3b
[smoove] 2024/10/09 09:21:21 os.(*Process).Signal(...)
	/home/brentp/go/go/src/os/exec.go:
[smoove] 2024/10/09 09:21:21 135
os.(*Process).kill(...)
	/home/brentp/go/go/src/os/exec_posix.go:66
os.(*Process).Kill(...)
	/home/brentp/go/go/src/os/exec.go:120
github.com/brentp/smoove/duphold.Main.func2(0xc0003d0000, 0xc00032e7f8, 0xc0003177b0, 0xc000310120, 0xc0003481f8, 0xc00032e810, 0xc000319fb0)
	/home/brentp/src/smoove/duphold/duphold.go:96 +0x595
created by github.com/brentp/smoove/duphold.Main
	/home/brentp/src/smoove/duphold/duphold.go:79 +0x4d2
2024/10/09 09:21:21 exit status 2
",kuangzhuoran,https://github.com/brentp/smoove/issues/250
