id,title,state,created_at,updated_at,closed_at,body,user,url
I_kwDOJSUnIc6UEAUe,volcanosv_asm,CLOSED,2024-08-24T00:37:55Z,2024-10-21T15:24:36Z,2024-10-21T15:24:36Z,"你好，我使用这个软件的时候，报错是找不到[E::hts_open_format] Failed to open file ""/public/home/maokaikai/data/10.OS/08.VolcanoSV/01.MDJ/volcanosv_asm_output/chr1//phasing_result/AHTL-1_phased.bam"" : No such file or directory
error: Error estimating alignment parameters.
caused by: Error reading indexed FASTA file.
caused by: Unknown sequence name.
请问该怎么解决呢？",pengyan19,https://github.com/maiziezhoulab/VolcanoSV/issues/2
I_kwDOJSUnIc6bNNlo,volcanosv-vc-large-indel.py fails,CLOSED,2024-10-22T00:17:04Z,2024-10-23T19:44:49Z,2024-10-23T19:44:49Z,"Hello, I would like to ask help in running volcanosv-vc-large-indel.py
I have run the script as follows. It started with assertion errors and failed eventually. [test_large-indel.sh.log](https://github.com/user-attachments/files/17468093/test_large-indel.sh.log)

Could you advise on troubleshooting the issue? Thank you.

```
$python3 ${volcanosv_vc_large_indel_py} \
	-bam $bam \
	-i $inputdir \
	-o $outputdir \
	-ref $reference \
	-t 4 \
	-chr 21 \
	-dtype Hifi \
	-px $sample
```

",byoo,https://github.com/maiziezhoulab/VolcanoSV/issues/3
I_kwDOJSUnIc6buP9p,volcanosv-vc-complex-sv.py fails,CLOSED,2024-10-24T21:30:19Z,2024-10-28T16:36:36Z,2024-10-28T16:36:36Z,"Hello,

I'd like to report that volcanosv-vc-complex-sv.py fails to run on hifi reads.
volcanosv-vc-complex-sv.py expects ""Hifi"" as the data type and pass the value to align_ins2ref.py. But align_ins2ref.py expects ""CCS"" and fails due to the undefined ""Hifi"". Could you fix the issue? Thanks!

https://github.com/maiziezhoulab/VolcanoSV/blob/648788c550e524b3ea1c82f919cd0ccfce3bd26e/bin/VolcanoSV-vc/Complex_SV/volcanosv-vc-complex-sv.py#L10

https://github.com/maiziezhoulab/VolcanoSV/blob/648788c550e524b3ea1c82f919cd0ccfce3bd26e/bin/VolcanoSV-vc/Complex_SV/align_ins2ref.py#L10",byoo,https://github.com/maiziezhoulab/VolcanoSV/issues/4
I_kwDOJSUnIc6b76Ys,volcanosv-vc-small-indel.py and volcanosv-vc-large-indel.py fail on hifi reads,CLOSED,2024-10-26T22:03:09Z,2024-11-22T17:35:19Z,2024-10-31T16:28:16Z,"
Hello,

We are continuing to test VolcanoSV on hifi reads and got the error below in running `volcanosv-vc-small-indel.py`.
Could you help resolve the issue?

```
****************************************

    check kmer support and remove false call

****************************************
100%|██████████| 594495/594495 [2:28:05<00:00, 66.91it/s]
/software/VolcanoSV/current/bin/VolcanoSV-vc/Small_INDEL/check_reads_kmer_support.py:272: RuntimeWarning: Mean of empty slice.
  zero_rate = ((np.array(cnt_list)<= min_support )).mean()
/software/python/current/lib/python3.12/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
```

In addition, I'd like to report that when the optional `--region` argument is not used for `volcanosv-vc-small-indel.py`, it is still passed into `htsbox pileup` as `-r None`. While this seems harmless, it might not be intentional and it gives the following warning:
` [fai_fetch] Warning - Reference None not found in FASTA file, returning empty sequence`

Thank you!",byoo,https://github.com/maiziezhoulab/VolcanoSV/issues/5
I_kwDOJSUnIc6cilnq,take so long time on chr1,CLOSED,2024-10-31T08:48:20Z,2024-11-05T20:21:03Z,2024-11-05T20:21:03Z,"Hi,

I used VolcanoSV to call variants, but it has been stuck on chr1 for more than four days. The program has not reported any errors, and appears that hifiasm is still running. Is this normal?
```
path_to_volcanosv='../VolcanoSV'
for i in {1..22}
do
echo ""***********************assembly for chr${i}*******************""
python3 ${path_to_volcanosv}/bin/VolcanoSV-asm/volcanosv-asm.py \
-bam hifi_tumor.bam \
-o volcanosv_asm_output_tumor \
-ref genome.fa \
-t 20 \
-chr ${i} \
-dtype Hifi \
-px tumor \
-asm hifiasm
done
```

Best regards.",DayTimeMouse,https://github.com/maiziezhoulab/VolcanoSV/issues/6
I_kwDOJSUnIc6c3U9h,ValueError: too many values to unpack (expected 2) in volcanosv-vc-small-indel.py,OPEN,2024-11-04T03:39:25Z,2024-12-16T16:40:55Z,,"Hi,

I have encountered another issue.

```
path_to_volcanosv=../VolcanoSV
python3 ${path_to_volcanosv}/bin/VolcanoSV-vc/Small_INDEL/volcanosv-vc-small-indel.py \
-i volcanosv_asm_output_tumor \
-o small_indel_output_tumor \
-bam hifi_tumor.bam \
-ref genome.fa \
-t 11 \
-px hifi_tumor
```

Error:
```
ValueError: too many values to unpack (expected 2)
 38%|█████████████████████████▋                                         | 144066/374930 [1:15:42<2:01:19, 31.72it/s]
```
Please see details in log.
[log.txt](https://github.com/user-attachments/files/17606031/log.txt)

The issue might be with coords.split('-').

```
def count_kmers_in_region(bam_file, region, kmer_size):
    kmers = {}
    chrom, coords = region.split("":"")
    start, end = coords.split(""-"")
    start, end = int(start), int(end)
    x = 0
    dc = get_seq(bam_file, chrom, start, end)
    for qname, seq in dc.items():
        for i in range(len(seq) - kmer_size + 1):
            kmer = seq[i:i+kmer_size]
            if kmer in kmers:
                kmers[kmer] += 1
            else:
                kmers[kmer] = 1
        x+=1
    # print(f""num reads in {region}: {x}"")
    # print(len(kmers))

    return kmers
```

Best regards.",DayTimeMouse,https://github.com/maiziezhoulab/VolcanoSV/issues/7
I_kwDOJSUnIc6dA2uj,use T2T-CHM13 as reference,CLOSED,2024-11-05T02:13:31Z,2024-11-05T20:20:55Z,2024-11-05T20:20:55Z,"Hi,

I'd like to use T2T-CHM13 as reference, how to set `-rv`?
```
python3 ${path_to_volcanosv}/bin/VolcanoSV-vc/Small_INDEL/volcanosv-vc-small-indel.py \
-i volcanosv_asm_output/ \
-o volcanosv_small_indel \
-bam Hifi_L2_hg19_minimap2_chr10.bam \
-ref refdata-hg19-2.1.0/fasta/genome.fa \
-rv 37 \
-r chr10 \
-t 30 \
-px Hifi_L2
```

Best regards.",DayTimeMouse,https://github.com/maiziezhoulab/VolcanoSV/issues/8
I_kwDOJSUnIc6dA6wJ,volcanosv-vc-large-indel.py fails,CLOSED,2024-11-05T02:30:41Z,2024-12-16T16:40:09Z,2024-12-16T16:40:09Z,"Hi,

I ran `volcanosv-vc-large-indel.py`, but the results of chr* did not have volcano_variant_chr*vcf file.

log:
```
Traceback (most recent call last):
  File ""/home/xgc/variant/sv/volcanosv/VolcanoSV/bin/VolcanoSV-vc/Large_INDEL//extract_contig_signature_Hifi.py"", line 740, in <module>
    ref_seq = dc_ref[chr_name]
KeyError: 'chr1'
cat: large_indel_output_tumor/chr1/volcano_variant_chr*vcf: 没有那个文件或目录
```
script:
```
path_to_volcanosv='../VolcanoSV'
for i in {1..22}
do
echo ""***********************large-indel for chr${i}*******************""
python3 ${path_to_volcanosv}/bin/VolcanoSV-vc/Large_INDEL/volcanosv-vc-large-indel.py \
-i volcanosv_asm_output_tumor \
-bam hifi_tumor.bam \
-o large_indel_output_tumor \
-ref genome.fa \
-t 20 \
-chr ${i} \
-dtype Hifi \
-px hifi_tumor
done
```

Best regards.",DayTimeMouse,https://github.com/maiziezhoulab/VolcanoSV/issues/9
I_kwDOJSUnIc6f-wp2,complex-sv with external assembly contigs,CLOSED,2024-11-22T17:35:55Z,2024-12-03T20:58:14Z,2024-12-03T20:58:14Z,"When an external whole genome assembly contigs (hp1.fa and hp2.fa) are used, we need to comment out the line 106 in your script: volcanosv-vc-complex-sv.py like this:

logger.info(""-------------------------------Skip Merge contigs for external whole genome assembly "")
#merge_fasta(input_dir,out_dir)
",cbi-star,https://github.com/maiziezhoulab/VolcanoSV/issues/10
I_kwDOJSUnIc6hpCE2,validate called Structural Variants,CLOSED,2024-12-02T13:19:12Z,2024-12-03T20:58:27Z,2024-12-03T20:58:27Z,"Hi,

How can I further validate called Structural Variants (SVs) besides using IGV, especially when the number of SV variants may be in the hundreds or even thousands? Could you give me some ideas?

Best regards.",DayTimeMouse,https://github.com/maiziezhoulab/VolcanoSV/issues/11
I_kwDOJSUnIc6i6YMZ,AD/DP isn't provided,OPEN,2024-12-11T14:58:21Z,2024-12-11T14:58:21Z,,"Hi,

I've noticed that information like AD (Allele Depth) and DP (Depth of Coverage) isn't provided in the VCF. I'd like to ask where I can obtain this kind of information from.

Best regards.",DayTimeMouse,https://github.com/maiziezhoulab/VolcanoSV/issues/12
