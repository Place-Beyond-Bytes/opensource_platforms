id,title,state,created_at,updated_at,closed_at,body,user,url
MDU6SXNzdWUxMTEwNjM0NQ==,bug with prediction,CLOSED,2013-02-18T08:28:38Z,2015-05-01T10:02:47Z,2015-05-01T10:02:47Z," File ""/usr/lib64/python2.7/site-packages/gimmemotifs/prediction.py"", line 54, in add_motifs
    f.write(""%s\n"" % motif.to_pfm())
 AttributeError: 'list' object has no attribute 'to_pfm'
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/1
MDU6SXNzdWUxMTc1OTYwMA==,rewrite help of all scripts to be more clear and consistent,CLOSED,2013-03-07T13:41:28Z,2017-07-04T18:30:55Z,2017-07-04T18:30:55Z,,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/2
MDU6SXNzdWUxMTc1OTYwNg==,motif_localization_plots.py crashes,CLOSED,2013-03-07T13:41:49Z,2013-04-25T09:40:27Z,2013-04-25T09:40:27Z,,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/3
MDU6SXNzdWUxMTc1OTYzMg==,Fix ChIPMunk error,CLOSED,2013-03-07T13:42:32Z,2017-05-11T10:47:08Z,2017-05-11T10:47:08Z,"Sometimes GimmeMotifs hangs on ChIPMunk, especially with small inputs. Figure out what's happening and Fix It!
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/4
MDU6SXNzdWUxMjMyMjkzNg==,gimme match consumes huge amounts of memory,CLOSED,2013-03-22T15:08:07Z,2018-10-24T15:41:25Z,2018-10-24T15:41:25Z,"> 4GB for 13 motifs. Not good!
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/5
MDU6SXNzdWUxMzYzMDI5OQ==,Add support for new backgrounds,CLOSED,2013-04-25T09:41:31Z,2015-05-01T17:46:12Z,2015-05-01T17:46:12Z,"- GC matched background (for all genomes)
- DNAse I hotspots (for organisms where data is available)?
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/6
MDU6SXNzdWUxMzYzMDM0NQ==,Improve documentation,CLOSED,2013-04-25T09:42:51Z,2018-10-24T15:41:56Z,2018-10-24T15:41:56Z,"Improve documentation of all scripts included with GimmeMotifs.
- Make sure it is consistent with the new subcommands
- Provide a working example with example data
- Include new motif tools in the documentation
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/7
MDU6SXNzdWUxNTA1NDYxNA==,gimme scan command line options,CLOSED,2013-06-03T07:35:04Z,2015-05-01T11:15:46Z,2015-05-01T11:15:46Z,"Check if -b (bed) and -n (number of matches) work.
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/8
MDU6SXNzdWUxNTIxNzAxNA==,gimme background command line options,CLOSED,2013-06-06T11:03:23Z,2015-05-01T17:46:40Z,2015-05-01T17:46:40Z,"Specify -n as number of sequences, for every option
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/9
MDU6SXNzdWUxNTI2MDY0OA==,BED output of gimme scan doesn't work,CLOSED,2013-06-07T07:36:15Z,2013-06-07T07:56:20Z,2013-06-07T07:56:20Z,,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/10
MDU6SXNzdWUxNTI2MTcxNg==,gimme scan: strand specific scanning doesn't work,CLOSED,2013-06-07T08:12:11Z,2015-05-04T06:07:57Z,2015-05-04T06:07:57Z,,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/11
MDU6SXNzdWUxNzQ5NTkzNg==,gimme background matched_genomic gives coordinates with .5,CLOSED,2013-08-01T08:31:49Z,2015-05-01T17:47:27Z,2015-05-01T17:47:27Z,"Median sequence size?
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/12
MDU6SXNzdWUyMzY1NDQyNQ==,"Invalid BED12 for track2fasta.py (comma column 11, 12)",CLOSED,2013-12-03T16:27:44Z,2015-05-04T06:11:07Z,2015-05-04T06:11:07Z,"warn / do something with invalid BED12 files that don't have a comma at the end of column 11 and 12
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/13
MDU6SXNzdWUyNzQxOTYxNA==,Skip chromosomes that don't exist in index,CLOSED,2014-02-12T09:21:49Z,2015-05-04T06:41:44Z,2015-05-04T06:41:44Z,"For instance:

KeyError: 'chr6_apd_hap1'
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/14
MDU6SXNzdWUzNzQ2NDA0NA==,background generates regions outside chrom size?,CLOSED,2014-07-09T13:31:39Z,2015-05-01T17:48:23Z,2015-05-01T17:48:23Z,"simon@mb06 ~/tmp $ gimme motifs -n test -a small -t MDmodule /home/matteo/STEM/p300/fluff/ext_250/gimme/p300_refpeaks_sort_merged_ext_250_no_overscaffold_no_TSS_1kb_50p_130u_norm_prof_corr0.8_reformatted_prof_0.bed -g xenTro3beta 
Output directory test already exists!
Resuming a previous run is not yet implemented. Please specify a different name,
or delete this directory if you really want to overwrite it
2014-07-09 15:23:39,127 - INFO - Logging started
2014-07-09 15:23:39,128 - INFO - Created logfile test/gimme_motifs.log
2014-07-09 15:23:39,129 - INFO - gimme_motifs version 0.8.3
2014-07-09 15:23:39,130 - INFO - Created output directory test (all output files will be stored here)
2014-07-09 15:23:39,133 - INFO - Starting full motif analysis
2014-07-09 15:23:39,147 - INFO - Using temporary directory /tmp/gimmemotifs.12161.unHncT
2014-07-09 15:23:39,154 - INFO - Using pp
2014-07-09 15:23:39,155 - INFO - Parameters:
2014-07-09 15:23:39,156 - INFO -   ncpus: 12
2014-07-09 15:23:39,157 - INFO -   torque: False
2014-07-09 15:23:39,157 - INFO -   lwidth: 500
2014-07-09 15:23:39,158 - INFO -   tools: MDmodule
2014-07-09 15:23:39,159 - INFO -   user_background: None
2014-07-09 15:23:39,159 - INFO -   use_strand: False
2014-07-09 15:23:39,160 - INFO -   scan_cutoff: 0.9
2014-07-09 15:23:39,161 - INFO -   width: 200
2014-07-09 15:23:39,162 - INFO -   genome: xenTro3beta
2014-07-09 15:23:39,162 - INFO -   fraction: 0.2
2014-07-09 15:23:39,163 - INFO -   background: genomic_matched,random
2014-07-09 15:23:39,164 - INFO -   abs_max: 1000
2014-07-09 15:23:39,164 - INFO -   available_tools: MDmodule,MEME,MEMEW,GADEM,MotifSampler,trawler,Improbizer,BioProspector,Posmo,ChIPMunk,JASPAR,AMD,HMS
2014-07-09 15:23:39,165 - INFO -   analysis: small
2014-07-09 15:23:39,166 - INFO -   enrichment: 1.5
2014-07-09 15:23:39,167 - INFO -   keep_intermediate: False
2014-07-09 15:23:39,167 - INFO -   max_time: None
2014-07-09 15:23:39,168 - INFO -   cluster_threshold: 0.95
2014-07-09 15:23:39,169 - INFO -   motif_db: vertebrate_motifs.pwm
2014-07-09 15:23:39,169 - INFO -   pvalue: 0.001
2014-07-09 15:23:39,170 - INFO -   markov_model: 1
2014-07-09 15:23:39,259 - INFO - Could not parse max_time value, setting to no limit
2014-07-09 15:23:39,260 - INFO - Invalid time limit for motif prediction, setting to no limit
2014-07-09 15:23:39,261 - INFO - Preparing input (BED)
2014-07-09 15:24:03,577 - INFO - Creating matched genomic background (xenTro3beta, using genes in /usr/share/gimmemotifs/genes/xenTro3beta.bed)
Traceback (most recent call last):
  File ""/usr/bin/gimme"", line 400, in <module>
    args.func(args)
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/commands/motifs.py"", line 69, in motifs
    gm.run_full_analysis(args.inputfile, params)
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/core.py"", line 785, in run_full_analysis
    self.create_background(background, params[""genome""], params[""width""])
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/core.py"", line 399, in create_background
    self._create_background(""genomic_matched"", self.validation_bed, None, self.prediction_bg, organism=organism, width=width)
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/core.py"", line 324, in _create_background
    f = MatchedGenomicFasta(bedfile, gene_file, index_dir, width, nr_times)
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/background.py"", line 367, in __init__
    track2fasta(index, tmpbed, tmpfasta)
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/genome_index.py"", line 399, in track2fasta
    all_seqs = g.get_sequences(chrom, coords)
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/genome_index.py"", line 262, in get_sequences
    raise ValueError, ""%s: %s, invalid start, greater than sequence length!"" % (chr,start)
ValueError: scaffold_84: 31303539, invalid start, greater than sequence length!
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/15
MDU6SXNzdWU0NzYxNjMyMA==,MoAn compile,CLOSED,2014-11-03T16:52:51Z,2014-11-04T14:31:19Z,2014-11-04T14:31:19Z,"I have problems compiling MoAn: I called it with make in the folder. I don't know how to get the output log from the setup.py tools.
Thank you very much,
ido

```
galaxy_env)solexa@gecko:/groups/csf-ngs/bin/gimmemotifs/gimmemotifs-0.8.4/src/MoAn$ make
gcc -c -g -W  -O3 anneal.c -o obj/anneal.o
gcc -c -g -W  -O3 sesa.c -o obj/sesa.o
gcc -c -g -W  -O3 score.c -o obj/score.o
gcc -c -g -W  -O3 build.c -o obj/build.o
gcc -c -g -W  -O3 search.c -o obj/search.o
gcc -c -g -W  -O3 hittable.c -o obj/hittable.o
gcc -c -g -W  -O3 pssm.c -o obj/pssm.o
gcc -c -g -W  -O3 timer.c -o obj/timer.o
gcc -c -g -W  -O3 error.c -o obj/error.o
gcc -c -g -W  -O3 stringcon.c -o obj/stringcon.o
gcc -c -g -W  -O3 ds_ssort/globals.c -o obj/globals.o
gcc -c -g -W  -O3 ds_ssort/ds.c -o obj/ds.o
gcc -c -g -W  -O3 ds_ssort/shallow.c -o obj/shallow.o
ds_ssort/shallow.c: In function ‘shallow_mkq’:
ds_ssort/shallow.c:92:19: error: nested function ‘vecswap2’ declared but never defined
ds_ssort/shallow.c: In function ‘shallow_mkq16’:
ds_ssort/shallow.c:186:19: error: nested function ‘vecswap2’ declared but never defined
ds_ssort/shallow.c: In function ‘shallow_mkq32’:
ds_ssort/shallow.c:264:19: error: nested function ‘vecswap2’ declared but never defined
ds_ssort/shallow.c: In function ‘shallow_inssort_lcp’:
ds_ssort/shallow.c:498:20: error: nested function ‘cmp_unrolled_shallow_lcp’ declared but never defined
make: *** [obj/shallow.o] Error 1

(galaxy_env)solexa@gecko:/groups/csf-ngs/bin/gimmemotifs/gimmemotifs-0.8.4/src/MoAn$ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.7/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Debian 4.7.2-5' --with-bugurl=file:///usr/share/doc/gcc-4.7/README.Bugs --enable-languages=c,c++,go,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.7 --enable-shared --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.7 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --enable-plugin --enable-objc-gc --with-arch-32=i586 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.7.2 (Debian 4.7.2-5)
```
",idot,https://github.com/vanheeringen-lab/gimmemotifs/issues/16
MDU6SXNzdWU0NzcxMjcxMg==,could not run test,CLOSED,2014-11-04T13:30:43Z,2015-05-04T07:54:36Z,2015-05-04T07:54:36Z,"File ""test/test_motif.py"", line 5, in <module>
    from gimmemotifs.utils import which
ImportError: cannot import name which

And, python package pyyaml is also required.
",sywang,https://github.com/vanheeringen-lab/gimmemotifs/issues/17
MDU6SXNzdWU0NzcxNjAyNA==,gimme background matched_genomic with -f BED fails,CLOSED,2014-11-04T14:02:17Z,2015-05-01T17:47:55Z,2015-05-01T17:47:55Z,"kprange@mb06 ~/MLL_Fusion/analyses_nov_2014/BRE_motifs $ gimme background -i test.bed -f BED -g hg19 test matched_genomic
Traceback (most recent call last):
  File ""/usr/bin/gimme"", line 417, in <module>
    args.func(args)
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/commands/background.py"", line 71, in background
    bg.create_matched_genomic_bedfile(out, inputfile, gene_file, l, args.number, True)
TypeError: create_matched_genomic_bedfile() takes exactly 7 arguments (6 given)

Test.bed:
kprange@mb06 ~/MLL_Fusion/analyses_nov_2014/BRE_motifs $ cat test.bed
chr1    10011   10053   D256N5M1:154:C55L9ACXX:4:2304:2839:53613        0       -
chr1    10048   10090   D256N5M1:154:C55L9ACXX:4:1111:17209:91625       0       +
chr1    10119   10161   D256N5M1:154:C55L9ACXX:4:2208:9041:60563        0       -
chr1    10127   10169   D256N5M1:154:C55L9ACXX:4:2105:15109:63619       0       +
chr1    10174   10216   D256N5M1:154:C55L9ACXX:4:1315:20800:58785       0       +
chr1    10198   10240   D256N5M1:154:C55L9ACXX:4:1105:5332:10721        0       +
chr1    10234   10276   D256N5M1:154:C55L9ACXX:4:2304:10743:58755       25      +
chr1    10262   10304   D256N5M1:154:C55L9ACXX:4:2205:17772:54808       0       +
chr1    10308   10350   D256N5M1:154:C55L9ACXX:4:1105:2621:91731        23      +
chr1    10354   10396   D256N5M1:154:C55L9ACXX:4:2314:11599:48130       0       +
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/18
MDU6SXNzdWU0Nzk1NzMyNQ==,Update documentation,CLOSED,2014-11-06T12:36:51Z,2018-10-24T15:41:44Z,2018-10-24T15:41:44Z,"- gimme threshold
- gimme genome
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/19
MDU6SXNzdWU0Nzk1NzM1NA==,gimme cluster doesn't close threads,CLOSED,2014-11-06T12:37:23Z,2018-10-24T15:41:10Z,2018-10-24T15:41:10Z,,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/20
MDU6SXNzdWU5Njc1MDg3OQ==,Background creation: use input instead of validation files,CLOSED,2015-07-23T07:30:10Z,2018-10-24T15:42:26Z,2018-10-24T15:42:26Z,"I think there might be a bug in the core.py file under the function ""create_background"", since for the prediction background file we should input the prediction fasta file not the validation fasta file as input, unless I am mistaken.

Here is the function under core.py:

```
def create_background(self, background=[""random""], organism=""hg18"", width=200):
    nr_sequences = {}

# Create background for motif prediction
if ""gc"" in background:
     #this is the line I am talking about; self.validation_fa should be self.prediction_fa
    self._create_background(""gc"", self.validation_bed, self.validation_fa, self.prediction_bg,  organism=organism, width=width)

else:
    #this is the line I am talking about; self.validation_fa should be self.prediction_fa
    self._create_background(background[0], self.validation_bed, self.validation_fa, self.prediction_bg, organism=organism, width=width)

# Get background fasta files
for bg in background:
    nr_sequences[bg] = self._create_background(bg, self.validation_bed, self.validation_fa, self.bg_file[""fa""][bg], organism=organism, width=width)
```

Thank you,

Rami Alouran
Ohio University Bioinformatics lab 
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/21
MDU6SXNzdWU5NzQxMzc2MA==,Document removal of the genomic_matched background option.,CLOSED,2015-07-27T08:43:01Z,2017-07-04T18:30:32Z,2017-07-04T18:30:32Z,"- add deprecation warning
- adapt command line scripts, as well as documentation
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/22
MDU6SXNzdWUxMDA3MDgwNjY=,matplotlib backend configurable,OPEN,2015-08-13T07:40:10Z,2015-08-13T07:40:10Z,,"Add it to the configuration file
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/23
MDU6SXNzdWUxMjc2Nzc3NjQ=,Remove pp dependency,CLOSED,2016-01-20T13:04:07Z,2016-02-19T15:41:24Z,2016-02-19T15:41:24Z,"Replace with multiprocessing
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/24
MDU6SXNzdWUxMjc2Nzc4MDQ=,Remove Pycluster dependency,CLOSED,2016-01-20T13:04:24Z,2016-02-19T15:41:04Z,2016-02-19T15:41:04Z,"Replace with sklearn
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/25
MDU6SXNzdWUxMjk0NzM1ODI=,bug gimme background,CLOSED,2016-01-28T14:48:53Z,2018-07-16T12:48:50Z,2018-07-16T12:48:50Z,"Traceback (most recent call last):
  File ""/usr/bin/gimme"", line 433, in <module>
    args.func(args)
  File ""/usr/lib64/python2.7/site-packages/gimmemotifs/commands/background.py"", line 63, in background
    m = bg.MarkovFasta(f, n=number, k=args.markov_order)
TypeError: **init**() got an unexpected keyword argument 'n'
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/26
MDU6SXNzdWUxMzkwNzE0OTQ=,replace kid with jinja2,CLOSED,2016-03-07T19:33:29Z,2016-06-09T19:04:07Z,2016-06-09T19:04:07Z,,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/28
MDU6SXNzdWUxNDIwNDk4ODk=,ucsc genePredToBed as dependency for gimme genome,CLOSED,2016-03-19T10:23:52Z,2016-06-08T19:42:34Z,2016-06-08T19:42:33Z,"bioconda: ucsc-genepredtobe
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/30
MDU6SXNzdWUxNDUyMTI3MzE=,user defined background fasta,CLOSED,2016-04-01T15:39:40Z,2016-04-01T20:28:23Z,2016-04-01T20:28:23Z,"Quick question: If I give gimmemotif with my own background sequences, how does gimmemotif run MEME, Weeder (the tools that cannot accept user-defined background)?
",unfashionable,https://github.com/vanheeringen-lab/gimmemotifs/issues/31
MDU6SXNzdWUxNDUyNTU2Mjg=,A mistake at line 853 in gimmemotifs/gimmemotifs/tools.py,CLOSED,2016-04-01T18:47:47Z,2016-04-04T06:08:19Z,2016-04-04T06:08:19Z,"Line 853: number = default_params['width'].

Should be : number = default_params['number']
",unfashionable,https://github.com/vanheeringen-lab/gimmemotifs/issues/32
MDU6SXNzdWUxNTU2ODY2NDE=,Error in gimmemotif/scanner,CLOSED,2016-05-19T09:02:02Z,2016-06-08T19:42:16Z,2016-06-08T19:42:15Z,"https://github.com/simonvh/gimmemotifs/blob/master/gimmemotifs/scanner.py#L323

Undefinded variable ""vals"". 

Greetings, Lisa
",lschroer,https://github.com/vanheeringen-lab/gimmemotifs/issues/33
MDU6SXNzdWUxNTc4NDg2NjE=,Error when running Quick GimmeMotifs example [Key Error: 'ncpus'] in mp.py,CLOSED,2016-06-01T08:18:46Z,2016-06-01T11:19:47Z,2016-06-01T11:19:47Z,"Hi,
I'm running a debian jessie (8.4) and just installed GimmeMotifs via pip in a virtualenv:

```
cd /home/george
virtualenv GimmeMotifs_pythonEnv
GimmeMotifs_pythonEnv/bin/pip install numpy # 1.11.0
GimmeMotifs_pythonEnv/bin/pip install scipy # 0.17.1
GimmeMotifs_pythonEnv/bin/pip install matplotlib # 1.5.1
GimmeMotifs_pythonEnv/bin/pip install kid # 0.9.6
GimmeMotifs_pythonEnv/bin/pip install pybedtools # 0.7.7
GimmeMotifs_pythonEnv/bin/pip install pandas # 0.18.1
GimmeMotifs_pythonEnv/bin/pip install gimmemotifs # 0.9.0.3

source /home/george/GimmeMotifs_pythonEnv/bin/activate

gimme motifs /home/george/GimmeMotifs_pythonEnv/share/gimmemotifs/examples/TAp73alpha.fa -n /home/george/gimmemotifs_test/p73
```

This results in an error:

```
Traceback (most recent call last):
  File ""/home/george/GimmeMotifs_pythonEnv/bin/gimme"", line 11, in <module>
    from  gimmemotifs import commands
  File ""/home/george/GimmeMotifs_pythonEnv/local/lib/python2.7/site-packages/gimmemotifs/commands/__init__.py"", line 8, in <module>
    m =  __import__(""{0}.{1}"".format(__name__, cmdname), globals(), locals(), [cmdname], -1)
  File ""/home/george/GimmeMotifs_pythonEnv/local/lib/python2.7/site-packages/gimmemotifs/commands/cluster.py"", line 11, in <module>
    from gimmemotifs.comparison import MotifComparer
  File ""/home/george/GimmeMotifs_pythonEnv/local/lib/python2.7/site-packages/gimmemotifs/comparison.py"", line 419, in <module>
    from gimmemotifs.mp import pool
  File ""/home/george/GimmeMotifs_pythonEnv/local/lib/python2.7/site-packages/gimmemotifs/mp.py"", line 5, in <module>
    n_cpus = int(MotifConfig().get_default_params()[""ncpus""])
KeyError: 'ncpus'
```

Inspecting the content of `MotifConfig().get_default_params()` it seems like the `ncpus` is indeed not available:

```
>>> MotifConfig().get_default_params()
{'fraction': '0.2', 'use_strand': 'False', 'available_tools': 'MDmodule,MEME,GADEM,MotifSampler,trawler,Improbizer,BioProspector,Posmo,ChIPMunk,JASPAR,AMD,HMS,Homer', 'abs_max': '1000', 'analysis': 'medium', 'pvalue': '0.001', 'width': '200', 'lwidth': '500', 'scan_cutoff': '0.9', 'background': 'genomic_matched,random', 'cluster_threshold': '0.95', 'max_time': 'None', 'motif_db': 'vertebrate_motifs.pwm', 'tools': 'MDmodule,MEME,MotifSampler,trawler,Improbizer,BioProspector,Posmo,ChIPMunk,JASPAR,AMD,HMS,Homer', 'enrichment': '1.5', 'markov_model': '1', 'genome': 'hg19'}
```

A `which ncpus` yields `/usr/bin/ncpus` and results in `8`.

What do you think about this?

Many thanks for your assistance and help.
Regards
",devNull2013,https://github.com/vanheeringen-lab/gimmemotifs/issues/34
MDU6SXNzdWUxNTkzMzM5MTM=,gimme scan should accept bed file / regions,CLOSED,2016-06-09T06:00:14Z,2016-06-09T19:43:51Z,2016-06-09T19:43:51Z,"Given a genome as argument.
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/35
MDU6SXNzdWUxNTkzMzM5NDg=,gimme scan should have default pwm,CLOSED,2016-06-09T06:00:38Z,2016-06-09T19:43:51Z,2016-06-09T19:43:51Z,"take standard gimme default pwm 
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/36
MDU6SXNzdWUxOTEyNTU2OTI=,Include singleton motifs in final output pwm of gimme cluster,CLOSED,2016-11-23T12:16:13Z,2018-07-16T12:53:05Z,2018-07-16T12:53:05Z,"currently only the clustered motifs are in the `clustered.pwm` file, include the singletons too",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/41
MDU6SXNzdWUxOTU3ODQ0MjI=,duplicate lines in maelstrom,OPEN,2016-12-15T11:40:31Z,2019-02-06T08:24:29Z,,"Maelstrom fails if duplicate lines are present in the input. Either deal with it, or give an informative error message.",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/42
MDU6SXNzdWUxOTcxNjY2NDc=,name of best match,CLOSED,2016-12-22T12:42:22Z,2021-04-13T08:13:07Z,2021-04-13T08:13:07Z,Currently the name of the best matching motif lists the motif ID. It should (also) list the proteins predicted to bind to that motif. ,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/43
MDU6SXNzdWUyMDAyMTI5MDU=,Configuration file not found,CLOSED,2017-01-11T21:31:34Z,2017-01-11T21:43:19Z,2017-01-11T21:43:19Z,"Hi all,

I installed the version 0.10.0b3 and b6 locally, however when i try to use them i get an error ""configuration file not found"". I checked my installation directory and there exists the configuration file in share/gimmemotifs/",itorres2607,https://github.com/vanheeringen-lab/gimmemotifs/issues/44
MDU6SXNzdWUyMDQ1MTQwNzM=,Python 3,CLOSED,2017-02-01T07:24:51Z,2017-05-11T08:27:32Z,2017-05-11T08:27:32Z,It's about time!,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/45
MDU6SXNzdWUyMDQ1MTQxNzM=,Specifify number of cores on command line,CLOSED,2017-02-01T07:25:43Z,2018-07-10T09:59:41Z,2018-07-10T09:59:41Z,It's probably a good idea to be able to specify the number of cores for all command line tools.,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/46
MDU6SXNzdWUyMDQ4MDE3NTI=,Replace fasta indexing ,CLOSED,2017-02-02T07:32:11Z,2018-07-11T15:25:30Z,2018-07-11T15:25:30Z,Either bedtools or pyfaidx,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/47
MDU6SXNzdWUyMTcyMzA2NTE=,hg38.fa contains multiple sequences,CLOSED,2017-03-27T12:32:27Z,2017-05-11T08:26:01Z,2017-05-11T08:26:01Z,"Tried to run following command:
`gimme genome /cbscratch/croth1/gimmemotifs/genomes/hg38  hg38`

with the latest version from bioconda
`gimmemotifs               0.10.0b6         py27pl5.22.0_1    bioconda`

This is the result:
```
Retrieving gene annotation for hg38
Expecting 10 words line 1 of /dev/stdin got 9
cut: write error: Broken pipe
Downloading hg38 genome
Trying to download http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/chromFa.tar.gz
Trying to download http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz
´Unpacking
Creating index
Sorry, can only index genomes with one sequence per FASTA file
/cbscratch/croth1/gimmemotifs/genomes/hg38/hg38/hg38.fa contains multiple sequences
```",croth1,https://github.com/vanheeringen-lab/gimmemotifs/issues/48
MDU6SXNzdWUyMjc5MTQ2MTg=,"Change ""user background"" to ""custom background""",CLOSED,2017-05-11T08:27:06Z,2018-12-03T23:06:16Z,2018-12-03T23:06:16Z,,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/49
MDU6SXNzdWUyMzQxMDQxNzc=,Change scan FDR to FPR,CLOSED,2017-06-07T06:23:46Z,2018-07-11T15:34:14Z,2018-07-11T15:34:14Z,"gimme scan determines FPR, not FDR!",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/50
MDU6SXNzdWUyMzQzMDE5MzY=,updates to gimme roc,CLOSED,2017-06-07T18:30:32Z,2017-07-07T13:04:25Z,2017-07-07T13:04:25Z,"* accept BED files and regions in addition to fasta files
* default pwm",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/51
MDU6SXNzdWUyMzUyMDg1NzM=,Accept narrowPeak files as input,CLOSED,2017-06-12T11:55:37Z,2018-11-19T20:21:41Z,2018-11-19T20:21:41Z,"In addition to BED, FASTA and regions files `gimme motifs` could accept narrowPeak as input. Simplifies analysis downstream of, for instance, MACS2. Summit could be taken into account automatically.",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/52
MDU6SXNzdWUyMzk5NDYyMDQ=,denovo test fails sometimes,CLOSED,2017-07-01T12:20:28Z,2018-07-16T12:39:42Z,2018-07-16T12:39:42Z,"```
======================================================================

ERROR: test1_denovo (test_denovo.TestDenovo)

de novo motif prediction

----------------------------------------------------------------------

Traceback (most recent call last):

  File ""/home/travis/build/simonvh/gimmemotifs/test/test_denovo.py"", line 28, in test1_denovo

    cluster=True)

  File ""/home/travis/build/simonvh/gimmemotifs/gimmemotifs/denovo.py"", line 559, in gimme_motifs

    stats,

  File ""/home/travis/build/simonvh/gimmemotifs/gimmemotifs/report.py"", line 219, in create_denovo_motif_report

    _create_text_report(inputfile, motifs, closest_match, stats, outdir)

  File ""/home/travis/build/simonvh/gimmemotifs/gimmemotifs/report.py"", line 87, in _create_text_report

    my_stats[str(motif)][bg] = stats[str(motif)][bg].copy()

KeyError: 'GimmeMotifs_6_ACTyAAACCG'
```",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/53
MDU6SXNzdWUyNDQ1MzAyOTA=,failed to download genome,CLOSED,2017-07-21T00:08:29Z,2017-08-16T09:47:33Z,2017-08-16T09:47:33Z,"Having trouble downloading hg18 genome using `gimme genome . hg18`

```
Retrieving gene annotation for hg18
Using http://hgdownload.cse.ucsc.edu/goldenPath/hg18/database/knownGene.txt.gz
zcat /tmp/tmpKPJNfT.gz | cut -f1-11 | /home/carlos/anaconda2/bin/genePredToBed /dev/stdin /home/carlos/anaconda2/share/gimmemotifs/genes/hg18.bed
Downloading hg18 genome
Trying to download http://hgdownload.soe.ucsc.edu/goldenPath/hg18/bigZips/chromFa.tar.gz
Trying to download http://hgdownload.soe.ucsc.edu/goldenPath/hg18/bigZips/hg18.fa.gz
Failed to download genome
```

The version is 0.10.0.

Using version 0.11.0

```
/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/matplotlib/font_manager.py:280: UserWarning: Matplotlib is building the font cache using fc-list. This may take a moment.
  'Matplotlib is building the font cache using fc-list. '
Retrieving gene annotation for hg18
Using http://hgdownload.cse.ucsc.edu/goldenPath/hg18/database/knownGene.txt.gz
zcat /tmp/tmpn1pj049r.gz | cut -f1-11 | /home/carlos/anaconda2/envs/gimme/bin/genePredToBed /dev/stdin /home/carlos/anaconda2/envs/gimme/share/gimmemotifs/genes/hg18.bed
Downloading hg18 genome
Trying to download http://hgdownload.soe.ucsc.edu/goldenPath/hg18/bigZips/chromFa.tar.gz
Traceback (most recent call last):
  File ""/home/carlos/anaconda2/envs/gimme/bin/gimme"", line 496, in <module>
    args.func(args)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/genome.py"", line 23, in genome
    get_genome(args.genomebuild, args.fastadir, args.indexdir)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 222, in get_genome
    download_genome(genomebuild, genome_dir)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 168, in download_genome
    genome_fa
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/urllib/request.py"", line 248, in urlretrieve
    with contextlib.closing(urlopen(url, data)) as fp:
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/urllib/request.py"", line 223, in urlopen
    return opener.open(url, data, timeout)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/urllib/request.py"", line 532, in open
    response = meth(req, response)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/urllib/request.py"", line 642, in http_response
    'http', request, response, code, msg, hdrs)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/urllib/request.py"", line 570, in error
    return self._call_chain(*args)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/urllib/request.py"", line 504, in _call_chain
    result = func(*args)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/urllib/request.py"", line 650, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found
```
",c-guzman,https://github.com/vanheeringen-lab/gimmemotifs/issues/54
MDU6SXNzdWUyNTA1NzAwNDQ=,Update documentation: location of config file,CLOSED,2017-08-16T09:48:17Z,2018-11-19T20:21:42Z,2018-11-19T20:21:42Z,"The current config file location is based on old, system-wide installation. Update with conda env path.",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/55
MDU6SXNzdWUyNTIwNDMzMTQ=,ValueError: Function <function Styler._bar_left at 0x7f4cdc455ae8> returned the wrong shape.,CLOSED,2017-08-22T18:09:51Z,2017-08-24T08:38:43Z,2017-08-24T08:38:43Z,"```
reading mapping
Traceback (most recent call last):
  File ""/home/carlos/anaconda2/envs/gimme/bin/gimme"", line 496, in <module>
    args.func(args)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/roc.py"", line 143, in roc
    0.01,
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/roc.py"", line 71, in html_report
    f.write(df.sort_values(""ROC AUC"", ascending=False).style.bar(bar_cols).set_precision(3).set_table_attributes(""data-sortable"").render().replace(""data-sortable"", 'class=""sortable-theme-slick"" data-sortable'))
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/pandas/io/formats/style.py"", line 434, in render
    self._compute()
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/pandas/io/formats/style.py"", line 502, in _compute
    r = func(self)(*args, **kwargs)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/pandas/io/formats/style.py"", line 531, in _apply
    raise ValueError(msg)
ValueError: Function <function Styler._bar_left at 0x7f4cdc455ae8> returned the wrong shape.
Result has shape: (6,)
Expected shape:   (0, 6)
```

Used gimme background with gc to create background regions, no errors.

Used gimme roc, received this error. Tried working on a small number of sequences (39).",c-guzman,https://github.com/vanheeringen-lab/gimmemotifs/issues/56
MDU6SXNzdWUyNTMwMjY4OTg=,No section params,CLOSED,2017-08-25T21:54:13Z,2017-09-05T07:08:06Z,2017-09-05T07:08:06Z,"Tried installing gimmeMotifs on a new ubuntu 16.04 system. Followed installation instructions as shown in the github.

Received this error when trying to run `gimme genome`:

```
gimme genome . hg38
```

```
Traceback (most recent call last):
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/configparser.py"", line 846, in items
    d.update(self._sections[section])
KeyError: 'params'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/carlos/anaconda2/envs/gimme/bin/gimme"", line 11, in <module>
    from  gimmemotifs import commands
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/__init__.py"", line 14, in <module>
    m =  __import__(""{0}.{1}"".format(__name__, cmdname), globals(), locals(), [cmdname], level)
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/location.py"", line 14, in <module>
    from gimmemotifs.mp import pool
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/mp.py"", line 5, in <module>
    n_cpus = int(MotifConfig().get_default_params()[""ncpus""])
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/config.py"", line 66, in get_default_params
    d = dict(self.config.items(""params""))
  File ""/home/carlos/anaconda2/envs/gimme/lib/python3.6/configparser.py"", line 849, in items
    raise NoSectionError(section)
configparser.NoSectionError: No section: 'params'
```",c-guzman,https://github.com/vanheeringen-lab/gimmemotifs/issues/57
MDU6SXNzdWUyNTQyNDk1NjQ=,gimme cluster error,CLOSED,2017-08-31T08:04:27Z,2017-08-31T08:06:56Z,2017-08-31T08:06:56Z,"```
Traceback (most recent call last):
  File ""/home/simon/anaconda2/envs/gimme/bin/gimme"", line 496, in <module>
    args.func(args)
  File ""/home/simon/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/cluster.py"", line 84, in cluster
    ids = _create_images(outdir, clusters) 
  File ""/home/simon/anaconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/cluster.py"", line 53, in _create_images
    add_pos = sorted(scores.values(),cmp=lambda x,y: cmp(x[1], y[1]))[0][1]
TypeError: 'cmp' is an invalid keyword argument for this function
```",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/58
MDU6SXNzdWUyNjE2NzYzMjg=,[Installation with pip] No section: 'params' error,CLOSED,2017-09-29T15:18:53Z,2018-11-22T11:58:37Z,2018-11-22T11:58:37Z,"Hi Simon,

I have been trying to use gimmemotifs lately, with little success. With `conda create`, my installation is stuck forever on 'Solving package specifications' unless I specify the version of gimmemotifs I want, something I took from a post of yours in the bioconda GitHub. Leaving that aside, what I want to report here is an error whenever I try to use gimmemotifs following its installation via `pip`. Namely, I get the following:

> Traceback (most recent call last):
>   File ""/usr/lib/python3.5/configparser.py"", line 843, in items
>     d.update(self._sections[section])
> KeyError: 'params'
> 
> During handling of the above exception, another exception occurred:
> 
> Traceback (most recent call last):
>   File ""/data/roger/.local/bin/gimme"", line 11, in <module>
>     from  gimmemotifs import commands
>   File ""/data/roger/.local/lib/python3.5/site-packages/gimmemotifs/commands/__init__.py"", line 14, in <module>
>     m =  __import__(""{0}.{1}"".format(__name__, cmdname), globals(), locals(), [cmdname], level)
>   File ""/data/roger/.local/lib/python3.5/site-packages/gimmemotifs/commands/location.py"", line 14, in <module>
>     from gimmemotifs.mp import pool
>   File ""/data/roger/.local/lib/python3.5/site-packages/gimmemotifs/mp.py"", line 5, in <module>
>     n_cpus = int(MotifConfig().get_default_params()[""ncpus""])
>   File ""/data/roger/.local/lib/python3.5/site-packages/gimmemotifs/config.py"", line 66, in get_default_params
>     d = dict(self.config.items(""params""))
>   File ""/usr/lib/python3.5/configparser.py"", line 846, in items
>     raise NoSectionError(section)
> configparser.NoSectionError: No section: 'params'

I suspect it may have something to do with the configuration file, but strangely enough, I did not encounter this problem when I installed the program as a part of a conda environment. Am I doing anything wrong or is it really an error? Thanks!
",Rmulet,https://github.com/vanheeringen-lab/gimmemotifs/issues/59
MDU6SXNzdWUyNjY3MzY0OTE=,Add AUPRC stat,CLOSED,2017-10-19T06:49:22Z,2018-11-19T20:21:41Z,2018-11-19T20:21:41Z,Use the new implementation `average_precision_score` in sklearn version 0.19.,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/60
MDU6SXNzdWUyNzA1NjA5Mzk=,Add motif_db argument to gimme motifs,OPEN,2017-11-02T07:45:34Z,2018-11-22T12:00:57Z,,"Hi,

So far I have been using the default database that comes bundled with Gimmemotifs, which is quite alright for most purposes. However, Jaspar 2018 has just been released and I wanted to repeat some analyses to see what new motifs may pop up. For some tools this is relatively straightforward (--pwmfile in `match` or `maelstrom`), but I did not see such an option in gimme motifs. Thus, I had to modify the config file, which is not as convenient as adding an argument.

I know it's a minor thing, but I leave this suggestion here in case you want to implement it if you deem it worthwhile. 

PS: Now that I think of it, the number of CPUs to be used could also be a valuable addition to command line program calls.",Rmulet,https://github.com/vanheeringen-lab/gimmemotifs/issues/61
MDU6SXNzdWUzMTcwNTc5MzE=,struct.error: unpack requires a bytes object of length 8,CLOSED,2018-04-24T03:32:18Z,2018-04-24T04:58:33Z,2018-04-24T03:42:38Z,"using gimmemotifs:               0.11.1-py36_0 

```
gimme maelstrom gimme_input.txt hg19 maelstrom.out

2018-04-23 22:29:09,302 - INFO - Starting maelstrom
2018-04-23 22:29:09,305 - INFO - Motif scanning (counts)
2018-04-23 22:29:09,305 - INFO - reading table
2018-04-23 22:29:09,401 - INFO - setting threshold
Determining threshold for fpr 0.01 and length 200 based on hg19
Traceback (most recent call last):
  File ""/apps/conda/envs/gimme/bin/gimme"", line 496, in <module>
    args.func(args)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/maelstrom.py"", line 29, in maelstrom
    run_maelstrom(infile, genome, outdir, pwmfile, methods=methods)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/maelstrom.py"", line 193, in run_maelstrom
    pwmfile=pwmfile)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/maelstrom.py"", line 59, in scan_to_table
    s.set_threshold(fpr=FPR, genome=genome)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 407, in set_threshold
    fa = RandomGenomicFasta(index, length, 10000)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 350, in __init__
    track2fasta(index, tmpbed, tmpfasta, use_strand=True)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 628, in track2fasta
    all_seqs = g.get_sequences(chrom, coords)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 489, in get_sequences
    seq += self._read(index, fasta, start, end, line_size)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 448, in _read
    d_offset = self._get_offset_from_index(index, i_offset)
  File ""/apps/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 420, in _get_offset_from_index
    d_offset = unpack(self.pack_char, entry)[0]
struct.error: unpack requires a bytes object of length 8

```
what's wrong with it?
Thanks,
Tommy ",crazyhottommy,https://github.com/vanheeringen-lab/gimmemotifs/issues/62
MDU6SXNzdWUzMTc4MDQ1MzM=,best practice  for motif analysis from histone modification ChIP-seq ,CLOSED,2018-04-25T21:42:42Z,2018-04-26T16:05:07Z,2018-04-26T16:05:07Z,"Hi,

I was reading http://gimmemotifs.readthedocs.io/en/master/reference.html#best-practices-and-tips

```
-w or –width

This is the width of the sequences used for motif prediction. Smaller sequences will result in a faster analysis, but you are of course limited by the accuracy of your data. For the tested ChIP-seq data sets 200 performs fine.

Running on FASTA files
It is possible to run GimmeMotifs on a FASTA file as input instead of a BED file. This is detected automatically if your input file is correctly formatted according to FASTA specifications. In this case it is not possible to generate a genomic matched background, so only the random Markov background will be used. **Please note that for best results, all the sequences should be of the same length**. This is not necessary for motif prediction, but the statistics and positional preference plots will be wrong if sequences have different lengths. Also see the next section.
```
The peaks from histone modification ChIP-seq are of different length. some of them are 6kb long (H3K27ac). in this case, how should one specify the -w?

I noticed that if I use the peak length of variable length in `gimme malestrom`, it still gives me results. There is no option for -w for this command. do I need to set it up in the config file?

If the peak length are not of the same length. How the 200bp position is determined?

Thanks,
Tommy 
",crazyhottommy,https://github.com/vanheeringen-lab/gimmemotifs/issues/63
MDU6SXNzdWUzMjIzOTgyNzY=,How gimme maelstrom final score was calculated ,CLOSED,2018-05-11T18:50:42Z,2018-11-23T02:21:45Z,2018-11-23T02:21:44Z,"Hi,

I saw in the output there are activity* files including different methods such as hypergeometric testing, randomforest etc. How the final score was calculated?

In my run with 4 different clusters in a bed file, the final score (html) reported that AP1 binding motif is enriched in cluster3 with scores of 4-5. the other clusters have a score of 0 or negative.

But when I use gimme scan to check how many AP1 motifs in each cluster, the number of motifs are not that different across clusters.

How is that possible?

Thanks!
Tommy ",crazyhottommy,https://github.com/vanheeringen-lab/gimmemotifs/issues/64
MDU6SXNzdWUzMjI1NzUwOTg=,gimme genome mm10 error,CLOSED,2018-05-13T08:33:03Z,2018-07-11T14:01:16Z,2018-07-11T14:01:15Z,"```
$ gimme genome gimme_genomes/ mm10
Retrieving gene annotation for mm10
Using http://hgdownload.cse.ucsc.edu/goldenPath/mm10/database/knownGene.txt.gz
zcat /tmp/tmpfxuf6a7g.gz | cut -f1-11 | /home/cag104/miniconda3/envs/bioinfo/bin/genePredToBed /dev/stdin /home/cag104/miniconda3/envs/bioinfo/share/gimmemotifs/genes/mm10.bed
Downloading mm10 genome
Trying to download http://hgdownload.soe.ucsc.edu/goldenPath/mm10/bigZips/chromFa.tar.gz
Unpacking
tar: gimme_genomes/mm10: Cannot open: No such file or directory
tar: Error is not recoverable: exiting now
Creating index
Traceback (most recent call last):
  File ""/home/cag104/miniconda3/envs/bioinfo/bin/gimme"", line 496, in <module>
    args.func(args)
  File ""/home/cag104/miniconda3/envs/bioinfo/lib/python3.6/site-packages/gimmemotifs/commands/genome.py"", line 23, in genome
    get_genome(args.genomebuild, args.fastadir, args.indexdir)
  File ""/home/cag104/miniconda3/envs/bioinfo/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 241, in get_genome
    g = g.create_index(genome_dir, index_dir)
  File ""/home/cag104/miniconda3/envs/bioinfo/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 344, in create_index
    raise IOError(msg)
OSError: No fastafiles found in /gpfs/data01/heinzlab/home/cag104/reference_data/Mus_musculus/UCSC/mm10/gimme_genomes/mm10 with extension in .fasta,.fa,.fsa
```",c-guzman,https://github.com/vanheeringen-lab/gimmemotifs/issues/65
MDU6SXNzdWUzMjk3MzYzMjc=,Warning message gimme scan,CLOSED,2018-06-06T07:03:18Z,2018-11-19T20:21:42Z,2018-11-19T20:21:42Z,"If file is bed, genome is needed to scan. However, with a fixed scanning threshold (-c) a warning is generated:
```
Parameter genome ignored when threshold is specified.
Did you want to use fpr?
```",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/66
MDU6SXNzdWUzNDA1MTQxMTc=,gimme roc ignore -N parameter,CLOSED,2018-07-12T07:07:23Z,2018-11-19T20:21:42Z,2018-11-19T20:21:41Z,It uses the number of cores specified in the config.,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/67
MDU6SXNzdWUzNTY4MjUxNjI=,gimme motifs output,CLOSED,2018-09-04T14:03:09Z,2018-10-24T15:40:40Z,2018-10-24T15:40:39Z,"Hi Simon,
I run gimme motifs on two different bed files of mm10 genome .. for one the output was absolutely fine as expected however the other one gave me weird output file with no error message though.
the output file contains:
gimmemotifs.log file and intermediate folder which contains (all_motifs.pfm, bg.gc.fa, bg.random.fa, input.bed, localization.fa, prediction.bed, prediction.bg.fa, prediction.fa, significant_motifs.pfm, stats.gc.txt, stats.random.txt, validation.bed, validation.fa).
this is the code I run:
$gimme motifs  chr18.bed -g mm10 -n gimme.motif

I don't know what could be possibly wrong.
any ideas?
thanks much
TA",tamerawwad,https://github.com/vanheeringen-lab/gimmemotifs/issues/68
MDU6SXNzdWUzNzU2OTI4NTk=,ImportError: cannot import name 'RLock',CLOSED,2018-10-30T21:05:04Z,2019-03-28T06:07:01Z,2019-03-28T06:07:01Z,"I am trying to install GimmeMotifs via conda. The process seems successful but when I run any command, I get the following error: "" ImportError: cannot import name 'RLock' "". ",FrancescoFerrari88,https://github.com/vanheeringen-lab/gimmemotifs/issues/69
MDU6SXNzdWUzODQwNzg0Nzk=,UnboundLocalError: local variable 'valid_bg' referenced before assignment,CLOSED,2018-11-25T13:21:54Z,2018-11-26T15:30:44Z,2018-11-26T15:30:44Z,"Hi Simon,
I've followed the https://gimmemotifs.readthedocs.io installation instructions. The Conda installation on macOS Sierra 10.12.6 worked fine, environment activated, genome annotations installed. Attempt to run basic analysis results in an error:
```
$ gimme motifs CTCF.bed -g hg19 -n test1
Sorry, motif prediction tool MEME is not supported
```
Excluding MEME doesn't help:
```
$ gimme motifs CTCF.bed -g hg19 -n test1 -t Homer,BioProspector
Traceback (most recent call last):
  File ""/Users/mdozmorov/miniconda2/envs/gimme/bin/gimme"", line 513, in <module>
    args.func(args)
  File ""/Users/mdozmorov/miniconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/motifs.py"", line 69, in motifs
    gimme_motifs(args.inputfile, args.name, params)
  File ""/Users/mdozmorov/miniconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/denovo.py"", line 525, in gimme_motifs
    input_type, background = check_denovo_input(inputfile, params)
  File ""/Users/mdozmorov/miniconda2/envs/gimme/lib/python3.6/site-packages/gimmemotifs/validation.py"", line 60, in check_denovo_input
    if not bg in valid_bg:
UnboundLocalError: local variable 'valid_bg' referenced before assignment
```
The head of my BED file:
```
chr1 850718 850942
chr1 856275 856499
chr1 862729 862953
chr1 864695 864919
chr1 872641 872865
chr1 889157 889381
chr1 889597 889821
chr1 900920 901144
chr1 907087 907311
chr1 956668 956892
```
Where to go from there?

Thanks,
Mikhail",mdozmorov,https://github.com/vanheeringen-lab/gimmemotifs/issues/70
MDU6SXNzdWUzODQzOTgwNDE=,"Sorry, motif prediction tool MEME is not supported",CLOSED,2018-11-26T16:03:02Z,2018-12-04T07:16:18Z,2018-12-03T23:06:15Z,"This issue came up in #70  (@mdozmorov @jonasungerback)

It probably has to with the fact that for a while the Mac OS X conda build for meme didn't work, so the gimmemotifs package has disabled it by default. I will fix this for the next release. In the meantime you can edit the gimmemotifs config file (most likely `~/.config/gimmemotifs/gimmemotifs.cfg`), find the `[params]` section and add `MEME` to `available_tools`.",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/71
MDU6SXNzdWUzODQzOTg5NDU=,In case the input file format is not recognized print a nice error message.,CLOSED,2018-11-26T16:05:00Z,2018-12-03T23:06:16Z,2018-12-03T23:06:16Z,See #70. Now we get an `UnboundLocalError`.,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/72
MDU6SXNzdWUzOTE3NzQwMTI=,Output of gimme roc cannot be sorted on p-value,CLOSED,2018-12-17T15:52:04Z,2019-05-10T06:19:27Z,2019-05-10T06:19:27Z,"**Describe the bug**
When you sort the html output of `gimme roc` based on (adjusted) p-value, it does not sort correctly.
",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/73
MDU6SXNzdWUzOTIwOTI4NDY=,IndexError: list index out of range,CLOSED,2018-12-18T10:34:58Z,2022-06-12T14:40:29Z,2021-04-13T08:13:48Z,"Hi,

I'm using `maelstrom` function for identifying different motifs. I used the following command 

`~/miniconda2/bin/gimme maelstrom peaks_gimme.input ~/gencode-transcripts/hg19.fa peaks_combo_res`

but it returns the following error

```
Traceback (most recent call last):
  File ""/home/thatikon/miniconda2/bin/gimme"", line 518, in <module>
    args.func(args)
  File ""/home/thatikon/miniconda2/lib/python2.7/site-packages/gimmemotifs/commands/maelstrom.py"", line 27, in maelstrom
    run_maelstrom(infile, genome, outdir, pwmfile, methods=methods, ncpus=ncpus)
  File ""/home/thatikon/miniconda2/lib/python2.7/site-packages/gimmemotifs/maelstrom.py"", line 254, in run_maelstrom
    pwmfile=pwmfile, ncpus=ncpus)
  File ""/home/thatikon/miniconda2/lib/python2.7/site-packages/gimmemotifs/maelstrom.py"", line 71, in scan_to_table
    s.set_threshold(fpr=FPR, genome=genome)
  File ""/home/thatikon/miniconda2/lib/python2.7/site-packages/gimmemotifs/scanner.py"", line 412, in set_threshold
    fa = RandomGenomicFasta(genome, length, 10000)
  File ""/home/thatikon/miniconda2/lib/python2.7/site-packages/gimmemotifs/background.py"", line 352, in __init__
    create_random_genomic_bedfile(tmpbed, genome, length, n)
  File ""/home/thatikon/miniconda2/lib/python2.7/site-packages/gimmemotifs/background.py"", line 35, in create_random_genomic_bedfile
    features = Genome(genome).get_random_sequences(n, length)
  File ""/home/thatikon/miniconda2/lib/python2.7/site-packages/genomepy/functions.py"", line 485, in get_random_sequences
    chroms = _weighted_selection(l, n)
  File ""/home/thatikon/miniconda2/lib/python2.7/site-packages/genomepy/functions.py"", line 234, in _weighted_selection
    return [items[bisect.bisect(cuml, random.random()*total_weight)] for _ in range(n)]
IndexError: list index out of range
```
I'm using `v0.12.0`. Any help would be greatly appreciated.

Thank you.


",itsvenu,https://github.com/vanheeringen-lab/gimmemotifs/issues/74
MDU6SXNzdWU0MTM3OTI5MjM=,gimme index,CLOSED,2019-02-24T07:47:44Z,2019-10-14T09:30:14Z,2019-10-14T09:30:14Z,"
Hello:
 
I got an strange error after running `gimme index -h`

`usage: gimme [-h] <subcommand> [options]
gimme: error: invalid choice: 'index' (choose from 'motifs', 'match', 'maelstrom', 'roc', 'cluster', 'background', 'threshold', 'location', 'scan', 'diff', 'logo', 'prediction')`

And the manual said that I could create an index with `gimme index` command

",yongjieliu,https://github.com/vanheeringen-lab/gimmemotifs/issues/75
MDU6SXNzdWU0NDIyMDc3NDI=,Some background sequences start point is negative number,CLOSED,2019-05-09T12:20:55Z,2019-05-10T08:55:57Z,2019-05-10T08:55:57Z,"**Describe the bug**
When I chose XT9.1 (Xenopus_tropicalis_v9.1) as the genome, the genome random sequences always have some negative start sequences, for example: scaffold_2334 -99 100

/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/pyfaidx/\__init\__.py
```python
 617 def fetch(self, name, start, end):
 618         if self.read_ahead and not (name, start, end) in self:
 619             self.fill_buffer(name, start, end + self.read_ahead)
 620         print(name, start, end)                                                                                                                                                                               
 621         if (name, start, end) in self:
 622             seq = self.from_buffer(start, end)
 623         else:
 624             seq = self.from_file(name, start, end)
 625          
 626         return self.format_seq(seq, name, start, end)
 627
````
when I add line 620 in this function, it will print error line:
scaffold_2334 -99 100

**Error logs**
```bash 
 File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 569, in best_score
    for matches in self.scan(seqs, 1, scan_rc, normalize=normalize, gc=gc):
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 610, in scan
    self.set_meanstd(gc=gc)
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 354, in set_meanstd
    self.set_background(gc=gc)
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 451, in set_background
    fa = as_fasta(tmp.name, genome=genome)
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/gimmemotifs/utils.py"", line 613, in as_fasta
    genome.track2fasta(seqs, tmpfa.name)
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/genomepy/functions.py"", line 429, in track2fasta
    for seq in seqqer:
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/genomepy/functions.py"", line 382, in _bed_to_seqs
    seq = self.get_spliced_seq(chrom, intervals, rc)
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/pyfaidx/__init__.py"", line 1046, in get_spliced_seq
    chunks = [self.faidx.fetch(name, s, e) for s, e in intervals]
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/pyfaidx/__init__.py"", line 1046, in <listcomp>
    chunks = [self.faidx.fetch(name, s, e) for s, e in intervals]
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/pyfaidx/__init__.py"", line 624, in fetch
    seq = self.from_file(name, start, end)
  File ""/home/user/anaconda3/envs/regnetwork/lib/python3.6/site-packages/pyfaidx/__init__.py"", line 646, in from_file
    ""Requested start coordinate must be greater than 1."")
pyfaidx.FetchError: Requested start coordinate must be greater than 1.
```

**Installation information (please complete the following information):**
 - OS: [Linux]
 - Installation [conda]
 - Version [develop]

**Additional context**
Add any other context about the problem here.
",bioqxu,https://github.com/vanheeringen-lab/gimmemotifs/issues/76
MDU6SXNzdWU0NDgyMTIxNTM=,possible to use reference genome from bowtie?,CLOSED,2019-05-24T14:51:02Z,2019-10-14T09:08:33Z,2019-10-14T09:08:32Z,"Hi
GimmeMotifs has been installed on the cluster that I work on. But **to avoid taking up storage space**- it is preferred that I use a reference genome that is already installed- from bowtie.

I tried this:
`gimme scan ENCODE_ESC_peaks_formatted.fa -p jaspar.tab -g /..../ReferenceGenomes/Mus_musculus/UCSC/mm9/Sequence/WholeGenomeFasta/genome.fa -b > ENCODE_jaspar_gimme_motifs.bed`

But I got the error:

```
Genome not found. Have you installed your genome with genomepy?
See https://github.com/simonvh/genomepy for details.
Alternatively, you can specify a FASTA file.
```

Is it somehow possible to get gimme scan to search a genome from bowtie rather than install the genomepy one and use that?",chrisclarkson,https://github.com/vanheeringen-lab/gimmemotifs/issues/77
MDU6SXNzdWU0NTM4MDgzNTY=,Problem with gimme after updating the anaconda environment.,CLOSED,2019-06-08T16:01:08Z,2019-10-14T09:32:10Z,2019-10-14T09:32:10Z,"Hello,

I have run into some gimme issues after updating of the anaconda environment. The first related to `from scipy.misc import factorial` where factorial has now been moved to `scipy.special`. This is however an easy fix where I can easily downgrade scipy or change the code in rank.py line 12. However, after trying both, I get the following error (both on Mac and in Ubuntu and for both gimme motifs and gimme maelstrom) that I cannot resolve:

`Traceback (most recent call last):
  File ""/opt/anaconda3/envs/gimmemotifs/lib/python3.6/site-packages/genomepy/functions.py"", line 287, in __init__
    super(Genome, self).__init__(name)
  File ""/opt/anaconda3/envs/gimmemotifs/lib/python3.6/site-packages/pyfaidx/__init__.py"", line 996, in __init__
    build_index=build_index)
  File ""/opt/anaconda3/envs/gimmemotifs/lib/python3.6/site-packages/pyfaidx/__init__.py"", line 333, in __init__
    if filename.lower().endswith('.bgz') or filename.lower().endswith(
AttributeError: 'NoneType' object has no attribute 'lower'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/opt/anaconda3/envs/gimmemotifs/bin/gimme"", line 513, in <module>
    args.func(args)
  File ""/opt/anaconda3/envs/gimmemotifs/lib/python3.6/site-packages/gimmemotifs/commands/motifs.py"", line 69, in motifs
    gimme_motifs(args.inputfile, args.name, params)
  File ""/opt/anaconda3/envs/gimmemotifs/lib/python3.6/site-packages/gimmemotifs/denovo.py"", line 543, in gimme_motifs
    input_type, background = check_denovo_input(inputfile, params)
  File ""/opt/anaconda3/envs/gimmemotifs/lib/python3.6/site-packages/gimmemotifs/validation.py"", line 55, in check_denovo_input
    Genome(genome)
  File ""/opt/anaconda3/envs/gimmemotifs/lib/python3.6/site-packages/genomepy/functions.py"", line 290, in __init__
    if os.path.isdir(name) and len(glob.glob(os.path.join(name, ""*.fa""))) == 1 and genome_dir is not None:
  File ""/opt/anaconda3/envs/gimmemotifs/lib/python3.6/genericpath.py"", line 42, in isdir
    st = os.stat(s)
TypeError: stat: path should be string, bytes, os.PathLike or integer, not NoneType`

I can also mention that I fail to roll back one step in my anaconda revisions due to missing packages from the earlier revision so I am a little stuck. Is this something you can help out with?

Thanks in advance!

Best,
Jonas",jonasungerback,https://github.com/vanheeringen-lab/gimmemotifs/issues/78
MDU6SXNzdWU0Njg0MzY1OTI=,Syntax error when running gimme roc,CLOSED,2019-07-16T04:05:28Z,2019-12-06T14:49:36Z,2019-12-06T14:49:36Z,"**Describe the bug**
I have a virtual environment running Python 3.7.3 and used pip to install numpy and gimme. I tried running the following command:
gimme roc input.fasta bg.fa > enriched_motifs.txt

The following output was seen:
Traceback (most recent call last):
  File ""/path/to/bin/gimme"", line 6, in <module>
    from gimme.generator import main
  File ""/path/to/lib/python3.7/site-packages/gimme/__init__.py"", line 1, in <module>
    from .app import App
  File ""/path/to/lib/python3.7/site-packages/gimme/app.py"", line 3, in <module>
    from .routes import Routes
  File ""/path/to/lib/python3.7/site-packages/gimme/routes.py"", line 119
    except IndexError, e:
                     ^
SyntaxError: invalid syntax

**To Reproduce**
1. Create a new pip virtual environment with Python 3
2. Run pip install numpy
3. Run pip install gimme
4. Try gimme roc input.fasta bg.fa > enriched_motifs.txt

**Expected behavior**
Enriched motifs listed in the output text file.

**Error logs**
Error logs listed above

**Installation information (please complete the following information):**
 - OS: macOS Mojave
 - Installation: pip
 - Version: pip 19.1.1, Python 3.7",preethiperi,https://github.com/vanheeringen-lab/gimmemotifs/issues/79
MDU6SXNzdWU1MDM1OTk0MDc=,Problem running gimme scan,CLOSED,2019-10-07T17:52:30Z,2019-10-15T15:15:05Z,2019-10-15T15:15:05Z,"**Describe the bug**
I'd like to annotate the directionality of some CTCF motif. I'm using  ```gimme scan MK_CTCF_From_Romina_hg38_c10.0_l245_g100_peaks -p CTCF.pwm -g hg38 -b > CTCF_motifs.bed``` command, but I get this error message:

>  Traceback (most recent call last):
  File ""/Users/luca/anaconda3/envs/gimme/bin/gimme"", line 513, in <module>
    args.func(args)
  File ""/Users/luca/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/pwmscan.py"", line 170, in pwmscan
    normalize=args.zscore,
  File ""/Users/luca/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/pwmscan.py"", line 113, in command_scan
    fa = as_fasta(inputfile, genome)
  File ""/Users/luca/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/utils.py"", line 613, in as_fasta
    genome.track2fasta(seqs, tmpfa.name) 
  File ""/Users/luca/anaconda3/envs/gimme/lib/python3.6/site-packages/genomepy/functions.py"", line 466, in track2fasta
    track_type = get_track_type(track)
  File ""/Users/luca/anaconda3/envs/gimme/lib/python3.6/site-packages/genomepy/functions.py"", line 231, in get_track_type
    if isinstance(track, []):
TypeError: isinstance() arg 2 must be a type or tuple of types

Do you have any suggestion to sort it out?

**To Reproduce:**
genome path is: ```.//.local/share/genomes/hg38/hg38.fa ```

this is the structure of my bed file:
> chr1:16100-16375
chr1:103922-104996
chr1:138811-139325
chr1:267382-268156
chr1:609167-610766
chr1:665825-666188
chr1:778686-779058
chr1:857890-858227
chr1:869737-870095
chr1:904592-904947

This is the pwm file I extracted from the motif_database:
>CTCF_known1 CTCF_1 CTCF_jaspar_MA0139.1
Y 0.095290 0.318729 0.083242 0.502738
D 0.182913 0.158817 0.453450 0.204819
R 0.307777 0.053669 0.491785 0.146769
C 0.061336 0.876232 0.023001 0.039430
C 0.008762 0.989047 0.000000 0.002191
A 0.814896 0.014239 0.071194 0.099671
S 0.043812 0.578313 0.365827 0.012048
Y 0.117325 0.474781 0.052632 0.355263
A 0.933114 0.012061 0.035088 0.019737
G 0.005488 0.000000 0.991218 0.003293
R 0.365532 0.003293 0.621295 0.009879
K 0.059276 0.013172 0.553238 0.374314
G 0.013187 0.000000 0.978022 0.008791
G 0.061538 0.008791 0.851648 0.078022
C 0.114411 0.806381 0.005501 0.073707
R 0.409241 0.014301 0.557756 0.018702
S 0.090308 0.530837 0.338106 0.040749
Y 0.128855 0.354626 0.080396 0.436123
V 0.442731 0.199339 0.292952 0.064978

I install the gimmemotifs package using conda with this command: ```conda create -n gimme python=3 gimmemotifs``` no more than a week ago. I saw there have been few probelm with the conda update.

```conda info``` gives:

>      active environment : gimme
    active env location : /Users/luca/anaconda3/envs/gimme
            shell level : 2
       user config file : /Users/luca/.condarc
 populated config files : /Users/luca/.condarc
          conda version : 4.7.12
    conda-build version : 3.18.8
         python version : 3.7.3.final.0
       virtual packages : 
       base environment : /Users/luca/anaconda3  (writable)
           channel URLs : https://conda.anaconda.org/conda-forge/osx-64
                          https://conda.anaconda.org/conda-forge/noarch
                          https://conda.anaconda.org/bioconda/osx-64
                          https://conda.anaconda.org/bioconda/noarch
                          https://repo.anaconda.com/pkgs/main/osx-64
                          https://repo.anaconda.com/pkgs/main/noarch
                          https://repo.anaconda.com/pkgs/r/osx-64
                          https://repo.anaconda.com/pkgs/r/noarch
          package cache : /Users/luca/anaconda3/pkgs
                          /Users/luca/.conda/pkgs
       envs directories : /Users/luca/anaconda3/envs
                          /Users/luca/.conda/envs
               platform : osx-64
             user-agent : conda/4.7.12 requests/2.22.0 CPython/3.7.3 Darwin/18.7.0 OSX/10.14.6
                UID:GID : 501:20
             netrc file : None
           offline mode : False

and ```conda list```:

> #
# Name                    Version                   Build  Channel
_py-xgboost-mutex         2.0                       cpu_0    conda-forge
appdirs                   1.4.3                      py_1    conda-forge
asn1crypto                0.24.0                py36_1003    conda-forge
bcftools                  1.8                  h4da6232_3    bioconda
bedtools                  2.29.0               ha290c19_1    bioconda
boltons                   19.1.0                     py_0    conda-forge
bucketcache               0.12.1                   py36_1    conda-forge
bzip2                     1.0.8                h01d97ff_1    conda-forge
ca-certificates           2019.9.11            hecc5488_0    conda-forge
certifi                   2019.6.16                py36_1    conda-forge
cffi                      1.12.3           py36hccf1714_0    conda-forge
chardet                   3.0.4                 py36_1003    conda-forge
click                     7.0                        py_0    conda-forge
cryptography              2.7              py36h212c5bf_0    conda-forge
curl                      7.65.3               h22ea746_0    conda-forge
cycler                    0.10.0                     py_1    conda-forge
decorator                 4.4.0                      py_0    conda-forge
diskcache                 4.0.0                      py_0    conda-forge
expat                     2.2.5             h6de7cb9_1003    conda-forge
feather-format            0.3.1                    py36_1    conda-forge
freetype                  2.10.0               h24853df_1    conda-forge
future                    0.17.1                py36_1000    conda-forge
gadem                     1.3.1                h470a237_1    bioconda
genomepy                  0.6.0                      py_0    bioconda
ghostscript               9.22              h0a44026_1001    conda-forge
gimmemotifs               0.13.1           py36h01d97ff_3    bioconda
homer                     4.10            pl526h770b8ee_0    bioconda
htslib                    1.7                           0    bioconda
icu                       64.2                 h6de7cb9_1    conda-forge
idna                      2.8                   py36_1000    conda-forge
jinja2                    2.10.1                     py_0    conda-forge
joblib                    0.14.0                     py_0    conda-forge
jpeg                      9c                h1de35cc_1001    conda-forge
kiwisolver                1.1.0            py36h770b8ee_0    conda-forge
krb5                      1.16.3            hcfa6398_1001    conda-forge
libblas                   3.8.0               12_openblas    conda-forge
libcblas                  3.8.0               12_openblas    conda-forge
libcurl                   7.65.3               h16faf7d_0    conda-forge
libcxx                    9.0.0                         0    conda-forge
libcxxabi                 9.0.0                         0    conda-forge
libdeflate                1.3                  h01d97ff_0    conda-forge
libedit                   3.1.20170329      hcfe32e1_1001    conda-forge
libffi                    3.2.1             h6de7cb9_1006    conda-forge
libgcc                    4.8.5               hdbeacc1_10    conda-forge
libgfortran               3.0.1                         0    conda-forge
libiconv                  1.15              h01d97ff_1005    conda-forge
liblapack                 3.8.0               12_openblas    conda-forge
libopenblas               0.3.7                hd44dcd8_1    conda-forge
libpng                    1.6.37               h2573ce8_0    conda-forge
libssh2                   1.8.2                hcdc9a53_2    conda-forge
libtiff                   4.0.10            hd08fb8f_1003    conda-forge
libuuid                   2.32.1            h1de35cc_1000    conda-forge
libxgboost                0.90                 h6de7cb9_2    conda-forge
libxml2                   2.9.9                h12c6b28_5    conda-forge
libxslt                   1.1.33               h320ff13_0    conda-forge
llvm-openmp               9.0.0                h40edb58_0    conda-forge
logbook                   1.4.3            py36h01d97ff_0    conda-forge
lz4-c                     1.8.3             h6de7cb9_1001    conda-forge
markupsafe                1.1.1            py36h1de35cc_0    conda-forge
matplotlib                3.1.1                    py36_1    conda-forge
matplotlib-base           3.1.1            py36h3a684a6_1    conda-forge
meme                      4.12.0          py36pl526hd869df4_2    bioconda
mysql-connector-c         6.1.11            h42c63d9_1003    conda-forge
ncurses                   6.1               h0a44026_1002    conda-forge
norns                     0.1.5                      py_0    bioconda
nose                      1.3.7                 py36_1002    conda-forge
numpy                     1.17.2           py36h6b0580a_0    conda-forge
olefile                   0.46                       py_0    conda-forge
openjdk                   11.0.1            h01d97ff_1017    conda-forge
openssl                   1.1.1c               h01d97ff_0    conda-forge
pandas                    0.25.1           py36h86efe34_0    conda-forge
pathlib                   1.0.1                      py_1    conda-forge
patsy                     0.5.1                      py_0    conda-forge
perl                      5.26.2            haec8ef5_1006    conda-forge
perl-algorithm-cluster    1.58            pl526h1de35cc_0    bioconda
perl-carp                 1.38                    pl526_3    bioconda
perl-cgi                  4.40            pl526h470a237_0    bioconda
perl-constant             1.33                    pl526_1    bioconda
perl-exporter             5.72                    pl526_1    bioconda
perl-extutils-makemaker   7.36                    pl526_1    bioconda
perl-html-parser          3.72            pl526h04f5b5a_5    bioconda
perl-html-tagset          3.20                    pl526_3    bioconda
perl-html-template        2.97                    pl526_1    bioconda
perl-html-tree            5.07                    pl526_1    bioconda
perl-scalar-list-utils    1.52            pl526h01d97ff_0    bioconda
perl-xml-namespacesupport 1.12                    pl526_0    bioconda
perl-xml-parser           2.44_01         pl526h4c9d1cc_1002    conda-forge
perl-xml-sax              0.99                    pl526_1    bioconda
perl-xml-sax-base         1.09                    pl526_0    bioconda
perl-xml-sax-expat        0.51                    pl526_3    bioconda
perl-xml-simple           2.25                    pl526_1    bioconda
perl-xsloader             0.24                    pl526_0    bioconda
perl-yaml                 1.29                    pl526_0    bioconda
pillow                    6.2.0            py36hb6f49c9_0    conda-forge
pip                       19.2.3                   py36_0    conda-forge
py-xgboost                0.90             py36h6de7cb9_2    conda-forge
pybedtools                0.8.0            py36h5c9b4e4_1    bioconda
pycparser                 2.19                     py36_1    conda-forge
pyfaidx                   0.5.5.2                    py_1    bioconda
pyopenssl                 19.0.0                   py36_0    conda-forge
pyparsing                 2.4.2                      py_0    conda-forge
pysam                     0.14.1           py36hae42fb6_1    bioconda
pysocks                   1.7.1                    py36_0    conda-forge
python                    3.6.7             h94afb7f_1005    conda-forge
python-dateutil           2.8.0                      py_0    conda-forge
python-xxhash             1.3.0            py36h1de35cc_0    conda-forge
pytz                      2019.2                     py_0    conda-forge
pyyaml                    5.1.2            py36h01d97ff_0    conda-forge
readline                  8.0                  hcfe32e1_0    conda-forge
represent                 1.6.0            py36h01d97ff_0    conda-forge
requests                  2.22.0                   py36_1    conda-forge
samtools                  1.7                           1    bioconda
scikit-learn              0.21.3           py36hd4ffd6c_0    conda-forge
scipy                     1.2.1            py36hbd7caa9_1    conda-forge
seaborn                   0.9.0                      py_1    conda-forge
setuptools                41.2.0                   py36_0    conda-forge
six                       1.12.0                py36_1000    conda-forge
sklearn-contrib-lightning 0.5.0                    py36_0    conda-forge
sqlite                    3.29.0               hb7d70f7_1    conda-forge
statsmodels               0.10.1           py36heacc8b8_0    conda-forge
tk                        8.6.9             h2573ce8_1003    conda-forge
tornado                   6.0.3            py36h01d97ff_0    conda-forge
tqdm                      4.36.1                     py_0    conda-forge
trawler                   2.0                     pl526_2    bioconda
ucsc-bedtogenepred        377                  he2eb843_0    bioconda
ucsc-bigbedtobed          366                  h1341992_0    bioconda
ucsc-genepredtobed        377                  he2eb843_2    bioconda
ucsc-genepredtogtf        377                  he2eb843_2    bioconda
ucsc-gff3togenepred       366                  h1341992_0    bioconda
ucsc-gtftogenepred        377                  he2eb843_2    bioconda
urllib3                   1.25.6                   py36_0    conda-forge
weeder                    2.0                  h04f5b5a_3    bioconda
wheel                     0.33.6                   py36_0    conda-forge
xdg                       3.0.2                         0    conda-forge
xgboost                   0.90             py36h6de7cb9_2    conda-forge
xmltodict                 0.12.0                     py_0    conda-forge
xxmotif                   1.6                           0    bioconda
xz                        5.2.4             h1de35cc_1001    conda-forge
yaml                      0.1.7             h1de35cc_1001    conda-forge
zlib                      1.2.11            h01d97ff_1006    conda-forge
zstd                      1.4.0                ha9f0a20_0    conda-forge



I'm running it on MacOS Mojave version 10.14.6

Hope you can help me out.
Thanks in advance.",stefanucci-luca,https://github.com/vanheeringen-lab/gimmemotifs/issues/80
MDU6SXNzdWU1MDgzMjUxMjY=,gimme maelstrom crashes,CLOSED,2019-10-17T08:42:29Z,2019-12-05T11:51:55Z,2019-12-05T11:51:55Z,"**Describe the bug**

`gimme maelstrom` crashes with a strange error message.


**To Reproduce**

Unknown, may be related to large number of input regions. 

**Error logs**

![unnamed](https://user-images.githubusercontent.com/281252/66992305-e013d680-f0c9-11e9-9ed4-9ea8e119fc60.png)",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/81
MDU6SXNzdWU1MTA1MDkxMjc=,Outdated dependency: scipy.misc,CLOSED,2019-10-22T08:39:31Z,2019-11-20T17:26:46Z,2019-10-22T11:44:25Z,"**Describe the bug**
Scipy.misc is deprecated and replaced with scipy.special (as shown [here](https://docs.scipy.org/doc/scipy-1.2.1/reference/generated/scipy.misc.factorial.html))

**To Reproduce**
Steps to reproduce the behavior:
1) install gimme motifs
2) initiate (for reference, I did this with `$gimme motif --help`)

**Expected behavior & Error logs**
![image](https://user-images.githubusercontent.com/48289046/67269937-ed5d0680-f4b7-11e9-998e-b4c8750f5e55.png)

**Installation information (please complete the following information):**
 - OS: Ubuntu 18.04
 - Installation conda (manual from conda cloud)
 - Version 0.13.1 

**Additional context**
The error refers to gimme maelstrom (see image). Might be related to issue #81.
",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/82
MDU6SXNzdWU1MTA1Mjc4Mjg=,bug in determine_file_type,CLOSED,2019-10-22T09:16:24Z,2019-12-05T11:51:54Z,2019-12-05T11:51:54Z,"**Describe the bug**
In utils.py, function determine_file_type tries to call file type by using function [os.path.splitext](https://docs.python.org/2/library/os.path.html) and comparing the extension to a list of extensions.

snippet:
```
    ext = os.path.splitext(fname)[1].lower()
    if ext in [""bed""]:
        return ""bed""
```

However, `os.path.splitext` returns '.bed' rather than 'bed'. Thus no hit is found.
Add the period to fix the issue:

```
    ext = os.path.splitext(fname)[1].lower()
    if ext in ["".bed""]:
        return ""bed""
    elif ext in ["".fa"", "".fasta""]:
        return ""fasta""
    elif ext in ["".narrowpeak""]:
        return ""narrowpeak""
```",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/83
MDU6SXNzdWU1MTA1NjU3NTc=,Hidden file dependency: genome.gaps.bed,CLOSED,2019-10-22T10:30:47Z,2019-12-06T16:11:24Z,2019-12-06T16:11:24Z,"**description**
`gimme scan` requires a genome.gaps.bed to be present in the same folder as the genome. This requirement originates from genomepy > functions.py > gap_sizes.

_Placing this issue here as it also affects gimme motifs (feel free to close it if this makes no sense!). Will attempt to fix in Genomepy._

**additional info**
When installing a genome with Genomepy, there is apparently [a plugin](https://github.com/simonvh/genomepy/blob/master/genomepy/plugins/gaps.py) that can create this gaps.bed file. For other genomes (or without the plugin active), this is not done. And there seems to be no command to do this manually.

**solution**
An optimal solution would be if gap_sizes would check for existence of the file, and runs this plugin if it does not.",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/85
MDU6SXNzdWU1MTExODIzNzg=,Find all occurrences of motifs in the genome,CLOSED,2019-10-23T09:06:17Z,2021-04-13T08:14:37Z,2021-04-13T08:14:37Z,"Hi Simon,

the title of the issue is pretty self-explanatory: I am trying to find all the occurrences (positions) of a custom list of motifs (PWMs file) in the genome (Zebrafish if it matters). The overarching goal is to determine if a particular group of motifs is overrepresented in a (very large) region of the genome.  

For that I thought of using `gimme scan`. However after a couple of tries, and reading the docs, I am not sure if it (i) thi is the right tool for the job; or (ii) if I am using it correctly. For instance I divided the genome into large portions and ran:

```bash
gimme scan zv9.50kb_windows.bed --pwmfile Filtered_pmw.txt -g  genome.fasta -f 0.05 --bed > motifs_locations.bed
```
This finds the genomic location of some motifs, but not all the expected positions. I am assuming that this is because the genome is being used a background control against itself. 

Am I going about this the right way and do you have any suggestions?",adomingues,https://github.com/vanheeringen-lab/gimmemotifs/issues/86
MDU6SXNzdWU1MTEzNTYyMDY=,Bug on gimme background when narrowPeak file is used,CLOSED,2019-10-23T14:18:57Z,2019-12-06T14:45:28Z,2019-12-06T14:45:28Z,"I wanted to compute background for my sequences, as I ran gimme background for it, but get suddenly smth about not enough sequences with GC between 0.9 and 0.95.
I must tell you, that I work with Dictiostelium genome, it is extremely GC-poor and such a high value is quite strange.

But then I got the idea that it is possible to be mismatched with AT-content. And I have found that in output file first columns of bedtools nuc is your input, but as I had narrowPeak file, it used all 4 columns and then put 5th column as AT-content. In line 202 of **gimmemotifs/background.py** you put 4 but in my file it should be 5.
To prevent future mistakes I ask you to deal with it narrowPeak files or with bedtools nuc header to use the right column to future work.

All the best!

Irina Zhegalova,
PhD student at Moscow State University",irzhegalova,https://github.com/vanheeringen-lab/gimmemotifs/issues/87
MDU6SXNzdWU1MTI2NjU3NDA=,Fasta parser class fails if the description contains '>' character,CLOSED,2019-10-25T18:50:17Z,2019-12-05T11:51:54Z,2019-12-05T11:51:54Z,"Hello, 
I was experimenting with some custom segments from a genome, which I put into a fasta file using biopython. Biopython defaults to <Unknown id> <Unknown description> if I provide neither, so I have description lines that look like
`><unknown id> <unknown description>`
which breaks the fasta parser apparently, so I can't get past `divide_fa_file()` part unless I 'fix' my descriptions. 

Perhaps there is some value in using a standard library like SeqIO from biopython to avoid this kind of edge case problems? ",littleblackfish,https://github.com/vanheeringen-lab/gimmemotifs/issues/88
MDU6SXNzdWU1MTI2Njc3MDM=,Trawler capitalization issue in initial config,CLOSED,2019-10-25T18:54:21Z,2019-12-05T11:51:54Z,2019-12-05T11:51:54Z,"When the initial config is generated in the first run, in my case trawler was specified in all lower case (i.e. 'trawler') in available_tools, but first case capitalized in the section name (i.e. [Trawler]). 

I needed to manually correct it to clear the 'tool not supported' error before being able to do anything useful.",littleblackfish,https://github.com/vanheeringen-lab/gimmemotifs/issues/89
MDU6SXNzdWU1MTM3Njc3Mjk=,Use biopython for FASTA parsing,OPEN,2019-10-29T08:40:22Z,2019-10-29T08:40:53Z,,"See #88. 

Replace the custom FASTA for the robust implementation from Biopython. We should keep the custom `Fasta()` class, as this implements some additional functionality that we need, but the actual parsing could use `SeqIO`. Biopython is already pulled in as a dependency of genomepy, so no additional dependencies are introduced.",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/91
MDU6SXNzdWU1MTYwNDA2MDM=,Include a table with matches with `gimme motifs`,CLOSED,2019-11-01T10:45:31Z,2021-04-13T08:16:06Z,2021-04-13T08:16:06Z,"For all motifs that are analyzed with `gimme motifs` (both known and novel), the output report should contain a link to a file with matching sequences and locations. This is a feature that people often look for, now they have to run a separate `gimme scan`.",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/92
MDU6SXNzdWU1MTY3ODYyNzk=,p-value for seqcor metric,OPEN,2019-11-03T06:11:49Z,2020-02-13T06:36:21Z,,Currently comparing two motifs with `seqcor()` doesn't generate a p-value. The score distributions for `seqcor()` need to be generated.,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/93
MDU6SXNzdWU1MTkxMjM4MjY=,Use chromalog for colored logging,CLOSED,2019-11-07T08:48:26Z,2019-12-09T11:06:58Z,2019-12-09T11:06:58Z,https://chromalog.readthedocs.io/en/latest/,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/94
MDU6SXNzdWU1Mjk5MDQ0MzM=,Python version,CLOSED,2019-11-28T13:11:18Z,2019-11-28T13:42:24Z,2019-11-28T13:42:24Z,"The bioconda recipe seems to only work with py3.6, which I think is caused by the requirement of `scipy < 1.3.0`. This requirement is in the development branch and the bioconda recipe.

Why is this? Gimmemotifs does not seem to use any of the backward incompatible changes:
https://docs.scipy.org/doc/scipy/reference/release.1.3.0.html#scipy-1-3-0-release-notes
",Maarten-vd-Sande,https://github.com/vanheeringen-lab/gimmemotifs/issues/95
MDU6SXNzdWU1MzQwNDQ2MDM=,Improve logging,OPEN,2019-12-06T14:49:29Z,2019-12-06T14:49:29Z,,"- [ ] Use [loguru](https://github.com/Delgan/loguru) for simplified logging. 
- [ ] Use loguru to catch all exceptions in the logging.
- [ ] Have a command-line option to change the loglevel (see #79)",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/96
MDU6SXNzdWU1MzY1NzU3MTg=,gimme motifs ... bedtools error,CLOSED,2019-12-11T19:41:59Z,2023-01-19T08:54:11Z,2023-01-19T08:54:11Z,"**Describe the bug**
Motif enrichment with ""gimme motifs"" resulted in bedtools error:

2019-12-11 19:36:10,744 - INFO - No config found.
2019-12-11 19:36:10,744 - INFO - Creating new config.
2019-12-11 19:36:10,747 - INFO - Using included version of MDmodule.
2019-12-11 19:36:10,756 - INFO - Using system version of MEME.
2019-12-11 19:36:10,763 - INFO - Using system version of MEMEW.
2019-12-11 19:36:10,770 - INFO - Using system version of DREME.
2019-12-11 19:36:10,776 - INFO - Using system version of Weeder.
2019-12-11 19:36:10,782 - INFO - Using system version of GADEM.
2019-12-11 19:36:10,783 - INFO - Using included version of MotifSampler.
2019-12-11 19:36:10,792 - INFO - Using system version of Trawler.
2019-12-11 19:36:10,792 - INFO - Using included version of Improbizer.
2019-12-11 19:36:10,792 - INFO - Using included version of BioProspector.
2019-12-11 19:36:10,792 - INFO - Using included version of Posmo.
2019-12-11 19:36:10,793 - INFO - Using included version of ChIPMunk.
2019-12-11 19:36:10,793 - INFO - Using included version of AMD.
2019-12-11 19:36:10,793 - INFO - Using included version of HMS.
2019-12-11 19:36:10,802 - INFO - Using system version of Homer.
2019-12-11 19:36:10,808 - INFO - Using system version of XXmotif.
2019-12-11 19:36:10,816 - INFO - Using system version of ProSampler.
2019-12-11 19:36:10,817 - WARNING - Yamda not in config
2019-12-11 19:36:10,825 - INFO - Using system version of DiNAMO.
2019-12-11 19:36:10,837 - WARNING - RPMCMC not found. To include it you will have to install it.
2019-12-11 19:36:10,838 - INFO - Configuration file: /home/kopardevn/.config/gimmemotifs/gimmemotifs.cfg
2019-12-11 19:36:11,024 - INFO - creating background (matched GC%)
2019-12-11 19:36:57,722 - INFO - Creating index for genomic GC frequencies.
Traceback (most recent call last):
  File ""/opt2/conda/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/motifs.py"", line 75, in motifs
    number=10000,
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 122, in create_background_file
    m = MatchedGcFasta(inputfile, genome, number=number, size=size)
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 548, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 512, in matched_gc_bedfile
    min_bin_size=min_bin_size,
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 387, in gc_bin_bedfile
    create_gc_bin_index(genome, fname, min_bin_size=min_bin_size)
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 331, in create_gc_bin_index
    fi=fasta
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/pybedtools/bedtool.py"", line 840, in decorated
    result = method(self, *args, **kwargs)
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/pybedtools/bedtool.py"", line 345, in wrapped
    decode_output=decode_output,
  File ""/opt2/conda/envs/gimme/lib/python3.6/site-packages/pybedtools/helpers.py"", line 434, in call_bedtools
    raise BEDToolsError(subprocess.list2cmdline(cmds), stderr)
pybedtools.helpers.BEDToolsError:
Command was:

	bedtools nuc -fi /data2/hg38.fasta -bed /tmp/pybedtools.77gsq__0.tmp

Error message was:
Error: malformed BED entry at line 225325. Start was greater than end. Exiting.

**To Reproduce**
Steps to reproduce the behavior:
gimme motifs /data2/MCF7.idr.filt.narrowPeak /data2/MCF7.idr.filt.narrowPeak_gimmemotifs --known -g /data2/hg38.fasta

**Expected behavior**
I was expecting creation of MCF7.idr.filt.narrowPeak_gimmemotifs folder with output files

**Error logs**
If applicable, add error logs to help explain your problem.

**Installation information (please complete the following information):**
 - OS: Linux, centos os
 - Installation conda inside singularity container
 - Version 0.14.0

**Additional context**
Add any other context about the problem here.
",kopardev,https://github.com/vanheeringen-lab/gimmemotifs/issues/97
MDU6SXNzdWU1MzgzMTQwMDM=,One or more setup errors occured  after installing gimme using  'conda create -n gimme python=3 gimmemotifs,CLOSED,2019-12-16T10:15:36Z,2023-01-19T08:53:46Z,2023-01-19T08:53:46Z,"**Describe the bug**
A clear and concise description of what the bug is.
>>
File ""${mypath}/cli.py"",line 179, in cli
).format(params[""size""]),
KeyError:'size'
did it mean that the key 'size' do not  exist ?
>>

**To Reproduce**
Steps to reproduce the behavior:
when I ran `gimme motifs -h` ,the error was what I said 
>>
KeyError:'size'


**Expected behavior**
A clear and concise description of what you expected to happen.

First of all,really thanks for your help,and how could I fix this error?

**Error logs**
If applicable, add error logs to help explain your problem.

There are several errors before the above one appears .The former problems have been solved while latter one is under handling.So ,I will list those steps and those errors.
First ,install this software using conda 
>>conda create -n gimme python=3 gimmemotifs
>>conda activate gimme
Error one:
from tqdm.auto import tqdm
ModuleNotFoundError: No module named 'tqdm.auto'
>>
So ,I installed the  'tqdm' using  command line `pip  install tqdm` ,and then systems display:
>>
Requirement already satisfied: tqdm in ./envs/gimme/lib/python3.6/site-packages/tqdm-4.7.2-py3.6.egg (4.7.2)
>>
it was a file ,not a package.So ,I deleted that file ,and re-did `pip  install tqdm`.The systems display:
>>
Collecting tqdm
  Using cached https://files.pythonhosted.org/packages/7f/32/5144caf0478b1f26bd9d97f510a47336cf4ac0f96c6bc3b5af20d4173920/tqdm-4.40.2-py2.py3-none-any.whl
ERROR: gimmemotifs 0.14.0 requires configparser, which is not installed.
ERROR: gimmemotifs 0.14.0 requires xgboost>=0.71, which is not installed.
Installing collected packages: tqdm
Successfully installed tqdm-4.40.2
>>
then ,I install those packages using command line:
`pip  install  configparser`
`pip  install  xgboost`
>>
Collecting xgboost
  Downloading https://files.pythonhosted.org/packages/c1/24/5fe7237b2eca13ee0cfb100bec8c23f4e69ce9df852a64b0493d49dae4e0/xgboost-0.90-py2.py3-none-manylinux1_x86_64.whl (142.8MB)
     |████████████████████████████████| 142.8MB 231kB/s
Requirement already satisfied: scipy in ./Miniconda2/envs/gimme/lib/python3.6/site-packages (from xgboost) (1.3.2)
Requirement already satisfied: numpy in ./Miniconda2/envs/gimme/lib/python3.6/site-packages (from xgboost) (1.17.3)
Installing collected packages: xgboost
Successfully installed xgboost-0.90
>>
Then ,i ran `gimme motifs -h` ,the error was what I said 
>>
KeyError:'size'


**Installation information (please complete the following information):**
 - Linux: [e.g. OSX, Linux]
 - Installation :condacreate -n gimme python=3 gimmemotifs   [e.g. conda]
 - Version  0.14.0 [e.g. 0.13.0]

**Additional context**
Add any other context about the problem here.
",Vickismemo,https://github.com/vanheeringen-lab/gimmemotifs/issues/98
MDU6SXNzdWU1MzkxNzkwOTE=,Gimmemotifs not updating to 0.14 with conda,CLOSED,2019-12-17T16:32:47Z,2023-01-19T08:53:21Z,2023-01-19T08:53:21Z,"**Describe the bug**
I tried to update gimmemotifs to its latest version (0.14.0) with `conda update gimmemotifs`, but it reports that the latest version is already installed and does not proceed further. This is not true according to `conda info`: version 0.13.1 is installed, not 0.14.0.

Interestingly, `conda search gimmemotifs` found that 0.14.0 is available on the bioconda channel. If I force installation of said version with `conda install gimmemotifs=0.14.0`, it is installed successfully. However, as reported in another post, the program won't run because of dependency issues with `tqdm`.

**To Reproduce**
conda update gimmemotifs

**Expected behavior**
Conda should install the latest available version of gimmemotifs, but instead it get stuck at version 0.13.1.

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: conda
 - Version: 0.13.1
",Rmulet,https://github.com/vanheeringen-lab/gimmemotifs/issues/99
MDU6SXNzdWU1NTE1NDg4OTk=,can not install gimmemotifs,CLOSED,2020-01-17T17:46:18Z,2021-04-13T08:18:15Z,2021-04-13T08:18:15Z,"when I try to install gimmemotifs with conda in python3.7 version,  (`conda install -c bioconda gimmemotifs`)
I met a lot of errors:
Collecting package metadata (current_repodata.json): done
Solving environment: failed with initial frozen solve. Retrying with flexible solve.
Solving environment: failed with repodata from current_repodata.json, will retry with next repodata source.
Collecting package metadata (repodata.json): done
Solving environment: failed with initial frozen solve. Retrying with flexible solve.
Solving environment: | 
Found conflicts! Looking for incompatible packages.                                                                             failed                                                                                                                              
                                                                                                                                  
UnsatisfiableError: The following specifications were found                                                                       
to be incompatible with the existing python installation in your environment:

Specifications:

  - gimmemotifs -> python=2.7
  - gimmemotifs -> python[version='<3|>=2.7,<2.8.0a0']

Your python: python=3.7

If python is on the left-most side of the chain, that's the version you've asked for.
When python appears to the right, that indicates that the thing on the left is somehow
not available for the python version you are constrained to. Note that conda will not
change your python version to a different minor version unless you explicitly specify
that.

The following specifications were found to be incompatible with each other:
Package setuptools conflicts for:
python=3.7 -> pip -> setuptools
gimmemotifs -> jinja2 -> setuptools
Package pip conflicts for:
gimmemotifs -> python=2.7 -> pip
python=3.7 -> pip
Package certifi conflicts for:
gimmemotifs -> jinja2 -> setuptools -> certifi[version='>=2016.09|>=2016.9.26']
python=3.7 -> pip -> setuptools -> certifi[version='>=2016.09|>=2016.9.26']
Package wheel conflicts for:
python=3.7 -> pip -> wheel
gimmemotifs -> python=2.7 -> pip -> wheel
Package python-dateutil conflicts for:
gimmemotifs -> pybedtools -> pandas -> python-dateutil[version='>=2.5.*']
Package ca-certificates conflicts for:
python=3.7 -> openssl[version='>=1.1.1c,<1.1.2a'] -> ca-certificates
gimmemotifs -> python=2.7 -> ca-certificates

do you know how to resolve this issue?
best,
",BenxiaHu,https://github.com/vanheeringen-lab/gimmemotifs/issues/101
MDU6SXNzdWU1NTQxNDMyMTA=,ImportError: dlopen: cannot load any more object with static TLS,CLOSED,2020-01-23T13:02:27Z,2020-01-31T07:29:51Z,2020-01-31T07:29:51Z,"**To Reproduce**
```
conda create -n test1 python=3 gimmemotifs
conda activate test1 
gimme -h 
```

> Traceback (most recent call last):
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/bin/gimme"", line 8, in <module>
>     from gimmemotifs.cli import cli
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/lib/python3.6/site-packages/gimmemotifs/cli.py"", line 11, in <module>
>     from gimmemotifs import commands, __version__
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/lib/python3.6/site-packages/gimmemotifs/commands/__init__.py"", line 15, in <module>
>     ""{0}.{1}"".format(__name__, cmdname), globals(), locals(), [cmdname], level
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/lib/python3.6/site-packages/gimmemotifs/commands/background.py"", line 8, in <module>
>     from gimmemotifs.background import create_background_file
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/lib/python3.6/site-packages/gimmemotifs/background.py"", line 36, in <module>
>     from gimmemotifs.utils import number_of_seqs_in_file, as_fasta
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/lib/python3.6/site-packages/gimmemotifs/utils.py"", line 36, in <module>
>     from gimmemotifs.rocmetrics import ks_pvalue
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/lib/python3.6/site-packages/gimmemotifs/rocmetrics.py"", line 14, in <module>
>     from sklearn.metrics import (
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/lib/python3.6/site-packages/sklearn/__init__.py"", line 83, in <module>
>     from .utils._show_versions import show_versions
>   File ""/mbshome/mkolmus/anaconda3/envs/test1/lib/python3.6/site-packages/sklearn/utils/_show_versions.py"", line 12, in <module>
>     from ._openmp_helpers import _openmp_parallelism_enabled
> ImportError: dlopen: cannot load any more object with static TLS
> 


**Installation information (please complete the following information):**
 - OS:  Linux
 - Installation conda

> # packages in environment at /mbshome/mkolmus/anaconda3/envs/test1:
> #
> # Name                    Version                   Build  Channel
> _libgcc_mutex             0.1                 conda_forge    conda-forge
> _openmp_mutex             4.5                       0_gnu    conda-forge
> _py-xgboost-mutex         2.0                       cpu_0    conda-forge
> alsa-lib                  1.1.5             h516909a_1002    conda-forge
> appdirs                   1.4.3                      py_1    conda-forge
> arrow-cpp                 0.15.1           py36h982ac2c_6    conda-forge
> attrs                     19.3.0                     py_0    conda-forge
> backcall                  0.1.0                      py_0    conda-forge
> backports                 1.0                        py_2    conda-forge
> bedtools                  2.29.2               hc088bd4_0    bioconda
> biopython                 1.76             py36h516909a_0    conda-forge
> bleach                    3.1.0                      py_0    conda-forge
> boltons                   20.0.0                     py_0    conda-forge
> boost-cpp                 1.70.0               ha2d47e9_1    conda-forge
> brotli                    1.0.7             he1b5a44_1000    conda-forge
> bucketcache               0.12.1                   py36_1    conda-forge
> bzip2                     1.0.8                h516909a_2    conda-forge
> c-ares                    1.15.0            h516909a_1001    conda-forge
> ca-certificates           2019.11.28           hecc5488_0    conda-forge
> certifi                   2019.11.28               py36_0    conda-forge
> cffi                      1.13.2           py36h8022711_0    conda-forge
> chardet                   3.0.4                 py36_1003    conda-forge
> click                     7.0                        py_0    conda-forge
> configparser              3.7.3                    py36_1    conda-forge
> cryptography              2.8              py36h72c5cf5_1    conda-forge
> curl                      7.65.3               hf8cf82a_0    conda-forge
> cycler                    0.10.0                     py_2    conda-forge
> dbus                      1.13.6               he372182_0    conda-forge
> decorator                 4.4.1                      py_0    conda-forge
> defusedxml                0.6.0                      py_0    conda-forge
> dinamo                    1.0                  h78a066a_0    bioconda
> diskcache                 4.0.0                      py_0    conda-forge
> double-conversion         3.1.5                he1b5a44_2    conda-forge
> entrypoints               0.3                   py36_1000    conda-forge
> expat                     2.2.5             he1b5a44_1004    conda-forge
> feather-format            0.4.0                   py_1003    conda-forge
> fontconfig                2.13.1            he4413a7_1000    conda-forge
> freetype                  2.10.0               he983fc9_1    conda-forge
> future                    0.18.2                   py36_0    conda-forge
> gadem                     1.3.1                h470a237_1    bioconda
> genomepy                  0.7.1                      py_0    bioconda
> gettext                   0.19.8.1          hc5be6a0_1002    conda-forge
> gflags                    2.2.2             he1b5a44_1002    conda-forge
> ghostscript               9.22              hf484d3e_1001    conda-forge
> giflib                    5.2.1                h516909a_1    conda-forge
> gimmemotifs               0.14.1           py36h516909a_1    bioconda
> glib                      2.58.3          py36h6f030ca_1002    conda-forge
> glog                      0.4.0                he1b5a44_1    conda-forge
> grpc-cpp                  1.25.0               h213be95_2    conda-forge
> gst-plugins-base          1.14.5               h0935bb2_0    conda-forge
> gstreamer                 1.14.5               h36ae1b5_0    conda-forge
> homer                     4.10            pl526hc9558a2_0    bioconda
> icu                       58.2              hf484d3e_1000    conda-forge
> idna                      2.8                   py36_1000    conda-forge
> importlib_metadata        1.4.0                    py36_0    conda-forge
> ipykernel                 5.1.3            py36h5ca1d4c_0    conda-forge
> ipython                   7.11.1           py36h5ca1d4c_0    conda-forge
> ipython_genutils          0.2.0                      py_1    conda-forge
> ipywidgets                7.5.1                      py_0    conda-forge
> jedi                      0.15.2                   py36_0    conda-forge
> jinja2                    2.10.3                     py_0    conda-forge
> joblib                    0.14.1                     py_0    conda-forge
> jpeg                      9c                h14c3975_1001    conda-forge
> jsonschema                3.2.0                    py36_0    conda-forge
> jupyter_client            5.3.4                    py36_1    conda-forge
> jupyter_core              4.6.1                    py36_0    conda-forge
> kiwisolver                1.1.0            py36hc9558a2_0    conda-forge
> krb5                      1.16.4               h2fd8d38_0    conda-forge
> lcms2                     2.9                  hbd6801e_1    conda-forge
> libblas                   3.8.0               14_openblas    conda-forge
> libcblas                  3.8.0               14_openblas    conda-forge
> libcurl                   7.65.3               hda55be3_0    conda-forge
> libdeflate                1.5                  h516909a_0    conda-forge
> libedit                   3.1.20170329      hf8c457e_1001    conda-forge
> libevent                  2.1.10               h72c5cf5_0    conda-forge
> libffi                    3.2.1             he1b5a44_1006    conda-forge
> libgcc                    7.2.0                h69d50b8_2    conda-forge
> libgcc-ng                 9.2.0                h24d8f2e_2    conda-forge
> libgfortran-ng            7.3.0                hdf63c60_4    conda-forge
> libgomp                   9.2.0                h24d8f2e_2    conda-forge
> libiconv                  1.15              h516909a_1005    conda-forge
> liblapack                 3.8.0               14_openblas    conda-forge
> libopenblas               0.3.7                h5ec1e0e_6    conda-forge
> libpng                    1.6.37               hed695b0_0    conda-forge
> libprotobuf               3.11.0               h8b12597_0    conda-forge
> libsodium                 1.0.17               h516909a_0    conda-forge
> libssh2                   1.8.2                h22169c7_2    conda-forge
> libstdcxx-ng              9.2.0                hdf63c60_2    conda-forge
> libtiff                   4.1.0                hc3755c2_3    conda-forge
> libuuid                   2.32.1            h14c3975_1000    conda-forge
> libxcb                    1.13              h14c3975_1002    conda-forge
> libxgboost                0.90                 he1b5a44_4    conda-forge
> libxml2                   2.9.9                h13577e0_2    conda-forge
> libxslt                   1.1.32            hae48121_1003    conda-forge
> logbook                   1.5.3            py36h516909a_0    conda-forge
> logomaker                 0.8                        py_0    bioconda
> lz4-c                     1.8.3             he1b5a44_1001    conda-forge
> markupsafe                1.1.1            py36h516909a_0    conda-forge
> matplotlib                3.1.1                    py36_0    conda-forge
> matplotlib-base           3.1.1            py36hfd891ef_0    conda-forge
> meme                      5.0.5           py36pl526h19b89cf_0    bioconda
> mistune                   0.8.4           py36h516909a_1000    conda-forge
> more-itertools            8.1.0                      py_0    conda-forge
> mpi                       1.0                     openmpi    conda-forge
> mysql-connector-c         6.1.11            hc9bbbdd_1005    conda-forge
> nbconvert                 5.6.1                    py36_0    conda-forge
> nbformat                  5.0.3                      py_0    conda-forge
> ncurses                   6.1               hf484d3e_1002    conda-forge
> norns                     0.1.5                      py_0    bioconda
> nose                      1.3.7                 py36_1003    conda-forge
> notebook                  6.0.2                    py36_0    conda-forge
> numpy                     1.17.5           py36h95a1406_0    conda-forge
> olefile                   0.46                       py_0    conda-forge
> openjdk                   11.0.1            h600c080_1018    conda-forge
> openmpi                   4.0.2                hd49bf07_2    conda-forge
> openssl                   1.1.1d               h516909a_0    conda-forge
> pandas                    0.25.3           py36hb3f55d8_0    conda-forge
> pandoc                    2.9.1.1                       0    conda-forge
> pandocfilters             1.4.2                      py_1    conda-forge
> parquet-cpp               1.5.1                         2    conda-forge
> parso                     0.5.2                      py_0    conda-forge
> pathlib                   1.0.1                    py36_1    conda-forge
> patsy                     0.5.1                      py_0    conda-forge
> pcre                      8.43                 he1b5a44_0    conda-forge
> perl                      5.26.2            h516909a_1006    conda-forge
> perl-algorithm-cluster    1.58            pl526h14c3975_0    bioconda
> perl-app-cpanminus        1.7044                  pl526_1    bioconda
> perl-base                 2.23                    pl526_1    bioconda
> perl-carp                 1.38                    pl526_3    bioconda
> perl-cgi                  4.44            pl526h14c3975_1    bioconda
> perl-common-sense         3.74                    pl526_2    bioconda
> perl-constant             1.33                    pl526_1    bioconda
> perl-dbi                  1.642                   pl526_0    bioconda
> perl-encode               2.88                    pl526_1    bioconda
> perl-exporter             5.72                    pl526_1    bioconda
> perl-extutils-makemaker   7.36                    pl526_1    bioconda
> perl-file-path            2.16                    pl526_0    bioconda
> perl-file-temp            0.2304                  pl526_2    bioconda
> perl-file-which           1.23                    pl526_0    bioconda
> perl-html-parser          3.72            pl526h6bb024c_5    bioconda
> perl-html-tagset          3.20                    pl526_3    bioconda
> perl-html-template        2.97                    pl526_1    bioconda
> perl-html-tree            5.07                    pl526_1    bioconda
> perl-json                 4.02                    pl526_0    bioconda
> perl-json-xs              2.34            pl526h6bb024c_3    bioconda
> perl-log-log4perl         1.49                    pl526_0    bioconda
> perl-math-cdf             0.1             pl526h14c3975_5    bioconda
> perl-parent               0.236                   pl526_1    bioconda
> perl-scalar-list-utils    1.52            pl526h516909a_0    bioconda
> perl-types-serialiser     1.0                     pl526_2    bioconda
> perl-xml-namespacesupport 1.12                    pl526_0    bioconda
> perl-xml-parser           2.44_01         pl526ha1d75be_1002    conda-forge
> perl-xml-sax              1.02                    pl526_0    bioconda
> perl-xml-sax-base         1.09                    pl526_0    bioconda
> perl-xml-sax-expat        0.51                    pl526_3    bioconda
> perl-xml-simple           2.25                    pl526_1    bioconda
> perl-xsloader             0.24                    pl526_0    bioconda
> perl-yaml                 1.29                    pl526_0    bioconda
> pexpect                   4.7.0                    py36_0    conda-forge
> pickleshare               0.7.5                 py36_1000    conda-forge
> pillow                    7.0.0            py36hefe7db6_0    conda-forge
> pip                       19.3.1                   py36_0    conda-forge
> prometheus_client         0.7.1                      py_0    conda-forge
> prompt_toolkit            3.0.2                      py_0    conda-forge
> prosampler                1.0                  hc9558a2_0    bioconda
> psutil                    5.6.7            py36h516909a_0    conda-forge
> pthread-stubs             0.4               h14c3975_1001    conda-forge
> ptyprocess                0.6.0                   py_1001    conda-forge
> py-xgboost                0.90                     py36_4    conda-forge
> pyarrow                   0.15.1           py36h8b68381_1    conda-forge
> pybedtools                0.8.1            py36he513fc3_0    bioconda
> pycparser                 2.19                     py36_1    conda-forge
> pyfaidx                   0.5.8                      py_1    bioconda
> pygments                  2.5.2                      py_0    conda-forge
> pyopenssl                 19.1.0                   py36_0    conda-forge
> pyparsing                 2.4.6                      py_0    conda-forge
> pyqt                      5.9.2            py36hcca6a23_4    conda-forge
> pyrsistent                0.15.7           py36h516909a_0    conda-forge
> pysam                     0.15.4           py36hbcae180_0    bioconda
> pysocks                   1.7.1                    py36_0    conda-forge
> python                    3.6.7             h357f687_1006    conda-forge
> python-dateutil           2.8.1                      py_0    conda-forge
> python-xxhash             1.4.1            py36h516909a_0    conda-forge
> pytz                      2019.3                     py_0    conda-forge
> pyyaml                    5.1.2            py36h516909a_0    conda-forge
> pyzmq                     18.1.1           py36h1768529_0    conda-forge
> qt                        5.9.7                h52cfd70_2    conda-forge
> re2                       2020.01.01           he1b5a44_0    conda-forge
> readline                  8.0                  hf8c457e_0    conda-forge
> represent                 1.6.0            py36h516909a_0    conda-forge
> requests                  2.22.0                   py36_1    conda-forge
> scikit-learn              0.22.1           py36hcdab131_1    conda-forge
> scipy                     1.4.1            py36h921218d_0    conda-forge
> seaborn                   0.9.0                      py_2    conda-forge
> send2trash                1.5.0                      py_0    conda-forge
> setuptools                45.1.0                   py36_0    conda-forge
> sip                       4.19.8          py36hf484d3e_1000    conda-forge
> six                       1.14.0                   py36_0    conda-forge
> sklearn-contrib-lightning 0.5.0                    py36_0    conda-forge
> snappy                    1.1.7             he1b5a44_1003    conda-forge
> sqlite                    3.30.1               hcee41ef_0    conda-forge
> statsmodels               0.10.2           py36hc1659b7_0    conda-forge
> terminado                 0.8.3                    py36_0    conda-forge
> testpath                  0.4.4                      py_0    conda-forge
> thrift-cpp                0.12.0            hf3afdfd_1004    conda-forge
> tk                        8.6.10               hed695b0_0    conda-forge
> tornado                   6.0.3            py36h516909a_0    conda-forge
> tqdm                      4.41.1                     py_0    conda-forge
> traitlets                 4.3.3                    py36_0    conda-forge
> trawler                   2.0                           3    bioconda
> ucsc-bedtogenepred        377                  h35c10e6_0    bioconda
> ucsc-bigbedtobed          357                           1    bioconda
> ucsc-genepredtobed        377                  h35c10e6_2    bioconda
> ucsc-genepredtogtf        377                  h35c10e6_2    bioconda
> ucsc-gff3togenepred       357                           1    bioconda
> ucsc-gtftogenepred        377                  h35c10e6_2    bioconda
> uriparser                 0.9.3                he1b5a44_1    conda-forge
> urllib3                   1.25.7                   py36_0    conda-forge
> wcwidth                   0.1.8                      py_0    conda-forge
> webencodings              0.5.1                      py_1    conda-forge
> weeder                    2.0                  h6bb024c_3    bioconda
> wheel                     0.33.6                   py36_0    conda-forge
> widgetsnbextension        3.5.1                    py36_0    conda-forge
> xdg                       4.0.1                      py_1    conda-forge
> xgboost                   0.90             py36he1b5a44_4    conda-forge
> xmltodict                 0.12.0                     py_0    conda-forge
> xorg-fixesproto           5.0               h14c3975_1002    conda-forge
> xorg-inputproto           2.3.2             h14c3975_1002    conda-forge
> xorg-kbproto              1.0.7             h14c3975_1002    conda-forge
> xorg-libx11               1.6.9                h516909a_0    conda-forge
> xorg-libxau               1.0.9                h14c3975_0    conda-forge
> xorg-libxdmcp             1.1.3                h516909a_0    conda-forge
> xorg-libxext              1.3.4                h516909a_0    conda-forge
> xorg-libxfixes            5.0.3             h516909a_1004    conda-forge
> xorg-libxi                1.7.10               h516909a_0    conda-forge
> xorg-libxrender           0.9.10            h516909a_1002    conda-forge
> xorg-libxtst              1.2.3             h516909a_1002    conda-forge
> xorg-recordproto          1.14.2            h516909a_1002    conda-forge
> xorg-renderproto          0.11.1            h14c3975_1002    conda-forge
> xorg-xextproto            7.3.0             h14c3975_1002    conda-forge
> xorg-xproto               7.0.31            h14c3975_1007    conda-forge
> xxmotif                   1.6                  h2d50403_2    bioconda
> xz                        5.2.4             h14c3975_1001    conda-forge
> yaml                      0.1.7             h14c3975_1001    conda-forge
> zeromq                    4.3.2                he1b5a44_2    conda-forge
> zipp                      1.0.0                      py_0    conda-forge
> zlib                      1.2.11            h516909a_1006    conda-forge
> zstd                      1.4.4                h3b9ef0a_1    conda-forge



**Additional context**
Add any other context about the problem here.
",mkolmus,https://github.com/vanheeringen-lab/gimmemotifs/issues/102
MDU6SXNzdWU1NTc1MjQ3MDE=,Crash on any command,CLOSED,2020-01-30T14:19:26Z,2023-01-19T08:53:13Z,2023-01-19T08:53:13Z,"When I upgraded to 0.14.1 I tarted to got a bug even with gimme motifs -h

Traceback (most recent call last):
  File ""/home/user/anaconda3/envs/gimme_2/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/user/anaconda3/envs/gimme_2/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 179, in cli
    ).format(params[""size""]),
KeyError: 'size'


What could you suggest me to do?",irzhegalova,https://github.com/vanheeringen-lab/gimmemotifs/issues/103
MDU6SXNzdWU1NTc5OTI4MTY=,gimme match do not provide p-value,CLOSED,2020-01-31T08:46:30Z,2023-01-19T09:10:00Z,2023-01-19T09:10:00Z,"While running gimme match the output contains NaN in p.value field.
Could you help me to fix it?",irzhegalova,https://github.com/vanheeringen-lab/gimmemotifs/issues/105
MDU6SXNzdWU1NjMxNjA4OTM=,SQLite concurrency,CLOSED,2020-02-11T12:01:41Z,2020-02-18T02:23:33Z,2020-02-18T02:23:33Z,"**Describe the bug**
Unable to simultaneously process several datasets on a HPC cluster

**To Reproduce**
Launching 10+ parallel instances of gimmemotifs (each with `-N 12`)

**Expected behavior**
Possible to use gimmemotifs on many datasets in parallel

**Error logs**
```
multiprocessing.pool.RemoteTraceback: 
""""""
Traceback (most recent call last):
  File ""/local/anaconda3/envs/gimme/lib/python3.7/site-packages/diskcache/core.py"", line 705, in _transact
    sql('BEGIN IMMEDIATE')
sqlite3.OperationalError: database is locked
```

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: conda
 - Version: 0.14.2

**Additional context**
To my understanding there is an inherent limitation on concurrency given the current implementation, but I was curious if there are plans to mitigate this sort of problem. Or perhaps it'd be nice to note this in the documentation.

Thanks!",jessakay,https://github.com/vanheeringen-lab/gimmemotifs/issues/106
MDU6SXNzdWU1NjQ0MjM2Njc=,Gimme motif Errors without results,CLOSED,2020-02-13T03:57:48Z,2023-01-19T08:52:41Z,2023-01-19T08:52:41Z,"**Describe the bug**
A clear and concise description of what the bug is.


`gimme motif` fails and does not produce any motifs 

I have run `gimme motif` in multiple different environments and in a different contexts without success. I have also installed gimme from conda and from cloning the github repo and running it locally. 

**To Reproduce**
Steps to reproduce the behavior:

```
gimme motifs -g hg19 AG.fa /scratch/generate/combined/motifs_0.99-1_out/AG/
```
and 

```
```
gimme motifs -g hg19 -b random AG.fa /scratch/generate/combined/motifs_0.99-1_out/AG/
```
```

**Expected behavior**
A clear and concise description of what you expected to happen.

That gimme motif does not error out and results in identified motifs 

**Error logs**
If applicable, add error logs to help explain your problem.

*1 Random background*
------------------------
```
2020-02-12 12:12:05,122 - INFO - creating background (random)
2020-02-12 12:29:40,299 - INFO - starting full motif analysis
2020-02-12 12:29:40,300 - INFO - using size of 200, set size to 0 to use original region size
2020-02-12 12:29:40,300 - INFO - preparing input from FASTA
2020-02-12 12:29:40,300 - INFO - preparing input (FASTA)
2020-02-12 16:43:07,691 - INFO - starting motif prediction (xl)
2020-02-12 16:43:07,693 - INFO - tools: MEME, BioProspector, Homer
2020-02-12 16:48:09,093 - INFO - BioProspector_width_6 finished, found 0 motifs
2020-02-12 16:48:09,096 - INFO - BioProspector_width_8 finished, found 0 motifs
2020-02-12 16:48:09,098 - INFO - BioProspector_width_16 finished, found 0 motifs
2020-02-12 16:48:09,100 - INFO - BioProspector_width_10 finished, found 0 motifs
2020-02-12 16:48:09,102 - INFO - BioProspector_width_12 finished, found 0 motifs
2020-02-12 16:48:09,104 - INFO - BioProspector_width_14 finished, found 0 motifs
2020-02-12 16:48:09,106 - INFO - BioProspector_width_18 finished, found 0 motifs
2020-02-12 16:48:09,107 - INFO - BioProspector_width_20 finished, found 0 motifs
2020-02-12 16:48:09,108 - INFO - all jobs submitted
2020-02-12 16:48:09,109 - INFO - Homer_width_6 finished, found 0 motifs
2020-02-12 16:48:09,109 - INFO - Homer_width_8 finished, found 0 motifs
2020-02-12 16:48:09,110 - INFO - Homer_width_10 finished, found 0 motifs
2020-02-12 16:48:09,111 - INFO - Homer_width_14 finished, found 0 motifs
2020-02-12 16:48:09,111 - INFO - Homer_width_12 finished, found 0 motifs
2020-02-12 16:48:09,112 - INFO - Homer_width_18 finished, found 0 motifs
2020-02-12 16:48:09,113 - INFO - Homer_width_16 finished, found 0 motifs
2020-02-12 16:48:09,113 - INFO - Homer_width_20 finished, found 0 motifs
2020-02-12 16:48:09,114 - INFO - MEME_width_6 finished, found 0 motifs
2020-02-12 16:48:09,115 - INFO - MEME_width_8 finished, found 0 motifs
2020-02-12 16:48:09,115 - INFO - MEME_width_10 finished, found 0 motifs
2020-02-12 16:48:09,116 - INFO - MEME_width_12 finished, found 0 motifs
2020-02-12 16:48:09,117 - INFO - MEME_width_14 finished, found 0 motifs
2020-02-12 16:48:09,117 - INFO - MEME_width_16 finished, found 0 motifs
2020-02-12 16:48:09,118 - INFO - MEME_width_18 finished, found 0 motifs
2020-02-12 16:48:09,119 - INFO - MEME_width_20 finished, found 0 motifs
2020-02-12 16:48:11,122 - INFO - predicted 0 motifs
2020-02-12 16:48:11,134 - INFO - no motifs found
2020-02-12 16:48:11,135 - INFO - finished
Traceback (most recent call last):
  File ""/scratch/miniconda3/envs/gimme_git/bin/gimme"", line 7, in <module>
    exec(compile(f.read(), __file__, 'exec'))
  File ""/scratch/GimmeMotif/gimmemotifs/scripts/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/scratch/GimmeMotif/gimmemotifs/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/scratch/GimmeMotif/gimmemotifs/gimmemotifs/commands/motifs.py"", line 97, in motifs
    denovo = read_motifs(os.path.join(args.outdir, ""gimme.denovo.pfm""))
  File ""/scratch/GimmeMotif/gimmemotifs/gimmemotifs/motif.py"", line 1522, in read_motifs
    infile = pfmfile_location(infile)
  File ""/scratch/GimmeMotif/gimmemotifs/gimmemotifs/utils.py"", line 103, in pfmfile_location
    raise ValueError(""Motif file {} not found"".format(infile))
ValueError: Motif file /scratch/generate/combined/motifs_0.99-1_out/AG/gimme.denovo.pfm not found
```

*2 GC Background*
--------------------
```
2020-02-12 20:41:12,380 - INFO - creating background (matched GC%)
2020-02-12 20:41:12,488 - INFO - Creating index for genomic GC frequencies.
Traceback (most recent call last):
  File ""/scratch/miniconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/motifs.py"", line 75, in motifs
    number=10000,
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 122, in create_background_file
    m = MatchedGcFasta(inputfile, genome, number=number, size=size)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 548, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 512, in matched_gc_bedfile
    min_bin_size=min_bin_size,
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 387, in gc_bin_bedfile
    create_gc_bin_index(genome, fname, min_bin_size=min_bin_size)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 352, in create_gc_bin_index
    df.reset_index()[cols].to_feather(fname)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/pandas/util/_decorators.py"", line 214, in wrapper
    return func(*args, **kwargs)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/pandas/core/frame.py"", line 1994, in to_feather
    to_feather(self, path)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/pandas/io/feather_format.py"", line 64, in to_feather
    feather.write_feather(df, path)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/pyarrow/feather.py"", line 180, in write_feather
    writer.write(df)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/pyarrow/feather.py"", line 91, in write
    table = Table.from_pandas(df, preserve_index=False)
  File ""pyarrow/table.pxi"", line 1139, in pyarrow.lib.Table.from_pandas
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/pyarrow/pandas_compat.py"", line 474, in dataframe_to_arrays
    convert_types))
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/concurrent/futures/_base.py"", line 586, in result_iterator
    yield fs.pop().result()
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/concurrent/futures/_base.py"", line 425, in result
    return self.__get_result()
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/concurrent/futures/_base.py"", line 384, in __get_result
    raise self._exception
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/concurrent/futures/thread.py"", line 56, in run
    result = self.fn(*self.args, **self.kwargs)
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/pyarrow/pandas_compat.py"", line 463, in convert_column
    raise e
  File ""/scratch/miniconda3/envs/gimme/lib/python3.6/site-packages/pyarrow/pandas_compat.py"", line 457, in convert_column
    return pa.array(col, type=ty, from_pandas=True, safe=safe)
  File ""pyarrow/array.pxi"", line 169, in pyarrow.lib.array
  File ""pyarrow/array.pxi"", line 78, in pyarrow.lib._ndarray_to_array
  File ""pyarrow/error.pxi"", line 91, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: ('an integer is required (got type str)', 'Conversion failed for column chrom with type object')

```

**Installation information (please complete the following information):**
 - OS: [Linux]

 - Installation [conda]
 - Version [v0.14.2]

**Additional context**
Add any other context about the problem here.
",mikecormier,https://github.com/vanheeringen-lab/gimmemotifs/issues/107
MDU6SXNzdWU1NjQ2NzcwMjM=,gimme maelstrom error,CLOSED,2020-02-13T13:18:50Z,2023-01-19T08:52:03Z,2023-01-19T08:52:03Z,"I'm trying to run gimme maelstrom but it gets stuck here:

2020-02-13 10:25:29,036 - INFO - Starting maelstrom
2020-02-13 10:25:29,066 - INFO - motif scanning (counts)
2020-02-13 10:25:29,067 - INFO - reading table
2020-02-13 10:25:30,782 - INFO - setting threshold
2020-02-13 10:25:32,287 - INFO - creating count table

And there is no error message.

I was using python 3.7 and switched to 3.6 and it didn't solve the issue.
",ritamonteiro,https://github.com/vanheeringen-lab/gimmemotifs/issues/108
MDU6SXNzdWU1NjY2NDU3OTI=,dockerFile,CLOSED,2020-02-18T04:56:53Z,2023-01-19T09:09:46Z,2023-01-19T09:09:46Z,It would be great if you could create a version of Gimme Motifs in a docker.  Any plans?,michy999,https://github.com/vanheeringen-lab/gimmemotifs/issues/109
MDU6SXNzdWU1NzYzNzI3MDQ=,Gimme error -SQLlite,CLOSED,2020-03-05T16:20:04Z,2023-01-19T08:51:34Z,2023-01-19T08:51:34Z,"Hello, I recently installed gimme (by helping from HPC programmer), but I faced this issue below
Could you help me to fix this problem? Not only maelstrom has problem, the motif find with known option doesn't work
BP

$ gimme maelstrom mygenelist_quantile_normalized_lcpm_mean_center2.txt hg38 output
    2020-03-04 11:48:15,520 - INFO - Starting maelstrom
    2020-03-04 11:48:21,987 - INFO - motif scanning (counts)
    2020-03-04 11:48:21,989 - INFO - reading table
    Traceback (most recent call last):
      File ""/usr/local/apps/gimmemotifs/0.14.3/bin/gimme"", line 11, in <module>
        cli(sys.argv[1:])
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 625, in cli
        args.func(args)
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/gimmemotifs/commands/maelstrom.py"", line 37, in maelstrom
        gc=gc,
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/gimmemotifs/maelstrom.py"", line 311, in run_maelstrom
        gc=gc,
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/gimmemotifs/moap.py"", line 122, in scan_to_table
        s.set_background(genome=genome, gc=gc, size=size)
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
        with Cache(CACHE_DIR) as cache:
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/diskcache/core.py"", line 442, in __init__
        sql = self._sql_retry
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/diskcache/core.py"", line 634, in _sql_retry
        sql = self._sql
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/diskcache/core.py"", line 629, in _sql
        return self._con.execute
      File ""/usr/local/Anaconda/envs_app/GimmeMotifs/0.14.3/lib/python3.7/site-packages/diskcache/core.py"", line 616, in _con
        settings = con.execute(select).fetchall()
    sqlite3.DatabaseError: database disk image is malformed

",genomicspark,https://github.com/vanheeringen-lab/gimmemotifs/issues/110
MDU6SXNzdWU1OTMzMDM1OTg=,Improve visualisation for maelstrom,OPEN,2020-04-03T11:08:35Z,2020-04-03T12:19:14Z,,"I have been using maelstrom over the past few days and it gives me exactly what I want. Motif analyses from different clusters and the extra code to plot the heatmap was the cherry on top. My heatmap looks different to the one on the tutorial - my heatmap is very thin and the colours are thin lines, rather than squares, which means my cluster labels are squished and unreadable. As a python newbie, I think some extra info on how to visualise maelstrom output would be welcome. I see the link to the juypter notebook is broken (https://github.com/vanheeringen-lab/gimmemotifs/blob/master/docs/notebooks/maelstrom.ipynb), which might have given me some tips.

Some things I think are needed:
Ability to dictate dimensions of plot.
Ability to change colour palettes.
Addition of dendrogram (I assume the heatmap clusters the motifs).
I think the above might be doable just from tweaking the python code.

For future releases, I think it might be good for the maelstrom command to plot the heatmap, or for another function altogether. ",connorrogerson,https://github.com/vanheeringen-lab/gimmemotifs/issues/112
MDU6SXNzdWU2MDAyNzg0NjA=,gimme motifs and scan,CLOSED,2020-04-15T12:59:14Z,2023-01-19T08:50:41Z,2023-01-19T08:50:41Z,"Hello, 
I have been using Gimme motifs and scan separately.  the motif command to find de novo motifs and then the scan command to get the positions of the de novo motifs from the combined.pfm file.

Is there an easier way todo this, within 1 command please?

Best,
Michy",michy999,https://github.com/vanheeringen-lab/gimmemotifs/issues/113
MDU6SXNzdWU2MTY1MTgxMTk=,Error: pyarrow.lib.ArrowTypeError,CLOSED,2020-05-12T09:48:52Z,2020-06-09T09:57:55Z,2020-06-09T09:57:55Z,"If you get the following error:

```
File ""pyarrow/array.pxi"", line 169, in pyarrow.lib.array
File ""pyarrow/array.pxi"", line 74, in pyarrow.lib._ndarray_to_array
File ""pyarrow/array.pxi"", line 62, in pyarrow.lib._ndarray_to_type
File ""pyarrow/error.pxi"", line 91, in pyarrow.lib.check_status
pyarrow.lib.ArrowTypeError: ('Did not pass numpy.dtype object', 'Conversion failed for column chrom with type string')
```

This can be fixed by updating the `pyarrow` dependency (see also #107). 

```
conda update pyarrow=0.16.0
```

A new bioconda build of GimmeMotifs will fix this.",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/114
MDU6SXNzdWU2MjM4MjE0MDc=,"genomepy install leads to ""No such file or directory""",CLOSED,2020-05-24T08:40:12Z,2023-01-19T08:50:25Z,2023-01-19T08:50:24Z,"**Describe the bug**
genomepy fails to install genome in docker container. 

**To Reproduce**
`docker run -it quay.io/biocontainers/gimmemotifs:0.14.4--py37h516909a_0 genomepy install hg38 UCSC --annotation`

**Error logs**

> Downloading genome from http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz...
> gunzip: /root/.local/share/genomes/hg38/tmphz_jewej/hg38.fa: No such file or directory
> Traceback (most recent call last):

...

> subprocess.CalledProcessError: Command '['gunzip', '-f', '/root/.local/share/genomes/hg38/tmphz_jewej/hg38.fa']' returned non-zero exit status 1.

**Installation information (please complete the following information):**
 - OS: [docker]
 - Installation [quay.io/biocontainers/gimmemotifs:0.14.4--py37h516909a_0]
 - Version [genomepy, version 0.7.2]

**Additional context**
I tried to exec into container and run those commands:
`genomepy install hg38 UCSC --annotation`
`ls /root/.local/share/genomes/hg38/`
result: directory was empty

",plachta11b,https://github.com/vanheeringen-lab/gimmemotifs/issues/115
MDU6SXNzdWU2MjM4MzQ4NDI=,Use of -g with FASTA results in: ERROR: Genome file *.fa.sizes does not exist,CLOSED,2020-05-24T10:15:15Z,2020-05-25T16:23:01Z,2020-05-25T16:23:01Z,"**Describe the bug**
Gimme does not generate genome.fa.sizes file for file specified in -g.

This does not seems to be true: ""...you can now also directly supply a genome FASTA instead of a genome name. Pre-indexing is not required anymore.""

**To Reproduce**
$genome=Homo_sapiens.GRCh38.dna.primary_assembly.fa (ftp://ftp.ensembl.org/pub/release-100/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz)

$fasta_primary=
> \>ENSG00000165973|ENSG00000165973.19|ENST00000357134|ENST00000357134.10
> ACCCGGCGCTGC....
> \>ENSG00000165973|ENSG00000165973.19|ENST00000325319|ENST00000325319.9
> GGGGCTGCCTTCC....
> \>ENSG00000172020|ENSG00000172020.13|ENST00000305124|ENST00000305124.11
> ACAGTTGCTGCT....

....
```
wc -l 176
wc -c 29408
```

$fasta_background= (similar to primary)
```
wc -l 1550
wc -c 260202
```

In case of manually generated .sizes file gimme freezes. I do not know if it is another issue or badly generated sizes file.
`gimme motifs $fasta_primary /output -g $genome --denovo -b $fasta_background
`

**Expected behavior**
Using consensus fasta file without need for indexing. Gimme not freezing.

**Error logs**
> ERROR: Genome file ""/genome/ensembl/Homo_sapiens.GRCh38.dna.primary_assembly.fa.sizes"" does not exist

<details>
  <summary>Traceback</summary>
multiprocessing.pool.RemoteTraceback:
""""""
Traceback (most recent call last):
  File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
    result = (True, func(*args, **kwds))
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
    genome=genome,
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
    gc=gc,
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
    s.set_meanstd(gc=gc)
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
    self.set_background(gc=gc)
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 748, in set_background
    tmp.name, genome, number=nseq, length=size, bins=gc_bins
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/background.py"", line 398, in gc_bin_bedfile
    create_gc_bin_index(genome, fname, min_bin_size=min_bin_size)
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/background.py"", line 330, in create_gc_bin_index
    pybedtools.BedTool().window_maker(g=sizes, w=min_bin_size).nucleotide_content(
  File ""/usr/local/lib/python3.7/site-packages/pybedtools/bedtool.py"", line 917, in decorated
    result = method(self, *args, **kwargs)
  File ""/usr/local/lib/python3.7/site-packages/pybedtools/bedtool.py"", line 335, in wrapped
    kwargs = self.check_genome(**kwargs)
  File ""/usr/local/lib/python3.7/site-packages/pybedtools/bedtool.py"", line 1623, in check_genome
    raise FileNotFoundError(msg)
FileNotFoundError: Genome file ""/genome/ensembl/Homo_sapiens.GRCh38.dna.primary_assembly.fa.sizes"" does not exist
""""""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/usr/local/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 94, in motifs
    ""size"": args.size,
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/denovo.py"", line 619, in gimme_motifs
    stats_bg=background,
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 372, in predict_motifs
    stats_bg=stats_bg,
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 320, in pp_predict_motifs
    result.wait_for_stats()
  File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 178, in wait_for_stats
    job.get()
  File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 657, in get
    raise self._value
FileNotFoundError: Genome file ""/genome/ensembl/Homo_sapiens.GRCh38.dna.primary_assembly.fa.sizes"" does not exist
</details>


**Installation information (please complete the following information):**
 - OS: [docker]
 - Installation [quay.io/biocontainers/gimmemotifs:0.14.4--py37h516909a_0]
 - Version [GimmeMotifs v0.14.4]

**Additional context**
I tried generate .fa.sizes file manually. Gimme freeze after that.

$genome.sizes= generated by this script
```
from pyfaidx import Fasta
import os
import sys

def sizes_file(fname):
    if not os.path.exists(fname+"".sizes""):
        generate_fa_sizes(fname, fname+"".sizes"")

def generate_fa_sizes(fname, outname):
    f = Fasta(fname)
    with open(outname, ""w"") as sizes:
        for seqname, seq in f.items():
            sizes.write(f""{seqname}\t{len(seq)}\n"")

sizes_file(sys.argv[1])

```

Runs more than 12h without progress.
Last message in .log file is:
> gimme.scanner - DEBUG - using background: genome /genome/ensembl/Homo_sapiens.GRCh38.dna.primary_assembly.fa with size 200
",plachta11b,https://github.com/vanheeringen-lab/gimmemotifs/issues/116
MDU6SXNzdWU2MjQ0NDQyMzM=,Hangs on docker with low RAM (-g file.fa used),CLOSED,2020-05-25T18:58:26Z,2023-01-19T09:09:03Z,2023-01-19T09:09:03Z,"**Describe the bug**
Hang with 0% cpu utilization.

**To Reproduce**

`mkdir data`

data/primary.fasta (data from ensembl biomart)
```
echo "">ENSG00000165973|ENSG00000165973.19|ENST00000357134|ENST00000357134.10
ACCCGGCGCTGCCGAGCCACCTCCCCCGCCGCCCGCTAGCAAGTTTGGCGGCTCCAAGCCAGGCGCGCCTCAGGATCCAGGCTCATTTGCTTCCACCTAGCTTCGGTGCCCCCTGCTAGGCGGGGACCCTCGAGAGCG
>ENSG00000165973|ENSG00000165973.19|ENST00000325319|ENST00000325319.9
GGGGCTGCCTTCCCGGGCGCATATGCGAGCGCAGCACCCGGCGCTGCCGAGCCACCTCCCCCGCCGCCCGCTAGCAAGTTTGGCGGCTCCAAGCCAGGCGCGCCTCAGGATCCAGGCTCATTTGCTTCCACCTAGCTTCGGTGCCCCCTGCTAGGCGGGGACCCTCGAGAGCG
>ENSG00000172020|ENSG00000172020.13|ENST00000305124|ENST00000305124.11
ACAGTTGCTGCTAACTGCCCTGGTGTGTGTGAGGGAGAGAGAGGGAGGGAGGGAGAGAGAGCGCGCTAGCGCGAGAGAGCGAGTGAGCAAGCGAGCAGAAAAGAGGTGGAGAGGGGGGGAATAAGAAAGAGAGAGAAGGAAAGGAGAGAAGGCAGGAAGAAGGCAAGGGACGAGACAACC
>ENSG00000172061|ENSG00000172061.9|ENST00000347624|ENST00000347624.4
ACACTCATGCTGCAGCCTTGAGCCGTCCCTCGTCCTCCTCTCAGGCTCCCTCTTGTCCACGGCGGGCGGGCGCCGAGCTGCTGGCT
>ENSG00000165973|ENSG00000165973.19|ENST00000298925|ENST00000298925.9
ATATGCGAGCGCAGCACCCGGCGCTGCCGAGCCACCTCCCCCGCCGCCCGCTAGCAAGTTTGGCGGCTCCAAGCCAGGCGCGCCTCAGGATCCAGGCTCATTTGCTTCCACCTAGCTTCGGTGCCCCCTGCTAGGCGGGGACCCTCGAGAGCG"" > data/primary.fasta
```

data/background.fasta (data from ensembl biomart)
```
echo "">ENSG00000134014|ENSG00000134014.17|ENST00000256398|ENST00000256398.13
GGCTGTCAGCTTTCCCCGTGGTCTGAGTTTGTGGCTGCATTTTTATCTCTGGTGGCTCTGCTACGGCGGCGCAGAA
>ENSG00000106344|ENSG00000106344.8|ENST00000223073|ENST00000223073.6
ACTTCCGGAATCTCTCGGCGTGTGAGCTTGGTTGTCCTACCAAAGCCAGCGTTTCGGCTCGCGTGCGCCGGCCTAGTTTGCTCGCGTCCTCACGCGCTTTGGGTTTCCCGGTCTC
>ENSG00000135447|ENSG00000135447.17|ENST00000257905|ENST00000257905.13
AGAGTCCCCGGAGCCGCGAGCTGGGAGCGCTGTGCCGGGAGCCGGGAGCCGAGCGCGCCGGGCTGGGGCCGGGGCCGGAGCGGAGCGGAGAGGGAGCGCGCCCGCCCCAGCCCCGAGTCCCGCCGCCTTCCCTCCCGCCGCAGCGCGGGCCCACCGGCCGCCGCCCCAGCC
>ENSG00000112118|ENSG00000112118.20|ENST00000229854|ENST00000229854.12
GAAGAAGAAGAAGCTTTTGATTGGACAGTCGCTAGTCCGACCTCAGAGAACTCAGCCAATCATA
>ENSG00000100299|ENSG00000100299.18|ENST00000216124|ENST00000216124.10
GAGGCGGAAGCGCCCGCAGCCCGGTACCGGCTCCTCCTGGGCTCCCTCTAGCGCCTTCCCCCCGGCCCGACTCCGCTGGTCAGCGCCAAGTGACTTACGCCCCCGACCCTGAGCCCGGACCGCTAGGCGAGGAGGATCAGATCTCCGCTCGAGAATCTGAAGGTGCCCTGGTCCTGGAGGAGTTCCGTCCCAGCCCGCGGTCTCCCGGTACTGTCGGGCCCCGGCCCTCTGGAGCTTCAGGAGGCGGCCGTCAGGGTCGGGGAGTATTTGGGTCCGGGGTCTCAGGGAAGGGCGGCGCCTGGGTCTGCGGTATCGGAAAGAGCCTGCTGGAGCCAAGTAGCCCTCCCTCTCTTGGGACAGACCCCTCGGTCCC"" > data/background.fasta
```

data/hg38.fa (tried ensembl too)
```
# https://hgdownload.soe.ucsc.edu/downloads.html#human
curl ""http://hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz"" | \
gzip -d > data/hg38.fa
if [[ ""$(sha1sum data/hg38.fa)"" != *""c44a85ab746fe98ce1945022c643a4c289d2f3ce""* ]]; then echo ""data/hg38.fa: sha does not match""; else echo ""FILE OK""; fi
```

Dockerfile (extended due to .sizes issue #116)
```
echo ""FROM alpine/git:latest AS builder

WORKDIR /
RUN git clone https://github.com/vanheeringen-lab/genomepy.git
RUN git -C /genomepy checkout develop

FROM quay.io/biocontainers/gimmemotifs:0.14.4--py37h516909a_0

COPY --from=builder /genomepy /genomepy

RUN pip install /genomepy"" > Dockerfile
```

`docker build --no-cache -t gimme_container - < Dockerfile`

`docker run -ti -v ""$(pwd)/data"":/data -v ""$(pwd)/out"":/output gimme_container gimme motifs /data/primary.fasta /output -g /data/hg38.fa --denovo -b /data/background.fasta`

It hangs. On keyboard interrupt almost all threads are in lock.acquire() state

**Expected behavior**
A clear and concise description of what you expected to happen.

**Error logs**
docker exec -it 08cf8bba779a top
<details>
  <summary>top</summary>

> Mem: 317788K used, 4741240K free, 0K shrd, 0K buff, 1K cached
> CPU:   0% usr   0% sys   0% nic  99% idle   0% io   0% irq   0% sirq
> Load average: 0.04 0.01 0.02 5/532 2163
>   PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND
>     1     0 root     S     606m  12%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>  2156     1 root     S     607m  12%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    77     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    67     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    75     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    76     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    73     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    78     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    69     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    70     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    71     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    74     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>    72     1 root     S     460m   9%   0% {gimme} /usr/local/bin/python /usr/local/bin/gimme motifs data/regulated_more_02.fasta /output -g /gen
>  2157     0 root     S     6872   0%   0% sh
>  2163  2157 root     R     6872   0%   0% top
>  1185     1 root     Z        0   0%   0% [orted]
>  1205     1 root     Z        0   0%   0% [orted]
>  1209     1 root     Z        0   0%   0% [orted]
>  1225     1 root     Z        0   0%   0% [orted]
>  1165     1 root     Z        0   0%   0% [orted]
>  1213     1 root     Z        0   0%   0% [orted]
>  1217     1 root     Z        0   0%   0% [orted]
>  1221     1 root     Z        0   0%   0% [orted]

</details>

<details>
  <summary>Traceback on ctrl-c</summary>

> ^CProcess ForkPoolWorker-13:
> Traceback (most recent call last):
>   File ""/usr/local/bin/gimme"", line 11, in <module>
> Process ForkPoolWorker-11:
> Process ForkPoolWorker-4:
> Process ForkPoolWorker-9:
> Process ForkPoolWorker-1:
> Process ForkPoolWorker-5:
> Process ForkPoolWorker-6:
> Process ForkPoolWorker-10:
> Process ForkPoolWorker-12:
> Process ForkPoolWorker-3:
> Process ForkPoolWorker-8:
> Process ForkPoolWorker-7:
>     cli(sys.argv[1:])
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 625, in cli
>     args.func(args)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 94, in motifs
>     ""size"": args.size,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/denovo.py"", line 619, in gimme_motifs
>     stats_bg=background,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 372, in predict_motifs
>     stats_bg=stats_bg,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 320, in pp_predict_motifs
>     result.wait_for_stats()
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 178, in wait_for_stats
>     job.get()
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 651, in get
>     self.wait(timeout)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 648, in wait
>     self._event.wait(timeout)
>   File ""/usr/local/lib/python3.7/threading.py"", line 552, in wait
>     signaled = self._cond.wait(timeout)
>   File ""/usr/local/lib/python3.7/threading.py"", line 296, in wait
>     waiter.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt
> Traceback (most recent call last):
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 297, in _bootstrap
>     self.run()
>   File ""/usr/local/lib/python3.7/multiprocessing/process.py"", line 99, in run
>     self._target(*self._args, **self._kwargs)
>   File ""/usr/local/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
>     result = (True, func(*args, **kwds))
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/prediction.py"", line 54, in mp_calc_stats
>     genome=genome,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 226, in calc_stats
>     gc=gc,
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
>     s.set_meanstd(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 623, in set_meanstd
>     self.set_background(gc=gc)
>   File ""/usr/local/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 726, in set_background
>     lock.acquire()
> KeyboardInterrupt

</details>

**Installation information (please complete the following information):**
 - OS: [Docker]
 - Installation [extended quay.io/biocontainers/gimmemotifs:0.14.4--py37h516909a_0]
 - Version [GimmeMotifs v0.14.4]

",plachta11b,https://github.com/vanheeringen-lab/gimmemotifs/issues/117
MDU6SXNzdWU2MjQ2OTEwNTU=,GimmeMotifs crashes when no motifs are found,CLOSED,2020-05-26T08:19:05Z,2021-04-27T13:36:02Z,2020-09-29T13:41:55Z,"```
2020-05-26 10:15:00,816 - INFO - no motifs found
2020-05-26 10:15:00,816 - INFO - finished
Traceback (most recent call last):
  File ""/home/simon/anaconda3/envs/gimme/bin/gimme"", line 4, in <module>
    __import__('pkg_resources').run_script('gimmemotifs==0.14.3+17.gb2ae9f6.dirty', 'gimme')
  File ""/home/simon/anaconda3/envs/gimme/lib/python3.6/site-packages/pkg_resources/__init__.py"", line 666, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File ""/home/simon/anaconda3/envs/gimme/lib/python3.6/site-packages/pkg_resources/__init__.py"", line 1462, in run_script
    exec(code, namespace, namespace)
  File ""/home/simon/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs-0.14.3+17.gb2ae9f6.dirty-py3.6-linux-x86_64.egg/EGG-INFO/scripts/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/simon/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs-0.14.3+17.gb2ae9f6.dirty-py3.6-linux-x86_64.egg/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/home/simon/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs-0.14.3+17.gb2ae9f6.dirty-py3.6-linux-x86_64.egg/gimmemotifs/commands/motifs.py"", line 97, in motifs
    denovo = read_motifs(os.path.join(args.outdir, ""gimme.denovo.pfm""))
  File ""/home/simon/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs-0.14.3+17.gb2ae9f6.dirty-py3.6-linux-x86_64.egg/gimmemotifs/motif.py"", line 1522, in read_motifs
    infile = pfmfile_location(infile)
  File ""/home/simon/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs-0.14.3+17.gb2ae9f6.dirty-py3.6-linux-x86_64.egg/gimmemotifs/utils.py"", line 103, in pfmfile_location
    raise ValueError(""Motif file {} not found"".format(infile))
ValueError: Motif file testout/gimme.denovo.pfm not found
```",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/118
MDU6SXNzdWU2MjU5OTE1NTQ=,Error with scikit-learn >=0.23,CLOSED,2020-05-27T20:01:02Z,2021-04-13T08:41:48Z,2021-04-13T08:41:48Z,"lightning depends on a deprecated feature from scikit-learn. Version 0.22 is fine, but this needs looking into. 

See also vanheeringen-lab/genomepy#105",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/119
MDU6SXNzdWU2MjcyNzcwNjk=,Sensitivity cutoff for motif identification?,CLOSED,2020-05-29T13:41:04Z,2023-01-19T09:08:27Z,2023-01-19T09:08:27Z,"Is there a way to set the sentivity of identifying a sequence as a motif?
GimmeMotifs seems to have a very stringent way of selecting motifs. 

",ClarissaFeuersteinAkgoz,https://github.com/vanheeringen-lab/gimmemotifs/issues/120
MDU6SXNzdWU2MzUzNzc1MjQ=,AttributeError: 'Genome' object has no attribute 'props',CLOSED,2020-06-09T12:14:47Z,2021-04-13T08:19:42Z,2021-04-13T08:19:42Z,"**Describe the bug**
I get this error when I try to do Motif enrichment statistics. I downloaded the dm6 genome using genomepy. I dont understand what is causing the problem.

A quick question regarding this can I get the statistics without using the genome? 
I am interested in replicating the gimme roc command which was depreciated. Previously  it was done like this;

`gimme roc lola.pfm ENCFF742LVH.fa ENCFF742LVH.bg > lola_gimme_metrics.txt`
What is the equivalent of the same?

**To Reproduce**
My current try which ran into the error is;
`gimme motifs ENCFF742LVH.fa lola-motif -b ENCFF742LVH.bg -p lola.pfm --known -g dm6`

**Expected behavior**
I expected to get the `gimme.roc.report.txt` in the results dir

**Error logs**
```
2020-06-09 14:39:15,007 - INFO - skipping de novo
2020-06-09 14:39:15,007 - INFO - creating motif scan tables
2020-06-09 14:39:15,239 - INFO - using 10000 sequences
2020-06-09 14:39:15,239 - INFO - Creating index for genomic GC frequencies.
Traceback (most recent call last):
  File ""/home/festo/miniconda3/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/festo/miniconda3/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/home/festo/miniconda3/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 174, in motifs
    gcnorm=True,
  File ""/home/festo/miniconda3/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 306, in scan_to_file
    gcnorm=gcnorm,
  File ""/home/festo/miniconda3/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 199, in command_scan
    genome=genome, fname=bgfile, size=fa.median_length(), gc=gcnorm
  File ""/home/festo/miniconda3/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 747, in set_background
    tmp.name, genome, number=nseq, length=size, bins=gc_bins
  File ""/home/festo/miniconda3/lib/python3.7/site-packages/gimmemotifs/background.py"", line 387, in gc_bin_bedfile
    create_gc_bin_index(genome, fname, min_bin_size=min_bin_size)
  File ""/home/festo/miniconda3/lib/python3.7/site-packages/gimmemotifs/background.py"", line 326, in create_gc_bin_index
    sizes = g.props[""sizes""][""sizes""]
AttributeError: 'Genome' object has no attribute 'props'
```

**Installation information (please complete the following information):**
 - OS:  Linux Ubuntu 18.04
 - Installation  conda
 - Version  0.14.3
",Fnyasimi,https://github.com/vanheeringen-lab/gimmemotifs/issues/121
MDU6SXNzdWU2NDI4OTA5OTY=,Minor: RuntimeWarning,CLOSED,2020-06-22T09:03:43Z,2023-01-19T08:50:07Z,2023-01-19T08:50:07Z,"**Describe the bug**
Got this warning while running gimme motifs. Didn't notice anything off with the results yet.

**To Reproduce**
Steps to reproduce the behavior:
- fresh config file, keep-intermediates on.
```
gimme motifs peaks.bed . \
-g Xtropicalis.v9.fa \
-f 0.7 \
-N 45 \
-k
```

**Error logs**
```
2020-06-20 13:35:38,127 - INFO - creating motif scan tables
2020-06-20 13:51:43,664 - INFO - calculating stats
2020-06-20 13:54:15,700 - INFO - selecting non-redundant motifs
2020-06-20 13:54:46,776 - INFO - selected 3 non-redundant motifs: ROC AUC 0.913, PR AUC 0.972
2020-06-20 13:54:48,974 - INFO - determining FPR-based threshold
2020-06-20 13:55:11,596 - INFO - determining FPR-based threshold
2020-06-20 13:55:33,987 - INFO - determining FPR-based threshold
2020-06-20 13:55:54,441 - INFO - creating statistics report
/home/siebrenf/anaconda3/envs/tfs/lib/python3.7/site-packages/pandas/io/formats/style.py:1175: RuntimeWarning: invalid value encountered in true_divide
  normed = width * (s.to_numpy(dtype=float) - smin) / (smax - smin + 1e-12)
2020-06-20 13:56:58,648 - INFO - gimme motifs final report: ./gimme.motifs.html
```

**Installation information (please complete the following information):**
 - OS: Ubuntu 18.04
 - Installation: Conda
 - Version: 0.14.4 (latest)",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/122
MDU6SXNzdWU2NDM3MzMzMzk=,TypeError: '<=' not supported between instances of 'numpy.ndarray' and 'numpy.ndarray',CLOSED,2020-06-23T10:43:11Z,2020-07-07T07:58:43Z,2020-07-05T16:33:10Z,"When I run the following command: 
gimme motifs -b bg_gain_LMR_p0.005.bed -g hg19 --known -p HOCOMOCOv11_HUMAN gain_LMR_p0.005.bed ./result_interval

with a different bed file it has worked already

I get the following error message

**Error logs**
2020-06-23 12:29:17,592 - INFO - skipping de novo
2020-06-23 12:29:17,598 - INFO - creating motif scan tables
2020-06-23 12:33:05,535 - INFO - calculating stats
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.443388' '1.6809939999999999' '-0.215752']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.979627' '0.550293' '0.6340359999999999']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.39129' '0.761863' '-0.039827']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '3.2660259999999997' '0.39620700000000003'
 '-0.112055']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.395746' '-0.43999099999999997'
 '1.3514190000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.011143' '1.28257' '-2.907377']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.135723' '0.234121' '-1.4247100000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.1872770000000001' '1.1870100000000001'
 '-2.015707']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.011606' '-0.11078800000000001'
 '0.7163689999999999']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.728649' '0.126275' '0.9604389999999999']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.25085' '0.110528' '0.624474']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.813901' '0.760238' '-0.42581']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.649544' '0.07642' '0.054885']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.983754' '-0.073076' '-2.099869']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.738653' '2.2022310000000003' '-1.910455']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.549878' '1.0428709999999999' '0.389892']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.8479959999999999' '1.422683'
 '-1.2352379999999998']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.73747' '0.474498' '-1.3959620000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.506909' '0.047011000000000004' '-0.775601']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.8984770000000001' '0.23693699999999998'
 '-0.48547700000000005']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.08025700000000001' '0.5408189999999999'
 '-0.940793']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.178784' '1.321532' '-1.420401']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.269354' '1.1403590000000001' '-0.08666']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.37740100000000004' '0.710505'
 '0.9121370000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.6333880000000001' '1.353281' '-2.812048']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.041668000000000004' '0.6511319999999999'
 '-2.909601']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.023979' '-0.143623' '0.995693']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.42371000000000003' '2.109898' '1.045691']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.8099890000000001' '0.894804' '0.965268']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.663554' '0.747246' '1.504478']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.491808' '-0.258295' '-1.023865']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.702937' '1.077391' '-1.160859']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.103699' '0.33116999999999996' '0.03873']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.037225' '1.7343819999999999' '-1.834514']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.060799' '-0.015401' '0.7291270000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.236355' '1.1763219999999999' '-0.395504']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.9637629999999999' '2.476746'
 '1.8968049999999999']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.694009' '1.032813' '-2.4005080000000003']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.1497080000000004' '1.653673' '-2.392806']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.20135' '1.354429' '-1.6896669999999998']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.13836400000000001' '0.702538' '2.415279']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.868002' '1.3102770000000001' '-1.58334']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.015258' '1.446137' '0.09663200000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.116437' '0.521487' '1.629353']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.479708' '0.398408' '-0.30362']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.018628' '1.376119' '-0.539283']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.659251' '0.8953979999999999'
 '0.48822600000000005']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.14846199999999998' '0.404319'
 '-0.49439700000000003']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.4632120000000002' '0.6114430000000001'
 '-1.258268']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.2362229999999998' '0.057651999999999995'
 '2.183386']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.807552' '0.5102300000000001'
 '-0.5469149999999999']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.636939' '0.216392' '1.127918']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.0573110000000001' '-0.482809' '-0.291158']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.790679' '0.750173' '0.41952399999999995']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.823967' '1.162166' '-1.0355290000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.101901' '0.742175' '-0.5546270000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.495072' '0.601418' '-1.3896950000000001']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.100002' '1.32155' '0.143701']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.218116' '0.370867' '-0.869878']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.460449' '1.154191' '-2.3277919999999996']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '1.86558' '0.11198699999999999' '-2.79482']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '-0.051824' '0.638926' '-1.529782']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.502598' '1.2112610000000001' '-1.939114']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.49585100000000004' '1.7229279999999998'
 '-0.8115319999999999']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.28885900000000003' '-0.069594' '1.984647']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '2.081008' '2.109893' '-1.19423']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... '0.5998020000000001' '0.0065260000000000006'
 '0.46625500000000003']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U32'), dtype('<U32')) -> dtype('<U32')
multiprocessing.pool.RemoteTraceback:
""""""
Traceback (most recent call last):
  File ""/home/feuerste/miniconda3/envs/gimme101/lib/python3.7/multiprocessing/pool.py"", line 121, in worker
    result = (True, func(*args, **kwds))
  File ""/home/feuerste/miniconda3/envs/gimme101/lib/python3.7/site-packages/gimmemotifs/rocmetrics.py"", line 165, in phyper_at_fpr
    [sum(fg_vals >= s), sum(bg_vals >= s)],
TypeError: '<=' not supported between instances of 'numpy.ndarray' and 'numpy.ndarray'
""""""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/home/feuerste/miniconda3/envs/gimme101/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/feuerste/miniconda3/envs/gimme101/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/home/feuerste/miniconda3/envs/gimme101/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 183, in motifs
    ncpus=args.ncpus,
  File ""/home/feuerste/miniconda3/envs/gimme101/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 160, in calc_stats_iterator
    for motif_id, s, ret in it:
  File ""/home/feuerste/miniconda3/envs/gimme101/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 284, in _mp_stats
    ret = job.get()
  File ""/home/feuerste/miniconda3/envs/gimme101/lib/python3.7/multiprocessing/pool.py"", line 657, in get
    raise self._value
TypeError: '<=' not supported between instances of 'numpy.ndarray' and 'numpy.ndarray'


**Installation information (please complete the following information):**
 - Linux
 - Installation  with miniconda
 - Version conda 4.8.2

**Additional context**
Add any other context about the problem here.
",ClarissaFeuersteinAkgoz,https://github.com/vanheeringen-lab/gimmemotifs/issues/123
MDU6SXNzdWU2NDQ1NjM0MjY=,maelstrom error,CLOSED,2020-06-24T12:08:14Z,2021-04-13T08:41:27Z,2021-04-13T08:41:27Z,"Hi,

I came across this error from maelstrom: 
` gimme maelstrom -h`
`  File ""/home/xyz/miniconda3/envs/gimmemotifs/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 613, in cli
    args = parser.parse_args(sys_args)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1755, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1787, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1975, in _parse_known_args
    positionals_end_index = consume_positionals(start_index)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1952, in consume_positionals
    take_action(action, args)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1861, in take_action
    action(self, namespace, argument_values, option_string)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1158, in __call__
    subnamespace, arg_strings = parser.parse_known_args(arg_strings, None)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1787, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1993, in _parse_known_args
    start_index = consume_optional(start_index)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1933, in consume_optional
    take_action(action, args, option_string)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1861, in take_action
    action(self, namespace, argument_values, option_string)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 1043, in __call__
    parser.print_help()
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 2481, in print_help
    self._print_message(self.format_help(), file)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 2465, in format_help
    return formatter.format_help()
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 284, in format_help
    help = self._root_section.format_help()
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 215, in format_help
    item_help = join([func(*args) for func, args in self.items])
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 215, in <listcomp>
    item_help = join([func(*args) for func, args in self.items])
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 215, in format_help
    item_help = join([func(*args) for func, args in self.items])
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 215, in <listcomp>
    item_help = join([func(*args) for func, args in self.items])
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 531, in _format_action
    help_text = self._expand_help(action)
  File ""/home/xyz/miniconda3/envs/gimmemotifs/lib/python3.7/argparse.py"", line 620, in _expand_help
    return self._get_help_string(action) % params
ValueError: unsupported format character 'b' (0x62) at index 14
`

version: GimmeMotifs v0.14.4
source: the latest gimmemotifs release on bioconda channel.

Could you please take a look into this issue ?
Thank you in advance

Sudeep.",sudeepsahadevan,https://github.com/vanheeringen-lab/gimmemotifs/issues/125
MDU6SXNzdWU2NDg1MzUwODI=,ask for updating Cis-bp,OPEN,2020-06-30T22:26:06Z,2020-07-07T07:38:36Z,,"**Is your feature request related to a problem? Please describe.**
Now Cis-bp has changed to version 2.0.0, while the version in GimmeMotifs is still 1.0.2

**Describe the solution you'd like**
A clear and concise description of what you want to happen.
Is it possible to use the latest version when doing motif discovery?

**Describe alternatives you've considered**
That would be a big help, as version 2.0.0 is made in 2019 with improvement.

thanks & best regards",wangmhan,https://github.com/vanheeringen-lab/gimmemotifs/issues/127
MDU6SXNzdWU2NDk3Mjg3NTQ=,gimme motifs --known ERROR,CLOSED,2020-07-02T08:10:35Z,2020-09-29T13:41:56Z,2020-09-29T13:41:56Z,"Hi,

I am attempting to run gimme motifs with --known parameter on a fresh installation but it fails giving several errors.

The installation was performed following instructions e.g. creating an environment using Conda. The installation is done on an hpcs cluster at the institute where I am working.

The pipe I am sending is the following:

gimme motifs $PEAK $$FOLDER --size 200 --background $BG_PEAKS -g hg38 --known --nthreads 5
The error I get is the following:

2020-07-02 09:31:27,868 - INFO - skipping de novo
2020-07-02 09:31:27,872 - INFO - creating motif scan tables
2020-07-02 09:52:01,351 - INFO - calculating stats
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... ' nan' ' nan' ' nan']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U4'), dtype('<U4')) -> dtype('<U4')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... ' nan' ' nan' ' nan']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U4'), dtype('<U4')) -> dtype('<U4')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... ' nan' ' nan' ' nan']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U4'), dtype('<U4')) -> dtype('<U4')
...
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U4'), dtype('<U4')) -> dtype('<U4')
[1. 1. 1. ... 0. 0. 0.]
[' nan' ' nan' ' nan' ... ' nan' ' nan' ' nan']
ufunc 'subtract' did not contain a loop with signature matching types (dtype('<U4'), dtype('<U4')) -> dtype('<U4')
Traceback (most recent call last):
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/Envgimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/Envgimme/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/Envgimme/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 183, in motifs
    ncpus=args.ncpus,
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/Envgimme/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 160, in calc_stats_iterator
    for motif_id, s, ret in it:
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/Envgimme/lib/python3.7/site-packages/gimmemotifs/stats.py"", line 284, in _mp_stats
    ret = job.get()
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/Envgimme/lib/python3.7/multiprocessing/pool.py"", line 657, in get
    raise self._value
multiprocessing.pool.MaybeEncodingError: Error sending result: '<multiprocessing.pool.ExceptionWithTraceback object at 0x7ff7e81e11d0>'. Reason: 'Pic
klingError(""Can't pickle <class 'numpy.core._exceptions.UFuncTypeError'>: it's not the same object as numpy.core._exceptions.UFuncTypeError"")'

I tried to check on previous FAQ and forums but I cold not find anyone with the same issue.
Thanks in advance for the help
Francesco

",fgualdr,https://github.com/vanheeringen-lab/gimmemotifs/issues/128
MDU6SXNzdWU2NTIwOTYyNzI=,Warn if intervals are too small,CLOSED,2020-07-07T07:59:31Z,2021-04-13T08:43:41Z,2021-04-13T08:43:41Z,See  #123,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/129
MDU6SXNzdWU2NTM5MjQxNzU=,gimme motifs pyfaidx.FetchError,CLOSED,2020-07-09T09:47:50Z,2020-07-29T11:50:21Z,2020-07-29T11:50:21Z,"Hi, 

I tried to run gimme motifs, and it end with error.

My steps:
genomepy install ftp://ftp.ensembl.org/pub/release-97/fasta/gallus_gallus/dna/Gallus_gallus.GRCg6a.dna_sm.toplevel.fa.gz url --localname gg6_ensembl97
ln -s ~/references/ens_g6_atac/Gg6_extended_200819.filter.gtf 
gimme motifs -N 8 -p JASPAR2020_vertebrates -g gg6_ensembl97 in.bed out_dir

I attached the error log.

**Installation information (please complete the following information):**
 - OS: CentOS 7.8
 - Installation: conda install gimmemotifs
 - Version 0.14.4
genomepy --version 0.8.3

[slurm-13091988.out.txt](https://github.com/vanheeringen-lab/gimmemotifs/files/4895907/slurm-13091988.out.txt)
",wangmhan,https://github.com/vanheeringen-lab/gimmemotifs/issues/130
MDU6SXNzdWU2NTQwNTg3MjA=,background usage,CLOSED,2020-07-09T13:25:06Z,2023-01-19T09:07:36Z,2023-01-19T09:07:36Z,"Hi,

mine is a question as I was comparing results between Gimme Motifs (to check known enrichments) and Homer.
I am providing a BED file with a list of background sites as I am in Homer but for some high GC rich areas results are different which made me wonder whether with gimme motif when I provide background sites there is no GC normalisation of any sort.
am I correct?

Thanks

Francesco",fgualdr,https://github.com/vanheeringen-lab/gimmemotifs/issues/131
MDU6SXNzdWU2NjYwMDM4NzQ=,"Error: Sorry, motif prediction tool X is not supported",CLOSED,2020-07-27T06:03:32Z,2023-01-19T08:49:41Z,2023-01-19T08:49:41Z,"> I have seen that some people had the same problem than I when running gimmemotifs.
> Here the error message:
> ""Sorry, motif prediction tool trawler is not supported""

> Do you have solved the problem?
> I have the same error message with JASPAR.

> Could you help
> Many thanks
> Amandine",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/134
MDU6SXNzdWU2Njc4MDA3MDk=,gimme motifs -p HOMER get error,CLOSED,2020-07-29T12:19:39Z,2020-09-29T13:41:56Z,2020-09-29T13:41:56Z,"Hi,

**Describe the bug**
I run gimme motifs. With default motif database, it is fine. But when I change to HOMER motifs, it get error.

**To Reproduce**
my command is:
gimme motifs  -N 8 -g gg6_ensembl97 --known -p HOMER N18_dap_CMchondrocyte_edit.bed 

the bed file looks like this: 
2       137220997       137222121
1       118197558       118198419
2       135379155       135380077
1       88023060        88024016
2       142106184       142108062
2       123617608       123618658
7       25938892        25940560
2       32051752        32052880
1       36215876        36216752
7       5105571 5106653

**Expected behavior**
in the results folder, I only get generated_background.gc.fa  gimme.roc.report.txt  motif_scan_results.
No report files.

**Error logs**
The log file:
2020-07-29 09:49:10,195 - INFO - creating background (matched GC%)
2020-07-29 09:49:40,668 - INFO - skipping de novo
2020-07-29 09:49:40,668 - INFO - creating motif scan tables
2020-07-29 10:06:01,029 - INFO - calculating stats
2020-07-29 10:06:23,173 - INFO - selecting non-redundant motifs
2020-07-29 10:06:27,180 - INFO - selected 9 non-redundant motifs: ROC AUC 0.824, PR AUC 0.478
2020-07-29 10:06:27,195 - ERROR - Could not open N18_gimme_CMchondrocyte/motif_scan_results/YTAATTRAWWCCAGATGT_Pitx1:Ebox(Homeobox,bHLH)/Hindlimb-Pitx1-ChIP-Seq(GSE41591)/Homer.matches.bed for writing

**Installation information (please complete the following information):**
 - OS: CentOS 7.8
- Version [0.14.4]

**Additional context**
I attached my bed file.
[N18_dap_CMchondrocyte_edit.bed.zip](https://github.com/vanheeringen-lab/gimmemotifs/files/4994770/N18_dap_CMchondrocyte_edit.bed.zip)

Thanks!",wangmhan,https://github.com/vanheeringen-lab/gimmemotifs/issues/135
MDU6SXNzdWU2NjkyMzgxNDI=,"Fitting RF failed, input contains NaN",CLOSED,2020-07-30T22:13:16Z,2020-11-06T21:09:54Z,2020-11-06T21:09:54Z,"Hi,

**Describe the bug**
Running gimme maelstrom errors out part way through with the error messages below. Seems the last files I am able to generate from this package are activity*(hypergeom | lightningclassification |  mwu.score ).score.out.tx. And an html file is not produced. There are many warnings about my scikit version (that I have mostly omitted in the logs here), but, from issues raised previously I was unable to run this software without using previous versions of it. 

**To Reproduce**
command: gimme maelstrom $pathway/$fileofinterest.bed $mygenome $outputdirectory
My bed file does not contain special characters or missing values

**Expected behavior**
HTML output with beautiful results 

**Error logs**
2020-07-30 12:16:45,804 - INFO - Starting maelstrom
2020-07-30 12:16:45,957 - INFO - motif scanning (counts)
2020-07-30 12:16:45,960 - INFO - reading table
2020-07-30 12:16:52,614 - INFO - setting threshold
2020-07-30 12:16:59,557 - INFO - creating count table
2020-07-30 12:21:48,994 - INFO - done
2020-07-30 12:21:54,421 - INFO - creating dataframe
2020-07-30 12:22:19,360 - INFO - motif scanning (scores)
2020-07-30 12:22:19,363 - INFO - reading table
2020-07-30 12:22:36,418 - INFO - creating score table (z-score, GC%)
2020-07-30 12:29:40,551 - INFO - done
2020-07-30 12:29:45,892 - INFO - creating dataframe
2020-07-30 12:31:36,255 - INFO - Fitting LightningClassification
/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/externals/joblib/__init__.py:15: FutureWarning: sklearn.externals.joblib is deprecated in 0.21 and will be removed in 0.23. Please import this functionality directly from joblib, which can be installed with: pip install joblib. If this warning is raised when loading pickled models, you may need to re-serialize those models with scikit-learn 0.21+.
  warnings.warn(msg, category=FutureWarning)
/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/externals/six.py:31: FutureWarning: The module is deprecated in version 0.21 and will be removed in version 0.23 since we've dropped support for Python 2.7. Please rely on the official version of six (https://pypi.org/project/six/).
  ""(https://pypi.org/project/six/)."", FutureWarning)
/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/externals/joblib/__init__.py:15: FutureWarning: sklearn.externals.joblib is deprecated in 0.21 and will be removed in 0.23. Please import this functionality directly from joblib, which can be installed with: pip install joblib. If this warning is raised when loading pickled models, you may need to re-serialize those models with scikit-learn 0.21+.
  warnings.warn(msg, category=FutureWarning)
/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/externals/six.py:31: FutureWarning: The module is deprecated in version 0.21 and will be removed in version 0.23 since we've dropped support for Python 2.7. Please rely on the official version of six (https://pypi.org/project/six/).
  ""(https://pypi.org/project/six/)."", FutureWarning)
2020-07-30 14:25:33,211 - INFO - Done
2020-07-30 14:25:42,643 - INFO - Fitting MWU
2020-07-30 14:26:33,706 - INFO - Done
2020-07-30 14:26:38,950 - INFO - Fitting Hypergeom
2020-07-30 14:26:59,895 - INFO - Done
2020-07-30 14:27:08,941 - INFO - Fitting RF
2020-07-30 14:27:09,093 - WARNING - Method rf with scoring score failed
2020-07-30 14:27:09,093 - WARNING - Input contains NaN, infinity or a value too large for dtype('float32').
2020-07-30 14:27:09,093 - WARNING - Skipping
  warnings.warn(msg, category=FutureWarning)
/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/externals/six.py:31: FutureWarning: The module is deprecated in version 0.21 and will be removed in version 0.23 since we've dropped support for Python 2.7. Please rely on the official version of six (https://pypi.org/project/six/).
  ""(https://pypi.org/project/six/)."", FutureWarning)
Traceback (most recent call last):
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/gimmemotifs/commands/maelstrom.py"", line 37, in maelstrom
    gc=gc,
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/gimmemotifs/maelstrom.py"", line 389, in run_maelstrom
    fname, score_table, outdir, method, scoring, ncpus=ncpus
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/gimmemotifs/maelstrom.py"", line 79, in moap_with_table
    ncpus=ncpus,
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/gimmemotifs/moap.py"", line 1067, in moap
    clf.fit(motifs, df)
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/gimmemotifs/moap.py"", line 771, in fit
    orc.fit(df_X.values, y)
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/multiclass.py"", line 239, in fit
    for i, column in enumerate(columns))
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/joblib/parallel.py"", line 1029, in __call__
    if self.dispatch_one_batch(iterator):
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/joblib/parallel.py"", line 847, in dispatch_one_batch
    self._dispatch(tasks)
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/joblib/parallel.py"", line 765, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/joblib/_parallel_backends.py"", line 208, in apply_async
    result = ImmediateResult(func)
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/joblib/_parallel_backends.py"", line 572, in __init__
    self.results = batch()
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/joblib/parallel.py"", line 253, in __call__
    for func, args, kwargs in self.items]
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/joblib/parallel.py"", line 253, in <listcomp>
    for func, args, kwargs in self.items]
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/multiclass.py"", line 79, in _fit_binary
    estimator.fit(X, y)
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/ensemble/_forest.py"", line 295, in fit
    X = check_array(X, accept_sparse=""csc"", dtype=DTYPE)
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/utils/validation.py"", line 578, in check_array
    allow_nan=force_all_finite == 'allow-nan')
  File ""/mnt/blelloch/Boileau/conda/envs/genomepy/lib/python3.6/site-packages/sklearn/utils/validation.py"", line 60, in _assert_all_finite
    msg_dtype if msg_dtype is not None else X.dtype)
ValueError: Input contains NaN, infinity or a value too large for dtype('float32').

**Installation information (please complete the following information):**
Linux
# Name                    Version                   Build  Channel
bedtools                  2.29.2               hc088bd4_0    bioconda
biopython                 1.77                     pypi_0    pypi
genomepy                  0.8.4                    pypi_0    pypi
gimmemotifs               0.14.4                   pypi_0    pypi
pandas                    1.1.0                    pypi_0    pypi
pyarrow                   1.0.0                    pypi_0    pypi
pybedtools                0.8.1                    pypi_0    pypi
pycparser                 2.20                       py_2  
pyfaidx                   0.5.9              pyh864c0ab_1    bioconda
pyopenssl                 19.1.0                     py_1  
pyparsing                 2.4.7                      py_0  
pysam                     0.16.0.1                 pypi_0    pypi
pysocks                   1.7.1                    py36_0  
pytest                    5.4.3                    py36_0  
python                    3.6.10               h7579374_2  
scikit-learn              0.22.1           py36hd81dba3_0  

**Additional context**
Add any other context about the problem here.
",ryanmboileau,https://github.com/vanheeringen-lab/gimmemotifs/issues/136
MDU6SXNzdWU2NzQyNTIwOTg=,IndexError: list index out of range,CLOSED,2020-08-06T11:48:34Z,2020-08-07T09:32:15Z,2020-08-07T09:32:15Z,"**Describe the bug**
Running gimme motifs fails with some bed files with the following error:

2020-08-06 13:44:11,238 - INFO - creating background (matched GC%)
Traceback (most recent call last):
  File ""/Users/elinorg/Unix/miniconda3/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/Users/elinorg/Unix/miniconda3/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/Users/elinorg/Unix/miniconda3/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 75, in motifs
    number=10000,
  File ""/Users/elinorg/Unix/miniconda3/lib/python3.7/site-packages/gimmemotifs/background.py"", line 122, in create_background_file
    m = MatchedGcFasta(inputfile, genome, number=number, size=size)
  File ""/Users/elinorg/Unix/miniconda3/lib/python3.7/site-packages/gimmemotifs/background.py"", line 559, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/Users/elinorg/Unix/miniconda3/lib/python3.7/site-packages/gimmemotifs/background.py"", line 511, in matched_gc_bedfile
    bin_count[i] += 1
IndexError: list index out of range

**To Reproduce**
Steps to reproduce the behavior: gimme motifs consensus5_clean2.bed -g hg38 consensus5_clean_hg38

**Expected behavior**
Program to start running

**Error logs**
No files created

**Installation information (please complete the following information):**
 - OS: OSX
 - Installation conda
 - Version 0.14.4

**Additional context**
It works fine with other bed files.
[consensus5_clean2.bed.zip](https://github.com/vanheeringen-lab/gimmemotifs/files/5034578/consensus5_clean2.bed.zip)

",tonisorg,https://github.com/vanheeringen-lab/gimmemotifs/issues/137
MDU6SXNzdWU2NzY2OTUxMTg=,Gimme Motifs command region file,CLOSED,2020-08-11T08:44:06Z,2023-01-19T09:07:05Z,2023-01-19T09:07:05Z,"**Describe the bug**
When I use a region file as an input for gimme motifs (using  a suplied GRCh38.p13.fa), it crashes.
header of an example region file:

```
1:995733-996233
1:3685245-3685745
1:6581859-6582359
1:6824626-6825126
1:7555867-7556367
```

command to run it:

```
gimme motifs  \
/home/jsmits/Epithelial_fate_KC_LSC/Python_analysis/2020-08-04/differential_TP63_regions_LSC.txt \
/home/jsmits/gimme_output \
--denovo \
-g /home/jsmits/tools/GRCh38.p13/GRCh38.p13.fa \
-N 12 \ 
```

When I however take the exact same regions but turn them into a tab seperated bed file, gimme motifs runs succesfully with exactly the same input.

**Expected behavior**
Gracefully accepting regional file inputs, eventhought its weird it crashes at the first stage (creating background from the genome fastq) so I'm not sure whats going on there.

**Error logs**
```
2020-08-11 10:34:37,020 - INFO - creating background (matched GC%)
Please provide input file in BED or FASTA format
Traceback (most recent call last):
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/background.py"", line 470, in matched_gc_bedfile
    fa = Fasta(matchfile)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/fasta.py"", line 21, in __init__
    f = open(fname, ""r"")
FileNotFoundError: [Errno 2] No such file or directory: '/home/jsmits/gimme_output/input.w200.bed'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/jsmits/anaconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 93, in motifs
    number=10000,
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/background.py"", line 120, in create_background_file
    m = MatchedGcFasta(inputfile, genome, number=number, size=size)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/background.py"", line 564, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/background.py"", line 479, in matched_gc_bedfile
    fields = pd.read_csv(matchfile, comment=""#"", nrows=10, sep=""\t"").shape[1]
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/pandas/io/parsers.py"", line 676, in parser_f
    return _read(filepath_or_buffer, kwds)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/pandas/io/parsers.py"", line 448, in _read
    parser = TextFileReader(fp_or_buf, **kwds)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/pandas/io/parsers.py"", line 880, in __init__
    self._make_engine(self.engine)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/pandas/io/parsers.py"", line 1114, in _make_engine
    self._engine = CParserWrapper(self.f, **self.options)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/pandas/io/parsers.py"", line 1891, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File ""pandas/_libs/parsers.pyx"", line 374, in pandas._libs.parsers.TextReader.__cinit__
  File ""pandas/_libs/parsers.pyx"", line 674, in pandas._libs.parsers.TextReader._setup_parser_source
FileNotFoundError: [Errno 2] File /home/jsmits/gimme_output/input.w200.bed does not exist: '/home/jsmits/gimme_output/input.w200.bed'

```


**Installation information (please complete the following information):**
```
 - OS: mb07
 - conda (updated with pip)
 - gimmemotifs               0.14.4+78.g5555099          pypi_0    pypi

```",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/139
MDU6SXNzdWU2NzY3MTI2ODg=,Gimme motifs command costum background,CLOSED,2020-08-11T09:11:16Z,2023-01-19T08:49:23Z,2023-01-19T08:49:23Z,"**Describe the bug**
Trying to supply a costum background in a bed format for denovo motif analysis, causes it to crash.

head costum background bed file:

```
1	882858	883358
1	971241	971741
1	980009	980509
1	1003405	1003905
1	1006840	1007340
1	1021397	1021897
1	1025675	1026175
1	1143917	1144417
1	1163003	1163503
1	1176991	1177491
```

head input file:

```
1	995733	996233
1	3685245	3685745
1	6581859	6582359
1	6824626	6825126
1	7555867	7556367
1	8153625	8154125
1	9331490	9331990
1	9665271	9665771
1	11139718	11140218
1	11495922	11496422
```

code trying to run gimme motifs with a specific background:
```
gimme motifs   \
/home/jsmits/Epithelial_fate_KC_LSC/Python_analysis/2020-08-04/differential_TP63_regions_LSC.bed   \
/home/jsmits/gimme_LSC_TP63_bg_output   \
-b /home/jsmits/Epithelial_fate_KC_LSC/Python_analysis/2020-08-04/non-differential_TP63_regions.bed  \
--denovo   \
-g /home/jsmits/tools/GRCh38.p13/GRCh38.p13.fa   \
-N 8
```

**To Reproduce**
Run a gimme motif command with a custom bedfile as a background

**Expected behavior**
Accepting bed files as a background to compare with.

**Error logs**
```
2020-08-11 11:03:29,539 - INFO - starting full motif analysis
2020-08-11 11:03:29,602 - INFO - using size of 200, set size to 0 to use original region size
2020-08-11 11:03:29,603 - INFO - preparing input from BED
2020-08-11 11:03:29,895 - INFO - Copying custom background file /home/jsmits/Epithelial_fate_KC_LSC/Python_analysis/2020-08-04/non-differential_TP63_regions.bed to /home/jsmits/gimme_LSC_TP63_bg/intermediate/prediction.bg.fa.
Traceback (most recent call last):
  File ""/home/jsmits/anaconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 112, in motifs
    ""size"": args.size,
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/denovo.py"", line 609, in gimme_motifs
    params.get(""custom_background"", None),
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/denovo.py"", line 316, in create_backgrounds
    custom_background=custom_background,
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/denovo.py"", line 259, in create_background
    f = Fasta(bg_file)
  File ""/home/jsmits/anaconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/fasta.py"", line 25, in __init__
    raise IOError(""Not a valid FASTA file"")
OSError: Not a valid FASTA file

```
**Installation information (please complete the following information):**
```
 - OS: mb07
 - conda (updated with pip)
 - gimmemotifs               0.14.4+78.g5555099          pypi_0    pypi
```

",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/140
MDU6SXNzdWU2ODMyNjAxNjk=,Cross-species comparison,CLOSED,2020-08-21T04:53:30Z,2021-04-13T08:21:48Z,2021-04-13T08:21:47Z,"Hi!

I have fasta sequences from open regions (same cell lines) from mouse and human. I wonder what would be the best way to do differential motif enrichment analysis of this data with your tool, so I can get motifs that are enriched in mouse compared to human and vice versa? In **gimme motifs**, I can choose my background sequence set but I have to specify the genome (otherwise it gives me an error), and since here I have two genomes (hg19 and mm10) I am not sure how to proceed. There is also **gimme maelstrom** command, but it doesn't take fasta sequences and as I understood here you need to provide different experiments, which are done in the same species. So my question is, what is the best way to analyze my data with your tool?

Thank you! ",fransilvion,https://github.com/vanheeringen-lab/gimmemotifs/issues/141
MDU6SXNzdWU3MTYyNzU4MTU=,"FIX for ValueError: Shape of passed values is (13933, 1796), indices imply (14, 1796)",CLOSED,2020-10-07T07:31:12Z,2021-05-28T14:30:13Z,2021-05-28T14:30:13Z,"If you get an error like the following after upgrading to GimmeMotifs >=0.15, you can fix it by deleting the GimmeMotifs cache directory `~/.cache/gimmemotifs`.

```
Traceback (most recent call last):
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/gimmemotifs/commands/maelstrom.py"", line 33, in maelstrom
    run_maelstrom(
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/gimmemotifs/maelstrom.py"", line 343, in run_maelstrom
    counts = scan_regionfile_to_table(
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 164, in scan_regionfile_to_table
    s.set_threshold(fpr=FPR)
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 958, in set_threshold
    self._threshold = pd.concat((self._threshold, df), axis=1)
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/pandas/core/reshape/concat.py"", line 287, in concat
    return op.get_result()
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/pandas/core/reshape/concat.py"", line 502, in get_result
    new_data = concatenate_block_managers(
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/pandas/core/internals/concat.py"", line 84, in concatenate_block_managers
    return BlockManager(blocks, axes)
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/pandas/core/internals/managers.py"", line 149, in __init__
    self._verify_integrity()
  File ""/home/simon/anaconda3/envs/gimme-0.15.1/lib/python3.8/site-packages/pandas/core/internals/managers.py"", line 326, in _verify_integrity
    raise construction_error(tot_items, block.shape[1:], self.axes)
ValueError: Shape of passed values is (13933, 1796), indices imply (14, 1796)
```",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/145
MDU6SXNzdWU3MTc4NTIwMDA=,Setting the Region size to use for motif prediction as 0 or 2000 reported 'ValueError: a must be greater than 0 unless no samples are taken',CLOSED,2020-10-09T04:57:58Z,2023-01-19T08:49:01Z,2023-01-19T08:49:01Z,"Hello,

    I have installed the GimmeMotifs successfully. It was running normally when setting region size (-s) as 200 (default) or 400.
2020-10-09 04:30:18,410 - INFO - creating background (matched GC%)
2020-10-09 04:32:13,478 - INFO - starting full motif analysis
2020-10-09 04:32:13,479 - INFO - using size of 200, set size to 0 to use original region size
2020-10-09 04:32:13,479 - INFO - preparing input from BED
2020-10-09 04:34:10,734 - INFO - starting motif prediction (xl)
2020-10-09 04:34:10,734 - INFO - tools: MEME, BioProspector, Homer
............

    However, the bug will be reported when changing the region size (-s) into 2000 or 0
2020-10-09 04:29:09,731 - INFO - creating background (matched GC%)
Traceback (most recent call last):
  File ""/home/ec2-user/anaconda2/envs/py37/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/ec2-user/anaconda2/envs/py37/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/home/ec2-user/anaconda2/envs/py37/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 94, in motifs
    number=10000,
  File ""/home/ec2-user/anaconda2/envs/py37/lib/python3.7/site-packages/gimmemotifs/background.py"", line 120, in create_background_file
    m = MatchedGcFasta(inputfile, genome, number=number, size=size)
  File ""/home/ec2-user/anaconda2/envs/py37/lib/python3.7/site-packages/gimmemotifs/background.py"", line 564, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/home/ec2-user/anaconda2/envs/py37/lib/python3.7/site-packages/gimmemotifs/background.py"", line 538, in matched_gc_bedfile
    df.loc[df[""bin""] == b, [""chrom"", ""start"", ""end""]].sample(n).to_csv(
  File ""/home/ec2-user/anaconda2/envs/py37/lib/python3.7/site-packages/pandas/core/generic.py"", line 4993, in sample
    locs = rs.choice(axis_length, size=n, replace=replace, p=weights)
  File ""mtrand.pyx"", line 894, in numpy.random.mtrand.RandomState.choice
ValueError: a must be greater than 0 unless no samples are taken

And I want to predict the Motif sequence relying on the input original regions or broad regions. Could you have any suggestions about this issue?
",echoduan,https://github.com/vanheeringen-lab/gimmemotifs/issues/146
MDU6SXNzdWU3MjE0NjI1MjA=,API for coverage_table and combine_peaks,CLOSED,2020-10-14T13:32:24Z,2021-04-13T06:58:26Z,2021-04-13T06:58:26Z,Both `coverage_table` and `combine_peaks` should be callable from Python.,simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/147
MDU6SXNzdWU3MjI3NDU2MTY=,"gimme maelstrom error: ""TypeError: expected str, bytes or os.PathLike object, not list""",CLOSED,2020-10-15T23:16:35Z,2020-10-19T17:47:08Z,2020-10-19T17:47:08Z,"Hi,
I get an error using both my own input file as well as the example input file (below) when trying to run `gimme maelstrom test ""mm10"" output`

Thanks for your help!

```
loc    cluster
chr15:49258903-49259103    NK
chr10:72370313-72370513    NK
chr4:40579259-40579459    Monocytes
chr10:82225678-82225878    T-cells
chr5:134237941-134238141    B-cells
chr5:58858731-58858931    B-cells
chr20:24941608-24941808    NK
chr5:124203116-124203316    NK
chr17:40094476-40094676    Erythroblast
chr17:28659327-28659527    T-cells
```

Std out:

```
2020-10-15 16:10:57,689 - INFO - Starting maelstrom
2020-10-15 16:10:57,722 - INFO - motif scanning (counts)
2020-10-15 16:10:57,725 - INFO - reading table
Traceback (most recent call last):
  File ""/home/gd/software/miniconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/commands/maelstrom.py"", line 33, in maelstrom
    run_maelstrom(
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/maelstrom.py"", line 343, in run_maelstrom
    counts = scan_regionfile_to_table(
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 154, in scan_regionfile_to_table
    np.median([len(seq) for seq in as_fasta(check_regions, genome=genome).seqs])
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/utils.py"", line 692, in as_fasta
    return Fasta(fdict=as_seqdict(to_convert, genome, minsize))
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/functools.py"", line 875, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/utils.py"", line 614, in _as_seqdict_list
    return _genomepy_convert(to_convert, genome, minsize)
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/utils.py"", line 534, in _genomepy_convert
    g.track2fasta(to_convert, tmpfile.name)
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/genomepy/genome.py"", line 361, in track2fasta
    track_type = self.get_track_type(track)
  File ""/home/gd/software/miniconda3/envs/gimme/lib/python3.8/site-packages/genomepy/genome.py"", line 334, in get_track_type
    with open(track) as fin:
TypeError: expected str, bytes or os.PathLike object, not list
```

",dgoekbuget,https://github.com/vanheeringen-lab/gimmemotifs/issues/148
MDU6SXNzdWU3MjQ0MTc0NTA=,gimme maelstrom aggregation,CLOSED,2020-10-19T08:58:01Z,2021-04-13T09:03:54Z,2021-04-13T09:03:54Z,"Hi,

I am trying to run gimme maelstrom from command line.
From the code and description in principle is possible to specify the type of aggregation of the score.
How can I specify it from command line when submitting gimme from a bash script?

Thanks
Francesco",fgualdr,https://github.com/vanheeringen-lab/gimmemotifs/issues/149
MDU6SXNzdWU3MjczODA4NDA=,Browser depedent motif % sort,CLOSED,2020-10-22T13:17:00Z,2023-01-19T08:48:31Z,2023-01-19T08:48:30Z,"**Describe the bug**
The % containing motif sort in the browser is probably on string and not on number.
E.g. the 25% GATA motif from this dataset:
http://ocimum.science.ru.nl/tmp/danRer11/gimme.vertebrate.v5.0.pfm/10000/20/gimme.maelstrom.report.html
is sorted to the bottum in Internet explorer and google chrome,
while firefox sorts it above the 2% motifs and below the 3% motifs.

It also breaks at the 1 and >1%

**To Reproduce**
Look at the http://ocimum.science.ru.nl/tmp/danRer11/gimme.vertebrate.v5.0.pfm/10000/20/gimme.maelstrom.report.html

**Expected behavior**
Sort based on floats and not strings?",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/151
MDU6SXNzdWU3MzEzMjExOTU=,gimme scan produces no results when scanning many regions,CLOSED,2020-10-28T10:38:23Z,2021-04-13T10:33:01Z,2021-04-13T10:33:01Z,"**gimme scan produces no results when scanning many regions**
I tried to scan a large ChIP-seq file with gimme scan, but somehow I got zero hits. I used the following command:
`gimme scan Oth.ALL.05.Sox2.AllCell.bed -g mm10 -p examples/example.pfm`
I get only this output when the script is finished:
```
# GimmeMotifs version 0.15.1
# Input: Oth.ALL.05.Sox2.AllCell.bed
# Motifs: examples/example.pfm
# FPR: 0.01 (mm10)
# Scoring: logodds score
2020-10-28 10:49:22,893 - INFO - determining FPR-based threshold
```
The script is running for quite some time, so I think the scanning is happening. Maybe it's a silent crash that prevents the output from being written.
When I take only the first 1000 lines of the bed file, everything works flawlessly:
`head -n 1000 Oth.ALL.05.Sox2.AllCell.bed > Oth.ALL.05.Sox2.AllCell_head1000.bed`
`gimme scan Oth.ALL.05.Sox2.AllCell_head1000.bed -g mm10 -p examples/example.pfm`
```
# GimmeMotifs version 0.15.1
# Input: Oth.ALL.05.Sox2.AllCell_head1000.bed
# Motifs: examples/example.pfm
# FPR: 0.01 (mm10)
# Scoring: logodds score
chr1:3676482-3676757    pfmscan misc_feature    236     244     10.69957607887771       +       .       motif_name ""AP1"" ; motif_instance ""ATGAGTCAT""
chr1:4416781-4416972    pfmscan misc_feature    121     134     13.273571109612698      +       .       motif_name ""CTCF"" ; motif_instance ""GCGCCACCTTGTGG""
chr1:4416785-4417017    pfmscan misc_feature    117     130     13.273571109612698      +       .       motif_name ""CTCF"" ; motif_instance ""GCGCCACCTTGTGG""
[truncated...]
```
I don't think it's a problem with my bed file. To be extra sure, I removed all columns except 1-3, I removed all ""weird"" chromosomes (contigs without proper numbering etc), I sorted it with bedtools sort...
When I split the file into ~20 chunks (one per chromosome), all 20 chunks produce the expected output. So I don't think its a corrupt entry in the bed file, but more the total number of entries that causes the problem.
Here are the first 5 lines of the file:
```
chr1    3005524 3005922
chr1    3005528 3005943
chr1    3023143 3023434
chr1    3042827 3043208
chr1    3042844 3043243
```
The pfm file I used is from the examples directory of gimme, so it should be correct.

**To Reproduce**
Steps to reproduce the behavior:
1. download a large bed file, e.g. from [https://chip-atlas.org/peak_browser](https://chip-atlas.org/peak_browser)
2. scan it with `gimme scan your_large.bed -g mm10 -p examples/example.pfm`
3. receive empty output file

**Expected behavior**
gimme scan should print hits even when scanning many regions.

**Error logs**
I don't get any errors or crashes, just a result file without hits. Is there any way to access the logs?

**Installation information (please complete the following information):**
 - OS: Linux (Ubuntu)
 - Installation: conda/4.9.0 requests/2.24.0 CPython/3.8.3 Linux/4.15.0-48-generic ubuntu/18.04.4 glibc/2.27
 - Version: GimmeMotifs v0.15.1
 - installed mm10 with genomepy, including annotation

**Additional context**
A workaround is to split my input file into many chunks and scan all of them separately, and merge the results later. This works nicely, but of course it's ugly.
",LKremer,https://github.com/vanheeringen-lab/gimmemotifs/issues/152
MDU6SXNzdWU3Mzc0NDUzMzM=,gimme motif error after updating conda,CLOSED,2020-11-06T04:20:21Z,2021-04-13T08:58:54Z,2021-04-13T08:58:54Z,"Hi, i was running gimme motifs a while ago and suddenly it starting giving me the following error. could u please help me with this?
File ""/home/dimurali/miniconda3/envs/gimme/bin/gimme"", line 8, in <module>
    from gimmemotifs.cli import cli
  File ""/home/dimurali/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/__init__.py"", line 61, in <module>
    from . import denovo      # noqa: F401
  File ""/home/dimurali/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 52, in <module>
    from gimmemotifs.report import create_denovo_motif_report
  File ""/home/dimurali/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/report.py"", line 63, in <module>
    class ExtraStyler(Styler):
  File ""/home/dimurali/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/report.py"", line 72, in ExtraStyler
    template = env.get_template(""table.tpl"")
  File ""/home/dimurali/miniconda3/envs/gimme/lib/python3.8/site-packages/jinja2/environment.py"", line 883, in get_template
    return self._load_template(name, self.make_globals(globals))
  File ""/home/dimurali/miniconda3/envs/gimme/lib/python3.8/site-packages/jinja2/environment.py"", line 857, in _load_template
    template = self.loader.load(self, name, globals)
  File ""/home/dimurali/miniconda3/envs/gimme/lib/python3.8/site-packages/jinja2/loaders.py"", line 429, in load
    raise TemplateNotFound(name)
jinja2.exceptions.TemplateNotFound: table.tpl",dimurali93,https://github.com/vanheeringen-lab/gimmemotifs/issues/153
MDU6SXNzdWU3NDAzMzYzMTY=,meaning of this error ?,CLOSED,2020-11-11T00:06:27Z,2021-04-13T06:57:37Z,2021-04-13T06:57:37Z,"
HI all, 
while running gimme-motifs, i am getting the following error . could you help me understand this ?
/home/dimurali/anaconda3/envs/gimme/lib/python3.8/subprocess.py:849: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stderr = io.open(errread, 'rb', bufsize)

",dimurali93,https://github.com/vanheeringen-lab/gimmemotifs/issues/154
MDU6SXNzdWU3NTMyNzkwOTg=,configuration deleted while running multiple gimme jobs on cluster,CLOSED,2020-11-30T08:44:51Z,2023-01-19T09:06:35Z,2023-01-19T09:06:35Z,"Hi,

I am running gimme on a cluster sending different jobs in parallel.
To solve the cache issue I am using the trick of creating a temporary cache:

TMPDIR=/tmp_dmso/
NEW_CACHE=$TMPDIR/cache
mkdir -p $NEW_CACHE
if [ -z $XDG_CACHE_HOME ]; then
    XDG_CACHE_HOME=$HOME/.cache
fi
cp -r $XDG_CACHE_HOME/gimmemotifs $NEW_CACHE/
export XDG_CACHE_HOME=$NEW_CACHE

All is fine unless when I run multiple jobs in parallel and the gimmeconfig gets delegated.
Is there a way to specify the config file for each run?
So that gimme does not re-create it each time?",fgualdr,https://github.com/vanheeringen-lab/gimmemotifs/issues/155
MDU6SXNzdWU3NTUyODA5MTA=,ValueError interrrupting gimme motifs command,CLOSED,2020-12-02T13:37:03Z,2020-12-10T07:48:43Z,2020-12-10T07:48:43Z,"**Describe the bug**
So I have been running `gimme motifs` recently (new user), and today I stumbled upon this one error that keeps popping up that I could not trace why. I have two different sets of peaks, in the form of narrowPeak files, and they are a subset of peaks from the original narrowPeak files spit out by MACS2. These two narrowPeak files are replicated peaks (but not tightly concordant, so the regions are not exactly the same). Oddly, I successfully run `gimme motifs` on one narrowPeak file (replicate 1), while the program spits out a Value Error when run with another narrowPeak file (replicate 3). They are similarly formatted files and I have checked to see if there are any weird lines that is messing up the script, but to no avail.

**To Reproduce**
Here's the line I run for `gimme motifs`:
```
gimme motifs bdp2-macs2-rep1_peaks_filtered_rifin_only.narrowPeak gimme.BDP2.rifins.upstream.rep1.test -g /Users/sufyazi/Bioinformatics/PhD_works/BDP2_project/genome_db/PlasmoDB-34_Pfalciparum3D7_Genome.fasta -f 0.7
```


**Expected behavior**
When I run this command, I got these lines

```
2020-12-03 00:06:40,619 - INFO - creating background (matched GC%)
/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/subprocess.py:849: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stderr = io.open(errread, 'rb', bufsize)
2020-12-03 00:06:43,476 - INFO - starting full motif analysis
2020-12-03 00:06:43,476 - INFO - using size of 200, set size to 0 to use original region size
2020-12-03 00:06:43,477 - INFO - preparing input from BED
2020-12-03 00:06:44,442 - INFO - starting motif prediction (xl)
2020-12-03 00:06:44,442 - INFO - tools: MEME, BioProspector, Homer
2020-12-03 00:06:44,873 - INFO - all jobs submitted
```
And the run will run rather smoothly (there will be an annoying 'KeyParam' errors popping up but these does not halt the execution of the command and I could get output files when the run completed itself).

**Error logs**
The issue here is, when I run the same command, but with another narrowPeak file:
```
gimme motifs bdp2-macs2-rep3_peaks_filtered_rifin_only.narrowPeak gimme.BDP2.rifins.upstream.rep3.test -g /Users/sufyazi/Bioinformatics/PhD_works/BDP2_project/genome_db/PlasmoDB-34_Pfalciparum3D7_Genome.fasta -f 0.7
```
I get this weird error
```
2020-12-03 00:04:55,534 - INFO - creating background (matched GC%)
/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/subprocess.py:849: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stderr = io.open(errread, 'rb', bufsize)
Traceback (most recent call last):
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/commands/motifs.py"", line 87, in motifs
    create_background_file(
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/background.py"", line 120, in create_background_file
    m = MatchedGcFasta(inputfile, genome, number=number, size=size)
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/background.py"", line 564, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/background.py"", line 538, in matched_gc_bedfile
    df.loc[df[""bin""] == b, [""chrom"", ""start"", ""end""]].sample(n).to_csv(
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/pandas/core/generic.py"", line 4993, in sample
    locs = rs.choice(axis_length, size=n, replace=replace, p=weights)
  File ""mtrand.pyx"", line 902, in numpy.random.mtrand.RandomState.choice
ValueError: a must be greater than 0 unless no samples are taken
```
I have double checked the input narrowPeak files and compared the problematic ones with the working one and there's nothing different structurally that may disrupt the command. I am not sure how to proceed from here. They even have around the same number of peak lines (~150-160 lines) in each file (expected, as they are replicated dataset and a subset of regions associated with a set of genes I'm interested in). 

I hope someone can help me. I provided a ZIP folder with all of the input files I used for the command described above if you would like to try to replicate the error. [gimmemotifs-sufyazi.zip](https://github.com/vanheeringen-lab/gimmemotifs/files/5629561/gimmemotifs-sufyazi.zip)

**Installation information (please complete the following information):**
 - OS: I am using Macbook Pro MacOS to run the analysis.
 - Installation and version: conda package (pypi) gimmemotifs 0.15.1+2.gf3d08fa (I saw you proposed a hotfix for a valueError in one of the issue threads so I tried it but it didn't change anything for me)

**Additional context**
Since the day I installed gimme, whenever I run gimme motifs command even if the run is successful (and I can get output files), my computer would seem to be stuck at trying to resolve KeyParam error (seem to be stuck in a loop) and I usually need to ctrl+C as soon as I see the `run is finished` to manually terminate the command. I could make a separate thread if you want me to report this error. 





",sufyazi,https://github.com/vanheeringen-lab/gimmemotifs/issues/156
MDU6SXNzdWU3NTYxMTAzMDY=,KeyError: 'params' popping up during gimme motifs command run,CLOSED,2020-12-03T11:25:56Z,2023-01-19T09:06:25Z,2023-01-19T09:06:25Z,"**Describe the bug**
So every time I run gimme motifs (the only command I've run so far) on my system, although the run will finish successfully, I have to manually CRTL+C and quit my terminal because the program will seem to be stuck at trying to resolve this KeyError.

**To Reproduce**
I run a standard `gimme motifs` command:
```
gimme motifs INPUT.narrowPeak OUTPUTPATH -g GENOME.fa
```

**Expected behavior**
As I have never run gimme motifs without seeing these errors pop up I'm not sure what I expect it to look. But here's the output lines printed as the run is going:

<img width=""1263"" alt=""Screen Shot 2020-12-03 at 9 15 35 pm"" src=""https://user-images.githubusercontent.com/15644815/101004817-c7f46480-35b4-11eb-819e-c363f3acee39.png"">

and as time passes, I'll see motifs being called and found and some `matplotlib` lines about building the font cache

<img width=""1263"" alt=""Screen Shot 2020-12-03 at 9 15 51 pm"" src=""https://user-images.githubusercontent.com/15644815/101005518-fb36f380-35b4-11eb-8d82-deade6ccdf06.png"">

**Error logs**
And usually the KeyError will pop up after these repeated 'matplotlib building cache' lines, with these exact lines:

```
Traceback (most recent call last):
  File ""<string>"", line 1, in <module>
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/multiprocessing/spawn.py"", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/multiprocessing/spawn.py"", line 125, in _main
    prepare(preparation_data)
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/multiprocessing/spawn.py"", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/multiprocessing/spawn.py"", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/runpy.py"", line 265, in run_path
    return _run_module_code(code, init_globals, run_name,
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/runpy.py"", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/runpy.py"", line 87, in _run_code
    exec(code, run_globals)
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/bin/gimme"", line 8, in <module>
    from gimmemotifs.cli import cli
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/__init__.py"", line 61, in <module>
    from . import denovo      # noqa: F401
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 51, in <module>
    from gimmemotifs.stats import calc_stats, rank_motifs, write_stats
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/stats.py"", line 10, in <module>
    from gimmemotifs.scanner import scan_to_best_match, Scanner
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 55, in <module>
    config = MotifConfig()
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/config.py"", line 95, in __init__
    self._upgrade_config()
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/config.py"", line 98, in _upgrade_config
    if ""width"" in self.config[""params""]:
  File ""/Users/sufyazi/opt/anaconda3/envs/gimme/lib/python3.8/configparser.py"", line 960, in __getitem__
    raise KeyError(key)
KeyError: 'params'
```
And usually these would appear back to back, which to me a non-programmer, looks like it's stuck in a loop of some sort.

<img width=""1253"" alt=""Screen Shot 2020-12-03 at 10 10 19 pm"" src=""https://user-images.githubusercontent.com/15644815/101006608-4e10ab00-35b5-11eb-9a0f-8da1c484404c.png"">

However after a while, I will always see these lines, indicating that the run actually did run, and has finished.
<img width=""1055"" alt=""Screen Shot 2020-12-03 at 9 59 34 pm"" src=""https://user-images.githubusercontent.com/15644815/101007569-9334dd00-35b5-11eb-8fb9-fb8ec1780a67.png"">

But as you can see in the last line, the CPU is still at work and the whole traceback lines will appear back to back, until I manually suspend the process and/or exit the terminal.

Later I would check the output files and everything looks like it has worked. So I am not sure what exactly is happening, seeing that the program actually did work despite the error messages. 

**Installation information (please complete the following information):**
 - OS: MacOS BigSur 11.0.1
 - Installation conda (pypi)
 - Version gimmemotifs 0.15.2+2.g2d3b70b

**Additional context**
After I manually `CTRL+C`, I usually get this warning, with xxxx being digits that usually differs between runs.

```
There appear to be xxxx leaked semaphore objects to clean up at shutdown warnings.warn('resource_tracker: There appear to be %d
```
",sufyazi,https://github.com/vanheeringen-lab/gimmemotifs/issues/157
MDU6SXNzdWU3NjQ1NTA5MzQ=,BED format and FASTA input issues,CLOSED,2020-12-12T23:11:06Z,2023-01-19T09:06:13Z,2023-01-19T09:06:13Z,"Hi,

I noticed that running gimme motifs over different BED format might result in errors. 
This seems to be simply due, at least for what I have seen, to the formatting of the BED.
When producing BED with rtracklayes (so using bioconductor R functions from Granges) it works when the name of each feature and the score is provided. while it breaks down (at least in. my hands) when the format is: chr, start, end, ., 0,  like when there is no score or strand provided bu only ""."" or ""0"".
Another issue I found is when running gimme motifs with FASTA. it keeps looking for BED even though I provide a real Fasta and I figures that if I provide a fasta and specify the genome ""mm10"" it assumes that is a BED instead of a fasta.

I'll try to provide examples over the next days.
Don't know if this can be fixed or I am doing something wrong.

Thanks",fgualdr,https://github.com/vanheeringen-lab/gimmemotifs/issues/158
MDU6SXNzdWU3NjUxMzc5NjM=,genome installation problem,CLOSED,2020-12-13T07:36:18Z,2021-04-13T08:05:21Z,2021-04-13T08:05:21Z,"Hi,

I am trying to freshly install genome but an error with genome-you comes out:
Don't know what to do as the folder I create to store genomes is completely empty to start with

 genomepy install mm10 --annotation
Downloading genome from UCSC.
Target URL: http://hgdownload.soe.ucsc.edu/goldenPath/mm10/bigZips/chromFa.tar.gz...
Genome download successful, starting post processing...
Traceback (most recent call last):
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/bin/genomepy"", line 10, in <module>
    sys.exit(cli())
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/click/core.py"", line 829, in __call__
    return self.main(*args, **kwargs)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/click/core.py"", line 782, in main
    rv = self.invoke(ctx)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/click/core.py"", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/click/core.py"", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/click/core.py"", line 610, in invoke
    return callback(*args, **kwargs)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/genomepy/cli.py"", line 221, in install
    genomepy.install_genome(
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/genomepy/functions.py"", line 305, in install_genome
    p.download_genome(
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/genomepy/provider.py"", line 303, in download_genome
    shutil.move(src, dst)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/tempfile.py"", line 827, in __exit__
    self.cleanup()
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/tempfile.py"", line 831, in cleanup
    self._rmtree(self.name)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/tempfile.py"", line 813, in _rmtree
    _shutil.rmtree(name, onerror=onerror)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/shutil.py"", line 719, in rmtree
    onerror(os.rmdir, path, sys.exc_info())
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/shutil.py"", line 717, in rmtree
    os.rmdir(path)
OSError: [Errno 39] Directory not empty: '/hpcnfs/data/GN2/fgualdrini/.local/share/genomes/mm10/tmp214g9nnb'",fgualdr,https://github.com/vanheeringen-lab/gimmemotifs/issues/159
MDU6SXNzdWU3NjU1NzQyMjE=,gimme motifs with FASTA,CLOSED,2020-12-13T18:06:55Z,2021-04-13T08:03:36Z,2021-04-13T08:03:36Z,"Hi,

I am having several issues with gimme motif.
I freshly re-install all together with new genomes using genome-you as indicated.
I generated fasta files for both sample and background using bedroll and the .fa file obtained with genomepy. 
The size of background and samples are both 151bp

I run the script as follow:
gimme motifs $FOLDER/temp.fa $FOLDEROUT/ --background $BG_FOLDER/BG.fa -p $pfm_file --known

I got the following error:

Nevertheless I get the following error:

2020-12-13 19:00:29,932 - WARNING - size parameter will be ignored for FASTA input
2020-12-13 19:01:05,856 - INFO - skipping de novo
2020-12-13 19:01:05,876 - INFO - creating motif scan tables
Traceback (most recent call last):
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/commands/motifs.py"", line 186, in motifs
    scan_to_file(
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 383, in scan_to_file
    for line in command_scan(
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 324, in command_scan
    for row in it:
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 221, in scan_score_table
    for i, scores in enumerate(result_it):
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 1010, in best_score
    for matches in self.scan(seqs, 1, scan_rc, zscore=zscore, gc=gc):
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 1078, in scan
    self.set_meanstd(gc=gc)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 715, in set_meanstd
    self.set_background(gc=gc)
  File ""/hpcnfs/data/GN2/fgualdrini/.conda/envs/gimme/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 839, in set_background
    raise ValueError(""Need either genome or filename for background."")
ValueError: Need either genome or filename for background.",fgualdr,https://github.com/vanheeringen-lab/gimmemotifs/issues/160
MDU6SXNzdWU3NjYwNjQ0MTU=,Motif to TF mapping nonredundant.motifs.pfm file,CLOSED,2020-12-14T07:50:10Z,2021-06-28T09:43:26Z,2021-06-28T09:43:26Z,"When running gimme maelstrom using a 'nonredundant.motifs.pfm' file generated by a different maelstrom run (on different yet similar data), the mapping rate of motifs to TF drastically drops. 

Image of an original run: 
![image](https://user-images.githubusercontent.com/47240368/102053989-f827d880-3de8-11eb-8b1e-883c292e7a7e.png)

Image of a run on similarish data using the nonredundant.motifs.pfm file from the previous analysis:

![image](https://user-images.githubusercontent.com/47240368/102054140-33c2a280-3de9-11eb-8d04-9a1e664e8254.png)

",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/161
MDU6SXNzdWU3NzI5MTUyMjE=,wrong percent of occurence,CLOSED,2020-12-22T12:38:05Z,2021-05-18T17:15:09Z,2021-05-18T17:15:09Z,"Hey!
I find out that the procedure for counting percent of motif occurrence does not take into account that in one peak it is possible to have more than one motif occurrence. In that case we should probably count number of peaks with at least 1 occurrence, shouldn't we?
https://github.com/vanheeringen-lab/gimmemotifs/blob/50abbc2e3ab86770b2ac53b1adc94c6a533d11ec/gimmemotifs/maelstrom.py#L512",irzhegalova,https://github.com/vanheeringen-lab/gimmemotifs/issues/162
MDU6SXNzdWU3NzYzOTEwNDY=,Bug with gimme motifs using hocomoco motifs,OPEN,2020-12-30T10:43:39Z,2020-12-30T10:43:39Z,,"this was the command: 
gimme motifs IMPORT.bed ./OUTPUT folder -b gc -g hg19 -p HOCOMOCOv11_HUMAN 

**Describe the bug**
the output data is missing the  expected HTML file such as gimme.motifs.html or gimme.motifs.redundant.html


**Error logs**
(/icgc/dkfzlsdf/analysis/C010/feuerste/conda/gimme) -bash-4.2$ gimme motifs Cluster5_scaled.bed ./result_cluster5_hocomoco_gc_background -b gc -g hg19 -p HOCOMOCOv11_HUMAN
2020-12-30 10:58:07,113 - INFO - creating background (matched GC%)
/icgc/dkfzlsdf/analysis/C010/feuerste/conda/gimme/lib/python3.8/subprocess.py:849: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stderr = io.open(errread, 'rb', bufsize)
2020-12-30 11:00:54,271 - INFO - starting full motif analysis
2020-12-30 11:00:54,271 - INFO - using size of 200, set size to 0 to use original region size
2020-12-30 11:00:54,271 - INFO - preparing input from BED
2020-12-30 11:03:41,042 - INFO - starting motif prediction (xl)
2020-12-30 11:03:41,043 - INFO - tools: MEME, BioProspector, Homer
2020-12-30 11:03:42,271 - INFO - all jobs submitted
2020-12-30 11:03:42,285 - INFO - Homer_width_12 finished, found 0 motifs
2020-12-30 11:03:42,286 - INFO - Homer_width_14 finished, found 0 motifs
2020-12-30 11:03:42,286 - INFO - Homer_width_16 finished, found 0 motifs
2020-12-30 11:03:42,286 - INFO - Homer_width_18 finished, found 0 motifs
2020-12-30 11:03:42,286 - INFO - Homer_width_8 finished, found 0 motifs
2020-12-30 11:03:42,288 - INFO - Homer_width_20 finished, found 0 motifs
2020-12-30 11:03:42,288 - INFO - MEME_width_8 finished, found 0 motifs
2020-12-30 11:03:42,289 - INFO - MEME_width_6 finished, found 0 motifs
2020-12-30 11:03:42,290 - INFO - MEME_width_10 finished, found 0 motifs
2020-12-30 11:03:42,291 - INFO - MEME_width_12 finished, found 0 motifs
2020-12-30 11:03:42,292 - INFO - MEME_width_14 finished, found 0 motifs
2020-12-30 11:03:42,293 - INFO - MEME_width_16 finished, found 0 motifs
2020-12-30 11:03:42,294 - INFO - MEME_width_18 finished, found 0 motifs
2020-12-30 11:03:42,295 - INFO - MEME_width_20 finished, found 0 motifs
2020-12-30 11:03:42,295 - INFO - Homer_width_6 finished, found 0 motifs
2020-12-30 11:03:42,296 - INFO - Homer_width_10 finished, found 0 motifs
2020-12-30 11:04:17,278 - INFO - BioProspector_width_6 finished, found 5 motifs
2020-12-30 11:04:25,233 - INFO - BioProspector_width_8 finished, found 5 motifs
2020-12-30 11:04:28,567 - INFO - BioProspector_width_10 finished, found 5 motifs
2020-12-30 11:04:33,914 - INFO - BioProspector_width_12 finished, found 5 motifs
2020-12-30 11:04:36,992 - INFO - BioProspector_width_14 finished, found 5 motifs
2020-12-30 11:04:40,421 - INFO - BioProspector_width_16 finished, found 5 motifs
2020-12-30 11:04:45,516 - INFO - BioProspector_width_18 finished, found 5 motifs
2020-12-30 11:04:57,188 - INFO - BioProspector_width_20 finished, found 5 motifs
2020-12-30 11:08:14,344 - INFO - predicted 40 motifs
2020-12-30 11:08:14,361 - INFO - 16 motifs are significant
2020-12-30 11:08:14,470 - INFO - clustering 16 motifs.
2020-12-30 11:09:14,514 - INFO - creating de novo reports
2020-12-30 11:09:53,526 - INFO - finished
2020-12-30 11:09:53,526 - INFO - output dir: ./result_cluster5_hocomoco_gc_background
2020-12-30 11:09:53,526 - INFO - de novo report: ./result_cluster5_hocomoco_gc_background/gimme.denovo.html
2020-12-30 11:10:04,499 - INFO - creating motif scan tables
2020-12-30 11:13:06,682 - INFO - calculating stats
2020-12-30 11:13:46,927 - INFO - selecting non-redundant motifs
2020-12-30 11:13:49,994 - INFO - selected 1 non-redundant motifs: ROC AUC 0.726, PR AUC 0.542
**2020-12-30 11:13:55,704 - INFO - creating statistics report**
Traceback (most recent call last):
  File ""/icgc/dkfzlsdf/analysis/C010/feuerste/conda/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/icgc/dkfzlsdf/analysis/C010/feuerste/conda/gimme/lib/python3.8/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/icgc/dkfzlsdf/analysis/C010/feuerste/conda/gimme/lib/python3.8/site-packages/gimmemotifs/commands/motifs.py"", line 265, in motifs
    roc_html_report(
  File ""/icgc/dkfzlsdf/analysis/C010/feuerste/conda/gimme/lib/python3.8/site-packages/gimmemotifs/report.py"", line 933, in roc_html_report
    df = df.loc[idx]
  File ""/home/feuerste/.local/lib/python3.8/site-packages/pandas/core/indexing.py"", line 879, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
  File ""/home/feuerste/.local/lib/python3.8/site-packages/pandas/core/indexing.py"", line 1099, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
  File ""/home/feuerste/.local/lib/python3.8/site-packages/pandas/core/indexing.py"", line 1037, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis, raise_missing=False)
  File ""/home/feuerste/.local/lib/python3.8/site-packages/pandas/core/indexing.py"", line 1254, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
  File ""/home/feuerste/.local/lib/python3.8/site-packages/pandas/core/indexing.py"", line 1315, in _validate_read_indexer
    raise KeyError(
KeyError: ""Passing list-likes to .loc or [] with any missing labels is no longer supported. The following labels were missing: Index(['ZN214_HUMAN.H11MO.0.C'], dtype='object'). See https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#deprecate-loc-reindex-listlike""


**Installation information (please complete the following information):**
 - OS: Linux 3.10.0-693.21.1.el7.x86_64 x86_64
 - Installation conda
 - Version 0.15.2


",ClarissaFeuersteinAkgoz,https://github.com/vanheeringen-lab/gimmemotifs/issues/163
MDU6SXNzdWU3Nzc5NDY0NTE=,Can GimmeMotifs detect TF downstream targets,CLOSED,2021-01-04T09:12:49Z,2021-04-13T06:49:47Z,2021-04-13T06:49:47Z,"Hi,
Can we also detect TF motif targets GimmeMotifs?

Thanks.
Inayat",inayat45shaikh,https://github.com/vanheeringen-lab/gimmemotifs/issues/164
MDU6SXNzdWU3NzgxNzI3MjI=,pyfaidx.fetchError when running gimme motifs,CLOSED,2021-01-04T15:26:47Z,2023-01-19T08:47:24Z,2023-01-19T08:47:24Z,"**Describe the bug**
I want to use  .narrowPeak files generated by seq2science as input for gimme motifs (six files in total). However, for two out of the six files  gimme motifs returns an error: pyfaidx.fetchError: requested start coordinate must be 1.  


**To Reproduce**
For all files I run a standard gimme motifs command (separately) 
`gimme motifs INPUT.narrowPeak OUTPUTPATH  -g GENOMEPATH ` 

**Expected behavior**
Because the other  .narrowPeak files run fine, I would expect gimme motifs to also have no problems with the current two. 

**Error logs**
![image](https://user-images.githubusercontent.com/76217186/103550439-2e68ed00-4ea9-11eb-8d9a-11e4f7674196.png)




**Installation information:**
 - OS: [Linux]
 - Installation [conda]
 - Version [0.15.2]


",ymquint,https://github.com/vanheeringen-lab/gimmemotifs/issues/165
MDU6SXNzdWU3ODQ5ODc5OTg=,Gimme motifs not using -f (fraction) provided,CLOSED,2021-01-13T10:37:14Z,2021-03-24T11:36:55Z,2021-03-24T11:36:55Z,"**Describe the bug**
Gimme motifs is not apparently using the -f value provided.
 
**To Reproduce**
 I've run gimme motifs commnad providing input, background and genome in fasta format with the -s flag set to 0 as well as -f set to 0.5. Here is one example. 
`gimme motifs diff_peaks_down_MB.bed.fa down_MB_nocenteredx2_b_f0,5 -g ../../genome/Nfu_20150522.softmasked_genome.fa -b ../nucfree/allPeaks_MB.bed.fa -s 0 -f 0.5` 

**Expected behavior**
In the file params.txt, the fraction should indicate 0.5, however it appears the default 0.2. 

**Error logs**
I copy the content of the file params.txt.

fraction	0.2
use_strand	False
abs_max	1000
analysis	xl
enrichment	1.5
size	0
lsize	500
background	['custom']
cluster_threshold	0.95
scan_cutoff	0.9
available_tools	MDmodule,MEME,MEMEW,DREME,Weeder,GADEM,MotifSampler,Trawler,Improbizer,BioProspector,Posmo,ChIPMunk,AMD,HMS,Homer,XXmotif,ProSampler,DiNAMO
tools	MEME,Homer,BioProspector
pvalue	0.001
max_time	-1.0
ncpus	12
motif_db	gimme.vertebrate.v5.0.pfm
use_cache	False
custom_background	../nucfree/allPeaks_MB.bed.fa
genome	../../genome/Nfu_20150522.softmasked_genome.fa

In addition, the .log file says it is using 0.2 as a fraction. From gimmemotifs.log:
`2021-01-13 09:32:15,478 - gimme.config - DEBUG -   fraction: 0.2`

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation conda
 - Version v0.14.4
",adeben1,https://github.com/vanheeringen-lab/gimmemotifs/issues/166
MDU6SXNzdWU3ODUzMDk0ODA=,Gimme motifs can't read intermediate file,CLOSED,2021-01-13T17:46:50Z,2021-04-13T08:07:21Z,2021-04-13T08:07:21Z,"**Describe the bug**
When running gimme motifs with the following parameters:
gimme motifs -s 0 -f 0.5 -g mm10 --denovo Alluvial_open_GM.5.0.Forkhead.0008.bed Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs

We get the following error:

2021-01-13 17:29:57,285 - INFO - creating background (matched GC%)
Sequences do not seem to be of equal size.
GC% matched sequences of the median size (300) will be created
2021-01-13 17:30:15,741 - INFO - starting full motif analysis
2021-01-13 17:30:15,741 - INFO - using original size
2021-01-13 17:30:15,741 - INFO - preparing input from BED
Please provide input file in BED or FASTA format
Traceback (most recent call last):
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/background.py"", line 468, in matched_gc_bedfile
    for seq in fa.seqs
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/background.py"", line 468, in <listcomp>
    for seq in fa.seqs
ZeroDivisionError: division by zero

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/cjr78/miniconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 625, in cli
    args.func(args)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/commands/motifs.py"", line 94, in motifs
    ""size"": args.size,
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/denovo.py"", line 609, in gimme_motifs
    params.get(""custom_background"", None),
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/denovo.py"", line 316, in create_backgrounds
    custom_background=custom_background,
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/denovo.py"", line 226, in create_background
    f = MatchedGcFasta(fafile, genome, nr_times * len(fg))
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/background.py"", line 559, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/gimmemotifs/background.py"", line 477, in matched_gc_bedfile
    [float(x[fields + 1]) for x in bed.nucleotide_content(fi=genome_fa)]
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/pybedtools/bedtool.py"", line 917, in decorated
    result = method(self, *args, **kwargs)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/pybedtools/bedtool.py"", line 401, in wrapped
    decode_output=decode_output,
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.7/site-packages/pybedtools/helpers.py"", line 455, in call_bedtools
    raise BEDToolsError(subprocess.list2cmdline(cmds), stderr)
pybedtools.helpers.BEDToolsError:
Command was:

        bedtools nuc -fi /home/cjr78/.local/share/genomes/mm10/mm10.fa -bed Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs/intermediate/prediction.fa

Error message was:
It looks as though you have less than 3 columns at line 1 in file Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs/intermediate/prediction.fa.  Are you sure your files are tab-delimited?`

**To Reproduce**
Run gimme motifs

**Expected behavior**
For gimme motifs to run and read its own intermediate files

**Error logs**
Error log:
2021-01-13 17:30:15,735 - gimme.config - DEBUG - Using multiprocessing
2021-01-13 17:30:15,736 - gimme.config - DEBUG - Parameters:
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   fraction: 0.2
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   use_strand: False
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   abs_max: 1000
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   analysis: xl
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   enrichment: 1.5
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   size: 0
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   lsize: 500
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   background: ['gc']
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   cluster_threshold: 0.95
2021-01-13 17:30:15,736 - gimme.config - DEBUG -   scan_cutoff: 0.9
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   available_tools: MDmodule,MEME,MEMEW,DREME,Weeder,GADEM,MotifSampler,Trawler,Improbizer,BioProspector,Posmo,ChIPMunk,AMD,HMS,Homer,XXmotif,ProSampler,DiNAMO
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   tools: MEME,Homer,BioProspector
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   pvalue: 0.001
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   max_time: -1
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   ncpus: 12
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   motif_db: gimme.vertebrate.v5.0.pfm
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   use_cache: False
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   custom_background: Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs/generated_background.gc.fa
2021-01-13 17:30:15,737 - gimme.config - DEBUG -   genome: mm10
2021-01-13 17:30:15,737 - gimme.config - DEBUG - No time limit for motif prediction
2021-01-13 17:30:15,741 - gimme.denovo - INFO - starting full motif analysis
2021-01-13 17:30:15,741 - gimme.denovo - DEBUG - Using temporary directory /tmp/gimmemotifs.151283.xrc7uklp
2021-01-13 17:30:15,741 - gimme.denovo - INFO - using original size
2021-01-13 17:30:15,741 - gimme.denovo - INFO - preparing input from BED
2021-01-13 17:30:15,746 - gimme.denovo - DEBUG - Splitting Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs/intermediate/input.bed into prediction set (Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs/intermediate/prediction.bed) and validation set (Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs/intermediate/validation.bed)
2021-01-13 17:30:16,053 - gimme.denovo - DEBUG - Creating GC matched background

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: conda
 - Version: 0.14.4

**Additional context**
Add any other context about the problem here.

Head of input bed file looks like this:

chr10   69165952        69166203
chr11   98750442        98751534
chr3    21895407        21895988
chr2    102815334       102815552
chr17   93484588        93484861
chr4    92547518        92547673
chr2    117637363       117637832
chr16   52000168        52000605
chr11   23401137        23401330
chr18   58143451        58143760`

Head of Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs/intermediate/prediction.fa looks like this:

>chr10:117988166-117988166

>chr10:39490581-39490581

>chr10:69114610-69114610

>chr11:100894221-100894221

>chr11:103115577-103115577

Head of Alluvial_open_GM.5.0.Forkhead.0008_gimmemotifs/intermediate/localization.fa

>chr9:53356720-53356720
CCGAAATGAATACGTGATTTTAAGCCACAGGGCCCAGAACACATTGCTGATCGTGATCTCTGCCAGAGATCAGACACAGAACAAATCTGGGAGCACCTTAAAATTTAATTTTGTTGACTTTACCAAGGCATTTGATCGTATCAGGCAGTGTGGGTTCCTACTCCCTCAGCCGCCCTGCAGGTTTGGCCACCCTAGGAAGTTCTCAAGTGTTCGAAGGTTACACTCTGGCAGGAGCTGTGTTTGTTTAGTTATGTCAACACTGCAGACAGTATCAGGAGAGGGCGTTGAAGGTGTGTAAAAGGCCTTGTTTATTCAGTGGCTTTTATGTTCCCCGTTTCCTGAGAGCCAGCATCTAAAAACGCTGGTCTCATACAGATCCTGTTGGGCAGCTGCCTAGCTCATGAGGTCTCAGGTGTTCTCCAGAAAATTGTCCATAACCCCAAAGCACAGCAAGAGTAGGCAGGGAGGACTTGCTAATGCCCAACCCGTCTTCTCAGCAG
>chr11:114907707-114907707
ccactcagctatgtccttgattcTAATACTCTTTTTACtattttatttagagactggtgtcttgttaaactgcccaggttgaccttgaactcatcctgtaactcaagcaggccttgaacttgctatctatcctcctgcctcagtttcacctggccctactgcACAACAGGGGTTAAAATTCATATCTGTTCAGATGGAATGGTCAAAGTAGAGACATCCACAAAAGAGGATCACCATGGATATTTACATGACGACAGTAACTGTCACCAAAGAGTCTGCCCAAACCACAGGCTTGCACAAGTCATGATGACCTTGCACAAAGAACCACAGCCTTGCAGCGCGACATCAGCCCAGAAGCTATCTGTTCAGCCTCACACTGGCTCCACCTTTAATACTGACCTTTGTGGTGGAGGACCATTGCTTCAACACAGCTTATGTAACCTTCCCGACCTTCCTGTTAATCCTCACCTTCCTTACTCTCTCACCCTATGACATCTTGC
>chr15:60166898-60166898
atcctcgtctacatatgtatTGTTAAGAAAAAGAAGGATTTTTTTTTTTACTTAAATACATGAATACTTTTCTAGAGTACAAAAGAGAAAGTATAAatgaatttgtctataaaattttaaataaacctttagtattcaatcttatgctgatgcaatactgttatttgcttttctttattgaaatgatgacattttcttagattagtcatcttttctttataagataaagtaaaagacttttatttaccttatgagtaatcactcaagaagctaaacatttgggttcttaacagaattatttttatgttcagtattgatttgaccatgtttttgattattactgaaataagatcttcACTTAAAATATCTGGAGAGGagtcccacagtccccagaggagtctccactctcaggcactctagcacgtccaggatcttagggtcactggtgagtagaacacaacatttgttccaataccaccagtagtgactggaaacagcag
>chr12:56905999-56905999
TGCTTGTATAGCAGTTTAAGGGTCAAATGCTGCTCTGCCCGGTGCCTCTGACATCACTTAACTCTCCCCGGGAGAGGGGCACTAGCGTCATTCTCTGGGCTGGCCAGCAGCAGGCCTGAAGGTGGGTCCGCAGCAGCTCAGTCTTGTTTCTCCTGGAGACCTACAGGGTCAGAAACTGTGAGGGAGCATTGCAACTAAGACTCTAAGTCTTTGTTTGTATTGGCTTGAGAGAGAATTTTTTTCACAATTTATGAAAACACAATGTAGCCAGAAAGTTACAATGTAAATGTGAGTTTCAAACTTTGCTGTAGTCATAGGTTAATCGTTAGTCATTTGTGGTTGACAAGGGAGGTTATAATTTGACACCTGGCAAAAAATCAAGCCCATTTCAGAGAAGTTAGGAGCTGGGAAATGAGATGGAAAAACACCCTCCATTTCCCTAGGAGGTCCCATGAAAAAGCATTTAGCAAAATCTCTTCTCTCCCTAGAAGTCAATTCCT
>chr3:45534546-45534546
ACACTTCATCTCCTGCTGCATCCTTTCCTCGGGGCTACATGTTACTGATGTAAGTGTTTTGTCTTCTTTTACAGGGACACACTATATATCTTAAAATTGTGAAGAAAATGTAGTTAAGTCAATGAGAATTGTGTAATCATCACTACAACCAGTCAACTTTACCACCTTCTCCATGAATCAAGTGATACATTAACCTAATTAGTAAGACTATTTAAGGGACTTCAGGGACAAGAATATCAGAGCTACATTTTCTATAAACAGTATTCATATTCTGAGAGTAAAAACTAGTAATTATTTTCTCATTTCAGTAATGTTATTCAGAAAAAAGATGAACAATAGCAGAGAAATGAATCAGAGAACAACCATCCTTTATCTCCCTCACATTTATGATTCACTGGTAGAATATTACCTTAGGGAATTTTTGTTTGGGAAAACTATAGGCATGGAAACATAATTTTTTTTAtgcccctctcctggtccaccctcccacagtttctcat


",connorrogerson,https://github.com/vanheeringen-lab/gimmemotifs/issues/167
MDU6SXNzdWU3ODU0MDQ1NjY=,ImportError: cannot import name '_non_reducing_slice' from 'pandas.core.indexing',CLOSED,2021-01-13T20:04:49Z,2021-12-16T22:40:53Z,2021-04-13T06:40:22Z,"Hi 

I recently installed gimmemotifs (see version below) using conda as recommended.
Installation step went well without any errors.
But then calling `bash gimme motifs -h` to test installation got me this error: ""ImportError: cannot import name '_non_reducing_slice' from 'pandas.core.indexing'"" (see **Error logs** below).  

Seems pandas has removed the leading underscore to the offending function and replaced `_non_reducing_slice` by `non_reducing_slice` as shown in their repo [here](https://github.com/pandas-dev/pandas/blob/a6bc6ecc97d6d5520c609f4a8cbf3d51d2c0746d/pandas/core/indexing.py#L2370)

Patching report.py with the new function name fixed it.

Please, can you fix it by replacing the function by its new name in report.py?

Thanks in advance

@jos4uke

**To Reproduce**
Please see **Installation information** section to reproduce.

**Expected behavior**
calling help on gimme motifs using the -h switch should have returned the expected help message:

```bash
# expected help message
# gimme motifs -h
Matplotlib is building the font cache; this may take a moment.
usage: gimme [-h] <subcommand> [options] motifs [-h] [-b BACKGROUND] [-g GENOME] [--denovo] [--known] [--noreport] [--rawscore] [--nogc]
                                                [-N INT] [-p PFMFILE] [-t N] [-a ANALYSIS] [-k] [-S] [-f FRACTION] [-s N]
                                                INPUT OUTDIR

positional arguments:
  INPUT                 FASTA, BED, narrowPeak or region file.
  OUTDIR                Output directory.

optional arguments:
  -h, --help            show this help message and exit
  -b BACKGROUND, --background BACKGROUND
                        Background type (random,genomic,gc,promoter,custom) or a file with background sequences (FASTA, BED or regions)
  -g GENOME             Genome name or fasta file
  --denovo              Only use de novo motifs
  --known               Only use known motifs
  --noreport            Don't create a HTML report.
  --rawscore            Don't z-score normalize motif scores
  --nogc                Don't use GC% bins
  -N INT, --nthreads INT
                        Number of threads (default 12)

optional arguments for known motifs:
  -p PFMFILE            PFM file with motifs.(default: JASPAR2020_plants.pfm)

optional arguments for de novo motifs:
  -t N, --tools N       Tools to use, any combination of MDmodule,MEME,MEMEW,Weeder,GADEM,MotifSampler,Trawler,Improbizer,BioProspector,Posm
                        o,ChIPMunk,AMD,HMS,Homer,XXmotif,ProSampler,DiNAMO (default MEME,BioProspector,Homer)
  -a ANALYSIS, --analysis ANALYSIS
                        Analysis type: small, medium, large, xl (xl)
  -k, --keepintermediate
                        Don't delete intermediate files
  -S, --singlestrand    Only predict motifs for single + strand (default is both)
  -f FRACTION, --fraction FRACTION
                        Fraction of peaks to use for motif predicton (0.2)
  -s N, --size N        Region size to use for motif prediction (200). Set to 0 to use the size of the input regions.

````

**Error logs**

```bash
# gimme motifs -h
Matplotlib is building the font cache; this may take a moment.
Traceback (most recent call last):
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/gimme"", line 8, in <module>
    from gimmemotifs.cli import cli
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/__init__.py"", line 61, in <module>
    from . import denovo      # noqa: F401
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 52, in <module>
    from gimmemotifs.report import create_denovo_motif_report
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/report.py"", line 19, in <module>
    from pandas.core.indexing import _non_reducing_slice
ImportError: cannot import name '_non_reducing_slice' from 'pandas.core.indexing' (/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/pandas/core/indexing.py)

```

**Installation information:**
 - OS: Linux node7 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64 GNU/Linux 
 - Installation: `bash mamba create -n gimmemotifs python=3 gimmemotifs`
 - Versions:
   -   python                    3.8.6           hffdb5ce_4_cpython    conda-forge
   -  gimmemotifs               0.15.2           py38h0213d0e_0    bioconda

",jos4uke,https://github.com/vanheeringen-lab/gimmemotifs/issues/168
MDU6SXNzdWU3ODU4NTY3MzM=,sqlite3.DatabaseError: file is not a database,CLOSED,2021-01-14T10:09:07Z,2021-04-13T06:45:47Z,2021-04-13T06:45:46Z,"Hi @simonvh 

I ran `gimme motifs` on motif database JASPAR2020_plants, but it seems the way I set the command line may be wrong as I got this error `sqlite3.DatabaseError: file is not a database`:
  
```bash
# see step to rerproduce for the full command line
gimme motifs -p JASPAR2020_plants ...

```

As you can see, I didn't suffix the motifs database file name with `.pfm` extension as seen in your documentation for `JASPAR2020_vertebrates` or `HOMER`. 

I checked for `JASPAR2020_plants` motifs database location in my installation. It was installed as well  along with all the other motifs databases in `/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/data/motif_databases/` (see **Additional information** for the path to included motifs database installed via conda).

And also checked for the configuration file (see **Additional information** for my config file content) for the default motifs databases location parameter: `motif_databases = motif_databases`.
It matched the folder name in my installation.

But seems gimme motifs didn't know where to search for the motifs database on my installation.  

Is it the right way to set the motifs database, when this one is included with gimme motifs? 
Or maybe I need to setup the configuration file differently so gimme motifs know where to find it? 
Can you help please?

Thanks in advance

@jos4uke

**Step to reproduce:**

```bash
SEQDIR=seq
ZONES=(zone1 zone2 zone3 zone4)
ZONE_SEQS=(cds.ranges.zone1.flank.seqs.fa  cds.ranges.zone2.flank.seqs.fa  cds.ranges.zone3.flank.seqs.fa  cds.ranges.zone4.flank.seqs.fa)
OUTDIR=gimmemotifs
THREADS=12
#### gimme motifs 
MOTIFS_DB=JASPAR2020_plants 
REF_GENOME=my_genome.fa

ZONE_SEQ=$SEQDIR/${ZONE_SEQS[$SLURM_ARRAY_TASK_ID]}
ZONE=${ZONES[$SLURM_ARRAY_TASK_ID]}
OUTDIR_MOTIFS=${OUTDIR}/${ZONE}.motifs
echo ""### zone seq file: ${ZONE_SEQ}""
echo ""### zone: ${ZONE}""
echo ""### output directory: ${OUTDIR_MOTIFS}""

gimme motifs ${ZONE_SEQ} ${OUTDIR_MOTIFS} \
	-g ${REF_GENOME} \
	--background random \
	-p ${MOTIFS_DB} \
	--analysis xl \
	--keepintermediate \
	--size 1000 \
	-N ${THREADS}

```

**Expected behavior**
A clear and concise description of what you expected to happen.

**Error logs**

```bash
2021-01-13 22:04:09,094 - WARNING - size parameter will be ignored for FASTA input
2021-01-13 22:04:09,095 - INFO - creating background (random)
2021-01-13 22:04:27,450 - INFO - starting full motif analysis
2021-01-13 22:04:27,475 - INFO - using size of 1000, set size to 0 to use original region size
2021-01-13 22:04:27,476 - INFO - preparing input from FASTA
2021-01-13 22:04:27,476 - INFO - preparing input (FASTA)
2021-01-13 22:05:09,014 - INFO - starting motif prediction (xl)
2021-01-13 22:05:09,014 - INFO - tools: MEME, BioProspector, Homer
2021-01-13 22:05:10,005 - INFO - all jobs submitted
2021-01-13 22:05:25,253 - INFO - Homer_width_6 finished, found 5 motifs
2021-01-13 22:05:33,216 - INFO - Homer_width_8 finished, found 5 motifs
2021-01-13 22:06:13,432 - INFO - Homer_width_10 finished, found 5 motifs
2021-01-13 22:07:56,607 - INFO - Homer_width_12 finished, found 5 motifs
2021-01-13 22:10:04,261 - INFO - BioProspector_width_6 finished, found 5 motifs
2021-01-13 22:10:04,711 - INFO - MEME_width_6 finished, found 0 motifs
2021-01-13 22:10:04,951 - INFO - MEME_width_8 finished, found 0 motifs
2021-01-13 22:10:05,211 - INFO - MEME_width_10 finished, found 0 motifs
2021-01-13 22:10:05,445 - INFO - MEME_width_12 finished, found 0 motifs
2021-01-13 22:10:05,687 - INFO - MEME_width_14 finished, found 0 motifs
2021-01-13 22:10:05,913 - INFO - MEME_width_16 finished, found 0 motifs
2021-01-13 22:10:06,140 - INFO - MEME_width_18 finished, found 0 motifs
2021-01-13 22:10:06,411 - INFO - MEME_width_20 finished, found 0 motifs
/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/subprocess.py:844: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stdout = io.open(c2pread, 'rb', bufsize)
/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/subprocess.py:849: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stderr = io.open(errread, 'rb', bufsize)
2021-01-13 22:10:07,033 - INFO - using 14000 sequences
2021-01-13 22:11:04,225 - INFO - BioProspector_width_8 finished, found 5 motifs
2021-01-13 22:11:32,823 - INFO - BioProspector_width_10 finished, found 5 motifs
2021-01-13 22:11:59,414 - INFO - BioProspector_width_12 finished, found 5 motifs
2021-01-13 22:12:47,144 - INFO - BioProspector_width_16 finished, found 5 motifs
2021-01-13 22:13:06,400 - INFO - Homer_width_14 finished, found 5 motifs
2021-01-13 22:13:23,304 - INFO - BioProspector_width_18 finished, found 5 motifs
2021-01-13 22:13:41,501 - INFO - BioProspector_width_20 finished, found 5 motifs
2021-01-13 22:14:16,643 - INFO - BioProspector_width_14 finished, found 5 motifs
2021-01-13 22:17:48,051 - INFO - Homer_width_16 finished, found 5 motifs
2021-01-13 22:25:03,907 - INFO - Homer_width_18 finished, found 5 motifs
2021-01-13 22:33:15,235 - INFO - Homer_width_20 finished, found 5 motifs
multiprocessing.pool.RemoteTraceback: 
""""""
Traceback (most recent call last):
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/multiprocessing/pool.py"", line 125, in worker
    result = (True, func(*args, **kwds))
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/prediction.py"", line 47, in mp_calc_stats
    stats = calc_stats(
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/stats.py"", line 216, in calc_stats
    for batch_result in calc_stats_iterator(
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/stats.py"", line 121, in calc_stats_iterator
    s.set_meanstd(gc=gc)
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 715, in set_meanstd
    self.set_background(gc=gc)
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 843, in set_background
    with Cache(CACHE_DIR) as cache:
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/diskcache/core.py"", line 457, in __init__
    sql = self._sql_retry
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/diskcache/core.py"", line 649, in _sql_retry
    sql = self._sql
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/diskcache/core.py"", line 644, in _sql
    return self._con.execute
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/diskcache/core.py"", line 631, in _con
    settings = con.execute(select).fetchall()
sqlite3.DatabaseError: file is not a database
""""""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/commands/motifs.py"", line 104, in motifs
    gimme_motifs(
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 613, in gimme_motifs
    result = predict_motifs(
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/prediction.py"", line 360, in predict_motifs
    result = pp_predict_motifs(
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/prediction.py"", line 320, in pp_predict_motifs
    result.wait_for_stats()
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/prediction.py"", line 178, in wait_for_stats
    job.get()
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/multiprocessing/pool.py"", line 771, in get
    raise self._value
sqlite3.DatabaseError: file is not a database
ERROR: file is not a database

```

**Installation information:**
 - OS: Linux node7 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64 GNU/Linux 
 - Installation: `bash mamba create -n gimmemotifs python=3 gimmemotifs`
 - Versions:
   -   python                    3.8.6           hffdb5ce_4_cpython    conda-forge
   -  gimmemotifs               0.15.2           py38h0213d0e_0    bioconda

**Additional information:**

I installed gimme motifs using conda. And searching for all included motifs databases, I found them installed under: `/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/data/motif_databases/` 

```bash
# included motifs databases
CIS-BP.motif2factors.txt                 HOMER.motif2factors.txt                    JASPAR2020_insects.pfm
CIS-BP.pfm                               HOMER.pfm                                  JASPAR2020.motif2factors.txt
ENCODE.motif2factors.txt                 IMAGE.motif2factors.txt                    JASPAR2020_nematodes.motif2factors.txt
ENCODE.pfm                               IMAGE.pfm                                  JASPAR2020_nematodes.pfm
factorbook.motif2factors.txt             JASPAR2018_fungi.motif2factors.txt         JASPAR2020.pfm
factorbook.pfm                           JASPAR2018_fungi.pfm                       JASPAR2020_plants.motif2factors.txt
gimme.invertebrate.v1.0.pwm              JASPAR2018_insects.motif2factors.txt       JASPAR2020_plants.pfm
gimme.plant.v1.0.pwm                     JASPAR2018_insects.pfm                     JASPAR2020_urochordates.motif2factors.txt
gimme.vertebrate.v3.1.factor2motifs.txt  JASPAR2018.motif2factors.txt               JASPAR2020_urochordates.pfm
gimme.vertebrate.v3.1.motif2factors.txt  JASPAR2018_nematodes.motif2factors.txt     JASPAR2020_vertebrates.motif2factors.txt
gimme.vertebrate.v3.1.pwm                JASPAR2018_nematodes.pfm                   JASPAR2020_vertebrates.pfm
gimme.vertebrate.v5.0.motif2factors.txt  JASPAR2018.pfm                             RSAT_insects.motif2factors.txt
gimme.vertebrate.v5.0.pfm                JASPAR2018_plants.motif2factors.txt        RSAT_insects.pfm
HOCOMOCOv10_HUMAN.motif2factors.txt      JASPAR2018_plants.pfm                      RSAT_plants.motif2factors.txt
HOCOMOCOv10_HUMAN.pfm                    JASPAR2018_urochordates.motif2factors.txt  RSAT_plants.pfm
HOCOMOCOv10_MOUSE.motif2factors.txt      JASPAR2018_urochordates.pfm                RSAT_vertebrates.motif2factors.txt
HOCOMOCOv10_MOUSE.pfm                    JASPAR2018_vertebrates.motif2factors.txt   RSAT_vertebrates.pfm
HOCOMOCOv11_HUMAN.motif2factors.txt      JASPAR2018_vertebrates.pfm                 SwissRegulon.motif2factors.txt
HOCOMOCOv11_HUMAN.pfm                    JASPAR2020_fungi.motif2factors.txt         SwissRegulon.pfm
HOCOMOCOv11_MOUSE.motif2factors.txt      JASPAR2020_fungi.pfm
HOCOMOCOv11_MOUSE.pfm 
```

And here is the config file content:

```bash
# ~/.config/gimmemotifs/gimmemotifs.cfg
[main]
bg = bg
template_dir = templates
score_dir = score_dists
gene_dir = genes
motif_databases = motif_databases
tools = included_tools/

[params]
fraction = 0.2
use_strand = False
abs_max = 5000
analysis = xl
enrichment = 1.5
size = 200
lsize = 500
background = gc,random
cluster_threshold = 0.95
scan_cutoff = 0.9
available_tools = MDmodule,MEME,MEMEW,Weeder,GADEM,MotifSampler,Trawler,Improbizer,BioProspector,Posmo,ChIPMunk,AMD,HMS,Homer,XXmotif,ProSampler,DiNAMO
tools = MEME,BioProspector,Homer
pvalue = 0.001
max_time = -1
ncpus = 12
motif_db = JASPAR2020_plants.pfm
use_cache = False

[YAMDA]
bin = run_em.py
dir = included_tools/

[DiNAMO]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/dinamo
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[RPMCMC]
bin = multi_motif_finder
dir = included_tools/

[ProSampler]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/ProSampler
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[AMD]
bin = AMD.bin
dir = included_tools/

[MEME]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/meme
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[DREME]
bin = dreme-py3
dir = included_tools/

[MEMEW]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/meme
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[MDmodule]
bin = MDmodule
dir = included_tools/

[Improbizer]
bin = ameme
dir = included_tools/

[MotifSampler]
bin = MotifSampler
dir = included_tools/

[GADEM]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/gadem
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[Trawler]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/trawler
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[Weeder]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/weeder2
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[BioProspector]
bin = BioProspector
dir = included_tools/

[ChIPMunk]
bin = ChIPMunk.sh
dir = included_tools/ChIPMunk

[Homer]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/homer2
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[XXmotif]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/XXmotif
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[Posmo]
bin = posmo
dir = included_tools/

[HMS]
bin = hms
dir = included_tools/HMS

```",jos4uke,https://github.com/vanheeringen-lab/gimmemotifs/issues/169
MDU6SXNzdWU3ODYzNjQyNzc=,gimme motifs error: creating statistics report crashed with KeyError: 'Factor',CLOSED,2021-01-14T21:47:59Z,2021-02-01T18:53:21Z,2021-02-01T18:53:21Z,"Hi @simonvh 

I ran gimme motifs after several  attempts and add-ons to my script you suggested me earlier.
But still I was not able to complete the full analysis. It crashed trying to generate the statistics report throwing a `KeyError: 'Factor'`.

Can you help please?

@jos4uke

**To Reproduce**

```bash
SEQDIR=seq
ZONES=(zone1 zone2 zone3 zone4)
ZONE_SEQS=(cds.ranges.zone1.flank.seqs.fa  cds.ranges.zone2.flank.seqs.fa  cds.ranges.zone3.flank.seqs.fa  cds.ranges.zone4.flank.seqs.fa)
OUTDIR=gimmemotifs
THREADS=12
#### gimme motifs 
MOTIFS_DB=JASPAR2020_plants 
REF_GENOME=my_genome.fa

# run information
ZONE_SEQ=$SEQDIR/${ZONE_SEQS[$SLURM_ARRAY_TASK_ID]}
ZONE=${ZONES[$SLURM_ARRAY_TASK_ID]}
OUTDIR_MOTIFS=${OUTDIR}/${ZONE}.motifs.random_bg
echo ""### zone seq file: ${ZONE_SEQ}""
echo ""### zone: ${ZONE}""
echo ""### output directory: ${OUTDIR_MOTIFS}""
mkdir -p $OUTDIR_MOTIFS
echo ""### create output directory: done""

# setup new cache 
# cache corruption on cluster workaround: https://gimmemotifs.readthedocs.io/en/master/faq.html#sqlite-error-when-running-on-a-cluster
NEW_CACHE=$OUTDIR_MOTIFS/cache
mkdir -p $NEW_CACHE
if [ -z $XDG_CACHE_HOME ]; then
    XDG_CACHE_HOME=$HOME/.cache
fi
cp -r $XDG_CACHE_HOME/gimmemotifs $NEW_CACHE/
export XDG_CACHE_HOME=$NEW_CACHE
echo '### new cache: Using $XDG_CACHE_HOME for cache'

gimme motifs ${ZONE_SEQ} ${OUTDIR_MOTIFS} \
	-g ${REF_GENOME} \
	--background random \
	-p ${MOTIFS_DB} \
	--analysis xl \
	--keepintermediate \
	--size 1000 \
	-N ${THREADS}

```

**Error logs**

```bash
2021-01-14 21:23:38,498 - INFO - creating background (random)
2021-01-14 21:23:55,607 - INFO - starting full motif analysis
2021-01-14 21:23:55,630 - INFO - using original size
2021-01-14 21:23:55,630 - INFO - preparing input from FASTA
2021-01-14 21:23:55,630 - INFO - preparing input (FASTA)
2021-01-14 21:24:27,487 - INFO - starting motif prediction (xl)
2021-01-14 21:24:27,488 - INFO - tools: MEME, BioProspector, Homer
2021-01-14 21:24:28,266 - INFO - all jobs submitted
2021-01-14 21:24:40,746 - INFO - Homer_width_6 finished, found 5 motifs
2021-01-14 21:24:44,046 - INFO - Homer_width_8 finished, found 5 motifs
2021-01-14 21:25:29,599 - INFO - Homer_width_10 finished, found 5 motifs
2021-01-14 21:27:04,055 - INFO - Homer_width_12 finished, found 5 motifs
2021-01-14 21:29:09,013 - INFO - BioProspector_width_6 finished, found 5 motifs
2021-01-14 21:29:09,462 - INFO - MEME_width_6 finished, found 0 motifs
2021-01-14 21:29:09,644 - INFO - MEME_width_8 finished, found 0 motifs
2021-01-14 21:29:09,808 - INFO - MEME_width_10 finished, found 0 motifs
2021-01-14 21:29:09,966 - INFO - MEME_width_12 finished, found 0 motifs
2021-01-14 21:29:10,135 - INFO - MEME_width_14 finished, found 0 motifs
2021-01-14 21:29:10,310 - INFO - MEME_width_16 finished, found 0 motifs
2021-01-14 21:29:10,473 - INFO - MEME_width_18 finished, found 0 motifs
2021-01-14 21:29:10,634 - INFO - MEME_width_20 finished, found 0 motifs
/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/subprocess.py:844: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stdout = io.open(c2pread, 'rb', bufsize)
/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/subprocess.py:849: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stderr = io.open(errread, 'rb', bufsize)
2021-01-14 21:29:11,185 - INFO - using 14000 sequences
2021-01-14 21:29:11,186 - INFO - Creating index for genomic GC frequencies.
2021-01-14 21:29:31,371 - INFO - Homer_width_14 finished, found 5 motifs
2021-01-14 21:29:33,975 - INFO - BioProspector_width_8 finished, found 5 motifs
2021-01-14 21:29:56,546 - INFO - BioProspector_width_10 finished, found 5 motifs
2021-01-14 21:30:20,797 - INFO - BioProspector_width_12 finished, found 5 motifs
2021-01-14 21:30:36,001 - INFO - BioProspector_width_14 finished, found 5 motifs
2021-01-14 21:30:58,691 - INFO - BioProspector_width_16 finished, found 5 motifs
2021-01-14 21:31:15,074 - INFO - BioProspector_width_20 finished, found 5 motifs
2021-01-14 21:31:20,170 - INFO - BioProspector_width_18 finished, found 5 motifs
2021-01-14 21:33:42,374 - INFO - Homer_width_16 finished, found 5 motifs
2021-01-14 21:38:07,963 - INFO - Homer_width_18 finished, found 5 motifs
2021-01-14 21:45:17,678 - INFO - Homer_width_20 finished, found 5 motifs
2021-01-14 21:45:58,723 - INFO - predicted 80 motifs
2021-01-14 21:45:58,734 - INFO - 78 motifs are significant
2021-01-14 21:45:59,182 - INFO - clustering 78 motifs.
2021-01-14 21:47:30,038 - INFO - creating de novo reports
2021-01-14 21:48:25,695 - INFO - finished
2021-01-14 21:48:25,695 - INFO - output dir: gimmemotifs/zone4.motifs.random_bg
2021-01-14 21:48:25,695 - INFO - de novo report: gimmemotifs/zone4.motifs.random_bg/gimme.denovo.html
/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/subprocess.py:849: RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used
  self.stderr = io.open(errread, 'rb', bufsize)
2021-01-14 21:49:00,534 - INFO - creating motif scan tables
2021-01-14 21:49:08,296 - INFO - using 14000 sequences
2021-01-14 22:07:59,320 - WARNING - Using 0.75-0.80
2021-01-14 22:09:18,919 - WARNING - Using 0.75-0.80
2021-01-14 22:11:20,017 - INFO - calculating stats
2021-01-14 22:12:10,075 - INFO - selecting non-redundant motifs
2021-01-14 22:12:24,993 - INFO - selected 22 non-redundant motifs: ROC AUC 0.911, PR AUC 0.825
2021-01-14 22:12:25,912 - INFO - determining FPR-based threshold
2021-01-14 22:12:27,610 - WARNING - Using 0.75-0.80
2021-01-14 22:12:28,888 - INFO - determining FPR-based threshold
2021-01-14 22:12:30,563 - WARNING - Using 0.75-0.80
2021-01-14 22:12:31,832 - INFO - determining FPR-based threshold
2021-01-14 22:12:33,709 - WARNING - Using 0.75-0.80
2021-01-14 22:12:35,006 - INFO - determining FPR-based threshold
2021-01-14 22:12:36,524 - WARNING - Using 0.75-0.80
2021-01-14 22:12:37,791 - INFO - determining FPR-based threshold
2021-01-14 22:12:39,454 - WARNING - Using 0.75-0.80
2021-01-14 22:12:40,751 - INFO - determining FPR-based threshold
2021-01-14 22:12:42,402 - WARNING - Using 0.75-0.80
2021-01-14 22:12:43,672 - INFO - determining FPR-based threshold
2021-01-14 22:12:45,426 - WARNING - Using 0.75-0.80
2021-01-14 22:12:46,731 - INFO - determining FPR-based threshold
2021-01-14 22:12:48,417 - WARNING - Using 0.75-0.80
2021-01-14 22:12:49,749 - INFO - determining FPR-based threshold
2021-01-14 22:12:51,326 - WARNING - Using 0.75-0.80
2021-01-14 22:12:52,590 - INFO - determining FPR-based threshold
2021-01-14 22:12:54,093 - WARNING - Using 0.75-0.80
2021-01-14 22:12:55,326 - INFO - determining FPR-based threshold
2021-01-14 22:12:56,876 - WARNING - Using 0.75-0.80
2021-01-14 22:12:58,120 - INFO - determining FPR-based threshold
2021-01-14 22:12:59,847 - WARNING - Using 0.75-0.80
2021-01-14 22:13:01,128 - INFO - determining FPR-based threshold
2021-01-14 22:13:02,699 - WARNING - Using 0.75-0.80
2021-01-14 22:13:03,971 - INFO - determining FPR-based threshold
2021-01-14 22:13:05,564 - WARNING - Using 0.75-0.80
2021-01-14 22:13:06,833 - INFO - determining FPR-based threshold
2021-01-14 22:13:08,370 - WARNING - Using 0.75-0.80
2021-01-14 22:13:09,638 - INFO - determining FPR-based threshold
2021-01-14 22:13:11,260 - WARNING - Using 0.75-0.80
2021-01-14 22:13:12,544 - INFO - determining FPR-based threshold
2021-01-14 22:13:14,243 - WARNING - Using 0.75-0.80
2021-01-14 22:13:15,549 - INFO - determining FPR-based threshold
2021-01-14 22:13:17,128 - WARNING - Using 0.75-0.80
2021-01-14 22:13:18,409 - INFO - determining FPR-based threshold
2021-01-14 22:13:20,032 - WARNING - Using 0.75-0.80
2021-01-14 22:13:21,306 - INFO - determining FPR-based threshold
2021-01-14 22:13:22,963 - WARNING - Using 0.75-0.80
2021-01-14 22:13:24,234 - INFO - determining FPR-based threshold
2021-01-14 22:13:25,861 - WARNING - Using 0.75-0.80
2021-01-14 22:13:27,139 - INFO - determining FPR-based threshold
2021-01-14 22:13:28,691 - WARNING - Using 0.75-0.80
2021-01-14 22:13:29,109 - INFO - creating statistics report
Traceback (most recent call last):
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/pandas/core/indexes/base.py"", line 3080, in get_loc
    return self._engine.get_loc(casted_key)
  File ""pandas/_libs/index.pyx"", line 70, in pandas._libs.index.IndexEngine.get_loc
  File ""pandas/_libs/index.pyx"", line 101, in pandas._libs.index.IndexEngine.get_loc
  File ""pandas/_libs/hashtable_class_helper.pxi"", line 4554, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File ""pandas/_libs/hashtable_class_helper.pxi"", line 4562, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Factor'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/commands/motifs.py"", line 265, in motifs
    roc_html_report(
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/report.py"", line 970, in roc_html_report
    0, ""factors"", motif_to_factor_series(df.index, pfmfile=pfmfile, motifs=motifs)
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/report.py"", line 816, in motif_to_factor_series
    factors = [motifs[motif].format_factors(html=True) for motif in series]
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/report.py"", line 816, in <listcomp>
    factors = [motifs[motif].format_factors(html=True) for motif in series]
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/gimmemotifs/motif.py"", line 1332, in format_factors
    fcount = Counter([x.upper() for x in self.factor_info[""Factor""]])
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/pandas/core/series.py"", line 824, in __getitem__
    return self._get_value(key)
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/pandas/core/series.py"", line 932, in _get_value
    loc = self.index.get_loc(label)
  File ""/opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/lib/python3.8/site-packages/pandas/core/indexes/base.py"", line 3082, in get_loc
    raise KeyError(key) from err
KeyError: 'Factor'

```

***Installation information:**
 - OS: Linux node7 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64 GNU/Linux 
 - Installation: `bash mamba create -n gimmemotifs python=3 gimmemotifs`
 - Versions:
   -   python                    3.8.6           hffdb5ce_4_cpython    conda-forge
   -  gimmemotifs               0.15.2           py38h0213d0e_0    bioconda

**Additional context**

 Here is the config file content:

```bash
# ~/.config/gimmemotifs/gimmemotifs.cfg
[main]
bg = bg
template_dir = templates
score_dir = score_dists
gene_dir = genes
motif_databases = motif_databases
tools = included_tools/

[params]
fraction = 0.2
use_strand = False
abs_max = 5000
analysis = xl
enrichment = 1.5
size = 200
lsize = 500
background = gc,random
cluster_threshold = 0.95
scan_cutoff = 0.9
available_tools = MDmodule,MEME,MEMEW,Weeder,GADEM,MotifSampler,Trawler,Improbizer,BioProspector,Posmo,ChIPMunk,AMD,HMS,Homer,XXmotif,ProSampler,DiNAMO
tools = MEME,BioProspector,Homer
pvalue = 0.001
max_time = -1
ncpus = 12
motif_db = JASPAR2020_plants.pfm
use_cache = False

[YAMDA]
bin = run_em.py
dir = included_tools/

[DiNAMO]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/dinamo
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[RPMCMC]
bin = multi_motif_finder
dir = included_tools/

[ProSampler]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/ProSampler
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[AMD]
bin = AMD.bin
dir = included_tools/

[MEME]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/meme
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[DREME]
bin = dreme-py3
dir = included_tools/

[MEMEW]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/meme
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[MDmodule]
bin = MDmodule
dir = included_tools/

[Improbizer]
bin = ameme
dir = included_tools/

[MotifSampler]
bin = MotifSampler
dir = included_tools/

[GADEM]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/gadem
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[Trawler]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/trawler
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[Weeder]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/weeder2
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[BioProspector]
bin = BioProspector
dir = included_tools/

[ChIPMunk]
bin = ChIPMunk.sh
dir = included_tools/ChIPMunk

[Homer]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/homer2
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[XXmotif]
bin = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin/XXmotif
dir = /opt/share/FLOCAD/userspace/jtran1/miniconda3/envs/gimmemotifs/bin

[Posmo]
bin = posmo
dir = included_tools/

[HMS]
bin = hms
dir = included_tools/HMS

```.
",jos4uke,https://github.com/vanheeringen-lab/gimmemotifs/issues/170
MDU6SXNzdWU3OTEwMDQ0NjY=,Run Gimme motif on pre-computed score tables,CLOSED,2021-01-21T12:02:03Z,2023-01-19T08:47:13Z,2023-01-19T08:47:13Z,"Hi,

I would like to know if there is an in built function that allows to compute motif enrichment starting from score_tables for target and background directly.

I need to check enrichments in subset of the same list of sequences and would like to speed up processing by simply partition the same target score_table and feed this into the motif enrichment tool.

Maybe can be done directly in python but don't know how.

Cheers,

Francesco",fgualdr,https://github.com/vanheeringen-lab/gimmemotifs/issues/171
MDU6SXNzdWU3OTEyMTA4MzM=,Maelstrom not running,CLOSED,2021-01-21T15:20:11Z,2021-06-18T08:29:26Z,2021-06-18T08:28:19Z,"**Describe the bug**
Maelstrom errors when running with default parameters.

**To Reproduce**
gimme maelstrom -N $SLURM_NTASKS /rds/user/cjr78/hpc-work/ATAC/gimmemotifs/maelstrom_forkhead/maelstrom_forkhead_input.txt mm10 /rds/user/cjr78/hpc-work/ATAC/gimmemotifs/maelstrom_forkhead/

**Expected behavior**
I've ran maelstrom before with no errors. Expecting a similar results.

**Error logs**
2021-01-21 15:06:51,859 - INFO - Starting maelstrom
2021-01-21 15:06:52,021 - INFO - motif scanning (counts)
2021-01-21 15:06:52,034 - INFO - reading table
2021-01-21 15:07:34,118 - INFO - using 14000 sequences
2021-01-21 15:08:35,419 - INFO - setting threshold
2021-01-21 15:09:26,638 - INFO - determining FPR-based threshold
2021-01-21 15:14:38,091 - INFO - creating count table
Traceback (most recent call last):
  File ""/home/cjr78/miniconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/maelstrom.py"", line 45, in maelstrom
    aggregation=aggregation,
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/maelstrom.py"", line 350, in run_maelstrom
    gc=gc,
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 166, in scan_regionfile_to_table
    for row in s.count(regions):
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 991, in count
    for matches in self.scan(seqs, nreport, scan_rc):
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 1074, in scan
    seqs = as_fasta(seqs, genome=self.genome)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/utils.py"", line 696, in as_fasta
    return Fasta(fdict=as_seqdict(to_convert, genome, minsize))
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/functools.py"", line 807, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/utils.py"", line 618, in _as_seqdict_list
    return _genomepy_convert(to_convert, genome, minsize)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/utils.py"", line 538, in _genomepy_convert
    g.track2fasta(to_convert, tmpfile.name)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/genomepy/genome.py"", line 361, in track2fasta
    track_type = self.get_track_type(track)
  File ""/home/cjr78/miniconda3/envs/gimme/lib/python3.6/site-packages/genomepy/genome.py"", line 334, in get_track_type
    with open(track) as fin:
TypeError: expected str, bytes or os.PathLike object, not list


**Installation information (please complete the following information):**
 - OS: Linux
 - Installation pip
 - Version 0.15.2

**Additional context**
Add any other context about the problem here.
",connorrogerson,https://github.com/vanheeringen-lab/gimmemotifs/issues/172
MDU6SXNzdWU3OTU4MTIyMTQ=,Rename ouput coverage table,CLOSED,2021-01-28T09:06:36Z,2021-02-02T08:29:59Z,2021-02-02T08:29:59Z,"**Is your feature request related to a problem? Please describe.**
Right now the ID column (chr1:1023-212)0 that is outputed by coverage table is called: ""loc""
However this is very inconvenient when using it in python (where you cant call the column via df.loc  for obvious reasons).

**Describe the solution you'd like**
If the column instead would be called something more descriptive e.g. 'region' I think that would be more descriptive and easier to use. :)",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/173
MDU6SXNzdWU3OTU4NDM5ODY=,Mapping TFs to motifs with pwm file previous run,CLOSED,2021-01-28T09:48:55Z,2021-01-28T09:56:05Z,2021-01-28T09:56:05Z,"**Describe the bug**

When I run gimme maelstrom using all regions of a specific analysis, i get a nice non-redundant PWM file, and a HTML output where (most) motifs are mapped to TFs:
<img width=""1823"" alt=""first_run_maelstrom"" src=""https://user-images.githubusercontent.com/47240368/106119939-0b52f580-6156-11eb-9a83-87dd00f5653a.png"">

However if I use this non-redudent PWM file for another gimme maelstrom run with a different (more specific) input, the mapping of TFs to motifs breaks. Eventhough the motifs seem very specific and TFs should be able to be matched to the motifs. This doesnt happen:
<img width=""1650"" alt=""second_run_maelstrom"" src=""https://user-images.githubusercontent.com/47240368/106120007-2160b600-6156-11eb-89b9-ab740baad840.png"">

**To Reproduce**
Run Maelstrom with a PWM file generated by a previous maelstrom run.

**Installation information (please complete the following information):**
conda, i think its a developmental version:
gimmemotifs               0.15.1+5.gfceb2a4          pypi_0    pypi",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/174
MDU6SXNzdWU4MDg3NDQ0Njg=,gimmemotifs lacks module pyarrow when installed with pip,CLOSED,2021-02-15T18:31:05Z,2021-05-18T17:14:04Z,2021-05-18T17:14:04Z,"**Describe the bug**
see title

**Expected behavior**
Dask also has extra dependencies when installing over Pip. Easiest solution would be to document it in [the same way.](https://docs.dask.org/en/latest/install.html#pip)

**Error logs**
[github action log](https://github.com/vanheeringen-lab/ANANSE/pull/31/checks?check_run_id=1905454221)

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: pip
 - Version: latest
",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/176
MDU6SXNzdWU4MzY5MzI2Nzc=,FIX: gimme_motifs call ignores user specified args ,CLOSED,2021-03-20T22:49:33Z,2021-05-18T17:15:26Z,2021-05-18T17:15:26Z,"**Issue:** user defined arguments are not included in` gimme_motifs()` in _motifs.py_ **line 104** 

```
gimme_motifs(
            sample,
            args.outdir,
            params={
                ""tools"": args.tools,
                ""analysis"": args.analysis,
                ""background"": bg,
                ""custom_background"": bgfile,
                ""genome"": args.genome,
                ""size"": args.size,
            },
        )

```
**As a result:**
          `params = parse_denovo_params(params)` in denovo.py line 571 sets parameters to default
         ` prepare_denovo_input_bed()` uses default **fraction** and **abs_max** (ignoring user-defined fraction value)

**Easy fix options**: 

(1) set the `.config/gimmemotifs/gimmemotifs.cfg` file directly

**OR** 

(2) alter ` gimme_motifs()` in _motifs.py_ **line 104**:

```
gimme_motifs(
            sample,
            args.outdir,
            params={
                ""tools"": args.tools,
                ""analysis"": args.analysis,
                ""background"": bg,
                ""custom_background"": bgfile,
                ""genome"": args.genome,
                ""size"": args.size,
                ""fraction"": args.fraction,
            },
        )
```
",kirbyziegler,https://github.com/vanheeringen-lab/gimmemotifs/issues/177
MDU6SXNzdWU4MzkzOTY2NDQ=,FIX: XXMotif.py does not parse motif results,CLOSED,2021-03-24T06:21:15Z,2021-05-18T17:13:48Z,2021-05-18T17:13:48Z,"### Running: test_tools.py

**[XXMotif.py]**: line 93: `motifs, stdout, stderr = self._read_and_label_motifs(outfile, stdout, stderr, fmt=""xxmotif"")`
**[motifprogram.py]**: line 41: `motifs = read_motifs(outfile, fmt=""meme"")`
**[motif.py]**: line 1591: `def read_motifs(infile=None, fmt=""pfm"", as_dict=False):`
**[motif.py]**: line 1621: `motifs = _read_motifs_from_filehandle(f, fmt)`

- The **fmt** variable is being overwritten from ""xxmotif"" to ""meme"" by _motifprogram.py_ (line 41)

### Solution:
**[motifprogram.py]**: line 41: `motifs = read_motifs(outfile, fmt)`
",kirbyziegler,https://github.com/vanheeringen-lab/gimmemotifs/issues/178
MDU6SXNzdWU4Mzk0MDI2NjI=,FIX: yamda.py _parse_params bug,CLOSED,2021-03-24T06:32:53Z,2021-05-18T17:13:26Z,2021-05-18T17:13:26Z,"### yamda.py:

 line 31: `prm = super._parse_params(params, needs_background=True)`

### Solution:

 line 31: `prm = super()._parse_params(params, needs_background=True)`",kirbyziegler,https://github.com/vanheeringen-lab/gimmemotifs/issues/179
MDU6SXNzdWU4Mzk0MTA3NjE=,FIX: yamda.py: attempts to run python script without python command ,CLOSED,2021-03-24T06:47:35Z,2021-05-18T17:13:10Z,2021-05-18T17:13:10Z,"### Solution:
**yamda.py:**

line 71: 

     cmd = ""python %s -i %s -j %s -n %s -w %s -oc %s  %s"" % (
            bin,
            fastafile,
            params[""background""],
            params[""number""],
            params[""width""],
            self.tmpdir,
            params[""strand""],
        )

- **python** _run_em.py_ [yamda_parameters]",kirbyziegler,https://github.com/vanheeringen-lab/gimmemotifs/issues/180
MDU6SXNzdWU4Mzk1MDE5Njk=,FIXES: trawler.py issues,CLOSED,2021-03-24T09:00:39Z,2021-05-18T17:12:48Z,2021-05-18T17:12:48Z,"**FIX1**
line20: `self.name = ""Trawler""`

**FIX2**
line31: `prm = super()._parse_params(params)`
",kirbyziegler,https://github.com/vanheeringen-lab/gimmemotifs/issues/181
MDU6SXNzdWU4NTE2MzU0NDI=,Interpreting maelstrom final.out.txt,CLOSED,2021-04-06T17:19:03Z,2021-04-09T08:44:19Z,2021-04-09T08:44:19Z,"I'd like to perform downstream analysis with the output from gimme maelstrom, so I'd like to know if all motifs from final.out.txt are interesting or maybe filtering by aggregated z-score would be a good starting point.",adeben1,https://github.com/vanheeringen-lab/gimmemotifs/issues/182
MDU6SXNzdWU4NTI0Mzc0MDU=,I cannot install following your instructions,CLOSED,2021-04-07T13:56:28Z,2021-04-07T14:20:15Z,2021-04-07T14:20:15Z,"Hello,
I followed your instructions to install the software using anaconda, and I get the following error immediately after starting `gimme`:
```
Traceback (most recent call last):
  File ""/Users/vscolari/opt/anaconda3/envs/gimme/bin/gimme"", line 8, in <module>
    from gimmemotifs.cli import cli
  File ""/Users/vscolari/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/__init__.py"", line 61, in <module>
    from . import denovo      # noqa: F401
  File ""/Users/vscolari/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 52, in <module>
    from gimmemotifs.report import create_denovo_motif_report
  File ""/Users/vscolari/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/report.py"", line 19, in <module>
    from pandas.core.indexing import _non_reducing_slice
ImportError: cannot import name '_non_reducing_slice' from 'pandas.core.indexing' (/Users/vscolari/opt/anaconda3/envs/gimme/lib/python3.8/site-packages/pandas/core/indexing.py)
```

OS MacOS Catalina: `Darwin 19.6.0 Darwin Kernel Version 19.6.0: Mon Aug 31 22:12:52 PDT 2020; root:xnu-6153.141.2~1/RELEASE_X86_64 x86_64`",scovit,https://github.com/vanheeringen-lab/gimmemotifs/issues/183
MDU6SXNzdWU4NTMxOTM2NzE=,CLIP-seq analysis - RNA motifs,CLOSED,2021-04-08T08:06:16Z,2021-04-09T13:46:04Z,2021-04-09T13:46:04Z,"Hi,

Is it possible to use `gimmemotifs` for the detection of RNA motifs from CLIP-seq derived locations? Off the top of my head, the main differences from ChIP-seq (DNA) motifs is that RNA motifs will be on a single strand, that to which the RNA-binding protein binds to, rather than both strands. With that in mind I have called binding site with a CLIP-seq specific tool, extracted the DNA sequencing from the binding strand, and used this command for motif discovery:

```
gimme motifs pred.rat.top1000.fa ./ -g ${GENOME}/Sequence/WholeGenomeFasta/genome.fa -N 10 --denovo --size 50 --analysis small --singlestrand
```

I am assuming that using `--singlestrand` only the sequences in the file will be use for motif prediction, and not those from both strands. Is this correct? `--size 50 --analysis small` are being used because there is a published motif for this particular protein and it is small - my goal is to partly recover the published motif from my data. 


Am I missing nay other setting or doing this entirily the wrong way? 

Cheers.",adomingues,https://github.com/vanheeringen-lab/gimmemotifs/issues/184
MDU6SXNzdWU4NTk5Mjk2MzI=,how to find the location of motif,CLOSED,2021-04-16T15:34:16Z,2023-01-19T08:46:05Z,2023-01-19T08:46:05Z,"hello,
    I have run `gimme maelstrom` to predict motifs based on ATAC-seq peaks from multiple groups. Now I want to know whether a specific peak contain a motif. here are the results I got:
![image](https://user-images.githubusercontent.com/12387462/115048538-aaf76880-9ea7-11eb-9796-0000e7be0aa0.png)
",BenxiaHu,https://github.com/vanheeringen-lab/gimmemotifs/issues/186
MDU6SXNzdWU4OTEzNDY3NDE=,"scanner.set_background ""OperationalError: attempt to write a readonly database""",CLOSED,2021-05-13T20:26:58Z,2021-05-16T10:32:44Z,2021-05-16T10:32:44Z,"**Describe the bug**
I am using gimmemotifs in a jupyter notebook installed in a docker container.  When trying to ""set_background"", I get ""OperationalError: attempt to write a readonly database""

I think I probably need to chmod a specific file or directory, but I'm not sure which one.

**To Reproduce**
```
from gimmemotifs.scanner import Scanner
s = Scanner()
s.set_background(genome='hg19', size=200)
```

**Expected behavior**
not sure, but hopefully no error!

**Error logs**
```
---------------------------------------------------------------------------
OperationalError                          Traceback (most recent call last)
<ipython-input-13-d39db170f527> in <module>
      1 from gimmemotifs.scanner import Scanner
      2 s = Scanner()
----> 3 s.set_background(genome='hg19', size=200)

/opt/conda/lib/python3.8/site-packages/gimmemotifs/scanner.py in set_background(self, fname, genome, size, nseq, gc, gc_bins)
    725         logger.debug(""using background: genome {} with size {}"".format(genome, size))
    726         lock.acquire()
--> 727         with Cache(CACHE_DIR) as cache:
    728             self.background_hash = ""d{}:{}:{}:{}"".format(
    729                 genome, int(size), gc, str(gc_bins)

/opt/conda/lib/python3.8/site-packages/diskcache/core.py in __init__(self, directory, timeout, disk, **settings)
    479         for key, value in sorted(sets.items()):
    480             if key.startswith('sqlite_'):
--> 481                 self.reset(key, value, update=False)
    482 
    483         sql(

/opt/conda/lib/python3.8/site-packages/diskcache/core.py in reset(self, key, value, update)
   2443                 try:
   2444                     try:
-> 2445                         ((old_value,),) = sql(
   2446                             'PRAGMA %s' % (pragma)
   2447                         ).fetchall()

OperationalError: attempt to write a readonly database
```

**Installation information (please complete the following information):**
 - Ubuntu 20.04.1
 - conda install gimmemotifs==0.14.4

",celinesin,https://github.com/vanheeringen-lab/gimmemotifs/issues/188
MDU6SXNzdWU5MDA1NzQyNzM=,Error while running tutorial,CLOSED,2021-05-25T09:55:58Z,2023-01-19T09:05:55Z,2023-01-19T09:05:55Z,"**Describe the bug**
I was following the tutorial (https://gimmemotifs.readthedocs.io/en/master/tutorials.html#find-de-novo-motifs). When searching for de-novo motifs I get the following error:

$ gimme motifs Gm12878.CTCF.top500.narrowPeak gimme.CTCF -g hg19 --denovo
2021-05-25 09:59:02,874 - INFO - creating background (matched GC%)
Traceback (most recent call last):
  File ""/home/neuhaus/miniconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/commands/motifs.py"", line 87, in motifs
    create_background_file(
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/background.py"", line 121, in create_background_file
    m = MatchedGcFasta(inputfile, genome, number=number, size=size)
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/background.py"", line 577, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/background.py"", line 510, in matched_gc_bedfile
    fraction = number / len(gc)
ZeroDivisionError: division by zero

$ tree gimme.CTCF/
gimme.CTCF/
├── input.w200.bed
└── motif_scan_results

The input.w200.bed looks alright, it contains 500 lines. 
$ head -n 5 gimme.CTCF/input.w200.bed
chr11   190037  190237  1501.49835704239
chr14   106873577       106873777       1275.01449536283
chr14   106765204       106765404       1264.07667497398
chr15   22461178        22461378        1111.26912053378
chr14   107119996       107120196       996.90008265053

**To Reproduce**
I pretty much followed the tutorial step-by-step, but for completness here are the commands:

$ conda create -n gimme python=3 gimmemotifs
...
Executing transaction: \
For Linux 64, Open MPI is built with CUDA awareness but this support is disabled by default.
To enable it, please set the environment variable OMPI_MCA_opal_cuda_support=true before
launching your MPI processes. Equivalently, you can set the MCA parameter in the command line:
mpiexec --mca opal_cuda_support 1 ...

In addition, the UCX support is also built but disabled by default.
To enable it, first install UCX (conda install -c conda-forge ucx). Then, set the environment
variables OMPI_MCA_pml=""ucx"" OMPI_MCA_osc=""ucx"" before launching your MPI processes.
Equivalently, you can set the MCA parameters in the command line:
mpiexec --mca pml ucx --mca osc ucx ...
Note that you might also need to set UCX_MEMTYPE_CACHE=n for CUDA awareness via UCX.
Please consult UCX's documentation for detail.
...
done

$ conda activate gimme
$ conda env config vars set OMPI_MCA_opal_cuda_support=true
$ conda install -c conda-forge ucx
$ conda env config vars set OMPI_MCA_pml=""ucx""
$ conda env config vars set OMPI_MCA_osc=""ucx""
$ conda deactivate; conda activate gimme; conda env config vars list
OMPI_MCA_opal_cuda_support = true
OMPI_MCA_pml = ucx
OMPI_MCA_osc = ucx

$  wget http://ftp.ebi.ac.uk/pub/databases/ensembl/encode/integration_data_jan2011/byDataType/peaks/jan2011/spp/optimal/hub/spp.optimal.wgEncodeBroadHistoneGm12878CtcfStdAlnRep0_VS_wgEncodeBroadHistoneGm12878ControlStdAlnRep0.bb
$ bigBedToBed spp.optimal.wgEncodeBroadHistoneGm12878CtcfStdAlnRep0_VS_wgEncodeBroadHistoneGm12878ControlStdAlnRep0.bb Gm12878.CTCF.narrowPeak
$ sort -k7gr Gm12878.CTCF.narrowPeak | head -n 500 > Gm12878.CTCF.top500.narrowPeak
$ genomepy install hg19 UCSC --annotation

$ gimme motifs Gm12878.CTCF.top500.narrowPeak gimme.CTCF -g hg19 --denovo

2021-05-25 09:59:02,874 - INFO - creating background (matched GC%)
Traceback (most recent call last):
  File ""/home/neuhaus/miniconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/cli.py"", line 661, in cli
    args.func(args)
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/commands/motifs.py"", line 87, in motifs
    create_background_file(
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/background.py"", line 121, in create_background_file
    m = MatchedGcFasta(inputfile, genome, number=number, size=size)
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/background.py"", line 577, in __init__
    matched_gc_bedfile(tmpbed, matchfile, genome, number, size=size)
  File ""/home/neuhaus/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/background.py"", line 510, in matched_gc_bedfile
    fraction = number / len(gc)
ZeroDivisionError: division by zero


**Installation information:**
 - OS: CentOS Linux 7 (Core)
 - Installation conda (conda 4.10.1)
 - gimmemotifs: 0.15.3

Thanks for your help,
Florian

",fneuh,https://github.com/vanheeringen-lab/gimmemotifs/issues/189
MDU6SXNzdWU5MTgzNzE4NTk=,ValueError: Motif GM.5.0.bHLH.0126 does not occur in motif database when running maelstrom,CLOSED,2021-06-11T07:54:43Z,2021-11-05T12:42:05Z,2021-06-28T09:43:26Z,"Dear developer

I am running maelstrom using the test data `hg19.blood.most_variable.1k.txt`
my hg19 genome is from
```
sgd@localhost ~/reference/genome/hg19
$ genomepy install hg19 --annotation -g .
Downloading genome from UCSC.
Target URL: http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz...
Download: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 905M/905M [01:54<00:00, 8.30MB/s]
Genome download successful, starting post processing...

name: hg19
local name: hg19
fasta: /data/sgd_data/reference/genome/hg19/hg19/hg19.fa
Downloading annotation from UCSC.
Target URL: http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/genes/hg19.knownGene.gtf.gz...
Download: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 17.1M/17.1M [00:03<00:00, 4.53MB/s]
Annotation download successful
```

```
sgd@localhost ~/test
$ gimme maelstrom hg19.blood.most_variable.1k.txt ~/reference/genome/hg19/hg19/hg19.fa maelstrom.blood.1k.out -N 60
2021-06-11 15:23:06,610 - INFO - Starting maelstrom
2021-06-11 15:23:06,617 - INFO - Input is not mean-centered, setting the mean of all rows to 0.
2021-06-11 15:23:06,617 - INFO - Use --nocenter if you know what you're doing and want to change this behavior.
2021-06-11 15:23:06,617 - INFO - Note that if you use count data (ChIP-seq, ATAC-seq) we recommend to first transform your data, for instance using log2(), and to normalize between samples. To create a table suitable for maelstrom you can use the coverage_table script included with GimmeMotifs.
2021-06-11 15:23:06,632 - INFO - Counts, using: maelstrom.blood.1k.out/motif.count.txt.gz
2021-06-11 15:23:06,632 - INFO - motif scanning (scores)
2021-06-11 15:23:06,632 - INFO - reading table
2021-06-11 15:23:12,367 - INFO - creating score table (z-score, GC%)
2021-06-11 15:45:27,389 - INFO - done
2021-06-11 15:45:28,815 - INFO - creating dataframe
2021-06-11 15:45:38,405 - INFO - Selecting non-redundant motifs
2021-06-11 15:45:43,852 - INFO - Selected 657 motifs
2021-06-11 15:45:43,852 - INFO - Motifs: maelstrom.blood.1k.out/nonredundant.motifs.pfm
2021-06-11 15:45:43,852 - INFO - Factor mappings: maelstrom.blood.1k.out/nonredundant.motifs.motif2factors.txt
2021-06-11 15:45:44,024 - INFO - Fitting BayesianRidge
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.46it/s]
2021-06-11 15:45:46,488 - INFO - Done
2021-06-11 15:45:46,757 - INFO - Fitting XGBoostRegression
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:24<00:00,  4.15s/it]
2021-06-11 15:46:11,661 - INFO - Done
2021-06-11 15:46:11,844 - INFO - Fitting MultiTaskLasso
2021-06-11 15:46:14,602 - INFO - Done
2021-06-11 15:46:14,878 - INFO - Fitting SVR
2021-06-11 15:46:22,090 - INFO - Done
2021-06-11 15:46:22,111 - INFO - Rank aggregation
2021-06-11 15:46:23,020 - INFO - Correlation
2021-06-11 15:46:24,321 - INFO - html report
Traceback (most recent call last):
  File ""/opt/sysoft/Python-3.7.9/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/opt/sysoft/Python-3.7.9/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 730, in cli
    args.func(args)
  File ""/opt/sysoft/Python-3.7.9/lib/python3.7/site-packages/gimmemotifs/commands/maelstrom.py"", line 45, in maelstrom
    aggregation=aggregation,
  File ""/opt/sysoft/Python-3.7.9/lib/python3.7/site-packages/gimmemotifs/maelstrom.py"", line 546, in run_maelstrom
    maelstrom_html_report(outdir, os.path.join(outdir, ""final.out.txt""), pfmfile)
  File ""/opt/sysoft/Python-3.7.9/lib/python3.7/site-packages/gimmemotifs/report.py"", line 868, in maelstrom_html_report
    motif_to_img_series(df.index, pfmfile=pfmfile, outdir=outdir, subdir=""logos""),
  File ""/opt/sysoft/Python-3.7.9/lib/python3.7/site-packages/gimmemotifs/report.py"", line 837, in motif_to_img_series
    raise ValueError(f""Motif {motif} does not occur in motif database"")
ValueError: Motif GM.5.0.bHLH.0126 does not occur in motif database

```

Best wishes

Guandong Shang",shangguandong1996,https://github.com/vanheeringen-lab/gimmemotifs/issues/192
MDU6SXNzdWU5MTk5NTUyODQ=,gimme scan running quite time,CLOSED,2021-06-14T02:56:24Z,2023-01-19T08:44:45Z,2023-01-19T08:44:45Z,"Hi, dear developer 

I am running gimme scan using my bed and genome, but it takes so much time. and it not finished.
```
$ gimme scan -g ~/reference/genome/TAIR10/Athaliana.fa -p /opt/sysoft/Python-3.7.9/lib/python3.7/site-packages/data/motif_databases/JASPAR2018_plants.pfm test.bed > test.motif
2021-06-14 10:45:48,025 - INFO - determining FPR-based threshold

```

Here is my bed, which has only 1000 line
```
$ head test.bed 
Chr1	1422	3756	CIM_SIM_ATAC_1	.	.
Chr1	6494	6860	CIM_SIM_ATAC_2	.	.
Chr1	8527	8978	CIM_SIM_ATAC_3	.	.
Chr1	9381	9877	CIM_SIM_ATAC_4	.	.
Chr1	13375	15027	CIM_SIM_ATAC_5	.	.
Chr1	15874	16066	CIM_SIM_ATAC_6	.	.
Chr1	16542	16929	CIM_SIM_ATAC_7	.	.
Chr1	20621	21789	CIM_SIM_ATAC_8	.	.
Chr1	22150	23178	CIM_SIM_ATAC_9	.	.
Chr1	32994	34002	CIM_SIM_ATAC_10	.	.

```
Here is my genome, whose size about 100MB
```
$ head ~/reference/genome/TAIR10/Athaliana.fa
>Chr1
CCCTAAACCCTAAACCCTAAACCCTAAACCTCTGAATCCTTAATCCCTAAATCCCTAAATCTTTAAATCCTACATCCAT
GAATCCCTAAATACCTAATTCCCTAAACCCGAAACCGGTTTCTCTGGTTGAAAATCATTGTGTATATAATGATAATTTT
ATCGTTTTTATGTAATTGCTTATTGTTGTGTGTAGATTTTTTAAAAATATCATTTGAGGTCAATACAAATCCTATTTCT
TGTGGTTTTCTTTCCTTCACTTAGCTATGGATGGTTTATCTTCATTTGTTATATTGGATACAAGCTTTGCTACGATCTA
CATTTGGGAATGTGAGTCTCTTATTGTAACCTTAGGGTTGGTTTATCTCAAGAATCTTATTAATTGTTTGGACTGTTTA
TGTTTGGACATTTATTGTCATTCTTACTCCTTTGTGGAAATGTTTGTTCTATCAATTTATCTTTTGTGGGAAAATTATT
TAGTTGTAGGGATGAAGTCTTTCTTCGTTGTTGTTACGCTTGTCATCTCATCTCTCAATGATATGGGATGGTCCTTTAG
CATTTATTCTGAAGTTCTTCTGCTTGATGATTTTATCCTTAGCCAAAAGGATTGGTGGTTTGAAGACACATCATATCAA
AAAAGCTATCGCCTCGACGATGCTCTATTTCTATCCTTGTAGCACACATTTTGGCACTCAAAAAAGTATTTTTAGATGT

```

But if I use the test data, it only takes less than 1 min

```
$ gimme scan Gm12878.CTCF.top500.w200.bed -g ~/reference/genome/hg19/hg19/hg19.fa > Gm12878.CTCF.top500.w200.motif 
```

```
$ head Gm12878.CTCF.top500.w200.motif 
# GimmeMotifs version 0.16.0
# Input: Gm12878.CTCF.top500.w200.bed
# Motifs: /opt/sysoft/Python-3.7.9/lib/python3.7/site-packages/gimmemotifs/../data/motif_databases/gimme.vertebrate.v5.0.pfm
# FPR: 0.01 (/home/sgd/reference/genome/hg19/hg19/hg19.fa)
# Scoring: logodds score
chr11:190037-190237	pfmscan	misc_feature	143	159	13.564392316467963	+	.	motif_name ""GM.5.0.C2H2_ZF.0023"" ; motif_instance ""acgccccctgctggcag""
chr11:190037-190237	pfmscan	misc_feature	143	156	11.987579910503003	+	.	motif_name ""GM.5.0.C2H2_ZF.0024"" ; motif_instance ""acgccccctgctgg""
chr11:190037-190237	pfmscan	misc_feature	28	40	7.964216719769734	-	.	motif_name ""GM.5.0.C2H2_ZF.0028"" ; motif_instance ""cctgctggcaacc""
chr11:190037-190237	pfmscan	misc_feature	144	156	13.411970806500104	+	.	motif_name ""GM.5.0.C2H2_ZF.0037"" ; motif_instance ""cgccccctgctgg""
chr11:190037-190237	pfmscan	misc_feature	144	156	8.375953426690378	-	.	motif_name ""GM.5.0.Mixed.0025"" ; motif_instance ""cgccccctgctgg""

```

Best wishes

Guandong Shang",shangguandong1996,https://github.com/vanheeringen-lab/gimmemotifs/issues/193
MDU6SXNzdWU5MzY1NDQxNzE=,Adjust the figure size of maelstrom heatmap,CLOSED,2021-07-04T21:30:02Z,2021-07-10T15:17:26Z,2021-07-10T15:17:26Z,"Hi, I want to plot the heatmap of MaelstromResult. However I cannot print all the motifs names of each row even I adjusted  the size of heatmap.
`mr.plot_heatmap(figsize=(20, 20),threshold=1)`
`mr.plot_heatmap(figsize=(6, 6),threshold=1)`
it can only change the size of heatmap not the labels as the followings,

![image](https://user-images.githubusercontent.com/10953976/124399692-0dc50700-dd15-11eb-8826-b18620b899ca.png)
![image](https://user-images.githubusercontent.com/10953976/124399701-1c132300-dd15-11eb-97b4-caf3d1cb2e2a.png)

Could you please help to give any advice on how to adjust the heatmap in python? Or if I can use R to plot this heatmap?  
Thank you very much!",lynnyummy,https://github.com/vanheeringen-lab/gimmemotifs/issues/194
MDU6SXNzdWU5Mzc2NDk3NDQ=,Non insightfull error,CLOSED,2021-07-06T08:30:51Z,2023-01-19T08:44:19Z,2023-01-19T08:44:19Z,"Hi Simon! 
When trying to run gimme scan on a summit file with 1bp regions (because I forgot to rescale them after merge peaks), the error is not verry insightfull (at least to me).

> Traceback (most recent call last):
>   File ""/vol/mbconda/jsmits/envs/ananse/bin/gimme"", line 11, in <module>
>     cli(sys.argv[1:])
>   File ""/vol/mbconda/jsmits/envs/ananse/lib/python3.7/site-packages/gimmemotifs/cli.py"", line 730, in cli
>     args.func(args)
>   File ""/vol/mbconda/jsmits/envs/ananse/lib/python3.7/site-packages/gimmemotifs/commands/pfmscan.py"", line 36, in pfmscan
>     gcnorm=args.gcnorm,
>   File ""/vol/mbconda/jsmits/envs/ananse/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 416, in scan_to_file
>     gcnorm=gcnorm,
>   File ""/vol/mbconda/jsmits/envs/ananse/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 310, in command_scan
>     genome=genome, fname=bgfile, size=fa.median_length(), gc=gcnorm
>   File ""/vol/mbconda/jsmits/envs/ananse/lib/python3.7/site-packages/gimmemotifs/scanner.py"", line 889, in set_background
>     cache.set(self.background_hash, (fa, gc_bins))
>   File ""/vol/mbconda/jsmits/envs/ananse/lib/python3.7/site-packages/diskcache/core.py"", line 772, in set
>     size, mode, filename, db_value = self._disk.store(value, read, key=key)
>   File ""/vol/mbconda/jsmits/envs/ananse/lib/python3.7/site-packages/diskcache/core.py"", line 234, in store
>     result = pickle.dumps(value, protocol=self.pickle_protocol)
> ValueError: pickle protocol must be <= 4

Eventually I found out the problem, but i think a more insightfull error would be nice.

Gr Jos
",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/195
MDU6SXNzdWU5Mzg2NjU0NDg=,motif2factors with non-public assemblies,CLOSED,2021-07-07T09:06:10Z,2022-01-03T12:19:39Z,2022-01-03T12:19:39Z,"**Is your feature request related to a problem? Please describe.**
The current implementation assumes the assembly is downloadable with genomepy, plus that it contains a gtf file. Ideally, we support the cases where this is not the case as well.",Maarten-vd-Sande,https://github.com/vanheeringen-lab/gimmemotifs/issues/196
MDU6SXNzdWU5MzkxODcwNDU=,Autogenerated API documentation,OPEN,2021-07-07T19:16:53Z,2021-07-08T07:25:56Z,,"I love the engineering of the library but I am forced to spelunk through the source code to understand how to make use of the Python library. For example, what's the easy way to load one of the libraries of motifs included with the package? It would be awesome to have some more comprehensive auto-generated API docs, and/or examples of using the Python API.",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/197
MDU6SXNzdWU5MzkyMzQ3MTg=,Add config method to list available motif libraries,CLOSED,2021-07-07T20:24:21Z,2021-12-22T14:02:00Z,2021-12-22T14:02:00Z,"AFAICT there is no way to list all the libraries that are ""batteries-included"" with a gimmemotifs install. I think this code snippet will do it.

```python
def list_gimmemotif_included_libraries():
    """"""Return a list of all motif libraries included with gimmemotifs

    The returned strings are suitable for use with `gimmemotifs.motif.read_motifs`
    """"""
    library_files = glob(str(Path(MotifConfig().get_motif_dir()).resolve() / ""*.pfm""))
    return sorted([Path(p).name for p in library_files])
```

You could potentially add this type of thing to the `MotifConfig` object if that makes sense to you. Happy to submit a PR if it'll be accepted.",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/198
MDU6SXNzdWU5NDA5NjcxNTY=,CIS-BP identifier mapping for Lambert et al,OPEN,2021-07-09T18:03:32Z,2021-07-13T13:55:58Z,,"It seems like the Lambert et al Cell review is a very popular resource. Unfortunately, all the CIS-BP identifiers used in their supplementary tables reference a v1.94d, which seems publicly unavailable afaict. Matt Weirauch sent me a mapping between v1.94d and v2.00, which is publicly available and included with a gimmemotifs installation. Would it be off-topic to include this mapping file into the distribution?",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/200
MDU6SXNzdWU5NDUzNTUzNTI=,A problem about input peak select for maelstrom,CLOSED,2021-07-15T13:00:56Z,2023-01-19T09:05:33Z,2023-01-19T09:05:33Z,"Hi, 

I have some questions about input data of maelstrom. **Is there any limit about input peak set select ?**. I noticed you use the most variable peak as input peak count data. I am just wondering why you select the most variable peak.

**And I am wondering whether I can use maelstrom in not most variable peak set**. For example, I have a interesting gene set, and I extract nearby peak and want to see the motif tendency in this peak set during different samples.

And the third question is that If I have two peak set: set A and set B, **Will the result of maelstrom be much different?** For example, TF C2C2 value will be 4-2-1-0 in set A while C2C2 value will be 0-1-2-4 in set B.  

Best wishes
Guandong Shang",shangguandong1996,https://github.com/vanheeringen-lab/gimmemotifs/issues/202
MDU6SXNzdWU5NzQ5NTkwMDI=,Sampling from a PWM,CLOSED,2021-08-19T19:03:19Z,2021-12-22T14:02:01Z,2021-12-22T14:02:01Z,"Is there a recommended way to ""realize"" a sequence from a PWM using random sampling? I would imagine something like

```
rng = np.random.default_rng()
motif.sample_from_pwm(rng)
```

that would generate the associated random sequence.

Alternatively, is there a recommended snippet of code to accomplish which is *fast*?",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/204
MDU6SXNzdWU5ODM3NjQ1NzA=,motif2factors python 3.6 TypeError: __init__() got an unexpected keyword argument 'capture_output',CLOSED,2021-08-31T11:41:58Z,2021-12-22T14:02:00Z,2021-12-22T14:02:00Z,"```
gimmemotifs/orthologs.py"", line 163, in _orthofinder
    [""orthofinder"", ""-f"", peptide_folder, ""-t"", str(threads)], capture_output=True

TypeError: __init__() got an unexpected keyword argument 'capture_output'
```

Related to python<3.7


If we are upgrading to 3.8 anyways, then we can just leave it for now. Otherwise we need to do some small changes in how we capture stdout/stderr",Maarten-vd-Sande,https://github.com/vanheeringen-lab/gimmemotifs/issues/205
MDU6SXNzdWU5OTQzMTEyNTA=,ERROR multiprocessing.pool.apply_async(),OPEN,2021-09-12T23:21:33Z,2021-09-13T01:43:17Z,,"Running _gimme_ script using an interpreter (pycharm) on macOS. 

This first call runs successfully:

**[line 781] report.py:** closest_match = mc.get_closest_match(motifs)

This second call throws an error while waiting for jobs to finish: 

**[line 119] motifs.py:** result = mc.get_closest_match(denovo, dbmotifs=pfmfile, metric=""seqcor"")

> comparison.py throws this ERROR after pool.close() [line 749]

```
Traceback (most recent call last):
  File ""/Users/kirbyziegler/miniconda3/lib/python3.8/multiprocessing/spawn.py"", line 125, in _main
    prepare(preparation_data)
  File ""/Users/kirbyziegler/miniconda3/lib/python3.8/multiprocessing/spawn.py"", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File ""/Users/kirbyziegler/miniconda3/lib/python3.8/multiprocessing/spawn.py"", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File ""/Users/kirbyziegler/miniconda3/lib/python3.8/runpy.py"", line 265, in run_path
    return _run_module_code(code, init_globals, run_name,
  File ""/Users/kirbyziegler/miniconda3/lib/python3.8/runpy.py"", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File ""/Users/kirbyziegler/miniconda3/lib/python3.8/runpy.py"", line 87, in _run_code
    exec(code, run_globals)
  File ""/Users/kirbyziegler/Projects/gimmemotifs-0.15.3/scripts/gimme"", line 8, in <module>
    from gimmemotifs.cli import cli
  File ""/Users/kirbyziegler/Projects/gimmemotifs-0.15.3/gimmemotifs/__init__.py"", line 61, in <module>
    from . import denovo      # noqa: F401
  File ""/Users/kirbyziegler/Projects/gimmemotifs-0.15.3/gimmemotifs/denovo.py"", line 52, in <module>
    from gimmemotifs.report import create_denovo_motif_report
  File ""/Users/kirbyziegler/Projects/gimmemotifs-0.15.3/gimmemotifs/report.py"", line 68, in <module>
    class ExtraStyler(Styler):
  File ""/Users/kirbyziegler/Projects/gimmemotifs-0.15.3/gimmemotifs/report.py"", line 74, in ExtraStyler
    [jinja2.FileSystemLoader(MotifConfig().get_template_dir()), Styler.loader]
  File ""/Users/kirbyziegler/Projects/gimmemotifs-0.15.3/gimmemotifs/config.py"", line 242, in get_template_dir
    return self.get_data_dir(""template_dir"")
  File ""/Users/kirbyziegler/Projects/gimmemotifs-0.15.3/gimmemotifs/config.py"", line 229, in get_data_dir
    my_dir = self.config.get(""main"", ddir)
  File ""/Users/kirbyziegler/miniconda3/lib/python3.8/configparser.py"", line 781, in get
    d = self._unify_values(section, vars)
  File ""/Users/kirbyziegler/miniconda3/lib/python3.8/configparser.py"", line 1149, in _unify_values
    raise NoSectionError(section) from None
configparser.NoSectionError: No section: 'main'
```

I attempted to fix by:

1) Calling pool.join() directly after pool.close(), this forces the program to wait for jobs to complete

  ```
  logger.info(""closing pool.."")
  pool.close()
  logger.info(""waiting for processes to finish.."")
  pool.join()
  logger.info(""getting jobs (%d).."", len(jobs))
```

2) Altering code so that the number of jobs is never more than the ncpus

  ```
  batch_len = math.ceil(len(dbmotifs) / ncpus)
  ```

3) Adding freeze support

```
from multiprocessing import freeze_support
freeze_support()
```

4) Turning off parallel. This works, but is slow. 
     Indicates __get_all_scores(metric=""seqcor"")_ functions properly.

  ```
  result = mc.get_closest_match(denovo, dbmotifs=pfmfile, metric=""seqcor"", parallel=False)
  ```

5) Using default  metric=""wic""  with parallel instead of  metric=""seqcor"".  **THIS WORKS**. 

  ```
  result = mc.get_closest_match(denovo, dbmotifs=pfmfile, metric=""wic"", parallel=True)
  ```
### Any idea why metric=""seqcor"" cannot be run in parallel here?

- What is the consequence of using _wic_ instead of _seqcor_ here?
- Could it possibly be a pickling error?
   https://docs.python.org/3/library/pickle.html#what-can-be-pickled-and-unpickled
   https://stackoverflow.com/questions/8804830/python-multiprocessing-picklingerror-cant-pickle-type-function

6) **[line 246] motifs.py:** nr_motifs = select_nonredundant_motifs(). **THIS WORKS**. 
    Indicates that _mc.get_all_scores(metric=""seqcor"")_ functions properly in parallel. 


### SUMMARY

  ```
mc.get_closest_match(denovo, dbmotifs=pfmfile, metric=""seqcor"", parallel=True)  ##FAIL
mc.get_closest_match(denovo, dbmotifs=pfmfile, metric=""seqcor"", parallel=False) ##PASS
mc.get_closest_match(denovo, dbmotifs=pfmfile, metric=""wic"", parallel=True)     ##PASS
mc.get_all_scores(denovo, nonredundant, metric=""seqcor"", parallel=True)         ##PASS
  ```




",kirbyziegler,https://github.com/vanheeringen-lab/gimmemotifs/issues/206
I_kwDOAApTRs48mgHM,Error: 127,CLOSED,2021-10-05T19:45:20Z,2023-01-19T08:42:20Z,2023-01-19T08:42:20Z,"Running this command:  

genomepy install GRCm38.p5 --annotation

I got: 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/spuccio/anaconda3/envs/gimme/bin/genomepy"", line 8, in <module>
    sys.exit(cli())
  File ""/home/spuccio/anaconda3/envs/gimme/lib/python3.9/site-packages/click/core.py"", line 1137, in __call__
    return self.main(*args, **kwargs)
  File ""/home/spuccio/anaconda3/envs/gimme/lib/python3.9/site-packages/click/core.py"", line 1062, in main
    rv = self.invoke(ctx)
  File ""/home/spuccio/anaconda3/envs/gimme/lib/python3.9/site-packages/click/core.py"", line 1668, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File ""/home/spuccio/anaconda3/envs/gimme/lib/python3.9/site-packages/click/core.py"", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File ""/home/spuccio/anaconda3/envs/gimme/lib/python3.9/site-packages/click/core.py"", line 763, in invoke
    return __callback(*args, **kwargs)
  File ""/home/spuccio/anaconda3/envs/gimme/lib/python3.9/site-packages/genomepy/cli.py"", line 262, in install
    genomepy.install_genome(
  File ""/home/spuccio/anaconda3/envs/gimme/lib/python3.9/site-packages/genomepy/functions.py"", line 254, in install_genome
    provider.download_annotation(name, genomes_dir, localname=localname, **kwargs)
  File ""/home/spuccio/anaconda3/envs/gimme/lib/python3.9/site-packages/genomepy/providers/base.py"", line 293, in download_annotation
    raise GenomeDownloadError(
genomepy.exceptions.GenomeDownloadError: An error occured while installing the gene annotation for GRCm38.p5 from NCBI.
If you think the annotation should be there, please file a bug report at: https://github.com/vanheeringen-lab/genomepy/issues

Error: 127
",sinnamone,https://github.com/vanheeringen-lab/gimmemotifs/issues/208
I_kwDOAApTRs48599e,PWMs do not sum to 1,CLOSED,2021-10-09T23:06:43Z,2021-12-22T14:02:01Z,2021-12-22T14:02:01Z,"**Describe the bug**
The rows of each PWM should sum to 1. This is not always the case.

**To Reproduce**
```python
import gimmemotifs
import numpy as np

config = gimmemotifs.config.MotifConfig()
libraries = config.list_installed_libraries()
for library in libraries:
    motifs = gimmemotifs.motif.read_motifs(library)
    for m in motifs:
        normed = all(np.asarray(m.pwm).sum(axis=1) == 1.)
        if not normed:
            print(f""Motif {m} has a PWM that is not normalized"")
```

**Expected behavior**
Rows should all sum to 1.

**Installation information (please complete the following information):**
 - OS: OS X
 - Installation `python setup.py install`
 - Version latest `develop` branch
",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/209
I_kwDOAApTRs485-Fn,Store PWM as numpy array,OPEN,2021-10-09T23:10:02Z,2021-10-11T06:23:56Z,,"**Is your feature request related to a problem? Please describe.**
I'm guessing most people would rather work with a PWM as a numpy array. Numpy is already a dependency for gimmemotifs, so it wouldn't be a burden to use it. I use the motifs in gimmemotifs to do lots of sequence sampling, so in practice I convert the PWMs to numpy arrays. This is annoying, however, because I need to keep a separate numpy array copy.

**Describe the solution you'd like**
Provide a numpy array version of the PWM.
",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/210
I_kwDOAApTRs49LNJX,Gimme Maelstrom - strange Value Error,CLOSED,2021-10-14T12:38:31Z,2023-01-19T08:39:07Z,2023-01-19T08:39:07Z,"Hi Simon!
I'm Francesco. I'm really enthusiastic about using your gimme motif suite to perform differential motif enrichment analysis. When I try with Maelstrom, however, I always received this error message that is very complex for me to solve.

Traceback (most recent call last):
  File ""<string>"", line 1, in <module>
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/lib/python3.9/multiprocessing/spawn.py"", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/lib/python3.9/multiprocessing/spawn.py"", line 125, in _main
    prepare(preparation_data)
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/lib/python3.9/multiprocessing/spawn.py"", line 236, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/lib/python3.9/multiprocessing/spawn.py"", line 287, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/lib/python3.9/runpy.py"", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/lib/python3.9/runpy.py"", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/lib/python3.9/runpy.py"", line 87, in _run_code
    exec(code, run_globals)
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/bin/gimme"", line 8, in <module>
    from gimmemotifs.cli import cli
  File ""/Users/ieo5634/opt/anaconda3/envs/gimmeMotif/lib/python3.9/site-packages/gimmemotifs/__init__.py"", line 61, in <module>
    from . import denovo

.....  and at the bottom of the message this:

ValueError: invalid literal for int() with base 10: ''

As you suggested, I already tried to delete the gimme motif configuration file ~/.config/gimmemotifs/gimmemotifs.cfg and run it without any parameters, then run again my analysis but the problem remains.

I run the program on my Mac OS bigSur 11.5.2, these are my python and other packages versions:

_py-xgboost-mutex         2.0                       cpu_0    conda-forge
abseil-cpp                20210324.1           he49afe7_0    conda-forge
appdirs                   1.4.4              pyh9f0ad1d_0    conda-forge
arrow-cpp                 4.0.1           py39hc705ef8_0_cpu    conda-forge
aws-c-cal                 0.5.9                h0df4f8a_0    conda-forge
aws-c-common              0.5.11               h0d85af4_0    conda-forge
aws-c-event-stream        0.2.7                h5ecfe7a_7    conda-forge
aws-c-io                  0.9.14               h9daffe9_1    conda-forge
aws-checksums             0.1.11               h9daffe9_6    conda-forge
aws-sdk-cpp               1.8.186              h8d473ab_2    conda-forge
bedtools                  2.30.0               haa7f73a_1    bioconda
biofluff                  3.0.4                      py_0    bioconda
biopython                 1.78             py39h89e85a6_2    conda-forge
boltons                   21.0.0             pyhd8ed1ab_0    conda-forge
brotli                    1.0.9                h046ec9c_4    conda-forge
brotlipy                  0.7.0           py39hcbf5805_1001    conda-forge
bucketcache               0.12.1           py39hde42818_2    conda-forge
bzip2                     1.0.8                h0d85af4_4    conda-forge
c-ares                    1.17.1               h0d85af4_1    conda-forge
ca-certificates           2021.5.30            h033912b_0    conda-forge
certifi                   2021.5.30        py39h6e9494a_0    conda-forge
cffi                      1.14.5           py39h319c39b_0    conda-forge
chardet                   4.0.0            py39h6e9494a_1    conda-forge
click                     8.0.1            py39h6e9494a_0    conda-forge
colorama                  0.4.4              pyh9f0ad1d_0    conda-forge
configparser              5.0.2              pyhd8ed1ab_0    conda-forge
cryptography              3.4.7            py39ha2c9959_0    conda-forge
cycler                    0.10.0                     py_2    conda-forge
decorator                 5.0.9              pyhd8ed1ab_0    conda-forge
diskcache                 5.2.1              pyh44b312d_0    conda-forge
expat                     2.2.10               h1c7c35f_0    conda-forge
feather-format            0.4.1              pyh9f0ad1d_0    conda-forge
freetype                  2.10.4               h4cff582_1    conda-forge
future                    0.18.2           py39h6e9494a_3    conda-forge
gadem                     1.3.1                hb4d813b_3    bioconda
genomepy                  0.9.3                      py_0    bioconda
gflags                    2.2.2             hb1e8313_1004    conda-forge
ghostscript               9.54.0               he49afe7_1    conda-forge
gimmemotifs               0.16.0           py39he2a1a62_2    bioconda
glog                      0.5.0                h25b26a9_0    conda-forge
grpc-cpp                  1.38.0               h25f885f_0    conda-forge
homer                     4.10            pl526h770b8ee_0    bioconda
htseq                     0.13.5           py39hdd6a155_1    bioconda
htslib                    1.12                 hc38c3fb_1    bioconda
icu                       68.1                 h74dc148_0    conda-forge
idna                      2.10               pyh9f0ad1d_0    conda-forge
jbig                      2.1               h0d85af4_2003    conda-forge
jinja2                    3.0.1              pyhd8ed1ab_0    conda-forge
joblib                    1.0.1              pyhd8ed1ab_0    conda-forge
jpeg                      9d                   hbcb3906_0    conda-forge
kiwisolver                1.3.1            py39hedf5dff_1    conda-forge
krb5                      1.19.1               hcfbf3a7_0    conda-forge
lcms2                     2.12                 h577c468_0    conda-forge
lerc                      2.2.1                h046ec9c_0    conda-forge
libblas                   3.9.0                9_openblas    conda-forge
libcblas                  3.9.0                9_openblas    conda-forge
libcurl                   7.77.0               hf45b732_0    conda-forge
libcxx                    11.1.0               habf9029_0    conda-forge
libdeflate                1.7                  h35c211d_5    conda-forge
libedit                   3.1.20191231         h0678c8f_2    conda-forge
libev                     4.33                 haf1e3a3_1    conda-forge
libevent                  2.1.10               hddc9c9b_3    conda-forge
libffi                    3.3                  h046ec9c_2    conda-forge
libgcc                    4.8.5                         1    conda-forge
libgfortran               5.0.0           9_3_0_h6c81a4c_22    conda-forge
libgfortran5              9.3.0               h6c81a4c_22    conda-forge
libiconv                  1.16                 haf1e3a3_0    conda-forge
liblapack                 3.9.0                9_openblas    conda-forge
libllvm10                 10.0.1               h009f743_3    conda-forge
libnghttp2                1.43.0               h07e645a_0    conda-forge
libopenblas               0.3.15          openmp_h5e1b9a4_1    conda-forge
libpng                    1.6.37               h7cec526_2    conda-forge
libprotobuf               3.16.0               hcf210ce_0    conda-forge
libssh2                   1.9.0                h52ee1ee_6    conda-forge
libthrift                 0.14.1               hab56fdc_1    conda-forge
libtiff                   4.3.0                h1167814_1    conda-forge
libutf8proc               2.6.1                h35c211d_0    conda-forge
libuuid                   2.32.1            h35c211d_1000    conda-forge
libwebp-base              1.2.0                h0d85af4_2    conda-forge
libxgboost                1.4.0                he49afe7_0    conda-forge
libxml2                   2.9.12               h93ec3fd_0    conda-forge
libxslt                   1.1.33               h5739fc3_2    conda-forge
llvm-openmp               11.1.0               hda6cdc1_1    conda-forge
llvmlite                  0.36.0           py39h798a4f4_0    conda-forge
logbook                   1.5.3            py39hcbf5805_4    conda-forge
logomaker                 0.8                pyh864c0ab_1    bioconda
loguru                    0.5.3            py39h6e9494a_2    conda-forge
lz4-c                     1.9.3                h046ec9c_0    conda-forge
markupsafe                2.0.1            py39h89e85a6_0    conda-forge
matplotlib                3.4.2            py39h6e9494a_0    conda-forge
matplotlib-base           3.4.2            py39hb07454d_0    conda-forge
meme                      5.3.0           py39pl5262hd110924_2    bioconda
mpi                       1.0                     openmpi    conda-forge
mysql-connector-c         6.1.11            h0f02589_1007    conda-forge
ncurses                   6.2                  h2e338ed_4    conda-forge
norns                     0.1.5              pyh864c0ab_1    bioconda
nose                      1.3.7                   py_1006    conda-forge
numba                     0.53.1           py39he2616bd_0    conda-forge
numpy                     1.20.3           py39h7eed0ac_1    conda-forge
olefile                   0.46               pyh9f0ad1d_1    conda-forge
openjdk                   11.0.9.1             hcf210ce_1    conda-forge
openjpeg                  2.4.0                h6e7aa92_1    conda-forge
openmpi                   4.1.1                hd3cd54c_0    conda-forge
openssl                   1.1.1k               h0d85af4_0    conda-forge
orc                       1.6.8                hfe4c36d_0    conda-forge
palettable                3.3.0                      py_0    conda-forge
pandas                    1.2.4            py39h4d6be9b_0    conda-forge
parquet-cpp               1.5.1                         2    conda-forge
pathlib                   1.0.1            py39h6e9494a_4    conda-forge
patsy                     0.5.1                      py_0    conda-forge
perl                      5.26.2            hbcb3906_1008    conda-forge
perl-algorithm-cluster    1.58            pl526h1de35cc_0    bioconda
perl-carp                 1.38                    pl526_3    bioconda
perl-cgi                  4.40            pl526h470a237_0    bioconda
perl-common-sense         3.74                    pl526_2    bioconda
perl-constant             1.33                    pl526_1    bioconda
perl-dbi                  1.642                   pl526_0    bioconda
perl-exporter             5.72                    pl526_1    bioconda
perl-extutils-makemaker   7.36                    pl526_1    bioconda
perl-file-path            2.16                    pl526_0    bioconda
perl-file-which           1.23                    pl526_0    bioconda
perl-html-parser          3.72            pl526h04f5b5a_5    bioconda
perl-html-tagset          3.20                    pl526_3    bioconda
perl-html-template        2.97                    pl526_1    bioconda
perl-html-tree            5.07                    pl526_1    bioconda
perl-json                 4.02                    pl526_0    bioconda
perl-json-xs              2.34            pl526h04f5b5a_3    bioconda
perl-log-log4perl         1.49                    pl526_0    bioconda
perl-math-cdf             0.1             pl526h1de35cc_5    bioconda
perl-scalar-list-utils    1.52            pl526h01d97ff_0    bioconda
perl-types-serialiser     1.0                     pl526_2    bioconda
perl-xml-namespacesupport 1.12                    pl526_0    bioconda
perl-xml-parser           2.44_01         pl526hb1d6bea_1002    conda-forge
perl-xml-sax              0.99                    pl526_1    bioconda
perl-xml-sax-base         1.09                    pl526_0    bioconda
perl-xml-sax-expat        0.51                    pl526_3    bioconda
perl-xml-simple           2.25                    pl526_1    bioconda
perl-xsloader             0.24                    pl526_0    bioconda
perl-yaml                 1.29                    pl526_0    bioconda
pillow                    8.2.0            py39h5fdd921_1    conda-forge
pip                       21.1.2             pyhd8ed1ab_0    conda-forge
prosampler                1.0                  h770b8ee_0    bioconda
py-xgboost                1.4.0            py39h6e9494a_0    conda-forge
pyarrow                   4.0.1           py39hc3b5b9c_0_cpu    conda-forge
pybedtools                0.8.2            py39h33336d3_1    bioconda
pybigwig                  0.3.18           py39h8b2de0f_1    bioconda
pycparser                 2.20               pyh9f0ad1d_2    conda-forge
pyfaidx                   0.5.9.5            pyh3252c3a_0    bioconda
pyopenssl                 20.0.1             pyhd8ed1ab_0    conda-forge
pyparsing                 2.4.7              pyh9f0ad1d_0    conda-forge
pysam                     0.16.0.1         py39h56703ae_3    bioconda
pysocks                   1.7.1            py39h6e9494a_3    conda-forge
python                    3.9.4           h9133fd0_0_cpython    conda-forge
python-dateutil           2.8.1                      py_0    conda-forge
python-xxhash             2.0.2            py39h89e85a6_0    conda-forge
python_abi                3.9                      1_cp39    conda-forge
pytz                      2021.1             pyhd8ed1ab_0    conda-forge
pyyaml                    5.4.1            py39hcbf5805_0    conda-forge
qnorm                     0.7.0              pyh44b312d_0    conda-forge
re2                       2021.04.01           he49afe7_0    conda-forge
readline                  8.1                  h05e3726_0    conda-forge
represent                 1.6.0            py39hb5aae12_2    conda-forge
requests                  2.25.1             pyhd3deb0d_0    conda-forge
scikit-learn              0.24.2           py39h4b1dcc9_0    conda-forge
scipy                     1.6.3            py39h056f1c0_0    conda-forge
seaborn                   0.11.1               hd8ed1ab_1    conda-forge
seaborn-base              0.11.1             pyhd8ed1ab_1    conda-forge
setuptools                49.6.0           py39h6e9494a_3    conda-forge
six                       1.16.0             pyh6c4a22f_0    conda-forge
snappy                    1.1.8                hb1e8313_3    conda-forge
sqlite                    3.35.5               h44b9ce1_0    conda-forge
statsmodels               0.12.2           py39h329c335_0    conda-forge
threadpoolctl             2.1.0              pyh5ca1d4c_0    conda-forge
tk                        8.6.10               h0419947_1    conda-forge
tornado                   6.1              py39hcbf5805_1    conda-forge
tqdm                      4.61.0             pyhd8ed1ab_0    conda-forge
trawler                   2.0                  hdfd78af_4    bioconda
tzdata                    2021a                he74cb21_0    conda-forge
ucsc-bedtogenepred        377                  h516baf0_1    bioconda
ucsc-bigbedtobed          377                  h516baf0_1    bioconda
ucsc-genepredtobed        377                  h516baf0_3    bioconda
ucsc-genepredtogtf        377                  h516baf0_3    bioconda
ucsc-gff3togenepred       377                  h516baf0_1    bioconda
ucsc-gtftogenepred        377                  h516baf0_3    bioconda
urllib3                   1.26.5             pyhd8ed1ab_0    conda-forge
weeder                    2.0                  hb280591_5    bioconda
wheel                     0.36.2             pyhd3deb0d_0    conda-forge
xdg                       5.0.2              pyhd8ed1ab_0    conda-forge
xgboost                   1.4.0            py39h6e9494a_0    conda-forge
xmltodict                 0.12.0                     py_0    conda-forge
xxhash                    0.8.0                h35c211d_3    conda-forge
xxmotif                   1.6                           0    bioconda
xz                        5.2.5                haf1e3a3_1    conda-forge
yaml                      0.2.5                haf1e3a3_0    conda-forge
zlib                      1.2.11            h7795811_1010    conda-forge
zstd                      1.5.0                h582d3a0_0    conda-forge

And finally, my input TXT file is this tab delimited file like this;

loc     Trametinib_12h  Trametinib_24h  Trametinib_3h   Untreated
chr14:51533916-51534416 -0.73038978554192       -0.75756174613418       0.0292045064051196      1.45874702527098
chr17:40519037-40519537 -0.414261532842008      -0.791426003462628      -0.137144588165848      1.34283212447048
chr7:142808500-142809000        -0.856711011099945      -2.48554062398944       1.15561859563714        2.18663303945224
chr12:25458510-25459010 -1.11450907682427       -2.09368630465281       0.716401716886725       2.49179366459037
chr3:186098124-186098624        -0.813729589200967      -1.83892747430712       -1.08594276476826       3.73859982827634
chr20:62739893-62740393 -0.430940180607117      -0.893090704706988      -0.406246362173098      1.7302772474872
chr4:87896621-87897121  -0.577905813389179      0.05970737077861        -2.31475686197784       2.83295530458841
chr22:24207010-24207510 -0.603639756229142      -0.279537387442472      -0.948471767354042      1.83164891102566
chr11:122643118-122643618       -0.524114013826575      -0.749542504928305      -0.160310105579936      1.43396662433481
chr10:99965421-99965921 -1.06461687455462       -0.423861486523813      -0.450305165527713      1.93878352660615
chr11:70016462-70016962 -0.659396598158438      -1.30147785188861       -0.126278345089177      2.08715279513622
chr22:43264253-43264753 -0.858073997387409      -1.07580442926487       0.53618053094244        1.39769789570984
chr14:74616749-74617249 -0.540435607173403      -0.439786003323952      -0.210392283547632      1.19061389404499
chr9:19998659-19999159  -0.992356201003537      -1.68042041234842       0.598847799536313       2.07392881381564

With peak coordinates in the first column and normalised/mean centred values in the others for each group.
I would really appreciate any help as I already tried in different ways but couldn't fix the problem
Many thanks!
Francesco",Francis3209,https://github.com/vanheeringen-lab/gimmemotifs/issues/211
I_kwDOAApTRs49WFdG,gimme scan negative region lenght ,CLOSED,2021-10-18T14:31:47Z,2023-01-19T09:03:34Z,2023-01-19T09:03:34Z,"When providing gimme scan with a bedfile with:
chrom:end-start

instead of 
chrom:start-end

gimme scan doesn't crash but instead calculates the same score for each region.
Crashing or an error would prevent people like me that make such silly mistakes a bit of a headache trying to find what is going on.  :) ",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/212
I_kwDOAApTRs4-K3tR,Easily scan a sequence,OPEN,2021-11-03T03:12:13Z,2021-11-03T08:49:14Z,,"**Is your feature request related to a problem? Please describe.**

Sometimes in a pipeline I have a simple Python string containing a nucleotide sequence and I'd like to scan it for motifs. It's not clear from the docs how to do that easily. Currently I do the following:

```python
scanner = Scanner()
# ...
results = scanner.scan(Fasta(fdict={""seq"": sequence}), nreport=20)
```

after which I need to zip the `results` with the motif library that I used to initialize the `Scanner` object and manually construct a dataframe. For example:

```python
def scan_seq_for_motifs(name, sequence):
    hits = []
    for motif, raw_hits in zip(
        motif_library, next(scanner.scan(Fasta(fdict={name: sequence}), nreport=20))
    ):
        for raw_hit in raw_hits:
            hits.append(
                {
                    ""motif_id"": motif.id,
                    ""motif_len"": len(motif),
                    ""motif_factors"": motif.format_factors(),
                    ""motif_consensus"": motif.consensus,
                    ""match_score"": raw_hit[0],
                    ""match_start"": raw_hit[1],
                    ""match_end"": raw_hit[1] + len(motif),
                    ""match_strand"": raw_hit[2],
                }
            )
    return pd.DataFrame(hits)
```

Is there some easy API call I'm not aware of?

**Describe the solution you'd like**

Make is easy to take a sequence and scan it.
",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/216
I_kwDOAApTRs4-U5Ps,"Motif trimming does not update Motif.logodds, leading to incorrect motif scores",OPEN,2021-11-05T10:20:00Z,2022-08-03T08:22:12Z,,"Hi all!

I wasn't entirely sure what to name this issue, as I think it's a confluence of two issues.

Briefly put: `Scanner.best_match` and other scanning methods rely on the helper-matrix `Motif.logodds`. This matrix is not updated when motif.trim() is called, which means that trimming the motif has no impact on the scoring.

Secondary to this, `Motif.pwm_max_score()` and `min_score` compute the scores based on the pwm rather than logodds, leading to inconsistencies between scores found with e.g. Scanner.best_match and the computed max and min scores (for e.g. trimming thresholds other than 0.25). This in turn has downstream effects on the computation of z-scores, thresholds and the like.

The core issue seems to be:
- Motif.logodds is not always updated when motif.pwm is written to
- max_score and min_score are computed based on the pwm, rather than motif.Logodds

A proposed solution would be to place pwm updates behind a setter which also updates Motif.logodds. The max and min methods can then be replaced by e.g. `sum(max(row) for row in self.logodds`. This has the added advantage of storing all the log-odds computation in one place and reducing code replication.

I'd be happy to submit a merge request for this, if you'd like?",oalmelid,https://github.com/vanheeringen-lab/gimmemotifs/issues/218
I_kwDOAApTRs4-lB3P,Mac M1 support,OPEN,2021-11-10T14:24:06Z,2021-12-17T10:15:15Z,,"**Is your feature request related to a problem? Please describe.**
It would be great if GimmeMotifs was easy to install on a Mac M1 (arm64).

**Describe the solution you'd like**
Bioconda doesn't support macOs arm64, and probably won't for a while, so having pip binary wheels might be an option here. [cibuildwheel](https://cibuildwheel.readthedocs.io/en/stable/) makes building these on various architectures quite straightforward - including macOs arm64. However, the problem is that GimmeMotifs uses a variety of (precompiled) C executables (like meme, homer, ucsc-genepredtobed, gadem, etc) that are packaged for bioconda, but would need building for pip. I'm not sure how feasible or easy that is (or indeed) what the precise list of required dependencies is here.

**Describe alternatives you've considered**
Using Rosetta is a workaround, but that can be fragile (dual conda installs), and isn't a good long-term solution.

**Additional context**
An example cibuildwheel run: https://github.com/tomwhite/gimmemotifs/actions/runs/1443766343. Note that this does *not* solve the problems described above!
",tomwhite,https://github.com/vanheeringen-lab/gimmemotifs/issues/220
I_kwDOAApTRs4-qEek,motif2factor converts colons to underscores in gene names,OPEN,2021-11-11T17:42:01Z,2021-11-11T17:42:01Z,,"GRCz11 from Ensembl. 
- The GTF contains several genes with a colon in the name (for example: `['im:7142702', 'zgc:162472', 'si:ch211-160f23.5']`)
- The motif2factors converts the colons to underscores (for example: `[ 'im_7142702', 'zgc_162472', 'si_ch211-160f23.5']`)

gffread's pep.fa output seems to still contains the colon. After that I have no idea!

Here is the full list of mismatched genes for GRCz11.
```
['si_ch211-195d17.2', 'si_ch211-130h14.4', 'si_dkey-222b8.1', 'si_ch211-265g22.4', 'si_ch211-204c21.1', 'wu_fc17b08', 'si_ch211-263k4.2', 'si_ch211-153j24.3', 'zgc_171929', 'si_ch1073-412h12.3', 'si_ch211-160f23.5', 'im_7142702', 'zgc_162472', 'zgc_162612', 'si_ch73-130a3.4', 'zgc_158291', 'si_ch73-386h18.1', 'zgc_91944']
```",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/221
I_kwDOAApTRs4_PkUg,Update IC-related functions in Motif class,OPEN,2021-11-23T10:03:45Z,2021-11-23T10:06:23Z,,"Add information on formula's for motif IC, decide what needs to be private and public.

Originally posted by @Maarten-vd-Sande in https://github.com/vanheeringen-lab/gimmemotifs/pull/223#discussion_r754021487_",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/224
I_kwDOAApTRs4_Pk0B,Make it possible to directly hand over a numpy array to C scanning functions,OPEN,2021-11-23T10:05:31Z,2021-11-23T10:05:31Z,,"Not sure if you're willing to dig into the C source. But since the logodds are now anyway numpy arrays, it seems like a waste to convert it to a list, and then in the C code convert the list into C arrays. No clue, but **perhaps** a numpy array can be read directly by the C code?

_Originally posted by @Maarten-vd-Sande in https://github.com/vanheeringen-lab/gimmemotifs/pull/223#discussion_r754100484_",simonvh,https://github.com/vanheeringen-lab/gimmemotifs/issues/225
I_kwDOAApTRs4_n4Gl,Non-redundant motif selection fails on some files,CLOSED,2021-11-30T16:12:37Z,2021-12-01T09:56:55Z,2021-12-01T09:56:55Z,"**Describe the bug**
Some of my bed files produce an error when selecting non-redundant motifs for the HTML file. Weirdly this error is related to two similar sets (size, but not motif wise!) of BED files which both fail while one set doesn't. Interestingly previously with version 15.3 it was the total opposite, hence the update to 16.1. 

**To Reproduce**
At the moment I cannot provide you with the motif files or bed files, the motifs are PWMs gathered from the CISBP database and have worked previously! Below is the command with variables. 


> 
>     OUTTMP=$(echo $peaks | sed 's/.bed//') 
>     OUT=""${outfolder}${OUTTMP}""
>     echo $OUT
>     mkdir -p $OUT
>     gimme motifs ""${peaks}"" ""${OUT}"" -g ""${genome}"" -p ""${motifFile}"" -N 40 --known
> 

**Error logs**
2021-11-30 15:58:44,229 - INFO - selecting non-redundant motifs
Traceback (most recent call last):
  File ""/home/users/juhomon/miniconda3/envs/gimmemamba/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/users/juhomon/miniconda3/envs/gimmemamba/lib/python3.9/site-packages/gimmemotifs/cli.py"", line 730, in cli
    args.func(args)
  File ""/home/users/juhomon/miniconda3/envs/gimmemamba/lib/python3.9/site-packages/gimmemotifs/commands/motifs.py"", line 246, in motifs
    nr_motifs = select_nonredundant_motifs(
  File ""/home/users/juhomon/miniconda3/envs/gimmemamba/lib/python3.9/site-packages/gimmemotifs/comparison.py"", line 976, in select_nonredundant_motifs
    rfe = RFE(model, i)
TypeError: __init__() takes 2 positional arguments but 3 were given

**Installation information (please complete the following information):**
 - OS: CentOS7
 - Installation: mamba -create -n gimmemamba gimmemotifs
 -  Version: v0.16.1

**Additional**
Run with SLURM ",juhomon,https://github.com/vanheeringen-lab/gimmemotifs/issues/226
I_kwDOAApTRs4_-WY6,develop branch: different results in scan_regionfile_to_table,CLOSED,2021-12-07T12:43:20Z,2021-12-17T15:54:44Z,2021-12-17T15:54:44Z,"**Describe the bug**
The output of `scan_regionfile_to_table()` has changed on the develop branch between commits 2586d96 (nov 11) and b7e153c (dec 1).

![image](https://user-images.githubusercontent.com/48289046/145029625-4910358e-178a-4445-a1ce-05ac579ab9e8.png)

**To Reproduce**
m2f:
```
Motif	Factor	Evidence	Curated
GM.5.0.Sox.0001	SOX12	ChIP-seq	Y
```

pfm:
```
>GM.5.0.Sox.0001
0.7213	0.0793	0.1103	0.0891
0.9259	0.0072	0.0062	0.0607
0.0048	0.9203	0.0077	0.0672
0.9859	0.0030	0.0030	0.0081
0.9778	0.0043	0.0128	0.0051
0.1484	0.0050	0.0168	0.8299
```

fasta:
```
>chr1
AAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGTAAAAACTGAAAAATGCCCCCCCCAAANNNAAAGGGGGGGTTTTTTTTAAAAAAACCCCCCCCGGGTCAGCTTTTTTGCAGGGGGGGGGCAGT
```

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: `git clone` + `pip install -e . `
 - Version: develop branch v0.16.1+79.gb7e153c

**Additional context**
No idea if this change is good or bad.",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/229
I_kwDOAApTRs4_-XWK,develop branch: deprecation warnings are going to stdout,CLOSED,2021-12-07T12:47:32Z,2021-12-20T11:02:55Z,2021-12-20T11:02:54Z,"**Describe the bug**
On the develop branch (commit b7e153c, from dec 1), `motif.to_pwm()` returns a deprecation warning that is caught by `""{}\n"".format(m.to_pwm())`. So I gues its going to stdout instead of stderr.

**Expected behavior**
Deprecation warnings to stderr. Using `logger.warning()` with the warnings should fix this.

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: `git clone` + `pip install -e . `
 - Version: develop branch v0.16.1+79.gb7e153c
",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/230
I_kwDOAApTRs4_-YGc,develop branch: _io.TextIOWrapper spam,CLOSED,2021-12-07T12:50:52Z,2021-12-20T07:49:19Z,2021-12-20T07:49:19Z,"**Describe the bug**
On the develop branch (commit b7e153c, from dec 1), stdout is constantly receiving `<_io.TextIOWrapper name=`file` mode='r' encoding='UTF-8'>`. This is new behaviour since commits 2586d96, from nov 11.

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: `git clone` + `pip install -e . `
 - Version: develop branch v0.16.1+79.gb7e153c
",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/231
I_kwDOAApTRs5AFcE7,Gimme scan question,OPEN,2021-12-09T05:34:19Z,2021-12-09T08:58:12Z,,"Dear all,
I am trying to get ctcf motif orientation within some peaks. My question is, suppose the ctcf motif exists multiple times within the same peak, which occurrence of these multiple occurrences is reported? And why? And what does the number in the fourth column (the column before the orientation column) represent?

Thank you very much for the wonderful tool",ahmedabbas81,https://github.com/vanheeringen-lab/gimmemotifs/issues/232
I_kwDOAApTRs5AiMSb,When will y'all cut a new release?,CLOSED,2021-12-16T22:43:13Z,2023-01-18T11:30:04Z,2023-01-18T11:30:04Z,There's lots of stuff in `develop` which isn't accessible,laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/234
I_kwDOAApTRs5AiSzm,MotifSampler doesn't run on MacOS (installation issues),CLOSED,2021-12-16T23:32:52Z,2021-12-22T14:02:01Z,2021-12-22T14:02:01Z,"**Describe the bug**
When running `python setup.py install` on my Mac, I get the following output:

```
base ❯ python setup.py install
running install
running bdist_egg
running egg_info
writing gimmemotifs.egg-info/PKG-INFO
writing dependency_links to gimmemotifs.egg-info/dependency_links.txt
writing requirements to gimmemotifs.egg-info/requires.txt
writing top-level names to gimmemotifs.egg-info/top_level.txt
reading manifest file 'gimmemotifs.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
warning: no files found matching 'run_tests.py'
adding license file 'COPYING'
writing manifest file 'gimmemotifs.egg-info/SOURCES.txt'
installing library code to build/bdist.macosx-10.9-x86_64/egg
running install_lib
running build_py
compiling BioProspector... ok
compiling MDmodule... ok
copying build/src/MDmodule/MDmodule -> build/lib.macosx-10.9-x86_64-3.8/gimmemotifs/included_tools
copying build/src/BioProspector/BioProspector -> build/lib.macosx-10.9-x86_64-3.8/gimmemotifs/included_tools
error: [Errno 8] Exec format error: 'src/MotifSampler/MotifSampler_x86_64'
```

**To Reproduce**
`python setup.py install` on a Mac.

**Expected behavior**
Gimmemotifs should install successfully.

**Error logs**
see above.

**Installation information (please complete the following information):**
This is the `develop` branch on an Intel-based Mac.
",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/235
I_kwDOAApTRs5BAzQr,Different Motifs predicted for the same set of sequences,OPEN,2021-12-29T20:15:25Z,2021-12-29T20:16:10Z,,"**Describe the bug**
Gimme motif predicts different motifs for a set of sequences in different runs. 

I have a set of sequences that are stored in a fasta file. I ran Gemme motif to find the presented motifs in the sequences for two times and each time I am getting different motifs. Is this related to the randomness of selected sequences as training set? I have set the parameter -f to 0.7 as I have small number of sequences to include 70% of my sequences for prediction of motifs and only 30% for validation. 

**Expected behavior**
I expected to get at least same number of detected motifs with very similar patterns from 2 separate runs on a single fasta 

Is there anything like setting the seed when running the motif search. In case that the issue comes from randomness of training set. Please let me know if this can be fixed. 
",yasamanrezvani,https://github.com/vanheeringen-lab/gimmemotifs/issues/239
I_kwDOAApTRs5BFNtC,direct and indirect,OPEN,2022-01-01T20:24:17Z,2022-01-01T20:24:17Z,,"I am scanning a bed file for known motifs. I was wondering if there is a way to distinguish direct vs indirect here?
I used the following command: 
gimme scan  p2g_vitro_noheader_v1_dup_removed.tsv -g hg38 -N 40 -b  -n 20 > p2g_vitro_noheader_v1_dup_removed.scan.gff


<img width=""458"" alt=""Screen Shot 2022-01-01 at 12 23 06 PM"" src=""https://user-images.githubusercontent.com/19545198/147859486-7abc852d-4ea8-4215-a173-a442083839d4.png"">

",rojinsafavi,https://github.com/vanheeringen-lab/gimmemotifs/issues/240
I_kwDOAApTRs5BFkM-,Why don't all rows have names?,OPEN,2022-01-02T08:57:25Z,2022-01-02T08:57:25Z,,"Why don't all rows have names? The same thing happened with the plot from my own data.

Your example plot:
![image](https://user-images.githubusercontent.com/54537420/147870939-e89a5821-5251-4764-8e43-ec584d3425e4.png)
",tzhu-bio,https://github.com/vanheeringen-lab/gimmemotifs/issues/241
I_kwDOAApTRs5CRssP,"Error in creating statistics report ""_translate() takes 1 positional argument but 3 were given""",CLOSED,2022-01-23T17:35:08Z,2023-01-18T11:29:42Z,2023-01-18T11:29:42Z,"**Describe the bug**
When running gimmemotifs de-novo motif discovery with the example file, TAp73alpha.bed, de-novo motif discovery finished but an error occured in creating statistics report. It says ""TypeError: _translate() takes 1 positional argument but 3 were given"". 

**To Reproduce**
Download the example file,  TAp73alpha.bed, from [https://figshare.com/articles/dataset/GimmeMotifs_example_data/5182897], and download the hg19 reference genome (provider UCSC) using genomepy. Then, run the command 
`gimme motifs TAp73alpha.bed gimme_out/gimme.p73 -g hg19 -a small -t Homer,MDmodule,BioProspector` 

**Expected behavior**
A full report including the statistics report should be outputted. 

**Error logs**
scanning:   0%|          | 0/1000 [00:00<?, ? sequences/s]
scanning:   0%|          | 1/1000 [00:00<07:37,  2.19 sequences/s]
scanning: 100%|██████████| 1000/1000 [00:00<00:00, 2010.79 sequences/s]
2022-01-22 19:51:04,657 - INFO - creating statistics report
/home/miniconda3/x86/envs/gimme3/lib/python3.9/site-packages/pandas/core/arraylike.py:364: RuntimeWarning: divide by zero encountered in log10
  result = getattr(ufunc, method)(*inputs, **kwargs)
/home/miniconda3/x86/envs/gimme3/lib/python3.9/site-packages/pandas/io/formats/style.py:2817: RuntimeWarning: invalid value encountered in double_scalars
  norm = colors.Normalize(smin - (rng * low), smax + (rng * high))
Traceback (most recent call last):
  File ""/home/miniconda3/x86/envs/gimme3/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/miniconda3/x86/envs/gimme3/lib/python3.9/site-packages/gimmemotifs/cli.py"", line 746, in cli
    args.func(args)
  File ""/home/miniconda3/x86/envs/gimme3/lib/python3.9/site-packages/gimmemotifs/commands/motifs.py"", line 278, in motifs
    roc_html_report(
  File ""/home/miniconda3/x86/envs/gimme3/lib/python3.9/site-packages/gimmemotifs/report.py"", line 1018, in roc_html_report
    ExtraStyler(df)
  File ""/home/miniconda3/x86/envs/gimme3/lib/python3.9/site-packages/pandas/io/formats/style.py"", line 272, in render
    return self._render_html(sparse_index, sparse_columns, **kwargs)
  File ""/home/miniconda3/x86/envs/gimme3/lib/python3.9/site-packages/pandas/io/formats/style_render.py"", line 123, in _render_html
    d = self._translate(sparse_index, sparse_columns)
TypeError: _translate() takes 1 positional argument but 3 were given

**Installation information (please complete the following information):**
 - OS: Linux 
 - Installation: mamba installation
 - Version 0.17.0 (py39h8f06ca0_1)
 - Python: 3.9.7
 - Pandas: 1.3.5
",sqhang,https://github.com/vanheeringen-lab/gimmemotifs/issues/242
I_kwDOAApTRs5CX77v,MotifComparer.get_all_scores() error,CLOSED,2022-01-25T08:26:29Z,2022-02-01T09:34:40Z,2022-02-01T09:34:40Z,"**Describe the bug**
Since I updated gimmemotifs to 0.17.0 the `get_all_scores` function of the `MotifComparer` no longer works.

**To Reproduce**
```
from gimmemotifs.motif import Motif
from gimmemotifs.comparison import MotifComparer

m1 = Motif(pfm=[[100, 100, 300, 500],
                [200, 300, 100, 300],
                [500, 300, 400, 200],
                [200, 300, 200,   0]
               ])
m1.id = ""m1""

m2 = Motif(pfm=[[900, 800, 100,   0],
                [  0, 100, 400, 100],
                [100, 100, 500, 200],
                [  0,   0,   0, 700],
                [300, 100, 900, 500]
               ])
m2.id = ""m2""

mc = MotifComparer()
mc.get_all_scores(motifs=[m1], dbmotifs=[m2], match=""total"", metric=""pcc"", combine=""mean"")
```

**Error**
```
ERROR:root:_get_all_scores failed
Traceback (most recent call last):
  File ""/workspace/.conda/tobias-test/lib/python3.9/site-packages/gimmemotifs/comparison.py"", line 164, in _get_all_scores
    scores[m1.id][m2.id] = mc.compare_motifs(
  File ""/workspace/.conda/tobias-test/lib/python3.9/site-packages/gimmemotifs/comparison.py"", line 461, in compare_motifs
    m1.wiggle_pwm(), m2.wiggle_pwm(), metric, combine
AttributeError: 'Motif' object has no attribute 'wiggle_pwm'
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""/workspace/.conda/tobias-test/lib/python3.9/site-packages/gimmemotifs/comparison.py"", line 703, in get_all_scores
    for m1, v in result.items():
AttributeError: 'NoneType' object has no attribute 'items'
```

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation conda & pip (I tried both)
 - Version 0.17.0 (it worked with 0.16.0)",hschult,https://github.com/vanheeringen-lab/gimmemotifs/issues/243
I_kwDOAApTRs5CZHAc,Stochastic failure of parallel jobs when importing functions from gimmemotifs,OPEN,2022-01-25T13:17:50Z,2022-01-25T13:17:50Z,,"**Describe the bug**
I'm running CellOracle in parallel on a computing cluster (using sge), and stochastically some of my jobs are failing with an error `KeyError: 'params'` coming from gimmemotifs (see logs below). There's no clear pattern as to which jobs fail and re-sumitting the jobs usually allows them to run. 

I tried the solution suggested [here](https://github.com/vanheeringen-lab/gimmemotifs/issues/157) and it didn't help. I checked that `~/.config/gimmemotifs/gimmemotifs.cfg` does include a `[params]` section and it does.

**To Reproduce**
Steps to reproduce the behavior:
`from gimmemotifs.scanner import Scanner` in multiple parallel jobs at once.

**Expected behavior**
Parallel jobs should not randomly crash when importing

**Error logs**
```
Traceback (most recent call last):
  File ""scripts/celloracle_filter_links.py"", line 2, in <module>
    import celloracle as co
  File ""/home/research/vaquerizas/liz/spermatogenesis_multiome/celloracle/software/CellOracle/celloracle/__init__.py"", line 8, in <module>
    from . import utility, network, network_analysis, go_analysis, data, data_conversion, oracle_utility
  File ""/home/research/vaquerizas/liz/spermatogenesis_multiome/celloracle/software/CellOracle/celloracle/utility/__init__.py"", line 18, in <module>
    from .load_hdf5 import load_hdf5
  File ""/home/research/vaquerizas/liz/spermatogenesis_multiome/celloracle/software/CellOracle/celloracle/utility/load_hdf5.py"", line 8, in <module>
    from ..motif_analysis.tfinfo_core import load_TFinfo
  File ""/home/research/vaquerizas/liz/spermatogenesis_multiome/celloracle/software/CellOracle/celloracle/motif_analysis/__init__.py"", line 11, in <module>
    from .motif_analysis_utility import is_genome_installed
  File ""/home/research/vaquerizas/liz/spermatogenesis_multiome/celloracle/software/CellOracle/celloracle/motif_analysis/motif_analysis_utility.py"", line 24, in <module>
    from gimmemotifs.scanner import Scanner
  File ""/home/research/vaquerizas/liz/spermatogenesis_multiome/celloracle/.celloracle_venv/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 55, in <module>
    config = MotifConfig()
  File ""/home/research/vaquerizas/liz/spermatogenesis_multiome/celloracle/.celloracle_venv/lib/python3.8/site-packages/gimmemotifs/config.py"", line 95, in __init__
    self._upgrade_config()
  File ""/home/research/vaquerizas/liz/spermatogenesis_multiome/celloracle/.celloracle_venv/lib/python3.8/site-packages/gimmemotifs/config.py"", line 98, in _upgrade_config
    if ""width"" in self.config[""params""]:
  File ""/home/linuxbrew/.linuxbrew/opt/python/lib/python3.8/configparser.py"", line 960, in __getitem__
    raise KeyError(key)
KeyError: 'params'
```

**Installation information (please complete the following information):**
 - OS: Linux, CentOS 7
 - Installation: pip in a virtual environment
 - Version: 0.14.4

**Additional context**
I also ran into [this issue](https://github.com/vanheeringen-lab/gimmemotifs/issues/106) with the cache. The solution there fixed it. The jobs where I get the `KeyError: 'params'` are a later step that does not actually use gimmemotifs so I haven't set a job-specific cache directory for these. 
",liz-is,https://github.com/vanheeringen-lab/gimmemotifs/issues/245
I_kwDOAApTRs5CseoT,IndexError: list index out of range in tutorial dataset,OPEN,2022-01-31T04:22:37Z,2022-01-31T04:22:37Z,,"**Describe the bug**
Hi All, I am running the tutorial on finding differential motifs from hg19.blood.most_variable.1k.txt data. The genome file was downloaded using genomepy and I have deleted the unknown chromosomes. Additionally, I also sort the reference fasta by chromosome name since someone has the same error as me. However, it gave me the error information like 👍 

gimme maelstrom hg19.blood.most_variable.1k.txt hg19 maelstrom.blood.1k.out
2022-01-30 20:13:12,321 - INFO - Starting maelstrom
2022-01-30 20:13:12,330 - INFO - Motif scanning (counts)
2022-01-30 20:13:12,330 - INFO - reading table
2022-01-30 20:13:12,461 - INFO - setting threshold
Determining threshold for fpr 0.01 and length 200 based on hg19
Traceback (most recent call last):
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/bin/gimme"", line 496, in <module>
    args.func(args)
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/commands/maelstrom.py"", line 29, in maelstrom
    run_maelstrom(infile, genome, outdir, pwmfile, methods=methods)
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/maelstrom.py"", line 193, in run_maelstrom
    pwmfile=pwmfile)
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/maelstrom.py"", line 59, in scan_to_table
    s.set_threshold(fpr=FPR, genome=genome)
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/scanner.py"", line 407, in set_threshold
    fa = RandomGenomicFasta(index, length, 10000)
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 347, in __init__
    create_random_genomic_bedfile(tmpbed, index, length, n)
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/background.py"", line 35, in create_random_genomic_bedfile
    features = get_random_sequences(index_dir, n, length)
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 672, in get_random_sequences
    chroms = _weighted_selection(l, n)
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 660, in _weighted_selection
    return [items[bisect.bisect(cuml, random.random()*total_weight)] for _ in range(n)]
  File ""/Users/yandingzhao/opt/anaconda3/envs/gimme/lib/python3.6/site-packages/gimmemotifs/genome_index.py"", line 660, in <listcomp>
    return [items[bisect.bisect(cuml, random.random()*total_weight)] for _ in range(n)]
IndexError: list index out of range

**To Reproduce**
I tried hg19.blood.most_variable.1k.txt data but still have the same error.

**Installation information (please complete the following information):**
 I have put the conda info from my end here:
 active environment : gimme
    active env location : /Users/yandingzhao/opt/anaconda3/envs/gimme
            shell level : 2
       user config file : /Users/yandingzhao/.condarc
 populated config files : /Users/yandingzhao/.condarc
          conda version : 4.10.3
    conda-build version : 3.21.5
         python version : 3.9.7.final.0
       virtual packages : __osx=10.16=0
                          __unix=0=0
                          __archspec=1=x86_64
       base environment : /Users/yandingzhao/opt/anaconda3  (writable)
      conda av data dir : /Users/yandingzhao/opt/anaconda3/etc/conda
  conda av metadata url : None
           channel URLs : https://conda.anaconda.org/bioconda/osx-64
                          https://conda.anaconda.org/bioconda/noarch
                          https://conda.anaconda.org/conda-forge/osx-64
                          https://conda.anaconda.org/conda-forge/noarch
                          https://repo.anaconda.com/pkgs/main/osx-64
                          https://repo.anaconda.com/pkgs/main/noarch
                          https://repo.anaconda.com/pkgs/r/osx-64
                          https://repo.anaconda.com/pkgs/r/noarch
                          https://conda.anaconda.org/r/osx-64
                          https://conda.anaconda.org/r/noarch
          package cache : /Users/yandingzhao/opt/anaconda3/pkgs
                          /Users/yandingzhao/.conda/pkgs
       envs directories : /Users/yandingzhao/opt/anaconda3/envs
                          /Users/yandingzhao/.conda/envs
               platform : osx-64
             user-agent : conda/4.10.3 requests/2.26.0 CPython/3.9.7 Darwin/20.6.0 OSX/10.16
                UID:GID : 501:20
             netrc file : None
           offline mode : False
",wt2855918,https://github.com/vanheeringen-lab/gimmemotifs/issues/246
I_kwDOAApTRs5D2riy,conda install improvements,CLOSED,2022-02-15T09:23:22Z,2023-01-18T11:28:32Z,2023-01-18T11:28:32Z,"Installing gimmemotifs can be a hassle, even for conda, as there are so many unpinned dependencies. I checked those dependencies out and noticed you have 7 different places where you list them:
- requirements.txt
- setup.py
- conda_env.txt
- conda_env.dev.txt
- conda_env.osx.txt
- .rtd_environment.yml
- docs/requirements.txt
- [the bioconda recipe](https://github.com/bioconda/bioconda-recipes/blob/master/recipes/gimmemotifs/meta.yaml)

Each file has different packages and versions! I've compiled all packaged (required to run gimme on linux) in the yaml format below, with minimal versions where I found them in any of these files. Ideally, this yaml should be used to update the `bioconda recipe` and `conda_env.txt`. That should speed up installations already.
For testing on travis, we can pin the versions and channels in `conda_env.dev.txt` and `conda_env.osx.txt` to prevent timeouts.
The others lists could perhaps be merged with/taken from `conda_env.txt` somehow?

```yaml
name: gimme
channels:
  - conda-forge
  - bioconda
  - defaults
dependencies:
- biofluff >=3.0.4  # TODO: biofluff added, version set to bioconda
- bedtools  # TODO: is this needed with pybedtools? under ""host"" on bioconda
- configparser
- dinamo
- diskcache
- feather-format
# TODO: future can be removed on bioconda (python2 pkg IIRC)
- gadem
- genomepy >=0.11.1  # TODO: version updated
- homer
- ipywidgets  # Necessary for progress bar in Jupyter notebook  # TODO: missing on bioconda
- iteround
- jinja2
- logomaker
- loguru
- matplotlib-base >=3.1.2  # TODO: was matplotlib >=2.0, version set to bioconda
- meme >=5.1.1  # TODO: version set to bioconda
- ncurses >=6.1 # TODO: is this needed with loguru? version set to bioconda
- numpy >= 1.6.0  # TODO: missing on bioconda (version set to requirements.txt)
- pandas >=1.0.3 # TODO: pandas specified on bioconda (version set to .rtl-environment.yaml)
- prosampler
- pillow >=0.7.1.2  # TODO: is this needed? version set to bioconda
- pyarrow >=0.16.0
- pybedtools
- pysam  # TODO: missing on bioconda. used only once.
- python >=3.8  # TODO: added minimum version (version set to conda_env.test.txt)
- python-xxhash
- pyyaml >=3.10  # TODO: is this needed?
- qnorm  >=0.5  # TODO: version set to bioconda
- scikit-learn >=0.23.2  # TODO: version set to bioconda
- scipy >=1.4.1
- seaborn >=0.10.1  # TODO: version set to bioconda
# TODO: six can be removed on bioconda (python2 pkg IIRC)
- statsmodels
- tqdm >=4.46.1  # TODO: version set to bioconda
- trawler
- ucsc-bigbedtobed  # TODO: is this needed?
- ucsc-genepredtobed  # TODO: is this needed? missing on bioconda
- weeder
- xdg
- xgboost >=1.0.2  # TODO: version set to bioconda
- xxmotif
```",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/250
I_kwDOAApTRs5ES5sc,MotifComparer metrics,OPEN,2022-02-21T13:31:18Z,2022-05-19T13:28:58Z,,"Hi Gimmemotifs-Team,
Thank you for providing this software! I want to use your tools to find out the similarity between multiple motifs to group them later. But looking at the results of the different metrics I don't know how to interpret the values. Especially with the changes between versions. Can you help me?
I thought that the values are similarity scores. So the higher the value the more similar are two motifs. But this does not seem to be the case for `ed` or `distance`. Also, I am wondering if the similarity scores will always be symmetric? And why are the values on the diagonal line changing on some tables? 

Thanks in advance
Hendrik

**To Reproduce:**
```
import pandas as pd
import gimmemotifs

def get_matrix(d):
    index = list(d.keys())
    col = list(d[index[0]].keys())
    
    table = pd.DataFrame(index=index, columns=col)
    for r_index in index:
        for c_index in col:
            table.loc[r_index, c_index] = d[r_index][c_index][0]
            
    return table

# downloaded from https://jaspar.genereg.net/download/data/2022/CORE/JASPAR2022_CORE_non-redundant_pfms_jaspar.txt
motifs = gimmemotifs.motif.read_motifs(""JASPAR2022_CORE_non-redundant_pfms_jaspar.txt"")

print(""Gimmemotifs: "", gimmemotifs.__version__)
for metric in [""seqcor"", ""pcc"", ""ed"", ""distance"", ""wic"", ""chisq"", ""akl"", ""ssd""]:
    mc = gimmemotifs.comparison.MotifComparer()
    scores = get_matrix(mc.get_all_scores(motifs=motifs[0:3], dbmotifs=motifs[0:3], match=""total"", metric=metric, combine=""mean""))
    print(metric, scores)
```

**Output:**
![grafik](https://user-images.githubusercontent.com/27274175/154943731-85137152-0e6a-4902-9eb7-cfd9edcab9ad.png)

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation pip
 - Versions: 0.16.0 & 0.17.0+12.g1908faa ",hschult,https://github.com/vanheeringen-lab/gimmemotifs/issues/251
I_kwDOAApTRs5HBRsP,Report Metrics,OPEN,2022-04-04T09:37:02Z,2022-05-19T09:31:22Z,,"Hello,

Your software and tutorial is very helpful and I have been able to use easily, thank you.

However, I am new to motif analysis and have been struggling to interpret the output metrics/significance scores.

I am trying to identify enriched motifs upstream of the starting codon for a set of genes but there are only approximately 100 genes in my input set.

Using gimme motifs, which report statistic is the most reliable?
Is there any guidance on reasonable significance thresholds?
How should I adjust my interpretation given the small sample size?

Any help is greatly appreciated.
Thank you",MattGoulty,https://github.com/vanheeringen-lab/gimmemotifs/issues/252
I_kwDOAApTRs5H6qmF,a custom size rather than fixed size,CLOSED,2022-04-18T01:36:25Z,2022-04-18T14:31:17Z,2022-04-18T14:31:17Z,"The size of the region used for motif finding is important.  
The default size is 200 bp that these regions will be based off the center of the peaks.  
If I prefer a custom, how can  I specify ""-size""?

LuZhang",wbszhu,https://github.com/vanheeringen-lab/gimmemotifs/issues/253
I_kwDOAApTRs5H-sOA,TypeError: _translate() takes 1 positional argument but 5 were given,CLOSED,2022-04-19T01:42:44Z,2023-01-18T11:27:47Z,2023-01-18T11:27:47Z,"Hi,
I use the command like below:
```
gimme motifs OUT-00-MS_PeQTLmotif.bed  OUT-00-MS-PeQTL_gimmotif/ -b OUT-00-LW_PeQTLmotif.bed -g  ~/22.genome/susScr11_xy/Sus_scrofa.Sscrofa11.1.dna.toplevel.fa --known --rawscore  -s 20
```
and the input format like this

head OUT-00-MS_PeQTLmotif.bed 
```
chr1	186731	186732	eqtl20_1	.
chr1	857255	857256	eqtl20_2	.
chr1	1522259	1522260	eqtl20_3	.
chr1	7612510	7612511	eqtl20_4	.
chr1	8934727	8934728	eqtl20_5	.
chr1	8934192	8934193	eqtl20_6	.
chr1	8934727	8934728	eqtl20_7	.
chr1	8934192	8934193	eqtl20_8	.
chr1	13447075	13447076	eqtl20_9	.
chr1	16248970	16248971	eqtl20_10	.
```
head OUT-00-LW_PeQTLmotif.bed 
```
chr1	186731	186732	eqtl20_1	.
chr1	857255	857256	eqtl20_2	.
chr1	1522259	1522260	eqtl20_3	.
chr1	7612510	7612511	eqtl20_4	.
chr1	8934727	8934728	eqtl20_5	.
chr1	8934192	8934193	eqtl20_6	.
chr1	8934727	8934728	eqtl20_7	.
chr1	8934192	8934193	eqtl20_8	.
chr1	13447075	13447076	eqtl20_9	.
chr1	16248970	16248971	eqtl20_10	.
```

and I received the error:
```
/public/home/luzhang/miniconda3/envs/gimme/lib/python3.9/site-packages/pandas/core/arraylike.py:397: RuntimeWarning: divide by zero encountered in log10
  result = getattr(ufunc, method)(*inputs, **kwargs)
/public/home/luzhang/miniconda3/envs/gimme/lib/python3.9/site-packages/pandas/io/formats/style.py:3558: RuntimeWarning: invalid value encountered in double_scalars
  norm = mpl.colors.Normalize(smin - (rng * low), smax + (rng * high))
/public/home/luzhang/miniconda3/envs/gimme/lib/python3.9/site-packages/pandas/io/formats/style.py:3558: RuntimeWarning: invalid value encountered in double_scalars
  norm = mpl.colors.Normalize(smin - (rng * low), smax + (rng * high))
Traceback (most recent call last):
  File ""/public/home/luzhang/miniconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/public/home/luzhang/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/cli.py"", line 746, in cli
    args.func(args)
  File ""/public/home/luzhang/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/commands/motifs.py"", line 278, in motifs
    roc_html_report(
  File ""/public/home/luzhang/miniconda3/envs/gimme/lib/python3.9/site-packages/gimmemotifs/report.py"", line 1018, in roc_html_report
    ExtraStyler(df)
  File ""/public/home/luzhang/miniconda3/envs/gimme/lib/python3.9/site-packages/pandas/io/formats/style.py"", line 344, in render
    return self._render_html(sparse_index, sparse_columns, **kwargs)
  File ""/public/home/luzhang/miniconda3/envs/gimme/lib/python3.9/site-packages/pandas/io/formats/style_render.py"", line 164, in _render_html
    d = self._translate(sparse_index, sparse_columns, max_rows, max_cols)
TypeError: _translate() takes 1 positional argument but 5 were given
```
Thanks
LuZhang",wbszhu,https://github.com/vanheeringen-lab/gimmemotifs/issues/254
I_kwDOAApTRs5IeMrh,plot_logo() seems to plot wrong logos with newer gimmemotifs versions,CLOSED,2022-04-26T12:21:14Z,2022-05-30T14:20:52Z,2022-05-30T14:20:52Z,`motif.plot_logo()` seems to be giving bad logos for new(er) gimme versions,Maarten-vd-Sande,https://github.com/vanheeringen-lab/gimmemotifs/issues/256
I_kwDOAApTRs5IrRgi,Gimme Scan Not Functioning as Expected,OPEN,2022-04-28T21:13:07Z,2022-05-19T09:17:19Z,,"**Describe the bug**
Hi, thank you for the wonderful software. I am obtaining a large number of hits with gimme scan even when I pass the -n 1 argument for a bed file that has a single interval. Specifically, the command:
gimme scan df.csv -g mm9 -c 1 -n 1 -b > motifs.bed 

Returns 1801 results, where df.csv is:
Chr xxxxx yyyyy


**To Reproduce**
Gimmemotifs 0.17.0 and python 3.7.

**Expected behavior**
Expecting 1 hit per sequence I input. Instead am receiving an output of 1801 hits. 

**Error logs**
No error messages were outputted. 

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: conda
 - Version [e.g. 0.13.0]

**Additional context**
Add any other context about the problem here.
I have adjusted fpr, but still cannot replicate scan to result inanely 1 hit. 
",vbchavali,https://github.com/vanheeringen-lab/gimmemotifs/issues/257
I_kwDOAApTRs5KxRLY,tool jaspar not configured,OPEN,2022-05-31T21:21:07Z,2022-05-31T21:21:07Z,,"In the versioning/develop branch, `test_tool[jaspar]` is currently skipped. Running this test throws `not configured` warning.
",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/261
I_kwDOAApTRs5KxRR-,tool yamda not configured,OPEN,2022-05-31T21:21:40Z,2022-05-31T21:21:40Z,,"In the versioning/develop branch, `test_tool[yamda]` is currently skipped. Running this test throws `not configured` warning.
",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/262
I_kwDOAApTRs5KxR6C,set readthedocs default branch to master,CLOSED,2022-05-31T21:24:55Z,2022-06-18T11:17:21Z,2022-06-18T11:17:21Z,"Readthedocs' defaults to the `stable` branch, which is pretty ancient. 
Instead, it should default to `master`. @simonvh, only you have he rights to change this.

https://readthedocs.org/projects/gimmemotifs/",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/263
I_kwDOAApTRs5KxSJW,update setup.py,OPEN,2022-05-31T21:26:14Z,2022-06-14T09:48:10Z,,`python setup.py install` and related functions throw a bunch of deprecation warnings.,siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/264
I_kwDOAApTRs5K1Sgd,backgrounds don't adhere to npcus,OPEN,2022-06-01T09:26:29Z,2022-06-01T09:26:29Z,,"When running `gimme motifs`, the background generation ignores the argument `ncpu`s.
This might be happening for other commands too.",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/265
I_kwDOAApTRs5LA5tN,docstrings for to_pfm,OPEN,2022-06-02T18:11:58Z,2022-06-02T18:11:58Z,,"Thanks for the great tool.

Quick suggestion: it would be nice to have PSEUDO_PFM_COUNT documented in readthedocs, it would have saved some confusion for me about the output of `.to_pfm()`. It's also not clear what these other constants defined next to PSEUDO_PFM_COUNT  are https://github.com/vanheeringen-lab/gimmemotifs/blob/33ade299fcf018cbd8cb1880181a9ff92c32b141/gimmemotifs/motif/__init__.py#L60

Thanks again!


",gfudenberg,https://github.com/vanheeringen-lab/gimmemotifs/issues/267
I_kwDOAApTRs5LBQVe,JASPAR2020_vertebrates error,OPEN,2022-06-02T19:34:12Z,2022-06-03T20:24:37Z,,"Hello, I am trying to provide the jaspar_2020 database to maelstrom as described: https://gimmemotifs.readthedocs.io/en/stable/overview.html#motif-databases.

`gimme maelstrom` seems to run fine I use the default database or provide jaspar 2018 motifs with the added parameter `-p JASPAR2018_vertebrates`. However, I am encountering  key errors when I provide jaspar 2020 or 2022, where it appears there is a motif id mismatch at some point in the scanning. 

```
scanning:   0%|                                      | 0/1000 [00:00<?, ? sequences/s]Traceback (most recent call last):
  File ""/home1/fudenber/.conda/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home1/fudenber/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/cli.py"", line 746, in cli
    args.func(args)
  File ""/home1/fudenber/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/commands/maelstrom.py"", line 33, in maelstrom
    run_maelstrom(
  File ""/home1/fudenber/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/maelstrom.py"", line 343, in run_maelstrom
    counts = scan_regionfile_to_table(
  File ""/home1/fudenber/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/scanner.py"", line 182, in scan_regionfile_to_table
    for row in s.count(regions):
  File ""/home1/fudenber/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/scanner.py"", line 1031, in count
    for matches in self.scan(seqs, nreport, scan_rc):
  File ""/home1/fudenber/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/scanner.py"", line 1140, in scan
    for result in it:
  File ""/home1/fudenber/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/scanner.py"", line 1204, in _scan_sequences
    motifs = [(m, thresholds[m.id]) for m in read_motifs(self.motifs)]
  File ""/home1/fudenber/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/scanner.py"", line 1204, in <listcomp>
    motifs = [(m, thresholds[m.id]) for m in read_motifs(self.motifs)]
KeyError: 'MA0637.1_CENPB'
scanning:   0%|                                      | 0/1000 [00:02<?, ? sequences/s]
```

",gfudenberg,https://github.com/vanheeringen-lab/gimmemotifs/issues/268
I_kwDOAApTRs5LnXry,The input files for motif2factors,CLOSED,2022-06-12T15:10:34Z,2022-06-16T14:48:50Z,2022-06-16T14:48:50Z,sorted,lynnyummy,https://github.com/vanheeringen-lab/gimmemotifs/issues/270
I_kwDOAApTRs5L5SJW,Bioconda installation,OPEN,2022-06-16T09:35:49Z,2023-04-11T07:22:08Z,,"Hi,

Thanks for the great package. I'm trying to install GimmeMotifs via conda and it keeps failing (in different computers and users). The command I run, as per guides in readthedocs:

`conda create -n gimme gimmemotifs`

Output:

`Collecting package metadata (current_repodata.json): done`
`Solving environment: failed with repodata from current_repodata.json, will retry with next repodata source.`
`Collecting package metadata (repodata.json): done`
`Solving environment: /`

In case it is useful, below the info of my conda installation.

Thanks for your help!

Chema

====== `conda info` =====

`          conda version : 4.13.0`
`    conda-build version : 3.21.9`
`         python version : 3.8.13.final.0`
`       virtual packages : __osx=10.16=0`
`                        __unix=0=0`
`                          __archspec=1=x86_64`
`       base environment : /opt/anaconda3  (writable)`
`      conda av data dir : /opt/anaconda3/etc/conda`
`  conda av metadata url : None`
`           channel URLs : https://conda.anaconda.org/conda-forge/osx-64`
`                          https://conda.anaconda.org/conda-forge/noarch`
`                          https://conda.anaconda.org/bioconda/osx-64`
`                         https://conda.anaconda.org/bioconda/noarch`
`                          https://repo.anaconda.com/pkgs/main/osx-64`
`                          https://repo.anaconda.com/pkgs/main/noarch`
`                          https://repo.anaconda.com/pkgs/r/osx-64`
`                          https://repo.anaconda.com/pkgs/r/noarch`
`               platform : osx-64`
`             user-agent : conda/4.13.0 requests/2.28.0 CPython/3.8.13 Darwin/21.4.0 OSX/10.16`
`               UID:GID : 502:20`
`             netrc file : None`
`           offline mode : False`
",ChemaMD,https://github.com/vanheeringen-lab/gimmemotifs/issues/271
I_kwDOAApTRs5M7q9Y,error when using CIS-BP database for gimme match,CLOSED,2022-06-30T22:49:59Z,2022-07-05T15:53:40Z,2022-07-05T15:53:40Z,"Hi, I have been running gimme motif very normally for long time, however, today when I start to use ""CIS-BP"" motif base, I just cannot run all the gimme motif analyses, it keeps reporting error like following,
`Fontconfig warning: ignoring UTF-8: not a valid region tag
Traceback (most recent call last):
  File ""/data/home/btx541/.conda/envs/gimme/bin/gimme"", line 8, in <module>
    from gimmemotifs.cli import cli
  File ""/data/home/btx541/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/__init__.py"", line 61, in <module>
    from . import denovo      # noqa: F401
  File ""/data/home/btx541/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/denovo.py"", line 51, in <module>
    from gimmemotifs.stats import calc_stats, rank_motifs, write_stats
  File ""/data/home/btx541/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/stats.py"", line 10, in <module>
    from gimmemotifs.scanner import scan_to_best_match, Scanner
  File ""/data/home/btx541/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/scanner.py"", line 58, in <module>
    config = MotifConfig()
  File ""/data/home/btx541/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/config.py"", line 95, in __init__
    self._upgrade_config()
  File ""/data/home/btx541/.conda/envs/gimme/lib/python3.9/site-packages/gimmemotifs/config.py"", line 98, in _upgrade_config
    if ""width"" in self.config[""params""]:
  File ""/data/home/btx541/.conda/envs/gimme/lib/python3.9/configparser.py"", line 960, in __getitem__
    raise KeyError(key)
KeyError: 'params'`

I am also trying to remove and reinstall gimme motifs, however, more issues come out....

Could you please help to check what issue it could be?  Thank you very much!

",lynnyummy,https://github.com/vanheeringen-lab/gimmemotifs/issues/273
I_kwDOAApTRs5O0YAT,Error in maelstrom,CLOSED,2022-07-29T14:54:39Z,2022-08-03T04:27:40Z,2022-08-03T04:27:40Z,"I've hit an error when using maelstrom. I'm not sure where it's coming from. Here's the output:


`gimme maelstrom --no-filter --nthreads 8 -p motifs/input.pfm labeled-regs.txt hg38 maelstrom_out/out_name

2022-07-29 10:12:52,748 - INFO - Starting maelstrom
2022-07-29 10:12:53,174 - INFO - motif scanning (counts)
2022-07-29 10:12:53,174 - INFO - reading table
2022-07-29 10:13:32,374 - INFO - using 14000 sequences
2022-07-29 10:13:32,474 - INFO - Creating index for genomic GC frequencies.
2022-07-29 10:18:39,060 - INFO - setting threshold
2022-07-29 10:18:39,955 - INFO - determining FPR-based threshold
2022-07-29 10:18:51,916 - INFO - creating count table
scanning: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 200341/200341 [01:01<00:00, 3246.69 sequences/s]
2022-07-29 10:20:03,032 - INFO - done
2022-07-29 10:20:03,032 - INFO - creating dataframe
2022-07-29 10:20:09,641 - INFO - motif scanning (scores)
2022-07-29 10:20:09,641 - INFO - reading table
2022-07-29 10:20:11,138 - INFO - creating score table (z-score, GC%)
scanning: 100%|██████████████████████████████████████████████████████████████████████████████████████████████| 200341/200341 [01:32<00:00, 2159.28 sequences/s]
2022-07-29 10:26:55,599 - INFO - done
2022-07-29 10:26:55,599 - INFO - creating dataframe
2022-07-29 10:28:07,568 - INFO - Fitting MWU
/storage/work/sam77/software/anaconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/moap.py:322: RuntimeWarning: divide by zero encountered in log10
  self.act_ = pd.DataFrame(-np.log10(fpr.T), columns=clusters, index=df_X.columns)
2022-07-29 10:33:18,729 - INFO - Done
2022-07-29 10:33:19,584 - INFO - Fitting Hypergeom
/storage/work/sam77/software/anaconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/moap.py:386: RuntimeWarning: divide by zero encountered in log10
  self.act_ = pd.DataFrame(-np.log10(fpr.T), columns=clusters, index=df_X.columns)
2022-07-29 10:33:22,868 - INFO - Done
2022-07-29 10:33:25,024 - INFO - Fitting RF
2022-07-29 10:47:27,291 - INFO - Done
2022-07-29 10:47:27,328 - INFO - Rank aggregation
2022-07-29 10:47:28,984 - INFO - html report
Traceback (most recent call last):
  File ""/storage/work/sam77/software/anaconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/storage/work/sam77/software/anaconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/cli.py"", line 746, in cli
    args.func(args)
  File ""/storage/work/sam77/software/anaconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/commands/maelstrom.py"", line 33, in maelstrom
    run_maelstrom(
  File ""/storage/work/sam77/software/anaconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/maelstrom.py"", line 546, in run_maelstrom
    maelstrom_html_report(outdir, os.path.join(outdir, ""final.out.txt""), pfmfile)
  File ""/storage/work/sam77/software/anaconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/report.py"", line 923, in maelstrom_html_report
    df_styled = df_styled.wrap().render()
  File ""/storage/work/sam77/software/anaconda3/envs/gimme/lib/python3.10/site-packages/pandas/io/formats/style.py"", line 344, in render
    return self._render_html(sparse_index, sparse_columns, **kwargs)
  File ""/storage/work/sam77/software/anaconda3/envs/gimme/lib/python3.10/site-packages/pandas/io/formats/style_render.py"", line 164, in _render_html
    d = self._translate(sparse_index, sparse_columns, max_rows, max_cols)
TypeError: ExtraStyler._translate() takes 1 positional argument but 5 were given`",shaunmahony,https://github.com/vanheeringen-lab/gimmemotifs/issues/274
I_kwDOAApTRs5PFkmb,Motif.information_content is NaN if any entry in the pfm is 0.,OPEN,2022-08-03T08:25:44Z,2022-08-03T08:25:59Z,,"As it says in the headline, `numpy.log2(self.pfm)` will result in `-inf`, which in turn becomes `NaN` when multiplied by `self.pfm`. 

The limiting behaviour of `p log(p)` as `p -> 0` should be 0. It looks like this got broken when the motif class got refactored.

I've got a fix and am adding unit tests for it now. Will have a PR for it up shortly.",oalmelid,https://github.com/vanheeringen-lab/gimmemotifs/issues/275
I_kwDOAApTRs5QQCYY,Provide background peaks file as .bed instead of FASTA?,OPEN,2022-08-22T12:56:51Z,2022-09-29T05:57:18Z,,"Hello,

I am writing an issue of 'other' type as I am not sure where to ask. I am trying to run gimme motifs with a custom, non-genomepy genome and I am getting the following error:
```
(gimme_venv) alberto@nostromo:/mnt/sda/alberto/projects/ananse_smed/outputs/gimme$ gimme motifs -b 202110XX_peaks_goodformat.bed -g /mnt/sda/alberto/DATA/dynamic/genomes/Smed/Guo/Smed.fasta /mnt/sda/alberto/projects/ananse_smed/outputs/wgcna/20220812_wgcna_smed_black_assocpeaks.bed  outdir
2022-08-22 13:34:23,208 - INFO - starting full motif analysis
2022-08-22 13:34:23,223 - INFO - using size of 200, set size to 0 to use original region size
2022-08-22 13:34:23,224 - INFO - preparing input from BED
2022-08-22 13:34:23,338 - INFO - Copying custom background file 202110XX_peaks_goodformat.bed to outdir/intermediate/prediction.bg.fa.
Traceback (most recent call last):
  File ""/mnt/sda/alberto/programs/miniconda3/envs/gimme_venv/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/mnt/sda/alberto/programs/miniconda3/envs/gimme_venv/lib/python3.9/site-packages/gimmemotifs/cli.py"", line 748, in cli
    args.func(args)
  File ""/mnt/sda/alberto/programs/miniconda3/envs/gimme_venv/lib/python3.9/site-packages/gimmemotifs/commands/motifs.py"", line 111, in motifs
    denovo = gimme_motifs(
  File ""/mnt/sda/alberto/programs/miniconda3/envs/gimme_venv/lib/python3.9/site-packages/gimmemotifs/denovo.py"", line 625, in gimme_motifs
    background = create_backgrounds(
  File ""/mnt/sda/alberto/programs/miniconda3/envs/gimme_venv/lib/python3.9/site-packages/gimmemotifs/denovo.py"", line 330, in create_backgrounds
    create_background(
  File ""/mnt/sda/alberto/programs/miniconda3/envs/gimme_venv/lib/python3.9/site-packages/gimmemotifs/denovo.py"", line 279, in create_background
    f = Fasta(bg_file)
  File ""/mnt/sda/alberto/programs/miniconda3/envs/gimme_venv/lib/python3.9/site-packages/gimmemotifs/fasta.py"", line 25, in __init__
    raise IOError(""Not a valid FASTA file"")
OSError: Not a valid FASTA file
```

I am unable to detect any problem with the FASTA file of the genome:
```
(gimme_venv) alberto@nostromo:/mnt/sda/alberto/projects/ananse_smed/outputs/gimme$ head /mnt/sda/alberto/DATA/dynamic/genomes/Smed/Guo/Smed.fasta
>smed_chr1
TCACTTTTCCAATTCAAAAATTGTAGTAATCGCGTTGGTTTGTTCCCCAAAGAGGTGATC
AATCTCTCGCCAGGAACTCCCCAACATTTGCGACGGATCCTACTACCTTCCTCTCCTCGG
GTTGATCAAGGTTCCCCATCGGAATAAGCGTACTATCGTTATGATAGCTCGGTTTTAAAT
CTTACTTTCCAGTATTATTTCCATATAATATAAATAACATTACAAAATATACTAACAAAA
TGATGCATCGAAACTTTTACCGTACCTTATGTGTGATTTTTCAGCTTTCACTGTTTAAGT
TGTGTTTTACTTGTCCACTCAGAATTTATTTAACGGCTTTCATGAAGTTTTCGGCTTTTT
TCCGTATGTTTTACACCTTTCGGTTGCTATTGTTGTCTCATTTATTATTATTATTAATCT
CAACTCATCGTACTCGTTTTTTTTAATCATCATTTTCCTCTGGTTGCTAACTATTATTCT
CGTAATTCATTATTATCTCTAATCCTTTATTTTCATTAATAACAGGCATCATCATTTTAT
(gimme_venv) alberto@nostromo:/mnt/sda/alberto/projects/ananse_smed/outputs/gimme$ grep "">"" /mnt/sda/alberto/DATA/dynamic/genomes/Smed/Guo/Smed.fasta
>smed_chr1
>smed_chr2
>smed_chr3
>smed_chr4
>SmedMT
```

Correct me if I am wrong, but I understand the error refers to trying to pass the background peaks as a .bed file. Is it possible to do this, or must the background peak file be in .fasta format? I could not find any related info in the documentation.

Thanks in advance,

Alberto",apposada,https://github.com/vanheeringen-lab/gimmemotifs/issues/277
I_kwDOAApTRs5SuEXl,What does inferred mean in combined.motif2factors?,CLOSED,2022-09-27T13:51:50Z,2022-10-06T18:35:41Z,2022-10-06T18:35:41Z,"`gimme motifs`finds a denovo motif, with this sequence logo:

![image](https://user-images.githubusercontent.com/414586/192544162-64adfe4c-a6c6-4456-ac20-ad74474b24f6.png)

And claims it is inferred that YY1 is a factor that will bind it, but YY1 has a very different looking binding motif. What does inferred mean? How should I interpret this? I searched through the manual but didn't find anything describing what inferred meant.

Thank you so much! ",roryk,https://github.com/vanheeringen-lab/gimmemotifs/issues/279
I_kwDOAApTRs5Tf0jo,Questions about GimmeMotifs output,OPEN,2022-10-07T08:59:46Z,2022-10-14T09:53:00Z,,"I have been using gimmemotifs to analize data comming from chipseq experiment, it worked well,  but now is hard for me to understand the outputs and i miss some information at the documentation. Let me explain myself:

at the results i have four html files : gimme.clustereds.html, gimme.denovo.html,  gimme.motifs.html,  gimme.motifs.redundant.html

that i think,  but not for sure, that contains:

gimme.denovo.html : motives found that are not present at any datbase
gimme.motifs.redundant.html : All motives found at the sample, including denovo and known motif
gimme.clustereds.html   here i think you try to ""cluster"" the motives 
 gimme.motifs.html : Final results with the most relevant information found

is that rigth?

the point here is that  i don't find how to how to follow the the process, should  I find the names  from gimme.clustereds.html in gimme.motifs.redundant.html ?

 how do you go from them redundant list to the motif list?  and what should i take as a final result

thanks",paumarc,https://github.com/vanheeringen-lab/gimmemotifs/issues/280
I_kwDOAApTRs5Uspip,clustered motifs for invertebrates,OPEN,2022-10-24T15:09:04Z,2022-10-28T06:28:37Z,,"Hi Simon,

great tool, I missed using it!

any chance you have a Drosophila/arthropods/insects/invertebrates version of the clustered vertebrate motifs like gimme.vertebrate.v5.0?
Or a code template to generate it?

Thanks!",perinom,https://github.com/vanheeringen-lab/gimmemotifs/issues/282
I_kwDOAApTRs5WJlu-,Odd behaviour using --fraction,CLOSED,2022-11-11T11:41:41Z,2023-01-11T12:48:14Z,2023-01-11T12:48:14Z,"**Describe the bug**
One of my input files fails when --fraction 1 is used.  Other fraction below this run, e.g. --fraction 0.99.  The last line of the BED file is OK, i.e. does not run over the end of a chromosome.

Last lines of input BED:
chr22	11815567	11815821	1.30222897085266
chr22	15775758	15775963	1.450876122866
chr2	195181137	195181406	1.09126450599062
chr20	29885538	29885777	1.25589653105964
chr11	15027039	15027314	1.01498919564827
chr20	30829958	30830307	1.22945126796095
chr6	79440963	79441249	1.41701594737168
chr4	49114650	49114880	1.42618253180225

Full file attached.

**To Reproduce**
FAILS:  
`gimme motifs DiffBind_summitsFALSE_MACS2_call-summits_results_Day3-Stiff_vs_Day0-2D_FDRlt0p05_LFCgt1.bed DiffBind_summitsFALSE_MACS2_call-summits_results_Day3-Stiff_vs_Day0-2D_FDRlt0p05_LFCgt1_motifs -g hg38.analysisSet.fa --denovo --tools Homer,MEME,MotifSampler,Weeder,GADEM -a large --size 200 -f 1`

Error:  
2022-11-11 11:01:53,053 - INFO - creating background (matched GC%)
2022-11-11 11:02:10,546 - INFO - starting full motif analysis
2022-11-11 11:02:10,546 - INFO - using size of 200, set size to 0 to use original region size
2022-11-11 11:02:10,546 - INFO - preparing input from BED
Traceback (most recent call last):
  File ""/home/ian/miniconda3/envs/gimme/bin/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/home/ian/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/cli.py"", line 748, in cli
    args.func(args)
  File ""/home/ian/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/commands/motifs.py"", line 111, in motifs
    denovo = gimme_motifs(
  File ""/home/ian/m
[DiffBind_summitsFALSE_MACS2_call-summits_results_Day3-Stiff_vs_Day0-2D_FDRlt0p05_LFCgt1.bed.txt](https://github.com/vanheeringen-lab/gimmemotifs/files/9989896/DiffBind_summitsFALSE_MACS2_call-summits_results_Day3-Stiff_vs_Day0-2D_FDRlt0p05_LFCgt1.bed.txt)
[DiffBind_summitsFALSE_MACS2_call-summits_results_Day3-Stiff_vs_Day0-2D_FDRlt0p05_LFCgt1.bed.txt](https://github.com/vanheeringen-lab/gimmemotifs/files/9989897/DiffBind_summitsFALSE_MACS2_call-summits_results_Day3-Stiff_vs_Day0-2D_FDRlt0p05_LFCgt1.bed.txt)
iniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 625, in gimme_motifs
    background = create_backgrounds(
  File ""/home/ian/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 344, in create_backgrounds
    nr_sequences[bg] = create_background(
  File ""/home/ian/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/denovo.py"", line 231, in create_background
    fg = Fasta(fafile)
  File ""/home/ian/miniconda3/envs/gimme/lib/python3.8/site-packages/gimmemotifs/fasta.py"", line 25, in __init__
    raise IOError(""Not a valid FASTA file"")

RUN:
`gimme motifs DiffBind_summitsFALSE_MACS2_call-summits_results_Day3-Stiff_vs_Day0-2D_FDRlt0p05_LFCgt1.bed DiffBind_summitsFALSE_MACS2_call-summits_results_Day3-Stiff_vs_Day0-2D_FDRlt0p05_LFCgt1_motifs -g hg38.analysisSet.fa --denovo --tools Homer,MEME,MotifSampler,Weeder,GADEM -a large --size 200 -f 0.99`

Messages:
2022-11-11 11:18:41,799 - INFO - creating background (matched GC%)
2022-11-11 11:18:59,415 - INFO - starting full motif analysis
2022-11-11 11:18:59,415 - INFO - using size of 200, set size to 0 to use original region size
2022-11-11 11:18:59,415 - INFO - preparing input from BED
2022-11-11 11:19:33,563 - INFO - starting motif prediction (large)
2022-11-11 11:19:33,563 - INFO - tools: GADEM, Homer, MEME, MotifSampler, Weeder
2022-11-11 11:19:33,722 - INFO - all jobs submitted

**Expected behavior**
Run to completion

**Installation information (please complete the following information):**
 - OS: Ubuntu 20
 - Installation: mamba install gimme
 - Version [e.g. 0.13.0]: 0.17.2

# packages in environment at /home/ian/miniconda3/envs/gimme:
#
# Name                    Version                   Build  Channel
_libgcc_mutex             0.1                 conda_forge    conda-forge
_openmp_mutex             4.5                       2_gnu    conda-forge
alsa-lib                  1.2.3.2              h166bdaf_0    conda-forge
appdirs                   1.4.4              pyh9f0ad1d_0    conda-forge
arrow-cpp                 9.0.0           py38h06d3c50_7_cpu    conda-forge
attr                      2.5.1                h166bdaf_1    conda-forge
attrs                     22.1.0             pyh71513ae_1    conda-forge
aws-c-cal                 0.5.11               h95a6274_0    conda-forge
aws-c-common              0.6.2                h7f98852_0    conda-forge
aws-c-event-stream        0.2.7               h3541f99_13    conda-forge
aws-c-io                  0.10.5               hfb6a706_0    conda-forge
aws-checksums             0.1.11               ha31a3da_7    conda-forge
aws-sdk-cpp               1.8.186              hb4091e7_3    conda-forge
bedtools                  2.30.0               h468198e_3    bioconda
biofluff                  3.0.4                      py_0    bioconda
biopython                 1.79             py38h0a891b7_2    conda-forge
biothings_client          0.2.6              pyhd8ed1ab_0    conda-forge
boost-cpp                 1.74.0               h6cacc03_7    conda-forge
brotli                    1.0.9                h166bdaf_7    conda-forge
brotli-bin                1.0.9                h166bdaf_7    conda-forge
brotlipy                  0.7.0           py38h0a891b7_1004    conda-forge
bzip2                     1.0.8                h7f98852_4    conda-forge
c-ares                    1.18.1               h7f98852_0    conda-forge
ca-certificates           2022.9.24            ha878542_0    conda-forge
cachetools                5.2.0              pyhd8ed1ab_0    conda-forge
cattrs                    22.2.0             pyhd8ed1ab_0    conda-forge
certifi                   2022.9.24          pyhd8ed1ab_0    conda-forge
cffi                      1.15.1           py38h4a40e3a_1    conda-forge
charset-normalizer        2.1.1              pyhd8ed1ab_0    conda-forge
click                     8.1.3            py38h578d9bd_0    conda-forge
colorama                  0.4.5              pyhd8ed1ab_0    conda-forge
configparser              5.3.0              pyhd8ed1ab_0    conda-forge
contourpy                 1.0.5            py38h43d8883_0    conda-forge
cryptography              38.0.2           py38h2b5fc30_1    conda-forge
cycler                    0.11.0             pyhd8ed1ab_0    conda-forge
dbus                      1.13.6               h5008d03_3    conda-forge
dinamo                    1.0                  h2df963e_2    bioconda
diskcache                 5.4.0              pyhd8ed1ab_0    conda-forge
dnspython                 2.2.1              pyhd8ed1ab_0    conda-forge
exceptiongroup            1.0.0rc9           pyhd8ed1ab_0    conda-forge
expat                     2.4.9                h27087fc_0    conda-forge
feather-format            0.4.1              pyh9f0ad1d_0    conda-forge
fftw                      3.3.10          nompi_hf0379b8_105    conda-forge
filelock                  3.8.0              pyhd8ed1ab_0    conda-forge
font-ttf-dejavu-sans-mono 2.37                 hab24e00_0    conda-forge
font-ttf-inconsolata      3.000                h77eed37_0    conda-forge
font-ttf-source-code-pro  2.038                h77eed37_0    conda-forge
font-ttf-ubuntu           0.83                 hab24e00_0    conda-forge
fontconfig                2.14.1               hc2a2eb6_0    conda-forge
fonts-conda-ecosystem     1                             0    conda-forge
fonts-conda-forge         1                             0    conda-forge
fonttools                 4.38.0           py38h0a891b7_0    conda-forge
freetype                  2.12.1               hca18f0e_0    conda-forge
frozendict                2.3.4            py38h0a891b7_0    conda-forge
gadem                     1.3.1                hec16e2b_4    bioconda
genomepy                  0.14.0             pyh7cba7a3_1    bioconda
gettext                   0.21.1               h27087fc_0    conda-forge
gflags                    2.2.2             he1b5a44_1004    conda-forge
ghostscript               9.54.0               h27087fc_2    conda-forge
gimmemotifs               0.17.2               h9ee0642_0    bioconda
gimmemotifs-minimal       0.17.2           py38h8ded8fe_0    bioconda
glib                      2.74.0               h6239696_0    conda-forge
glib-tools                2.74.0               h6239696_0    conda-forge
glog                      0.6.0                h6f12383_0    conda-forge
grpc-cpp                  1.47.1               h05bd8bd_6    conda-forge
gst-plugins-base          1.18.5               hf529b03_3    conda-forge
gstreamer                 1.20.3               hd4edc92_2    conda-forge
homer                     4.11            pl5321h9f5acd7_7    bioconda
htseq                     2.0.2            py38h7a2e8c7_0    bioconda
htslib                    1.16                 h6bc39ce_0    bioconda
icu                       69.1                 h9c3ff4c_0    conda-forge
idna                      3.4                pyhd8ed1ab_0    conda-forge
importlib-metadata        4.11.4           py38h578d9bd_0    conda-forge
iteround                  1.0.3              pyhd8ed1ab_0    conda-forge
itsdangerous              2.1.2              pyhd8ed1ab_0    conda-forge
jack                      1.9.18            hfd4fe87_1001    conda-forge
jinja2                    3.1.2              pyhd8ed1ab_1    conda-forge
joblib                    1.2.0              pyhd8ed1ab_0    conda-forge
jpeg                      9e                   h166bdaf_2    conda-forge
keyutils                  1.6.1                h166bdaf_0    conda-forge
kiwisolver                1.4.4            py38h43d8883_0    conda-forge
krb5                      1.19.3               h3790be6_0    conda-forge
lcms2                     2.12                 hddcbb42_0    conda-forge
ld_impl_linux-64          2.39                 hc81fddc_0    conda-forge
lerc                      4.0.0                h27087fc_0    conda-forge
libabseil                 20220623.0      cxx17_h48a1fff_4    conda-forge
libblas                   3.9.0           16_linux64_openblas    conda-forge
libbrotlicommon           1.0.9                h166bdaf_7    conda-forge
libbrotlidec              1.0.9                h166bdaf_7    conda-forge
libbrotlienc              1.0.9                h166bdaf_7    conda-forge
libcap                    2.64                 ha37c62d_0    conda-forge
libcblas                  3.9.0           16_linux64_openblas    conda-forge
libclang                  13.0.1          default_hc23dcda_0    conda-forge
libcrc32c                 1.1.2                h9c3ff4c_0    conda-forge
libcups                   2.3.3                h3e49a29_2    conda-forge
libcurl                   7.85.0               h7bff187_0    conda-forge
libdb                     6.2.32               h9c3ff4c_0    conda-forge
libdeflate                1.13                 h166bdaf_0    conda-forge
libedit                   3.1.20191231         he28a2e2_2    conda-forge
libev                     4.33                 h516909a_1    conda-forge
libevent                  2.1.10               h9b69904_4    conda-forge
libffi                    3.4.2                h7f98852_5    conda-forge
libflac                   1.3.4                h27087fc_0    conda-forge
libgcc-ng                 12.2.0              h65d4601_19    conda-forge
libgfortran-ng            12.2.0              h69a702a_19    conda-forge
libgfortran5              12.2.0              h337968e_19    conda-forge
libglib                   2.74.0               h7a41b64_0    conda-forge
libgomp                   12.2.0              h65d4601_19    conda-forge
libgoogle-cloud           2.2.0                h838d150_1    conda-forge
libiconv                  1.17                 h166bdaf_0    conda-forge
libidn2                   2.3.4                h166bdaf_0    conda-forge
liblapack                 3.9.0           16_linux64_openblas    conda-forge
libllvm11                 11.1.0               he0ac6c6_4    conda-forge
libllvm13                 13.0.1               hf817b99_2    conda-forge
libnghttp2                1.47.0               hdcd2b5c_1    conda-forge
libnsl                    2.0.0                h7f98852_0    conda-forge
libogg                    1.3.4                h7f98852_1    conda-forge
libopenblas               0.3.21          pthreads_h78a6416_3    conda-forge
libopus                   1.3.1                h7f98852_1    conda-forge
libpng                    1.6.38               h753d276_0    conda-forge
libpq                     14.5                 hd77ab85_0    conda-forge
libprotobuf               3.21.8               h6239696_0    conda-forge
libsndfile                1.0.31               h9c3ff4c_1    conda-forge
libsqlite                 3.39.4               h753d276_0    conda-forge
libssh2                   1.10.0               haa6b8db_3    conda-forge
libstdcxx-ng              12.2.0              h46fd767_19    conda-forge
libthrift                 0.16.0               h491838f_2    conda-forge
libtiff                   4.4.0                h0e0dad5_3    conda-forge
libtool                   2.4.6             h9c3ff4c_1008    conda-forge
libudev1                  251                  h166bdaf_0    conda-forge
libunistring              0.9.10               h7f98852_0    conda-forge
libutf8proc               2.7.0                h7f98852_0    conda-forge
libuuid                   2.32.1            h7f98852_1000    conda-forge
libvorbis                 1.3.7                h9c3ff4c_0    conda-forge
libwebp-base              1.2.4                h166bdaf_0    conda-forge
libxcb                    1.13              h7f98852_1004    conda-forge
libxkbcommon              1.0.3                he3ba5ed_0    conda-forge
libxml2                   2.9.12               h885dcf4_1    conda-forge
libxslt                   1.1.33               h0ef7038_3    conda-forge
libzlib                   1.2.13               h166bdaf_4    conda-forge
llvmlite                  0.39.1           py38h38d86a4_0    conda-forge
logomaker                 0.8                pyh864c0ab_1    bioconda
loguru                    0.6.0            py38h578d9bd_1    conda-forge
lxml                      4.8.0            py38h0a891b7_2    conda-forge
lz4-c                     1.9.3                h9c3ff4c_1    conda-forge
markupsafe                2.1.1            py38h0a891b7_1    conda-forge
matplotlib                3.6.1            py38h578d9bd_0    conda-forge
matplotlib-base           3.6.1            py38hb021067_0    conda-forge
meme                      5.4.1           py38pl5321h41067b3_2    bioconda
mpi                       1.0                     openmpi    conda-forge
munkres                   1.1.4              pyh9f0ad1d_0    conda-forge
mygene                    3.2.2              pyh5e36f6f_0    bioconda
mysql-common              8.0.31               haf5c9bc_0    conda-forge
mysql-connector-c         6.1.11            h6eb9d5d_1007    conda-forge
mysql-connector-python    8.0.31           py38hec49fd2_1    conda-forge
mysql-libs                8.0.31               h28c427c_0    conda-forge
ncurses                   6.3                  h27087fc_1    conda-forge
norns                     0.1.6              pyh5e36f6f_0    bioconda
nose                      1.3.7           py38h32f6830_1004    conda-forge
nspr                      4.32                 h9c3ff4c_1    conda-forge
nss                       3.78                 h2350873_0    conda-forge
numba                     0.56.3           py38h9a4aae9_0    conda-forge
numpy                     1.23.4           py38h7042d01_0    conda-forge
openjpeg                  2.5.0                h7d73246_1    conda-forge
openmpi                   4.1.4              ha1ae619_101    conda-forge
openssl                   1.1.1q               h166bdaf_1    conda-forge
orc                       1.8.0                h09e0d61_0    conda-forge
packaging                 21.3               pyhd8ed1ab_0    conda-forge
palettable                3.3.0                      py_0    conda-forge
pandas                    1.5.1            py38h8f669ce_0    conda-forge
parquet-cpp               1.5.1                         1    conda-forge
patsy                     0.5.3              pyhd8ed1ab_0    conda-forge
pcre2                     10.37                hc3806b6_1    conda-forge
perl                      5.32.1          2_h7f98852_perl5    conda-forge
perl-base                 2.23            pl5321hd8ed1ab_0    conda-forge
perl-business-isbn        3.007           pl5321hd8ed1ab_0    conda-forge
perl-business-isbn-data   20210112.006    pl5321hd8ed1ab_0    conda-forge
perl-carp                 1.50            pl5321hd8ed1ab_0    conda-forge
perl-cgi                  4.54            pl5321hec16e2b_1    bioconda
perl-common-sense         3.75            pl5321hd8ed1ab_0    conda-forge
perl-compress-raw-zlib    2.202           pl5321h166bdaf_0    conda-forge
perl-constant             1.33            pl5321hd8ed1ab_0    conda-forge
perl-data-dumper          2.183           pl5321h166bdaf_0    conda-forge
perl-dbi                  1.643           pl5321h166bdaf_0    conda-forge
perl-encode               3.19            pl5321h166bdaf_0    conda-forge
perl-encode-locale        1.05            pl5321hdfd78af_7    bioconda
perl-exporter             5.74            pl5321hd8ed1ab_0    conda-forge
perl-extutils-makemaker   7.64            pl5321hd8ed1ab_0    conda-forge
perl-file-path            2.18            pl5321hd8ed1ab_0    conda-forge
perl-file-spec            3.48_01         pl5321hdfd78af_2    bioconda
perl-file-temp            0.2304          pl5321hd8ed1ab_0    conda-forge
perl-file-which           1.24            pl5321hd8ed1ab_0    conda-forge
perl-html-parser          3.79            pl5321h9f5acd7_0    bioconda
perl-html-tagset          3.20                          0    bioconda
perl-html-template        2.97            pl5321hdfd78af_2    bioconda
perl-html-tree            5.07            pl5321hdfd78af_2    bioconda
perl-http-date            6.05            pl5321hdfd78af_0    bioconda
perl-http-message         6.36            pl5321hdfd78af_0    bioconda
perl-io-html              1.004           pl5321hdfd78af_0    bioconda
perl-json                 4.10            pl5321hdfd78af_0    bioconda
perl-json-xs              2.34            pl5321h9f5acd7_5    bioconda
perl-log-log4perl         1.56            pl5321hd8ed1ab_0    conda-forge
perl-lwp-mediatypes       6.04            pl5321hdfd78af_1    bioconda
perl-math-cdf             0.1             pl5321hec16e2b_7    bioconda
perl-mime-base64          3.16            pl5321h166bdaf_0    conda-forge
perl-parent               0.238           pl5321hd8ed1ab_0    conda-forge
perl-scalar-list-utils    1.63            pl5321h166bdaf_0    conda-forge
perl-storable             3.15            pl5321h166bdaf_0    conda-forge
perl-threaded             5.32.1               hdfd78af_1    bioconda
perl-time-local           1.30            pl5321hdfd78af_0    bioconda
perl-timedate             2.33            pl5321hdfd78af_2    bioconda
perl-types-serialiser     1.01            pl5321hdfd78af_0    bioconda
perl-uri                  5.12            pl5321hdfd78af_0    bioconda
perl-url-encode           0.03            pl5321h9ee0642_0    bioconda
perl-xml-namespacesupport 1.12            pl5321hd8ed1ab_0    conda-forge
perl-xml-parser           2.44_01         pl5321hc3e0081_1003    conda-forge
perl-xml-sax              1.02            pl5321hd8ed1ab_0    conda-forge
perl-xml-sax-base         1.09            pl5321hd8ed1ab_0    conda-forge
perl-xml-sax-expat        0.51            pl5321hd8ed1ab_0    conda-forge
perl-xml-simple           2.25            pl5321hdfd78af_2    bioconda
perl-yaml                 1.30            pl5321hdfd78af_0    bioconda
pillow                    9.2.0            py38ha3b2c9c_2    conda-forge
pip                       22.3               pyhd8ed1ab_0    conda-forge
prosampler                1.0                  hc9558a2_0    bioconda
protobuf                  4.21.8           py38hfa26641_0    conda-forge
pthread-stubs             0.4               h36c2ea0_1001    conda-forge
pulseaudio                14.0                 hbc9ff1d_7    conda-forge
pyarrow                   9.0.0           py38h8617f3d_7_cpu    conda-forge
pybedtools                0.9.0            py38hf4f3596_1    bioconda
pybigwig                  0.3.18           py38hf8a4f86_2    bioconda
pycparser                 2.21               pyhd8ed1ab_0    conda-forge
pyfaidx                   0.7.1              pyh5e36f6f_0    bioconda
pyld                      2.0.3              pyhd8ed1ab_1    conda-forge
pyopenssl                 22.1.0             pyhd8ed1ab_0    conda-forge
pyparsing                 3.0.9              pyhd8ed1ab_0    conda-forge
pyqt                      5.15.4           py38hfa26641_0    conda-forge
pyqt5-sip                 12.9.0           py38hfa26641_0    conda-forge
pysam                     0.19.1           py38h1c8baaf_1    bioconda
pysocks                   1.7.1            py38h578d9bd_5    conda-forge
python                    3.8.13          h582c2e5_0_cpython    conda-forge
python-dateutil           2.8.2              pyhd8ed1ab_0    conda-forge
python-xxhash             3.0.0            py38h0a891b7_1    conda-forge
python_abi                3.8                      2_cp38    conda-forge
pytz                      2022.5             pyhd8ed1ab_0    conda-forge
pyvcf3                    1.0.3              pyhdfd78af_0    bioconda
pyyaml                    6.0              py38h0a891b7_4    conda-forge
qnorm                     0.8.1              pyh6c4a22f_0    conda-forge
qt-main                   5.15.2               hdf1cb14_3    conda-forge
re2                       2022.06.01           h27087fc_0    conda-forge
readline                  8.1.2                h0f457ee_0    conda-forge
requests                  2.28.1             pyhd8ed1ab_1    conda-forge
requests-cache            0.9.6              pyhd8ed1ab_0    conda-forge
s2n                       1.0.10               h9b69904_0    conda-forge
scikit-learn              1.1.2            py38h0b08f9b_0    conda-forge
scipy                     1.9.3            py38h8ce737c_0    conda-forge
seaborn                   0.12.0               hd8ed1ab_0    conda-forge
seaborn-base              0.12.0             pyhd8ed1ab_0    conda-forge
setuptools                65.5.0             pyhd8ed1ab_0    conda-forge
sip                       6.5.1            py38h709712a_2    conda-forge
six                       1.16.0             pyh6c4a22f_0    conda-forge
snappy                    1.1.9                hbd366e4_1    conda-forge
sqlite                    3.39.4               h4ff8645_0    conda-forge
statsmodels               0.13.2           py38h71d37f0_0    conda-forge
tabix                     1.11                 hdfd78af_0    bioconda
threadpoolctl             3.1.0              pyh8a188c0_0    conda-forge
tk                        8.6.12               h27826a3_0    conda-forge
toml                      0.10.2             pyhd8ed1ab_0    conda-forge
tornado                   6.2              py38h0a891b7_0    conda-forge
tqdm                      4.64.1             pyhd8ed1ab_0    conda-forge
typing_extensions         4.4.0              pyha770c72_0    conda-forge
ucsc-bedtogenepred        377                  ha8a8165_3    bioconda
ucsc-genepredtobed        377                  ha8a8165_5    bioconda
ucsc-genepredtogtf        377                  ha8a8165_5    bioconda
ucsc-gff3togenepred       377                  ha8a8165_3    bioconda
ucsc-gtftogenepred        377                  ha8a8165_5    bioconda
unicodedata2              14.0.0           py38h0a891b7_1    conda-forge
unzip                     6.0                  h7f98852_3    conda-forge
url-normalize             1.4.3              pyhd8ed1ab_0    conda-forge
urllib3                   1.26.11            pyhd8ed1ab_0    conda-forge
weeder                    2.0                  h9f5acd7_6    bioconda
wget                      1.20.3               ha56f1ee_1    conda-forge
wheel                     0.37.1             pyhd8ed1ab_0    conda-forge
xdg                       5.1.1              pyhd8ed1ab_0    conda-forge
xorg-libxau               1.0.9                h7f98852_0    conda-forge
xorg-libxdmcp             1.1.3                h7f98852_0    conda-forge
xxhash                    0.8.0                h7f98852_3    conda-forge
xxmotif                   1.6                  h2d50403_2    bioconda
xz                        5.2.6                h166bdaf_0    conda-forge
yaml                      0.2.5                h7f98852_2    conda-forge
zipp                      3.10.0             pyhd8ed1ab_0    conda-forge
zlib                      1.2.13               h166bdaf_4    conda-forge
zstd                      1.5.2                h6239696_4    conda-forge
",IanCodes,https://github.com/vanheeringen-lab/gimmemotifs/issues/284
I_kwDOAApTRs5XAL90,set_genomes function in Scanner() cannot be passed additional arguments for class Genome,CLOSED,2022-11-22T11:18:06Z,2022-11-29T16:12:57Z,2022-11-29T16:12:56Z,"**Description of bug:**
When I initialize an object of class `Scanner()` and use the `set_genomes()` function on that object, I am unable to pass in a `genomes_dir` that is not either the default genomepy genomes directory or defined in the genomepy configuration file (under `genomes_dir`). This does not allow customizability if you are unable to run either of these options in a streamlined way.

**To reproduce:**
1. Install genomepy genome of your choosing (in my case, hg19) to a directory that is *not* `~/.local/share/genomes` (specified with the `--genomes_dir` flag)

`genomepy install --annotation hg19 --genomes_dir /path/to/alternate/genomes_dir`

2. Initialize an object of class Scanner() and set_genome() on this object

`from gimmemotifs.scanner import Scanner`
`scanner = Scanner()`
`scanner.set_genome(""hg19"")`

**Error:**

Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""/path/to/conda_env/nopeak-utils/lib/python3.8/site-packages/gimmemotifs/scanner.py"", line 1095, in set_genome
    Genome(genome)
  File ""/path/to/conda_env/nopeak-utils/lib/python3.8/site-packages/genomepy/genome/__init__.py"", line 51, in __init__
    self.genomes_dir = get_genomes_dir(genomes_dir, check_exist=False)
  File ""/path/to/conda_env/nopeak-utils/lib/python3.8/site-packages/genomepy/utils.py"", line 50, in get_genomes_dir
    raise FileNotFoundError(""Please provide or configure a genomes_dir"")
FileNotFoundError: Please provide or configure a genomes_dir

- currently, `set_genome()` only takes a single argument, which is the string associated with the genome build that is installed through `genomepy install`
- This should take all of the arguments that the class `Genome()` takes in order to increase customizability of the function `set_genome()` (for example: `genomes_dir` and additional `*args` and `**kwargs` for `Fasta` class)

**Installation information (please complete the following information):**
 - OS: Linux
 - Installation: conda
 - Version: gimmemotifs v0.17.2

**Additional context**
I have a plan to fix this and am currently working on it in a forked repository. I will submit a merge request once completed and reference this issue.
",roskamsh,https://github.com/vanheeringen-lab/gimmemotifs/issues/285
I_kwDOAApTRs5Xfdbd,xgboost dependency,CLOSED,2022-11-29T11:01:28Z,2023-01-11T12:48:14Z,2023-01-11T12:48:14Z,"When running gimme maelstrom (on a fresh gimme install), it will crash due to missing xgboost:

```
2022-11-29 11:54:29,527 - INFO - Starting maelstrom
2022-11-29 11:54:29,797 - INFO - Input is not mean-centered, setting the mean of all rows to 0.
2022-11-29 11:54:29,797 - INFO - Use --nocenter if you know what you're doing and want to change this behavior.
2022-11-29 11:54:29,797 - INFO - Note that if you use count data (ChIP-seq, ATAC-seq) we recommend to first transform your data, for instance using log2(), and to normalize between samples. To create a table suitable for maelstrom you can use the coverage_table script included with GimmeMotifs.
2022-11-29 11:54:31,817 - INFO - Counts, using: scANANSE/analysis/maelstrom/motif.count.txt.gz
2022-11-29 11:54:31,817 - INFO - Scores, using: scANANSE/analysis/maelstrom/motif.score.txt.gz
2022-11-29 11:55:00,524 - INFO - Selecting non-redundant motifs
2022-11-29 11:58:07,099 - INFO - Selected 238 motifs
2022-11-29 11:58:07,099 - INFO - Motifs: scANANSE/analysis/maelstrom/nonredundant.motifs.pfm
2022-11-29 11:58:07,099 - INFO - Factor mappings: scANANSE/analysis/maelstrom/nonredundant.motifs.motif2factors.txt
Traceback (most recent call last):
  File ""/vol/mbconda/jsmits/gimme_dev/bin/gimme"", line 7, in <module>
    exec(compile(f.read(), __file__, 'exec'))
  File ""/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/gimmemotifs/scripts/gimme"", line 11, in <module>
    cli(sys.argv[1:])
  File ""/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/gimmemotifs/gimmemotifs/cli.py"", line 754, in cli
    exit(1)
  File ""/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/gimmemotifs/gimmemotifs/commands/maelstrom.py"", line 34, in maelstrom
    run_maelstrom(
  File ""/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/gimmemotifs/gimmemotifs/maelstrom.py"", line 460, in run_maelstrom
    m = Moap.create(method, ncpus=ncpus)
  File ""/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/gimmemotifs/gimmemotifs/moap.py"", line 76, in create
    return cls._predictors[name.lower()](ncpus=ncpus)
  File ""/ceph/rimlsfnwi/data/moldevbio/zhou/jsmits/gimmemotifs/gimmemotifs/moap.py"", line 199, in __init__
    raise ImportError(""Optional dependency xgboost is required."")
ImportError: Optional dependency xgboost is required.
```
i guess it needs to be added (back?) within the gimme yaml",JGASmits,https://github.com/vanheeringen-lab/gimmemotifs/issues/286
I_kwDOAApTRs5XhBEz,gimme threshold error,CLOSED,2022-11-29T15:37:42Z,2023-01-11T12:48:15Z,2023-01-11T12:48:15Z,"https://github.com/vanheeringen-lab/gimmemotifs/blob/6205d503a74a74bfa83092b6c3fc1c73ea0c8466/gimmemotifs/commands/threshold.py#L23

Argument `filename` was removed from `Scanner.set_threshold()` ([four years ago](https://github.com/vanheeringen-lab/gimmemotifs/commit/2eb9637579abdec7c8e70eb3deca67b92c4693c9)).",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/287
I_kwDOAApTRs5YJy1Y,Push most recent version (0.17.2) to gimmemotifs,CLOSED,2022-12-06T12:16:43Z,2023-01-18T10:56:25Z,2023-01-18T10:56:25Z,"Hi there,

Is there any chance you could please push the most recent build of gimmemotifs (v0.17.2) to pypi? 

Thank you so much!
Breeshey",roskamsh,https://github.com/vanheeringen-lab/gimmemotifs/issues/290
I_kwDOAApTRs5ZqsCL,PerformanceWarning,OPEN,2022-12-20T10:53:54Z,2022-12-20T10:56:14Z,,"https://github.com/vanheeringen-lab/gimmemotifs/blob/ecd4806eff4567744016f96b596d72e25a006e4a/gimmemotifs/scanner/base.py#L422

the function `set_threshold` compiles columns for each motifs (at a FPR, for a specific background) into a single dataframe using the above code. This results in:

```
pandas/core/frame.py:3978: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  self._set_item(key, value)
```",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/297
I_kwDOAApTRs5Zxxqs,FutureWarning,OPEN,2022-12-21T12:26:06Z,2022-12-21T12:26:06Z,,"https://github.com/vanheeringen-lab/gimmemotifs/blob/ecd4806eff4567744016f96b596d72e25a006e4a/gimmemotifs/maelstrom/__init__.py#L235

throws
```
FutureWarning: Attribute `affinity` was deprecated in version 1.2 and will be removed in 1.4. Use `metric` instead
```

[Docs](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.FeatureAgglomeration.html) suggest it might be more than just changing the keyword. Might have to become `metric=scipy.metrics.distance.correlation`",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/298
I_kwDOAApTRs5ZyBk9,ConvergenceWarning,OPEN,2022-12-21T13:18:09Z,2022-12-21T13:37:14Z,,"maelstrom throws
```
ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
```

Possible sources:
- The warning likely originates from `LinearSVR`.
  https://github.com/vanheeringen-lab/gimmemotifs/blob/ecd4806eff4567744016f96b596d72e25a006e4a/gimmemotifs/maelstrom/moap.py#L591
- The location in the full log suggest it might originate from `_df_rank_aggregation`.

# Full log
```
2022-12-20 10:30:34 - INFO - Starting maelstrom
2022-12-20 10:30:34 - INFO - Input is not mean-centered, setting the mean of all rows to 0.
2022-12-20 10:30:34 - INFO - Use --nocenter if you know what you're doing and want to change this behavior.
2022-12-20 10:30:34 - INFO - Note that if you use count data (ChIP-seq, ATAC-seq) we recommend to first transform your data, for instance using log2(), and to normalize between samples. To create a table suitable for maelstrom you can use the coverage_table script included with GimmeMotifs.
2022-12-20 10:30:41 - INFO - motif scanning (counts)
2022-12-20 10:30:41 - INFO - reading table
2022-12-20 10:30:44 - INFO - setting threshold
2022-12-20 10:30:51 - INFO - creating count table
2022-12-20 10:37:27 - INFO - done
2022-12-20 10:37:27 - INFO - creating dataframe
2022-12-20 10:39:48 - INFO - motif scanning (scores)
2022-12-20 10:39:48 - INFO - reading table
2022-12-20 10:39:56 - INFO - creating score table (z-score, GC%)
2022-12-20 11:03:36 - INFO - done
2022-12-20 11:03:36 - INFO - creating dataframe
2022-12-20 11:28:25 - INFO - Selecting non-redundant motifs
2022-12-20 11:37:08 - INFO - Selected 585 motifs
2022-12-20 11:37:08 - INFO - Motifs: .../nonredundant.motifs.pfm
2022-12-20 11:37:08 - INFO - Factor mappings: .../nonredundant.motifs.motif2factors.txt
2022-12-20 11:37:19 - INFO - Fitting BayesianRidge
100%|██████████| 33/33 [06:14<00:00, 11.34s/it]
2022-12-20 11:43:36 - INFO - Done
2022-12-20 11:43:48 - INFO - Fitting XGBoostRegression
100%|██████████| 33/33 [1:00:42<00:00, 110.38s/it]
2022-12-20 12:44:33 - INFO - Done
2022-12-20 12:44:45 - INFO - Fitting MultiTaskLasso
2022-12-20 16:08:58 - INFO - Done
2022-12-20 16:09:10 - INFO - Fitting SVR
2022-12-20 19:12:30 - INFO - Done
2022-12-20 19:12:30 - INFO - Rank aggregation

.../site-packages/gimmemotifs/__init__.py:24: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  _warn(*args, **kwargs)
[warning repeats 32 more times ]

2022-12-20 19:12:32 - INFO - Correlation
2022-12-20 19:13:16 - INFO - html report
2022-12-20 19:19:12 - INFO - .../gimme.maelstrom.report.html
```",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/299
I_kwDOAApTRs5gyzvn,Segmentation fault on scan_all function,OPEN,2023-03-14T17:02:34Z,2023-03-22T11:37:08Z,,"**Describe the bug**
When I try to perform Motif.scan_all on HNF1A, I get segmentation fault

**To Reproduce**
Steps to reproduce the behavior:
1. Export whole genome sequence 
2. Take MA0046.2 jaspar
3. Run the following code, where mart_export.txt is gene sequence:
```
from gimmemotifs.motif import Motif,read_motifs
from gimmemotifs.fasta import Fasta
jaspar_motif_file = ""MA0046.2.jaspar""
motifs = read_motifs(jaspar_motif_file, fmt=""jaspar"")
f = Fasta(""mart_export.txt"")
m = motifs[0]
la = m.scan_all(f)
print(la)
```

**Expected behavior**
Predictions are printed out

**Error logs**
Process finished with exit code 139 (interrupted by signal 11: SIGSEGV)
",nikolamilosevic86,https://github.com/vanheeringen-lab/gimmemotifs/issues/302
I_kwDOAApTRs5k4Uzz,FR: support pandas 2,OPEN,2023-05-02T14:01:06Z,2023-05-02T14:01:06Z,,"In `gimmemotifs.report.py`, we use `pandas.io.formats.style.Styler.render()`. This function has been deprecated and is replaced with `pandas.io.formats.style.Styler.to_html()`. The new function does not work without tinkering (I tried a while ago and vaguely remember it would take some time, which I don't have). 

For now, I've pinned our pandas requirements to `>=1.3, <2`.
",siebrenf,https://github.com/vanheeringen-lab/gimmemotifs/issues/306
I_kwDOAApTRs5qBGvH,gimme motif2factors: No Orthologs Found for any factor in my custom organism genome,OPEN,2023-06-28T10:36:34Z,2023-07-05T10:45:34Z,,"Hi! I hope all is going good!

I am trying to run gimme motif2factors (v0.17.1, installed through conda/mamba) on  the genome of my organism to be able to run ANANSE. I set up a folder for a custom genome in `~/.local/share/genomes/MyOrganism` as I have previously done for other organisms on other occasions:

```
alberto@nostromo:~/.local/share/genomes/Smed$ ls -lha
total 205M
drwxrwxr-x  4 alberto alberto 4.0K Jun 28 11:30 .
drwxrwxr-x 16 alberto alberto 4.0K Jun 27 19:47 ..
-rw-rw-r--  1 alberto alberto 194M Jun  1 13:34 Smed.annotation.bed
lrwxrwxrwx  1 alberto alberto   78 Jun  1 13:10 Smed.annotation.gtf -> ~/projects/smed_cisreg/data/standard_references/schMedS3_h1.gtf
-rw-rw-r--  1 alberto alberto    0 Jun  1 16:47 Smed.blacklist.bed
lrwxrwxrwx  1 alberto alberto   71 Jun  1 13:10 Smed.fa ->  ~/DATA/dynamic/genomes/Smed/Rink/schMedS3/schMedS3_h1.fa
lrwxrwxrwx  1 alberto alberto   71 Jun  1 13:12 Smed.fa.fai -> ~/projects/dev/pipe/scbe_pipe/metadata/schmidtea.fa.fai
-rw-rw-r--  1 alberto alberto  12K Jun  1 13:30 Smed.fa.sizes
-rw-rw-r--  1 alberto alberto 4.6K Jun  1 13:40 Smed.gaps.bed
-rw-rw-r--  1 alberto alberto  12M Jun  1 18:14 Smed.pep.fa
-rw-rw-r--  1 alberto alberto  14K Jun  1 16:47 Smed.seq2scienceblacklist_complement_encode_mito.bed
-rw-rw-r--  1 alberto alberto    0 Jun  1 16:47 Smed.seq2scienceblacklist_encode_mito.bed
drwxrwxr-x  2 alberto alberto 4.0K Jun  1 16:50 genome_sizes
drwxrwxr-x  3 alberto alberto 4.0K Jun  1 16:47 index
```

In the process of trying to run motif2factors, I am getting the following issue. When trying the following: 

`gimme motif2factors --new-reference Smed --threads 12 --tmpdir temp --keep-intermediate`

I get the following:

```
19:52:23 | INFO | Making a new reference for: Smed.
19:52:23 | INFO | You say the gimme.vertebrate.v5.0 database is based on: GRCh38.p13 & GRCm38.p6.
19:52:23 | INFO | For better orthology inference we are also using these assemblies: danRer11 & UCB_Xtro_10.0 & GRCg6a & BraLan2 & oryLat2 & ARS-UCD1.2 & phaCin_unsw_v4.1 & rCheMyd1.pri.
19:52:23 | INFO | Using lenient strategy for orthology/name inference.
19:52:23 | INFO | genomes_dir: /mnt/sda/alberto/.local/share/genomes
19:52:23 | INFO | tmpdir: temp
19:52:23 | INFO | outdir: .
19:52:23 | INFO | Downloading all assemblies.
19:52:23 | INFO | BraLan2 was already downloaded, using that version.
19:52:23 | INFO | GRCh38.p13 was already downloaded, using that version.
19:52:23 | INFO | GRCm38.p6 was already downloaded, using that version.
19:52:23 | INFO | found pep.fa for Smed, using that one.
19:52:23 | INFO | danRer11 was already downloaded, using that version.
19:52:23 | INFO | rCheMyd1.pri was already downloaded, using that version.
19:52:23 | INFO | GRCg6a was already downloaded, using that version.
19:52:23 | INFO | phaCin_unsw_v4.1 was already downloaded, using that version.
19:52:23 | INFO | oryLat2 was already downloaded, using that version.
19:52:23 | INFO | UCB_Xtro_10.0 was already downloaded, using that version.
19:52:23 | INFO | ARS-UCD1.2 was already downloaded, using that version.
19:52:23 | INFO | Taking the longest protein per gene per assembly.
19:52:23 | INFO | Processing BraLan2.
19:52:31 | INFO | Processing GRCh38.p13.
19:52:31 | INFO | Processing GRCh38.p13.
19:53:21 | INFO | Processing GRCm38.p6.
19:53:51 | INFO | Processing Smed.
19:53:53 | INFO | Processing danRer11.
19:54:09 | INFO | Processing rCheMyd1.pri.
19:54:30 | INFO | Processing GRCg6a.
19:54:49 | INFO | Processing phaCin_unsw_v4.1.
19:55:15 | INFO | Processing oryLat2.
19:55:20 | INFO | Processing UCB_Xtro_10.0.
19:55:41 | INFO | Processing ARS-UCD1.2.
19:56:07 | INFO | Running orthofinder to find orthologs.
[...]
```

And Orthofinder runs well, but I get ` INFO |  No orthologs found for [...]`, for ALL the motifs in the database. Leading to a motif2factors.txt file where the column factor just says NO ORTHOLOGS FOUND. First I tried adding more species from genomepy in case of poor phylogenetic signal to transfer TF annotation to the genome of my organism, but this did not work either (I got the same result).

```
$ wc -l Smed.gimme.vertebrate.v5.0.motif2factors.txt 
1797 Smed.gimme.vertebrate.v5.0.motif2factors.txt
$ grep ""NO ORTHOLOGS FOUND"" Smed.gimme.vertebrate.v5.0.motif2factors.txt | wc -l
1796 #first line of the table is column names hence 1 number difference
```

I have ran `motif2factors` several times in the past, with other genomes from other organisms, and I have never found this problem. What do you think might be happening here?

Cheers,
Alberto
",apposada,https://github.com/vanheeringen-lab/gimmemotifs/issues/307
I_kwDOAApTRs6CeTPS,Exception on motif enrichment analysis,OPEN,2024-03-15T16:06:05Z,2024-03-15T16:06:05Z,,"**Describe the bug**
I'm currently preparing a motif enrichment analysis. Preliminarily, I wanted to test the enrichment on just a single gene, but the program terminates prematurely.

**To Reproduce**
Steps to reproduce the behavior:
```
$ gimme motifs IFIH1.fasta -p consensus_pwms_stripped.jaspar gimme_out -g Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa -f 0.99 --known -N 36
```
IFIH1.fasta and consensus_pwms_stripped.jaspar are attached: [consensus_pwms_stripped.zip](https://github.com/vanheeringen-lab/gimmemotifs/files/14617909/consensus_pwms_stripped.zip)
[IFIH1.zip](https://github.com/vanheeringen-lab/gimmemotifs/files/14617910/IFIH1.zip)
Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa can be downloaded from 
[here](https://ftp.ensembl.org/pub/release-111/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz).


**Expected behavior**
I expected the program to run in full or to provide a concise error message.

**Error logs**
```
2024-03-15 15:58:49,937 - WARNING - Will use the sequences from the FASTA input. If size is specified, this will be ignored.
2024-03-15 15:58:49,938 - INFO - creating background (matched GC%)
2024-03-15 16:00:17,614 - INFO - creating motif scan tables
Scanning: 100%|████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.18 sequences/s]Scanning: 100%|████████████████████████████████████████████████████████████████████████| 9992/9992 [00:01<00:00, 7159.13 sequences/s]
2024-03-15 16:00:20,133 - INFO - calculating stats
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: FitFailedWarning:
1 fits failed out of a total of 5.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/model_selection/_validation.py"", line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/base.py"", line 1474, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py"", line 1221, in fit
    self.coef_, self.intercept_, self.n_iter_ = _fit_liblinear(
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/svm/_base.py"", line 1174, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0.0

  _warn(*args, **kwargs)
2024-03-15 16:00:22,278 - INFO - selecting non-redundant motifs
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: FitFailedWarning:
1 fits failed out of a total of 5.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/model_selection/_validation.py"", line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/base.py"", line 1474, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py"", line 1221, in fit
    self.coef_, self.intercept_, self.n_iter_ = _fit_liblinear(
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/svm/_base.py"", line 1174, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0.0

  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: FitFailedWarning:
1 fits failed out of a total of 5.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/model_selection/_validation.py"", line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/base.py"", line 1474, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py"", line 1221, in fit
    self.coef_, self.intercept_, self.n_iter_ = _fit_liblinear(
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/svm/_base.py"", line 1174, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0.0

  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: FitFailedWarning:
1 fits failed out of a total of 5.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/model_selection/_validation.py"", line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/base.py"", line 1474, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py"", line 1221, in fit
    self.coef_, self.intercept_, self.n_iter_ = _fit_liblinear(
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/svm/_base.py"", line 1174, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0.0

  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: The least populated class in y has only 1 members, which is less than n_splits=5.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: FitFailedWarning:
1 fits failed out of a total of 5.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/model_selection/_validation.py"", line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/base.py"", line 1474, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py"", line 1221, in fit
    self.coef_, self.intercept_, self.n_iter_ = _fit_liblinear(
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/svm/_base.py"", line 1174, in _fit_liblinear
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0.0

  _warn(*args, **kwargs)
/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/__init__.py:30: UserWarning: No positive class found in y_true, recall is set to one for all thresholds.
  _warn(*args, **kwargs)
Traceback (most recent call last):
  File ""/home/mabe/.conda/envs/mabe/bin/gimme"", line 12, in <module>
    cli(sys.argv[1:])
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/cli.py"", line 755, in cli
    args.func(args)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/commands/motifs.py"", line 240, in motifs
    nr_motifs = select_nonredundant_motifs(
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/comparison.py"", line 944, in select_nonredundant_motifs
    roc_auc = roc_auc_score(y_test, y_pred)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/utils/_param_validation.py"", line 213, in wrapper
    return func(*args, **kwargs)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/metrics/_ranking.py"", line 640, in roc_auc_score
    return _average_binary_score(
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/metrics/_base.py"", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/metrics/_ranking.py"", line 382, in _binary_roc_auc_score
    raise ValueError(
ValueError: Only one class present in y_true. ROC AUC score is not defined in that case.
```

**Installation information (please complete the following information):**
 - OS: [Ubuntu 22.04.4 LTS]
 - Installation [conda]
 - Version [0.18.0]

**Additional context**
As I am new to the software, this might as well be an error on my side. Still, I think that the error message should be better!
",Mitmischer,https://github.com/vanheeringen-lab/gimmemotifs/issues/311
I_kwDOAApTRs6Ckloc,Exception on differential enrichment,OPEN,2024-03-17T12:00:57Z,2024-05-02T12:51:38Z,,"**Describe the bug**
In order to perform differential enrichment, I wanted to try on a single gene, but gimme crashes.

**To Reproduce**
Steps to reproduce the behavior:
```
gimme maelstrom -N120 IFIH1.fasta Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa /tmp/maelstrom_out
```
IFIH1.fasta is attached: [IFIH1.fasta.txt](https://github.com/vanheeringen-lab/gimmemotifs/files/14627236/IFIH1.fasta.txt)

Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa can be downloaded from 
[here](https://ftp.ensembl.org/pub/release-111/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz).

**Expected behavior**
I expected the program to run in full or to provide a concise error message.

**Error logs**
```
2024-03-17 11:07:42,884 - INFO - Starting maelstrom                                                                                                                                                                        2024-03-17 11:07:42,890 - INFO - motif scanning (counts)                                                                                          
2024-03-17 11:07:42,890 - INFO - reading table                                                                                                                                 
2024-03-17 11:07:45,717 - INFO - using 14000 sequences                                                                                            
2024-03-17 11:08:34,427 - INFO - setting threshold                                                                                                
Determining FPR-based threshold: 100%|██████████████████████████████████████████████████████████████| 10633/10633 [12:40<00:00, 13.98 sequences/s]
2024-03-17 11:21:23,647 - INFO - creating count table                                                                                             
Scanning: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:09<00:00,  9.37s/ sequences]
2024-03-17 11:21:33,022 - INFO - done                                                                                                             
2024-03-17 11:21:33,022 - INFO - creating dataframe                                                                                               
2024-03-17 11:21:33,435 - INFO - motif scanning (scores)                                                                                          
2024-03-17 11:21:33,435 - INFO - reading table                                                                                                    
2024-03-17 11:21:39,620 - INFO - using 14000 sequences                                                                                            
2024-03-17 11:22:13,126 - INFO - creating score table (z-score, GC%)                                                                              
Determining mean and stddev for motifs: 100%|██████████████████████████████████████████████████████████| 19756/19756 [11:18<00:00, 29.13 motifs/s]             
Scanning: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:05<00:00,  5.55s/ sequences]
2024-03-17 11:33:43,722 - INFO - done                                                                                                                                          
2024-03-17 11:33:43,722 - INFO - creating dataframe                                                                                               
2024-03-17 11:33:44,235 - INFO - Selecting non-redundant motifs                                                                                   
Traceback (most recent call last):                                                                                                                
  File ""/home/mabe/.conda/envs/mabe/bin/gimme"", line 12, in <module>                                                                                                           
    cli(sys.argv[1:])                                                                                                                                          
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/cli.py"", line 755, in cli                                                                         
    args.func(args)                                                                                                                                                            
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/commands/maelstrom.py"", line 42, in maelstrom                                                                                                 
    run_maelstrom(                                                                                                                                                                                 
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/gimmemotifs/maelstrom/__init__.py"", line 239, in run_maelstrom                                                
    fa.fit(scores)                                                                                                                                                             
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/base.py"", line 1474, in wrapper                                                                                                                   
    return fit_method(estimator, *args, **kwargs)                                                                                                                              
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/cluster/_agglomerative.py"", line 1329, in fit                                                                             
    super()._fit(X.T)                                                                                                                                                          
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/cluster/_agglomerative.py"", line 1066, in _fit                                                                            
    out = memory.cache(tree_builder)(                                                            
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/joblib/memory.py"", line 353, in __call__                                                                                          
    return self.func(*args, **kwargs)                                                                                                                                                                                      
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/cluster/_agglomerative.py"", line 706, in _complete_linkage                                                                                        
    return linkage_tree(*args, **kwargs)                                                                                                                                                                                   
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/sklearn/cluster/_agglomerative.py"", line 585, in linkage_tree                                                                                             
    out = hierarchy.linkage(X, method=linkage, metric=affinity)                                                                                                                                                            
  File ""/home/mabe/.conda/envs/mabe/lib/python3.10/site-packages/scipy/cluster/hierarchy.py"", line 1030, in linkage                                                                                                            raise ValueError(""The condensed distance matrix must contain only ""                                                                                                                                                    
ValueError: The condensed distance matrix must contain only finite values.
```

**Installation information (please complete the following information):**
 - OS: [Ubuntu 22.04.4 LTS]
 - Installation [conda]
 - Version [0.18.0]

**Additional context**
As I am new to the software, this might as well be an error on my side (or maybe the statistics just doesn't work out on a single gene) . Still, I think that the error handling/error message should be better!
",Mitmischer,https://github.com/vanheeringen-lab/gimmemotifs/issues/312
I_kwDOAApTRs6DAYMR,Incompatibility with certain common PWM files,OPEN,2024-03-20T16:01:28Z,2024-03-20T16:01:28Z,,"**Describe the bug**
`gimme scan` appears to be incompatible with custom PWMs that have spaces in the motif description. Note that JASPAR itself returns files that are formatted like this, for example: https://jaspar.elixir.no/api/v1/matrix/MA0002.1.jaspar . My motif database has those spaces, too.

**To Reproduce**
See error logs.

**Expected behavior**
gimme should support PWM files with spaces in the motif description (or give more helpful error messages).

**Error logs**
I reproduced the behaviour for two input files:
```
$ gimme scan in/IFIH1.fasta -g ../reference_dbs/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa -p ../5/in2/consensus_pwms_stripped.jaspar
# GimmeMotifs version 0.18.0
# Input: in/IFIH1.fasta
# Motifs: ../5/in2/consensus_pwms_stripped.jaspar
# FPR: 0.01 (../reference_dbs/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa)
# Scoring: logodds score
Scanning:   0%|                                                                                                                                                                                                                                                                                | 0/1 [00:00<?, ? sequences/s]
Traceback (most recent call last):
  File ""/home/mabe/.conda/envs/memegimme/bin/gimme"", line 12, in <module>
    cli(sys.argv[1:])
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/cli.py"", line 755, in cli
    args.func(args)
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/commands/pfmscan.py"", line 20, in pfmscan
    scan_to_file(
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/__init__.py"", line 402, in scan_to_file
    for line in command_scan(
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/__init__.py"", line 287, in command_scan
    for row in it:
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/__init__.py"", line 224, in scan_normal
    for i, result in enumerate(result_it):
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/base.py"", line 573, in scan
    for result in it:
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/base.py"", line 637, in _scan_sequences
    motifs = [(m, thresholds[m.id]) for m in read_motifs(self.motifs)]
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/base.py"", line 637, in <listcomp>
    motifs = [(m, thresholds[m.id]) for m in read_motifs(self.motifs)]
KeyError: 'AC0081:NFIA_NFIC:SMAD AC0081:NFIA/NFIC:SMAD'
Scanning:   0%|   
```

```
$ gimme scan in/IFIH1.fasta -g ../reference_dbs/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa -p ../5/in2/consensus_pwms.jaspar
2024-03-20 15:57:51,945 - WARNING - multiple motifs with same id: AC0001:GATA_PROP:GATA AC0001:GATA/PROP:GATA
<....SNIP....>
2024-03-20 15:57:53,062 - WARNING - multiple motifs with same id: AC0637:AHR:bHLH AC0637:AHR:bHLH
# GimmeMotifs version 0.18.0
# Input: in/IFIH1.fasta
# Motifs: ../5/in2/consensus_pwms.jaspar
# FPR: 0.01 (../reference_dbs/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa)
# Scoring: logodds score
2024-03-20 15:57:53,302 - WARNING - multiple motifs with same id: AC0001:GATA_PROP:GATA AC0001:GATA/PROP:GATA
2024-03-20 15:57:53,304 - WARNING - multiple motifs with same id: AC0002:PROP_ALX:Homeodomain AC0002:PROP/ALX:Homeodomain
2024-03-20 15:57:53,306 - WARNING - multiple motifs with same id: AC0003:HNF1A_HNF1B:Homeodomain AC0003:HNF1A/HNF1B:Homeodomain
2024-03-20 15:57:53,308 - WARNING - multiple motifs with same id: AC0004:ZSCAN:C2H2_ZF AC0004:ZSCAN:C2H2_ZF
2024-03-20 15:57:53,310 - WARNING - multiple motifs with same id: AC0005:POU3F_POU1F:Homeodomain,POU AC0005:POU3F/POU1F:Homeodomain,POU
2024-03-20 15:57:53,311 - WARNING - multiple motifs with same id: AC0006:MEOX:Homeodomain AC0006:MEOX:Homeodomain
2024-03-20 15:57:53,313 - WARNING - multiple motifs with same id: AC0007:BARX_NKX:Homeodomain AC0007:BARX/NKX:Homeodomain
2024-03-20 15:57:53,315 - WARNING - multiple motifs with same id: AC0008:VENTX:Homeodomain AC0008:VENTX:Homeodomain
2024-03-20 15:57:53,316 - WARNING - multiple motifs with same id: AC0009:PAX_VSX:Homeodomain AC0009:PAX/VSX:Homeodomain
<....SNIP....>
2024-03-20 15:57:59,796 - WARNING - multiple motifs with same id: AC0637:AHR:bHLH AC0637:AHR:bHLH
Traceback (most recent call last):
  File ""/home/mabe/.conda/envs/memegimme/bin/gimme"", line 12, in <module>
    cli(sys.argv[1:])
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/cli.py"", line 755, in cli
    args.func(args)
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/commands/pfmscan.py"", line 20, in pfmscan
    scan_to_file(
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/__init__.py"", line 402, in scan_to_file
    for line in command_scan(
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/__init__.py"", line 287, in command_scan
    for row in it:
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/__init__.py"", line 224, in scan_normal
    for i, result in enumerate(result_it):
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/base.py"", line 573, in scan
    for result in it:
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/base.py"", line 636, in _scan_sequences
    thresholds = self.get_gc_thresholds(seqs, zscore=zscore)
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/gimmemotifs/scanner/base.py"", line 605, in get_gc_thresholds
    maxt = pd.Series([m.max_score for m in motifs], index=_threshold.columns)
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/pandas/core/series.py"", line 461, in __init__
    com.require_length_match(data, index)
  File ""/home/mabe/.conda/envs/memegimme/lib/python3.10/site-packages/pandas/core/common.py"", line 571, in require_length_match
    raise ValueError(
ValueError: Length of values (1274) does not match length of index (1273)
```

The pwm files are attached: [consensus_pwms.zip](https://github.com/vanheeringen-lab/gimmemotifs/files/14669210/consensus_pwms.zip) . Without specifying my own matrices, it works.

**Installation information (please complete the following information):**
 - OS: [Ubuntu 22.04.4 LTS]
 - Installation [conda]
 - Version [0.18.0]


**Additional context**


Add any other context about the problem here.
",Mitmischer,https://github.com/vanheeringen-lab/gimmemotifs/issues/313
I_kwDOAApTRs6Dwqkq,Gimme maelstrom didn't work with custom pfm file,OPEN,2024-03-27T11:37:03Z,2024-03-27T11:37:03Z,,"**Describe the bug**
Hi Simon,
when I run Gimme maelstrom with my custom .pfm file , an error appear at the beginning of the analysis. Strangely, the standard  gimme motifs analysis with the same .pfm didn't give any problem after several runs. 

**To Reproduce**
gimme maelstrom -p ${PFM_FILE} ${INPUT_TABLE} ${GENOME_PATH} ${OUTPUT_DIR}
rm -r /.../tempfiles/cache/gimmemotifs

**Expected behavior**

**Error logs**
The following log messages appear:
2024-03-27 10:18:11,629 - INFO - Starting maelstrom
2024-03-27 10:18:11,651 - INFO - Input is not mean-centered, setting the mean of all rows to 0.
2024-03-27 10:18:11,652 - INFO - Use --nocenter if you know what you're doing and want to change this behavior.
2024-03-27 10:18:11,652 - INFO - Note that if you use count data (ChIP-seq, ATAC-seq) we recommend to first transform your data, for instance using log2(), and to normalize between samples. To create a table suitable for maelstrom you can use the coverage_table script included with GimmeMotifs.
2024-03-27 10:18:11,921 - INFO - motif scanning (counts)
2024-03-27 10:18:11,921 - INFO - reading table
2024-03-27 10:18:35,794 - WARNING - multiple motifs with same id: ATF1_HUMAN.H11MO.0.B
2024-03-27 10:18:44,367 - INFO - using 14000 sequences
2024-03-27 10:18:44,404 - INFO - Creating index for genomic GC frequencies.
2024-03-27 10:27:06,498 - INFO - setting threshold
2024-03-27 10:27:06,608 - WARNING - multiple motifs with same id: ATF1_HUMAN.H11MO.0.B
Traceback (most recent call last):
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/bin/gimme"", line 12, in <module>
    cli(sys.argv[1:])
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/lib/python3.10/site-packages/gimmemotifs/cli.py"", line 755, in cli
    args.func(args)
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/lib/python3.10/site-packages/gimmemotifs/commands/maelstrom.py"", line 42, in maelstrom
    run_maelstrom(
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/lib/python3.10/site-packages/gimmemotifs/maelstrom/__init__.py"", line 192, in run_maelstrom
    counts = scan_regionfile_to_table(
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/lib/python3.10/site-packages/gimmemotifs/scanner/__init__.py"", line 154, in scan_regionfile_to_table
    s.set_threshold(fpr=FPR)
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/lib/python3.10/site-packages/gimmemotifs/scanner/base.py"", line 438, in set_threshold
    cache.set(k, df[motif.id])
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/lib/python3.10/site-packages/diskcache/core.py"", line 796, in set
    with self._transact(retry, filename) as (sql, cleanup):
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/lib/python3.10/contextlib.py"", line 135, in __enter__
    return next(self.gen)
  File ""/hpcnfs/data/GN2/fgandolfi/.conda/envs/gimmeMotifsEnv/lib/python3.10/site-packages/diskcache/core.py"", line 730, in _transact
    raise Timeout from None
  diskcache.core.Timeout


**Installation information (please complete the following information):**
 - OS: Linux CentOS 7
 - Installation Conda Environment
 - Version 4.9.2

**Additional context**
The gimme maelstrom analysis works fine when the custom .pfm file is not provided (i.e.: the default gimme motif database of pwms is used), so I guess some issue related to the custom pfm used 

Thanks a lot in advance


Francesco
",Francis3209,https://github.com/vanheeringen-lab/gimmemotifs/issues/314
I_kwDOAApTRs6EhipX,FYI: SafeConfigParser in versioneer not compatible with Python 3.12,OPEN,2024-04-03T16:30:06Z,2024-05-30T10:39:48Z,,"Python 3.12 removed the `SafeConfigParser` class:
https://docs.python.org/3.12/whatsnew/3.12.html#configparser

The `versioneer.py` file included in your repo is therefore not compatible with Python 3.12. Just something to keep in mind as time goes on.",laserson,https://github.com/vanheeringen-lab/gimmemotifs/issues/315
I_kwDOAApTRs6Hr9fh,Gimmemotif motif scan 'score' metric,OPEN,2024-05-02T20:46:52Z,2024-05-02T20:46:52Z,,"Hello dev team, 

Thanks for the tool. I am running gimmemotif scan. I would like to know how the 'score' is calculated? 
At first I thought each motif has a score. I looked at specific motif_ids and in the following ss, we have three different motifs (summation of motifs in factors_direct and factors_indirect) and four scores.
![Screenshot 2024-05-02 at 1 22 11 PM](https://github.com/vanheeringen-lab/gimmemotifs/assets/83424513/78555a30-0d35-4bf7-a7eb-1a0646c3a8a2)

In here, we have one motif TF in the factors_indirect but we have two scores associated with it. How should we interpret the results? 
![Screenshot 2024-05-02 at 1 40 43 PM](https://github.com/vanheeringen-lab/gimmemotifs/assets/83424513/1517f926-9b6a-4fd5-a8fb-6022885bd3e5)

Thanks!
",momur,https://github.com/vanheeringen-lab/gimmemotifs/issues/316
I_kwDOAApTRs6KahtZ,Supporting for metagenomic data,OPEN,2024-05-29T02:12:58Z,2024-05-29T02:12:58Z,,"**Is your feature request related to a problem? Please describe.**
As a researcher working with metagenomic data, I'm constantly faced with the challenge of identifying transcription factor binding motifs across diverse microbial communities. The lack of dedicated tools tailored for analyzing such complex datasets often leads to suboptimal results and hinders our understanding of gene regulatory networks in microbiomes. GimmeMotifs, with its comprehensive motif analysis capabilities, holds great potential for enhancing metagenomic studies, but currently lacks direct support for handling and interpreting mixed species data, which is my primary frustration.

**Describe the solution you'd like**
I would like GimmeMotifs to incorporate a new module or extend its existing pipeline to specifically handle and analyze metagenomic datasets. This could involve implementing algorithms that can deconvolute signals from multiple species, allowing for the separate identification of transcription factor binding motifs for each species present in the sample. Additionally, integration of taxonomic classification tools could help in attributing discovered motifs to their respective taxa, enhancing the biological interpretability of the results. Support for handling uneven sequence coverage and potential sequence biases due to varying genome abundances within the community would also be crucial.

**Describe alternatives you've considered**
I have explored using other motif finding tools like HOMER and MEME Suite, which offer some level of flexibility in analyzing diverse sequence data. However, they too lack specialized functionalities for metagenomics and often require extensive preprocessing and postprocessing steps to accommodate mixed species data. Developing custom scripts and workflows has been another approach, but this is time-consuming and prone to errors without the robust validation and optimization provided by established software like GimmeMotifs.

**Additional context**
Given the rapid advancements in metagenomics and the growing interest in understanding the functional roles of transcription factors in microbial ecosystems, extending GimmeMotifs to cater to this domain would significantly broaden its user base and scientific impact. It would be invaluable if the tool could not only identify motifs but also provide visualizations and statistical measures to assess the significance of motif enrichment across different taxa, enabling researchers to draw more informed conclusions about regulatory patterns in complex microbial communities.",OtaviaW,https://github.com/vanheeringen-lab/gimmemotifs/issues/317
I_kwDOAApTRs6MbIcN,Maelstrom: uninformative error when duplicate regions present,OPEN,2024-06-16T18:49:00Z,2024-06-16T18:49:00Z,,"Hi there,

I ran into the following error when I tried running maelstrom with a file containing identical regions (with different labels). It took quite a while to track down this error, so a more helpful error message would be good. Or you could put explicit instructions not to use duplicate entries on the tutorial site

`
2024-06-16 13:39:27,642 - INFO - Starting maelstrom
2024-06-16 13:39:28,107 - INFO - motif scanning (counts)
2024-06-16 13:39:28,108 - INFO - reading table
2024-06-16 13:39:37,351 - INFO - using 14000 sequences
2024-06-16 13:39:37,369 - INFO - Creating index for genomic GC frequencies.
2024-06-16 13:43:26,698 - INFO - setting threshold
2024-06-16 13:45:09,928 - INFO - creating count table
2024-06-16 14:00:08,540 - INFO - done
2024-06-16 14:00:08,547 - INFO - creating dataframe
Traceback (most recent call last):
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/bin/gimme"", line 12, in <module>
    cli(sys.argv[1:])
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/cli.py"", line 755, in cli
    args.func(args)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/commands/maelstrom.py"", line 42, in maelstrom
    run_maelstrom(
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/maelstrom/__init__.py"", line 192, in run_maelstrom
    counts = scan_regionfile_to_table(
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/scanner/__init__.py"", line 180, in scan_regionfile_to_table
    df = pd.DataFrame(scores, index=idx, columns=motif_names, dtype=dtype)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/pandas/core/frame.py"", line 754, in __init__
    mgr = arrays_to_mgr(
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/pandas/core/internals/construction.py"", line 123, in arrays_to_mgr
    arrays = _homogenize(arrays, index, dtype)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/pandas/core/internals/construction.py"", line 620, in _homogenize
    com.require_length_match(val, index)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/pandas/core/common.py"", line 571, in require_length_match
    raise ValueError(
ValueError: Length of values (235020) does not match length of index (235653)
`

**Installation information :**
 - OS: Linux
 - Installation conda
 - Version [e.g. 0.18.0]
 

",shaunmahony,https://github.com/vanheeringen-lab/gimmemotifs/issues/318
I_kwDOAApTRs6McwoI,Maelstrom: failing during MultiTaskLasso,CLOSED,2024-06-17T04:42:00Z,2024-06-17T12:26:25Z,2024-06-17T12:26:24Z,"Maelstrom is failing during the MultiTaskLasso step. Error produced as follows. 

```
2024-06-16 23:11:52,642 - INFO - BioProspector no longer found.
2024-06-16 23:11:52,653 - INFO - MDmodule no longer found.
2024-06-16 23:11:52,655 - INFO - Posmo no longer found.
2024-06-16 23:11:52,657 - INFO - Using included version of BioProspector.
2024-06-16 23:11:52,716 - INFO - Using included version of MDmodule.
2024-06-16 23:11:52,717 - INFO - Using included version of Posmo.
2024-06-16 23:11:52,731 - INFO - Configuration file: /storage/home/sam77/.config/gimmemotifs/gimmemotifs.cfg
2024-06-16 23:11:53,249 - INFO - Starting maelstrom
2024-06-16 23:11:53,435 - INFO - motif scanning (counts)
2024-06-16 23:11:53,435 - INFO - reading table
2024-06-16 23:12:00,664 - INFO - using 14000 sequences
2024-06-16 23:12:00,676 - INFO - Creating index for genomic GC frequencies.
2024-06-16 23:15:49,417 - INFO - setting threshold
2024-06-16 23:17:24,238 - INFO - creating count table
2024-06-16 23:22:29,762 - INFO - done
2024-06-16 23:22:29,774 - INFO - creating dataframe
2024-06-16 23:23:34,960 - INFO - motif scanning (scores)
2024-06-16 23:23:34,966 - INFO - reading table
2024-06-16 23:23:44,026 - INFO - creating score table (z-score, GC%)
2024-06-16 23:46:50,436 - INFO - done
2024-06-16 23:46:50,445 - INFO - creating dataframe
2024-06-17 00:01:38,037 - INFO - Selecting non-redundant motifs
2024-06-17 00:07:43,782 - INFO - Selected 559 motifs
2024-06-17 00:07:43,783 - INFO - Motifs: maelstrom_out/all-cisbpmotifs/nonredundant.motifs.pfm
2024-06-17 00:07:43,783 - INFO - Factor mappings: maelstrom_out/all-cisbpmotifs/nonredundant.motifs.motif2factors.txt
2024-06-17 00:07:51,287 - INFO - Fitting BayesianRidge
0it [00:00, ?it/s]
2024-06-17 00:07:53,011 - INFO - Done
2024-06-17 00:08:00,230 - INFO - Fitting XGBoostRegression
0it [00:00, ?it/s]
2024-06-17 00:08:01,946 - INFO - Done
2024-06-17 00:08:09,159 - INFO - Fitting MultiTaskLasso
2024-06-17 00:08:11,507 - WARNING - Method multitasklasso with scoring score failed
2024-06-17 00:08:11,507 - WARNING - at least one array or dtype is required
2024-06-17 00:08:11,507 - WARNING - Skipping
Traceback (most recent call last):
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/bin/gimme"", line 12, in <module>
    cli(sys.argv[1:])
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/cli.py"", line 755, in cli
    args.func(args)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/commands/maelstrom.py"", line 42, in maelstrom
    run_maelstrom(
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/maelstrom/__init__.py"", line 351, in run_maelstrom
    _moap_with_table(
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/maelstrom/__init__.py"", line 452, in _moap_with_table
    moap(
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/maelstrom/moap.py"", line 760, in moap
    clf.fit(motifs, df)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/gimmemotifs/maelstrom/moap.py"", line 527, in fit
    model.fit(df_X, df_y)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/sklearn/base.py"", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/sklearn/pipeline.py"", line 476, in fit
    self._final_estimator.fit(Xt, y, **last_step_params[""fit""])
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/sklearn/linear_model/_coordinate_descent.py"", line 3212, in fit
    return super().fit(X, y, **params)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/sklearn/base.py"", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/sklearn/linear_model/_coordinate_descent.py"", line 1617, in fit
    X, y = self._validate_data(
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/sklearn/base.py"", line 648, in _validate_data
    y = check_array(y, input_name=""y"", **check_y_params)
  File ""/storage/home/sam77/work/software/miniconda3/envs/gimme/lib/python3.10/site-packages/sklearn/utils/validation.py"", line 882, in check_array
    dtype_orig = np.result_type(*dtypes_orig)
ValueError: at least one array or dtype is required
```

**Installation information:**
 - OS:  Linux
 - Installation conda
 - Version 0.18.0

**Additional context**
Input file is lines with the following format:
`chr17:76500201-76500401	Day0

chr14:94796951-94797151	Day0

chr2:108843948-108844148	Day0
`",shaunmahony,https://github.com/vanheeringen-lab/gimmemotifs/issues/319
I_kwDOAApTRs6Qkxt8,Cannot install package,OPEN,2024-07-23T15:56:43Z,2024-09-20T01:43:12Z,,"I cannot install gimmemotifs in my anaconda environment with pip, conda, or from source code. I get the same error regardless. Can someone please help? Thank you!


The error occurs here:
        building 'gimmemotifs.c_metrics' extension
Here is a printout of the error mesage:
gimmemotifs/c_metrics.c: In function 'get_truncate_len':
gimmemotifs/c_metrics.c:315:5: error: type of 'len1' defaults to 'int' [-Wimplicit-int]
  315 | int get_truncate_len(len1, len2, pos) {
      |     ^~~~~~~~~~~~~~~~
gimmemotifs/c_metrics.c:315:5: error: type of 'len2' defaults to 'int' [-Wimplicit-int]
gimmemotifs/c_metrics.c:315:5: error: type of 'pos' defaults to 'int' [-Wimplicit-int]
gimmemotifs/c_metrics.c: In function 'c_metrics_pwmscan':
gimmemotifs/c_metrics.c:564:16: warning: unused variable 'pwm_min' [-Wunused-variable]
  564 |         double pwm_min = -50;
      |                ^~~~~~~
gimmemotifs/c_metrics.c:563:13: warning: unused variable 'c' [-Wunused-variable]
  563 |         int c;
      |             ^
gimmemotifs/c_metrics.c: At top level:
gimmemotifs/c_metrics.c:901:22: error: initialization of 'int' from 'void *' makes integer from pointer without a cast [-Wint-conversion]
  901 |         {NULL, NULL, NULL, 0, NULL}
      |                      ^~~~
gimmemotifs/c_metrics.c:901:22: note: (near initialization for 'CoreMethods[4].ml_flags')
gimmemotifs/c_metrics.c:901:31: warning: excess elements in struct initializer
  901 |         {NULL, NULL, NULL, 0, NULL}
      |                               ^~~~
gimmemotifs/c_metrics.c:901:31: note: (near initialization for 'CoreMethods[4]')




",DrNamwob,https://github.com/vanheeringen-lab/gimmemotifs/issues/320
