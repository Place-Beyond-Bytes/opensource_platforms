commit_sha,commit_author_name,commit_author_email,commit_message,commit_date,login
f80cd7618636e44e3963f65625cea78c38a8d823,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges release-1.1.5 branch into master,2023-09-07T17:41:34Z,nawrockie
da9e3aae096f8ba8008a33999a88b1e2a8c4ac0e,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes page breaks in tutorial,2023-09-06T13:55:10Z,nawrockie
16fce9fd879a649923d2a57401bb792b59c560ac,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes ref to user guide in man page,2023-09-06T13:47:31Z,nawrockie
df4154139dd5e377cd0576416d0ec9a07cc42152,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes typo in cmalign man page,2023-09-06T13:35:29Z,nawrockie
14830716eb15ed1450417f25d6d0118d682fefa3,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes typos in man pages,2023-09-06T13:27:55Z,nawrockie
90eab9bfbe76569251fecde4a7f7732d386cc2c6,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Tweaks wording in release notes,2023-09-05T20:05:43Z,nawrockie
68df52e7eed3c6466e08b9dce003745c09a1b2f2,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Completes merge,2023-09-05T20:02:38Z,nawrockie
20cc72d572fd394c5ce1c53f7ff2501d9120ff3b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Final tweaks to 1.1.5 release notes,2023-09-05T20:02:09Z,nawrockie
2ee34bf814e5bb27d07b074646fe6ab6cb1b15ab,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes reference to infernal 1.1 as new,2023-09-05T19:08:42Z,nawrockie
f8fd35c93481c062aa6a726be455439a3fe0b988,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Tweaks to user guide

Bulk of changes are in install.tex, and are mirrored
after somewhat recent changes in the hmmer guide",2023-09-05T19:01:05Z,nawrockie
05710a0a2122f5991f786dc99ee0d02fd9ee3fda,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Bumps version to 1.1.5,2023-09-05T18:30:10Z,nawrockie
73cf6816b61dd4fe708fd1c9c2c9db729e1bf566,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Silences misleading indention compiler warnings

gcc 12.2.0 -Wall throws warnings if an if statement is misleadingly
indented to look like a statement is guarded by the if when it is not.
This commit fixes this by adding explicit { } to each if.",2023-09-05T18:09:45Z,nawrockie
7ae15e048b32e6192a90f31027ee46ef7d8639cc,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Silences gcc compiler snprintf warnings

Alignment displays string buffers are allocated carefully to have exactly the
number of necessary characters, which includes consensus positions in the annotation
of truncated begins/ends. This length (and corresponding number of chars) is computed
by the function, but gcc 12.2.0 on odyssey with --enable-debugging (-Wall) throws
a warning about strings potentially being truncated or out of range. I think this
is because the compiler doesn't realize the integer lengths are bounded (and can't
go as high as INTMAX for example). The way this commit silences the warnings is to
explicitly check the snprintf return value, and fail if it is not the expected value.",2023-09-05T18:02:07Z,nawrockie
32d85087e4bdd97c0ce02179a2a6c5d4d575bcb5,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Workaround for --enable-tsan failures

Adds --cpu 0 to two cmalign tests in dev_testsuite.sqc
that should fail (cmalign is expected to not finish and output error message)
because the thread sanitizer detects a thread leak, because a single thread
calls cm_Fail() when a matrix size exceeds the max allowed. I think this is
unavoidable without a major refactorization, so I'm sidestepping it by having
these tests run in serial (non-threaded) mode. Interestingly these two
tests only failed on mac os/x --enable-tsan builds, linux --enable-tsan
had them pass.",2023-09-05T13:59:28Z,nawrockie
2bea470dd24a15782901372ff0d9d7efeb8a3d0e,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes cmsearch --time* tests,2023-09-01T20:17:05Z,nawrockie
cf5d2122de7a864bceb7807301bb2445d7fd9c60,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates tutorial for 1.1.5,2023-09-01T20:15:17Z,nawrockie
66a0455527da98004e58355a7c46b2102289ca36,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Reorganizes user guide sections

Moves ""Some other topics"" section into introduction and tutorial.
This moves bug reporting info earlier in guide.' did not match any file(s) known to git",2023-09-01T18:14:53Z,nawrockie
caaf61f8b2e4f8c05749cc330f72288e1e039568,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Bumps version/date,2023-09-01T17:21:34Z,nawrockie
c4c16a12d90bc1b89592ae0fd860ea342e410d76,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Silences icx -Wall warnings

Two unused variable warnings",2023-09-01T15:58:33Z,nawrockie
ba7413527b88380fa8cdf227412069dc0a439f89,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Silences icx compiler warning

This fixes a mistake when initializing the cp9 HMM structure
of setting the begin and end probabilities from the 0th node to
to -INFTY (int). icx caught this as a implicit int to float
conversion. This should have been innocuous because the begin
and end probabilities from the 0th node are never used.",2023-09-01T15:45:05Z,nawrockie
30fdb99ae5a5624518afecd6a2e0a0147a9c3d53,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Silences icx compiler warning

Was mistakenly using p7_IMPOSSIBLE (an int) instead of -eslINFINITY
when checking for impossible dp mx value. icx caught this as an implicit
int to float conversion. This was a mistake but was innocuous because the
function it was in was experimental and not hooked up to anything.",2023-09-01T15:41:22Z,nawrockie
1e7dccbe97236b509a2f9ba6cb05aae906c0a084,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Replaces all sprintf() calls with snprintf()

Analogous to easel commit e6c56e4 and hmmer commit a705104.

Clang 14.0.3 throws warnings for all sprintf() calls. See the easel and
hmmer commit logs from Sean for details.

This commit replaces all sprintf() calls with snprintf() calls and
updates the FormatTimeString() function to take a buffer size
parameter.",2023-08-31T19:07:50Z,nawrockie
602228d79091992a765255844871df7ad28ff752,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Silences compiler warnings

Warnings reported on os/x intel with clang 14.0.3.",2023-08-31T17:53:47Z,nawrockie
f3636ffc44e02082ce13aca45d4fcdafc02dcf59,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes hacky symlink in hmmer/ to easel/formats/

This undoes a recent commit 7d42409 that added a conditional
symlink to configure that allowed two hmmer testsuite tests to pass
that would otherwise fail IF configuring from a directory other
than the top level (e.g. a build dir). Turns out that fix didn't
work if no top-level configure had been performed yet. Since it
doesn't always work and it was very hacky I decided to remove it.
These two hmmer testsuite tests will therefore fail if configuring
from a directory other than the top level infernal/ dir.",2023-08-31T17:00:08Z,nawrockie
48d689a03fd7849b336f9ead1fdaf55d1977e4ee,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Sets undefined status

To silence compiler warnings",2023-08-31T16:06:36Z,nawrockie
3e5f7719343f117e53ab90c77462674c184c4295,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Prefixes debug print with #

This prevents testsuite failure with --enable-mpi",2023-08-31T16:03:19Z,nawrockie
81a16ba08063adf49928ebef88704371acea2313,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes --time* cmsearch/cmscan exercises,2023-08-31T13:55:51Z,nawrockie
31fe5c38eec60d45a0400996eebca3f0051ca8c3,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Tweaks tutorial wording,2023-08-31T13:51:51Z,nawrockie
1465a1bc34b7d14cfbefbf9dee9b657a0a50da81,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds 1.1.5 release notes,2023-08-30T23:53:04Z,nawrockie
375dc34ed3cc3fae80e9cf5f7dbe34e845e3e361,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges hfp-errbuf-race2 branch into release-1.1.5,2023-08-30T22:37:27Z,nawrockie
0b426583e1a1cf8021e4b5ffd88f6489cca8bfa2,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes cmscan thread race related to CM_FILE errbuf

In cmscan, the master thread modifies cmfp->errbuf in cm_p7_oprofile_ReadMSV
and worker threads potentially modify cmfp->errbuf in cm_file_Read() if full CM is needed for
the final pipeline stages. Fix is to add a new msv_errbuf for exclusive use by cm_p7_oprofile_ReadMSV.
This is analogous to Sean's fix in hmmer to a similar thread race issue in hmmscan by the addition
of rr_errbuf to P7_HMMFILE (commit 3867dac, related to hmmer github issues #277 and #278).",2023-08-30T20:17:55Z,nawrockie
aa887ceb6dba36dd4662b933c51756c2c1ad2e47,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes cmscan thread race, in shared hmmfile errbuf

cmscan's master thread reads MSV profiles using p7_oprofile_ReadMSV()
 which uses P7_HMMFILE's errbuf. cmscan worker threads also (previously) used the same errbuf
(in cmfp->hfp->errbuf) if they progressed to the glocal envelope definition stage of
 cm_Pipeline() which requires the worker to read the full (general, non-optimized) HMM
from the HMM file which it needs because it configures it for glocal alignment which is
not possible with an optimized profile. The fix is to have infernal's read_{asc,bin}30hmm
functions (which are copies of the same functions from hmmer) to use the hfp->rr_errbuf
recently added by Sean to hmmer (commit 3867dac (related to hmmer github issues #277 and #278).
This works because previously neither cmscan master nor worker threads used rr_errbuf.",2023-08-30T20:00:16Z,nawrockie
ed7201f125310679ae60c918d57caa2935abfd26,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Silences compiler warnings,2023-08-30T15:16:03Z,nawrockie
bc86cdb62f598ae3b88816bec6698abb53916753,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Cleans up comments related to previous commit,2023-08-29T22:13:45Z,nawrockie
ad072eb67f0c52f65186071a25218acbb85ae74e,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes cmsearch race condition

The final chunk of the final sequence in a block was potentially being
reverse complemented before being copied. Travis actually fixed an analogous
race condition in nhmmer.c in 2013 (commit b3c27ff). The fix here is based
on his fix.",2023-08-29T20:16:00Z,nawrockie
38349c70f7803dca700d37283a7e559cc13770cf,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Silences compiler warnings (unused variables and misleading indentations),2023-08-29T20:11:54Z,nawrockie
7d42409bdb46f18f88caf21ed73278fe3124475f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds easel/formats symlink to hmmer/

This symlink is necessary to allow two hmmer testsuite tests that use files in easel/formats/ to pass when built as part of infernal and when the build directory and src directory are different. It may be easier in the future to just change the hmmer tests to not rely on files in easel/formats (by copying those files to hmmer/testsuite/) but for the infernal 1.1.5 release it is too late to make this change in hmmer because hmmer 3.4 was just released. I plan to make a hmmer PR after the 1.1.5 release to suggest the alternative.",2023-08-29T17:24:44Z,nawrockie
c54625e41498e25ef3b32f594997c623d0921a16,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges splittut branch into develop,2023-08-28T16:04:36Z,nawrockie
7187437f43bc61612ccc3fa24eac96351ac3517d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Improves err msg when cmscan run with uncalibrated model,2023-08-28T16:04:01Z,nawrockie
cae3b148ec1e59cd324c38419032869ef10ef351,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates tutorial on cmcalibrate split/merge,2023-08-28T16:03:10Z,nawrockie
200e53e4f89328dfd45b61e0c3c799c32e41ca14,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Improves error msg when cmsearch/cmscan run with uncalibrated model,2023-08-28T16:02:10Z,nawrockie
ffa0af83853aacd9b6f96d8bd197049e9d099a49,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges fragtut branch into develop (again),2023-08-25T23:01:13Z,nawrockie
eb239ad0bbd973649b5e375d756ec6ff6f7e8e1a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Final tweaks to tutorial on build frags,2023-08-25T23:00:23Z,nawrockie
5cf3c72efabbda6acb12271e079d9163561fa5f4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges asan branch into develop,2023-08-25T22:58:03Z,nawrockie
d538ad56e328d866b8f944268a52c6f3df2c1ba1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes memory leaks detected with --enable-asan,2023-08-25T22:57:36Z,nawrockie
cae40bc2c38958c52f789331e8123f02a129a718,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges develop branch into asan,2023-08-25T12:45:30Z,nawrockie
cad6bfa798039ebe3cde78da3b683187e897402c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges fragtut branch into develop,2023-08-25T12:45:05Z,nawrockie
7fdbece2d97b847371cab85bdf0a3674f247b137,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes memory leaks,2023-08-24T19:39:03Z,nawrockie
3596f93135ccbe15a0245743f261c09c2ad3debd,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes memory leak detected by --enable-asan,2023-08-24T19:14:41Z,nawrockie
019942310c75bd423abb5c261a3d14c301eb7b37,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes unused assign_fragments(),2023-08-24T19:12:10Z,nawrockie
32379d53dfc0d14099eaa8aaf078a98c712f56a3,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes memory leak,2023-08-24T19:11:31Z,nawrockie
735fc749a80aa1c10c5287909b15e53ff7376722,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes memory leak,2023-08-23T19:07:28Z,nawrockie
623b63f1ea51bed1de46082322f0682b28bca7e6,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges enable-tsan branch into develop,2023-08-23T18:01:24Z,nawrockie
c8fbe8d85f61ae6e7bbfde5ddd654ee6186b1cf9,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds missing """,2023-08-23T18:01:06Z,nawrockie
a5ea1e328dd6d111cc1303e45e4fff93e742ca1f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,More configure.ac tweaks to match hmmer,2023-08-23T17:57:41Z,nawrockie
e5030de9986d92eab004b3006ab095a05e99c6ea,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Makes configure.ac more consistent with hmmer's

Most important change is typo fix of -fsanitize=threads to -fsanitize=thread, which was preventing successul a ./configure with --enable-tsan",2023-08-23T17:27:39Z,nawrockie
7f519186d09007d37ee86e97a105acb53374633f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds draft of tutorial section on cmbuild frags,2023-08-22T22:38:32Z,nawrockie
da0a5740ae837d80c58e4f76ecc0d1f178ae06e8,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes debugging printf,2023-08-22T21:59:22Z,nawrockie
b3ecc330f2451bc7b3f2d32334b5568e2523af09,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges hand-consrf branch into develop,2023-08-22T21:18:39Z,nawrockie
db12b3a43edfcb9627aae6744a60bb8e05b31899,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds --consrf explanation to man page,2023-08-22T21:18:09Z,nawrockie
ef47b7bc240a5d9138355a1e3841c4d3ae12c5d0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Undoes last commit,2023-08-22T21:07:31Z,nawrockie
a1bdcdeaca4adbbc93a1d2b440cb13dc161956a3,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes RF line if identical to cons->cseq,2023-08-22T21:07:06Z,nawrockie
e3325f47acd8f245ee9827e8ad5a1fedb09da170,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes conflict,2023-08-22T19:12:01Z,nawrockie
d36cb62fc4307b8c33321b689ad570e0a668f630,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges anytrunc-mod branch into develop,2023-08-22T17:54:20Z,nawrockie
aba11530c519e935e5e2f7769f05de6ff6a9d682,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds footnote about change to --anytrunc,2023-08-22T16:08:17Z,nawrockie
95322b7c05b82532a1d321a2fb9f9839edb25b04,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds note about new --anytrunc behavior,2023-08-22T16:04:48Z,nawrockie
2e0be5b24e96cc6dd6a8227bde7276aa6c5d2466,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes hard-coded location of cm file

itest11-search-frags test script now uses path to required CM file that is relative to srcdir instead of needing to specify testsuite dir, which wasn't even being properly used to define the CM file location",2023-08-08T17:13:55Z,nawrockie
b300845d6305dfad3a37c89529e78dd74d7c3557,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes .cm.* index files prior to building cms

If an earlier test failed, it may have left a .cm.* index file that could screw up a subsequent test that didn't check for those files and remove them, because if you build a new foo.cm file but leave old foo.cm.* index files, programs will read the old index files instead of the new foo.cm file.",2023-08-08T15:01:20Z,nawrockie
be31cbb2a96b97631985a507849dbeeadb793077,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --cpu 1 for multithreaded program calls

This allows the test to pass after configure --enable-debugging. Previously per-thread debugging print statements could occur in different orders on subsequent calls causing diffs that expected no difference to fail.",2023-08-08T14:58:23Z,nawrockie
f43af24505052172f92953f3ceb7e44d112adb67,cryptogenomicon,sean@eddylab.org,"Changes all `#include ""{esl,p7}_config.h""` to `#include <{esl,p7}>_config.h>`

Fixes a problem when using both a source and a build tree, and the
compilation in the build tree includes the wrong autoconf config.h
file from the source tree; we need to be using #include <config.h>
not #include ""config.h"".

For more explanation, see log message for related Easel commit 3534b765.

(xref SRE:2023/0807-h3-config-include-conflict)",2023-08-07T15:02:19Z,cryptogenomicon
f8e008ffe24ee539500b0ff744aa635ab23f1d1d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges flankins branch into develop,2023-07-13T14:23:31Z,nawrockie
74b2877a50aeb116742e16356728b4caea23f6c0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Tweaks cmalign man page related to new --flank*ins options,2023-07-13T14:23:01Z,nawrockie
5c064e7d00e8acfb57faa50a901c09eb6b5486ca,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds test for --flank*ins options to dev_testsuite,2023-07-12T23:20:19Z,nawrockie
68abc25abb8503e751f28a5d06bf02836ce8970f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds documentation for --flanktoins and --flankselfins,2023-07-12T22:53:49Z,nawrockie
7aa8e8349dd7345252dbead217c33a920fd99e8f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Changes order of options,2023-07-12T22:53:24Z,nawrockie
7a9749da1a5f978082ff7b6e611a3fbf0c2725e4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Changes max sum value for --flanktoins and --flankselfins options to 0.95,2023-07-12T22:50:28Z,nawrockie
32dc2109be5471fee34653c79d0ec08271d6240b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --flanktoins, --flankselfins options",2023-07-12T22:40:17Z,nawrockie
8ca533de50c0fbf97090b5d95decd7bdee13fc76,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes --noh3pri related bug for github issue #36,2023-07-07T14:04:44Z,nawrockie
f26809c7db405723453241f252e371fda9862664,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges bug-iss35-take2 branch into develop,2023-06-06T19:51:28Z,nawrockie
7f87d8b44cf600e62db9f7326fb49e88f30df8ad,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes multiple issues with potential overflows of ints in dp matrix pointer arithmetic and initialization by replacing use of ints with int64_t. Partially 'fixes' the bug(s) that cause github issue #35, along with easel commit 9edb09 which also involves replacing ints with int64_ts",2023-06-06T19:50:39Z,nawrockie
8bc37a5e797ebed3ec8428125b2a5f908d3dcada,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges sanitize branch into develop,2023-06-01T17:47:30Z,nawrockie
07fa24f468020b3aedbbb77a4611de3e7f504a67,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds sanitizer options following from hmmer commit 97bb0e9,2023-06-01T17:45:44Z,nawrockie
5859be057fff638639f218d7e58d54d1bb47a748,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Changes cmsearch/cmscan --anytrunc behavior to also run 5', 3' and 5&3' 'force' pipeline passes. This obviates need for users to run both with and without --anytrunc and remove lower scoring overlaps, which I've been recommending for some applications. Adds --inttrunc which reproduces v1.1 to 1.1.4 --anytrunc behavior",2023-03-17T19:52:41Z,nawrockie
1c4e7ad651f6f1742c7942f31bb0e0c8c2200d5d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges develop branch into anytrunc-mod,2023-03-17T18:58:06Z,nawrockie
04340d31968faf970c4ac3713b3de8a457a337ef,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes now obsolete #defines,2023-03-17T18:57:34Z,nawrockie
e95cb35548df4ac85edc2b376a51bba5a8869b6c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags branch into develop,2023-03-17T15:17:16Z,nawrockie
2a0c476d1b27bc584b61320eded33e996033c2da,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-p2a-trunc branch into build-frags,2023-03-16T18:50:31Z,nawrockie
4e0a30118eed3351297c6163527abdbab46106b5,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-p2a-trunc-simpler-cmbuild branch into build-frags-p2a-trunc,2023-03-16T18:49:59Z,nawrockie
aff2310febc0801b8c0bb9dc4c4cba9a67a8695b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds new test script for cmsearch -A and cmbuild --fraggiven with fragment seqs,2023-03-16T18:48:33Z,nawrockie
fefcf89ece4e8d743f7e984215fd040abc805fa7,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Recombines assign_fragments and annotate_fragments into mark_fragments, the two separable steps no longer being necessary now that Parsetrees2Alignment() adds missing chars based on inferred truncation mode",2023-03-16T17:56:56Z,nawrockie
051e9654a08f7015576ae9bc583708ed0ff91a33,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Transmogrify() now determines if sequence is truncated 5' and/or 3' and sets parsetrees pass_idx accordingly,2023-03-16T15:18:09Z,nawrockie
97de4cf25d28e018855b520e9c81d261f8fba7ab,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds tests for new --*miss* options,2023-03-15T16:27:37Z,nawrockie
bc7464ddd3c2259d48726e5a33b9a5eb391fdd35,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,parstree coords correctly updated for missing data chars,2023-03-15T16:14:49Z,nawrockie
5efa7d6e68bd72357930430957dea14e0edd645f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Missing data chars added to truncated parsetrees in cm_alidisplay_BackConvert(),2023-03-15T16:13:38Z,nawrockie
a09541a907d87b6b738cb4c3e3d5cbc4d07ad3a3,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds description of new options related to truncated aligned seqs in Parsetrees2Alignment() to man pages,2023-03-14T17:35:08Z,nawrockie
d0c62c8bf7f313f12602ebf6fa2dd68ef0ac4e8b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds 'allow_trunc' flag to Parsetrees2Alignment() to control if ~ should be added to aligned seqs deriving from truncated parsetrees, and adds command-line options to executables for control",2023-03-14T17:34:20Z,nawrockie
a27fb61a2e049f984a2cdc5af9f832e1b14de9ec,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Moves new code to add ~ to truncated parsetrees to after re-justification of inserts,2023-03-14T15:14:44Z,nawrockie
9be8673c38a98312269a40f91a907cb16f913fe0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Parsetrees2Alignment() now adds ~ before/after first/final residue based on parsetree's is_std and pass_idx,2023-03-14T14:34:54Z,nawrockie
33bc950747e20546be934e7dc19fa384943c6a95,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-p2a-trunc into build-frags,2023-03-14T14:33:54Z,nawrockie
55a16756f6e6df308ba5398acb9d503064631765,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Transmogrify() sets is_std to 0 and pass_idx to 5' and 3' force for truncated parsetrees,2023-03-14T14:33:04Z,nawrockie
8aaba123409e450820135b19649c350e099d88e5,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Makes test script executable,2023-03-13T21:41:00Z,nawrockie
613a1e2ed818e6eced225165574f893a9cba1b85,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds itest10 to testsuite to exercise cmbuild --frag* options,2023-03-09T18:46:58Z,nawrockie
ec6ceb8729034aca3cdc0a365b30c9a994ae0e33,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds description of --frag* options,2023-03-09T16:56:28Z,nawrockie
2d4724f710632a6d0b416d2a4378fdc3654a6f6c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds tests to dev testsuite for new --frag* cmbuild options,2023-03-08T18:50:50Z,nawrockie
e54d35e02872557d851b611d152891fb72b02c63,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-fraggiven branch into build-frags,2023-03-08T18:32:36Z,nawrockie
3c15f91e2b44540968d3ec940f1b611456351772,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-rfpos branch into build-frags,2023-03-08T18:32:14Z,nawrockie
98f7f40cd62b5d8f71b7b1b58774f4b2dcb66264,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds --fraggiven option and check_fragments() function,2023-03-08T18:30:25Z,nawrockie
1c34e72ce6810e17be39a8bdb94b2db6c94690a6,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-rfpos branch into build-frags-fraggiven,2023-03-08T15:35:24Z,nawrockie
eff025ce8c83163f377251218727a387ab374670,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --fragnrfpos option, requires --hand for defining fragments based on how many consensus positions are missing 5' or 3'",2023-03-07T20:45:08Z,nawrockie
d76d88e0c76a42d6609451e76a8167df0859c33f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds AssignMatchColumnsForMsa() with code taken from HandModelMaker(),2023-03-07T20:44:31Z,nawrockie
38c209a924088922ac02e5b61adbdb14b7371e50,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-rfpos branch into build-frags,2023-03-07T19:49:40Z,nawrockie
2f1b0f19d24a12ced5cd7bf46529cb1bd3a62599,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates desc of --fragthresh option, fixes typo",2023-03-07T19:49:12Z,nawrockie
b3212bf31a336ccea7bfa3bc43841d54ccacd0b0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-s1 branch into build-frags,2023-03-07T16:40:14Z,nawrockie
cbb2153976c68a2dd0585a7fb5e8646bb867a93b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fix for iss34, if a (truncated) parsetree ends with a self-insert, add transition count of insert -> match state of next node",2023-03-06T20:53:14Z,nawrockie
0585b088991ee7aba7d90c0f1db7e8097a524934,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags branch into build-frags-s1,2023-03-06T20:45:28Z,nawrockie
ba9b566505302bc7937204c15c800b1d74e4ef82,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds iss34 test, currently fails",2023-03-06T20:43:43Z,nawrockie
4f05d32bd66dc2ddd0f3e51d46b5f5ff4465505b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Reworks cm_parsetree_Doctor() for a new (valid) type of truncated parsetree not yet encountered in testing,2023-03-06T18:25:02Z,nawrockie
74aabc5742df251e18b7a858eb119b705f314c07,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Transmogrify(): removes incorrect addition of inserts in off-truncation mode when run for an alignment,2023-03-01T18:32:44Z,nawrockie
c4f011b7d31cb70b219f53939f72eed0a3597c92,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes declaration of unused variable,2023-03-01T17:28:01Z,nawrockie
5790f3ca6db21bea5b907f47bd5b4f70d3a327d4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges develop branch into build-frags,2023-02-28T18:59:34Z,nawrockie
8d08dc5cd75ad668a642d3ec1de1b34a3eda453c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates iss33 handling in testsuite, makes perl script executable",2023-02-28T18:48:39Z,nawrockie
76f89fc39ca23dd6d7fc6841d633a56a31e06bdc,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges bug-truncsearch1-fix1B branch into develop,2023-02-28T18:11:57Z,nawrockie
b32dae608a181be1894cbba71eb4c4ef337b7f32,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes unused arg to HMMBandsEnforceValidParse() and adds some comments,2023-02-28T18:05:40Z,nawrockie
872d1bb2c596778b972a35414d4194329416131f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes debug print statements,2023-02-28T17:55:28Z,nawrockie
f1a8cbe4f9e1d89997dcad20aace7becaa64eba8,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,After pli_cyk_env_filter() envelope boundaries now only changed if they don't violate enforcement of i0/j0 for truncation mode,2023-02-28T16:04:10Z,nawrockie
9e3a4e70c6c5dd553fb3b9f6dd7b0d051fedb267,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes need to have 3 truncated hits in iss33 test, too strict",2023-02-24T18:18:16Z,nawrockie
45e3e883bb60de7bfb82a11090bd022d105e982a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds iss33 tests, cmsearch currently fails these",2023-02-24T14:45:23Z,nawrockie
04e8ff2accb49fff4b3eaadd32e120f037aa8c86,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges develop branch into bug-truncsearch1,2023-02-22T17:10:49Z,nawrockie
08cc4d0f0a20badb6a07078e134011d41b9f3807,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes typo in output error message when --fmt 2 is used with cmsearch,2023-02-22T17:09:43Z,nawrockie
35ed5d64da4d0ea9be3aa20439112d4275894d4c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges develop branch into build-frags,2023-02-16T20:18:16Z,nawrockie
f6d4e9677d5399714672396b1936c086347742af,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges bug-truncsearch1 branch into develop,2023-02-16T20:17:53Z,nawrockie
71ee796188f48d6c22463bdff6f0bf867035cffa,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Tweaks debug print statements, for easier debugging",2023-02-16T20:15:58Z,nawrockie
75ceef3c33b87aa3105b5c3ed6d41df6966a4130,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges problem-msg branch into develop,2023-02-15T21:02:57Z,nawrockie
346d26498dc97b3dfb48b74d876c56fddd0b2e6b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Reworks output of sequence name when matrix memory overflow occurs, fixing recent commit 99df5f5",2023-02-15T21:02:22Z,nawrockie
3b4714e4ac4c7793e70f37bde9cafa12b74c4eb4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes else if block that was impossible to enter, must have been erroneously duplicated at some point",2023-02-15T17:53:56Z,nawrockie
9d11c7962be396cee6790765283c15167b201800,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges psicheck branch into develop,2023-02-15T02:25:37Z,nawrockie
feab61e0930868d6c6584132c6ea1c3892174fec,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Increases tolerance of deviation from 1.0 for summed psi (occupancy) of split states for models with clen > 25000,2023-02-15T02:24:40Z,nawrockie
bde87b050b7886d62d2adbae54a0511a3a4fcfbd,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges build-frags-newmarkfrags branch into build-frags,2023-02-06T21:29:54Z,nawrockie
6b025a68fe639bb738529a74108e8747fc92044d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Splits mark_fragments into assign/annotate_fragments so -O output msa can defines fragments based on input MSA,2023-02-06T21:29:04Z,nawrockie
6c0cd59708e6392af6374c0fd20e3c596e9e897a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Swaps out esl_msa_MarkFragments_old() for esl_msa_MarkFragments,2023-02-06T20:36:07Z,nawrockie
f97a060f56141d745b0395b8247cb77a2867feec,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes temporary print routines for debugging recent code changes,2022-11-08T18:24:39Z,nawrockie
26bc231a36a1ee6e3fed9233bdf1bf8f7b4ea820,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"ParsetreeCountExceptTruncatedMPs(), adds check for parsetree nodes that don't have left children due to truncation mode, and so should not have their transitions counted",2022-11-07T23:51:39Z,nawrockie
d67137d1aa4a937981c8330ff06ba5cce226f9d1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds support for degenerate symbols in PairCountMarginal(),2022-11-07T19:00:24Z,nawrockie
bd7469addc225469abdc045f4dd0af4bf2bb3048,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds support for counting truncated parsetrees into CM emission and transition vectors,2022-11-04T18:41:07Z,nawrockie
89448f7b5a545e7cd97aec786b9e801c6af27241,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,cm_parsetree_Doctor(): changes to accomodate truncated parsetrees,2022-11-03T18:43:47Z,nawrockie
50f440ee08c96e85b604826e8a55f80b4260daf4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Transmogrify: cleans up recent code changes,2022-10-27T19:13:12Z,nawrockie
dc6ddf0772bae384649d4bfe5cbc35f5bb7b911d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Transmogrify: restructures recently added code, handles special case of END_E",2022-10-26T20:04:38Z,nawrockie
6c17c3a17a150123d81a3966be47584c48046f1f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Transmogrify: first pass to find initial state keeps track of whether there are TRMODE_L and/or TRMODE_R,2022-10-26T19:41:32Z,nawrockie
acd25402d68217f1fd19007113e5f694f407001f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Transmogrify(): adds additional preorder traversal to determine first node/mode for truncated alignments,2022-10-25T19:31:38Z,nawrockie
7ec1801ccc8775269e2b8990b32675ae912c6a96,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Transmogrify(): when seq is truncated, non-ROOT/BIF nodes prior to first emit are now skipped",2022-10-21T18:20:17Z,nawrockie
38a128723dd94459baa2480c101869592f7e2c42,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Tranmogrify(): do not add states in subtrees with all missing data,2022-10-21T17:43:02Z,nawrockie
7a94e076fb19728a087ce1d1a94f1203333ef5a1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds support for truncation modes in Transmogrify(),2022-10-21T17:11:05Z,nawrockie
589062c3a111cfe5308769c9ef042e440c666ce1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Changes HandModelmaker() to define match columns by ignoring missing data in fragments, a la hmmer",2022-10-19T19:17:05Z,nawrockie
aeb358af5531492ede1980d461edb282197c454b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --fragthresh option, not fully implemented",2022-10-19T18:27:02Z,nawrockie
7c236f8727d591ade697ea69b27838a71ef21965,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges aln-mem-limit-fix branch into develop,2022-10-18T19:16:34Z,nawrockie
797011332b36ca0a64ffd07b0c9861cdef715957,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Changes default cmalign --mxsize value from 1028 to 1024, it was always supposed to be a power of 2",2022-10-18T18:26:20Z,nawrockie
a548baadc5c5d1776f9576c76e650e51d74f7624,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Doubles DEFAULT_HB_MXSIZE_{MAX,MIN}_MB from 512/128 to 1024/256.",2022-10-18T18:24:37Z,nawrockie
5186518bf0922773e3d1abd31feab493441f472b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds info on HMM mx size upon failure due to --mxsize violation,2022-10-18T18:23:39Z,nawrockie
a22578215e834557db16d9cb6e46d9728ac134df,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes check for cp9mx size, so as not to deviate from 1.1x behavior in place since 2013",2022-10-18T18:23:07Z,nawrockie
b33ac681afcf034e17b9037d2ed70298952224a3,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds correct size of CP9_MX matrices to return value of cm_{Tr,}AlignSizeNeededHB()",2022-10-14T18:10:37Z,nawrockie
9230616b7da4befc54d6512c09464f4428290894,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges longopts branch into develop,2022-10-12T18:40:06Z,nawrockie
e234467eb4dc3b1f4ae5fadc81e840f8d04a60a1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds more manual check of long incompatible option combos,2022-10-12T18:39:10Z,nawrockie
076d200d84177729616e7e7409a8f7084d3b56d6,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Modifies check of required options for --small (issue#20), simplifies other incompatible option combos",2022-10-11T18:05:55Z,nawrockie
0d1a12268cb444f7fbf5bfbdb42b87dd40257c56,nawrockie,nawrocke@ncbi.nlm.nih.gov,Merges h3-arm branch into develop,2022-10-11T17:28:34Z,nawrockie
95d6ae01d2224b9984209c64ba60136362544167,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges format3 branch into develop,2022-10-11T15:39:47Z,nawrockie
a4684ca5849316bfd72ec35829a11f98493710e6,nawrockie,nawrocke@ncbi.nlm.nih.gov,Merges develop branch into h3-arm,2022-10-11T15:29:51Z,nawrockie
a33bd006ce29c9adcbe2a2bae090917e2fd465e3,nawrockie,nawrocke@ncbi.nlm.nih.gov,esl_FCompare -> esl_FCompare_old,2022-10-11T15:29:47Z,nawrockie
b5e8b39c9f3bfa1ca83f09f327fbd74c07e1d0ed,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds tests for --fmt 3,2022-10-11T15:08:45Z,nawrockie
f65cc6eec41023a99b67bbc1d8abe17d46126c38,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Reverts to NULL default for --fmt, and adjusts related option checking",2022-10-11T15:08:24Z,nawrockie
455c0647181c7c79ec3f2c646ebd439a0028e6d4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Moves outside-esl-getopts checks related to --fmt to appropriate section,2022-10-07T16:35:56Z,nawrockie
44c7d3f3baa9ad068f539743b9648d595c9ffbef,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Sets default value for --fmt to 1 instead of NULL,2022-10-07T15:46:25Z,nawrockie
70aaeae7e9279b9a6a7592398d09af643c5f2b4b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds description of format 3 of tabular output,2022-10-06T20:00:27Z,nawrockie
04089bfd3c83283f1a0849a709eb7de2da7a4371,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds cm_tophits_GetMaxModelLength() to infernal.h,2022-10-06T20:00:11Z,nawrockie
7270c0cc90036414023b2054b009fa7ddd2136ab,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --fmt, and support for --fmt 3",2022-10-06T19:17:53Z,nawrockie
385605a3624fe85b4595b5735417f641faefa6e8,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds --fmt 3 support in mpi_master,2022-10-06T19:17:24Z,nawrockie
1b2d01665724c3c4681091bec1ef341026bbc408,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds cm_tophits_TabularTargets3() and hooks it up to cmscan --fmt 3,2022-10-06T18:40:26Z,nawrockie
7745e6c585fde942ea3458274aed7ad9e9c2395a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds mdl_len and seq_len to cmscan --fmt 2 tabular output,2022-10-06T18:13:53Z,nawrockie
e9d9b37421ef2907b21e6c42c28a8e87063c81fd,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes numbering of structures (all comments),2022-10-06T16:45:23Z,nawrockie
1f871cc24df973a2b985835509906e884c0dbcce,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates acknowledgements,2022-10-06T16:10:37Z,nawrockie
d39db74eb21225cc6e9ae377c297cd2b6f64933f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes footnote copied from hmmer userguide,2022-10-06T16:07:40Z,nawrockie
1d9da9c8c6ed6b4dedbc2b3ce7c7fad240bf4680,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges cmalign-fail-report-seq branch into develop,2022-10-06T15:19:53Z,nawrockie
99df5f5f1d26038400e0bacc6ea3666f2125c1dc,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds stderr output of seq name if alignment fails because matrix is too big,2022-10-06T15:18:55Z,nawrockie
54c34fae1c30b92a49ee25c101ab09613424bd19,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes latex newpage commands,2022-10-06T14:51:51Z,nawrockie
92e9e457b406b663c4a957a0a760077c5ed3cd4b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds --consrf option,2022-10-06T00:50:05Z,nawrockie
914ac0bfd940a51ec1763b3a510ea272bc3ec7d1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds info on possible lack of PP lines in cmsearch output (github issue 29),2022-10-05T23:02:43Z,nawrockie
74fca1c053490cf478b8ceb2c5bf23f80c3af0ab,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --noprob to list of options required with small, github issue #20",2022-10-05T20:56:40Z,nawrockie
00f57906a0d76cb60815aa3a1091173e0290044c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Completes merge of cmpress-errmsg branch to develop,2022-10-05T19:54:16Z,nawrockie
a9de8ec250bedf9c861bd0c6e75120476418d18f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds print statement for errors, omitted in f8cea70",2022-10-05T19:52:52Z,nawrockie
807de2194952c241a1715519d7ca8516d31bdf0b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Completes merge,2022-10-03T15:24:08Z,nawrockie
ef45a20675abf8cdec38a9897fd09d6b5702dbd7,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges calibrate-split branch into develop,2022-10-03T15:23:36Z,nawrockie
5a0480226147e986975232fe9108e8ccc44b6e08,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes unnec ')' from option def lines,2022-08-17T12:27:31Z,nawrockie
c3469f94d5c96a52f391b63ddfeb890b4e1a090c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes redundant '[default] from -u option defn line,2022-08-17T12:26:56Z,nawrockie
5a7c1c08d8f6d3e1a9c25b528968736e82eca87f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates userguide to use distilled.bib and fixes some refs,2022-08-10T16:45:47Z,nawrockie
8ac5fefd3b5ad0fddfd4908c75d1856b1b537af9,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes bug related to reading scores that are 0,2022-06-08T19:12:02Z,nawrockie
38962706abe41f3aec93ec9971842dc5e123eefd,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds split/part/merge cmcalibrate tests,2022-06-08T19:11:16Z,nawrockie
ae3e3cf9188910d010dbcca19acfafa7827ed266,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --split, --part and --merge cmcalibrate exercises to testsuite",2022-06-03T17:44:50Z,nawrockie
a933c7d1d8dc0fc4437eb792894501c93ccf15d7,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates man page for new cmcalibrate options,2022-06-03T17:26:23Z,nawrockie
1324b343b36b00bd4c819a18bcc29cbf070cb425,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds check of CM file with --split,2022-06-01T17:39:07Z,nawrockie
6c4cd180ba79dbe6c06f3f756fbf53dca1ab9df4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes some debug print statements,2022-06-01T17:16:21Z,nawrockie
01d04d6eb2fab77a2b1a0ffc589af25a068559b1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates output for --merge,2022-05-26T18:29:53Z,nawrockie
84f36b8c6e26e7ac350721d50b3c864632665d0e,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds 'calib.' to pfile output file name with --split,2022-05-26T17:15:48Z,nawrockie
28a2fafce2dda548a601726558dbecc68caf548b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,valgrind shows now memory leaks with --part for 1 CM,2022-05-26T15:01:52Z,nawrockie
84c71904cc4f93c0c596e54c31993b1c4f8ad991,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"valgrind shows no leaks for --merge, single CM",2022-05-25T18:04:43Z,nawrockie
bc1ca45d207c03ae11a0811046fcb88cea205a65,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Reworking how partition file command gets added with --merge,2022-05-24T21:12:07Z,nawrockie
5f89afefd0818cb94982737595c24996d70fe479,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,In middle of adding COM line to partition score file,2022-05-24T20:49:39Z,nawrockie
bb01f7c4b8fa1e00cebbf3ddefe6578382b53ab1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Forecast time no longer printed for --merge,2022-05-24T18:18:02Z,nawrockie
69938e3ac72ddfe744513001711c3cea9bac7cd4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,--part now works in threaded mode,2022-05-24T15:50:30Z,nawrockie
7d4b4de2d33f2712c203bd4d6c5113db2cf1efa0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,--merge now anecdotally working,2022-05-24T14:19:02Z,nawrockie
a21032b724c8b5969197956da215f246f1a5129a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"With --part --pfile, scores now output to pfp",2022-05-18T00:42:18Z,nawrockie
ea7f295d880e88d17b6de4ef6bc7d45a08f805ce,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds logic for partitioning sequences to search,2022-05-13T19:39:29Z,nawrockie
35ff7f1eff3bd149b0f4f6371a658d6445a6e25b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Header output with --split,2022-05-13T18:03:36Z,nawrockie
3a8c4fea4500e588d52cb94d66b73f69a671d07d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds options for split mode, starts new code for --split",2022-05-13T17:46:26Z,nawrockie
b762e011fb05a7490f2262294e8a663f5eea70c2,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges ncpu branch into develop,2022-03-21T19:29:08Z,nawrockie
f1c5ff22a9d6186469174fefc641ccd241f89416,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Actually sets default num cores for cmscan to 4,2022-03-11T16:58:02Z,nawrockie
ce6ae74590c50c2825496064bcf0ce791b9dad1f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Actually sets default num cores for cmalign to 4,2022-03-11T16:57:40Z,nawrockie
844fbbdd11ba79bd283a6cd06d8b6d2153e896f8,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Changes default policy on number of threads/cores, following 2017 commit in hmmer (7dfd76).
Set to using 4 worker threads by default, subject to change pending results of scaling experiments.
Options structures use CMNCPU for default, CMNCPU added to config.h.in, defined as 4
Use ncpus = min( --cpu option value,  # of cores available on machine)
Revised documentation in userguide and man pages to reflect this change and mirror HMMER wordage.",2022-03-11T16:23:30Z,nawrockie
17555a8331067af1ec39d59b74a3dcce40a81819,Nick Carter,npcarter@g.harvard.edu,Changed esl_DCompare and esl_FCompare to esl_DCompare_old and esl_FCompare_old for compatibility with develop branch of easel,2022-02-18T19:14:57Z,npcarter
bf2d30ff41ba5d0a9cc771b780f91ee73515f3bb,Nick Carter,npcarter@g.harvard.edu,"changed AC_PROG_CC_STDC macro in configure.ac to AC_PROG_CC, as AC_PROG_CC_STDC is obsolete",2022-02-18T18:40:33Z,npcarter
9936cc8d99759ab704784fe68405fa768982ab49,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Changes to make infernal build for arm/aarch64, inspired by hmmer h3-arm branch",2022-02-07T18:38:16Z,nawrockie
421f92b4e835d6206eee6fc50e13e34044c5568d,cryptogenomicon,sean@eddylab.org,"Swaps esl_FCompare() names.

esl_FCompare()    => esl_FCompare_old()
esl_DCompare()    => esl_DCompare_old()
esl_FCompareNew() => esl_FCompare()
esl_DCompareNew() => esl_DCompare()
esl_FCompareAbs() => esl_FCompare() with rtol=0.0
esl_DCompareAbs() => esl_DCompare() with rtol=0.0

See corresponding Easel commit for more	explanation.",2021-02-17T17:26:57Z,cryptogenomicon
646d728313a32144243319eb0b8a44a81ccf110d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges release-1.1.4 branch into develop,2020-12-10T13:21:39Z,nawrockie
4133bd18554a8594ee2881eab3b1930268d60973,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges release-1.1.4 branch into master,2020-12-10T13:20:01Z,nawrockie
4a39cb96e81d530bf9ef91803b1467feee3fd875,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes 00CHECKLIST, will now keep release notes locally in release e-notebook dir and infernal-plans",2020-12-10T13:17:33Z,nawrockie
1826d9ef1decd6dd6cd7c613ff89a818b6a3eaa2,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes now defunct README, recently replaced with README.md",2020-12-09T21:01:14Z,nawrockie
7dac0eb9891469ad4f0d325fc5232c9950521017,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Frees ESL_MSAWEIGHT_CFG 48 byte struct, detected as valgrind mem leak during 1.1.4 release process",2020-12-04T14:27:09Z,nawrockie
22fa7aa8a9def29c5e88d6f3e7e4479c1422bf72,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes install of man pages,2020-12-02T16:16:24Z,nawrockie
28d1bdb5e9bfe29f03cdfdfb2cd712e9646b2122,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Bumps version in alignment file missed earlier,2020-12-02T15:04:12Z,nawrockie
5c57935682d415681a563bcd2643fe36e8d758cb,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates version to 1.1.4,2020-12-02T15:03:21Z,nawrockie
d1fd52e3eb411ba1298f08be290a14a74e2d15da,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds http and https to beginning of urls so latex's url command makes them links,2020-12-02T13:55:41Z,nawrockie
d334fa1ab869c21ccfc50d32d69e6bb061565880,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes tufte latex fullwidth environment supported by hmmer but not by infernal,2020-12-02T13:48:53Z,nawrockie
e1853957ef1d8eaac2de1dc38b96626be36ba323,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds echo CLEANS at end of 'make clean's in Makefile.in's a la HMMER,2020-12-01T23:17:03Z,nawrockie
7337b013525e9a58a85ec28dc0079db96064c602,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes typo,2020-12-01T20:31:06Z,nawrockie
b06021bcefd6463f21016f13d2780f88c30fad20,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates LICENSE based on hmmer's LICENSE,2020-12-01T20:30:44Z,nawrockie
b5beaaadc4e40be0cd9a98843970305aaf6e4bf1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates INSTALL and adds README.md based on hmmer; Adds copyright.tex to userguide/Makefile.in,2020-12-01T18:48:54Z,nawrockie
36ab678f440245903997408086022c26c27bf26f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes Janelia address for trailer of each man.in file,2020-12-01T16:08:42Z,nawrockie
90d447b2b29ab19afb6c362dca22cc0d0f715ba4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes copyright.tex, it will now be built by configure from copyright.tex.in",2020-12-01T15:58:43Z,nawrockie
512408f378c755d85d07f32ce48141eb08a55b1b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds copyright.tex.in modeled after hmmer,2020-12-01T15:57:11Z,nawrockie
f7bee3b412b5e62291942f3c2a15d41542582bf4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Minor tweaks to be consistent with hmmer,2020-12-01T15:53:15Z,nawrockie
163f20fe9f2693f67f1782661ca49f0adcf2b65b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds infernal .man files to AC_CONFIG_FILES() section,2020-12-01T15:52:25Z,nawrockie
7a3a475a5edabf3038e6c1e02eaa049d442ed421,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Moves (unmodified) man files to .in equivalents, to mirror hmmer",2020-12-01T15:39:55Z,nawrockie
377e60e54b4e1ca15e12ddc6342b48350f69f54b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes no longer used boilerplate.trailer,2020-12-01T15:38:02Z,nawrockie
bd128d559bee578d4776f0b54280a516f3de04a3,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates for manpages -> man dir name change,2020-12-01T15:34:39Z,nawrockie
9e488102cfb5658d29accf16ed73af65e41b15fc,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Moves documentation/manpages to documentation/man to be consistent with hmmer,2020-12-01T15:29:45Z,nawrockie
fbcc4c6f0832aacf734bd05be77be2ecd3058bcf,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates tutorial model files and userguide .tex files for 1.1.4,2020-12-01T15:28:32Z,nawrockie
1add43831340307fd9f41c3fe67e53ae9fa5a4d4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds release notes for 1.1.4,2020-11-30T16:48:35Z,nawrockie
7ece0e3ce201bfafc907c272292e094d3caf8b57,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates infernal release date to Dec 2020,2020-11-30T14:40:37Z,nawrockie
7726ff34ee03b78896388f92d9a4e6d1ddc5cf42,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds PIC_CFLAGS when building platform-specific code following HMMER commit 2efeede; other tweaks to be consistent with HMMER;,2020-11-30T12:18:27Z,nawrockie
3b2846db0719eba29bf6190d84ce34cb9893dcf0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates hmmer version to 3.3.2; easel version to 0.48;,2020-11-30T12:07:39Z,nawrockie
6fcfaf8ff974149cf4c2e75f2c766782b170470f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Escapes $ characters for latex,2020-11-20T20:52:54Z,nawrockie
664c4e27bcbb5ee399e905571a696a5cc5dbc267,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,In process of editing 00CHECKLIST,2020-11-20T19:50:17Z,nawrockie
3cf9f7cf8135df0229db53fa36b5b897951a4160,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Bumps version to 1.1.4, hmmer 3.3.1, easel 0.47",2020-11-20T19:18:46Z,nawrockie
5c12891ed65334d8129b673d970934ca1b333e27,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates INSTALL,2020-08-12T12:51:02Z,nawrockie
7113abcfb1d955a88f78c745da330a72ea5b0583,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges enable-mpi-update branch into develop,2020-07-26T13:46:04Z,nawrockie
0ae40e3747fa7cf65243a5518c07cd01acb725f8,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Call AC_PROG_CC_STDC in configure.ac always (even with icc); mirrors hmmer commit e325efc,2020-07-26T13:45:31Z,nawrockie
4aae3bffc6b20539b2bcc05e045834d5e046a81d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes AC_PROG_CC; should have been removed in previous commit to mirror hmmer 7ef1bda,2020-07-26T13:44:14Z,nawrockie
f1aa4cb83ae3e3f4a9148806627c5722cfb8803c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Follows hmmer commit 7ef1bda 'Replaces AC_PROG_CC/AX_MPI with AX_PROG_CC_MPI in configure' see hmmer commit log for more details,2020-07-26T13:37:57Z,nawrockie
203e48c0b5a5702d18188fcc6bc4807eaaf015cf,cryptogenomicon,sean@eddylab.org,Merge branch 'develop' of https://github.com/EddyRivasLab/infernal into develop,2020-02-15T22:57:59Z,cryptogenomicon
d5c64f0755b64eb675a4018c438a7e3c00eb7d0b,cryptogenomicon,sean@eddylab.org,"Improves makeTAGS.sh. Adds -x option for my ~/src/makeTAGS.sh.

[SRE:H8/2]",2020-02-15T22:57:35Z,cryptogenomicon
3b1dfe9f840c63a943208e51017e3c77b74aebd7,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds iss21,2020-02-10T20:47:00Z,nawrockie
0f6f9903d50ad9fc7954f60ea9648e7d4a215db4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Correctly removes i49.tbl instead of i31.tbl,2020-02-10T20:46:49Z,nawrockie
9c4df16acb03e970ef6c69e24d5a55c6a1a5b853,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Uses grep to remove RF annotation instead of specifying both alignment files,2020-02-10T20:38:09Z,nawrockie
6e8ced30415b0a07e1e34628b7dd052faff90e7c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds iss21 test script to test github issue 21
Marks first step away from BUGTRAX for logging bugs, based on
a recent analogous change in how HMMER documents/tests bugs",2020-02-10T20:28:42Z,nawrockie
fba203f88af0c42a5d91ab8c1cc932f45e8c79ea,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Instructs esl_msaweight_PB_adv() to ignore RF annotation unless --hand is used
Prior to this change RF annotation could impact model building when --hand was not used
because esl_msaweight_PB behaves differently if RF annotation exists vs when it does not
So MSA weighting can be affected based on presence/absence of RF which has downstream
algorithm for determining RF gives a different RF column annotation than what is on
algorithm for determining RF gives a different RF column annotation than what is provided
) which had downstream effects on model parameterization. In Infernal, RF annotation
should not impact model building unless --hand is used.",2020-02-10T18:50:52Z,nawrockie
dbf94aef253adba01d5f86f3473fbe767948c89d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates description of --fmt 2 fields affected by recent addition of $ character in olp field,2020-01-21T11:32:32Z,nawrockie
1dc9c1b7bc01846e793dfe3cbf6c8bc5b2094841,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updaates explanation of --oskip option
 for recent changes to anyidx field",2020-01-21T11:31:41Z,nawrockie
f843476986e1744de6fa9f8de6b96f7e16c028f5,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds $ as possible value in anyidx column for --fmt 2 tblout files,2020-01-21T11:30:06Z,nawrockie
db198dadd55b955a3789f4b5e47bbc7664f7f362,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Typo fix in comment,2020-01-03T16:56:10Z,nawrockie
65c0fb6920deef9f6fc11812d8a6449939f08d9a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Typo fix,2020-01-03T16:54:43Z,nawrockie
ef79c13eab6ee974175faac331e48a557f8e1118,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds CPPFLAGS (following Debian team suggestion) and other flags (following hmmer's profmark/Makefile.in),2020-01-03T16:30:38Z,nawrockie
ca1bc4b3f40c88e2837e3e991351c44577737136,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes cmalign, which was accidentally added earlier",2020-01-03T16:29:12Z,nawrockie
1c558657fa8f343dd1333b22d178389bd6a5b26f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Typo (spelling) fixes suggested by Debian team,2020-01-03T16:18:46Z,nawrockie
08344da729c7cae69d32299e587f34af29bb05a1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds SSE_CFLAGS and VMX_CFLAGS to Makefile.in and src/Makefile.in following hmmer to address i386 compilation fail reported by Michael Crusoe at Debian,2020-01-03T16:10:02Z,nawrockie
34586053ad9ede8fee59b2046b8cd66e56a5a1da,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merge branch 'develop' of github.com:EddyRivasLab/infernal into develop,2019-12-10T18:06:51Z,nawrockie
3d89b75badc7d7c7fd921347e3fc36efe9ec05f4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates calls to esl_sqio_ReadBlock() for recently changed prototype,2019-12-10T18:06:38Z,nawrockie
10f3b437270cea92674f42827fb538ceb2c7a596,Sean R. Eddy,cryptogenomicon@users.noreply.github.com,"Merge pull request #18 from EddyRivasLab/readblock_max_init_window

Updates esl_sqio_ReadBlock() to use new max_init_window arg",2019-12-07T03:13:18Z,cryptogenomicon
f1229276738ab44821f4d10ea16d2d755c74e3dd,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates esl_sqio_ReadBlock() to use new max_init_window arg, set to TRUE, to revert to infernal v1.1.1 behavior where the first window read of a sequence of length L is always max(100000, L)",2019-12-06T20:57:14Z,nawrockie
9457f7d382b70f7aa0999ae05d855255d1e76997,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates for new website git repos eddylab.org and infernal.org,2019-11-20T02:35:54Z,nawrockie
6214dbfbaa53ce502271a78fe96ce4efdaed5ea1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds final note about checking for INFERNAL_* strings in README, which I missed somehow in 1.1.3",2019-11-19T21:17:31Z,nawrockie
3b9caaab8996f2e9bc6564b694cd92a1ce9a7717,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges master branch into develop,2019-11-19T21:14:57Z,nawrockie
9aa2bc3d15325f80493a23415c53fe165fe4111c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges release-1.1.3 into develop,2019-11-19T21:09:33Z,nawrockie
a358a4984a90efd8177a82440f7576204735ae5c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges release-1.1.3 into master,2019-11-19T21:06:29Z,nawrockie
ff79e50ab1b598f8a7c7243c388ed1ba900868f9,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Typo fix,2019-11-19T21:04:37Z,nawrockie
c3ae50203f6e6b18a68167bcbc8135189c87968a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Final changes to 00CHECKLIST prior to 1.1.3 release,2019-11-19T21:03:09Z,nawrockie
3b5b2822acea4b321428dee36ea7e13646df523b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,GPLv3->BSD,2019-11-19T18:45:16Z,nawrockie
3b8091eaf2d866087e068e76bee87211990bd117,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes errant @INFERNAL_COPYRIGHT@ line from LICENSE. More tweaks to checklist.,2019-11-19T18:24:02Z,nawrockie
6e9e3ae56c51ef39f5aa1f868cf3afcd7bbffe20,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds AC_CONFIG_FILES calls for hmmer and easel man pages and hmmer tex files,2019-11-19T15:46:07Z,nawrockie
4174ba564e987d79d286bb9787430dd9d5b97df1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Tweak to release notes,2019-11-18T17:56:51Z,nawrockie
e2f5e902398a6394f04b10c909e6912305fab408,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes 8 byte cmalign memory leak that only occurs with --cpu 0 revealed during valgrind testing for release. Updates to 00CHECKLIST for 1.1.3 release - more to come.,2019-11-18T14:55:38Z,nawrockie
e7c4ea4c502e33f58b0bc567390c4552f633e4af,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates HMMER, easel versions in configure.ac, minor update to 00CHECKLIST",2019-11-17T12:55:59Z,nawrockie
3cfb262b58ede69bfa2c2344834c4b8493aa9f4e,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates tutorial Rfam cmscan example for Rfam 14.1,2019-11-17T12:42:17Z,nawrockie
ea0ef7100c9761b115e465a2aebb69531e44e318,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Version updates',2019-11-16T19:29:57Z,nawrockie
26b6f29c11e7088495cc88cc0b6c3fdd2fb169f3,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates tutorial with 1.1.3, models changed due to new Henikoff sequence weighting in Easel, which subtly changes most of the results in the tutorial.",2019-11-16T19:23:09Z,nawrockie
8f49959d1e7d871870c490109b21318f6f945cef,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes typo in man pages,2019-11-14T15:17:52Z,nawrockie
0f07a9d20ad954f052fc640cf746c3847b98c177,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds release notes in markdown, following format from HMMER and Easel",2019-11-14T15:15:42Z,nawrockie
8f5ca2a692ae883ecdab03651b1a2d5879d2f0fa,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Minor edits to checklist; syncing up with laptop,2019-11-12T03:08:13Z,nawrockie
0568fd319c7ca4daba231a07391d0aa02e008e40,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds bug i49 in BUGTRAX and with test script integrated in testsuite and dev_testsuite. This was fixed as of 241987e but I just decided to add the test script.,2019-11-10T13:11:51Z,nawrockie
8b758e051fb23b907903b5aa5db3de51b0eb92d2,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates Easel copyright date,2019-11-09T11:51:34Z,nawrockie
79ff5462a14d0e32f560d511a3c92b56aa713292,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Bumps version and dates for 1.1.3, stray character fix in INSTALL",2019-11-08T18:29:10Z,nawrockie
1ad8d0ce4486880e2ee3e86e955fb38260e7c1d8,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges eforce branch into develop,2019-10-02T18:32:03Z,nawrockie
a7c8822e1f2489a408d52c8d72df746975bade45,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes GA/TC/NC cutoffs from filter HMM sections of CM files, since those cutoffs pertain to the CM, not the HMM. Adds documentation for new --emaxseq option to manpage. Adds dev_testsuite exercises for --emaxseq.",2019-10-02T18:29:26Z,nawrockie
19f229aa33e0f54caf236f20a23253efb0c1478e,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges develop branch into eforce branch,2019-10-02T14:29:02Z,nawrockie
bc2b8cc307e168cec8f8cfe61a119b666048c593,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges hmmonly-overlaps2 branch into develop,2019-10-02T14:27:14Z,nawrockie
d19ce7a81fbf473cea5b9d7feece0f3025d37ef4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges develop branch into hmmonly-overlaps2,2019-10-02T14:26:43Z,nawrockie
fb4fc4a88f8653d427d33f59770de71fa51bf351,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Reverts debugging print statements to only print if eslDEBUGLEVEL >= 3,2019-10-02T14:25:15Z,nawrockie
81ec4d5be98bd693e775815a74250045c2833032,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Replaces stray SIMD_CFLAGS with SSE_CFLAGS, missed in commit 31dff66",2019-10-02T13:59:26Z,nawrockie
6c929c8bfe9ff3d39c8f2161bf1452385c126a57,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates support in configure.ac and src/Makefile.in for PIC_CFLAGS, to be consistent with analogous change in hmmer:develop 52fe7cc",2019-10-02T13:49:29Z,nawrockie
241987eeee0797c4c11c872133fbc0a28a3ec0d5,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Cleans up recent edits for dealing with overlapping hits in pli_final_stage_hmmonly, and adds critical fix for bug that prevented hits in a chain of two overlapping pairs of hits from possibly not being reevaluated.",2019-10-02T13:27:30Z,nawrockie
92d48d515118433f77dcf0f07b8ed7d14182240a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Skips addition of lower scoring overlapping hit in pli_final_stage_hmmonly(),2019-10-02T01:43:33Z,nawrockie
9d44201c085a406392ab5f4f578cd11164f80c47,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds experimental code for dealing with rare overlaps in pli_final_stage_hmmonly() returned by p7_domaindef_ByPosteriorHeuristics,2019-10-02T01:35:20Z,nawrockie
74e8506de7ceb441b2c483afd9d5f8120b287cdb,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes unnecessary TEMP in comment,2019-10-02T01:34:41Z,nawrockie
66af5f4e30280c74e6910e318f9ce1461d208616,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges develop into eforce,2019-09-23T15:36:56Z,nawrockie
7addcf02baf08efa48a7dea0f7754dad55df7e19,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes inaccurate explanation of cmfetch -O option,'With the -f option, this can result in many files being created.' This is incorrect, as -O is incompatible with -f, and making them compatible so that sentence is accurate is not trivial and probably not worth doing, since other unix tools can be used to achieve the same result.",2019-09-23T15:33:41Z,nawrockie
7e680b5f610739ab10b5881900bccaa6f2a11655,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes typo, changes '--oskip <f>' to '--oskip' because oskip option doesn't take an argument, reported by Ioanna Kalvari",2019-09-23T10:44:38Z,nawrockie
c4dedeeb662c31d772634ba9f7766563b162b184,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds --emaxseq option to cmbuild to allow effective sequence number greater than number of seqs in alignment,2019-09-23T10:23:05Z,nawrockie
53dd9a340e7cd8e1d075475d19c1a432fe2bd45f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates configure.ac to work with new --enable-pic flag in easel,2019-09-16T20:10:21Z,nawrockie
7d93882d6fce7d24231dbe8d5b83b13ed6e1b6ab,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes requirement that CM file be calibrated prior to being pressed and adds corresponding exercises to testsuites; Updates cmscan --trmF3 option requirements to be consistent with recently updated cmsearch --trmF3 options.,2019-04-09T16:49:34Z,nawrockie
b9a0ee68441e85a768682ef452b98f3b9c2f2932,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Relaxes requirement that model need to be calibrated to use --trmF3 option, now --trmF3 requires --hmmonly",2019-03-07T16:49:49Z,nawrockie
b748e2c750ca9f54401b40de6c32fdc3f6fd0bf1,cryptogenomicon,sean@eddylab.org,"Improves handling of `make check` dependency on python3.

See related Easel commit for more detail.

Also adds HMMER3 documentation/userguide/inclusions/Makefile to the
configure script.",2018-11-15T14:03:32Z,cryptogenomicon
a6d8ac977794a0f4986304174c3b451c2713e8eb,cryptogenomicon,sean@eddylab.org,"configure, make now test for python3; disable 'make check' if not found.",2018-11-14T14:37:09Z,cryptogenomicon
1254048386d859fe0e74f5ffb84fe9a7d82be007,cryptogenomicon,sean@eddylab.org,Adds an AC_DEFINE_UNQUOTED for EASEL_URL in configure.ac.,2018-08-23T19:05:17Z,cryptogenomicon
e7259acc0c06e7dca45c96c6c6827e7e6f41c400,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges buildphi branch into develop,2018-07-18T08:15:59Z,nawrockie
8cfbf6e76105b3d126f272cf95a65ba7f6a0ab36,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --occfile, --cp9occfile and --fp7occfile to create output files with occupancy values for CM states, ML CP9 states and filter P7 states",2018-07-18T08:15:19Z,nawrockie
a1373326aba32a33a2d282c11549f3e2f17fd842,cryptogenomicon,sean@eddylab.org,"Updates to new esl_mixdchlet, and fixes several compiler warnings.",2018-07-14T15:34:22Z,cryptogenomicon
8da043242a7f95ee1ff2d5a36f5e4e3a81b04bd0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges onepass branch into develop,2018-06-12T19:12:30Z,nawrockie
48a203a759ff319b2dd22b996f490176e805fb19,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds exercises for new testsuite exercises to dev_testsuite,2018-06-12T19:10:25Z,nawrockie
9e9290a307e9c86110523de4f4fa43e1fbcb27e4,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes bug in recently added --olonepass related code when sequence length is less than cm->maxW,2018-06-06T15:14:23Z,nawrockie
282bc746acc41b6fbcac05e7118835d9c6c21e88,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes bug related to possible out of bounds counter in recently added code,2018-06-06T13:39:37Z,nawrockie
4c4cd76e9b463fbb96fb84d1f00ef1c18b7a5980,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes debugging print statement,2018-06-05T17:05:43Z,nawrockie
c7ebe8c735d033b054064cc2beb11da35380f2cf,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Shortens help message for --olonepass, which was too long",2018-06-05T16:21:58Z,nawrockie
391ab94dcf166a59b04544dff01c2fe536624d1d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds --olonepass option to cmsearch/cmscan, similar to --onepass but relaxes requirement that all envelopes must contain the full sequence, to all envelopes must overlap to more than 0.5 fraction of smaller envelope",2018-06-05T16:07:43Z,nawrockie
666a8018c85d57d2da8918b69d7d40cc5c0e45a8,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds --noiter option to cmsearch and cmscan for not iteratively tightening HMM bands to try to get an alignment matrix within size limits,2018-06-05T13:25:31Z,nawrockie
2c8326281f4942f9472e7eb73b7e79234a12f338,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merges qsortfix branch into develop,2018-05-23T10:39:38Z,nawrockie
6cf2c217727e7df160db8e8c47c701fcac632313,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds i48 (qsort callback random return value) to BUGTRAX without any test scripts or code because I didn't think it was possible/practical to create a reproducible situation that exercised this bug,2018-05-23T09:50:50Z,nawrockie
64ddca03582f386001a0412280f46b2f5226dc9c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes tie breaks in helper qsort functions; adds missing bug i47 script,2018-05-22T13:38:35Z,nawrockie
5e095afef5b030a0834c274a4ed59ec6e391353b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds bug i47 and the fix, to BUGTRAX and cmbuild.c and adds bug-i47.pl script to test for it.",2018-03-19T20:03:24Z,nawrockie
6531ff810166c90fb9a0107db4efe4eb635e5df0,cryptogenomicon,sean@eddylab.org,Merge branch 'vectorconf' into develop,2017-05-06T19:31:41Z,cryptogenomicon
bf24085bbc9e90b8e9acc389a1a710e56e0d16df,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Checksums now copied to CM's mlp7 HMM if it exists for the cm,2017-05-04T16:26:28Z,nawrockie
1d7b7b4595c21b561189722fe042a5b3d087a896,cryptogenomicon,sean@eddylab.org,"Merge branch 'develop' into vectorconf

Brings in changes that removed Easel's augmentation concept, and made
the build safe from gnu autoheader's ravages.",2017-04-30T15:53:50Z,cryptogenomicon
c66deb66d45472ed47eceb525c72aa45fc4bf75d,cryptogenomicon,sean@eddylab.org,"Removes Easel's 'augmentation' concept, and adds gnu autoheader safety.

Following similar changes in Easel and HMMER3:
 - Remove eslLIBRARY define. Easel no longer uses 'augmentation'.
 - Make all AC_DEFINE()'s use 3-arg form, so gnu autoheader doesn't crash.
 - Add AC_CONFIG_HEADERS(easel/decoy_config.h) to bamboozle autoheader.

Also:
 - Remove AX_CC_MAXOPT from configure.ac; just use -O3 instead.",2017-04-30T15:23:46Z,cryptogenomicon
406a05da34dc1e6329c0c64e62e807b38d82bdf1,cryptogenomicon,sean@eddylab.org,Merge branch 'develop' into vectorconf,2017-04-19T19:12:08Z,cryptogenomicon
f8cea705d07d7a1ce5359f66ccd143d00a969d12,cryptogenomicon,sean@eddylab.org,"Fixes failing unit test, caused by recent update to esl_ssi behavior.

esl_ssi now enforces a documented requirement for unique keys. As a
result, the itest2-duplicate-names test now fails, like its HMMER
counterpart i10-duplicate-names.

Updated itest2-duplicate-names, and revised cmpress.c along the same
lines as recent revs to H3's hmmpress.c and i10-duplicate-names.

Also had to fix two other problems introduced by changes to HMMER 3.1
develop branch that had not been propagated into Infernal:

1. in cm_file.c::read_asc30hmm(), there is only one GA/TC/NC threshold
for DNA/RNA models, not two. Fixed.

2. cmbuild.c calls p7_Builder(), which now takes two fewer arguments;
 two experimental arguments were removed from p7_Builder() in H3 dev
 branch last August.",2017-04-19T19:01:47Z,cryptogenomicon
634d1dc5577a01f80c51c7899dfaddc53397990a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merge branch 'alidisplay-bug' into develop,2017-02-28T13:38:11Z,nawrockie
18e92deef2ca8be277187db903533119b069250d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes bug i46 a rare formatting error in cm_alidisplay output, and logs it in BUGTRAX. No test script was created for this simple bug.",2017-02-28T13:31:00Z,nawrockie
045be28e91fab7842f0e95c3f75ff75b0f670dbd,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Actually logs and fixes bug i45 (previous commit message claimed the same thing, but I had failed to checkin relevant files)",2017-02-22T18:57:38Z,nawrockie
b931e0cd2209547ee0f232dbeee72d7d531dfc9f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Logs and fixes bug i45. See BUGTRAX for details.,2017-02-22T16:26:31Z,nawrockie
c2c46044f9de07c3d35720c146a08bc2680fb5ac,cryptogenomicon,sean@eddylab.org,"Merge branch 'develop' of https://github.com/EddyRivasLab/infernal into vectorconf

Pulls in Eric's recent fixes on the develop branch, so now ./configure
--enable-debugging builds and passes tests.",2017-01-31T18:06:44Z,cryptogenomicon
8e9c33e9d0f67d6a27bce73a081da500d4f450d1,cryptogenomicon,sean@eddylab.org,"Starts adoption of new vector code configuration, following Easel, H3.

This commit has some test failures when built with --enable-debugging.
Committing so that I can merge in some new fixes from Eric.

Simplifies configure.ac and various #define constants:
  Now uses ESL_{SSE,VMX} macros.
  Removes SIMD_CFLAGS; now using SSE_CFLAGS, etc.
  Removes aclocal.m4. Macros are now in easel/m4
  Makefile.in uses target-specific variable rules for vector CFLAGS.
  Removes CHECK_GNU_MAKE, @EXEC_DEPENDENCY@.
  Makefiles assume static pattern rules are supported by make.
  Removes @INFERNAL_LICENSETAG@. BSD-licensed now, no dual licensing.
  Commandline option handling simplified.
  Removed cm_DEBUGLEVEL. Debugging stuff is under eslDEBUGLEVEL
  eslDEBUGLEVEL is an int, 0 if off; tests must be #if, not #ifdef.
  Removes all @LICENSE@ sedition tags.
  Removes all Subversion $Id$, $URL$ tags
  Removes main Makefile's if wrapper for binary distribution.

Updates configure.ac to current Easel:
  Adds AX_GCC_FUNC_ATTRIBUTE(noreturn), AX_GCC_FUNC_ATTRIBUTE(format).
  Adds some AC_CHECK_FUNCS(): putenv, strsep, chmod, erfc
  Adds some AC_SEARCH_LIBS(): socket, inet_pton

Fixed a number of compiler warnings about unused variables.

Removes ""copyright and license"" sections.

Bugfix in read_asc30hmm(), which is (dangerously) copied here from
HMMER; HMMER's version is more recent, and can deal with single
GA/NC/TC thresh in DNA/RNA model files.

Changed how we make hmmer/src/impl symlink, and added a configure
command to make a hmmer/easel symlink. Using AC_CONFIG_COMMANDS (as
before) appears to cause a bizarre problem in configure's code for
trapping exit status and cleaning up its confXXXXXX ${ac_tmp}
directory - Infernal's configure was failing to remove that directory.
Instead, now we just make the symlinks with shell commands.  These are
only needed for running the testsuite, and as such, they are only
needed in the build tree, not the source tree.

The hmmer/easel symlink is needed because of the way the hmmer
testsuite looks for easel miniapps. Eric had apparently worked around
this bug by having ""make check"" copy a bunch of miniapps. This is no
longer necessary; removed those commands from ""make check"".

Replaced config.guess with new (2017-01-01) version.",2017-01-31T17:40:29Z,cryptogenomicon
a08ea7b1362bf12346788363f4d72eaf99334a82,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"make clean now successfully finishes with --enable-debugging=1. Vast majority of changes are so that all output added with --enable-debugging begins with #DEBUG. itest4-stdin.pl now greps out #DEBUG lines before diffing output files. Also fixes two ESL_DASSERT1 calls with bugs, and a test in hmmband.c::cp9_ValidateBands that is run with --enable-debugging=1 that enforced an assumption about j bands that was invalidated when banded truncated alignment was implemented.",2017-01-25T22:18:35Z,nawrockie
1a9a2eca9b9b5ce3f5778509697f888bc873002d,cryptogenomicon,sean@eddylab.org,Adds a .gitignore file.,2016-12-31T15:24:06Z,cryptogenomicon
15479c03a97b8757e62028f0603449ee869e8214,Nick Carter,npcarter@g.harvard.edu,making autoconf compatible with change to easel,2016-08-24T22:06:18Z,npcarter
a82c97fd55f05e533ac5e3ead2b21a742a51faaf,Nick Carter,npcarte@fas.harvard.edu,Merge branch 'develop' of https://github.com/EddyRivasLab/infernal into develop,2016-08-12T16:43:06Z,N/A
520c7a0cac946fef99aa888577dd002be0471436,Nick Carter,npcarte@fas.harvard.edu,adding test parsing script,2016-08-12T16:42:52Z,N/A
8cd0e3ea14e58b8bd9b60db46b73198366c87168,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Merge pull request #3 from satta/repro_SDE

support SOURCE_DATE_EPOCH",2016-08-11T17:43:44Z,nawrockie
69ee99274cedc5893b05c01864d165bbc969a35f,Sascha Steinbiss,sascha@steinbiss.name,support SOURCE_DATE_EPOCH,2016-08-11T15:12:28Z,satta
0877d3adfabe4cdaccfd292189a24f0169fd30fd,Nick Carter,npcarter@hmmer02.mcb.harvard.edu,Changed configure script to be compatible with new develop version of Easel.,2016-07-29T21:10:04Z,N/A
faf1fac26c848a491267169b5ed7b65c37f09864,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates 00CHECKLIST for 1.1.2 release. Adds 1.1.2 release notes.,2016-07-11T12:27:42Z,nawrockie
8526408c155c1a5f279364931c6c9348d997820a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merge branch 'release-1.1.2' into develop,2016-07-07T12:21:06Z,nawrockie
76f771f1656e13c7e8483c0aa8265d83d981be6f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merge branch 'release-1.1.2',2016-07-07T12:19:04Z,nawrockie
1bbcf253a677dd631bf64e65f2cc9ed74df24cba,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates release date to July 2016 (was going to release with June 2016, but I need to retest anyway due to recent bug fix).",2016-07-01T20:11:24Z,nawrockie
709538ae6a335936ef1bc1e67f58461604d6b88e,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates 00CHECKLIST.,2016-07-01T20:07:00Z,nawrockie
c1193d68b5192f8b44256f31ec22fbd8f76557ec,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes major bug in cm_pipeline.c:pli_p7_filter(), was not updating score based on viterbi bias. This had the effect that the viterbi bias filter never removed any windows. Noticed this in regression testing on rmark3 against 1.1.1 in release process of 1.1.2. A very important catch that reminds why it's worth it to do the annoying and time consuming regression testing in the release 00CHECKLIST.",2016-07-01T19:53:09Z,nawrockie
9f040a73e5b53153ea61eb56d340adaff25576c1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Completing merge.,2016-07-01T18:58:40Z,nawrockie
64dc8501375baa696d8addd13f2f695a6591c6da,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes single character overlap annotation from default tabular output file in cmscan. This could have broken v1.1 tblout parsers. I had forgotten I made this change post 1.1.1, and caught it only in final stages of regression testing.",2016-07-01T18:57:27Z,nawrockie
5f5f25a7432cdb346fefba9124da16705b881204,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates website on userguide title page.,2016-06-29T19:49:22Z,nawrockie
7c34d07c544b47f7fa0fac053c45f7130773d6cb,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes license info in README, used to be GPLv3.",2016-06-29T14:38:54Z,nawrockie
542ad4b9b7f5e20f85a524c92dee796f8e690eda,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes instructions for building from git repo.,2016-06-29T14:27:37Z,nawrockie
444a381280925ca5588f942d963aa63804aca948,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates website and git repo address in INSTALL, README and configure.ac. Updates instructions for installing from a git clone from a svn working copy in INSTALL.",2016-06-28T20:18:15Z,nawrockie
f4942e187ae2e1ed19a4ede8f5cbb85d967e5036,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removes COPYRIGHT, following Easel and HMMER's lead.",2016-06-28T19:53:25Z,nawrockie
8f61f1a3f13aee749468cbb77eae652f6b9fce65,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Changes abs() to llabs() in cmsearch.c and cmscan.c. Fixes cm_tophits benchmark function call error. Minor fix to install.tex.,2016-06-28T19:13:05Z,nawrockie
a6c0c43cadff7f70073dab6f30a2e5048b5297f0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Userguide is ready for 1.1.2 release.,2016-06-28T14:27:54Z,nawrockie
f704400453d3b4bb5a6388d892340afcc10bce2f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds release notes for v1.1.2.,2016-06-24T15:17:47Z,nawrockie
92f55e747c8cd9b1f1c42e370b52552a7dc5cf82,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Makes possible malloc(0) call impossible in new cm_tophits_TabularTargets2() function.,2016-06-24T13:57:28Z,nawrockie
28655ce227a2a58faf8fb4b27b62986a0603520c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Bumps version to 1.1.2. Updates release date to June 2016.,2016-06-24T13:43:41Z,nawrockie
64878cca5286a7c8810e8061f078b085dc17387a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Merge branch 'overlap-reporting' into develop.,2016-06-23T14:17:21Z,nawrockie
196fe153629852b702d7e6865e6776ad1082c925,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixes recently introduced minor memory leak in hmmonly pipeline (cm_pipeline.c) revealed by Valgrind. Removes debugging print statements related to new clan options (cmscan.c). Adds two files used by testsuite for new overlap/clan option testing.,2016-06-23T14:09:43Z,nawrockie
b6822b60279b42f36e5f5123ed6091f6504af209,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Silences a bunch of warnings reported with --Wall with gcc 4.8.1 related to set but unused variables. Doesn't silence them all. I left several where I decided the variables are helpful for understanding the code.,2016-06-22T16:11:04Z,nawrockie
e0dab07999e66babba541bdd557d403baa886292,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixes several possible ESL_ALLOC(0) calls with ESL_MAX(1, x) idiom introduced by SRE in a62a380, found during quick manual inspection of all 1184 ESL_ALLOC calls in all 56 .c files. Some were detected with 'make devcheck'. Fixes minor memory leak in cm_tophits_TabularTargets2().",2016-06-22T15:26:52Z,nawrockie
1878eae77308b20000dad0387e736c2b7a3c2000,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates user guide, mainly formatting changes to recent additions based on manual inspection of resulting PDF.",2016-06-22T15:14:58Z,nawrockie
e13e4f6cce1652ee787cbf0122850514c2cb3074,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates dev_testsuite.sqc to test new cmscan options.,2016-06-22T15:12:02Z,nawrockie
4a86259599c8210f6b4b939ccde0ce39f43831e0,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Updates standard testsuite (testsuite.sqc) with tests on overlaps (itest9-overlaps.pl) and one exercise. Adds relevant files for those tests. Updates i1.pm to parse new tblout format 2. Updates function prototype for tblout format 1 parsing (formerly just tblout format) for itest*pl scripts.,2016-06-21T15:29:32Z,nawrockie
b0958d06c4cb82d8715095798abc0766ce0122f1,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Adds example of searching Rfam against an archaeal genome to the tutorial, including new overlap annotation and related options.",2016-06-16T17:53:26Z,nawrockie
20d597e2a436ce1009bfe4cb4ee12b319cc221dc,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Updates cmscan man page for recently (post 1.1.1 release) added options --clanin, --oclan and --oskip. Rearranges the order of some options in cmscan.c and cmsearch.c, and moves some into developer option categories.",2016-06-15T19:59:24Z,nawrockie
bdc22e3a402e5026e4727f51aadc414dc86f0019,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Adds description of clan input file to formats.tex part of user guide. Adds check that --fmt 2 used in combination with --oclan and --clanin to cmscan.c. Adds example clan input file.,2016-06-15T18:13:03Z,nawrockie
b64896bb14576f1e360c902c3c10fb7295a4518e,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Removes debugging print statement in cmsearch.c. Adds description of format 2 --tblout output to user guide.,2016-06-14T17:33:10Z,nawrockie
8007ed39c623e091232a2a306ff04d8f59894ed2,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixed bug related to overlap marking when --clanin used but not --oclan,2016-06-14T13:03:15Z,nawrockie
7d0dcbfad636f187711a2b1efb541279e48cee1d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"To get Infernal to build at NCBI: added check for librt, for esl_stopwatch.c's clock_gettime. This check was added to Easel's configure.ac in commit 3709bec, and *is* also in HMMER's configure.ac.",2016-05-10T20:26:02Z,nawrockie
a62a3809f30867ce9355fc79d336a8bba321e7fa,cryptogenomicon,sean@eddylab.org,"Adopts ""git flow"". This is an initial ur-commit on master.

Merges 1.1 branch (f5feaab) into master. Updated release version to
1.1.1x, date to May 2016.

Changes to make it compile with new HMMER 3.1 master branch,
(h3-master) and Easel master branch (master):
- P7_MSVDATA => P7_SCOREDATA; p7_msvdata_*() => p7_scoredata_*().
- p7_MSVFilter_longtarget => SSV
- p7_domaindef_ByPosteriorHeuristics prototype changes; now has ntseq
  arg (pass NULL) and some trailing args (also pass NULL)
- p7_pli_ExtendAndMergeWindows() prototype change: remove <seqlen> arg
- p7_Builder() prototype change: adds two undocumented trailing args,
  pass NULL
- esl_sqio_ReadBlock() now takes max_residues and max_seqs args.
  CM_MAX_RESIDUE_COUNT for max_residues
- esl_composition_*() and esl_msaweight_*() calls require .h inclusion
- cm_tophits_RemoveOrMarkOverlaps adds do_clans arg; pass FALSE

revised how 'make check' copies easel miniapps. cp fails, because
files are identical; added if check for miniapps existing already.

in configure.ac, revised how the impl symlink is made. AC_CONFIG_LINKS
should not be used to link directories. Instead, do
AC_CONFIG_COMMANDS. (TODO: H3 configura.ac needs this too.)

Avoid zero mallocs; use ESL_MAX(1, size) as workaround. (cm_mx.c, cm_pipeline.c)

Fixed missing comma in --notrunc ESL_OPTIONS incomp list.

bug-i44.pl needed chmod +x",2016-05-06T14:22:38Z,cryptogenomicon
be08dd7240b40ba75d184fcb2b4dccf7256e0615,cryptogenomicon,sean@eddylab.org,"Converts ESLX_MSAFILE to ESL_MSAFILE.

Belatedly completing the implementation of the new ESL_MSAFILE
parsers, by converting the interim ESLX_MSAFILE to ESL_MSAFILE, and
eslx_msafile_*() functions to esl_msafile_*(). Old interface is
retained as ESL_MSAFILE2, because we need to keep supporting --small
option in some tools including easel miniapps.",2016-05-04T15:31:36Z,cryptogenomicon
f5feaab5b3875cef798c068c2095fec79665170a,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Revert ""Changes made so that a make in 'infernal/rmark' will work:""

Reverting 9ad7308, which was accidentally merged from master to 1.1
branch yesterday with 1f04201.

This reverts commit 9ad73083a9094b09454c531f7bae35c1ed8cdae5.",2016-04-27T15:37:08Z,nawrockie
d865756a10922b753341c478ab55f0f75d0b17ce,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Revert b6b9f2c ""Adding --maxtest and --maxtrain flags to rmark-create, so I can produce a ""twilight-zone"" plot from Rfam that's kinda like Sean's pfam-based twilight-zone plot. Simple enough - just build training and test sets as before, then randomly select subsets based on the values of the new flags (by default, I'll use --maxtrain 1, and probably --maxtest 40)""

Which was accidentally merged from master to 1.1 branch yesterday with
""1f04201""

This reverts commit b6b9f2c844b6df6a6b5b61cd5232908e0e0ffed3.",2016-04-27T15:34:50Z,nawrockie
56cd87df1d36a2916cbabb9a0cfe67b4ce9d6366,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Revert 75d73f4 ""Updating the rmark-create program for the purposes of
""
Which was accidentally merged from master to the 1.1 branch in
1f04201.

This reverts commit 75d73f4ad2c8acf30eaaf0be0de056f2d0567d3b.",2016-04-27T15:33:18Z,nawrockie
25f485308f03171b42855e382d5f4c7bc2b0e413,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Cleaning up mistakes in previous revert commit.,2016-04-27T15:29:08Z,nawrockie
9ffe089f0f238f7f9ff2e04c689616e2ce9fa950,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Revert ""Changes to make Infernal compile given recent hmmer changes, most""

This reverts commit ca845db6aeed0f4be16b9e842dfd6545b83e207b.",2016-04-27T15:04:43Z,nawrockie
e9269f6cb4de7d54e593746a9553d3d455af238b,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Reverting configure.ac to infernal-1.1 branch version, copied from src distro of infernal-1.1.1, following accidental merged with master's configure.ac yesterday.",2016-04-27T14:24:21Z,nawrockie
ba04edd7ad5f66fcafccdc75b71e958de4867680,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Inconsequential spacing change to pipeline.tex. Still investigating detached head.,2016-04-27T01:33:37Z,nawrockie
feae28a679fd574c527aab06631010a68e21b8aa,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Inconsequential spacing change to more.tex. Still investigating detached head.,2016-04-27T01:27:48Z,nawrockie
1f04201c3056ffbdcdf2570b3de7c05a03045551,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixed conflicts from automatic merge.,2016-04-27T01:02:39Z,nawrockie
47e02776cc90bb656e18bd9de857a638aa97547d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Added newline to end of cmbuilformats.tex. Still investigating detached head.,2016-04-27T00:47:30Z,nawrockie
0a976f7ffa5ae2c3d01296b81d52bb28a2171e7f,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Added newline to end of cmbuild.tex. Inconsequential change to test git commit after Sean reported detached head in 1.1 branch.,2016-04-27T00:42:19Z,nawrockie
3fd69d07592886e960c4a86d7233d7e116b5df3c,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Added newline to main.tex, inconsequential change to check git status after Sean reported detached head on 1.1 branch.",2016-04-27T00:31:58Z,nawrockie
d8352498fb5c74f09a2bfcfa5c169180e8caaddf,cryptogenomicon,sean@eddylab.org,"One p7_oprofile_Clone() call updated to p7_oprofile_Shadow(),
following API change in hmmer.

'make tags' changed to call a new makeTAGS.sh script instead.  By
running ./makeTAGS.sh directly, you can use tag searching without
needing to ./configure a Makefile. In my src/, I now create a
supertags file for HMMER, Easel, and Infernal, so I can easily search
all our Easel- or HMMER-dependent code when I'm changing something in
an API (like p7_oprofile_Clone() getting renamed).",2016-02-29T17:02:49Z,cryptogenomicon
6fc6b291cf419be389ffb668885b250e4268dfe8,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Removed COPYRIGHT and updated LICENSE to BSD, modelled on current (master branch) revisions of COPYRIGHT file in HMMER in Easel.",2016-02-19T15:07:49Z,nawrockie
212211f66018f59807100cf0945592f177c3ee07,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixed off-by-one in array allocation introduced in recent bug fix.,2016-01-27T20:50:50Z,nawrockie
e795455817066b1944e9611c7bbf1a927f8b9168,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,Fixed off-by-one in array allocation introduced in recent bug fix.,2016-01-27T20:40:27Z,nawrockie
4a1f8eb8bd73fb223c9c8e61a521b1ca02252455,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixed and logged bug i44. Here's the BUGTRAX entry:

The --mapstr option in cmalign results in the output alignment
including the SS_cons annotation from alignment <f> where <f> is the
alignment used to build the CM being used provided with --mapali
<f>. For example: 'cmalign --mapali my.stk --mapstr my.cm new.stk'.
(--mapstr must be used in combination with --mapali). The bug is that
if any of the annotated basepairs in 'my.stk' were actually broken by
the consensus/insert column definition in cmbuild when the model was
built, then the output alignment 'new.stk' would have broken basepairs
annotated. For example if columns i and j (with i < j) are paired in
my.stk and column i is a consensus column in the model my.cm but j is
*not* a consensus column, then in new.stk column 'i' would be
annotated
as a left half of a basepair but column 'j' would be annotated as a
'.' (if at all, since it's an insert column it may not appear in
'new.stk'). So the output structure would likely not be a legal
secondary structure.

Fix is to check for this case in cmalign.c:map_alignment() and remove
the broken basepair halves by changing them to '.'. The test script
checks that both a broken non-pseudoknotted basepair and a
pseudoknotted broken basepair are both correctly removed.",2015-10-28T17:35:26Z,nawrockie
88e2f5c85ce6f089059d7c2f0f7f4b438d03679d,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Modified bug fix in previous commit to work for pseudoknots, and it is a little cleaner now. Next step is to document in BUGTRAX.",2015-10-28T17:35:17Z,nawrockie
1ef0f0aa02ef606c93a974239749936e691e4014,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"First Infernal commit (at least by me) under git control. First of
several commits that will fix a bug with cmalign --mapstr. --mapstr
only works in combination with --mapali <f>, and allows user to
annotate output cmalign alignment with structure from input alignment
used to build the CM (provided as <f> with --mapali). The bug is that
if the original structure in the seed was modified by cmbuild
(e.g. a basepair existed between one consensus and one non-consensus
column, and was therefore removed), this would be included as a half
basepair in the output alignment from cmalign. Code wasn't being
careful enough to catch this case. I'll document the bug fully in
BUGTRAX when it's completely fixed.",2015-10-28T17:35:05Z,nawrockie
6be76cdc40de985f43aa6df330e1abb0645afcce,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Fixed and logged bug i44. Here's the BUGTRAX entry:

The --mapstr option in cmalign results in the output alignment
including the SS_cons annotation from alignment <f> where <f> is the
alignment used to build the CM being used provided with --mapali
<f>. For example: 'cmalign --mapali my.stk --mapstr my.cm new.stk'.
(--mapstr must be used in combination with --mapali). The bug is that
if any of the annotated basepairs in 'my.stk' were actually broken by
the consensus/insert column definition in cmbuild when the model was
built, then the output alignment 'new.stk' would have broken basepairs
annotated. For example if columns i and j (with i < j) are paired in
my.stk and column i is a consensus column in the model my.cm but j is
*not* a consensus column, then in new.stk column 'i' would be
annotated
as a left half of a basepair but column 'j' would be annotated as a
'.' (if at all, since it's an insert column it may not appear in
'new.stk'). So the output structure would likely not be a legal
secondary structure.

Fix is to check for this case in cmalign.c:map_alignment() and remove
the broken basepair halves by changing them to '.'. The test script
checks that both a broken non-pseudoknotted basepair and a
pseudoknotted broken basepair are both correctly removed.",2015-10-28T17:09:31Z,nawrockie
938321c3a6bb0472412746477afbc6540ea62794,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"Modified bug fix in previous commit to work for pseudoknots, and it is a little cleaner now. Next step is to document in BUGTRAX.",2015-10-28T16:25:55Z,nawrockie
420d392d064da0e3f98cfa9ee97c2e6115f15262,Eric Nawrocki,nawrocke@ncbi.nlm.nih.gov,"First Infernal commit (at least by me) under git control. First of
several commits that will fix a bug with cmalign --mapstr. --mapstr
only works in combination with --mapali <f>, and allows user to
annotate output cmalign alignment with structure from input alignment
used to build the CM (provided as <f> with --mapali). The bug is that
if the original structure in the seed was modified by cmbuild
(e.g. a basepair existed between one consensus and one non-consensus
column, and was therefore removed), this would be included as a half
basepair in the output alignment from cmalign. Code wasn't being
careful enough to catch this case. I'll document the bug fully in
BUGTRAX when it's completely fixed.",2015-10-28T15:05:06Z,nawrockie
e2c2c9eaa39068c825391b148f3c3d091ca47b71,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4769 from 1.1 release branch to trunk with command:

svn merge -r 4768:4769 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4770 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2015-02-23T14:56:19Z,nawrockie
4a5ff76f4d91372d60dd6916fa47707abf625f7f,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --onlytrunc option to cmsearch/cmscan, which mimics nhmmer in
that there is no preference for full length hits over truncated hits. 
This is sometimes useful for group I intron searches when it is
expected that the intron will be split in two, with a ORF in between
the two parts.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4769 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2015-02-23T14:53:25Z,nawrockie
305add1af962ba18000af07edab559b4b18f9a2a,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4763 from 1.1 release branch to trunk.

commmand used: 
svn merge -r 4762:4763 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4764 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2015-01-24T19:01:58Z,nawrockie
b768bb09decc221924301d18b2f1daf6d76c9def,Eric Nawrocki,eric.nawrocki@gmail.com,"'cmscan --tblout <s> --fmt 2' now includes additional fields
indicating for hits with a better scoring overlapping hit, the index
of that overlap. Potentially two indices are printed: the highest
scoring overlapping hit, and the highest scoring overlapping 'winning'
hit, if it differs from the former. A 'winning' hit is a hit for which
no higher scoring overlapping hit exists. 

Both fields will be useful in the update version of SSU-ALIGN.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4763 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2015-01-24T19:00:44Z,nawrockie
40af2933afe864c193966f362a64185a3fd85860,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4761 from 1.1 release branch with command:

svn merge -r 4760:4761 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4762 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-12-17T14:58:34Z,nawrockie
65a2e27564621a4c6ee1726092e9658db71087ec,Eric Nawrocki,eric.nawrocki@gmail.com,"cmscan: MSV data is now saved in memory, instead of reread for each
sequence. HMM and CM data is still read per sequence (but only when
needed). Implemented for serial, threaded and MPI.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4761 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-12-17T14:57:12Z,nawrockie
ca3c2d3a9f2efc4e54e73c2bafa4d13cbf676efc,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4759 from 1.1 release branch to trunk.

Command used: svn merge -r 4758:4759
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4760 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-12-02T16:07:30Z,nawrockie
1d474bc24c39d82643a678bd51a75b0d0db36861,Eric Nawrocki,eric.nawrocki@gmail.com,"- Fixed MPI version of the bug fixed in r4757 (CM index was not a unique
  identifier -- it is now).

- added support for marking overlapping hits on a single
  sequence/strand between different models for cmscan. Hits which have
  a higher scoring overlap to a different model are now annotated in
  cmscan --tblout output, but I'm not sure if I'll keep this as I
  don't really want to modify the 1.1 --tblout format. I may make a
  new --rfamtblout option soon that creates a tabular file that
  includes this additional annotation.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4759 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-12-02T16:05:48Z,nawrockie
cc751c34a800516982ebea1d051743fcd7c26175,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4957 changes from 1.1 release branch to trunk.

Command used: svn merge -r 4756:4757 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4758 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-11-26T17:06:22Z,nawrockie
0d6b684ae9e4deab4ec6d7ff21225589fdf0e4a4,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a bug in cmscan in which some hits were defined as overlaps and
one was removed erroneously. This only occured in threaded mode when
multiple CMs were given the same index, which is supposed to be a
unique identifier. The idx for each CM is now unique, even in threaded
mode. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4757 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-11-26T17:03:58Z,nawrockie
24d8e66a3e9049a227b1854449fcf1f858bb438b,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4755 to trunk from 1.1 release branch.

svn merge -r 4754:4755  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4756 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-11-20T19:28:58Z,nawrockie
06f5d413b229ffdde5d962420e2f037b7d037f75,Eric Nawrocki,eric.nawrocki@gmail.com,"Reworked cmscan's handling of long query sequences. Previously each
chunk (100 Kb) was searched by each model before moving onto next
chunk. Now, all chunks of a sequence are searched by each model before
moving onto next model. This alleviates bottlenecks in threaded and
MPI, and also corrects a problem with the previous implementation
which determined the overlapping region between chunks based only on
the first model read, when it should be based on the current model,
which it is now.

Also modified how 'block' size, the number of models per thread/worker,
is determined. Previously it was hard-coded at 25, now it is
determined based on number of threads/workers available with the goal
of evenly distributing all models to all threads/workers. Added
--bsize <n> option for overriding this auto-determination.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4755 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-11-20T19:24:04Z,nawrockie
cf13472e1270b2f1b38e7ef7aa9a94ad21a0518e,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4753 to trunk from 1.1 release branch.

svn merge -r 4752:4753  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4754 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-11-19T19:55:50Z,nawrockie
485b461714af34fd5b2170c459e388a7c232267a,Eric Nawrocki,eric.nawrocki@gmail.com,"cmscan now breaks query sequences into overlapping chunks of 100Kb
(identically to how cmsearch does) and scores all models against each
strand of each chunk. Serial, threaded, and MPI modes have all been
updated. This is a major step towards using 'cmscan' as a replacement
for Rfam's 'rfam_scan.pl'.

- 10 Mb sequence limit is no longer needed, cmscan will now work on
  large chromosomes.
- cmsearch and cmscan results with same models, same sequences and
  same filter thresholds should give identical results.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4753 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-11-19T19:50:40Z,nawrockie
4c2e63b3f056186bdd75cf99ceaa536fd82ec5f3,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4950 changes from 1.1 release branch to trunk.

Command used: svn merge -r 4749:4750 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4751 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-10-24T15:54:03Z,nawrockie
45919b55e9db1de605d8d61d8755f99d41f7a8a6,Eric Nawrocki,eric.nawrocki@gmail.com,"Added 'seqlen' field to special tabular output when --trmF3 is used to
denote full sequence length, for use in SSU-ALIGN.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4750 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-10-24T15:52:17Z,nawrockie
302f7aa0a85739a3b53350fa69ccfacfc093c38c,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from 1.1 release branch r4747:r4748.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4749 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-10-22T19:11:24Z,nawrockie
ce06625af38d7f8a3247b2c8a88b944c00e02276,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified behavior of --trmF3 option, which terminates after the F3
(local HMM Fwd) filter stage and outputs surviving windows. This
option is used by SSU-ALIGN to classify sequences as arc/bac/euk based
on HMM scores. Previously, all surviving windows were output, but I
realized there could be overlaps, which is problematic for SSU-ALIGN,
so now windows are added as hits to a CM_HITLIST and then overlaps are
removed using Infernal's existing overlap removal machinery. The
tabular output is different for these hits (both stdout and --tblout)
because we don't have all the information we do for traditional hits
which survive all filter stages.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4748 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-10-22T19:06:43Z,nawrockie
b6084f3918504d06a1b964d9ab82cc358a49b733,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged 1.1 release branch changes in r4775 to trunk, adding
--noforecast option to cmcalibrate.

Command used: 
svn merge -r 4774:4775 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4746 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-10-17T12:57:45Z,nawrockie
403ad48b1586664385f33ffb9153acf348af27fe,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --noforecast option to cmcalibrate, which skips the step that
predicts and displays the running time. This can take a significant
fraction of total running time for models that have large Ws,
i.e. LSU, SSU, etc. when run on many CPUs with MPI.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4745 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-10-17T12:55:01Z,nawrockie
0bb5d205182b3e489b20b213ed4c3b0041d58e73,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed --only53trunc option, which I should have removed in the
previous revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4741 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-09-30T14:30:50Z,nawrockie
0fa2780bcbc15b8f2e5e74da434b695f3787ece8,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed --only53trunc cmsearch/cmscan option introduced in r4738. 

Added --onepass cmsearch/cmscan option which forces only the best
scoring HMM pipeline pass to progress to the CM stages (CYK and
Inside) in the specific case where all passes identify either zero
envelopes or a single envelope encompassing the full target sequence. 
This addresses the problem that a partial SSU sequence was typically
being aligned 4 times, in the standard pass, 5' truncation pass, 3'
truncation pass, and 5' and 3' truncation pass, slowing down cmsearch
about 4-fold relative to the new --onepass implementation (and about
8-fold relative to cmalign). 

This required a reorganization of the all important cm_pipeline()
function, which now loops over all passes twice, once for the HMM
filter stages, and then again for the CM stages. Previously, there was
a single loop over all pipeline passes, in which all filter stages
were carried out for each pass.
 --This line, and those below, will be ignored--

M    src/cmsearch.c
M    src/cm_pipeline.c
M    src/infernal.h
M    src/cmscan.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4740 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-09-30T14:28:46Z,nawrockie
125f98f86cdcf0b48fb99f8cbf7a68f95ae7b91f,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --only53trunc option, for forcing 5' and 3' truncation
mode. We'll enable this in updated SSU-ALIGN when we know that the full
sequence is homologous (as inferred from P7_DOMAIN_DEF's mocc
array). This was motivated by the common case of a partial SSU
sequence in a SSU dataset, for which default cmsearch will take up to 
8X longer if it doesn't already know we're dealing with a partial 
homolog that spans the full target sequence because it tries standard
alignment and all 3 types of truncated alignment (5', 3' and 5&3'). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4738 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-09-29T14:30:28Z,nawrockie
141a9e4b53f7721901c6a10a1b37d9a3aee24995,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --5trunc and --3trunc options to cmsearch/cmscan and necessary
support code in cm_pipeline.c and infernal.h. These allow only 5' or
3' truncated alignment, which is useful for the updated SSU-ALIGN
because we'll pass subsequences into cmsearch and want to be able to
restrict the possible types of truncated alignment. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4734 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-09-26T17:56:47Z,nawrockie
86fee03a2692341ac63ae1e1ca0a846d55902f8e,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --trmF3 option to cmsearch/cmscan, for terminating a pipeline
after the F3 (local Fwd) stage and outputting surviving windows. This
option will be used in the Infernal 1.1-updated version of SSU-ALIGN.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4733 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-09-25T15:01:04Z,nawrockie
a8a04f9bce3f3e5a35a9f3546f31e053bafa8336,Eric Nawrocki,eric.nawrocki@gmail.com,"Added -h (--dereference) flag to tar commands to follow HMMER commit
r4728.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4730 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-09-10T13:34:25Z,nawrockie
483a4bdbdbd74230b97da0b1006b2762b6f9488f,Eric Nawrocki,eric.nawrocki@gmail.com,"Added -h (--dereference) flag to tar commands to follow HMMER commit
4728.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4729 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-09-10T13:33:58Z,nawrockie
7baa79bd3c6fa3d32503ad8013aba6be516f0d3f,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated 00CHECKLIST with minor changes done during 1.1.1 release in
1.1 release branch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4715 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-23T15:13:40Z,nawrockie
533a01f3646e3c93513f6d2be0e0c5b1612c07ab,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated 00CHECKLIST with minor changes made during 1.1.1 release
(mostly search/replace '1.1' for '1.1.1').


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4714 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-23T15:13:05Z,nawrockie
714e834ec7783eabfe8c94d1c95f2ad91ff1ab97,Eric Nawrocki,eric.nawrocki@gmail.com,"Merging changes made in 1.1 branch during 1.1.1 release back to trunk
(revs 4707->4711).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4713 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-23T15:11:27Z,nawrockie
76d59da69712b9df1537e29b2d04e69087f569f2,Eric Nawrocki,eric.nawrocki@gmail.com,"Added bug-i43 test to dev_testsuite.sqc, which has a bug test section
that is supposed to mirror testsuite.sqc. 

Fixed a typo in install.tex.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4710 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-23T09:59:58Z,nawrockie
2a615e00ecfc03b0a488c694da6a8d65641e7f66,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated version and date in preparation for 1.1.1 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4708 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-22T13:11:50Z,nawrockie
c2a5a2c97f46e4b606282b7e25eade49a343691e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4707 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-21T18:05:07Z,nawrockie
a5d91389a4c6f848a13bd206820642fc1c26563e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4706 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-21T18:04:31Z,nawrockie
cbcc7b46dce8954d78b48ac30affd8326fb13041,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4700 changes to trunk, from 1.1 release branch.

Fixed and logged bug i43.

Command used: svn merge -r 4699:4700 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4701 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-18T17:49:42Z,nawrockie
5ef84aa829b58cd34006e7b7b7cf275f78acfea7,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed, logged and added test scripts for bug i43, related to the
possibility of optimal accuracy parsetrees that include illegal local
begins. I've only seen the bug manifested for large models (Euk LSU)
which explains why it's persisted until now since these large models
did not previously exist in Rfam. The bug occurs because of a build-up
of round-off error due to the logsum lookup table, which can only get
high enough to cause a problem with a big model. 

The fix is simple, to check to make sure a local begin is legal before
allowing it. With normal size models, an illegal local begin would
never have a better score than a legal one, but with a large round-off
error that can happen in a big model, an illegal local begin can have
a better score than a legal one.)

xref: /groups/eddy/home/nawrockie/notebook/14_0624_inf_parsetree_bug/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4700 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-07-18T17:48:00Z,nawrockie
75d73f4ad2c8acf30eaaf0be0de056f2d0567d3b,Travis Wheeler,travis.wheeler@traviswheeler.com,"Updating the rmark-create program for the purposes of 
producing a ""twilight zone"" plot. This requires that I
compute the percent identity between each planted (test)
sequence and some appropriate representative of the query
(train) family. Previously, this was written with plans
to compute only the twilight zone for single sequence
queries, so I just picked one sequence for each family,
and used that as the ""train"" ... and computed pct_id on
that. When I decided that I wanted to show the benefits 
of profile search, I needed to change this to use a full
""train"" alignment, then use the consensus of the alignment
as the single query sequence (and the sequence for which
pct_id is computed). 

In addition to changes in rmark-create, this required 
a modification to esl_msa_ReasonableRF(), a function 
that appears to have been orphaned (not used elsewhere),
but did most of what I needed already. The change 
simply (1) makes the function write the RF line to the
place that the comments say it will (the passed rfline
char*), and (2) gives the option to write the consensus
sequence to the RF line (as Infernal seems to do by
default), rather than a simple run of 'x' and '.'.

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4680 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-06-04T00:38:52Z,N/A
0fe12b38201835f3c59bca5ed9ada15c5b579511,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4678 changes to trunk, from 1.1 release branch.

Changed how maximum HMM banded matrix size is defined in search/scan
pipelines. See r4678 in 1.1 release branch for more details.

Command used: svn merge -r 4677:4678 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4679 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-06-02T13:59:17Z,nawrockie
64742c35138cd28069a00706fd1fd692004d12e2,Eric Nawrocki,eric.nawrocki@gmail.com,"Added the first new post-v1.1 feature that's not a bug fix. The
maximum Hmm banded matrix size that's allowed in a search/scan
pipeline is now model-size-dependent. Previously it was 128.0 Mb for
all models by default (but settable with --mxsize). It's still
settable with --mxsize, but by default it is now scaled from 128.0 Mb
to 512.0 Mb depending on the current model's window size (W)
parameter. For models with W<=1000 (the vast majority of Rfam models)
it will be 128.0. For models with W>=3000 it will be 512 Mb. For
anything in between (1000 < W < 3000), the maximum size is calculated
as a linear function of W capped at 128 and 512.

The tradeoff here is, as usual, speed vs sensitivity. A smaller
maximum size results in slightly faster searches/scans because the HMM
banded matrix size limit acts as a filter, with higher stringency for
smaller maximum matrix sizes. But in my testing for LSU models, 128.0
is too limiting and causes the loss of an unacceptable number of real
LSU hits. Using 128.0 Mb is also probably a bit too strict for SSU
models, for which the new scheme sets the matrix size to about 300
Mb. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4678 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-06-02T13:57:16Z,nawrockie
ec0e68e913bb36701764c34145fcbd0c4e53c9a6,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from the 1.1 release branch related to the logging and
fixing of bug i42. Command used:

svn merge -r 4675:4676 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4677 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-05-30T18:32:25Z,nawrockie
54af08945908b623f3bde025a914f12ec6a758fc,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i42 in the 1.1 release branch.

Summary from BUGTRAX:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In the integral cm_pipeline.c::pli_dispatch_cm_search() function, the
HMM bands are calculated and tightened if necessary until the
resulting matrix is below our maximum allowed size (typically 128 Mb).
For the non-truncated case, the cp9bands_t 'tau' value is the only
value that is changed during band tightening (tau is the amount of
probability mass outside each band). However, in the truncated case 
two additional parameters, generically called 'thresh1' and 'thresh2'
are used to limit what types of marginal alignments (J, L, R, T) are
allowed at each state. 'thresh1' is the probability threshold for
calling a position 'maybe used', and 'thresh2' is the threshold for
calling a position 'likely used'. (See
hmmband.c::cp9_PredictStartAndEndPositions() for details on how these
thresholds are used.) When bands are
tightened for a truncated alignment, 'thresh1' and 'thresh2' can be
modified in addition to 'tau' with the effect of shrinking the size of
the required matrix in an attempt to get it under the maximum allowed
size. 

If, during this tightening of bands, a matrix is eventually determined
that is below our maximum, we continue with that matrix and then
(correctly) reset the tau, thresh1, and thresh2 values in the cm and
cp9bands_t objects back to their original values before leaving
pli_dispatch_cm_search().

However (and this is the bug), if 'tau', 'thresh1' and 'thresh2' are
all raised/lowered to their maxima/minima allowed and the matrix is
still above our max allowed size, then we have what we call a 'matrix
overflow', and the subsequence being evaluated is abandoned. A matrix
overflow acts as an independent filtering stage, removing any hits for
which we can't define a matrix within our allowed parameters for
'tau', 'thresh1', 'thresh2' and our maximum allowed matrix size. In
the case of an 'overflow' the 'tau' value of the cm is properly reset
to its original value, but the 'thresh1' and 'thresh2' values of the
cp9bands_t object were not being reset. Thus if a subsequent call to
pli_dispatch_cm_search() was made, they would begin at their near
maxima/minima values leftover from the previous call.

The fix is simple: reset them to their original values in the event of
a mx overflow.

I did not add a test for this in the testsuite because a simple
example of it would be very difficult to construct.

This bug was fixed in the Infernal 1.1 release branch as of revision
4676, and 4678 in the trunk.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4676 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-05-30T18:30:45Z,nawrockie
c8b0e784234fb48c932655ab4a5b88518cac3dfd,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from the 1.1 release branch for a better fix to bug
i41, with the command:

svn merge -r 4665:4666 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4667 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-05-09T13:41:22Z,nawrockie
004faf963081cc0e684fb128fc26abdab1c10f74,Eric Nawrocki,eric.nawrocki@gmail.com,"Implemented a better fix for bug i41 which was fixed in a recent
revision (r4664). 

The new fix is in cm_file.c::cm_file_WriteBinary() which tries to
determine the file offset at which the p7 filter is stored because
this can be returned optionally to the caller. When the binary output
is piped to cat or used in combination with an 'ssh' command this
offset cannot be determined (for reasons I don't pretend to
understand).  However, cmconvert's cm_file_WriteBinary() does not
request this offset be returned so the code doesn't need to try to
determine it.

So, the fix is to check if the file offset for the fp7 is going to be
returned before trying to determine it. Since it's not in cmconvert,
we avoid trying to determine it and avoid the failure.

I removed the requirement of '-o' with '-b' in cmconvert, which was
added as part of the r4664 fix. I left in the '-o' option in though,
since it could be useful.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4666 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-05-09T13:40:09Z,nawrockie
37da17a4cfbf406e2cbc15753d909a2c65a853fa,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from the 1.1 release branch for fixing bug i41, with
the command:

svn merge -r 4663:4664
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4665 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-05-09T13:08:00Z,nawrockie
9d89b8ef96d0a2b50f517426e85458beb3ef9676,Eric Nawrocki,eric.nawrocki@gmail.com,"Logged and fixed bug i41 (first bug found since 1.1 release in October
2013), a minor bug related to cmconvert -b (binary) output. In certain
cases, including when called as part of an 'ssh' command, and when
piped (e.g. 'cmconvert -b my.1p0.cm | cat'), 'cmconvert -b' will
fail. Reported by Eric Deveaud at the Institut Pasteur.

The fix I implemented, which was recommended by Eric, was to add a
'-o' option to cmconvert and require it when '-b' is used. 

No script to test this bug was added to the testsuite because once the
'-o' was added and required with '-b' it became impossible to
reproduce.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4664 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-05-09T13:01:16Z,nawrockie
b6b9f2c844b6df6a6b5b61cd5232908e0e0ffed3,Travis Wheeler,travis.wheeler@traviswheeler.com,"Adding --maxtest and --maxtrain flags to rmark-create, so I can produce a ""twilight-zone"" plot from Rfam that's kinda like Sean's pfam-based twilight-zone plot. Simple enough - just build training and test sets as before, then randomly select subsets based on the values of the new flags (by default, I'll use --maxtrain 1, and probably --maxtest 40)

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4649 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-04-11T19:38:16Z,N/A
9ad73083a9094b09454c531f7bae35c1ed8cdae5,Eric Nawrocki,eric.nawrocki@gmail.com,"Changes made so that a make in 'infernal/rmark' will work:

Updated hmmer section of configure.ac to be consistent with changes
made since the Infernal 1.1 release branch (June 2012). './configure'
now works in top-level infernal directory.

'make' in Infernal top-level still does not work. I'll fix that when
necessary.

rmark-create.c: added '#include ""esl_composition.h""'.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4644 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-04-10T13:19:41Z,nawrockie
a7f47444950ad5458e34b47f933b4ec586cc4af8,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo in caption of Figure 1 in pipeline section, in 1.1 release branch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4626 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-03-07T13:47:11Z,nawrockie
83d6c0a6f90c35cba149c892355bd27b486376d6,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo on legend of Table 1 in pipeline section.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4625 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-03-07T13:46:41Z,nawrockie
86d198ec1e13edce72a5b6bba901f7e22b742aac,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo in pipeline section of userguide in 1.1 release branch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4624 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-03-07T11:02:29Z,nawrockie
3325c93d58bd7dff770314f2cdf9ff16d98a69de,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo in pipeline section of user's guide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4623 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2014-03-07T11:00:30Z,nawrockie
9d03fb91827e97cb93eaf6a186ad3a06c2437e3b,Eric Nawrocki,eric.nawrocki@gmail.com,"Added instructions for creating Windows/Cygwin binaries to
00CHECKLIST. See notes in
~nawrockie/notebook/13_1205_inf_1p1_windows_cygwin/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4567 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-12-06T17:21:05Z,nawrockie
e4bdae4f0fbfc5f68307090d2a200d771833d2d5,Eric Nawrocki,eric.nawrocki@gmail.com,"Added instructions for creating Windows/Cygwin binaries to
00CHECKLIST. See notes in
~nawrockie/notebook/13_1205_inf_1p1_windows_cygwin/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4566 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-12-06T17:20:38Z,nawrockie
c227e7f1172c9cd07c8442324d02109cee896202,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed revision number for 1.1 release tag.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4558 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-31T18:07:52Z,nawrockie
81967fe7e03ee490469c68a20d0e50cf01b3e907,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed release number for 1.1 release tag.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4557 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-31T18:07:21Z,nawrockie
24711c5dacab60e1b966517ae2ac7d3b3755d067,Eric Nawrocki,eric.nawrocki@gmail.com,"Typo fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4555 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-31T17:53:53Z,nawrockie
64d4502a1941c1f1fdb854d453fede738c42cf7a,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated 00CHECKLIST, which now includes notes from 1.1 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4554 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-31T17:44:30Z,nawrockie
a4b3ab66d536e738c981885aa8818c8c6d0bf5a6,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating 00CHECKLIST, which now includes notes from 1.1 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4553 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-31T17:43:55Z,nawrockie
3f2ca55ecef458504f08ef614ca77d65e08a4156,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes during 1.1 release process back to trunk with
command:

svn merge -r 4522:HEAD
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4552 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-31T17:41:22Z,nawrockie
8b249925a723fdfba37dd511729f1495f006b83d,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor correction.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4547 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-24T00:21:21Z,nawrockie
2b5023baa81bc46bbecb8d6a866af5b5a6caf838,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated blurb in user guide about how to cite Infernal to specify new
1.1 applications note that's in press at Bioinformatics.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4546 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-23T20:32:58Z,nawrockie
b9799c3113d9bffa281ebecb55cf2f61a26dce6e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo in release notes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4544 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-21T17:42:16Z,nawrockie
229e603e931fc89537b20798bf5ea172225c0b6d,Eric Nawrocki,eric.nawrocki@gmail.com,"Updates for 1.1 release. 

BUGTRAX: added 1.1 release date after bug i40.
configure.ac: updated date and version.
tutorial/minifam.cm.i1m: apparently this format changed since the
                         original commit and just catching it now,
                         this file is included as an example of the
                         binary cmpress'd CM format.
documentation/userguide/*.tex: updated from 1.1rc4 executables to 1.1.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4543 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-10-21T17:27:20Z,nawrockie
dda49b271593082fd43b1f8a6a2be75ba036aa8f,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from the 1.1 release branch for fixing bug i40, with
command: 

svn merge -r 4526:4527
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4528 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-09-09T19:12:59Z,nawrockie
d4073394b181564474c3750432483f5b6a09385a,Eric Nawrocki,eric.nawrocki@gmail.com,"Logged and fixed bug i40. BUGTRAX entry included below. 

bug-i39.pl: fixed typos.

BUGTRAX entry:

ID              i40
TITLE		cmcalibrate segfaults on big (LSU) models
STATUS          CLOSED
XREF            /groups/eddy/home/nawrockie/notebook/13_0904_inf_cmcalibrate_lsu_bug/
REPORTED_BY     Eric Nawrocki
CLOSED_DATE     EPN, Wed Sep  4 11:55:49 2013
DESCRIPTION    

When defining the number of cells in the alpha_begl section of
CM_SCAN_MX, there was an overflow for very large models. The 
overflow never occurred for any Rfam 11.0 models, but did for 
at least some eukaryotic LSU rRNA models. The fix is to change 
how the number of cells in the 'begl' section of the scan matrix are
defined. From cm_mx.c:cm_scan_mx_floatize(), one example of the 
old way that did overflow: 

   smx->ncells_alpha_begl = (smx->W+1) * n_begl * (smx->W+1);
         
new way that does not:
 
  smx->ncells_alpha_begl = (smx->W+1);
  smx->ncells_alpha_begl *= n_begl;
  smx->ncells_alpha_begl *= (smx->W+1);

Note that ncells_alpha_begl is an int64_t.

There were several other places I made similar changes to hopefully
prevent similar overflows, although I limited the changes to those
involving ncells_alpha or ncells_alpha_begl in CM_SCAN_MX or 
CM_TR_SCAN_MX data structures. Use 'svn diff' for specifics.

I decided not to add a test for this bug in the testsuite, mainly 
because it only occurs for such large models that running the test
would take several minutes (at least, even with --forecast).

This bug was fixed in the Infernal 1.1 release branch as of revision
4527.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4527 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-09-09T19:11:10Z,nawrockie
27018f6af70f11336950d40ea422dfcc887059ce,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4523 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-08-26T14:21:05Z,nawrockie
edf4c7672b131d442133d2d7776e9408c7709b27,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4522 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-08-26T14:20:16Z,nawrockie
9d4dfdc0d230c14990f4503b591eaa03253570ca,Eric Nawrocki,eric.nawrocki@gmail.com,"Added updated 00CHECKLIST, with changes made during 1.1rc4 release
process. 1.1rc4 release now complete.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4502 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-26T18:18:30Z,nawrockie
72ff196d13504fe7772e977c06912d462abd60a8,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes during 1.1rc4 release process back to trunk with
command:

svn merge -r 4495:HEAD
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1

Changes are comprised of: updated configure.ac version number, release
stamp in BUGTRAX, update of release number in userguide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4501 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-26T18:16:51Z,nawrockie
86e34b3a117109a0a8c7582eb65d41073b09c5c2,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated version number for 1.1rc4 release, added release notes and
1.1rc4 stamp after bug i39 in BUGTRAX.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4498 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-26T09:52:44Z,nawrockie
0a4dc6432687f89c1057f1b821eacb526f335ce7,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated userguide for 1.1rc4 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4496 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-25T19:25:33Z,nawrockie
dd62b497c5ff6db77cc7d6c84f37a8df82d34918,Eric Nawrocki,eric.nawrocki@gmail.com,"Belatedly updated 00CHECKLIST for 1.1rc3 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4495 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-24T20:43:24Z,nawrockie
97312d9a85043334c53ac2b039f87793520a1d49,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4492:4493 changes from 1.1 release branch back to trunk. These
changes fix and log bug i39.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4494 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-20T19:19:16Z,nawrockie
c82d4d2a90eca447b211e57e82e84363f599daa2,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i39 in infernal 1.1 release branch. This bug
resulted in potentially corrupt alignments output from ""cmbuild -O""
when used for models with zero basepairs and at least one ROOT_IR
emission (insert following final match position). The error was in the
handling of ROOT_IR 'emitr' parsetree values in the
cm_parsetree_Doctor() function which only gets called for models with
zero basepairs. Fortunately, the fix does not change the results for
any models in Rfam 11 (meaning I don't have to update the Rfam 11 CM
file when this fix is released). The testsuite checks for this bug. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4493 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-20T19:17:46Z,nawrockie
b7606cbf938afc786de1798ae613304d3c4329f5,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4484:4491 changes from infernal 1.1 release branch back to trunk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4492 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-20T13:41:20Z,nawrockie
1f274262a5126ce85573eb66a21f1545f1d7a737,Eric Nawrocki,eric.nawrocki@gmail.com,"rmark-rocplot.c:
Fixed serious bug: a key value was not being initialized to zero. The
'false_pos_per_q' variable (false positives per query) in the
make_plot() function was not being properly initialized to zero.

This bug doesn't change any of my results on login-eddy, because the
value just happened to start out very near zero (< 10^-314) on the
specific compiled executable I used to get benchmark results. However,
when I run it on my laptop the bug changed the output relative to
login-eddy. (The changed results on my laptop reverted to the correct
ones if --enable-debugging was used with configure.)

00README and rmark-po-pp.sh: 
Fixed incorrect description of recently
updated usage of rmark-pp.sh, and updated rmark-po-pp.sh to be
consistent with rmark-pp.sh



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4487 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-17T18:20:30Z,nawrockie
6b6a7918ec5a3f72d0c092a342f739e1d78672cb,Eric Nawrocki,eric.nawrocki@gmail.com,"Added more automated tests for bug i38; these are run with 'make
devcheck'. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4486 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-17T17:41:40Z,nawrockie
aca2c59b08964e53dffb8741367aa906eec01ea6,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i38 in infernal 1.1 branch. The bug is a clean
cmalign failure with an error message if 'cmalign --mapali <f> CM SEQFILE' is
used with a alignment with no SS_cons consensus structure annotation,
even if CM was built with 'cmbuild --noss'. Fix is to add --noss
option to cmalign that must be used in this special case, and only is
valid in combination with --mapali. 

The testsuite explicitly checks for this bug.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4485 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-17T17:36:25Z,nawrockie
89543bfc0cca64dabd657fd8e19da7a034640287,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated for 1.1rc3 release. Merged changes made in 1.1rc3 release
branch (only since release process started -- all intermediate bug
fixes etc had been made as I went since 1.1rc2 release) to trunk by
svn merge from 1.1 branch for revision range r4471:HEAD. Also updated
00CHECKLIST.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4481 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-11T09:58:56Z,nawrockie
3d77cb60e69b1fb6a8b4d567563048c410c45e9e,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified permissions for all perl scripts so they're executable. And
changed testsuite.sqc and dev_testsuite.sqc commands that call them
from 'perl <script.pl>' to '<script.pl>'.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4478 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-05T14:42:37Z,nawrockie
e676d23be2eba2397db63bae3c69770cce947510,Eric Nawrocki,eric.nawrocki@gmail.com,"Actually modified permission of perl scripts by making them executable
with command:

svn propset svn:executable ""*"" *pl

I thought I had done this with the previous commit, but I hadn't.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4477 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-05T14:37:27Z,nawrockie
8f297f6b0f8bfcb0d82ca604688ec7fd267bc05c,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified permissions on all testsuite perl scripts so they're
executable with 'chmod +x testsuiite/*pl'. Updated testsuite.sqc and
dev_testsuite.sqc so that perl scripts are executed by name,
e.g. 'script.pl' instead of 'perl script.pl' as they were
before. Previously, if user had a perl in their path that wouldn't
work with the scripts then they'd get failures. This happened to me
with testing on cf-ubuntu32 which could not use the 'perl' in my
path. Now 'usr/bin/perl' is used.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4476 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-05T14:30:15Z,nawrockie
53e17e01709616cf348eead8ae0f7f92cadb9842,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated dates in COPYRIGHT (changed 2012 to 2013).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4474 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-04T18:58:04Z,nawrockie
466529c4d67204690b2faf8b9000391f99189d1e,Eric Nawrocki,eric.nawrocki@gmail.com,"pdates for 1.1rc3 release. Changed date in configure.ac. Added 1.1rc3
stamp in BUGTRAX. Updated output in tutorial of user guide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4472 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-04T18:48:39Z,nawrockie
242ac6e706458dd55844ad2d69df3b9e07260e89,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4470 from infernal 1.1 branch to trunk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4471 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-04T18:24:02Z,nawrockie
63550a7e047d23c4f545fe998c36e07b33e87451,Eric Nawrocki,eric.nawrocki@gmail.com,"Actual fix to bug i37. Previous fix (r4466) wasn't complete and
actually introduced a new bug (that failed on certain cases that the
code prior to the bug fix would have worked correctly on). This fix
""should"" work for all cases now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4470 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-06-04T18:17:17Z,nawrockie
f7d1244c11314dcbd8a547fe49b53d19b7917848,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4466 from Infernal 1.1 release branch back to trunk with
command:

svn merge -r 4467:4468
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4469 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-05-31T17:58:23Z,nawrockie
2454cc83ee08b48afd884951b8d0792fbef34de6,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed ""Total runtime"" prefix for total CPU timing info to ""# Total
CPU time"". This is only printed if --verbose is used, and it is now
more consistent with other programs. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4468 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-05-31T17:56:47Z,nawrockie
120d09b9ea8ca9ae56efd6f7b9f4f911b5f4b008,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4466 from Infernal 1.1 release branch back to trunk with
command:

svn merge -r 4465:4466
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4467 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-05-31T17:46:35Z,nawrockie
a9d4d8ef3551b12fbf37abca59b8e0f06eab9e50,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i37, reported by Zasha Weinberg. The actual fix
is a one line change in hmmband.c:cp9_ShiftCMBands(). BUGTRAX entry
is appended below.

~~~~~~~~~~~~~~~~~~~~~~~~~~
ID              i37
TITLE		Off-by-one error when shifting HMM bands
STATUS          CLOSED
XREF            Notes in ~nawrockie/notebook/13_0531_inf_1p1rc2_bug_zasha_bandshift
REPORTED_BY     Zasha Weinberg
CLOSED_DATE     EPN, Fri May 31 13:25:01 2013
DESCRIPTION    

As the last stage in the search/scan pipeline, a hit, the start/stop
of which have been defined by HMM banded inside, is excised and sent
to pli_align_hit() to be aligned from 1..L using the full DP matrices so
a traceback can be performed. The first step of pli_align_hit() is to 
shift the CM bands that were calc'ed in the final search stage. They
may shift because we now know the exact start/stop of the hit, and
we're aligning from 1..L instead of i..j (where i may not equal
1). When this shift occurs in cp9_ShiftCMBands() the maximum allowed
'i' value for any imin..imax band was being set as L. In fact, i
should be able to be L+1, so a d=0 length subsequence (d=j-i+1) is
possible for delete states. So the bug fix is to simply change the
maximum allowed value for i from L to L+1.

This bug existed in 1.1rc1 and 1.1rc2, and it's surprising it didn't
expose itself before now. The failure case is apparently a rare one,
when an all delete path is used by a subtree of the model 'after' the
full hit has been emitted. This will likely only happen in global
mode, which is how it was found and which is not default, and which
at least partially explains why it was not discovered earlier.

This bug was fixed in the Infernal 1.1 release branch as of revision
4467.
~~~~~~~~~~~~~~~~~~~~~~~~~~



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4466 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-05-31T17:37:06Z,nawrockie
1382ef7bf3d1d8533e7f57502b6aff603f371dae,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4463 from Infernal 1.1 release branch back to trunk with
command: 

svn merge -r 4462:4463 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1

This updates rmark with minor changes made during preparation of
infernal 1.1 applications note.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4464 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-05-28T19:22:40Z,nawrockie
d50b693097909b63d868994b1a8e18caf73bfdb6,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor changes to rmark made during preparation of infernal 1.1 app note.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4463 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-05-28T19:18:58Z,nawrockie
08b2c4940c181055bc9d924617b089e653232a5a,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4427 from 1.1 release branch back to trunk. DID NOT test that
it compiled and cleanly passed 'make check'. It won't compile
currently because it hasn't been updated for changes in HMMER or Easel
since the Infernal 1.1 release branch was created. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4428 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-04-19T15:53:47Z,nawrockie
cee2eb0117d837dbf7237904a1b41bc488c69168,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i36. This is the first bug reported in Infernal
1.1rc2. BUGTRAX entry with explanation at end of this log.

The actual fix is in cm_dpalign.c.

cm_dpsearch.c, cm_dpsearch_trunc.c and cm_dpalign_trunc.c: adding
check and enforcement that 'kn' is >= 0 during DP
functions. Previously I thought this was always true, but bug i36
revealed it can be false in very rare situations. 

hmmband.c, cm_p7_band.c, cm_pipeline.c, infernal.h: modified the
cp9_ValidateBands() function to take into account if the bands are for
a truncated or non-truncated parsetree which changes what properties
they must have to be 'valid'. This function is never actually called
in infernal unless it is compiled with a debugging level >= 1.

testsuite/*: tests for bug i36 and typo fix in bug-i34.pl

BUGTRAX entry for i36:

ID              i36
TITLE		Rare banded alignment traceback bifurcation offset bug
STATUS          CLOSED
XREF            Notes in ~nawrockie/notebook/13_0418_inf_zasha_banded_bug/00LOG
REPORTED_BY     Zasha Weinberg
CLOSED_DATE     EPN, Fri Apr 19 10:43:56 2013
DESCRIPTION    

In very rare cases, cmsearch was failing during a non-truncated HMM
banded optimal accuracy alignment traceback. There is a single model
for which this bug was observed, and it was reported by Zasha
Weinberg. The problem occurs when tracing back at a BIF_B state where
the z (BEGR_S child) state is either unreachable for any j, or
unreachable for the current j due to hdmin/hdmax band being set as
-1/-2. I thought at first the solution was to check for and catch this
rare case during the traceback, but a cleaner solution (the one
actually implemented) is to change the DP functions
(cm_CYKInsideAlignHB() and cm_OptAccAlignHB()) so they put 'k' instead
of 'kp_z' (for which kp_z = k - hdmin[z][jp_z]) into the kshadow DP
matrix. This prevents the need of reconverting kp_z to k during the
traceback. Since the bug occured at this reconversion step (b/c either
jp_z or hdmin[z][jp_z] was invalid in the rare cases) this solved the
problem and fixed the bug. (Storing k and not kp_z is the way the
truncated versions of these functions were already implemented in
cm_TrCYKInsideAlignHB() and cm_TrOptAccAlignHB()). 

This bug only occured when a B state had a parse subtree of length 0
underneath it and only for optimal accuracy (OA) parsetrees because OA
parsetrees have the odd property that only emissions contribute to the
score. This has the effect that what should be 'impossible' parsetrees
due to the HMM bands become possible (and are sometimes optimal)
because a subtree of length 0 does not contribute to the score, so
effectively any subtree of length 0 is 'possible'. This is not
problematic as long as it doesn't cause a failure downstream in the
code because later code has assumed it won't happen (which is what
happened in the case of this bug).

This bug was fixed in the Infernal 1.1 release branch as of revision
4427.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4427 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-04-19T15:48:36Z,nawrockie
c82ab492ee53fea536da2b0df979d120a5161494,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo I just noticed in the user guide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4411 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2013-03-01T18:49:20Z,nawrockie
6cade6165e2c2c5ae4e4b97702eff662d13846b3,Eric Nawrocki,eric.nawrocki@gmail.com,"Manually merged r4347 from 1.1 branch to trunk: a minor 1-line update
to 00CHECKLIST.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4348 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-17T10:24:11Z,nawrockie
f7aa153453bb3f349478304adbde6301d44548a8,Eric Nawrocki,eric.nawrocki@gmail.com,"Added line to 00CHECKLIST to remind me to update the 'Last modified'
bit of the Infernal website after a release -- which I forgot about
for the 1.1rc2 release until this morning.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4347 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-17T10:22:39Z,nawrockie
bbac4f0ad3365fc07b28a293d476d755c0d57c19,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating trunk, post 1.1rc2 release in 1.1 branch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4346 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-14T20:07:57Z,nawrockie
f45efd3a4e4619d715f1f1f9ada8da2b2093c20d,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated 00CHECKLIST post-1.1rc2 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4345 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-14T20:06:41Z,nawrockie
2357837aa9cb514d12fa097ebe97373eb67b9aa0,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed RELEASE-1.1rc2 notes from trunk, which I recently added in
r4339. This isn't supposed to go in until I merge the my special
working dir of the branch (~/releases/infernal-release/) back into the
trunk after I make the actual release. If it already existed at that
point svn would take issue. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4342 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-14T13:50:32Z,nawrockie
e66ad263b587a1cf2c38c10e4af807282985b8e9,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4340 changes from 1.1 release branch back to trunk. Simple
update of version/date in userguide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4341 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-14T13:43:15Z,nawrockie
a3dac38ac587c316d7302a620b5804d6f3b0a5b1,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated example of -h in userguide to show 1.1rc2 and December 2012
instead of 1.1 and June 2012.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4340 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-14T13:41:26Z,nawrockie
fa7ced65b6a1b21616179aa9a7c7383fa26ec4e8,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4338 changes from 1.1 release branch back to trunk, with command:
svn merge -r 4337:4338 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1

There was a strange conflict with RELEASE-1.1rc2, and I had to 'svn
add' it.

Log from 4338 revision in 1.1 branch:
~~~~~~~~~~~~~~~~~~~~~
Fixed and logged bug i35 in Infernal 1.1 release branch. This bug
commonly caused failures for a specific type of MPI cmcalibrate job:
when the model was large (W>~1500) and number or processors was >60. 

I never fully understood the nature of this bug, but figured out a
workaround. The issue was related to the first MPI_Send() call by
mpi_worker() and/or the first MPI_Probe() call by mpi_master(). It
seems like there is a 'time-out' that occurs by at least 1 worker that
causes the MPI process to fail when the initial mpi_master() step of
forecasting the total run time takes too long. It is only after this
forecast is complete that the master calls MPI_Probe() to receive the
worker's initial MPI_Send() (which is sent almost immediately after the
process starts). For large models, the forecast step can take up to
several minutes, so my guess is that the worker's MPI_Send() gives up
after too long. (If I simplify the forecast so it goes quicker then
the failure does not occur.) However, I never understood why this only
occurs with many processors, as I've never observed the failure with
less than 60 processors. 

The bug is logged in BUGTRAX, but not checked for in the testsuite,
since it requires MPI and only occurs for large jobs that commonly
take on the order of hours.

Updated 1.1rc2 release notes to mention that this bug has been fixed. 
~~~~~~~~~~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4339 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-14T11:46:11Z,nawrockie
f9346c9adee3295a0c598cd8ad5b533e299eb2dd,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i35 in Infernal 1.1 release branch. This bug
commonly caused failures for a specific type of MPI cmcalibrate job:
when the model was large (W>~1500) and number or processors was >60. 

I never fully understood the nature of this bug, but figured out a
workaround. The issue was related to the first MPI_Send() call by
mpi_worker() and/or the first MPI_Probe() call by mpi_master(). It
seems like there is a 'time-out' that occurs by at least 1 worker that
causes the MPI process to fail when the initial mpi_master() step of
forecasting the total run time takes too long. It is only after this
forecast is complete that the master calls MPI_Probe() to receive the
worker's initial MPI_Send() (which is sent almost immediately after the
process starts). For large models, the forecast step can take up to
several minutes, so my guess is that the worker's MPI_Send() gives up
after too long. (If I simplify the forecast so it goes quicker then
the failure does not occur.) However, I never understood why this only
occurs with many processors, as I've never observed the failure with
less than 60 processors. 

The bug is logged in BUGTRAX, but not checked for in the testsuite,
since it requires MPI and only occurs for large jobs that commonly
take on the order of hours.

Updated 1.1rc2 release notes to mention that this bug has been fixed. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4338 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-14T11:28:51Z,nawrockie
a2929b17c590123f1d08ac11b041569ae17db226,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes in r4336 in Infernal 1.1 branch back to trunk with: 
svn merge -r 4335:4336 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1

Log from r4336 in 1.1 branch:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Fixing bug i34 in Infernal 1.1 branch. *Should* be final commit before
1.1rc2 release. This bug concerns the rare case (1 occurence in all
Rfam 10.1 models) when a MATP node is immediately followed by an END
node, which is the only way a IL and EL can emit after the same
consensus position. As of a recent revision (r4272), I *thought*
a new convention of always placing EL columns before (5') of insert
columns in output alignments was 100% implemented, but I hadn't
updated the insert rejustification code in
cm_parsetree.c::Parsetrees2Alignment() to reflect this new
convention. This revision fixes that oversight. 

Bug i34 in BUGTRAX explains this further, and bug-i34.pl in the
testsuite tests for this bug. 

Also, cmalign.c has been slightly simplified by removing code meant to
allow an upper limit of 100K seqs or 100M residues to be aligned in
interleaved or non-Stockholm output alignments. This was having no
effect, as esl_sqio_ReadBlock() enforces that only up to 1 megabyte
(1024*1024 residues) of sequence can be read in a block, so that was
the actual upper limit. The code now reflects this. (I considered
changing the Easel function to allow a caller-defined max number of
residues, but I'm trying to make the minimal amount of changes
immediately prior the Infernal 1.1rc2 release, lest I break something
and don't notice it until post-release.)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4337 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-12T17:48:17Z,nawrockie
06df128388c0d4da84d7c056abf588ae33d1dfac,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixing bug i34 in Infernal 1.1 branch. *Should* be final commit before
1.1rc2 release. This bug concerns the rare case (1 occurence in all
Rfam 10.1 models) when a MATP node is immediately followed by an END
node, which is the only way a IL and EL can emit after the same
consensus position. As of a recent revision (r4272), I *thought*
a new convention of always placing EL columns before (5') of insert
columns in output alignments was 100% implemented, but I hadn't
updated the insert rejustification code in
cm_parsetree.c::Parsetrees2Alignment() to reflect this new
convention. This revision fixes that oversight. 

Bug i34 in BUGTRAX explains this further, and bug-i34.pl in the
testsuite tests for this bug. 

Also, cmalign.c has been slightly simplified by removing code meant to
allow an upper limit of 100K seqs or 100M residues to be aligned in
interleaved or non-Stockholm output alignments. This was having no
effect, as esl_sqio_ReadBlock() enforces that only up to 1 megabyte
(1024*1024 residues) of sequence can be read in a block, so that was
the actual upper limit. The code now reflects this. (I considered
changing the Easel function to allow a caller-defined max number of
residues, but I'm trying to make the minimal amount of changes
immediately prior the Infernal 1.1rc2 release, lest I break something
and don't notice it until post-release.)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4336 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-12T17:13:28Z,nawrockie
a3e6794319a0abb90e73892582cac0b8acedb70e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo in release notes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4335 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-10T19:18:44Z,nawrockie
77717111b2c935266b16a8d2f010b551dc33c65d,Eric Nawrocki,eric.nawrocki@gmail.com,"Updates for 1.1rc2 release. Changed 'November 2012' to 'December 2012'
and added a note on fix to OpenBSD and FreeBSD builds to the release
notes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4333 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-10T18:40:24Z,nawrockie
6f791bd139d9b83a6b109ba616b5846cf70689fe,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4327 changes from Infernal 1.1 release branch to trunk. This
changes enable infernal to build on OpenBSD.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4328 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-05T19:05:52Z,nawrockie
f176f03c1484101bd47454514ea07ba4aa205c0a,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated configure.ac so Infernal will build on OpenBSD. This commit is
related to r4325 in hmmer's trunk and r829 in easel's trunk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4327 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-12-05T19:03:59Z,nawrockie
5b621fdb3a1af13e36404ad149d16a21f0efa1ea,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from Infernal 1.1 release branch 4313 to trunk. This
change makes -msse3 be used in addition to -msse2 when available, so
we can build on FreeBSD. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4316 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-26T15:17:45Z,nawrockie
fcb151807e84498d490afb4afee234b985d2bb22,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated configure.ac based on recent revision 4310 to HMMER's
configure.ac to use -msse2 and -msse3 when both are available, so that
we build properly on FreeBSD.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4313 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-26T14:49:55Z,nawrockie
c6e90aa8d9e63dc1ad0581bbe83398ade73af51b,Eric Nawrocki,eric.nawrocki@gmail.com,"Reinstated number of sequences per temporary alignment from 10 to
10,000. I had set this to 10 while testing changes in a previous
revision since the 1.1rc1 release. This almost snuck into the 1.1rc2
release...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4309 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-21T17:11:01Z,nawrockie
9a6401597ebd7dc5b4d8cb3724a22d7759fc03c8,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed some typos and spacing in release notes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4306 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-16T10:51:32Z,nawrockie
297f16463c99ae790c1ae278db7993178b86c6b6,Eric Nawrocki,eric.nawrocki@gmail.com,"Updates for 1.1rc2 release. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4305 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-15T19:56:18Z,nawrockie
8e34cd7f15114fbfc35082fc470a300d58080e19,Eric Nawrocki,eric.nawrocki@gmail.com,"Merge from 1.1 release branch back to trunk. This revision resolves an
issue with the bug-i33.pl test script using an absolute path instead
of a relative path for a required input file.

svn merge -r 4302:4303 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4304 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-14T11:22:25Z,nawrockie
fc9fd4eb375a779d9f7a9ac5d685671a7f9eb746,Eric Nawrocki,eric.nawrocki@gmail.com,"bug-i33.pl was using an absolute path to a required file (bug-i33.cm)
which failed when using build directories. A relative path is now used
which resolves the problem.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4303 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-14T11:21:10Z,nawrockie
67c1979e227c9b014ba36bd79c73022e0bf9bad0,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4301 fix to cmbuild --refine related to bug i32 from infernal
1.1 release branch:

Merge command:
svn merge -r 4300:4301 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4302 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-14T01:01:54Z,nawrockie
6e6fd01ffc0285666b248948014d65eafc534176,Eric Nawrocki,eric.nawrocki@gmail.com,"Fix to cmbuild --refine related to bug i32, 'fixed' in r4234. That
revision fixed --refine when used with alignments with individual
sequence SS annotation but broke cmbuild --refine for sequences
without it. 'make devcheck' finally caught this.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4301 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-14T01:00:34Z,nawrockie
27efaccfd26666cfe543016893bf3f35b054e8d1,Eric Nawrocki,eric.nawrocki@gmail.com,"Reverting some changes from recent revisions 4226 and 4231 that modified
the CM file output format by changing the 'dbsize' value used for
CM exponential tail stats from a long to a double. The values are now
again printed as longs, as they were in 1.1rc1. 

I originally changed to doubles when I fixed bug i31, because dbsize
values > 2Gb were problematic on 32-bit machines. However, changing
the output format affected reading of binary files and meant that
1.1rc1 press'd files could not be read by future versions (1.1rc2 and
beyond), and vice versa. I realized this was a bad thing and so I'm
reverting in this revision. The affected functions now check that the
dbsize value is less than 2Gb before printing, and fail if it is
not. This is okay because the maximum the value will ever be is 160Mb,
because that's the maximum value for -L <x> in cmcalibrate.

Also changed max <x> for -L <x> in cmcalibrate, previously it was 100
Mb. I increased it to 160 Mb, which is 100-fold higher than the
default value of 1.6 Mb. <x> is the total length of random sequence
searched during calibration.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4292 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-11-06T15:09:43Z,nawrockie
3d81151319b88042c87574b847b66b6b61301d04,Eric Nawrocki,eric.nawrocki@gmail.com,"Merging r4274 from 1.1 release branch back to trunk. This revision
logged and fixed bug i33.

Command used to merge:
svn merge -r 4273:4274 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4275 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-31T00:07:47Z,nawrockie
ddaac372582229a4925b72d19450f4f831e2c16f,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i33 reported by Zasha Weinberg in the 1.1 release
branch. With 'cmsearch -A foo.stk foo.cm foo.fa', foo.stk can be
corrupt (most commonly with invalid PP lines).

This only occurs for a small but significant fraction (7% in Rfam
11.0) of CM files created with Infernal v1.0 and converted to 1.1
format with 1.1's 'cmconvert' program. The problem lies in
cm_alidisplay.c::cm_alidisplay_BackConvert() which uses
HandModelmaker() to construct a CM guide tree from a msa->ss_cons.
The resulting guide tree does not always match the 1.0-built CM guide
tree in the CM file because the HandModelmaker() function changed
between versions 1.0.2 and 1.1 (to fix bugs i19 and i20). When the bug
occurs, cm_alidisplay_BackConvert() gets a guide tree that doesn't
correspond to the CM and tries to use it to convert an aligned
sequence to a parsetree in Transmogrify() which, of course, does not
work properly. Surprisingly, this never causes a segmentation fault
and most commonly manifests itself by outputting corrupt PP lines in
the -A output alignment file.

The fix is to construct the guide tree that Transmogrify() requires
directly from the CM data structure instead of the msa->ss_cons, which
will work if the CM was built with v1.0 or v1.1 cmbuild.

cmalign.c: removed unused variable introduces in recent revision.
itest3-msa-integrity.pl: typo fix


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4274 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-31T00:02:48Z,nawrockie
0d92065af55f9a471aeb690e60c13fa3b3d57706,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged r4270:4271 from Infernal 1.1 release branch to trunk with command:
svn merge -r 4270:4271 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1

log from r4271:
~~~~~~~~~~~~
Modified how cmalign places insert and EL columns ('.' and '~' RF
columns, respectively) in a rare case when both an IL and an EL
are used to emit at least one residue after the same consensus column
in an alignment. Previously, IL inserts would occur 5' of the EL
inserts. Now, the order is reversed: EL inserts occur 5' of IL
inserts.

This only changes behavior for the following rare case: when a MATP
node is immediately followed by an END node (i.e. a
zero-consensus-length hairpin loop). When MATP->END, a MATP_IL can
emit to the same position as an EL. However, for MATL->END (the only
other x->END possibility), the MATL_IL is unreachable (to deal with an
ambiguity in the CM grammar) and an IR state necessarily emits at the
same position as the EL. Since ELs were introduced in Infernal, they
have always emitted 5' of IR states, so the convention of EL 5' of
inserts was already enforced for the vast majority of cases.

Now that ELs are *always* 5' of inserts, we can easily update
esl-alimerge to properly handle the merging of alignments that use EL
states. This is important for large alignments, e.g. SSU rRNA where it
is desirable to parallelize a large cmalign job into many smaller jobs
and then merge the resulting alignments together into one. Without
this new convention of ELs 5' of inserts, it would be possible to
update esl-alimerge to do this, but it would need to parse the SS_cons
of the alignment to determine whether ELs should be 5' or 3' of
inserts, and it would require the user to specify that an Infernal or
at least an RNA alignment was being input. I think enforcing the EL 5'
of insert convention is better as it significantly reduces the
required amount of code. The esl-alimerge miniapp will be updated
shortly.
~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4272 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-23T15:03:00Z,nawrockie
2b1cdc58288980e214a239ee0890e954dffd8932,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified how cmalign places insert and EL columns ('.' and '~' RF
columns, respectively) in a rare case when both an IL and an EL 
are used to emit at least one residue after the same consensus column
in an alignment. Previously, IL inserts would occur 5' of the EL
inserts. Now, the order is reversed: EL inserts occur 5' of IL
inserts. 

This only changes behavior for the following rare case: when a MATP
node is immediately followed by an END node (i.e. a
zero-consensus-length hairpin loop). When MATP->END, a MATP_IL can
emit to the same position as an EL. However, for MATL->END (the only
other x->END possibility), the MATL_IL is unreachable (to deal with an
ambiguity in the CM grammar) and an IR state necessarily emits at the
same position as the EL. Since ELs were introduced in Infernal, they
have always emitted 5' of IR states, so the convention of EL 5' of
inserts was already enforced for the vast majority of cases.

Now that ELs are *always* 5' of inserts, we can easily update
esl-alimerge to properly handle the merging of alignments that use EL
states. This is important for large alignments, e.g. SSU rRNA where it
is desirable to parallelize a large cmalign job into many smaller jobs
and then merge the resulting alignments together into one. Without
this new convention of ELs 5' of inserts, it would be possible to
update esl-alimerge to do this, but it would need to parse the SS_cons
of the alignment to determine whether ELs should be 5' or 3' of
inserts, and it would require the user to specify that an Infernal or
at least an RNA alignment was being input. I think enforcing the EL 5'
of insert convention is better as it significantly reduces the
required amount of code. The esl-alimerge miniapp will be updated
shortly. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4271 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-23T14:41:38Z,nawrockie
cf023459ec2a1069603ac5c4edc4bdf956f61255,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revisions 4240 and 4241 from 1.1 branch back to trunk. These
revisions add a new section to the user's guide listing options that
changed between v1.0 and v1.1.

Command used for merge:
svn merge -r 4239:4241 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4242 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-11T16:44:08Z,nawrockie
7d5362e56bd646dbb9efbd4d98986a6c867fa7d6,Eric Nawrocki,eric.nawrocki@gmail.com,"Small typo fixes in diffoptions.tex.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4241 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-11T16:42:38Z,nawrockie
d46d8d9e1d9ac9832920c27849305ff115cdd373,Eric Nawrocki,eric.nawrocki@gmail.com,"Added diffoptions.tex, a short new section for the userguide that
lists all options from Infernal 1.0 that have been renamed, changed,
or removed in version 1.1. 

This will go into the 1.1rc2 user's guide. The idea for this came from
Sarah who mentioned that several users have been asking about the
differences in options between 1.0 cmsearch and 1.1 cmsearch in the
context of getting rfam_scan.pl to run with Infernal 1.1.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4240 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-11T16:24:35Z,nawrockie
3d62c8aaa66716252d653d05ae56da43ba243137,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged i32 bug fix from infernal 1.1 branch into trunk with command:

svn merge -r 4233:4234 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4235 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-10T21:14:59Z,nawrockie
1ae67963c127ab00c30c1ef2324920156bed44d2,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i32 in infernal 1.1 release branch. cmbuild
--refine would fail if the input MSA had individual SS annotation
because sq->ss was not pre-allocated. Fix was simple. See BUGTRAX for
more details. bug-i32.pl run by the testsuite tests for this bug.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4234 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-10T21:13:22Z,nawrockie
3bb8ccf2785dec4e8c2a6a743b23c22d26ff08c6,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged recent changes from the 1.1 branch between r4226 and
r4232. These changes introduce a fix to a bug (i31 in BUGTRAX) for
handling database sizes > 2 Gb in 32-bit systems. See the 1.1 branch
logs for details.

Merge was perfomed with 3 merge commands:
svn merge -r 4225:4226 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1
svn merge -r 4230:4231 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1
svn merge -r 4231:4232 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4233 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-10T17:49:58Z,nawrockie
ec1c529299edc7d4cf8bb3133c3afe1da9972f8f,Eric Nawrocki,eric.nawrocki@gmail.com,"In r4226, cm_file.c was modified such that the CM file binary output
has changed. The cm->exp_infoA[]->dbsize value is now written and read
as a double instead of as a long. This means press'ed databases must
be re-pressed. There's one such file in the distribution:
tutorial/minifam.cm.i1m which is updated here.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4232 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-10T17:46:24Z,nawrockie
42c11f709ccaa7afa21a7b86c14801b60cf5a39d,Eric Nawrocki,eric.nawrocki@gmail.com,"These changes supplement the previous revision. cm_file.c now
correctly uses 'double' dbsize values instead of 'long' ones when
reading/writing binary CM files. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4231 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-10T14:31:07Z,nawrockie
19dbb704697499794a3de3d37f31746de6266c4c,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i31: on 32-bit file systems, database sizes >
2.15 Gb (2^32-1) would overflow and result in negative database sizes
and negative E-values (!). This was because parts of the code used
dbsize as a long. This bug has been in Infernal since E-values were
introduced (v0.8) and originates in RSEARCH, from which code was
stolen when E-values were first implemented in Infernal. Surprisingly,
it was only just reported now, by Sam Griffiths-Jones, probably because
previous versions were so slow that searches of multi-Gb files were
rare.

The fix is to use double for database size in all contexts. 

This bug is now tested for in the testsuite and logged as i31 in
BUGTRAX.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4226 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-09T19:25:04Z,nawrockie
1b891cb248a7db5d2a65abfd6a5959d95d7bb846,Eric Nawrocki,eric.nawrocki@gmail.com,"Merging r4218:4219 from 1.1 release branch to trunk. This is a tiny
fix to formatting with cmstat -T. 

Command used:
svn merge -r 4218:4219 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4220 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-02T13:29:54Z,nawrockie
dbef3349c7ba4917d5c1963cf8346fa663e64209,Eric Nawrocki,eric.nawrocki@gmail.com,"Simple fix of formatting for output with cmstat -T, spacing was off by
two spaces.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4219 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-02T13:27:01Z,nawrockie
4d094bc305da424db88056d1db46a9ebb73fd50a,Eric Nawrocki,eric.nawrocki@gmail.com,"Merging r4216:4217 from 1.1 release branch to trunk. This updates
cmcalibrate --memreq to include size of CM_HITLIST in it's predicted
memory requirement calculation. Merge was performed with command:

svn merge -r 4198:4199 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4218 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-01T18:17:53Z,nawrockie
95bea91275d11aca9840680eb906b514bbfa787e,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated cmcalibrate --memreq option for predicting total amount of
memory required to take into account size of CM_HITLIST. This is
non-negligible and should have been included before. The hit list can
grow to hundreds of thousands of hits for some models (up to about 70
Mb). The CM_HITLIST size prediction is model independent and derived
empirically, as the maximum of all Rfam 11 models, as there seems to
be no reliable way to estimate it in a model specific way without a
costly simulation. 

One place --memreq is used is in Rfam scripts that need to know how
much memory to request for cmcalibrate MPI jobs. Surprisingly the
Sanger compute farm needs each MPI job to define its collective memory
requirement (per-job, not per-CPU).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4217 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-10-01T18:12:00Z,nawrockie
33d67632b777c728d7108ce0036adc6dad329dfc,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes in r4208 from 1.1 release branch back to trunk with
command: 

svn merge -r 4207:4208
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1

Log from 4208 revision in 1.1 branch:
~~~~~~~~~~~~~~~~~~~~~~~~~~
This is a significant post-1.1rc1 release commit in the 1.1 release
branch. All changes are necessary to enable a --glist <f> option to
cmscan which reads a list of CM names from file <f> and runs those
models in glocal mode instead of local.

This motivation here is for Rfam, to eliminate the need for a
rfam_scan.pl script that wraps cmscan. The problem this new option
addresses is that some of the Rfam 11 models (40 out of 2208) have had
their GA, TC, NC bit score thresholds determined for searches in
glocal model, with all others being determined in local mode. This
means to do a proper 'cmscan --cut_ga' you'd really have to run two
separate cmscan calls, one with the 40 models in glocal mode and the
other with the remaining 2168 in local mode, and then merge and resort
the output. This merging and resorting would likely be done by a
rfam_scan.pl script. The --glist option allows this to be done in a
single cmscan call, and should obviate the need for a rfam_scan.pl
script altogether.  

The --glist option has been added to the cmscan man page, and is
tested by the itest8-glist.pl script run by the testsuite.
~~~~~~~~~~~~~~~~~~~~~~~~~~



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4209 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-09-06T00:14:21Z,nawrockie
36b4dc4ce5ec42ffa3a99c5f09f4e7681b80d36e,Eric Nawrocki,eric.nawrocki@gmail.com,"This is a significant post-1.1rc1 release commit in the 1.1 release
branch. All changes are necessary to enable a --glist <f> option to
cmscan which reads a list of CM names from file <f> and runs those
models in glocal mode instead of local.

This motivation here is for Rfam, to eliminate the need for a
rfam_scan.pl script that wraps cmscan. The problem this new option
addresses is that some of the Rfam 11 models (40 out of 2208) have had
their GA, TC, NC bit score thresholds determined for searches in
glocal model, with all others being determined in local mode. This
means to do a proper 'cmscan --cut_ga' you'd really have to run two
separate cmscan calls, one with the 40 models in glocal mode and the
other with the remaining 2168 in local mode, and then merge and resort
the output. This merging and resorting would likely be done by a
rfam_scan.pl script. The --glist option allows this to be done in a
single cmscan call, and should obviate the need for a rfam_scan.pl
script altogether.  

The --glist option has been added to the cmscan man page, and is
tested by the itest8-glist.pl script run by the testsuite.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4208 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-09-06T00:12:11Z,nawrockie
ad3b7ecac6f4299f4beb75c2f8998233288c1559,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision 4199 from the 1.1 release branch back to the
trunk. This adds support for gzipp'ed target sequence files in
cmsearch. svn merge command was:

svn merge -r 4198:4199 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4200 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-08-28T19:54:25Z,nawrockie
12c810d91bd4102042fabd1927551ed4f62e0353,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch can now handle gzipped sequence files in serial or threaded
mode. Previously it would fail with an error message when given a
gzipped file.

cmsearch needs to do a first pass read through the full file before it
begins a search. In the first pass, the lengths of each sequence are
recorded and the total database size is used to define the filter
thresholds that should be used. The file is then rewound for the next
pass, during which the actual search is performed. Gzipp'ed files
can't be rewound in Easel, which is why they were not previously
supported. Now, cmsearch implements a poor man's rewind of a gzipped
file by closing it and reopening it after the first pass. This was
suggested by Zasha Weinberg who requested the ability to read gzipp'ed
files. 

Reading of non-gzipped files should be completely unchanged.

It is certainly possible there's some reason this is a bad idea that I
just don't know of right now. If I learn of such a reason I'll revert
to the old behavior.

MPI cmsearch still can't handle gzipped files because it requires a
SSI index on the fasta file, and an SSI index cannot be created for a
gzipp'ed file.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4199 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-08-28T19:53:03Z,nawrockie
9a9eac1c999efd7dbc8a8730e67b3f203ef0100d,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from 1.1 branch r4195:4196 to trunk with command:

svn merge -r 4195:4196 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4197 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-08-27T18:18:18Z,nawrockie
2a9d41b01962b45a1320dba087781d976a1be79a,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding handling for zero-length sequences in cmsearch. Previously a
zero length sequence would cause the program to fail and output an
error message in serial and threaded modes. Now it simply skips these
sequences and includes them in the 'number of sequences', but they,
obviously, don't increase residue count at all. This commit actually
only fixes the problem for serial mode. A soon-to-be-made Easel commit
(likely r794) will fix the problem for threaded mode.

BUGTRAX, testsuite.sqc, dev_testsuite.sqc: added bug i30 which is the
failure on zero length sequences bug. testsuite and dev_testsuite now
run a script that checks if this bug exists or not.

configure.ac: fixed lack of handling of --enable-gsl, which was
deleted recently in r4179. configure now sets LIBGSL variable, which
is used by easel/miniapps/Makefile to """" instead of not setting it at
all, which was a problem.

itest7-trunc.pl: wasn't cleaning up a tmp file, now it does.
bug-i11.pl:      fixed a comment that referred to i6 instead of i11.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4196 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-08-27T15:05:18Z,nawrockie
1e6396ff3ff3fd18c0af0be83e57617d285f1d7a,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from 1.1 branch r4185:4186 to trunk with command:

svn merge -r 4185:4186
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4187 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-08-07T19:34:35Z,nawrockie
6c3efb6c6203ea285cc674c126068cce2eb1f6c3,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i29, which was present in infernal 1.1rc1 (but
will have been fixed in 1.1rc2, coming soon). Added test script that
gets run in testsuite.sqc with 'make check'. 

Bug was that rarely with version 1.0 some CM files get printed with 0
filter threshold points by cmcalibrate. Then in 1.1rc1 if we try to
use cmconvert on such a file we get an error. As of 1.0.2, I don't
think it's possible to calibrate a CM and get 0 filter threshold
points. This bug occurs for 1 out of the 1973 Rfam 10.1 files and was
reported by Jen Daub when she was trying to convert them. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4186 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-08-07T19:31:22Z,nawrockie
ad44a4a14bfae075372180ff51f61f4cbbebf232,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from 1.1 branch r4178:4179 to trunk with command:

svn log -r 4178:4179
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4180 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-23T17:04:42Z,nawrockie
090eb632c89353e690bfb9e3fcf90528ea9a43f8,Eric Nawrocki,eric.nawrocki@gmail.com,"configure.ac: removed --with-gsl flag; this is only relevant for Easel
	      anyway. Michael Zuker had reported using --with-gsl
	      results in a build failure. This should resolve that.

testsuite.sqc, dev_testsuite.sqc: removed test of truncyk_check. This
	       fails on OpenSuse virtual machine in compile farm. It's
	       not very relevant as it only tests code that's not used
	       by any of the 10 main infernal programs, so I'm
	       removing it.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4179 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-23T17:02:59Z,nawrockie
447a2ef8f5a25604a8fd45752b6893aecaeddc3d,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from 1.1 branch r4173:4174 to trunk with svn command:

svn merge -r 4173:4174
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4176 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-18T10:53:39Z,nawrockie
f8085fca1591f262ff1903b5a86637e45bedcfb7,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i28 in 1.1 release branch. This is the first bug
discovered in the 1.1rc1 release. It's logged in BUGTRAX and tested
for in the testsuite with the i28* files.

The bug is that the function to clone CP9Bands_t objects
(hmmband.c:cp9_CloneBands()) was not cloning all
parameters. Importantly the {J,L,R,T}valid parameters relevant to
truncated search/alignment were not being cloned. This couldn't affect
the final alignment but did cause a failure in rare cases. In
particular, it caused a possible downstread problem in truncated
pipeline passes if a single envelope contained multiple hits and the
required matrix exceeded the maximum allowed size. It is rare to have
multiple hits in a single envelope in truncated passes because they
are restricted to only the first or final W residues in a sequence. In
these rare cases the pipeline fails and exits because the matrix
should never exceed the maximum size because we've already ensured it
does not with the bands prior to cloning them. The reason it does
exceed the max size with the cloned bands is that we failed to clone
the {J,L,R,T}valid parameters. These parameters dictate what type of
truncated alignments are possible, so not copying them has the effect
that the cloned bands imply a bigger requisite matrix then the
original template bands.

The bug manifests itself once in the ENSEMBLE release 47 rhesus
macaque genome when searching with an SRP model, which finds on the
ballpark of 1 million hits (Alus). This is the only case I've ever
observed so it is what is tested in the testsuite.

More details on how the bug was discovered are in:
~nawrockie/notebook/12_0708_inf_stadler_paper_repro/00LOG.

infernal.h: modified a single comment line



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4174 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-18T10:46:19Z,nawrockie
ca845db6aeed0f4be16b9e842dfd6545b83e207b,Eric Nawrocki,eric.nawrocki@gmail.com,"Changes to make Infernal compile given recent hmmer changes, most
significantly the renaming of ""P7_MSVDATA"" to ""P7_SCOREDATA"".


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4169 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-13T14:44:55Z,nawrockie
f32cb1210fb3af8cf667672f1dd69d727c2438c4,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated 00CHECKLIST so documentation/userguide,
hmmer/documentation/userguide, and easel/documentation are not removed
in next release. The changes in revisions r4158 (Infernal trunk),
r4159 (HMMER trunk), and r780 (Easel trunk) enable this
change. When doing a 'make' in one of these directories we now check
that the required executables exist first, and fail if they don't.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4160 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-10T12:54:12Z,nawrockie
e2e189f3cb0c4bc06145098ec6d3f6c16319e3f1,Eric Nawrocki,eric.nawrocki@gmail.com,"Merging r4154 changes from Infernal 1.1 release branch to trunk.

4154 log from 1.1 branch:
~~~~~~~~~~~~~~~~~~~~~~~~~~
Fixing problem with 'make clean' and 'make distclean' in a released
distribution. 

Previously, a released distribution did not include the
documentation/userguide/ directory, because building the guide
requires the executable programs 'rman', 'pdflatex', 'bibtex' to be in
the user's path and Sean doesn't want people trying to build the
guide, having it fail mysteriously with a bunch of errors and then
reporting bugs to us.

Now, a released distribution will include the documentation/userguide/
directory, but a 'make' in that directory will first check to see if
'rman', 'pdflatex' and 'bibtex exist in the user's path using the
'command -v' command. As far as I can tell using 'command' is the
safest way to do this, although I could change this to running each
command with the --version option and checking if the return status is
in error or not. 

I will update the 00CHECKLIST in the trunk soon so the next release
will include the documentation/userguide/ directory. 

configure.ac changes because previously we had to ensure
documentation/userguide/ existed before trying to create it's makefile
with AC_CONFIG, now we don't have to check because it will always
exist. 
~~~~~~~~~~~~~~~~~~~~~~~~~~



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4158 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-10T12:42:30Z,nawrockie
2d124e143c97f62a90d5adf92bafc235bb47ba9b,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating LICENSE.tag in trunk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4157 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-10T12:40:21Z,nawrockie
de702327348c0674561b655cf65a3845618109de,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixing problem with 'make clean' and 'make distclean' in a released
distribution. 

Previously, a released distribution did not include the
documentation/userguide/ directory, because building the guide
requires the executable programs 'rman', 'pdflatex', 'bibtex' to be in
the user's path and Sean doesn't want people trying to build the
guide, having it fail mysteriously with a bunch of errors and then
reporting bugs to us.

Now, a released distribution will include the documentation/userguide/
directory, but a 'make' in that directory will first check to see if
'rman', 'pdflatex' and 'bibtex exist in the user's path using the
'command -v' command. As far as I can tell using 'command' is the
safest way to do this, although I could change this to running each
command with the --version option and checking if the return status is
in error or not. 

I will update the 00CHECKLIST in the trunk soon so the next release
will include the documentation/userguide/ directory. 

configure.ac changes because previously we had to ensure
documentation/userguide/ existed before trying to create it's makefile
with AC_CONFIG, now we don't have to check because it will always
exist. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4154 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-10T10:26:48Z,nawrockie
e106ab7abe7bbed83eb48a663ef752173d3c9c9a,Eric Nawrocki,eric.nawrocki@gmail.com,"Very minor change to 00CHECKLIST, correcting a path.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4140 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-07-06T12:41:53Z,nawrockie
e3346780cab7bbba3dbb5b902116d7e1204fbc3f,Eric Nawrocki,eric.nawrocki@gmail.com,"autobuild/, release-notes/00CHECKLIST, documentation/
Identical changes as those made in trunk with revision 4135. I
realized after that commit that I should be making changes in the 1.1
release branch, then merging them to the trunk (as per 00CHECKLIST). 

release-notes/LICENSE.tag: another oversight in the 1.1rc1 - this was
identical to HMMER's LICENSE.tag (I had changed it in a working
directory, but never committed it!) So 1.1rc1 files have HMMER's
license instead of Infernal's. Ughh.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4136 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-28T15:03:29Z,nawrockie
e63d63afb0f4404db87947132cc8597942695988,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated 00CHECKLIST during 1.1rc1 release, based on HMMER3's
00CHECKLIST.

documentation: minor updates that were supposed to go into the 1.1rc1
release (mainly the substitution of '1.1' with '1.1rc1') now get added
(after the release). I thought I had changed and committed these in a
release branch instead. This means the 1.1rc1 Userguide refers to
version 1.1 in some places when it should be referring to
1.1rc1. Crap.

infernal_autobuilds.pl: minor changes (changed H3 -> Infernal).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4135 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-28T14:10:02Z,nawrockie
6c3b4cbf7e7f2eaa2d96f63c9a2aaff633f93c76,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from 1.1 branch back to trunk by executing the
following command in an updated working directory of the trunk: 

svn merge -r 4120:4130 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4133 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-28T13:51:17Z,nawrockie
e6dd678f46747868aa091ed8cd71971172914acd,Eric Nawrocki,eric.nawrocki@gmail.com,"Part of the HMMER README text was left over from the original copy
from hmmer/README - I had neglected to delete it.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4130 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-28T01:15:56Z,nawrockie
e164f81f5a646ac3f79937cc2483a2ef20217fb8,Eric Nawrocki,eric.nawrocki@gmail.com,"Found and fixed bug in cmbuild.c and memory leaks in cmcalibrate.c and
cmalign.c, thanks to valgrind. Valgrind testing is not yet in the
automated testsuite which is why I'm only noticing this now. I do use
valgrind during development, but these leaks slipped through anyway -
reinforcing the need to add valgrind testing to the testsuite.

cmbuild.c: recently introduced (r4049) classic allocation error:
ESL_ALLOC(foo, sizeof(int) * alen+1) changed to
ESL_ALLOC(foo, sizeof(int) * (alen+1))

cmcalibrate.c, cmalign.c: fixed memory leaks.

cmsearch.c, cmscan.c: changed one-line description of a couple options
in help output (only ESL_GETOPTS definition changed, no other code
changes). 

release-notes/RELEASE-1.1rc1: minor edits.

testsuite/Makefile.in: 'make <program>' (e.g. 'make cmalign') was not
cleaning up tmp.sqc properly when run in a builddir different from the
srcdir. 

Bugs/BUGTRAX: updated 1.1rc1 release date to today.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4127 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-27T13:26:00Z,nawrockie
054ee1e7759df8394ea1671254d19eec8d712af9,Eric Nawrocki,eric.nawrocki@gmail.com,"Added creation of a symlink to make hmmer's testsuite pass a top-level
'make check' when hmmer/easel does not exist (e.g. in a src
distribution) and the build directory is not the same directory as the
src directory.

hmmer's testsuite expects that hmmer/easel exists because it uses
miniapps in hmmer/easel/miniapps/ and also the BLOSUM62 file in
easel/formats/. I had a workraound for this (creating symlink to
infernal/easel if infernal/hmmer/easel does not exist), but this would
only work when the builddir and the srcdir were the same dir -- using
a builddir other than the srcdir left hmmer's testsuite unable to find
easel/formats/BLOSUM62 (because that's not in the builddir, but rather
the srcdir). So now I check for this case and create two symlinks to
easel if necessary.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4126 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-26T18:43:34Z,nawrockie
70400f6a826c3d06d13d034a4d73af6428d6e7d3,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding INSTALL, based on hmmer's. Somehow I overlooked this
previously. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4125 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-26T16:18:33Z,nawrockie
50ccd8a60ff90e01b1f366058b6876a692299fb4,Eric Nawrocki,eric.nawrocki@gmail.com,"configure.ac now checks if Makefile.in files that won't exist in a
distro release actually exist before trying to create Makefile's from
them.

Previously we weren't checking if they following directories existed:
  documentation/userguide/
  hmmer/documentation/userguide
  easel/documentation/


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4123 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-26T16:03:08Z,nawrockie
d24e31625826ca1556ee975e9308b5bd29df7a51,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixing little things noticed when rerunning tutorial in release branch
as part of release-notes/00CHECKLIST.

I'll need to merge these back to the trunk after the release.

tutorial/*cm* and configure.ac:
changed version from ""1.1"" to ""1.1rc1""

testsuite/Makefile.in: shortcut for running per-program development
tests wouldn't work in build dirs (b/c I was using absolute paths),
now it will. 

testsuite/dev_testsuite.sqc: wasn't cleaning up some cmpress index
files, now it does.

testsuite/itest3-msa-integrity.pl: wasn't unlinking .tbl and .gdf
files, now it does.

autobuild/ppc-aix-xlc: added ""export PERL5LIB="""""" line, because my
local PERL5LIB path conflicts with the compile farm node that aix-xlc
is tested on (cf-ppc2.int.janelia.org) for the easel ncbi-indices
test. 

LICENSE.sh.in: added INFERNAL* variables

Bugs/BUGTRAX: appended tag showing 1.1rc1 release date.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4121 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-26T14:37:14Z,nawrockie
cee8d6b1f70d396f5f783b0d45d3536b970f06d9,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated svn:externals so Easel and HMMER are checked out of
appropriate, stable Infernal 1.1 release branch instead of the trunk. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4120 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-26T00:26:08Z,nawrockie
bb677508379a6713f913886a1b8f22ca8b26259d,Eric Nawrocki,eric.nawrocki@gmail.com,"created Infernal 1.1 release branch

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.1@4118 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T21:35:37Z,nawrockie
e034a577b7557be22840ccb9f0f2879ab159c98a,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding stl9-63 figure, that should've been added previously.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4117 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T18:36:45Z,nawrockie
052ad54b30590e33f0fe1deb62c847b863814d54,Eric Nawrocki,eric.nawrocki@gmail.com,"Added ""export PERL5LIB="""""" line to the three Mac autobuilds to work
around problem with conflicting Perl libraries in my path and the Mac
system's. This was causing an Easel testsuite failure, that should now
pass.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4115 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T18:25:26Z,nawrockie
007117a9f58c5c8c84d0a811e35ab019eed01e1e,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding files in hmmer's release-notes/ that were not previously in
Infernals. Presumably these will play some role in the release
process, since I plan to go off of HMMER's 00CHECKLIST for the 1.1
release, and update the Infernal 00CHECKLIST as I go.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4114 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T17:30:32Z,nawrockie
b5a02cce4bde887c062a180cc302ab12b74661a1,Eric Nawrocki,eric.nawrocki@gmail.com,"Rearranging location of release-notes and 00CHECKLIST to be consistent
with hmmer.

About to create a 1.1 release branch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4113 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T17:16:19Z,nawrockie
3896bd538655b0aa79e1406c1b29f3167e831119,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed trcyk test from testsuite.sqc.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4112 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T17:14:15Z,nawrockie
277fac2e044f27872ea9613738567cff8aaf2cef,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug in cm_OptAccAlignHB() involving setting minimum bound on
initialization of DP cells when EL is off. This was detected because
of a testsuite failure on intel-ia32 builds (where it caused a seg
fault), it passed on all other systems. I'm baffled as to how this bug
could have survived this long.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4111 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T15:19:33Z,nawrockie
4a2f54d9cd242ead3b4afdb24e241df1c796afed,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating config.guess and config.sub to versions in hmmer/. These were
last changed in hmmer rev 2772 back in March 2009, when they were
updated from 2004 to 2008 versions. I presume Infernal's were the 2004
versions, but not sure.

This fixes a problem during configure on PPC AIX (IBM) machines where
host wasn't being correctly identified as a PPC machine (since
Infernal's configure was using identical code from HMMER's and old
2004 config.guess set $host to a different name than new 2008
config.guess). Since configure didn't know we had a PPC, it thought
VMX was not available and wouldn't build Infernal, which requires VMX
or SSE.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4110 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T14:22:43Z,nawrockie
c586dd73ea5d0d1bbf88bcbeb0f16baa14fb7aef,Eric Nawrocki,eric.nawrocki@gmail.com,"Restoring 'tRNA.sto' to the file it should be -- I had somehow clobbered
it with the old 'trna.sto' file, probably when svn committing from a
mac machine due to their case-insensitivity. This change in the file
was causing a few developer tests to fail.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4109 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-25T13:29:30Z,nawrockie
41cf53d5e1e0f6a41f7809adfa24e15343965cfd,Eric Nawrocki,eric.nawrocki@gmail.com,"Changing SQCLEVEL from 3 to 2 for mac os builds so valgrind tests are
skipped. I don't think valgrind is installed on
xcompile.int.janelia.org (10.40.1.19) which is the node I need to use
for these tests. If it is installed I don't know where it is.

(Sean's nightlies use his desktop so he doesn't use 10.40.1.19, which
is why I think valgrind may not be installed there).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4108 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-24T23:17:20Z,nawrockie
3ddbbcf525d895a5719887dd151202eac8d068eb,Eric Nawrocki,eric.nawrocki@gmail.com,"I neglected to change 'trna.sto' to 'trna-2.sto' for its
single occurence in dev_testsuite.sqc in previous revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4107 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-24T23:12:04Z,nawrockie
fcc831baebfc672ea18570fb75546c0624643081,Eric Nawrocki,eric.nawrocki@gmail.com,"Moving trna.sto, which name-clashed with tRNA.sto on Mac/OSX machines, 
to trna-2.sto. Mac/OSX doesn't differentiate between lowercase and
uppercase for some reason. This was causing mysterious failures on the
testsuite on mac machines, or on any machine using a working directory
that had last been updated on a mac machine.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4106 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-24T18:45:41Z,nawrockie
65b40baa2d066002af76f80b845f1ca6820bd07f,Eric Nawrocki,eric.nawrocki@gmail.com,"Added infernal_autobuilds.pl based on hmmer_autobuilds.pl, for a
simple one command test of building infernal on all relevant
systems/compile farm nodes. This also sets the stage for nightly
builds although I'm not doing those yet.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4105 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-24T18:18:49Z,nawrockie
641dd4c8e30ccaea20f43bd2837b323e1802895c,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor name changes to keep up with changes in hmmer r4103.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4104 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-24T18:17:22Z,nawrockie
860d9100d9064bae06cdd38aed976bd6007fd63e,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding autobuild/, copied from hmmer/ and slightly modified. 

This should make things easier for testing the release branch on
multiple compile farm nodes prior to release. Nightlies, like hmmers,
are not yet set up, that's a TODO for after the 1.1 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4097 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-20T19:09:38Z,nawrockie
70b80cd443cffb7b251fe557619d45d90082e8d3,Eric Nawrocki,eric.nawrocki@gmail.com,"documentation: What should be final edits to the man pages and user
guide, found after proofreading a PDF of the guide. 

cmscan.c, cmsearch.c, cm_pipeline.c: fixed spelling of terminii ->
termini in comments.

cmbuild.c: reordering of --noss and --rsearch option.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4096 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-20T18:52:19Z,nawrockie
f569b2c2ee4a523874c0ef2b2b785f72a0ddbf24,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_parsetree.c: fixed rare bug that causes cmalign --sample to crash
on difficult sequences (i.e. random ones). This was found by my final
manual test of the 1.1 code: aligning 500 random seqs of various
lengths to each of the 1973 Rfam 10.1 models using --sample. 
xref:~nawrockie/notebook/12_0423_inf_final_stress_tests/

rmark/: small tweaks to comments.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4095 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-20T15:11:46Z,nawrockie
e5224d2d2edc5ca741abd1dde0077e13d730f01c,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding back three alignment files that I deleted in r4091 when the
intro/ directory was deleted. I didn't realize these get used by 'make
check'. They've been added back to testsuite/, and their location has
been updated in testsuite.sqc and dev_testsuite.sqc.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4093 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-19T22:37:58Z,nawrockie
27c7827fd62f389b0639c039e9da0682e7d643ce,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4092 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2012-06-19T21:45:04Z,nawrockie
88a9f43a208187bb5b3cca4cd8d4af8001483f2e,Eric Nawrocki,eric.nawrocki@gmail.com,"Deleting old files that are no longer used. Most (or maybe all) of
these have been unchanged since the 1.0.2 release, so someone could
get them from there if they wanted. 

Added README to replace 00README. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4091 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-19T21:17:59Z,nawrockie
2ac60e779b12f85e49df99d8887c224ea942fc44,Eric Nawrocki,eric.nawrocki@gmail.com,"Deleting old files that are no longer used prior to the 1.1 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4090 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-19T21:16:08Z,nawrockie
a2d7f2a14ac4315a6887960164a02be0f7995f0b,Eric Nawrocki,eric.nawrocki@gmail.com,"Still editing guide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4089 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-19T19:24:39Z,nawrockie
b932843bc318f66fcf5ccd4138f38773928bed88,Eric Nawrocki,eric.nawrocki@gmail.com,"Read through and revised all userguide .tex files and manpages as
necessary. Mainly small changes to wording and fixes to outdated
information. I'm about to do a spellcheck, but wanted to commit first,
in case aspell goes haywire somehow.

Also, deleted files that are no longer relevant. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4088 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-19T18:30:17Z,nawrockie
f73bb16467c79f99e93d73430c4ac4d4a90ae7bc,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated figure of a B. subtilis RNase P, an example of local
alignment, with new alignment details using a default built and
calibrated 1.1 version of the default RNaseP bacterial type A model
(RF00010). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4087 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-18T18:43:03Z,nawrockie
2d08257dbfbbf620a97ec14d962f5d0797a1f790,Eric Nawrocki,eric.nawrocki@gmail.com,"'make install' no longer installs 'libinfernal.a' in {prefix}/lib/ nor
'infernal.h' or 'config.h' in {prefix}/include/. This is because
Infernal's not meant to be a library for other applications at this
point. 

libinfernal.a is still built though, because it is used to build the
applications.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4086 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-18T15:11:53Z,nawrockie
f8fc9b2ede119b31d503a27430f3dec0043c05be,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch.c, cmscan.c, cmalign.c, sse_cmsearch.c: small changes to
silence icc compiler warnings.

itest_brute.c: modified sampling of random CM parameters to ensure
that the begin probability into state 6 of the ROOT->MATL->MATL->END CM is
never 1.0, if it is then a length 2 sequence has no valid parsetree
(because the MATL_IL prior to the END gets detached to remove
ambiguity with ROOT_IR). If there's no valid parsetree for a length 2
sequence then the paranoid internal checks in the CYK dp
implementations fail and itest_brute fails. This only occured with
Intel compilers, for an unknown reason. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4084 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-18T14:03:08Z,nawrockie
5cf849436198c64c31bd322fbee0201d47d5de27,Eric Nawrocki,eric.nawrocki@gmail.com,"MPI cmscan: the BLOCK_LIST list->current value was only being reset
to 0 once for each query sequence, instead of once per query sequence
strand searched, now fixed. Also fixed error in MPI summary statistics
output: models were being double counted (once per strand, instead of
once per sequence).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4083 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-18T12:39:17Z,nawrockie
f01a434a982812b92ae4be9c6fca0867c03abdf9,Eric Nawrocki,eric.nawrocki@gmail.com,"src/impl_sse/: 
Fixes to make sse_cmsearch and cmsearch_dual actually run. Previously
they compiled but sse_cmsearch seg-faulted and cmsearch_dual was
expecting cmsearch version 1.0 output, and so failed too. They now
give reasonable output, but haven't been rigorously tested or compared
with versions that were part of Diana's thesis' supp material.

src/Makefile.in: removed unnecessary '\'

documentation: small changes to pipeline.tex; still proof-reading.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4082 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-15T17:28:09Z,nawrockie
d90956553d04b8d62f868d8c43a77f7be8d3ba3a,Eric Nawrocki,eric.nawrocki@gmail.com,"Cleaned up configure and Makefiles based on manual testing, mainly of
'install', 'uninstall' which I don't normally use.

- Fixed problem with 'make distclean': I removed 'make distclean' call
  in easel/ because an earlier 'make distclean' in hmmer has already
  done this (after which there's no Makefile left in easel/).

- Fixed AC_LANG_CONFTEST related error in configure.ac that's reported
  by autoconf 2.68. This was already fixed in the corresponding place
  in HMMER's configure.ac.

bandcyk-montecarlo-test, bandcyk-truncation-test, cp9-test,
sub_cm-test, and truncyk_check were being installed since they're
built alongside the installed executables (all are in the PROGS
list). Made a new list IPROGS with only the 10 installed programs.

sse_cmsearch, and cmsearch_dual are no longer installed, nor are their
man pages. This is to simplify things: there's 10 Infernal programs
listed and discussed in the manual and only these 10 get installed.

infernal.man now gets installed.

Removed no longer relevant cm2hmmsearch and cm2hmm man pages. These
were for the use of Zasha Weinberg's rigorous filters which are no
longer supported.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4081 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-15T13:49:16Z,nawrockie
77db8c11cd6a36ea1bc6ef2ff8661d51b29a6189,Eric Nawrocki,eric.nawrocki@gmail.com,"configure now always builds hmmer/documentation makefiles, instead of
only building them if hmmer/documentation/ exists. The old behavior
was causing a problem with 'make clean' in build tree dirs that were
distinct from the src tree.

cm_file.c: updated comments (only) regarding magic number of binary
MSV/SSV filter files. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4080 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-15T09:22:15Z,nawrockie
b0e9bce972847d5a0b2020923c81104427925284,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed problem with last revision related to checking if IMPLDIR was
defined or not in Makefile.in.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4078 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-14T19:44:35Z,nawrockie
9bf72bf07a7356e2fc09b102145231994d39156e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed build process to work on systems with VMX parallel
instructions. Looks like this hasn't worked for a while now (maybe
since infernal/src/impl_sse/ was added.) The issue is that
infernal/src/impl_sse exists, but infernal/src/impl_vmx does not, so
we have to be careful not to do any of the impl_* specific build steps
on VMX machines.

Added @INFERNAL_IMPLDIR@ variable to configure and src/Makefile.in;
configure sets this to 'impl_sse' for SSE or '' for VMX. Then
src/Makefile defines IMPLDIR to this value, and then checks if IMPLDIR
is an empty string or not before performing any step that involves
IMPLDIR. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4077 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-14T19:09:54Z,nawrockie
9b0b3d6d9982775982049f7be6d70d0b666e8547,Eric Nawrocki,eric.nawrocki@gmail.com,"Read through and updated parts of the rmark 00README that had fallen
out of date. Now it is consistent with the current code. Also, made
small changes to comments in .pl scripts. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4075 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-14T17:12:28Z,nawrockie
c87b4d2e322453f401d9f7c32d750ff9b7cd17ef,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on ensuring Diana's SSE code builds appropriately, some of
that code has fallen out of sync. Also, some changes here necessary
for getting autobuilds to work.

configure.ac: 
- A few changes which I had missed in the previous revision (r4073)
  necessary for removing the possibility of building the dummy
  implementation.

- Potentially temporary changes for compiling infernal/src/impl_sse/
  code ONLY if system has SSE instructions. I haven't been able to
  fully test this yet since I don't have login access to any of the
  compile farm nodes that have VMX instead of SSE (should have it
  soon). 

Deleted src/impl_sse/sse_cmsearch_mod.c: a modified version of Diana's
sse_cmsearch I added in r3332 in early testing for an accelerated
pipeline. No longer useful and will probably confuse any users who
encounter it since it is nearly identical to sse_cmsearch.c with
changes only necessary for my benchmarking scripts (I didn't want to
modify Diana's sse_cmsearch.c).

sse_cmsearch.c: made changes to make it compile. This program hadn't
been created by a build for a long time now and it had fallen out of
sync. Changes were relatively straightforward.

testsuite/: small changes necessary for getting autobuilds to work. 
Many of these changes were required because bug scripts shouldn't use
absolute paths to files within them, instead they should be passed in
paths to any files they need via the command line.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4074 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-14T14:05:53Z,nawrockie
1e515fe905099b5127e05379bcb375f4b1f255ab,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed possibility of building a 'dummy' implementation. Infernal's
HMM filter-based search pipeline requires either SSE or VMX, and
configure now enforces one of the other exists on the current
machine. 

'configure' on a machine with neither SSE nor VMX instructions will
fail.

--enable-dummy is no longer a processed option to configure. 

--enable-vmx=no on a machine with VMX instructions causes configure to
fail. 

--enable-sse=no on a machine with SSE instructions causes configure to
fail. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4073 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-14T09:36:26Z,nawrockie
dc8de3ff26e610fe3cd95e9b30d837f05a03b018,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed problem with pipeline statistics output in 5'&3' truncation
mode. These stats are only output with --verbose in cmscan and
cmsearch (so tutorial results are unaffected by this change).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4072 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-13T20:15:10Z,nawrockie
d61d094e6b48e1d7dd79b87daf17d614fc44aee8,Eric Nawrocki,eric.nawrocki@gmail.com,"This revision is closely tied to the previous one. After updating back
in local copy on nfs (Janelia machine), I fixed some issues that
prevented building of the userguide. (I can't build the guide
on my MacBook, so I couldn't find these problems prior to the last
commit.)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4071 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-13T15:06:47Z,nawrockie
02e6e9f593c47f448ed818c31902ce303dbcaeb7,Eric Nawrocki,eric.nawrocki@gmail.com,"userguide/tutorial: Large revision due to local run-through of the
tutorial on my MacBook Pro:
- deleted old, no longer needed files
- added files needed for new tutorial
- updated timings/output to ensure they're accurate for released
  version (will update again if necessary).
src/cmcalibrate.c: removed redundant output of number of CPUs used for
		   forecast, printed with --forecast option. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4070 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-13T14:49:37Z,nawrockie
3fa2ab6d5e7b7672d6b702820b232b0e74fecc34,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating tutorial.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4069 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-13T14:29:32Z,nawrockie
49ba5e6a491b29bba09876b58a1816f066d7d526,Eric Nawrocki,eric.nawrocki@gmail.com,"Pipeline section is now 'complete', still needs proofreading and
editing though. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4068 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-12T18:05:01Z,nawrockie
3446d8665776eb5d2e2661d18d41399d690ff294,Eric Nawrocki,eric.nawrocki@gmail.com,"cmcalibrate: I had accidentally used 'ofp' instead of 'stdout' in
output of ""[ok]"" at end of program (which I just added in previous
revision to be consistent with cmsearch/cmscan).

Still working on guide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4067 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-08T15:28:19Z,nawrockie
9357f168b3cd366a64a729ec68f3a4428bf1fe27,Eric Nawrocki,eric.nawrocki@gmail.com,".c files: 
During testing I sometimes use '#if DEBUGGING' statements around
debugging printf()s and then define DEBUGGING as 1 when I encounter a
bug. I've done a global search for these in all .c files and either
removed them or replaced them with '#if eslDEBUGLEVEL >= x'.

configure.ac: updated release date to June.

documentation: added 'pipeline' section (not yet finished) and updated
	       'scores' section. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4066 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-08T14:04:21Z,nawrockie
0c203d4a5a5a2878d064d4106d65f6f719777726,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed difficult to find but easy to fix bug in MPI
cmscan. Previously, the CM file was being opened but not closed for
each the top and bottom strand of each query sequence in
mpi_master(). Instead it was being opened for each strand, but only
closed after the bottom strand was finished being scanned. Now it is
closed for both strands. This bug manifested itself only on certain
MPI jobs. An error occured because the system ran into its limit of
open file handles and then fopen() failed. The limit seems to vary
though on different nodes, and further I wasn't able to reproduce the
bug on a single node when I ran mpirun locally for some reason - only
qsub jobs would fail.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4065 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-08T12:36:28Z,nawrockie
29e0247da7b959968d3b489bb203e68e8431cdb5,Eric Nawrocki,eric.nawrocki@gmail.com,"Small changes: 
cmsearch.c: corrected free'ing of worker info for MPI when multiple
	    CMs are in the query CM file.

cm_pipeline.c: Fixed output of number of models for HMM-only
	       searches/scans.

hmmband.c: Fixed incorrect definition of imax[v] for rare case when ML
	   state meets criteria that all possible j values
	   (jmin..jmax) are less than all possible i values
	   (imin..imax).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4063 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-06T17:46:23Z,nawrockie
c8e59d479a4ea97cf54f4a8a796df9b5bf95faa8,Eric Nawrocki,eric.nawrocki@gmail.com,"Small fix to a unnecessarily complex if() statement involved with
splitting up windows post-SSV/pre-Viterbi that actually had no affect
on the code, but should have been simpler.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4062 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-05T17:18:36Z,nawrockie
768645ef85e420b9fbbcc7182fb0a29bc7e0186d,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on the tutorial. Added example of using --hand with
cmbuild and associated figure (trna1-DF6280-hand.pdf).

Added 'more.tex' and 'tabular.tex', based on sections of the same name
in the HMMER guide. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4061 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-04T19:37:42Z,nawrockie
2a68638a8fc7932325da688a472e6316eb7d70d5,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign.c, cmcalibrate.c, cmscan.c, cmsearch.c: 
The four programs that use threads now always print the number of
processors being used in the output header, even if --cpu is not
used. (cmalign only prints a header if user redirects alignment with
-o.)

The motivation for this is that the determination of thread number was
non-intuitive to me and so I think it may also be non-intuitive to a
significant number of users. X threads are always used on an X-core
machine, even if some of those threads are being used by other
processes. This can be undesirable. For example, if I submit many jobs
to the cluster, 8 jobs may be put onto the same node because each node
has 8 CPUs. Each of those jobs will be restricted to 3 Gb of RAM by
default, because our cluster divides up the 24 Gb or RAM per node
evenly and gives 3 Gb to any single-CPU on the node. However, all 8
jobs will fire up 8 threads because they each recogize the machine
they are running on has 8 CPUs. This can cause a problem if these jobs
are memory intensive. For example, cmalign limits the summed total
size of its DP matrices to 1 Gb. Given 3 Gb of total RAM, this would
if we have 1 worker thread (which I assumed would be the case), but is
not fine if we have 8 threads because we'll potentially want 8 Gb of
RAM.

When I ran into this case, I had to modify cmalign to output the
number of threads it was using before I could make sense of what was
going on. If a user runs into the same issue, they'll be hard-pressed
to make sense of it unless they know the number of threads being used
- this is why the number of threads used is now always printed. I'll
also make a note of this issue in the user guide and man pages, but
that will only be helpful to users who actually read the
documentation.

cmbuild.c: fixed off-by-one in alignment index in error message if an
	   alignment has no SS_cons annotation. 

mpisupport.c: fixed sizeof() function for a CM_ALIDISPLAY, it was not
	      counting one integer.

cm_pipeline.c: Silenced compiler warning regarding printing an int
	       with PRId64.

Still working on tutorial. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4060 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-03T15:22:16Z,nawrockie
d8dea5466298f03d4b348cea20c77be0b01032eb,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch.c, dev_testsuite.sqc: 
Input sequence files can no longer be an alignment. This change was
necessary because the machinery for reading sequences isn't tolerant
of interleaved sequences in the input file because long sequences are
not read all at once, but rather in overlapping windows. This change
mirrors a similar one made to nhmmer in HMMER svn rev 3938. The
testsuite now checks that a Stockholm alignment causes a cmsearch
failure. 

cmscan.c: 
Enforced a maximum length of 10 Mb for query sequences. This means
cmscan should be usable for essentially all prokaryotic genomes, but
not for the vast majority of eukaryotic ones. For euk genomes, users
will just be forced to use cmsearch. This is okay because cmscan is
really meant for short sequences, e.g. from a metagenomics study. 

The reason a maximum sequence length is important is that cmscan reads
in full sequences instead of reading in overlapping windows like
cmsearch does. Not reading windows significantly simplifies the code
but means that we have to limit the maximum size so we're not reading
in Gb long sequences all at once which could potentially require too
much memory.

cm_pipeline.c:
The --max and --nohmm options to cmsearch and cmscan will now turn off
hmm-only scans, forcing the CM to be used for all models, even ones
with zero basepairs. If the user is setting --max or --nohmm they
can't be worried about running time, so turning off HMM only scans
shouldn't be a problem. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4059 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-01T17:22:09Z,nawrockie
8ee1b3b62ba00d6a2ec0782c329b8c7e92555332,Eric Nawrocki,eric.nawrocki@gmail.com,"Several small changes motivated by my experience writing the new
tutorial and the included explanation of cmsearch/cmscan output.

cm_tophits.c: 
Simplified single character symbol that indicates truncated hit
alignments in cmsearch/cmscan output. Previous '}'/'{' were used for
truncated hits that extend to sequence ends, and '~' was used for
truncated hits that do not extend to sequence ends. Now, '~' is used
for all cases. Motivation for this change is that by default all
truncated hits will extend to the ends (they only possibly won't if
--anytrunc is used), and having annotation that only occurs with an
expert option is needlessly complex, and annoying to explain in the
user guide. '~' seems like a natural symbol to use for truncated hits,
indicating 'missing' residues are assumed to exist past where the
sequence terminates.

Added 'inc' field to tabular output file indicating if a hit is above
inclusion threshold ('!') or just above reporting threshold ('?'). The
idea here is that this should make it easier to parse out only hits
above inclusion threshold.

cmbuild.c: 
Filter HMM consensus sequence is now set during filter HMM
construction, this is important for zero basepair models, for which
the HMM will be used to annotate cmsearch/cmscan output alignments.

cm_pipeline.c:
Fixed pipeline statistics summary for cmscan.

Changed 'MSV' to 'SSV' in output, since 'SSV' is what's actually
used. 

mpisupport.c:
Removed <xtau> from CM_t packing/unpacking/sizing, this was removed a
few revisions ago, but I had neglected to remove it from this MPI
code.

cm_modelmaker.c: Fixed typo in comment.

infernal.h, cm_p7_modelmaker.c: 
Added cm_p7_hmm_SetConsensus(), required because we want HMM consensus
sequence uppercase/lowercase to be set the same way that Infernal sets
uppercase/lowercase for single stranded residues. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4058 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-01T14:11:33Z,nawrockie
aec841c5352308d934d86f946315199ea2cac0b5,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating tutorial. Not done yet.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4057 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-06-01T13:38:04Z,nawrockie
2e9a34f0dd4575c10dae7038641b78d496076834,Eric Nawrocki,eric.nawrocki@gmail.com,"Revising new cmalign behavior introduced in previous revision
(r4054). The failover to HMM banded non-truncated alignment from HMM
banded truncated alignment now only occurs in case of 'error type 2'
(described in r4054 log) where HMM bands disallow all valid
parsetrees. Failover is no longer allowed in case of 'error type 1',
which occurs if required size of truncated HMM band matrices exceed
maximum.

The motivation for this change is that error type 1 sometimes occurs
for valid (homologous) target sequences for large models and I've
decided it's better to inform the user they should be allowing larger
matrices (with --mxsize) than force standard alignment in these cases
which will almost certainly result in poor alignments.  I'm
particularly concerned about SSU and LSU rRNA alignment, where
sequences are often truncated and the required matrices for extreme
(but valid) input sequences can exceed the 1Gb limit (especially for
LSU). I think users trying to align these large RNAs should be
encouraged to increase the max size with --mxsize, which is now what
cmalign will do once it is used to try to align one of these extreme
examples. With the failover behavior introduced in r4054 (that I'm
reverting here), some of these sequences would be aligned poorly in
standard mode, unbeknownst to the user.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4056 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-31T13:23:39Z,nawrockie
23e0a5545541f55921c4696258f2a3e401744aed,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed how cmalign handles two types of 'errors' when doing HMM
banded truncated alignment (which is the default alignment mode), by
failing over to HMM banded standard (non-truncated) alignment and
retrying the alignment.

Error type 1: 
Previously, if the HMM banded truncated matrices exceeded maximum
allowed size (probably after iterative tightening of bands until a max
tau value reached), then cmalign would fail with an error message
suggesting the user raise max tau. Now, cmalign fails over into HMM
banded non-truncated alignment in these cases. If the required
non-truncated HMM banded matrices still exceed the max, then cmalign
will fail with an error.

Error type 2: 
Previously, if zero valid parsetrees were possible within the HMM
banded truncated matrix, then cmalign would fail with an error
message. Now, cmalign fails over into HMM banded non-truncated
alignment in these cases. For the non-truncated case, the probability
of the bands obscuring all valid parsetrees is even less than for the
truncated case.

Both of these errors are very rare. I've only observed error type 2
when cmalign is used to align random sequences. Error type 1 does
occur, but only for pathological cases - there are 2 examples in all
the Rfam 10.1 fulls, both for SSU_rRNA_eukarya. 

By switching from truncated to non-truncated alignment we are
sacrificing alignment accuracy, but the switch is only done for
extreme cases where the alignment would likely be highly ambiguous
anyway (e.g. random sequences). I think this is justified to prevent 
cmalign from exiting in error when it comes across one of these rare
cases.

xref: ~/notebook/12_0423_inf_final_stress_tests/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4054 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-30T18:54:33Z,nawrockie
7e4baf4b8de553e54a205ae6202ea49bcb6a7e58,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed rare bug in optimal accuracy alignment. When model is configured
in global mode it was possible for the optimal accuracy parsetree to
include emissions from the local end (EL) state, even though they
should be impossible. This causes a problem when converting the
resulting parsetree into an alignment because the PP annotation for
the EL emissions is undefined. 

This occurs if a 0.0 PP for those EL emissions is 'optimal' (results
in the maximum sum of PPs for all emitted residues, even when 0.0 is
attributed to the EL emissions). One might argue this means they
should be allowed, but doing that is a bad idea because it violates
too many assumptions made by various parts of the alignment machinery.

This occurred only rarely when aligning random sequences. I've never 
observed it on a CM emitted sequence or on a hit found by
cmsearch/cmscan. 

The fix for this brought in in this revision is to explicitly check
for and disallow transitions to EL that imply EL emissions when local
ends are off. This was added to cm_OptAccAlign() and cm_OptAccAlignHB()
in cm_dpalign.c, and cm_TrOptAccAlign() and cm_TrOptAccAlignHB() in
cm_dpalign_trunc.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4053 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-30T14:50:48Z,nawrockie
769818ec7b6ad86c7c90dfe856b69a8a5c54468d,Eric Nawrocki,eric.nawrocki@gmail.com,"Local model configuration is now default for cmalign, -g now enables
global alignment and -l is gone. Previously, cmalign default was
global as it was since inception (v0.4). Motivation was to match
cmsearch/cmscan which use local by default.

testsuite/*, cmalign.man: changes due to new local default. 

cm_alidisplay.c, cm_modelmaker.c: fixed problem with recent changes to
allow correct EL emission annotation with cmsearch -A (r4049). Zero
basepair models (HMM only mode) were not being handled correctly, now
they are.

cmscan.c, cmsearch.c, cm_pipeline.c: Very minor change. Changed when
'//' is printed after a query sequence is finished. Previously it was
printed after statistics, but now it is printed after -A file output
report, if -A is used.




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4050 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-28T22:43:20Z,nawrockie
5cc727c63595a64536a69cbb2b958a4074d57783,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed problem with cmsearch -A output alignments that use EL
emissions alluded to in log for r4045. Previously, EL emissions from
hits were annotated as inserts. Now they are properly annotated as EL
emissions with a '~' in the corresponding column of the RF annotation
of the output alignment.

This fix required changing the HandModelmaker() and Transmogrify()
functions to optionally handle EL emissions for this case. The added
code is responsible for detecting the case where an EL has been used
for emissions from the aligned sequence. This is somewhat non-trivial
because EL emits are placed in the alignment in positions that can be
far away from the position modeled by the state that's transiting to
the EL. 

rnamat.c: Fixed misspelling of HandModelmaker() within a comment.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4049 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-25T19:36:39Z,nawrockie
c2bfa3292ffa807ddb9edca01f639fab3e25d435,Eric Nawrocki,eric.nawrocki@gmail.com,"In the middle of fixing a problem with cmsearch -A <f> which outputs
an alignment of all hits to file <f>. If a hit emits residues from the
EL state these are not being annotated as '~' in the RF annotation of
the output alignment. This is because cm_modelmaker.c:Transmogrify()
does not handle EL emissions in a way that is consistent with how they
are marked up in an output alignment created by
cm_parsetree.c::Parsetrees2Alignment(). 

Transmogrify() has comments suggesting it can be used for local
alignments, but the local alignment conventions it expects are
different from what Parsetrees2Alignment() generates.  Transmogrify()
is (effectively) untouched since Infernal version 0.3, and I'm not
sure of the details of the local alignment conventions it expects
other than they are different from what Parsetree2Alignments()
generates (there's no further documentation I can find). It seems the
method of using these local alignments for building models was only
partially implemented. It doesn't much matter though because I've
verified that Transmogrify() is never currently being used with these
types of local alignments, at least in building all Rfam 10.1 models,
and they also are not used if the cmbuild input alignment was
generated by cmalign.

To avoid confusion with local alignments that use EL emissions, I've
reverted it to the Infernal v0.1 version of the function which did not
handle these other types of local alignments, and I plan to next add
support for the relevant types of local alignments I want the function
to be able to handle. The goal is to allow cmsearch -A to annotate EL
emissions in the RF annotation with '~' and also to allow cmbuild to
take an input alignment with '~' RF annotation and completely ignore
those columns (EL emissions are defined as 'nonhomologous'
residues). This way, cmbuild will work on any alignment generated by
cmalign and ignore ELs instead of treating them as insertions (which
it currently does). However, that change doesn't come in with this
revision; I'll work on that next.



Also, fixed a problem with annotation of PP for EL emissions in
cmsearch/cmscan hits introduced in revision 4043. For alignments that
use EL but without an EL emissions (silent local ends) the PP
annotation was being set as '0', now it's '.' for a gap, which makes
since there's no emitted residues.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4045 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-23T18:06:09Z,nawrockie
77c5f3c736d97bff7c6f04d90348333a2fb495b8,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_alidisplay.c: 

Modified PP annotation of EL emissions. Previously, these were left
blank (as ' '). Now, they are annotated with a single PP code
reporting the average PP of all emitted residues in the annotated
stretch. An example is shown below with an EL of 5 emissions
corresponding to a delete/skip of 7 model positions. The average
PP of the 5 EL emitted residues is between 0.75 and 0.85. 

          (((((((,,<<<<___.___.._>>>>,<<<<<~~~~~>>>>>,,,.,<<<<<_
  tRNA  1 GgggaugUAGCucAgU.GGU..AgaGCaucgGa*[7]*uCcgaagg.cgcgGGU
          G:GG:::UAG:::A+U G U  A:::C+:C:G:     :C:G:A + CG:GGGU
  test  1 GAGGUCUUAGUCUAAUuGCUcaAAGACGGCUGC*[5]*GCAGUAUAgCGUGGGU
          ****************9999************9..8..9***************

The dots in the PP line adjacent to the '8' don't actually correspond
to gaps in the alignment, but I couldn't come up with a clearly better
way of dealing with those columns. 

cm_dpsearch_trunc.c: 
Fixed an initialization bug recently introduced with L/R mode EL
states, caught by valgrind.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4043 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-23T01:11:59Z,nawrockie
2b8fadf004d46525266b237ffb8f9db2d6d8c75c,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified how HMM band tightening works in the rare case that the
required HMM banded DP matrices exceed the maximum allowable size (1
Gb in cmalign). 

Previously, the tau parameter which controls the amount of probability
mass outside the bands was doubled until it reached a maximum
value. Now, two additional parameters the CP9Bands_t object's thresh1
and thresh2 are modified as well. These parameters control the
occupancy probability required for a HMM position to be considered
'possibly' and 'probably' used by a parse and are used to define which
marginal alignment modes to use for each CM state in the downstream
truncated HMM banded alignment. This has the effect of further
reducing the required size of the DP matrices. 

Also, the maximum tau value has been raised to 0.05 from 0.01.

xref: ~/notebook/12_0423_inf_final_stress_tests/


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4042 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-22T19:37:56Z,nawrockie
19c1b906aaa1da9fa8a45ec4fc6f092beeadc756,Eric Nawrocki,eric.nawrocki@gmail.com,"Revisited and modified truncated DP alignment and search algorithms to
allow the local end 'EL' state to be used in both L (Left) and R
(Right) marginal modes. Previously, it was only possible to use EL in
J (Joint) mode.

This fixes a design flaw in my truncated DP implementations. Diana
and Sean's algorithm (Bioinformatics, 2008) does not include ELs in L
or R mode but it doesn't have to since it allows a truncated alignment
to begin and end at any position in a target sequence. My
implementation requires that the first and/or final residue must be
included in a truncated parsetree. This is not only true in the
search/scan pipeline related to target sequence ends, but also in
cmalign where the full input sequence must be aligned, thus the first
and final residue must be included. So it is important that we can use
EL in L or R mode in the case that the first or final residue is best
aligned to the EL state.

Put another way, imagine sampling a parsetree and randomly truncating
it, if the chosen cut points occur within a stretch of EL emitted
residues our DP algorithms for inferring the parsetree given the
sequence ought to be able to score it that way - previous to this
revision they would not, but now they do.

The cmalign tests in ~/notebook/12_0423_inf_final_stress_tests/
brought my attention to this issue.

Also updated itest_brute.c to include paths that use EL in L or R
mode.

xrefs: 
/groups/eddy/home/nawrockie/notebook/12_0511_inf_trunc_LR_ELs/00LOG
/groups/eddy/home/nawrockie/notebook/12_0423_inf_final_stress_tests/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4041 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-21T14:02:52Z,nawrockie
e78079390cad152e68d32d9bd6918a044539adc6,Eric Nawrocki,eric.nawrocki@gmail.com,"Reverting change from previous revision that I didn't mean to commit.

The change involves allowing EL emissions from L and R mode truncation
alignments instead of just J, which I'm experimenting with but not
ready to commit yet as its only partially implemented.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4038 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-11T19:48:31Z,nawrockie
927b8904decc3465773da3111d96404027869abb,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_mx.c, hmmband.c, infernal.h:
Modified how the mode (JLRT) of truncated alignments to allow at each
state is determined in rare cases where no CP9 HMM node has occupancy
probability above 0.98 (the thresh2 paramter of a CP9Bands_t object).

Previously, in this case the sp2 and ep2 values of cm->cp9b
(CP9Bands_t) would be set to special values that had the effect that
all types of marginal alignment were possible at all states. This
results in a prohibitively large matrix for large models (up to 250Gb
for eukarya SSU).

As of this revision, if no HMM node has occ prob > 0.98 then we look
for the first and final HMM node that has occ prob > thresh2_failover,
(a new parameter in the CP9Bands_t object) which is 0.90. If no node
has at least this occ probability then we go back to old behavior of
allowing all marginal modes in all states.

There are 3 sequences out of the ~3 million in all Rfam 10.1 fulls for
which the old behavior resulted in DP matrix that exceeds the maximum
allowed default size (1028 Mb) in local alignment mode. All three are
in SSU_rRNA_eukarya and in all three cases the required matrix was way
above the limit (>100 Gb). The 'fix' implemented here with
thresh2_failover fixes all three cases such that an alignment can be
computed with a matrix < 1028 Mb.

Other changes:
cm_dpalign.c, cm_dpalign_trunc.c: changed an error message, only. 

cm_tophits.c: changed format of cyk score from %6.2f to %6.1f, output
only if --cyk.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4037 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-11T16:15:28Z,nawrockie
181af98351f113c967b578aa19cfa8fe8ef12845,Eric Nawrocki,eric.nawrocki@gmail.com,"Added 'band tightening' capability to cmalign to avoid failure in most
cases when required DP matrix size exceeds the limit (by default 1Gb
(256 Mb previous to this commit, was 2Gb in Infernal 1.0.2)).  If the
limit is exceeded using the tail loss probability tau (1E-7 by
default) then tau is increased by a factor of cm->xtau (2.0 by
default), bands are recalculated and the required matrix size is again
checked to see if it is below the limit. This process iterates until
the required matrix is below the limit or cm->maxtau is reached (by
default 0.01). If maxtau is reached and the required DP mx size is
still above the limit, cmalign fails with an error message telling the
user to increase maxtau, tau or mxsize. 

This band tightening strategy is used by the search/scan pipeline to
avoid a failure if a hit requires a huge matrix. 

This change was motivated by results of tests with cmalign prior to
the 1.1 release (~nawrockie/notebook/12_0423_inf_final_stress_tests).

The main change in the code is to call cp9_IterateSeq2Bands() from
DispatchSqAlignment() when the band tightening strategy is being used
(flagged with cm->align_opts & CM_ALIGN_XTAU). The
cp9_IterateSeq2Bands() function was changed slightly to work in this
new context as well as its original one in the CM pipeline.

Most code changes int his revision are to allow this new feature, but
not the ones described below:

cm_tophits.c: output of tau changed from %7g to %7.2g.

cm_submodel.c, cm_mx.c, cm_qdband.c: added new case for initialization
of cm->qdbinfo: CM_QDBINFO_SETBY_SUBINIT for the case when a sub CM is
built from a 'mother' cm but we don't want to have to calculate
QDBs. Currently we'll never use QDBs with a sub CM because sub CMs are
only used with cmalign (and then only with --sub) and cmalign never
uses QDBs. Prior to this change, QDBs were being calculated for each
sub CM which is very slow for large CMs, e.g. SSU, and completely
unnecessary.

cmsearch.c, cmscan.c: cleaned up spacing in definition of options,
changed minimum allowed xtau value from 2.0 to 1.99, since default is
2.0 and I'm probably unnecessarily paranoid about floating point
precision.

xref: ~nawrockie/notebook/12_0423_inf_final_stress_tests/00LOG
      (explanation of cmalign tests, the results of which motivated
      this change)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4034 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-10T13:21:56Z,nawrockie
cc8b038a69697d1bd10e43217bf810eee06bccbf,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo in previous commit (r4028):
-I{$top_srcdir} --> -I${top_srcdir}


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4030 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-07T19:31:14Z,nawrockie
cc1473a72cce071852083055d412b3bb10aac9e9,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed include directory from -I${top_srcdir}/hmmer to
-I${top_srcdir}/hmmer/src. 

Reordered include and library (-I and -L) directories so that Easel
directories coms before hmmer directories, which they do in all other
Makefile's.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4028 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-07T15:07:55Z,nawrockie
38c71e0d8d1f969ba413b734baa180fbc343ec7c,Eric Nawrocki,eric.nawrocki@gmail.com,"New and hopefully final resolution to the problem of running hmmer's
testsuite in infernal, referred to in rev 4020 and 4021's log. 

The problem was that hmmer's testsuite.sqc requires that hmmer/easel/
exist and include miniapps in hmmer/easel/miniapps, while Infernal is
designed so that hmmer/ does not use its own easel/ subdir but rather
uses infernal/easel/. However, infernal/hmmer/easel/ does exist, it is
just never has a 'make' called within it, so hmmer/easel/miniapps/
executables never get built. So to deal with this, Infernal's 'make
check' now copies the required miniapps from infernal/easel/miniapps/
into infernal/hmmer/easel/miniapps, runs its testsuite and then
removes those miniapps.

It's also important that a 'make check' in Infernal successfully calls
hmmer's testsuite in a released version of Infernal. In a released
version the infernal/hmmer/easel/ directory won't exist at all, since
it is not needed and will have been deleted prior to the release.  To
deal with this case, Infernal's 'make check' will create a symlink
from infernal/hmmer/easel to infernal/easel if infernal/hmmer/easel
does not exist, then run hmmer's testsuite and then delete the
symlink. This change requires a check for the 'ln' program during a
configure, which is the reason that configure.ac has changed in this
revision.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4026 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-04T23:17:12Z,nawrockie
837ffe9a44ec34217e19f0d18f2d3998844f5756,Eric Nawrocki,eric.nawrocki@gmail.com,"With cmbuild --hand, '~' annotated RF columns are now considered
insert columns. Previously they were match columns. 

It's important we don't allow '~' RF match columns because '~' RF
columns are treated special by cmalign, as EL insert columns. cmalign
needs to know which columns are EL inserts when it merges
subalignments, which it does in memory-saving mode with large input
sequence files.

cmalign.c: removed MPI debugging code that prints process id.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4024 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-03T18:29:53Z,nawrockie
929f3743b5ca137b199cc4c322e39e0bd5a894fe,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified how RF annotation is transferred from the training alignment
to a CM and from a CM to a cmalign output alignment, based on
a recent conversation with Sean.

Now, if --hand is used in cmbuild msa->rf annotation is transferred to
the CM, else it isn't. Previously, training alignment RF annotation
was always transferred to the model if it existed.

cmalign now outputs #=GC RF annotation from the CM (cm->rf) if it
exists, else it uses the consensus sequence. Previously the consensus
sequence was always used. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4023 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-03T02:20:02Z,nawrockie
02e61369cb2df5015b79696cf79c32b713ef05de,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed default relative sequence weighting scheme from GSC to
position based Henikoff weights, to match HMMER. Effect on rmark3
benchmark is insignificant. Updated documentation to reflect this.

Changed preciision of entropy weight targetting from 3 sig digits to 2
sig digits, to match HMMER.

Exotic location commit; Mongtomery County Courthouse, 9th
floor, Rockville, MD


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4022 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-02T17:31:57Z,nawrockie
0506aae0e5a89c300437ffed2ed23b975138a25d,Eric Nawrocki,eric.nawrocki@gmail.com,"Makefile.in: a change introduced in r4020 that I thought fixed problem
with running hmmer's testsuite and its dependence on having easel in
hmmer/easel/ is flawed and has been reverted.  There's a bigger
problem here: easel is automatically checked out in hmmer/ and
infernal/ due to SVN external definitions in the Infernal and HMMER
trunks. I was just ignoring this and having hmmer/ use infernal/easel,
but that means that hmmer/easel just sits there unused. I'll have to
come up with a better solution for this but I'm putting it off for now
- the current code simply doesn't run the HMMER testsuite as that part
of the Makefile has been commented out. One solution could be to have
Infernal use infernal/hmmer/easel as its easel directory, and delete
infernal/easel/.

cmsearch.c and cm_pipeline.c: updated to be consistent with recent
changes in hmmer, namely to use the new p7_msvdata_Clone() function
and updated p7_pli_ExtendAndMergeWindows() function prototype.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4021 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-01T23:49:38Z,nawrockie
ed74444c7be6ed34907b0f0c328970a8f311f6c2,Eric Nawrocki,eric.nawrocki@gmail.com,"Clean-up of testsuite/ that touches many files. 

I meant to delete all those that are not needed by current testsuite
sqc files, but I may have missed some or deleted some that are needed.

Also:

- Fixed problem in running HMMER testsuite from Infernal. I now create
  a temporary hmmer/easel dir which is required, then delete it
  afterwards. 

- Added itest6-sensitivity.pl which performs some challenging searches
  using models and files collected by Sean in 2002. These were
  explained in 00README, but that's been removed and its text has been
  moved to itest6-sensitivity.pl.

- Added itest7-trunc.pl which tests search/scan pipeline on truncated
  seqs. 

- Updated option testing in testsuite to more comprehensively test new
  HMM-only pipeline specific code.

- I was using a 3 model file for multi-CM testing. This has been
  replaced by a 4 model file (adding zero basepair model snR75). New
  4 model file tests HMM-only pipeline.

- Removed old files used by 1.0 and earlier versions of Infernal. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4020 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-05-01T15:21:20Z,nawrockie
302ba1bf3a27d25ba26d9fd409ba6e8605bcb3df,Eric Nawrocki,eric.nawrocki@gmail.com,"Cleaning up Bugs/ directory, all that's left is 00README with updated
instructions on fixing/logging a bug, and BUGTRAX, the text file where
bugs are logged. Details:

- scripts/files for testing fixed bugs i3, i6, i9 are obsolete and
  have been deleted. i6 and i9 were dependent on cmscore which doesn't
  exist anymore. i3 was a bug in an old version of a scanning CYK
  function which is no longer in the code base, plus it required
  building a model and calling cmsearch with it. Since cmsearch
  now requires calibrated CM files, this would now require an
  unacceptably long calibration step.

Renamed i<d>-*.pl integrated test perl scripts to itest<d>-*.pl so
to reduce confusion with bug-related scripts since bugs are named i<d>
by convention.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4013 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-30T18:39:55Z,nawrockie
43a40238b53f1bf66bbf54e912d486555a7cc362,Eric Nawrocki,eric.nawrocki@gmail.com,"Moved and renamed perl scripts and required files that test fixed bugs
from Bugs/ to testsuite/ to be run as part of a 'make check', like
HMMER does. bugs.sqc will go away soon, only BUGTRAX will be kept in
Bugs/.

About to change i<d>*-.pl integrated test scripts to itest<d>*-.pl to
avoid confusion bug-related files, since bugs are named in BUGTRAX as
i<d> by convention.

Added testsuite/i1.pm, a perl module that parses cmsearch/cmscan --tblout
output. Based on hmmer's h3.pm. It is used by two of the integrated test
scripts.

Added testsuite/i5-pipeline.pl which runs some tests of the search and
scan pipeline, ensuring expected hits are found with expected scores.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4012 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-30T18:22:05Z,nawrockie
e1aece92e82528890d361bc55d5ae131d6369795,Eric Nawrocki,eric.nawrocki@gmail.com,"testsuite: 
- added i4-stdin.pl test, based on hmmer's i17-stdin.pl.
- updated CM files to new format (unparsed [COM], [DATE]
  lines added)
- updated names of CM files in i1*, i3* test scripts.

cmfetch.c: --index option causes check for existing press'd files and
dies if they exists (.i1i is a valid SSI index).  Before this
<cmfile>.i1m.ssi would be written and then subsequently never used by
cmfetch. Same thing currently happens in HMMER. Sean has a 'to do'
note related to this in HMMER's r3449 log. I'll mention this to him.

cmalign.c: new check for '-', '-' dual stdin mode.
cmstat.c: removed stopwatch for timing, it's unnecessary
cmcalibrate.c: fixed check for --seed value (it's an int, not a
boolean)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4011 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-30T14:42:36Z,nawrockie
6214418142070e599050eb21608216e7f26de09e,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed run-to-run variation in cmcalibrate if a CM occurs at a
different position in the CM file. Previously, there was no variation 
only for the same CM files, but the same model occuring first in a
file would be calibrated differently than if it were second in the
file. Run-to-run variation does occur the --seed 0 option is
used. This behavior is now completely consistent with hmmbuild
run-to-run variation in model calibration.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4010 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-30T12:53:15Z,nawrockie
ea6062a05e5bdf9622ca9dace748da423ad739be,Eric Nawrocki,eric.nawrocki@gmail.com,"Renamed all <fam>.rfam10p1.seed.sto to <fam>.sto, with: 
'svn mv <fam>.rfam10p1.seed.sto <fam>.sto'.

Renamed all <fam>*calibrated.cm to <fam>*c.cm, with: 
'svn mv <fam>*calibrated.cm <fam>*c.cm'

Added i3-msa-integrity.pl based on HMMER's test of a similar name. 

Added snR75.c.cm, a calibrated model with 0 basepairs for testing the
HMM-only pipeline.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4009 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-27T19:38:17Z,nawrockie
f568c1619e8428e20b964bae6a812df66f30883d,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild: Before building CM file foo.cm, cmbuild now checks whether
foo.cm.i1m, foo.cm.i1f, foo.cm.i1p, foo.cm.i1i, or foo.cm.ssi
exist. If any do, it dies with an error telling the user to delete
them first. Even -F won't cause these files to be deleted. 

The reason for this is that if a user builds a new foo.cm file, then
tries to use it while old foo.cm.i1* or foo.cm.ssi files exist,
Infernal will think that the foo.cm.i1* or foo.cm.ssi correspond with
the new foo.cm, when they don't. This is bad, since all Infernal
programs will use the binary file in foo.cm.i1m instead fo foo.cm if
it exists. I spoke briefly with Sean about this, and I think a similar
change in hmmbuild is warranted as well, though I haven't done that
here in case Sean wants to use a different solution.

The reason -F doesn't cause these files to be deleted is that no
Infernal program actually deletes old files, they only go so far as
overwriting ones. I didn't want to start that precedent, and plus I
think forcing the user to actually delete the files is safer.

cmpress: Fixed simple but serious bug where I was freeing the CM
before writing out the MSV filter file, which needs cm->W, cm->clen
and the number of basepairs in the CM. This meant those values were
usually invalid. I'm surprised this never caused a segfault.

testsuite: in process of adding more integrated tests, based on
hmmer's.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4008 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-27T13:04:55Z,nawrockie
e77b6116dbb9c87526fd881cd8529129f7f537d1,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified --tblout output, added 'bias' field, reordered score and
E-value.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4007 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-26T23:42:23Z,nawrockie
673e8980ac13ed26fff40fe4e747c5974b7d487f,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding testsuite.sqc, previously called 'exercises.sqc'.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4006 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-26T18:32:24Z,nawrockie
17224ee9eaf04b7a48aad413abf11cb9c952f84a,Eric Nawrocki,eric.nawrocki@gmail.com,"Added CM file format specification to userguide.

configure.ac: Updated release date from April to May.

cm_file.c: Fixed type in error message during asciicm file parsing.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4005 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-26T18:17:43Z,nawrockie
f3e4c4d6b11ebecf18d5b9a59dc9ea705f6a4815,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated comments in rmark-Rroc.pl.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4004 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-25T19:11:44Z,nawrockie
8f1b01c42c5e3185d295a1e77d3fe98f1da4cf6b,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch.c, cmscan.c, cmsearch.man, cmscan.man: 
Changed the --anytrunc option to a 'developer' option, which is now
only printed if --devhelp is used. This change was motivated by the
observation that E-values in --anytrunc mode are less accurate 
than standard E-values. This is not surprising given that cmcalibrate
does not consider truncated hits. --anytrunc allows truncated hits to
begin and end anywhere in the sequence. I could modify calibration to
work with --anytrunc, but that would take a while and --anytrunc is
not meant to be a commonly used option - it was mainly added for
testing purposes. 

xref: ~/notebook/12_0403_inf_hmmonly/00LOG; ELN3 p.63

cm_pipeline.c: modified some comments.

testsuite/snR75.rfam10p1.seed.sto: added this 0 basepair model for
testing the new HMM-only pipeline, more changes will come soon in the
.sqc files related to this.

Deleting documentation/userguide/Makefile, this now gets built from 
a Makefile.in by configure (previously, it was a static file).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4003 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-25T18:58:58Z,nawrockie
521395ae3fcaeafed0ff9e0e899e98afc552b17c,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild.c: added back in cm_zero_flanking_insert_columns() call which
I mistakenly deleted between r3984 and r3987.

cm_parsetree.c: cm_parsetree_Doctor() now appropriately ignores
ROOT_IL and ROOT_IR transitions, which subsequently get zeroed out by
cm_zero_flanking_insert_columns() called by cmbuild, instead of
returning !eslOK status when it sees them.

cm_submodel.c:debug_print_cm_params(), changed precision of transition
probabilities for output during debugging.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4002 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-24T10:44:08Z,nawrockie
3c01de5182bb7f81fd610e9dcfc4f17bf033ab28,Eric Nawrocki,eric.nawrocki@gmail.com,"One line fix of a careless mistake introduced in previous revision
4000: models were always being parameterized as if they had zero
basepairs. 
 --This line, and those below, will be ignored--

M    cmbuild.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4001 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-23T19:57:19Z,nawrockie
d39d31e2cfa67893d270589b73e5d34cf269a7e2,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_p7_modelmaker.c, cm_modelconfig.c:
The CM's maximum likelihood HMM, (cm->mlp7) now is given a copy of the
consensus structure of the CM as cm->mlp7->cs, this fixes a bug that
occurs if cm->mlp7->cs is NULL when P7_ALIDISPLAY's are converted to
a CM_ALIDISPLAY. 

cmbuild.c, cm_parsetree.c, infernal.h:
When building zero-basepair models with special HMM-like
parameterization, implicit D->I and I->D transitions (necessarily
MATL_D->MATL_IL or MATL_IL->MATL_D) in a cmbuild input MSA are now
doctor'ed in the same way they are for p7 HMMs in hmmer's
hmmbuild. This is done in cm_parsetree.c:cm_parsetree_Doctor(), which
is based on hmmer's p7_trace.c:p7_trace_Doctor(). The -O option has
been updated to output the doctored MSA. 

This is necessary so that zero basepair CMs can be parameterized
'identically' to their filter p7 HMMs. Since plan 7 doesn't allow D->I
or I->D transitions, we remove them from the CM before we create the
filter p7 HMM from it. 

Previous to this revision, I was simply ignoring D->I and I->D
transition counts and renormalizing the transition distributions. I
thought I could get away with this, but there's a pathological case in
rmark3 (Intron_gpI) where ignoring D->I and I->D causes a I->I
transition probability to get set so close to 1.0 that W is calc'ed by
the QDB algorithm as 20,000 (instead of ~600 normally). This occurs
because only one training sequence uses the I state in question and it
self-loops a bunch of times before transitioning to the next node's D
state, so if we ignore the I->D then we observe only I->I transitions
and get the very high I->I probability. By doctor'ing the parsetree so
the I->D becomes I->M we get at least one non I->I count, which ends
up reducing W back to a reasonable number.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@4000 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-23T19:41:21Z,nawrockie
ebe88eceaa9b7a88d5a2ed6518d526957658172e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with construction of filter p7 HMMs for models with zero
basepairs. Previously, these were being constructed from CMs built
using the default prior, instead of the special zero basepair prior.

Removed cm->comlog data structure and replaced it with the strings
ctime and comlog, which are used the same way they are for P7_HMMs in
hmmer. Added cm_SetCtime() and cm_AppendComlog() functions to
cm.c. This simplifies and allowed some code removal from cmbuild.c and
cmcalibrate.c which were manipulating the cm->comlog data structure
previously. 

CM file format changes slightly. BCOM, BDATE, CCOM, CDATE lines are
gone, replaced with a single DATE line, and potentially multiple COM
lines, handled the same way hmmer handles its COM and DATE lines. 

cmconvert now appends its command line string to the comlog of the CM
or HMM it outputs.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3997 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-20T20:18:01Z,nawrockie
1a308d638ac6c07891c87cf399d02e3c07eb3b3b,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with cmsearch -A, in
cm_alidisplay.c::cm_alidisplay_BackConvert(). If the CM_ALIDISPLAY did
not have posterior probability annotation a segfault would result.
Lack of PP annotation is rare, but does happen if memory required for
posterior annotation (Inside + Outside matrices) exceeds the maximum
matrix size, while memory required for CYK matrix does not.

Also, fixed error in counting of number of sequences re-searched for
5' and 3' truncations. This required addition of <npli_top> and
<npli_bot> parameters to the CM_PLI_ACCT data structure to keep track
of how many times the pipeline is run, which is kept track of
seperately for each pipeline pass.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3996 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-20T12:36:22Z,nawrockie
5d121b4a4d921fec7549429bbedabf1bf73d5457,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed sorting of hits from by score to by E-value prior to output in
cmsearch and cmscan. This new behavior matches hmmer.

Minor tweaks to tabular hit output in standard output and tabular
output (--tblout) for cmsearch and cmscan. In tabular standard output,
E-value is now before bit score, since it's the first sort key. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3995 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-19T14:11:13Z,nawrockie
51597ad4d5ba6dac6a063493072e7246ac4ced6e,Eric Nawrocki,eric.nawrocki@gmail.com,"Rethought and reverted changes in previous revisions to cmcalibrate
(r3992) and cmpress (r3987). Briefly, cmcalibrate no longer skips
calibration of zero basepair models by default, and cmpress requires
all models in the CM file being pressed be calibrated even ones with
zero basepairs. The rationale for these changes is discussed below.

As of r3992, models with zero basepairs would not be calibrated unless
--nohmmonly was used. The rationale was that an HMM would be used by
default in cmsearch/cmscan so CM E-value stats were
unnecessary. Similarly, as of r3987, cmpress would not require models
with zero basepairs be calibrated (all other models must be calibrated
though). This allowed cmscan to be run with a CM database in which
zero basepair CMs were not calibrated. This worked fine because HMM
E-value stats are calibrated at the cmbuild step, a la hmmbuild.

However, I realized that using -g (glocal mode) or --nohmmonly in
cmsearch or cmscan would require CM E-value stats even for models with
zero basepairs (since the HMM can't be run in glocal mode, so the CM
would need to be used). This meant that a user who wanted to use
glocal mode would have use --nohmmonly with cmcalibrate to force
calibration of zero bp models.

I don't want to require users know these caveats regarding 0 basepair
models, so I've reverted cmcalibrate to how it was prior to the r3992
commit (last prior change to cmcalibrate.c was r3968). That is,
cmcalibrate will always calibrate all models, even ones with 0
basepairs.  I've also reverted cmpress to require E-value stats for
all models.

It is still possible to use a non-calibrated zero basepair model in
cmsearch, but of course this will only happen for users that know they
can skip the calibration for these models (i.e. Rfam curators or those
rare, lovable users who actually read the documentation). I imagine
this ability to skip calibration could be useful when trying to build
a new family starting with one or a few sequences of unknown structure
where an initial fast HMM-only search can help you gain additional
homologs from which a structure might be inferred, as the Rfam
curators do (this situation is what motivated the development of the
HMM-only pipeline in the first place). However, before a release Rfam
would still want to calibrate the final model, even if it still has no
basepairs, because users who download the CM file should not be
limited. That is, they should be able to run glocal searches if they
want to.

For cmscan, all models need to be calibrated prior to running, since
cmpress requires calibrated models. I think this is reasonable
because cmscan should usually be run with a stable library of CMs,
e.g. a set of Rfam models from a specific release, which are probably
worth taking the time to calibrate, even if only to allow users to do
glocal cmscans.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3994 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-19T00:44:00Z,nawrockie
bd13bdea8cc741daa652d88b02cb834c5e65c47b,Eric Nawrocki,eric.nawrocki@gmail.com,"More changes due to the introduction of the HMM-only pipeline in
r3984. 

Updated cmemit and cmstat so they use the filter HMM instead of the CM
when the CM has 0 basepairs, just like cmsearch and cmscan do. In
cmemit, sequences are emitted from the filter HMM instead of the
CM. In cmstat, E-value statistics from the filter HMM are output
instead of E-value statistics from the CM. --nohmmonly forces use of
the CM for all models in both programs.

Updated cmcalibrate so it doesn't calibrate CMs with 0 basepairs by
default, since cmsearch and cmscan won't use the CM. Such models are
skipped and an informative message is output explaining why they were
skipped. The CCOM (cmcalibrate command) annotation in the CM file is
updated, but CM E-value stats are not added to the CM
file. --nohmmonly forces calibration of all models.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3992 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-18T18:39:05Z,nawrockie
354c694d5df3b7507ad5a1a51d2f63eb7f36a0c0,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch.c: MPI wasn't compiling thanks to recent changes in r3987,
	    now it is up to date.

hmmband.c: Fixed bug related to one fixed in r3975 having to do with
	   checking if BIF_B states should be set as unreachable
	   because their children BEGL_S or BEGR_S are during HMM
	   band definition. There was one rare case I wasn't checking
	   for. One sequence in RF00012 and 1 sequence in RF01855 CM
	   searches versus RFAMSEQ10 exhibited this case. I believe
	   all cases are handled properly now.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3988 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-17T12:03:29Z,nawrockie
733b317d067a3b8d1582fe3ea367da78bbd98548,Eric Nawrocki,eric.nawrocki@gmail.com,"More changes due to the introduction of the HMM-only pipeline variant
in r3984.

o New prior for zero-bp models in prior.c:Prior_Create().
  Added code copied from p7_prior.c:p7_prior_CreateNucleic() that uses
  the nhmmer default prior for models with 0 basepairs. I think the 
  nhmmer prior is more appropriate because it was trained on all
  columns of RNA alignments, whereas the singlet CM prior was trained
  only on single-stranded columns. Since the zero-bp models are meant
  for unstructured RNAs or RNAs of unknown structure, I think using
  the singlet prior, which has a strong A bias for example, is a bad
  idea. Ideally we'd have a prior trained on alignments of
  unstructured RNAs, but there's not enough data for that. 

o Models with zero basepairs need not be calibrated to be run in
  cmsearch and cmpress (and subsequently cmscan), because the CM 
  E-values are not used in the HMM-only pipeline variant.

o cmbuild: renamed --ignorant to --noss. This strips bps information from 
  SS_cons in input alignment, and, now, allows building models with no 
  SS_cons, they'll have 0 bps.

These changes were made with Rfam curators in mind. Their current
practice when faced with a RNA 'family' (often a single sequence) of
unknown structure is to predict one as a first step before building
the model. These changes should make it significantly easier for them
to build zero-bp models and do HMM-only searches first (since that
model need not be calibrated, and searches will be fast). Then they
can add a structure, but probably only if multiple homologs are found,
and an alignment of those homologs suggests a conserved structure.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3987 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-16T20:59:18Z,nawrockie
1fca4e63bb8311ba9c90400d6ecb96c2c1c4834b,Eric Nawrocki,eric.nawrocki@gmail.com,"Added ability to run a nhmmer-like HMM-only pipeline in
cmsearch/cmscan. 

By default, any model with 0 basepairs will use this
pipeline variant instead of the standard CM pipeline. 
It is also used (for all models) if --hmmonly is used.
This is true in both cmsearch and cmscan.

The motivation for this came out of the Xfam 2012 meeting. There was a
request to use HMMs for structureless CMs in Rfam, while not needing
Rfam curators to switch between nhmmer and Infernal, and not requiring
them to release a CM file for some families and a HMM file for
others. 

The hmmonly pipeline in Infernal is very similar to the one used by
nhmmer. It uses the same filters and filter thresholds. Bit scores are
often identical with nhmmer, though not always, due to subtle
differences in the pipelines. 

The --hmmF1, --hmmF2, --hmmF3, --hmmnobias, --hmmnonull2, and --hmmmax
options control the HMM-only pipeline (independently of the options
that control the CM pipeline).

Output has been modified due to this change. A hit alignment is now
annotated with whether it is to a CM or an HMM (cmscan results can
have these interleaved per query sequence). NC annotation (negative
scoring noncanonicals) is absent from HMM hits, since they'll normally
have 0 basepairs, and even if they do have basepairs (--hmmonly) the
paired positions won't have been scored together. 

Updated manpages and testsuite for this change.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3984 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-13T16:45:38Z,nawrockie
4c120be00c73f1e47ba885987a231f1895bc316c,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated the lone p7_MSVFilter_longtarget() call to be consistent with
its new prototype in HMMER, as of r3981.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3983 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-13T16:05:13Z,nawrockie
5b86f2619a645a202bacf08a5a54052bdbe4c89e,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_tophits.c: 
fixed small bug in printf formatting. 

cmbuild.c, dev-testsuite.sqc, cmbuild.man: 
Added -o and -O options. -o <f> sends summary output to <f> instead of
stdout. -O <f> saves input alignment with consensus columns annotated
to <f>. 

cm_modelmaker.c, infernal.h, cmbuild.c (additional): 
Modifying how inserted residues before the first and after the final
consensus positions in the input alignment to cmbuild are
treated. They no longer have any impact on the parameterization of the
model. 

Previously (since Infernal 0.1 probably) counts related to these
inserts were used to parameterize transitions involving the ROOT_IL
and ROOT_IR states (ROOT_S -> ROOT_IL, ROOT_S -> ROOT_IR, as well as
transitions out of ROOT_IL and ROOT_IR). However, this is probably a
bad idea because the ROOT_IL and ROOT_IR states are effectively
emitting outside the homology model. ROOT_IL and ROOT_IR are analogs
of the plan7 N and C states, which are not parameterized based on 
the input MSA in hmmbuild. 

Now, transitions into and out of ROOT_IL and ROOT_IR are parameterized
completely from the prior. As implemented in cmbuild, any insert
columns before the first consensus column or after the final consensus
column are now effectively ignored. That is, if we build two CMs:
model A from an alignment with flanking insert columns, and model B 
built from an identical alignment but with all flanking insert columns
removed, then CMs A and B will be identical. 

cmbuild reverts to the old behavior with either --v1p0 (which builds a
model the same way version 1.0.2 did) or --iflank, both of which are
special 'developer options', only shown to the user with --devhelp.

xref: ~/notebook/12_0318_inf_final_features/



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3977 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-05T18:26:11Z,nawrockie
071e811acc14a2a5d65bf505ac9693cc819731be,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed two memory leaks and one bug uncovered during preparation of my
xfam 2012 slides. I presented results from large-scale runs of
cmsearch and cmscan which tested the code more extensively than I had
previously. 

The bug:
hmmband.c: Fixed a bug during calculation of HMM bands for a BIF_B
state during standard (non-truncated) pipeline pass. If either the
BEGL_S or BEGR_S state is unreachable (bands exclude all possible
alignments including those states), then both of those states and the
parent BIF_B state should be made unreachable. I was incorrectly
testing for whether the BEGL_S or BEGR_S was unreachable. I'm actually
shocked this bug didn't show itself previously. The fix is a single
line, I've include a shortened version of the 'svn diff hmmband.c'
here for completeness:

@@ -1613,7 +1613,7 @@
-	    if(imin[v] == -1 || jmin[v] == -1) { 
+	    if(imin[w] == -1 || jmin[y] == -1) { 

Memory leak 1:
cm_pipeline.c: 
In pli_p7_filter(), p7_msvdata_ComputeRest() was being called
unnecessarily if more than one window survived the SSV filter in more
than one pipeline pass for the same model - it only need be called
once per model. For every additional time it was called per model, a
two float vectors of size (om->M+1) were being allocated and never
free'd. 

The fix is to now check if p7_msvdata_ComputeRest() was previously
called by checking if either msvdata->prefix_lengths of
msvdata->suffix_lengths are non-NULL, if so it need not be called
again.

Memory leak 2:
cm_pipeline.c:
In pli_cyk_env_filter() the i_surv vector was not being free'd in the
case that 0 envelopes survive the filter, now it is.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3975 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-04-02T19:57:16Z,nawrockie
dc55741e53bf5f6940b9ded67321746f1fe0439c,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed default F3,F4,F5 default threshold for database size between 200
Mb and 2 Gb. It was set as 0.008, but it should've been 0.0008. I had
mistyped it. Yikes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3973 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-28T00:43:55Z,nawrockie
aa3d0c36460aa7db8870b30690c5611f4d9be544,Eric Nawrocki,eric.nawrocki@gmail.com,"Added 1 important line to cmsearch/cmscan. A check in MPI mode if only
1 processor is running after MPI_Init() then we die with
cm_Fail(). We'll have no workers, so we can't run. Most likely cause
is if user fails to execute 'mpirun' and just does 'cmsearch --mpi'.
This check was in cmcalibrate and cmalign, but I hadn't added it to
cmsearch/cmscan since rebuilding them from hmmsearch/hmmscan.

I don't think a similar check is in hmmsearch or hmmscan. Should it
be? Without such a check, the MPI process will just run indefinitely.

I'm not sure if a cm_Fail() is kosher, but it seems to get the job
done (it kills the lone process that's running - there's no need to
worry about detached and confused workers).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3972 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-26T20:02:40Z,nawrockie
7be979895ee87474c430a1a50f045bf7ecfa0c3f,Eric Nawrocki,eric.nawrocki@gmail.com,"Updates to testsuite.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3971 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-26T19:22:49Z,nawrockie
a998cc4d38e29cc99903560e5be23fcfba3642c5,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated default filter thresholds for db size 200 Mb > Z > 20
Mb. Changed F1 from 0.30 to 0.35 and F2 from 0.20 to 0.15. 

xref: ~nawrockie/notebook/12_0319_inf_finalize_filter_thresholds/

Updated *mx_Dump* function calls in itest_brute.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3970 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-26T18:58:55Z,nawrockie
5c5fadefe67d6a4824c286bcedeb780a3d3fe44a,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed default filter thresholds based on recent rmark3 benchmarks
with final filter pipeline in place. These are the fastest strategies
that sacrifice <= 5% sensitivity (TPs at E-value < 0.1) relative to
--max at the specified database size Z. However, MER for these methods
is often close to --max thanks to increased specificity (fewer FPs).

xref: ~nawrockie/notebook/12_0319_inf_finalize_filter_thresholds/00LOG

New defaults, dependent on database size, Z:
                     MSV    Vit   Vbias locFwd lFbias glcFwd gFbias envdef
   min Z    max Z |   F1     F2    F2b      F3    F3b     F4    F4b     F5
--------------------------------------------------------------------------
    0 nt     2 Mb | 0.35    off    off  0.0200 0.0200 0.0200 0.0200 0.0200
    2 Mb    20 Mb | 0.35    off    off  0.0050 0.0050 0.0050 0.0050 0.0050
   20 Mb   200 Mb | 0.30   0.20   0.20  0.0030 0.0030 0.0030 0.0030 0.0030
  200 Mb     2 Gb | 0.15   0.15   0.15  0.0008 0.0008 0.0008 0.0008 0.0008 
    2 Gb    20 Gb | 0.15   0.15   0.15  0.0002 0.0002 0.0002 0.0002 0.0002
   20 Gb    inf   | 0.06   0.02   0.02  0.0002 0.0002 0.0002 0.0002 0.0002

F6 (CYK filter) is always 0.0001, regardless of Z.

I would have liked to turn off F1 for the first two db sizes, but
doing that decreased performance relative to using F1=0.35 so I left
it in. I was suspicious of this so I examined the differences in
detail. When F1 is turned off each target is chopped into 2*W length
windows with W overlapping residues b/t adjacent windows, however when
F1 is on windows are often significantly shorter than 2*W thanks to
Travis' new method of defining windows around diagonals based on
expected prefix/suffix lengths. This window size difference alone
causes about 7 hits to be missed in local Forward (F3) because the
profile and null model have their length calibrated to longer windows,
which drives the score down below threshold (often only a bit or
so). MSV is helping because it defines more accurate and tighter
windows which are penalized less solely due to their length. MSV does
miss 2 hits that would be found with it turned off, but 7 > 2 so I've
decided to keep MSV on for all stages.




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3969 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-26T18:13:11Z,nawrockie
9d185389c7ab7bccb37281bec26a2b6d0c7cc5ed,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added GC content of hits to cmsearch/cmscan output.

o In cmemit, with the -e (embed) option, sampled sequences are now
  embedded in 'realistic' genome-like sequence emitted from the fully
  connected HMM used by cmcalibrate which was trained on real genomes
  from all three domains. This makes experiments using sequences
  generated with -e more challenging/realistic. Previously sequences
  were embedded in iid sequence, which they still can be with --iid.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3968 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-26T17:30:53Z,nawrockie
d14068f90e8ce71cc80b64d2e8e82f35128a8ecb,Eric Nawrocki,eric.nawrocki@gmail.com,"Now compatible with recent changes in HMMER, namely 3f file
format in r3960 and change of FM_WINDOWLIST data structure name in
r3961. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3967 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-26T02:07:37Z,nawrockie
bbdce6ca431f71948546ed784f12ae0a5f85ca65,Eric Nawrocki,eric.nawrocki@gmail.com,"o Removed --anonbanded and --anewbands options from cmsearch/cmscan to
  simplify pipeline. Now type of hit alignment is always the same as
  the final search stage type; either HMM banded, QD banded or
  non-banded. If HMM banded, the same bands from search stage (when
  envelope boundaries may have been wider than final hit boundaries)
  are used for alignment, even though recalculating bands with final
  hit boundaries would probably yield tighter bands. We do not
  recalculate bands so we are guaranteed that the alignment displayed
  corresponds with the hit found in the search stage (in rare cases
  the new tighter bands may obscure that hit so the alignment display
  would be of a poorer hit). Also, any speed gain from tighter bands
  would be mostly or completely offset by time required for
  calculating the new bands.

o Renamed '--allstats' option in cmsearch and cmscan as '--verbose'
  and modified how it affects output. Removed per-hit alignment
  statistics such as matrix size, seconds required for alignment and
  tau used for calc'ing HMM bands from default output. These are
  useful for testing and debugging but not relevant to most users, and
  would likely be more confusing than beneficial. They are still
  printed with --verbose. Also modified the hit alignment summary
  statistics table, printed only with --verbose.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3966 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-25T23:51:33Z,nawrockie
8a860227667dccdf4248307b9e940bd8d1f87977,Eric Nawrocki,eric.nawrocki@gmail.com,"Added what is intended to be the final option to any of the v1.1
programs: --wcx <x> to cmsearch and cmscan. This sets the W parameter
(max expected hit length) of all models to <x> * clen (model consensus
length), ignoring the W from the CM file, which is calculated by
cmbuild using QDB and beta=1E-7 (by default).

The motivation for this was my vague recollection of a user telling me
they wanted to be able to set W on the command line. I imagine it
might be useful when trying to find hits that may include large
introns or other inserts. It's likely the default pipeline will find
these anyway if they're good hits, since W really only affects how
windows are defined around hits and multiple MSV hits would be merged
into one big window (possibly >> W) around all of them.  But homologs
with one or few MSV hits might be lost if they're >> W. This option
therefore is an expert one solely included to appease whoever it was
that requested it (maybe Franz Lang??).

<x> from --wcx <x> can't be less than 1.25, because we don't want
users to use W smaller than the model length as that would cause
problems in the filter pipeline, mainly in the glocal Forward stages,
which require a hit to the full model.

--wcx is necessarily incompatible with --nohmm, --qdb or --fqdb all of
which use QDBs at one or more CM stages. If QDBs are used, W is
defined as the max width of a QD band, so trying to set it on the
command line doesn't make sense.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3964 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-23T19:30:23Z,nawrockie
5cdf99dca57b288ed8e45c20dccd37f898d2b2fc,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cmscan.man. I thought I had added this already, as I refer to
updating it in r3937's svn log, which could be confusing if
anyone ever tries to revert these files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3963 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-23T18:59:49Z,nawrockie
73d25bb48a30e10cfbd0da855dbb13350803a6b0,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added -A <f> option to cmsearch, which saves a MSA of all hits above
  the inclusion threshold to file <f>. Updated man page and testsuite
  for this option. This option required adding two additional strings
  to the CM_ALIDISPLAY data structure, solely because ALIDISPLAY hit
  output does not display local end (EL state) emissions, but the msa
  must include them. Since there's no EL analog in HMMER, analogs of
  these strings are not necessary in P7_ALIDISPLAY.
  
  This change also necessitated two new functions:
  cm_alidisplay_BackConvert() which converts a CM_ALIDISPLAY back to a
  Parsetree_t, and cm_tophits_Alignment() which creates an MSA for all
  hits above inclusion thresh in a CM_TOPHITS data structure by
  repeated calls to cm_alidisplay_BackConvert(). These functions are
  based on analogous ones in HMMER.

o testsuite/
  Added dev_testsuite.sqc, which will replace the ten <prog>.sqc files
  (e.g. cmbuild.sqc). It is simply the concatenation of those 10
  <prog>.sqc files. ""make"" in testsuite/ still supports testing only
  one program (e.g. make cmbuild) but this now uses grep to pull out
  all relevant cmbuild tests, save them to a file 'tmp.sqc', run sqc
  on it and then remove 'tmp.sqc'. dev_testsuite.sqc is run with 
  a 'make devcheck'. It includes 1030 tests, and takes several minutes
  (10 maybe?) to run.

  The <prog>.sqc files have not yet been 'svn deleted'. They will be
  soon. 

o Other changes: fixed incorrect usage of 'esl_opt_IsOn()' in cmsearch
  for setting filter thresholds, these had default non-NULL, non-FALSE
  values, so esl_opt_IsOn() always returned TRUE even if they weren't
  invoked on the command line. The fix was to set their defaults to
  FALSE, since I wasn't actually using the default values anyway (they
  get set based on database size).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3962 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-23T13:49:23Z,nawrockie
2b82f7921958dd79d6f0e2191d7e4faab33192d1,Eric Nawrocki,eric.nawrocki@gmail.com,"o Brought itest_brute.c up to date with changes in truncated alignment
  since it was last looked at. 

o Added testsuite.sqc, this replaces exercises.sqc (which still has
  not yet been svn deleted). The lone unit test (cm_tophits_utest) and
  lone integrated test (itest_brute) are part of testsuite.sqc and are
  now run with a 'make check'. All tests other than these are 'option
  tests' from exercises.sqc. A 'make devcheck' runs the more
  comprehensive set of option tests in <prog>.sqc for each infernal
  program.

o Added INFERNAL_HMMERDIR=""hmmer"" to configure.ac and several
  Makefile.in's. Now Easel (INFERNAL_ESDIR) and HMMER, both libraries
  for Infernal, are treated the same. (Previously 'hmmer' was
  hardcoded, as opposed to a variable.)

o Updated several Makefile.in's so that they more appropriately change
  dir and execute 'make' in hmmer/ instead of hmmer/src, as they
  previously did. The lone exception is 'make check' still enters
  'hmmer/testsuite' and executes 'make check' there instead of in
  'hmmer/' because the latter would rerun Easel's testsuite, which is
  run with a prior 'make check' in easel/.

o .c changes are minor; removing commented out debugging printf
  statements and such. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3959 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-21T20:04:48Z,nawrockie
11c9b990f2b50d20a719390a9b1aa924c9de1e38,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating lone p7_MSVFilter_longtarget() call in cm_pipeline.c to work
with new function prototype as of HMMER r3957. The <force_ssv> flag is
set to TRUE to force SSV, not MSV run for all CM pipeline runs. SSV
was nearly always run anyway (at least for all Rfam 10.1 models)
unless user set --F1 <x>, with <x> less than 0.0025. Default F1 for
the biggest sized database (> 100Gb) is 0.05, so 0.0025 is really
overkill as it won't be significantly faster than a higher F1 value,
due to the organization of speed bottlenecks in later stages of the
pipeline.

refs: notebook/12_0318_inf_final_features/00LOG
      r3957 log HMMER


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3958 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-20T15:03:16Z,nawrockie
e46cc81f53ef0d0dc70da3ec326bbc9cbccaf18d,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild was transferring msa annotation to the CM too late, after the
cm->mlp7 maximum likelihood p7 HMM was being built, so the mlp7 wasn't
getting name, acc, desc annotation. This is normally innocuous but if
we use cmbuild --p7ml to define the mlp7 as the filter HMM, the mlp7 is
written to the cm file with a (null) name, and any subsequent
cmconvert --fhmm call will create a HMMER3 file without a valid name,
which is bad.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3956 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-20T13:17:58Z,nawrockie
7a6e7bfc27d65abd28a8534509079d68169d9e33,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding infernal.h, an all-encompassing header file replacing the
classic structs.h and funcs.h. Those haven't been deleted yet.  The
motivation for infernal.h was to mirror HMMER's use of a single header
file (hmmer.h), and to get rid of the non-descriptively named
structs.h and funcs.h, since the new installation procedure (which
follows HMMER's) will install infernal.h in an include directory. 

All compiled files have been modified; removed '#include ""structs.h""'
and '#include ""funcs.h""' and replaced with '#include ""infernal.h""'

Silenced some compiler warnings reported by Seolkyoung's machines
compiler, that were not being reported by mine.





git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3955 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-20T10:17:48Z,nawrockie
bf1721be187f98efaa645d95a85ee6a9625dffd5,Eric Nawrocki,eric.nawrocki@gmail.com,"o cm_pipeline_Create() was using esl_opt_IsUsed() when it should have
  been using esl_opt_IsOn() in several cases.

o An HMM is now stored inside a scan pipeline once it's read, so that
  truncated hit passes need not read it again to configure their own
  generic profile.

o Added -P option to cmstat, to display bit scores pertaining to a given
  CM P-value.

Small fixes to MPI issues in cmcalibrate.c and mpisupport.c that had
slipped through since I wasn't recently testing with MPI enabled.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3954 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-19T15:12:23Z,nawrockie
b0b1a45f107fd47eea0b1222b140b15e6ee554ae,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated copyright information. Added copyright.tex.in and
titlepage.tex.in in userguide, based on HMMER's. 

Small fix in rmark-master.pl.




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3953 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-18T14:11:58Z,nawrockie
45ff87141d706b76fab114fe0464853e21ff0842,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed incorrect usage of cmconvert in exercises.sqc. A 'make check' on
my Mac laptop now passes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3952 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-18T14:07:08Z,nawrockie
fc940167f3e46752985440b70ae1d59756372a56,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed recently introduced bug in scan pipeline. I was setting
  pli->maxW in cm_pli_NewModel based on cm->clen, when cm was NULL,
  should've used cm_clen read from special Infernal format press'ed
  MSV file.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3951 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-18T13:52:40Z,nawrockie
74d3bb39073f9f0eaf07a2f0998422027a94f599,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor changes to silence compiler warnings in Mac OS/X.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3950 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-18T13:47:29Z,nawrockie
510b15f7a171b60c556b129d3605eac631b7d9e6,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding userguide's new Makefile.in, this should've been added in an
earlier commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3949 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-18T13:06:40Z,nawrockie
37b1211610ae9ee90c2d27b32f08772b9c5d1734,Eric Nawrocki,eric.nawrocki@gmail.com,"Deleting unused trna.calibrated.cm file which caused a conflict on
case-insensitive Mac OS/X due to another file called
tRNA.calibrated.cm. Reported by Sean. Not sure how this file got in
here in the first place...



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3948 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-18T12:51:46Z,nawrockie
ad664c2c52811ebcca52ec69bcda751aad54d955,Eric Nawrocki,eric.nawrocki@gmail.com,"o Still updating userguide. 

o Added infernal.man man page.

o Changed HMMER_NCPU to INFERNAL_NCPU in threaded apps.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3947 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-17T18:51:45Z,nawrockie
9e56f8fa331355ba3730ad28c4dfb3f688bec53b,Eric Nawrocki,eric.nawrocki@gmail.com,"o rmark-master: added options to break down benchmark fasta file into
  multiple files, each with 1 sequence. This will make benchmarking
  the extremely slow --nohmm and --max options much easier. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3946 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-17T18:47:13Z,nawrockie
5197d9f9193d157b03bc172aa1f0d00600aa66c6,Eric Nawrocki,eric.nawrocki@gmail.com,"o Travis' new tighter MSV window definition is now default
  (p7_pipeline:p7_pli_ExtendAndMergeWindows()) based on improved
  benchmark results versus the old way.

o Envelope definition bias filter (F5b) is now OFF by default
  (previously it was on). This doesn't speed things up significantly.

o om->max_length is now reset as max of cm->W and 1.25 * cm->clen,
  instead of using the HMM's calculated value. This limits window
  sizes, and doesn't cause any hits to be missed. The 1.25 * cm->clen
  is hacky, but I'm worried about single-sequence built models which
  will have small Ws simply because no inserts were in the training
  'alignments'. 

o Enough has changed in the pipeline since I determined the default
  database-size dependent thresholds that they should be determined
  again. I'll do that soon.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3945 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-17T18:45:58Z,nawrockie
92723dc5169d2aad518637de9856179f12f33001,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding infernal.man, very minor changes to other .man files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3939 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-16T10:47:53Z,nawrockie
534493a775f8a145d18daace2d9cceadd8f7f920,Eric Nawrocki,eric.nawrocki@gmail.com,"- Fixed reading of CM files and sequence files from
  <stdin>. Previously this wouldn't work at all due to the way I was
  reading filter HMMs inside CM files. Now all applications should
  work identically to their analogs in HMMER with the sole exception
  that cmsearch can't read sequence files from stdin, because it does
  a first pass over the file to get the database size and the rewinds
  prior to searching.

- Added tests for reading from stdin for all cases to .sqc files.

- Updated cmsearch.man and cmscan.man; though these aren't final. I'm
  afraid their too verbose currently.

- Modified cmbuild to be more like hmmbuild. In absence of MSA names,
  gives first CM the same as the MSA file, and dies if it needs to
  build more CMs. Previously, for MSA file foo.sto, I'd name CM 1:
  foo-1, CM 2: foo-2 ... CM n: foo-n.

- Small changes to other man pages; borrowed heavily from analogous
  HMMER man pages to improve consistency. Only cmalign/hmmalign are
  still really different, because cmalign is more complicated, has
  MPI, and limits memory for large inputs. And of course cmcalibrate
  and hmmsim because hmmcalibrate and cmsim do not exist.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3937 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-15T19:28:23Z,nawrockie
8ed27b3bed0dbe4d08d49dcfad4fca84ae7a2791,Eric Nawrocki,eric.nawrocki@gmail.com,"Small revisions to sqc files. Added two required files which should
have been added previously.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3935 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-15T14:13:50Z,nawrockie
5f206b1bbde83cc8f0118589187c40655ed9e749,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding cmpress and cmconvert man pages.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3933 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-14T19:54:28Z,nawrockie
a2710dc81221ef3483058280519264e37257e5a5,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed two signficant typo bugs introduced during recent pipeline
  function reorganization. These were revealed by discrepancies in
  rmark3 benchmark results before and after that reorganization.

o Current rmark3 results, with recently revised MSV/SSV filter
  functions, now match those obtained before that revision.

o cmscan now works with recent MSV/SSV filter revisions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3931 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-14T19:27:27Z,nawrockie
d8210247bd45b8dfa7ca3104ef6a7842a706d0f4,Eric Nawrocki,eric.nawrocki@gmail.com,"Something went awry with my local copy of cmsearch.c before the last
commit (r3926) so that revision did not compile. This one will.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3927 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-13T19:46:55Z,nawrockie
b13f742a2b92d71939635036c0520225a7406047,Eric Nawrocki,eric.nawrocki@gmail.com,"IMPORTANT REVISION: As of this revision, Infernal now builds with
current the revision of hmmer. Revisions 3738 to 3925 would not
compile with concurrent versions of hmmer. Those revisions required
hmmer rev 3737 to compile because due to ongoing changes to the
ssv/msv long target functions in the interim.

Also added cmsearch --msvtight option to test Travis' new ssv/msv
filter tighter window definition procedure. Current default is to use
the old window definition of appending W residues onto beginning and
end of all ssv/msv hit endpoints that exceed the survival threshold.
My hope is to make his new tigher windowing method the default but I
need to do some benchmarking first.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3926 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-13T19:22:44Z,nawrockie
bcb3cc46b5970d7048be80608703fc8d6f2d2b01,Eric Nawrocki,eric.nawrocki@gmail.com,"o Nearly finished updating testsuite and man pages (except for
  cmsearch.man and cmscan.man). 
o Most code changes are minor, e.g. reordering of options and
  modifying -h output, and small fixes to problems revealed by
  testsuite. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3925 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-13T14:14:25Z,nawrockie
6b2924c8b830a5882ba6d66e7823f64ecb5bea34,Eric Nawrocki,eric.nawrocki@gmail.com,"- In process of updating man pages. 
- Reorganized options in cmalign.c, cmcalibrate.c, cmsearch.c,
  cmscan.c
- Moved RF annotation in pipeline output from above NC line at the
  very top to the very bottom, below PP line. Upon inspection
  this is definitely a better spot for it.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3917 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-09T21:44:05Z,nawrockie
044d1b10fa566f38c0a4937b058d23a4762fd2fb,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch.sqc now covers all options. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3911 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-08T21:50:44Z,nawrockie
ecfe3af18ab3e1034f6fb76469e1ea520a450155,Travis Wheeler,travis.wheeler@traviswheeler.com,"These changes cause libdivsufsort to be compiled when 'make' is called
from infernal's main directory. Previously, it was required that
'make' be called from the hmmer subdirectory



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3908 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-08T19:15:26Z,N/A
f324da89c742fcd5f9809062d3f68b591e3bf43d,Eric Nawrocki,eric.nawrocki@gmail.com,"Currently working on testsuite update of 'make devcheck' sqc
files. The goal here is to test all options at least once, as well as
what I guess would be popular option combinations. The update required
addition of sequence, alignment and CM files to testsuite/ which are
used by 'make devcheck'. 

Exercises for all applications (e.g. cmbuild.sqc) are complete, except
for cmsearch and cmscan. 

Most .c file changes are minor. Many are fixing problems with rare
options that were uncovered by updated sqc tests. 

Other changes:
cmemit: 
- added --embed <n> option for embedding emitted sequences within
  larger sequences of length <n>. 
- added --tr5p and --tr3p for truncating emitted sequences 5' and 3'.

cmpress:
- added requirement that CM file must be calibrated, because cmscan
  requires calibrated CMs.

cmconvert:
- added --mlhmm and --fhmm options for dumping the CM's maximum
  likelihood p7 HMM or filter p7 HMM in (current) HMMER3 format to a
  file. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3904 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-08T14:26:07Z,nawrockie
95b4016f7c73a2383dcf841cb02cfc87f025fff7,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed bug in determination of truncation penalties: we expect a
  MATP_IR in a MATP immediately prior to an END_E to have an
  impossible truncated begin score, yet we were throwing an error if
  this was the case. There's no consensus match state reachable from
  such a MATP_IR, so a truncated begin into it doesn't really make
  sense. This wasn't caught earlier because MATP->END situations are
  rare - they imply a consensus length 0 loop.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3898 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-05T15:55:11Z,nawrockie
056b73a54a135e14b86f68de9397fe3769595dbd,Eric Nawrocki,eric.nawrocki@gmail.com,"o Reorganized cm_pipeline.c; especially the CM search stage
  functions. Added several functions and improved modularization in
  general. 

o Split up old cm_pli_CMStage() function into two separate stages: 
  pli_cyk_env_filter and pli_final_stage(). This decouples CYK filter
  from the final Inside scoring and hit alignment stage.

o Added pli_cyk_seq_filter() which is used if --nohmm is enabled, this
  runs CYK as the first stage filter on full sequences (previously
  with --nohmm CYK was run on envelopes naively defined as 2*W chunks
  of each seq, with W overlapping residue with adjacent
  envelopes). pli_cyk_seq_filter() defines envelopes by appending
  nearby residues to hits reported by CYK and merging overlapping
  envelopes. --nohmm now mirrors cmsearch v1.0.2 --fil-no-hmm and is
  more efficient than the previous revision (which due to naive
  overlapping windows, searched each residue twice with CYK).
  
o Modified pli_align_hit() so it now uses DispatchSqAlignment() to
  create an alignment/parsetree. Previously there was a lot of code
  duplication between these two functions. I had to modify
  DispatchSqAlignment() slightly to make this work.

o Made all filter stage functions local to cm_pipeline.c, since
  they're never called outside of it.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3893 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-02T19:51:35Z,nawrockie
6babdc2d8eda3681c49ff882c9a21e6d551181bc,Eric Nawrocki,eric.nawrocki@gmail.com,"o IMPT: this revision requires hmmer r3737 to compile (see r3889 svn
  log for more info).

o Simple change, even though many files are affected. Added a
  CMConsensus_t ptr <cmcons> to CM_t data structure. It is built
  within CMLogoddsify() which is called (only) when the model is
  configured.  Adding cmcons to the CM data structure simplifies a lot
  of function calls that previously required both <cm> and a
  separately built CMConsensus_t pointer, including all CM related
  functions in the CM_PIPELINE. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3892 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-01T14:44:49Z,nawrockie
5e835a7b9d4bfd27ccc339f034f595e74800c1c8,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed bug in initialization of integer scores in a CM_TR_SCAN_MX, it
  was using float transition scores instead of the integer ones. This
  was not detected earlier because HMM banded matrices are used by
  default, but now I'm testing cmsearch --max, which uses non-banded
  matrices. 

o Bugs still exist in Diana's TrCYK_DnC(), which I need for
  nonbanded alignment of truncated hits with --max. I'm worried these
  will be difficult to fix because I'm unfamiliar with that code. 

o Changed type of ExpInfo_t's <cur_eff_dbsize> from long to a
  double. This number is the effective number of sequences in the
  database, the E value of a hit is obtained by multiplying P and this
  number. I'm not sure why it was a long previously, but I guess it is
  because actual database size (# res) was stored as a long. But using
  a long was problematic if the database was smaller than the average
  size of a hit because <cur_eff_dbsize> would be defined as 0.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3891 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-03-01T13:18:58Z,nawrockie
d6d68710c2b490a099b464b7ecbc2b3e5d1f8969,Eric Nawrocki,eric.nawrocki@gmail.com,"o IMPORTANT NOTE REGARDING WHY INFERNAL SVN REVISIONS 3737 TO 3890 MAY
  NOT COMPILE: this revision and all revisions back from 3737 to now
  (r3890) requires hmmer rev 3737 to compile. In my working directory
  I have a copy of hmmer r3737 sitting in infernal/hmmer/. The reason
  is due to a change in r3749 that Travis made to the hmmer's
  impl_sse/msvfilter.c which changed the function prototype and caused
  problems in Infernal's hmm filtering. Travis is planning on
  modifying the code further, and once that is done I'll update
  Infernal to work with current hmmer.

o Fixes/updates that were necessary to get 'make check''s
  exercises.sqc working. Most of these are small changes to code that
  is only used in testsuite programs: bandcyk-truncation-test,
  bandcyk-montecarlo-test, sub_cm-test, and cp9-test.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3890 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-29T20:28:29Z,nawrockie
8fea3162fda0f54fc0ff4102cd9705203e81b970,Eric Nawrocki,eric.nawrocki@gmail.com,"o IMPORTANT NOTE REGARDING WHY INFERNAL SVN REVISIONS 3737 TO 3889 MAY
  NOT COMPILE: this revision and all revisions back from 3737 to now
  (r3889) requires hmmer rev 3737 to compile. In my working directory
  I have a copy of hmmer r3737 sitting in infernal/hmmer/. The reason
  is due to a change in r3749 that Travis made to the hmmer's
  impl_sse/msvfilter.c which changed the function prototype and caused
  problems in Infernal's hmm filtering. Travis is planning on
  modifying the code further, and once that is done I'll update
  Infernal to work with current hmmer.

  Of course, I should have included this note in all logs from 3737 to
  present, but I neglected to. I'd like to go back and this note to
  the relevant svn logs, but I don't think I can. Unfortunately this
  means if anyone ever tries to revert to an Infernal revision between
  3737 and the current one they'll likely have trouble
  compiling. Hopefully in that case it won't be too difficult to
  figure out that hmmer/ r3737 is needed as I've put that information
  at the very beginning of several of the 00LOG files I keep in my
  electronic notebook directories. These 00LOGs have been referenced
  in many of the svn logs.

o Updated exercises.sqc. All tests that would be run with a 'make check'
  now pass, although 'make check' still fails because of a problem with
  ldivsufsort in hmmer. I'll resolve this soon.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3889 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-29T20:22:17Z,nawrockie
50fb6c1796635facdb15d7473eee6d69373598dc,Eric Nawrocki,eric.nawrocki@gmail.com,"o Reworked how truncation penalties are calculated. Each legal
  truncated begin match state (MATP_MP, MATL_ML, MATR_MR, BIF_B) now
  has its local begin probability split with any parent insert states
  it has (fraction is determined by expected occupancy).  Previously,
  a MATP_MP that modeled lpos..rpos split its probability with inserts
  that inserted before lpos and after rpos and similar rules were used
  for MATL_ML, MATR_MR, BIF_B. This was flawed in that some inserts
  didn't receive any truncated begin probability, and others had it
  assigned more than once. The new way fixes this.

o Updated pipeline to work with truncated hit passes when run in --max
  and --nohmm mode. The fix to truncation penalties resolved a problem
  in non-banded truncated Inside scanner.

o Modified Diana's TrCYK_DnC() and TrCYK_Inside() to take a flag:
  <do_1p0> that informs them to behave as their infernal 1.0 versions
  did. If FALSE, these functions act consistently with the truncated
  alignment functions in cm_dpalign_trunc.c() in the truncation
  penalty they enforce, which is different than what v1.0 used.
  This enables Diana's functions to be used in the pipeline when
  non-banded truncated alignments are required and return scores
  consistent with banded truncated alignments.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3888 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-28T16:58:22Z,nawrockie
7a15c07b2d4d1632b5be2facfca35e081c444a70,Eric Nawrocki,eric.nawrocki@gmail.com,"One more addition to testsuite.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3884 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-27T19:39:30Z,nawrockie
04b819f7c5e0dd464927fdec1478944b0adab7d4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Continuing update of testsuite. I'm going to use 3 Rfam10.1 seed
  alignments and CMs for most testsuite exercises. Adding them here. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3883 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-27T19:34:19Z,nawrockie
95674331802467ea413b6ed21f0213db678ad40d,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updating testsuite in preparation for 1.1 release. Added calibrated
  CMs in new file format, and 1.0 file format for cmconvert testing.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3882 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-27T15:27:52Z,nawrockie
4cab99bfee396cdb7385b0b1a3b137528d931788,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated cmscan to be consistent with recent options and pipeline
  related changes made in cmsearch. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3881 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-27T15:25:45Z,nawrockie
7f6967165a60fe07697e705d2819e15235f77746,Eric Nawrocki,eric.nawrocki@gmail.com,"Non-MPI cmsearch no longer uses an SSI index if one is
available. Previously, if available, SSI was used to determine the
database size and the total length of each sequence as it was read and
searched. If SSI was not available, the entire sequence file was read
with repeated calls to esl_sqio_ReadInfo() prior to doing any searches
to obtain the total size and each sequence's length. Now, the entire
file is read initially regardless of whether an SSI index exists or
not.
  
The behavior was changed because using SSI was only slightly faster in
most test cases and significant slower (~2X overall search time) in
some (when the sequence file had many sequences (~millions)). SSI
doesn't help much here because we need to read the entire file as we
search it anyhow (it would dramatically help if we were only searching
a few sequences in the file, for example). Some advantages of dropping
the use of SSI in non-MPI cmsearch is we've removed some code,
eliminated a branch point, and don't have to rely on the SSI index
being current.

MPI still requires SSI indexing. The reasoning there is that we may be
using hundreds of processors to search and the step of determining
database size must be done prior to the search with a single
processor, so it can be a bottleneck.

As the number of cores on a typical machine increases, we may want to
rethink this, and I may want to refer to the code in the previous
revision which used SSI in non-MPI mode. A better solution would be to
use a file format which puts the sequence length info at the beginning
of the file for quick retrieval.

xref: ~nawrockie/notebook/12_0221_inf_pipeline_finalize/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3877 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-24T21:21:19Z,nawrockie
f57bd8084aeb4a06bb4a4be0dd4a96e67c238593,Eric Nawrocki,eric.nawrocki@gmail.com,"- Modified non-MPI cmsearch so full sequence lengths are always known
  prior to calling cm_Pipeline(). If an SSI index is available the
  lengths are determined via an SSI lookup, if no SSI index exists, we
  do an initial read of the database with repeated esl_sqio_ReadInfo()
  calls and store the sequence lengths.

  This simplifies the pipeline because we now always know when the
  sequence chunk being searched contains have the 5' and 3' ends, so
  we only need to re-search the ends for truncated hits when necessary
  (previously we always researched the 3' end b/c we couldn't know if
  it was the true end). This allows me to remove
  cm_tophits.c:cm_tophits_RemoveBogusTerminusHits() and the
  CM_HIT_IS_REMOVED_TERMINUS and CM_HIT_FROM_TERMINUS_RESEARCH CM_HIT
  flags. (Actually I could have done this without the updated code in
  this revision, based on Travis' Easel r739 update to
  esl_sqio_ReadBlock() which added a check if each sequence window
  read contains the final residue of the sequence.)

  Also we can now set CM_HIT's srcL parameter as soon as the hit is
  found. Previously, we had to update all hit's srcL values with
  cm_tophits_SetSourceLengths() once the full lengths of the target
  sequences were determined (i.e. after the hits were created)
  cm_tophits_SetSourceLengths() has been removed.

- Note: if an SSI index esists and the sequence file contains > 1
  sequence with the same name (and different lengths), all but one of
  those sequences will be assigned the wrong L. I think we just can't
  deal with multiple sequences with the same name; I'll talk with Sean
  about this.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3876 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-24T15:29:46Z,nawrockie
71b64bf6a8591c24b0899824bd050dc6fb81a406,Eric Nawrocki,eric.nawrocki@gmail.com,"o Removed the -Z requirement from serial cmsearch. The database is
  now read by repeated calls to esl_sqio_ReadInfo() to set the
  database size. 

  Next step is to store the sequence lengths as the database is read
  in this initial pass. This will simplify the pipeline.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3875 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-23T19:17:42Z,nawrockie
02f1a1833dd4ab598ef5c0246019040dbaab1cb4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Cleaned up and revised CM_PIPELINE structure and creation in
  structs.h and cm_pipeline_Create() and cmsearch.c options.
  Not finished yet, but good commit point.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3874 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-23T18:32:47Z,nawrockie
fb128a48d2b1c2b6ce88240ff021f07436796f2f,Eric Nawrocki,eric.nawrocki@gmail.com,"o About to begin cleaning up pipeline code. I will first concentrate
  on removing options from the search/scan pipeline (mainly relevant
  to cmsearch.c/cmscan.c/cm_pipeline.c) which I tested during
  development of the pipeline but have determined to be no longer
  necessary. The code related to these options may be relevant in the
  future (post 1.1 release) if I revisit the pipeline code, but at
  that point I'll want to rethink any new options anyway so I'm
  convinced removing the options now is a good idea.

o Removed extraneous --noenvdef option from cmsearch and cmscan, it
  was disconnected previously but the option remained. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3873 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-22T16:07:35Z,nawrockie
73296cb28903c1fb6194697affa1422548798970,Eric Nawrocki,eric.nawrocki@gmail.com,"- Updated rmark/x-cmsearch to work with recently revised --tblout
  format.
- cm_parsetree.c: fixed an off-by-one bug in calculation of first
  consensus position in parsetree in rare case that 1st emission is
  from an EL entered from a MATR_MR state.
- cmsearch.c and cm_pipeline.c, revised some comments.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3872 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-22T15:47:40Z,nawrockie
66d240874c789978f72cdce5101d411561b5e8d4,Eric Nawrocki,eric.nawrocki@gmail.com,"o cm_tophits.c: corrected summary character for sequence bounds in hit
  alignment display for hits in the reverse complement of the target.
o cmalign.c: fixed DispatchSqAlignment() call in mpi_master() to
  current function prototype (I wasn't testing MPI compilation).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3870 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-21T16:23:17Z,nawrockie
c4163db15061cc3c33e0ada206a2c94f6f766df4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed serious bug in the four optimal accuracy alignment functions
  in computation of the EL state deck. I was calculating
  alpha[cm->M][j][d] independent of j, i.e is alpha[cm->M][j1][d] ==
  alpha[cm->M][j2][d] for any j1 and j2. Any alignment involving an EL
  state was being assigned an incorrect score (summed PP). I caught
  this by observing that rarely CYK alignments would have higher
  average PP than did OA alignments, which should never happen. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3867 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-21T15:00:31Z,nawrockie
51ce379b3185d15ba4feb1678d21060ac3aab12f,Eric Nawrocki,eric.nawrocki@gmail.com,"- Modified the conditions under which HMM banded matrices are free'd
  and rellocated in cm_hb_mx_GrowTo(), cm_tr_hb_mx_GrowTo(),
  cm_hb_shadow_mx_GrowTo() and cm_tr_hb_shadow_mx_GrowTo().  HMM
  banded matrices can vary dramatically in size, even for sequences in
  the same family, due to the tightness of the HMM bands.  The
  motivation here is to allow multi-threaded cmsearch, cmscan and
  cmalign to manage memory better by freeing large matrices when
  they're no longer needed.

  Previously, if the last processed sequence required a matrix half
  the maximum size or greater, the matrix was free'd. An additional
  condition is added in this revision, requiring that the required
  matrix size for the current sequence must also be at least 25%
  smaller than the current matrix size. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3866 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-20T21:07:06Z,nawrockie
c7be6b3c16f43453cde76fa58ec93972065015fe,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added --anytrunc option to cmsearch/cmscan enabling an alternative
  search strategy for truncated hits. There are now three such
  strategies: 

  1. default: 5'/3' truncated hits must include residue 1/L of the
     source sequence. 
  2. --notrunc: no truncated hits allowed.
  3. --anytrunc: truncated hits can start/end anywhere in the
     source sequence. 

  --anytrunc is implemented by doing only 2 pipeline passes, the
  first allowing only standard (non-truncated) hits and the second pass
  re-searches all full sequences allowing truncated hits to start/end
  anywhere. This option was added because I can imagine it might be
  useful for some searches, e.g. for split tRNAs or for SSU/LSU
  ribosomal RNAs that have very long inserts. --anytrunc is
  incompatible with -g (glocal mode).

  xref: 
  ~/notebook/12_0119_inf_trunc_finalize/00LOG and in 
  ELN3 page 51 (Kolbe09 benchmark results).

o Changed how P-values are calculated for the specially configured Rgm
  and Lgm P7 profiles used in the PLI_PASS_5P_ONLY_FORCE and
  PLI_PASS_3P_ONLY_FORCE pipeline passes that allow only 5' and 3'
  truncated hits respectively. Previously, a log(2/(M*(M+1))) penalty
  was assessed, but now a log(1/M) penalty is assessed because either
  the start node is fixed as 1 (3' trunc) or end node is fixed as M
  (5' trunc). 

o Fixed serious bug in cm_dpalign.c:cm_Posterior()/cm_PosteriorHB()
  and cm_dpalign_trunc.c:cm_TrPosterior()/cm_TrPosteriorHB(). The
  posterior matrix was being resized with cm_tr_mx_GrowTo() which
  could potentially free and reallocate the entire matrix if its
  current size was near the matrix size limit. As implemented, the
  outside matrix is reused as the posterior matrix in these functions
  to save memory, meaning the outside matrix could be free'd and
  reallocated prior to filling the posterior matrix, a process which
  uses the outside matrix values. This was very bad and I'm surprised
  it didn't expose itself earlier. I was only able to detect it on a
  single large RNaseP dataset using valgrind.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3865 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-20T19:29:44Z,nawrockie
e1ed3cc22cd097a6dc5dda937d380d9800eed2ab,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo, reported by Travis - possibly the first person to ever
read the User Guide ;)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3857 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-16T20:40:13Z,nawrockie
7b9394f49776f21fdfa0fa732fc32fd3e6d10a0a,Eric Nawrocki,eric.nawrocki@gmail.com,"Simplified how truncated search/alignment fits into the search/scan
pipeline and alignment pipeline by removing redundant flags and data
structures. Now, all truncated and scanners and aligners are passed a
pipeline pass index <pass_idx>, which dictates which types of
truncated alignments to allow as well as which truncation penalty to
use for any resulting hit/parsetree. (This is slightly awkward for
alignment functions ultimately called from 'cmalign', which require a
pipeline pass index to be passed in even though they're not called
from a search/scan pipeline; but it works and is relatively simple.)

Removed CM_TR_OPTS object, its functionality is entirely replaced by
<pass_idx>. Removed some CM_PIPELINE flags and associated options in
cmsearch/cmscan: <research_ends>, <do_force_ends>, <do_local_ends>,
<rs5term>, and <rs3term>. There is now a single CM_PIPELINE flag
related to truncated search: <do_trunc_ends>, if TRUE (default) allow
truncated search at sequence ends, if FALSE, don't.  In truncated
search, the first/final residues are always required to be present in
5'/3' truncated hits. This is no longer changeable via options to
cmsearch/cmscan. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3855 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-16T18:55:29Z,nawrockie
ac5f04121cb9dbdfae55c02cbd461705c1557afb,Eric Nawrocki,eric.nawrocki@gmail.com,"o Truncated begins into insert states are now allowed. This is
  hard-coded with a 'FALSE' flag pass into the one call of 
  cm_tr_penalties_Create() in cm_Configure(). The flag exists
  for testing purposes: if set to TRUE (disallowing truncated
  begins into inserts) an additional validation is performed
  that tests some of the penalty calculation code. This 
  validation can't be performed when inserts are allowed.

o Allowing truncated begins into inserts changes Kolbe09
  benchmark results very subtly, as expected.
  xref: ELN3 p50; ~/notebook/12_0119_inf_trunc_finalize/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3853 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-15T19:50:52Z,nawrockie
c6013e2cff4031ba895b49127d3ff75d2822b199,Eric Nawrocki,eric.nawrocki@gmail.com,"o Modified output of hit alignments when --aln-cyk is used to report
  average posterior probability.
o Fixed off-by-one bug in calculation of number of truncated positions
  5' if an EL is used to emit the first residue. 
o Truncated begins into inserts is currently disallowed. The plan is
  to run the Kolbe09 benchmark on this revision and place in my
  notebook. Then turn on truncated begins, recommit and rerun the
  benchmark. This way I'll have a record of the impact of allowing
  truncated begins into inserts on the benchmark, and those results
  will be reproducible because they'll be tied to specific SVN
  revisions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3852 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-15T15:44:39Z,nawrockie
420332cb2c5c8aadd18052b00aecd1c3c43ac30c,Eric Nawrocki,eric.nawrocki@gmail.com,"- Fixed bug in truncated optimal accuracy alignment functions
  (cm_TrOptAccAlign() and cm_TrOptAccAlignHB() in
  cm_dpalign_trunc.c()), which disallowed length 0 subtrees rooted at
  BEGL_S and BEGR_S states when updating parent BIF_B cells. These
  will necessarily have IMPOSSIBLE scores (since 0 residues have been
  emitted) but must be allowed as a special case. The analogous case
  was properly handled in the non-truncated functions I used as
  templates for the truncated versions, yet somehow I didn't properly
  incorporate it.

- Fixed small bug in calculation of insert local begin penalties in
  cm_trunc.c.

- Search and scan pipelines now correctly build non-banded matrices if
  the --aln-nonbanded flag is used.

- Modified summary character for sequence ends for truncated hits from
  '~'/'~' to '{'/'}' for start/end. I may still change this to 
  '['/']' which is currently used for non-truncated hits.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3851 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-15T13:20:10Z,nawrockie
54827bbc923d2ac490ae1fcb07526f500d04c381,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on incorporation of truncated scanners/aligners. Added
code for more appropriate determination of truncated begin penalties
into insert states. Removed cm->trbegin, truncated begin penalties,
these are now incorporated into the truncation penalties in the
CM_TR_PENALTIES object. 

cm_trunc.c::cm_tr_penalties_Create() has been revised to properly
determine fragment probability for local mode (previous method was
flawed), and cm_tr_penalties_Validate() tests the code there if 
inserts are ignored during creation. 

Many other small changes, as I revisited and updated old functions
relevant to the truncation penalty calculation.

xref: ELN3 p42-47: explanation and examples of truncation penalty
calculation in global and local mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3834 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-02-03T22:19:09Z,nawrockie
242f393db361cf6f77951f1448edc7ef08a4660f,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed bug in CM_ALIDISPLAY, model and sequence coordinate bounds
  were incorrectly calculated if first or final residue was emitted by
  an insert (impossible with CYK, but possible with optimal accuracy)
  or the EL state. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3818 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-24T13:15:42Z,nawrockie
f45db03c4534640be9bd235f67bc219772ce7663,Eric Nawrocki,eric.nawrocki@gmail.com,"o truncation bit score penalties are now deducted from truncated hits
  and alignments.
o added CM_TR_PENALTIES data structure for storing bit score penalty
  for truncated alignments. The penalty varies, depending on whether
  only 5' OR 3' truncation was allowed, or 5' AND 3' truncation was
  allowed, and on the internal entry state in local mode. This is why
  a separate data structure is useful. For convenience, a CM has a
  pointer to one of these, <cm->trp> which is built if the CM is
  configured for truncated search/alignment by cm_ConfigureSub().
o renamed TruncOpts_t to CM_TR_OPTS.
o added cm_trunc.c, it includes functions related to CM_TR_PENALTIES
  and CM_TR_OPTS.
o prototypes for all truncated alignment functions in
  cm_dpalign_trunc.c and truncated stochastic parsetree functions in
  cm_parsetree.c have changed, these now take a pty_idx int value
  which indicates which array in CM_TR_PENALTIES to draw truncation
  penalties from.
o added <trpenalty> variable to Parsetree_t, which stores the
  truncation penalty used in the parsetree, allowing the correct
  parsetree score to be derived from the CM and the parsetree. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3817 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-24T01:23:49Z,nawrockie
543288ffe704d2ee62bd3375ac8b4e097cf91481,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed small bug with cmcalibrate --random which allows models to be
  calibrated on sequences generated using the model's null model
  (usually iid). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3815 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-19T19:24:45Z,nawrockie
90d5953785fce258983010f34979759e7fbc1827,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug in cm_pipeline.c::cm_pli_p7Filter(). After MSV, long windows
greater than 2*W residues were being incorrectly split into windows of
2*W residues, with W == cm->W. Instead W == pli->maxW should have been
used. maxW is the max of cm->W and om->max_length, the W analog of
the HMM filter. maxW is used at all other stages of the pipeline, but
wasn't being used here. 

This bug caused problems when researching the W terminal residues of a
sequence for truncated hits, where the first/final residue is
expected to be involved in any surviving window because any hit that
survives MSV should be at least W residues. I was checking that the
first/final residue must be in any window in this case, and 
failing in rare cases, when maxW is > 2*cm->W.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3814 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-19T11:38:19Z,nawrockie
46752c3c44567d153ec4610e72c2e542ef45c05f,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated mpisupport.c to work with recent changes in data structures
  (missed earlier because I hadn't compiled with --enable-mpi).
o Other changes involve removal of debugging print statements. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3813 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-18T19:48:01Z,nawrockie
66617dad670a7bf353488ea9227445af0cd15987,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added --memreq option to cmcalibrate which prints the required
  memory for calibration and exits without actually calibrating any
  models. This was necessary because the scan matrix for large models
  can get big: for SSU, it is about 900 Mb, over 8 threads that's
  close to 7 Gb.

o Added Sizeof() functions for several data structures:
  - cm.c:cm_Sizeof()
  - cp9.c:cp9_Sizeof()
  - cm_p7_modelmaker.c:cm_p7_hmm_Sizeof()
  - display.c:SizeofEmitMap()
  - cp9_modelmaker.c:SizeofCP9Map()
  - hmmband.c:SizeofCP9Bands()
  - cm_qdband.c:SizeofCMQDBInfo()

o Fixed bug with start/stop positions reported with cmalign --sub. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3812 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-18T18:34:57Z,nawrockie
06e610b56947e10eb08914a42bf93095680c8ca8,Eric Nawrocki,eric.nawrocki@gmail.com,"Renamed x-cmalign.c to cmalign.c with 'svn mv x-cmalign.c
cmalign.c'. Replaced 'x-cmalign' in Makefile.in with 'cmalign'. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3811 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-18T00:27:37Z,nawrockie
bf1aa4c9fb66c52af6f9849a9a3ee1d1f25e8994,Eric Nawrocki,eric.nawrocki@gmail.com,"Deleted cmalign.c with 'svn delete cmalign.c'. About to rename
x-cmalign.c to cmalign.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3810 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-18T00:25:12Z,nawrockie
8e6500dba58a3ba4d4e02484bd02293b121dc0f4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added MPI support for x-cmalign.c.

o Fixed some memory leaks in x-cmalign using valgrind.

o Added non-banded standard and truncated matrices used for alignment
  to CM data structure: 

  nb_mx:  non-banded std CM_MX matrix (for CYK, Inside)
  nb_omx: non-banded std CM_MX matrix (for Outside, Posteriors)
  nb_emx: non-banded std CM_EMIT_MX matrix (for calc'ing PPs)
  nb_shmx: non-banded std CM_SHADOW_MX (for CYK, Optacc)

  trnb_mx:  non-banded truncated CM_TR_MX matrix (for CYK, Inside)
  trnb_omx: non-banded truncated CM_TR_MX matrix (for Outside, Posteriors)
  trnb_emx: non-banded truncated CM_TR_EMIT_MX matrix (for calc'ing PPs)
  trnb_shmx: non-banded truncated CM_TR_SHADOW_MX (for CYK, Optacc)

  These only get allocated if the CM_CONFIG_NONBANDEDMX flag is raised
  in cm->config_opts.
  
o Renamed CM's HMM banded matrices to be consistent
  with nonbanded names. Previously: hbmx, ohbmx, ehbmx, shhbmx,
  trhbmx, trohbmx, trehbmx, trshhbmx. Now: hb_mx, hb_omx, hb_emx,
  hb_shmx, trhb_mx, trhb_omx, trhb_emx, trhb_shmx.

o Moved, renamed and cleaned up:
  cm_dpalign.c::cm_SampleParsetree() to
  cm_parsetree.c::cm_StochasticParsetree()

  cm_dpalign.c::cm_SampleParsetreeHB() to
  cm_parsetree.c::cm_StochasticParsetreeHB()

  cm_dpalign_trunc.c::cm_TrSampleParsetree() to
  cm_parsetree.c::cm_TrStochasticParsetree()

  cm_dpalign_trunc.c::cm_TrSampleParsetreeHB() to
  cm_parsetree.c::cm_TrStochasticParsetreeHB()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3809 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-17T16:11:04Z,nawrockie
c9bf529571e89d8edcc5855a75f2e1b244d1aba3,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added stochastic traceback of truncated Inside nonbanded/HMM banded
  matrices in cm_dpalign_trunc.c, cm_TrSampleParsetree() and
  cm_TrSampleParsetreeHB(). Hooked these up with --sample in
  x-cmalign.

o Improved old non-truncated cm_SampleParsetree() and
  cm_SampleParsetreeHB(), these are now consistent with 
  the new truncated versions.

o x-cmalign output alignments now include #=GF annotation with
  command-line options used, date and cwd. I'm not sure if this is a
  good idea - I'll talk with Sean about it.

o Added cm_AlignSizeNeeded(), cm_AlignSizeNeededHB(),
  cm_TrAlignSizeNeeded() and cm_TrAlignSizeNeededHB() to cm_dpalign.c
  and cm_dpalign_trunc.c. These calculate the total size in Mb
  required for all CM DP matrices used in aligning a sequence. 

o Added total memory required for all DP matrices to per-sequence
  'scores' output in x-cmalign. The scores output is sent to file <f>
  with --sfile <f>, or to stdout if -o is used to save alignment in a
  file (instead of sending it to stdout).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3808 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-12T16:20:40Z,nawrockie
b86f80d20bd55f67724c0cd6287bbc4c7b51b56e,Eric Nawrocki,eric.nawrocki@gmail.com,"o added CM_ALNDATA structure and cm_alndata.c. Moved
  x-cmalign.c:process_align_workunit() to cm_alndata.c as
  ProcessAlignmentWorkunit().
o Removed all instances of seqs_to_aln_t data structure, replaced with
  CM_ALNDATA. The main reason for doing this is the redesign of the
  cmalign application (currently in x-cmalign.c).
o Removed all calls to old dispatch.c::DispatchAlignments(), replaced
  with cm_alndata:ProcessAlignmentWorkunit().
o seqstoaln.c and dispatch.c are no longer used, and so are not
  compiled by a 'make'.
o added D&C alignment with --small to x-cmalign, but in truncated mode
  (default) this does not guarantee an alignment of the full target
  sequence, instead returning an alignment of the subsequence which
  gives the maximum CYK score. I'll fix this soon. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3805 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-09T13:45:24Z,nawrockie
0b23ad0b25b63bb239a918d9807f6e8d3f2cc494,Eric Nawrocki,eric.nawrocki@gmail.com,"Rewrote cmalign from scratch. It comes in as 'x-cmalign.c',
'cmalign.c' is the old version. I'll switch the name soon.

Main motivation was to get threads working, and I wanted to simplify
the code as well. A secondary goal was to get rid of the old
DispatchAlignments() function. It is now replaced by a
'process_align_workunit()' local to x-cmalign.c (but this will have to
be made external soon so cmbuild can call it when --refine is
used). Serial and threaded are working, though there are a few options
still to add. MPI is not yet implemented. 

Additional changes relative to old (v1.0.2) cmalign: 
o truncated alignment is implemented, and is default.
o --mapali, based on hmmalign's option of the same name, comes in as a
  replacement to --withali. New implementation is much simpler because
  the new CM file format stores an alignment checksum and alignment
  map from the input alignment. --mapstr makes the input alignment
  structure be used (including pseudoknots), this replaces
  --withpknots. 
o --sub is still an option even though truncated alignment could
  replace it. I wanted to leave it in though to allow an analysis of
  the relative efficacy of each approach.
o Memory-saving mode is used, but only if necessary. Alignments are
  output in interleaved Stockholm if and only if all target sequences
  combined less than 10 Mb (this should limit total size of all
  parsetrees to about 250 Mb). If this size is exceeded, then each 10
  Mb chunk is aligned separately and output to a tmp file. After all
  sequences are aligned, the alignments in the tmp file are merged and
  the final alignment of all sequences is output to the normal output
  file in 1-line Pfam Stockholm format.

Unrelated change, that is responsible for many of the modified files
in this commit:
o Removed cmERRBUFSIZE, replaced with eslERRBUFSIZE. cmERRBUFSIZE was
  meant to allow for longer error messages, but it was not able to do
  that in fact because the ESL_FAIL, ESL_XFAIL macros allow a maximum
  length buffer of eslERRBUFSIZE anyway.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3800 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2012-01-05T22:06:47Z,nawrockie
163861cbe55e04ecfd51233841c0dbc780521d76,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --xfile option to cmcalibrate for printing out the hit scores in
the fit exponential tails. This will let me examine how many high
scoring hits get removed as beta is increased and tighter QDBs are
used. I'm hoping to change the default beta to get faster calibrations. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3798 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-30T15:51:29Z,nawrockie
a3bd63d49c17e64a134128f17e7300746943d093,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed cmcalibrate output. It is now one line per model with a time
estimate for each model printed before calibration begins. Previously,
time estimates for each mode (glocal CYK, glocal Inside, local CYK,
local Inside) were printed to separate lines as each mode's
calibration took place, but this prevented a user from estimating how
much total run time remains. To aid the user in this, I added a
'percent complete' progress bar, which should be fairly accurate even
in MPI mode. Additionally, summary statistics including mu, lambda and
total number of hits are printed in a 1-line-per-model format just
before cmcalibrate finishes and exits.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3797 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-29T20:15:23Z,nawrockie
c85a4242f0701345e19b148fc890ee23398dcad0,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added MPI support for cmcalibrate.
o Changed cm_Configure() function prototype to include a flag
  indicating if cm->W has been changed based on a command-line
  argument. In this case, the scan matrix is built differently. 
  This change is responsible for most of the changed files in this
  revision. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3796 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-29T14:08:58Z,nawrockie
5d1016519cc4ccfdc67fa651f7e6a712f6f0c6f4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Rewrote cmcalibrate.c based on cmscan.c and cmsearch.c, for the main
  purpose of adding multi-threading. It is now much simpler as well
  because filter thresholding and CP9 HMM exponential tail fitting are
  no longer necessary. MPI version not yet implemented.

o Changed how overlapping hits are removed from a CM_TOPHITS hit
  list. There was a major flaw in previous approach that prevented the
  correct removal overlaps in a greedy manner. New approach sorts
  differently and uses one of two methods that differ in time and
  memory complexity, depending on the number of hits to the same
  sequence and length of that sequence. Function name for sorting
  prior to overlap removal has changed; this the reason for many of
  the modified .c files in this revision.

o Fixed a simple but somehow difficult to find bug in cm_Clone() which
  was incorrectly copying the source CM's float EL self loop score
  into the destination CM's scaled integer EL self loop score.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3793 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-22T15:21:51Z,nawrockie
48e051776c897a46bdd3d1c09dd7e4b01af5b953,Eric Nawrocki,eric.nawrocki@gmail.com,"Major revision. There's several big interrelated changes here which
were simpler to do all at once, instead of committing each change
separately. 

o Overhauled how CM configuration is carried out. Goal is to have each
  CM configured at most once by cm_modelconfig.c::cm_Configure()
  (renamed from ConfigCM()). Upon entrance to this function a CM must
  be non-configured as verified by cm_nonconfigured_Verify(). I
  changed several external functions from funcs.h to be static local
  ones within cm_modelconfig.c so only cm_Configure() can call them.

  The motivation for the tighter regulation on configuration is to
  minimize possible execution paths through all the configuration
  functions, to minimize that chance that some paths will screw
  something up that would be difficult to detect. ConfigGlobal() is
  now gone: once a model is configured to local it cannot go back to
  global. If we really need to configure a model differently twice
  (only current case is in cmcalibrate) we have to clone the model
  prior to configuration and configure the clone differently than the
  original. cm_Clone() has been added to make this possible and is
  also now used in threaded cmsearch so QDBs to have to separately
  calculated for each thread's CM.

o Changed how QDBs are calculated and stored. Now, two sets of QDBs
  are stored in the CM file and data structure so we can potentially
  use one set for CYK filter in the pipeline and another for the final
  stage Inside scoring (even though we use HMM bands by default, we
  may need to failover into QDBs). We want to store them so cmsearch
  doesn't have to slowly recalculate them every run. If the user
  requests non-default beta values, then we'll have to compute new
  QDBs. I Introduced THE CM_QDBINFO object, mainly supported in
  cm_qdband.c, to hold the two sets of QDBs and two corresponding beta
  values. Both sets get defined with a single call to
  BandCalculationEngine() which had to be modified to handle this.  I
  also reworked the scan matrices to handle the QDB changes. The
  matrices are now called CM_SCAN_MX and CM_TR_SCAN_MX (to be
  consistent with other DP matrix names).

  Also, QDBs are now always configured in local mode, instead of local
  or glocal, so we don't have to recompute them if we want to do a
  glocal search. This only meaningfully affects the band on the
  ROOT_S, which is much tighter in glocal mode. I could have each DP
  scanning function change the band on ROOT_S they enforce when in
  glocal mode, but this is not yet implemented.

o The CM file format has changed slightly to include both sets of
  QDBs, instead of just one previously, and also total local begin and
  end probabilities <pbegin> and <pend> are now stored in the CM file,
  and now need to be defined in cmbuild, which has options for
  changing them, but then never changed again (especially after
  calibration). Carelessly, I previously allowed other applications to
  change these probabilities even though the CM E-values corresponded
  to the specific values used by cmcalibrate.

o cmcalibrate compiles again, after being left out of the Makefile
  since revision 3659, nearly 4 months ago. cmcalibrate had to be
  extensively reworked because CP9 HMM simulations are no longer
  necessary (we use HMMER p7s for all searches) and filter
  thresholding is no longer necessary (we now use model-independent
  thresholds like HMMER3 does). cmcalibrate serial mode is working,
  next step is to work on MPI and threaded.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3787 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-15T21:16:28Z,nawrockie
274c2d6467a84706de8294e952305222672ece47,Eric Nawrocki,eric.nawrocki@gmail.com,"Change in Makefile.in related to 'make check' that fixes hmmer
building. 

Partially updated exercises.sqc to work with new command-line options,
etc. for several of the applications. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3786 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-15T18:57:26Z,nawrockie
fa541c3568592b3f5b440dd9118467494b5dd5f4,Eric Nawrocki,eric.nawrocki@gmail.com,"With the --aln-cyk option enabled, cmsearch was not applying the null3
correction to the CYK score displayed in the hit alignment output, now
it is. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3783 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-07T15:53:34Z,nawrockie
ba001ecc13185f22c2c11b439af281ee348791ec,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed cmscore from Makefile.in's list of applications. It is no
longer useful and consequently isn't worth bringing
up-to-date. Infernal 1.1 won't be building it.

Reworked how many times CMLogoddsify() needs to be called during a
standard local CM configuration in cmsearch. Previously it was twice,
now its once. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3782 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-07T01:38:20Z,nawrockie
3085df09d30c7f59998b238c06e860b6a7a1132b,Eric Nawrocki,eric.nawrocki@gmail.com,"I accidentally committed the last revision (r3780) with an empty log.

The log for r3780 should've have read:

Revised, again, the CP9 HMMs that are part of the CM data
structure. Previously, there were 2 - cm->cp9loc and cm->cp9glb,
configured in local and global mode respectively. Now, there's four:

cm->cp9:  the standard cp9 hmm, configured in same mode (local/global)
	  as CM.
cm->Lcp9: for 3' truncated alignment: uses local begins only if CM is 
          locally configured, and equiprobable ends
cm->Rcp9: for 5' truncated alignment: uses local ends only if CM is 
          locally configured, and equiprobable begins
cm->Tcp9: for 5' and 3' truncated alignment: uses equiprobable begins
          and ends

The L,R,T cp9s are not built if the CM_CONFIG_NOTRUNC flag is raised.
They are used for deriving bands for L, R and T truncated alignment.

Also, changed how truncated local begin probabilities are
calculated. Previously ILs and IRs in MATP, MATL, and MATR nodes were
getting non-zero trbegin probs, by taking a fraction of the
probability for the local begin into the match state in the same node
(weighted by relative occupancy). Now, they take a fraction of the
local begin probs from match states immediately below them (not in the
same node). This makes BEGR_IL states reachable via truncated local
begins. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3781 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-06T16:14:57Z,nawrockie
5c568aafc4de5ef95a4fdd38c85210285e34c3d0,Eric Nawrocki,eric.nawrocki@gmail.com,"Revised, again, the CP9 HMMs that are part of the CM data
structure. Previously, there were 2 - cm->cp9loc and cm->cp9glb,
configured in local and global mode respectively. Now, there's four:

cm->cp9: the standard cp9 hmm, configured in same mode (local/global)
	 as CM.
cm->Lcp: for 3' truncated alignment: uses local begins only if CM is 
         locally configured, and equiprobable ends
cm->Rcp: for 5' truncated alignment: uses local begins only if CM is 
         locally configured, and equiprobable ends
cm->Lcp: for 3' truncated alignment: uses local begins only if CM is 
         locally configured, and equiprobable ends
         




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3780 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-06T16:06:07Z,nawrockie
69681b3d09c27feb4d607c7fe31ef5af8fd3d3eb,Eric Nawrocki,eric.nawrocki@gmail.com,"Two significant changes:

1. Revised how truncated alignment interacts with local begins. 

Added cm->trbegin and cm->trbeginsc arrays to the CM_t data
structure. These are analogous to cm->begin and cm->beginsc arrays but
allow local begins into insert states as well as main match
states. cm->trbegin probabilities are determined similarly to
cm->begin probabilities but also use the relative occupancy of inserts
versus match states. Begins into inserts are necessary because we
enforce the first/final residue of a target be included in any 5'/3'
truncated hit, and we need to be able to handle it if that residue is
an insert.

In global mode, a truncated hit must be rooted at state 0 or an
internal BIF_B state in the case of a Terminal (T) alignment. I
believe any such T alignment should be given a penalty of the summed
score of transitions from ROOT_S to the relevant BIF_B, but this isn't
implemented yet.

These changes were introduced to make scoring of truncated and
standard hits as consistent as possible, so I can reasonably use
standard E-values for truncated hits. 

2. Added a new CP9 HMM to the CM data structure for dealing with
   truncated alignment for a globally configured CM. 

This change is responsible for many of the modified files.  It
required renaming cm->cp9 to cm->cp9loc and adding a new CP9 HMM
called cm->cp9glb. The former is always locally configured and the
latter always globally. In glocal search mode, cm->cp9loc is used to
determine bands for truncated hits, and cm->cp9glb is used for
standard hits.  Many functions were previously passed a cm and were
using cm->cp9. These have been changed to take a cp9 directly and the
caller has to know if it should be cm->cp9loc or cm->cp9glb.

Just before I finished implementing this I thought of a better way,
which requires three additional cp9 HMM's one for each truncation
mode. I will work on this next, but wanted to commit current code so
I could revert if necessary.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3774 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-12-02T15:05:06Z,nawrockie
3e4bc633515b09f5ffc99f2f0e0fd711c57b9165,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed several Valgrind-diagnosed memory leaks. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3768 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-30T14:54:15Z,nawrockie
bac7eb9ccb6267a0805b063440c69b3bf19f4176,Eric Nawrocki,eric.nawrocki@gmail.com,"CM_PIPELINE accounting statistics are now collected separately for
each pipeline 'pass'. Pass 1 is the standard pass, analogous to the
pipeline run by hmmsearch, hmmscan, nhmmer, where the entire sequence is
searched. Pass 2 re-searches only the 5'-most W residues with
models/algorithms specifically configured to identify 5' truncated
hits (R marginal mode). Pass 3 does the analog of pass 2 but for the
3' terminus. Pass 4 re-searches short sequences that are less than W
residues in their entirety with models/algorithms configured to
identify hits truncated both 5' and 3'. By collecting stats for each
pass separately I can do testing to determine how the
terminal-sequence passes are behaving, which I couldn't do before. I'm
not sure how or if to display the pass 2-4 stats in default output yet.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3766 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-29T15:30:14Z,nawrockie
af9cdbbb6762644dcd3d1679d0e419180872daab,Eric Nawrocki,eric.nawrocki@gmail.com,"In previous commit, I accidentally included some local changes that I
didn't mean to. This revision puts cm_pipeline.c and structs.h back as
they should be.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3765 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-28T19:50:50Z,nawrockie
430698ab2ae3a16b383b75d2cb688d52515e2b5d,Eric Nawrocki,eric.nawrocki@gmail.com,"Overhauled how 5' and 3' ends of sequences are identified and
re-searched allowing for truncated hits. Previously, cmsearch and
cmscan handled this by copying the W terminal residues and calling
cm_Pipeline() with the terminus as a new sequence. This made the
otherwise straightforward serial, threaded and MPI loops significantly
more complex than they should be and required duplication of the
relevant code amongst those functions. Now, cm_Pipeline() handles
identifying, extracting and researching the terminal sequence. 

Unfortunately, in non-MPI cmsearch we don't always know the full
length of a target sequence while we are searching it, because long
sequences are input in overlapping 100Kb chunks. So we re-search the
3' end of all 100 Kb chunks, just in case each one turns out to be the
final one. This is wasteful, but not terribly, for each such 100Kb
chunk we re-search W residues, which on average should be about a 0.2%
duplication of effort.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3764 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-28T19:48:10Z,nawrockie
c5be4243edf5fd8908eb9f376832442ef5efd7c9,Eric Nawrocki,eric.nawrocki@gmail.com,"Simplified CP9 HMM dynamic programming functions in cp9_dp.c thanks to
their narrower scope. They are no longer used in 'search' mode, p7
HMMs and HMMER routines are now used. They are still used for deriving
bands for CM search/alignment though. The changes to those function
prototypes is responsible for many of the modified files here.

Still tweaking truncated search/alignment in the pipeline. I've fixed
a few problems from the previous revision; performance on Diana's
benchmark is improved.

I'm about to overhaul how cmsearch/cmscan identify the sequence ends,
which are re-searched for possible truncated hits. Currently, each of
the main loops in cmsearch/cmscan have to handle this (serial_loop,
pipeline_thread, and mpi_worker) and it is messy. I'm going to try to
shift this responsibility to the more general cm_Pipeline() function,
which should be cleaner.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3760 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-22T19:15:46Z,nawrockie
1bb5d86e2db703183a2cf32d9bfdf0e354571750,Eric Nawrocki,eric.nawrocki@gmail.com,"Serious changes introduced to how truncated hits are detected and
aligned. Now, by default:

 - the first residue of a target sequence must exist in R marginal
   alignments (truncation of 5' end of the RNA)
 - the final residue of a target sequence must exist in L marginal
   alignments (truncation of 3' end of the RNA)
 - the first and final residues of a target sequence must exist in T
   marginal alignments (truncation of 5' and 3' end of the RNA)

This change was introduced to reduce FPs in regions where truncated
hits are allowed (i.e. the first cm->W and final cm->W residues of
each target sequence) and because I believe it is consistent with the
assumptions underlying the truncated paradigm, that residues outside
the truncated hit are missing data. (For example, allowing a R
truncated hit to begin at position x != 1 ignores the fact that
residues 1..x-1 are not actually missing.)

Current strategy for enforcing first and/or final residues are
contained within truncated hits involves specially configured p7 HMMs
for L, R, and T modes, supported in a new file:
cm_p7_modelconfig_trunc.c. I am still experimenting with this. 

I plan on continuing to make changes to this new strategy in future
revisions, but this is a good commit point. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3757 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-21T21:04:20Z,nawrockie
157c6c28839f8e197d04fbc718d5cc20c5a47810,Eric Nawrocki,eric.nawrocki@gmail.com,"Experimenting with ways of improving performance on Diana's 2009 TrCYK
paper benchmark on artificially truncated RNase P and SSU rRNA
sequences. Added --nolocal option to the pipeline to use glocal domain
definition instead of local ddef for terminal windows (containing
residue 1 or L) to better define the non-truncated 3' ends of
5'-truncated sequences or vice versa. This looks promising but needs
more tweaking and experimentation. 

Fixed a bug related to HMM bands if Inside/TrInside finds more than
one hit in a single p7-defined envelope. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3748 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-16T21:19:46Z,nawrockie
7bb1ce81c23912dc05e738983ac6e70428f91b76,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cm_InitializeOptAccShadowDZero() and
cm_InitializeOptAccShadowDZeroHB() to handle a special case of
initializations for length 0 subtrees in optimal accuracy. Since, only
emissions contribute to the score zero length subtrees (d == 0) always
have the score IMPOSSIBLE, but the specific state path taken through
length 0 subtrees has consequences on the display of the alignment.
For example, in local mode, using an EL transition can be confusing to
the user if we could go right into a normal E state instead, but using
an EL may be preferable to transitioning through many delete->delete
transitions before reaching the nearest end. 

To determine which path to take ->EL or ->D->D->...->D->E these new
initialization functions compare the score of both possible paths and
update the shadow matrix so the higher scoring one is used. This
should make the resulting alignment display reasonable in all
cases. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3745 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-11T20:21:51Z,nawrockie
19c16d2705d31e26eb189188f82ebf7cb0b290bb,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified how truncated alignments are displayed in cmsearch/cmscan
output via the CM_ALIDISPLAY object. 

Previously, all truncated ends were shown, treated like local ends
(EL) for output, but this often included entire subtrees rooted at S
states being deleted thanks to the truncation. I thought this was
confusing and now only up to two additional EL-like insertions are
added for a truncated alignment. One indicating the number of
consensus model positions truncated at the 5' end at the beginning of
the alignment (if aln is R or T mode), and the other showing the
number of consensus model positions truncated at the 3' end at the end
of the alignment. Also, basepairs for which the other half has been
truncated-away are annotated with '?' in the 'NC' annotation line
indicating it is unknown if these pairs are negative-scoring
non-canonicals or not. I'm not sure if I'll keep this, but one nice
side effect of this is it helps orient the user as to how the
alignment is truncated, and points out that the user should not
attempt to look for the other half of such pairs in the alignment.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3743 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-10T15:26:44Z,nawrockie
475dac6ad92dc34a62621684f30efe140ee9b0de,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_dpsearch_trunc.c: All scanning truncated functions now take a
TrScanInfo_t object informing them whether to allow Left and/or Right
marginal alignments (allow_L and allow_R), and whether to require
first residue (i0) in L or T marginal mode alignments, or final
residue (j0) in R or T marginal mode alignments. Currently, only
allow_L and allow_R are functional, support for requiring i0 and/or j0
will come soon.

Fixed numerous small bugs with truncated search/alignment related to
its incorporation into the main search/scan pipeline, which were found
by running examples isolating those with obvious problems and tracing
down the problems with a GDB/Valgrind.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3742 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-09T11:38:57Z,nawrockie
93681419dc023d75bc56087432f2b303cc05c61f,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed how hits are reported in scanning DP functions (cm_dpsearch.c,
cm_dpsearch_trunc.c, sse_cm_dpsearch.c). A GammaHit matrix is now only
used if we're not using greedy hit resolution (--nogreedy in
cmsearch/cmscan). Otherwise we create a temporary CM_TOPHITS data
structure within the scanning DP functions, add all hits to it (many
of which probably overlap), and remove overlaps greedily based on
score and copy survivors to the master CM_TOPHITS before exiting.

This is significantly cleaner than the old way, which was using a
GammaHit matrix for greedy/non-greedy hit reporting, when it is not
necessary for the former. Also, cleaned up GammaHit matrix functions
which are now more specific and added cm_mx:ReportHitsGreedily(). 

Changed CM_SEARCH_CMGREEDY flag to CM_SEARCH_CMNOTGREEDY and inverted
its meaning because greedy hit resolution is now the default.

Also, I reverted cp9 local entry/exit probabilities back to
non-equiprobable, putting 95% probability on entering first node and
exiting final node (similar to the CM) based on benchmarking
results. Using equiprobable entry/exits slows down HMM banded
alignment of hits significantly and causes some sensitivity loss
relative to the old way (for a fixed tau probability loss
parameter). But this is not ideal for truncated alignment, where
equiprobable entries/exits make sense. I'm not sure how I'll
eventually resolve this yet.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3741 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-07T17:13:37Z,nawrockie
334820c36b780b70e5cc1661ef6a29391ae53e59,Eric Nawrocki,eric.nawrocki@gmail.com,"In the process of add truncated search/alignment to the main
pipeline. Code compiles but is known to crash in some cases.

I'm about to significantly change how hits are reported to the Gamma
matrix by all scanners, to more cleanly handle truncated hits, and I
wanted to commit prior to this change. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3740 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-04T15:57:08Z,nawrockie
5112906f4a54ccef511398ddac37c7009bb57e15,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_modelconfig.c:

Changed default behavior for how CP9 HMMs are locally
configured. Previously, they were configured to be as similar to the
locally configured CM as possible, with 1.-cm->pbegin probability of
starting with the first match state, and 1.-cm->pend probability of
ending with the final match state. Also, the I_0 and I_M (insert state
of first and last nodes) were unreachable because the CM states they
correspond to ROOT_IL and ROOT_IR are unreachable in a locally
configured CM.

Now, to better handle HMM banding for truncated alignment, all HMM
start/stops are equiprobable, and I_0 and I_M are reachable, because
they are in truncated local HMM alignment. In search I_0 and I_M will
never be used because they will never increase the bit score, but in
'cmalign' they should be reachable. Since the plan is to use truncated
alignment as default in cmalign, this change was necessary. I added a
flag in structs.h, CM_CONFIG_V1P0_HMM_LOCAL to allow reverting to the
old way, although no programs currently have options for this. I plan
to benchmark the effect of this on Diana's benchmark from the trCYK
paper. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3736 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-02T18:50:31Z,nawrockie
538d849f094bae4495fa61e51894a3d50a91f7d3,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug in truncated HMM banded optimal accuracy
(cm_dpalign_trunc.c::cm_TrOptAccAlignHB()): self-IL inserts were
incorrectly not being considered in J and L marginal modes. They are
meant to be, and are, ignored in R marginal mode because they're
silent. 

cm_dpalign.c and cm_dpalign_trunc.c: renamed matrix dump files that
are printed when eslDEBUGLEVEL >= 2.
 --This line, and those below, will be ignored--

M    src/cm_dpalign_trunc.c
M    src/cm_dpalign.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3735 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-02T15:36:42Z,nawrockie
bc2eac57196bccbd1750f81c6c78276ac545f90b,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed two bugs related to the newly revised optimal accuracy
implementation: 

1. In HMM banded standard and truncated OA, zero-length parsetrees
   rooted at S states are sometimes observed in the optimal parsetree
   which correspond to cells that are inconsistent with the
   bands. These cases are now specifically checked for and allowed
   (previously the program failed with an error). This can happen in
   OA because only emissions contribute to the score. There's a
   descriptive comment explaining this special case at the relevant
   point in cm_dpalign.c::cm_alignT_hb() and
   cm_dpalign_trunc.c::cm_tr_alignT_hb().

2. I was mistakenly overwriting initializations for transitions to
   zero-length EL parse-subtrees in all four optimal accuracy 
   functions (banded and non-banded; standard and truncated).

Also removed some debugging print statements from cmsearch and
hmmband.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3732 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-11-01T18:58:47Z,nawrockie
933859cd5d06e646edc451f2e14d6c940b80360d,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug in initialization of EL state deck in all four optimal
accuracy routines (both banded and non-banded, both standard and
truncated), and an off-by-one bug in standard and truncated HMM banded
optimal accuracy routines in a special optimal accuracy specific
intialization case involving zero length parsetrees for D states.

cm_mx.c:cm_hb_mx_Dump() now prints the EL deck.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3731 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-31T10:21:56Z,nawrockie
906f9f4623fb27c6ecbb8601b10c625ac8898d36,Eric Nawrocki,eric.nawrocki@gmail.com,"Small changes to get cmsearch working again without verbose debugging
output. I had introduced some problems while working truncated
alignment, which are cleaned up here. cmsearch is functional again,
but the testsuite is still in flux and 'make check' still fails.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3728 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-28T03:31:05Z,nawrockie
4d2d2a8d75b87a30814eecbda93cf4c46b966896,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed icc compiler warnings (withOUT configuring with
--enable-debugging) reported via email by Sean on 10.24.11.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3726 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-27T18:45:39Z,nawrockie
9744507f8ab4b6947e7aa3194b03e4d1a5262bdf,Eric Nawrocki,eric.nawrocki@gmail.com,"Reordered how transitions are examined in TrOptAcc functions so that
consensus states are always examined first; before inserts. This is
important for MATR node states in L marginal mode and MATL node states
in R marginal mode. These states don't emit, so they have equal scores
and the first one examined will be chosen. We enforce the first one
examined is the consensus state (MATR_MR or MATL_ML) so the optimally
accurate parsetree preferentially uses consensus states in these
situations. I also removed some debugging print statements. 

I plan to pause the work on truncated alignment for a moment and
switch focus to getting Infernal build-able and usable again prior to
integrating the truncated alignment into the search pipeline and
cmalign. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3725 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-27T18:14:41Z,nawrockie
b1dda2f9cf5f244889ca43e0cbddc598a8dd2219,Eric Nawrocki,eric.nawrocki@gmail.com,"Committing minor changes made locally on my MacBook Pro because I
realized that Valgrind doesn't work with Mac OS 10.7, to which I
(prematurely it seems) upgraded my laptop this weekend. I need to
switch over to working on the Janelia file system where Valgrind
works. 

Looks like I won't be working locally until Valgrind is updated
because I am completely dependent on it for finding bugs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3724 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-25T01:46:47Z,nawrockie
511c2fd210f85fe5d90fec31356c9abbf551c039,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on truncated alignment functions: all functions now take
an optimal alignment mode (<opt_mode>) parameter, which may be
'unknown' in CYK and Inside functions. If not unknown, the optimal
mode dictates which of the L, R and T matrices must be filled. If
unknown, all three will be filled. The J matrix is always filled.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3723 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-24T18:09:33Z,nawrockie
974ab0efc170a3f4ec34d39efea44d823413071e,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating truncated alignment functions to handle the possibility that
the optimal marginal mode is known and passed in. In this case we can
usually save time by not filling in one or more of the L, R or T
matrices. 

Current code will not compile, I'm committing files from my laptop so
I can start working on my Janelia desktop again. I've updated the
system software on the laptop to OS 10.7 and it has led to problems
with building. I think I may need to reinstall Apple's developer
tools.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3721 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-24T13:04:04Z,nawrockie
90d8b93ea480261024b31e1fdc18dbc9b98c06d0,Eric Nawrocki,eric.nawrocki@gmail.com,"Added HMM banded truncated outside, optimal accuracy, posterior, and
'EmitterPosterior' functions.

Optimal accuracy tracebacks are currently flawed in that transitions
from silent inserts (ILs in Right marginal mode and IRs in Left
marginal mode) are preferred over match states simply because those
inserts are inspected before the match states in the DP recursion and
both have identical scores. This leads to unnecessary states in the
optimally accurate parsetree. I think the only reasonable way to fix
this is to create new ordering of possible child states to transition
to for Left and Right marginal mode updates in the optimal accuracy DP
recursion. I'll attempt this soon.




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3716 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-12T13:38:17Z,nawrockie
6883e7290fb70021b1a375e1275798053fb0873f,Eric Nawrocki,eric.nawrocki@gmail.com,"There are several changes in this commit, mainly to functions in
cm_dpalign_trunc.c and cm_mx.c. It turned out to be easier to do all
of these at once rather than break them down into smaller revisions:

- Brought cm_dpalign_trunc.c functions in line with r3709 changes to
  cm_dpalign.c. Most important update is that all functions no longer
  take i0 and j0 sequence boundaries, but only sequence length L and
  explicitly operate on the full sequence 1..L instead of i0..j0.

- Added CM_HB_EMIT_MX, CM_TR_EMIT_MX, CM_TR_HB_EMIT_MX matrices to
  cm_mx.c and associated functions based on similar pre-existing data
  structures. 

- Updated cm_dpalign_trunc.c:cm_TrOptAccAlign() to work with emit
  matrices instead of a posterior matrix. This brings truncated
  non-banded optimal accuracy in line with the SVN r3710 modification
  to standard non-banded optimal accuracy.

The current code compiles, but is known to not work on several test
examples. I'll fix these soon, but wanted to commit the large changes
discussed above first.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3712 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-07T19:25:38Z,nawrockie
fea4c895923d5b4ab72b3eca277a113c3ca70778,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified optimal accuracy alignment by changing the posterior
probability the optimal accuracy DP algorithm in cm_OptAccAlign()
uses. Previously, the posterior matrix was used: post[v][j][d] is the
log of the posterior probability that state v is used with a subtree
from i=j-d+1 to j. Now, it uses emitmx->l_pp[v][i] and/or
emitmx->r_pp[v][j], the posterior probability that state v emitted
residue i and/or j (this is actually not strictly true for MATP_MP,
MATP_ML and MATP_MR states, see CM_EMIT_MX defn in structs.h).  This
makes optimal accuracy alignment return what it is supposed to: the
parsetree for which the sum of the posterior probability that each
residue aligns at its given position is maximized. Previously
(including Infernal v1.0 through v1.0.2), cm_OptAccAlign() was finding
a parsetree that was often, but not guaranteed to be, the actual
optimal accuracy alignment.

To make the new optimal accuracy alignment work efficiently, I added a
new data structure CM_EMIT_MX, which is filled from a posterior matrix
using cm_dpalign.c::cm_EmitterPosterior(). See structs.h for details
on the data structure and cm_mx.c for its functions. The CM_EMIT_MX
data structure was also designed so that an HMM banded variant would
be simple to implement. That will come in a subsequent commit as
CM_HB_EMIT_MX.

ref: ~nawrockie/notebook/11_0930_inf_optacc_revision/00LOG



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3710 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-10-03T18:24:07Z,nawrockie
03359d1b86c479c7dbe22149d8023ce6496e0f86,Eric Nawrocki,eric.nawrocki@gmail.com,"Most changes are in cm_dpalign.c, where I did general code clean-up
and modified some function prototypes. 

The main motivation was to force all alignment functions to take only
'L' the sequence length instead of 'i0' and 'j0' start and end
points. Using i0 and j0 was left over from the divide and conquer
(D&C) small memory functions upon the cm_dpalign.c functions were
originally based, but it no longer applies. The D&C functions are
designed to be called recursively on subsequences, where i0 != 1 and
j0 != L, but all of the alignment functions in cm_dpalign.c are
designed to be called once on the full sequence 1..L. Using both i0
and j0 was misleading and probably wouldn't even work in some cases if
i0 != 1. Making this change simplifies the code a small amount
throughout all of the DP functions because we know that matrix
position j corresponds to sequence position j, whereas before it could
be offset by i0-1.  While I was doing this I took the opportunity to
generally clean up the code and make the various functions, many of
which are very similar (CYK and Inside functions for example) as
similar as possible.

This introduces a bunch of minor, trivial code changes to the DP
recursions in cm_dpalign.c. Everything 'should' still work, but any
typo I may have made could certainly have broken something. Future
testing should find any of these. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3709 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-30T16:42:02Z,nawrockie
0ff81279895404c9a8f428765bc831f5d89ca2e0,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cm_dpalign_trunc.c::cm_TrOptAccAlign(). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3708 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-29T13:52:21Z,nawrockie
fc6dcbaf118802f415190456a190ca47d21edcf7,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_TrInside() and cm_TrOutside() are now consistent (based on my
current testing on small models) and the resulting {J,L,R,T}alpha and
{J,L,R,T}beta matrices can be combined into a valid posterior matrix
using cm_TrPosterior(). The cm_TrCheckPosterior() function checks this
matrix to make sure that each residue has a summed probability of 1.0
of being emitted from some state in the model.

The optimal 'Inside' score is currently calculated as the maximum
of the summed log odds score of: 

(a) all valid J parsetrees
(b) all valid L parsetrees
(c) all valid R parsetrees
(d) all valid T parsetrees

That is, it isn't the sum of all possible parsetrees in all modes. To
get a set of Outside matrices from which valid Posteriors can be
calculated, we need to restrict possible parsetree modes based on
which of (a), (b), (c) or (d) defined the Inside score. If:

(a) only allow J      parsetrees in the Outside Beta matrices
(b) only allow J or L parsetrees in the Outside Beta matrices
(c) only allow J or R parsetrees in the Outside Beta matrices
(d) allow all parsetrees in the Outside Beta matrices

If we don't restrict the possible parsetrees then we can get
[v][j][d] cells for which 
{J,L,R,T}alpha[v][j][d] + {J,L,R,T}beta[v][j][d] exceeds the
Inside score, which we don't want. Fortunately, in Outside it's simple
to restrict the mode of possible parsetrees during initialization of
cells for which j == L and d == L (for sequence length L), by setting
cells for disallowed modes to IMPOSSIBLE.

Restricting modes also allows an easy speedup and memory savings of
the DP algorithms, by skipping updates of cells in disallowed modes. I
haven't implemented this yet though.

We should be able to restrict modes when doing cm_TrCYKAlign() or
cm_TrInsideAlign() as well if we're in the search pipeline because the
first pass TrCYK/TrInside scanner will give us the optimal mode.

ref: ELN3 notebook p8-11
ref: ~nawrockie/notebook/11_0816_inf_trcyk_banded/00LOG



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3706 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-28T13:06:04Z,nawrockie
0fdd7d54d301890f0c6d743b1b639c922aa1b83c,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated truncated CYK/Inside/Outside alignment and scanner functions
to explicitly check for detached insert states (MATL_IL's and (rarely)
MATP_IR's immediately before END_E states) and keep all DP cells for
those states as their initialized value of IMPOSSIBLE. Even though
transitions into detached states are all 0.0, the truncated algorithms
allow begins and ends from IL/IR states regardless of the values of
transition probabilities into those states. So, while we don't need to
handle these states in a special way in the standard (non-truncated)
algorithms because they'll be unreachable, we do in the truncated
ones. Detached inserts need to be unreachable to effectively remove
ambiguities from the CM grammar.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3705 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-26T13:45:23Z,nawrockie
93dafdc38844f66bd8f2c27977299c0a94cf1f1e,Eric Nawrocki,eric.nawrocki@gmail.com,"itest_brute now works in local and global mode for standard and
truncated DP algorithms, where 'works' means that 1000 randomly
parameterized versions of the example CM (ROOT->MATL->MATL->END) show
agreement between the DP implementations (cm_CYKAlign(),
cm_InsideAlign(), cm_TrCYKAlign() and cm_TrInsideAlign()) and brute
force enumerations of all possible standard, J marginal, L marginal
and R marginal paths for target sequences 'A' and 'AA'. 

I introduced a small but significant change to Diana's TrCYK (and
TrInside) algorithms: IL->IL transitions are now disallowed in Right
marginal mode and IR->IR transitions are now disallowed in Left
marginal mode. xref: ELN3, p5.

These self insert transitions would be silent (non-emitting), meaning
there are an infinite number of them (making them impossible to
enumerate in itest_brute.c). We could easily and correctly account for
the contribution of the infinitely large set of such transitions b/c
inserts have a simple geometric length distribution (sum(L=1 to inf)
of staying in an insert L residues is (1 / (1/x)-1) where x is the
self loop probability), but that would introduce a strange special
case into the DP recursion. Or we could arbitrarily allow N
insert->inserts, which I chose to do with N=0. This can never effect
the optimal CYK score because an I->I transition must have a negative
score and doesn't emit any residues (from IL in R marginal mode or IR
in L marginal mode), so choosing 0 self loops is always optimal. It
does affect TrInside() however, but not in a significant way because
no residues are emitted from these states (optimal accuracy alignments
won't be changed). The bit score will be affected, but I don't think
they will be affected in any meaningful way. The most important thing
is to make sure TrOutside() handles the inserts in the same way (which
I haven't done yet).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3703 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-23T20:43:52Z,nawrockie
2a12da71ae6ab5de2b2f03b690e667565b9f4be0,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on itest_brute.c. It now tests local mode and truncated
modes. In truncated alignment, it tests for areement between
brute-force enumeration versus DP implementations in the optimal J, L
and R scores.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3702 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-22T12:55:05Z,nawrockie
2601f2a08dbf6a08ed2899fd328d2481092704d6,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed names of cm_cyk_align(), cm_cyk_align_hb, cm_optacc_align(),
cm_optacc_align_hb() and their truncated counterparts to 
cm_CYKAlign(), cm_CYKAlignHB(), cm_OptAccAlign(), cm_OptAccAlignHB().

Added itest_brute.c a brute force test of the Inside and CYK
algorithms as implemented in cm_InsideAlign() and cm_CYKAlign().
So far, a single four node (ROOT, MATL, MATL, END) model is
implemented. I'd like to add more models, with the goal of having
every possible transition represented. Also, I'd like to write a
truncated version of the brute test soon.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3697 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-20T16:15:39Z,nawrockie
9fcebfacc64d3929dc698babe08398660228d0c4,Eric Nawrocki,eric.nawrocki@gmail.com,"TrCYKOutside() now seems to be working for bifurcated models, or at
least it seems consistent with the CYK Inside implementation.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3695 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-19T17:33:20Z,nawrockie
77ebffbf7538da782009721bad720bc01431f8f6,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on ensuring that TrInsideCYK/TrOutsideCYK are correctly
implemented in the non-banded case. Fortunately, a simple but strict
test exists: ensure that for each target residue there is at least one
v,j,d cell in the matrix that is: (i) responsible for emitting that
residue and (ii) for which alpha[v][j][d] + beta[v][j][d] = CYK
score, in any of the J, L, R, or T matrices.

Correctly implementing TrOutside has been difficult, but I think the
CYK version of it may now be working, at least for models with no
bifurcations. Testing on models with no bifurcations is the next step.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3694 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-16T23:58:46Z,nawrockie
7970656f6c3764350ee41b5c322531ff26bd75c9,Eric Nawrocki,eric.nawrocki@gmail.com,"Added CM_MX and CM_SHADOW_MX data structures for non-banded CM
alignment. These complete the following set of eight different
matrices:

 CM_MX:                non-banded standard  CYK/Inside/Outside DP matrix
 CM_TR_MX:             non-banded truncated CYK/Inside/Outside DP matrix
 CM_HB_MX:             HMM banded standard  CYK/Inside/Outside DP matrix
 CM_TR_HB_MX:          HMM banded truncated CYK/Inside/Outside DP matrix
 
 CM_SHADOW_MX:         non-banded standard  CYK/optacc shadow matrix
 CM_SHADOW_TR_MX:      non-banded truncated CYK/optacc shadow matrix 
 CM_SHADOW_HB_MX:      HMM banded standard  CYK/optacc shadow matrix 
 CM_SHADOW_TR_HB_MX:   HMM banded truncated CYK/optacc shadow matrix 

Updated cm_dpalign.c functions to use the new CM_MX and CM_SHADOW_MX
data structures. 

Changed names (!) of DP alignment functions in cm_dpalign.c for
consistency across the different four alignment types (standard or
truncated and non-banded or HMM banded). The silly 'Fast' and 'fast_'
prefixes are gone, replaced with a 'cm_' prefix and 'optimal_accuracy'
has been shortened to 'optacc'. For functions whose names have
changed, a comment has been added citing their previous name.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3691 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-14T13:45:57Z,nawrockie
391467dcc4ba81de6c2d153c1ef39aec651e9b06,Eric Nawrocki,eric.nawrocki@gmail.com,"Beginning to add support for non-banded truncated alignment in
cm_dpalign_trunc.c(). So far only tr_cyk_align() and TrInsideAlign()
exist. These will mainly be useful for testing/debugging and
understanding the HMM banded versions (tr_cyk_align_hb() and
TrInsideAlignHB()) which are very similar, but are more complex due to
the enforcement of the HMM bands and the use of the banded DP
matrices.

Added non-banded DP matrices CM_TR_MX and CM_TR_SHADOW_MX data
structures and associated functions in cm_mx.c. 

Starting to work on non-banded truncated Outside in
TrOutsideAlign(). It will be easier to write the non-banded version
first, and the HMM banded version later.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3687 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-12T13:37:44Z,nawrockie
78a907bec8a252cf1e01c69a86759cf89d766948,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cm_dpalign_trunc:TrInsideAlignHB(). Fixed compiler warnings in
other files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3685 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-09T17:40:22Z,nawrockie
fc56c2436457f2c02d757c006c9fe99fb72cfe10,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cm_dpalign_trunc.c for truncated CYK/Inside/Outside
routines. These functions will mirror those in cm_dpalign.c, differing
only in that they're truncated versions. HMM banded TrCYK alignment is
in fast_tr_cyk_align_hb(), and traceback is in fast_tr_alignT_hb()
which are used by FastTrAlignHB(). To do: Inside, Outside, Posteriors,
Optimal accuracy. 

Most files modified in this commit are changed only slightly, to
account for:
1. Changed data type of Parsetree_t's 'mode' from int to char as it can
   only be one of a handful of values.
2. Changed Diana's convention of using actual ints of 3,2,1,0 for
   Joint, Left, Right, Terminal mode, respectively, to using #define'd
   values for each: TRMODE_J == 3, TRMODE_L == 2, TRMODE_R == 1,
   TRMODE_T == 0.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3684 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-09T12:56:47Z,nawrockie
7dd49f1de0065e8acc25efd23eb2ffae836d2c28,Eric Nawrocki,eric.nawrocki@gmail.com,"Added FTrInsideScanHB(). The function is nearly identical to
TrCYKScanHB(), the only necessary modification was changing
24 ESL_MAX calls to FLogsum calls for the DP matrix updates.
Brief testing indicate the Inside version is usually 1.5 to 2X slower
than CYK. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3683 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-07T15:47:13Z,nawrockie
8eaa2012ece5b05f83ff2fa67a371e0d5dad5293,Eric Nawrocki,eric.nawrocki@gmail.com,"Renamed FastTrCYKScanHBSkipSlow() as TrCYKScanHB(). All quick and
dirty attempts to optimize it failed, having no appreciable effect or
making it slower. It's fast enough for now though because it is nearly
always 2-5X faster than CP9 HMM band calculation. This means HMM
banded truncated CYK scan is at worst 2X slower than HMM banded CYK
scan, and is often only about 10-25% slower. 

Removed several old functions I was experimenting with for trCYK band
calculation and alignment. Reference for the current implementation is
in ~nawrockie/notebook/11_0816_inf_banded_trcyk and in my lab notebook
(ELN2) on page p.146-147.

About to implement TrFInsideScanHB() based on TrCYKScanHB().


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3682 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-07T15:20:23Z,nawrockie
7feddecda827bb16ac7911636c7220265a82c16d,Eric Nawrocki,eric.nawrocki@gmail.com,"Simplified HMM banded trCYK band calculation and alignment. Current
(new) strategy is to predict four consensus positions, stored in the
CP9Bands_t data structure based on the HMM posteriors:
sp1: first 'possible' consensus position used in parse (min k for
     which occ[k] > thresh1 (typically 0.01))
sp2: first 'probable' consensus position used in parse (min k for
     which occ[k] > thresh2 (typically 0.99))
ep1: final 'possible' consensus position used in parse (max k for
     which occ[k] > thresh1 (typically 0.01))
ep2: final 'probable' consensus position used in parse (max k for
     which occ[k] > thresh2 (typically 0.99))

Where occ[k] is the probability that HMM node k is occupied, i.e. the
summed probability that node k's match or delete state is used for any
residue in the sequence.

Then, for each CM state v, that roots a subtree spanning lpos to rpos
in consensus positions, determine if Joint, Left, Right, Terminal
marginal alignments are possible for v based on where lpos and rpos
fall relative to sp1, sp2, ep1, ep2. For example, Joint alignment is
only allowed if lpos >= sp1 and rpos <= ep1. Left alignment is only
allowed if sp1 <= lpos <= ep1 and rpos > ep2. Other rules dictate
Right and Terminal alignment possibilities. 

HMM bands are calculated as in the non-truncated case and expanded for
states that allow L, R, and T alignment. For L/T alignment, j bands are
expanded to allow alignment of any residue that may align to positions
ep2 or ep1. For R/T alignment, i bands are expanded to allow alignment
of any residue that may align to positions sp2 or sp1.

There is a potentially problematic case if no occ[k] exceeds thresh2
and/or thresh1, which causes J,L,R,T alignment to be possible for all
states, and HMM bands to be expanded to allow all possible residues to
align to any state. This happens commonly when aligning random
sequences for example, and alignment is still possible, but the
truncated HMM banded matrix may be too big. In this case, the
currently implemented strategy is to raise thresh1 and lower thresh2
concurrently with raising the HMM band probability threshold tau until
the resulting matrix is small enough.

Currently, code for the previous, more complicated way of calculated
bands for marginal alignments is included. It will be removed soon.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3681 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-07T10:38:34Z,nawrockie
856ac280c9192dc411b0684559c1a8a4ca2a3a53,Eric Nawrocki,eric.nawrocki@gmail.com,"hmmband.c::cp9_HMM2ijBands(): cleaned up code for determining CM i and j
bands from HMM bands and added code to expand bands to allow for
marginal alignments. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3680 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-06T14:24:40Z,nawrockie
400d1888f03dd8f02ad000c7fc0ed008010bb964,Eric Nawrocki,eric.nawrocki@gmail.com,"Reworked how HMM banded trCYK works. Previously J, L, and R matrices
were of equal size and valid for all states. Now, only states for
which a joint, left marginal, or right marginal parse is considered
'likely' are valid and (have allocated dp cells) for J, L, and R
matrices respectively. This should save a lot of memory in this
matrix, as well as time in the DP recursion, although it complicates
the code because for each state v and possible child state y being
transitioned to, we have to check if the state is valid for each of
the J, L, R matrices. The CM_TR_HB_MX has been changed significantly
to allow for these changes. FastTrCYKScanHB() is gone and only
FastTrCYKScanHBSkipSlow() remains because invalid cells must now be
skipped because they don't exist in the matrix. 

Currently, the code is working for most but not all tested
examples. There's still at least one bug, but I wanted to commit prior
to this weekend's shutdown of the Janelia computer network.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3679 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-02T20:24:10Z,nawrockie
d31c9bd2729b35d3a66579c35613617332a1cea9,Eric Nawrocki,eric.nawrocki@gmail.com,"Implemented a method for restricting the expansion of HMM bands to
allow for marginal hits. Previously all MP, ML, MR state bands were
expanded to allow for all possible marginal hits. Now only certain
state bands are expanded. A state v that roots the subtree spanning
lpos..rpos consensus positions is expanded based on occupancy of HMM
nodes that model lpos/rpos (probability the match or delete state of
the HMM node is visited) from a Forward/Backward/Posterior parse of
the target sequence. 

For example if occ[lpos] = 0.9999 and occ[rpos] = 0.9999, this means
the HMM is almost certain lpos and rpos are part of the optimal
alignment, so we don't have to worry about looking for marginal
alignments that span lpos..rpos. Conversely, if occ[lpos] and
occ[rpos] are very close to 0. then we don't have to worry about a
joint (non-marginal) alignment that spans lpos..rpos. Other exclusions
specific to L, R and T matrices are also possible. During HMM banded
trCYK, the J, L, R, T matrices can be skipped for states where the
corresponding joint or marginal alignment is unlikely based on the HMM
occupancy values. Currently, FastTrCYKScanHB() does not skip any of
these states. FastTrCYKScanHBSkipSlow() does skip them, but only by
checking if they should be skipped in the deepest part of the
recursion (very inefficient). It's only roughly 20% faster than
FastTrCYKScanHB() at best. I'll try to speed it up soon.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3677 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-02T15:18:04Z,nawrockie
158c8d72bf6dfcc842e8e6c99861dd99ea6deff4,Eric Nawrocki,eric.nawrocki@gmail.com,"Added CMH_QDB_LOCAL and CMH_QDB_GLOBAL CM flags, which are raised when
QDBs are valid and have been calculated either with local begins on or
off. cmbuild always calculates QDBs in local mode with default local
begin probabilities because that is the default search model
configuration, so when QDBs are read from the CM file the
CMH_QDB_LOCAL flag is raised. This allows programs to read QDBs and
not need to recalculate them when working with the CM in local
mode. If the model is reconfigured to global mode (or if the local
begin probabilities are set in a non-default way), then QDBs are then
recalculated. Arguably, for simplicity, we should always calculate
QDBs in local mode, but that would require putting a global CM into
local mode just to calculate QDBs. I may switch to this method in the
near future.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3676 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-02T09:23:42Z,nawrockie
7f0ef3dfe14415c08d03564492666996039b0d50,Eric Nawrocki,eric.nawrocki@gmail.com,"Most files were modified to use the function prototype for
DispatchAlignments(), cp9_HMM2ijBands(), ij2d_bands() and
cp9_ShiftCMBands() all of which now take a <do_trunc> argument, which
is TRUE if the HMM bands will be used to contrain a
trCYK/trInside/trOutside matrix, and FALSE otherwise.  Truncated
alignment requires special considerations when constructing the bands,
usually leading to wider bands for some states, which are unnecessary
if the bands will be used to constrain a standard non-truncated
CYK/Inside/Outside algorithm.

cm_dpsearch_trunc.c:

Updated FastTrCYKScanHB() so it finds optimal parse for all tested
examples on homologous or emitted sequences and the vast majority of
random sequences. More rigorous testing to come. Unfortunately (and
this was not immediately obvious) HMM bands need to be determined
differently to allow for marginal L and R hits. For example, if the
left consensus position modeled by a base pair is determined to be
unlikely to emit any residue in the target, we still need to allow
that base pair state to be reachable for right marginal hits. The
analogous case is true for the right position and left marginal hits,
and for right marginal hits in MATL-modeled positions and left
marginal hits in MATR-modeled positions. Currently, only bands for
MATP_MP, MATR_MR, and MATL_ML states are extended to allow for
marginal hits (i.e. bands for MATP_MR, MATP_ML, inserts, deletes are
not extended). This should be okay; although I believe its possible to
miss the optimal parse in rare cases, the difference in bit score and
parsetree should be essentially insignificant.

Due to the expansion of bands to allow for marginal hits, the number
of cells excluded from HMM bands calculated for a standard CYK parse
versus bands calculated for a trCYK parse is roughly 3X higher. This
means HMM banded trCYK could require about 9X more time and memory
than standard CYK (because 3 full DP matrices are used instead of
1). But in reality, HMM banded trCYK seems roughly only 3-5X slower
than standard, although 9X more memory is required. For large models
(RNase P, SSU), the time required for the banded CYK tends to be equal
or less than the time required to calculate the bands, meaning there's
an overall slow down of only ~2X for band calculation plus CYK.

The tightness of the bands and speed of CYK could be improved by
determining and enforcing different HMM bands for each of the J,L,R,T
matrices, because the wider bands for any state relative to standard
CYK are only necessary for the L or the R matrix (never J and never
both L and R), but that would require even more convoluted HMM banded
CYK/Inside/Outside/Posterior functions with about 3X as much overhead
in time and code for edge-case checking, and I'm not sure they're
worth the trouble to write/debug.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3674 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-09-01T13:34:53Z,nawrockie
cd6ed5e2acc56ae77fed1f996b9bedf358abd2d5,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed mpisupport.c functions related to packing search_results_t
HMMFilterInfo_t and BestFilterInfo_t structures, which are no longer
used.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3672 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-29T19:02:21Z,nawrockie
6ff164f55017f937634503c0733f3bbbb502cba9,Eric Nawrocki,eric.nawrocki@gmail.com,"pre-Irene commit, so I can get latest revision local on my laptop.

Added CM_TR_HB_MX data structure, a HMM banded DP matrix for use with
coming HMM banded trCYK and trInside functions to cm_mx.c by extending
CM_HB_MX.

Added cm_dpsearch_trunc.c::FastTrCYKScanHB() based on
FastTrCYKScan() and FastCYKScanHB(). This function is unfinished.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3671 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-27T16:23:50Z,nawrockie
6384fc2b2579c2b58fb63470afc4fc2ba24cbc31,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cm_dpsearch_trunc.c::RefITrInsideScan() based on RefTrCYKScan()
and RefIInsideScan(). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3668 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-25T18:00:57Z,nawrockie
fab69cd3e42348e36ad6d007089c47100fc355a9,Eric Nawrocki,eric.nawrocki@gmail.com,"Logged bug i27 in BUGTRAX. The code fix went in with the previous
revision (r3666).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3667 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-25T14:42:14Z,nawrockie
1a76ea48d2e27f6a1e84e8dc735017b7f08742a9,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i27 in BUGTRAX. Marginal emission scores used by
all truncated CYK implementations were being incorrectly calculated
due the use of the esl_vec_FLogsum() function on log odds scores in
base 2 (that function assumes log base e). This has been fixed by
rewriting how marginal scores are calculated and moving their
calculation to CMLogoddisfy(). Now whenever the CM bit scores are
valid, the marginal bit scores are as well (as opposed to requiring a
special call to SetMarginals()). 

The alphabet.c::LeftMarginalScore() and
alphabet.c::RightMarginalScore() functions contained the incorrect
usage of the esl_vec_FLogsum() function. These were renamed 
by adding '_reproduce_bug_i27' to their names and moved to
truncyk.c. I did this to enable reproduction of the benchmark from
Kolbe, Eddy 2009, but I'm not sure this is important since the version
that corresponds to that publication already enables reproduction.
I may remove this in a future commit.

The benchmark-trunc-search test program optionally compiled with
cm_dpsearch_trunc.c includes the option --i27 to use the old method
for calculating the marginal scores. 

Most of the files that were modified were to remove calls to
LeftMarginalScore() and RightMarginalScore(). They can simply use the
pre-calculated scores in cm->lmesc and cm->rmesc vectors now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3666 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-25T14:41:28Z,nawrockie
a3563b3d324fd88130cc8a1b62bd7599e0c4625e,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed cm_dpsearch_trunc.c::FastTrCYKScan() because its way more
complicated and negligibly faster than RefTrCYKScan(). Added note in
header cm_dpsearch_trunc.c explaining FastTrCYKScan() existed in
previous revision (r3663) and citing notebook reference, below:
ref: nawrockie/notebook/11_0816_inf_banded_trcyk/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3664 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-24T18:53:36Z,nawrockie
fa56ed1743ee5809c85833b582a8cdd86e0a8dbd,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding cm_dpsearch_trunc.c::FastTrCYKScan() based on FastCYKScan().
Unfortunately, trCYK is different enough from CYK that the speed
improvements seen between FastCYKScan() and RefCYKScan() (about 30%)
are much lower in the Tr (truncated) version (less than 5%). 

I plan to remove FastTrCYKScan() in the next commit, but I wanted to
commit it once so its code was in the subversion repository in case
anyone wants to revisit it to optimize it. I decided to scrap it
because it's marginal speed improvement doesn't outweigh its
disadvantages: it is long (three times as many lines as
RefTrCYKScan()) and difficult to debug/maintain. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3663 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-24T18:44:44Z,nawrockie
f9da080ea3870c7a91ed675163f49a00048b0d55,Sean Eddy,sean@eddylab.org,"p7_gmx_Dump() is about to change its prototype; will now have a 
<flags> argument. Updated Infernal, even before the update goes into
HMMER...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3662 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-23T12:51:22Z,cryptogenomicon
4826dde6a27100c668295c655785af9d13f5f60f,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed some obsolete data structures and associated functions:

1. Replaced the search_results_t data structure with the CM_TOPHITS
object which duplicates search_results_t functionality but is cleaner
and consistent with HMMER's search pipeline. Previously both were
used: search_results_t was used by the v1.0-introduced DP scanners in
cm_dpsearch.c and CM_TOPHITS was used by the new pipeline code in
cm_pipeline.c. CM_TOPHITS is now used by all
functions. search_results_t has been removed from structs.h.

2. Removed the SearchInfo_t object which was used by the old
search pipeline and is now obselete in the new pipeline. searchinfo.c
is no longer compiled. 

3. Removed the HMMFilterInfo_t object which stored per-CM bit score
HMM filter thresholds for models. These are not used by the new search
pipeline.

4. Simplified GammaHitMx* functions in cm_mx.c because hits are now
only reported from CM scanning functions, not CP9 HMM scanning
functions. 

5. Updated benchmarking code in Diana's impl_sse/sse_*.c files to be
consistent with recent code changes.

6. Removed rsearch_CYKScan() function, which is a copy of the RSEARCH
   version of CYK. It was used for comparison in speed testing of new
   CYK implementations, but I decided to drop it (thus removing the
   need for continually updating it) since it's not hooked up to any
   applications (neither cmsearch nor cmscan).

Note: cmcalibrate and cmsim have not yet been updated to work with the
changes introduced here, so they are temporarily not built by the
Makefile. I'll revisit these later. cmcalibrate needs to be reworked
extensively anyway because CP9 HMM Forward/Viterbi exponential tail
fits are no longer necessary with the new pipeline.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3659 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-22T18:44:23Z,nawrockie
88e89b64a6603b3866e41c5015cec6a77cb72013,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_dpsearch_truncyk.c: Found and fixed a bug involving using QDBs on B
states. ref: ~nawrockie/notebook/11_0816_inf_banded_trcyk/00LOG.

cmemit.c: Cleaned up another case of using msa->abc that should've
been fixed in previous commit.

trcyk.c: fixed a typo; an extra ';' that I had added when I updated
this file for use with the new CM file format. This was causing the
program to report an error with reading the CM file even if there was
no problem.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3657 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-18T13:42:11Z,nawrockie
f2036bbd664fdce219dab3731d860ea62b9d82b4,Eric Nawrocki,eric.nawrocki@gmail.com,"cmemit.c: changed number of command-line arguments from 2 to 1 to
mirror hmmemit and to allow piping of output as input into other
applications. Previously, the second command line argument was the
name of the output file, now default is to output to stdout.
Fixed bug with truncating output alignments related to using msa->abc
in a digitized MSA, in which abc should be null. cm->abc is now used
instead.

cm_dpsearch_trunc.c:
Fixed bug in cm_dpsearch_trunc.c::RefTrCYKScan(), for MR/IR states, I
was initializing of Lalpha[jp_y][v][d] to IMPOSSIBLE, when it should
have been Lalpha[jp_v][v][d].

cm_mx.c, funcs.h: added cm_DumpTrScanMatrixAlpha()




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3656 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-18T12:29:21Z,nawrockie
ca7f42528dcb293a0b688586918110f8869cbfeb,Eric Nawrocki,eric.nawrocki@gmail.com,"Reduced size of TrScanMatrix_t by only allocating 2D T matrices for B
states. Added cm_FreeTrScanMatrix_t() function.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3655 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-17T19:14:49Z,nawrockie
d224db4c254e60346f45c6eaf92aaf75d7cbb2f2,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cm_dpsearch_trunc.c for new implementations of Diana's trCYK. So
far, only an unfinished RefTrCYKScan() has been written, but the plan
is to write RefTrFInsideScan() and FastTr{CYK,Inside}Scan() analogs of
both, based on the templates in cm_dpsearch.c::RefFInsideScan() and
cm_dpsearch.c::Fast*Scan(). A new matrix structure TrScanMatrix_t,
based on ScanMatrix_t was added to structs.h and is used by
RefTrCYKScan(). 

RefTrCYKScan() seems to be correctly calculating the optimal trCYK
score with QDBs turned off, in that it agrees with the score reported
by the existing TrCYK_Inside() function in truncyk.c (after minor bug
fix explained below). Matching scores were verified anecdotally for
several models with the benchmark-trunc-search benchmark driver in
cm_dpsearch_trunc.c. Based on those tests, RefTrCYKScan() seems to be
roughly 3X faster than TrCYK_Inside().

alphabet.c: 
Updated allocation size of a count vector used by LeftMarginalScore()
and RightMarginalScore() to be consistent with what esl_abc_FCount()
expects. This is likely due to a change in Easel since these functions
were written.

truncyk.c:  
Found a bug related to updates of Ralpha matrix for IL states and an
analogous case in updating the Lalpha matrix for IR states. For these
self-transitioning states, it is important to fully calculate the J
matrix cell prior to calculating the L or R matrix cell because it
depends on the value of the J matrix cell. Previously, the L/R cell
was being calculated before the relevant J cell was fully calculated.
See the comments in the code, tagged with today's date, for more
information. 

There are still commented out debugging print statements in the
truncyk.c, that I may still yet use. Also, this bug may exist in the
various divide and conquer functions used by TrCYK_DnC(), but I
haven't investigated those yet, so the bug has not been entered into
BUGTRAX yet.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3654 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-17T18:08:43Z,nawrockie
6591d1b023aac60aaf6d4da4a3da35049d745003,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug involved with calculation of posterior probabilities for
residues emitted from EL states (local mode). The bug was essentially
a typo that very rarely resulted in a posterior probability exceeding
1.01 (which causes infernal to fail with an error message).
The bug was logged as i26 in BUGTRAX. See more detail there.

ref: ~nawrockie/notebook/11_0811_inf_big_hb_mx_issues/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3652 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-15T15:23:06Z,nawrockie
080cabf3bf4d2191087b645ba73f6a1b3b7212fe,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated MPI cmscan so it scans both strands of query sequences and
re-searches first/final W residues with local envelope
pipeline. Previous to this commit, only serial/threaded cmscan did
this. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3651 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-12T19:10:35Z,nawrockie
1f026e51dbec5a51ea9df767120e88c29417cb9b,Eric Nawrocki,eric.nawrocki@gmail.com,"1. Modified how search/scan pipeline handles sequences that require
   large HMM banded matrices at either the CYK scan filter, Inside
   scan, or optimal accuracy alignment stage.

   Previously, if the required matrix exceeded a maximum size (by
   default 128 Mb) then non-HMM banded alternatives were used. This
   was unacceptably slow. I had thought it would be extremely
   uncommon, but with the introduction of full SSU models in Rfam 10.1
   it is now the norm for searches/scans of archaeal or bacterial SSU
   models against eukaryotic sequences (and will likely also be common
   for the analogous situation for LSU). 

   Testing revealed that even if memory was not an issue, the HMM
   banded parses for these cases with large matrices would be too
   slow, taking several minutes in many cases.

   The new approach is to tighten the HMM bands until the resulting
   matrix is below our limit, by repeatedly multiplying the tau
   parameter (amount of probability mass permitted outside bands) by
   2, with a maximum allowed tau of 0.01. If the matrix is still too
   large with the max tau, a non-HMM banded alternative is used, but
   this should really be rare (though I haven't done extensive testing
   yet).. 

2. Fixed a problem with removing overlaps in cmscan. With the recent
   introduction of re-searching the first/final W residues of each
   sequence with a local-envelope pipeline, overlaps are now possible
   in cmscan (whereas previously they weren't). However, the
   de-overlap code didn't take the model used for each hit into
   account, so no two models could report a hit to the same part of a
   sequence. This has been fixed. I renamed functions related to this
   sorting from 'SortBySeqIdx' to 'SortByPosition'.

ref: ~nawrockie/notebook/11_0811_inf_big_hb_mx_issues/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3650 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-12T17:31:27Z,nawrockie
2100eb64c700eec22aad196f2d5fdbff60e4516a,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified how cmsearch and cmscan use the search pipeline. Now, by
default after the normal pipeline is run on each sequence and its
reverse complement, the first and final pli->maxW (predicted max size
of a hit) residues are re-searched again with the pipeline is a
special 'local envelope' mode. The default mode of the pipeline is to
define envelopes with an HMM filter in glocal mode, but this prevents
the pipeline from allowing many truncated hits that run up against the
5'/3' boundaries of the sequence from surviving to the CM stage. By
re-searching in local envelope mode these truncated hits are much more
likely to survive and be evaluated with the CM.

Ideally, truncated CYK/Inside would be used by the pipeline when it is
in local envelope mode, but neither QDB nor HMM banded versions of
these have yet to be written. The current implementation of trCYK is
far too slow to use in the pipeline. I plan on investigating how
difficult HMM banded implementations of trInside, trOutside,
trOptimalAccuracy, trPosteriors would be to write, and possibly trying
to write them before the next release. 
 --This line, and those below, will be ignored--

M    src/cmsearch.c
M    src/cm_tophits.c
M    src/cm_pipeline.c
M    src/structs.h
M    src/cmscan.c
M    src/funcs.h


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3648 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-11T14:29:08Z,nawrockie
8b4461b5fe9e65340524df0d57e0355ca3fdb95b,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified how hits are aligned in the new pipeline. Previously, any hit
i..j in a envelope 1..i..j..L that survived the final search stage of
HMM banded scanning Inside was aligned with HMM banded optimal
accuracy. The HMM bands from the final stage Inside scanner of 1..L
were not used, but rather bands were recalculated for alignment of
precisely i..j. In very rare cases, all of which I've seen occur with
truncated sequences, the resulting Inside parse of i..j had a bit
score much lower than the final stage bit score using HMM banded
scanning Inside (by default). This occurs if the i..j alignment bands
exclude the hit found by the scanner, which had different bands. In
this case, the reported alignment would often look like crap even
though the hit bit score (derived by the scanning Inside) was
significant.

The current solution is to use the Inside scanning bands for the hit
alignment, thus guaranteeing that a hit with the same Inside score is
found during alignment, and its optimally accurate parse is reported.
Unfortunately, the scanning bands are often looser and this can cause
a overall slowdown of 10-30% for cmsearch on rmark3, depending on the
strictness of the filters. Also, the matrices used for alignment
(which requires two HMM banded DP matrices plus a shadow matrix) are
much larger in some cases now (2-3X bigger in extreme cases).

I'm not completely satisfied with the current solution, and may come
back and reevaluate this in the future. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3646 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-09T12:45:28Z,nawrockie
4639c84d147adbdcfb2a432652033298dc18a6be,Eric Nawrocki,eric.nawrocki@gmail.com,"Improved efficiency of the cm_dpalign.c::optimal_accuracy_align_hb()
function when run on a CM in local mode. Previously, cells were being
initialized within the (for v... { for j... { } } part of the DP
calculation for the EL state after an unnecessary calculation of the
summed posterior probabilities of emitting the relevant residues from
an EL state. That calculation is already done for all possible sets of
contiguous residues once at the beginning of the function, and the
values are stored in the EL deck of the DP matrix. Thus, redoing the
calculation within the (for v... { for j... { } }) inner loop was
very wasteful. Now, the appropriate values are just copied from the EL
deck.

This change accelerates optimal_accuracy_align_hb() in local mode by
20-50% in my testing, depending on model size and the tightness of the
HMM bands. It accelerates overall optimal accuracy alignment (of which
optimal_accuracy_align_hb() takes 10-20% of the total time) by 5% on
average with 'cmemit -l' emitted sequences. 

xref: ~nawrockie/notebook/11_0805_inf_bug_long_el_aln/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3642 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-08T13:30:11Z,nawrockie
366668bf9453d56802c090f9c042868233831e61,Eric Nawrocki,eric.nawrocki@gmail.com,"This commit supplements r3633 from yesterday. I had forgotten to
include rmark-create.c and exercises.sqc in the r3633
commit. 

rmark-create.c: now compatible with the new esl_msa* files,
exercises.sqc:  -Z added to cmsearch tests, which require -Z or an
		esl-sfetch indexed target sequence file.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3638 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-05T14:20:22Z,nawrockie
cd35028ccbd46930f5a86479c1aaa812da53d02b,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated esl_msa* and esl_msafile* calls to be consistent with the new
API Sean introduced in revision 715 of Easel. 

Update was straightforward, except I had to modify
cm_parsetree.c::Parsetrees2Alignment() to not use msa->abc (for
identifying gaps) when msa is in text mode (this is a similar problem
to the one Sean detected and fixed in the esl-ssdraw miniapp with
revision 715). It's clear to me now that using msa->abc in a text mode
is a no-no, because whether it is NULL or not is used as a flag by
esl_msa* functions to determine if the msa is digitized or not. (Didn't
that used to be an explicit flag: msa->flags & eslMSA_DIGITAL?)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3633 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-04T15:13:38Z,nawrockie
62efa69cb09400930ff64ee8f54d780c589fcc61,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_alidisplay.c: Fixed problem with local end displays in
		 cmsearch/cmscan alignment output. The model and
		 sequence positions were being incorrectly updated
		 when a local end existed. Local ends can only now
		 appear completely within a block. Previously they
		 could be split across blocks, which was confusing to
		 look at and would have been needlessly difficult to
		 parse by a script. This has the slightly undesirable
		 side effect that the rare alignment blocks that would
		 have ended in a truncated local end display are now
		 shorter than all other blocks, by 2 or 3 characters
		 on average and possibly up to 6 or 7.

cm_pipeline.c: Fixed trivial bug that was causing --aln-nonbanded to
	       fail.

cmscan.c: call to cm_pipeline() in mpi_worker was using old function
	  prototype (MPI executable would not compile as a result).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3631 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-03T19:36:24Z,nawrockie
adff05a74bbcb234c3c9ba0a1c9ae4d029101440,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i25 in BUGTRAX. This bug was closely related to
bug i22, involving improper calculation of the null3 penalty for some
HMM banded hits. The fix to i22 fixed only the case where hits were
reported using the non-greedy, 'optimal' hit resolution strategy, but
somehow with the i22 fix I failed to make the corresponding fix for
the greedy hit resolution case. The fix to bug i25 fixes the greedy
case, in an analogous manner to the i22 fix. See BUGTRAX for more
info.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3629 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-03T09:59:20Z,nawrockie
262db6bf7820a178f4cb4b02d128a70a2e0cf0ae,Eric Nawrocki,eric.nawrocki@gmail.com,"funcs.h, cm_pipeline.c, cmscan.c, cmsearch.c:
cm_pipeline.c::cm_pli_CMStage() CM stage of the filter pipeline
requires <cm_config_opts>, so it knows how to configure the CM it will
read from the file. The configure options are determined by the
command-line options to cmscan/cmsearch. This is only relevant in SCAN
mode where the CM isn't read until the CM stage of the filter pipeline
is reached.

cm_tophits.c: 
Removed unused variable declaration to silence compiler warning.

x-cmsearch: 
Overdue update: x-cmsearch is now consistent with change of name of
in-developement dcmsearch executable to cmsearch that occured with svn
revision 3580, and a change to the --tblout file format. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3628 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-03T09:55:21Z,nawrockie
e3caf16829f3bbd85f971e1db332ad552793a1c0,Eric Nawrocki,eric.nawrocki@gmail.com,"cmstat.c: added options for alternative output modes:
	  -Z <x1> : set database size as <x1> Mb.
	  -E <x2> : print bit score threshold corresponding to E-value
	  	    of <x2> in a cmsearch database of size <x1>.
          -T <x3> : print E-value corresponding to bit score of <x3>		   
                    in a cmsearch db of size <x1>.
          --cut_ga: print E-value corresponding to Rfam GA cutoff 
                    in a cmsearch db of size <x1>.
          --cut_tc: print E-value corresponding to Rfam TC cutoff 
                    in a cmsearch db of size <x1>.
          --cut_nc: print E-value corresponding to Rfam NC cutoff 
                    in a cmsearch db of size <x1>.

cm_pipeline.c: typo fix in comment.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3625 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-01T19:30:33Z,nawrockie
a5b4fdcc1550dc4b2f7c03d9d7050d7ce610d758,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated configure.ac to be consistent with HMMER's configure.ac, so
configure creates the libdivsufsort directory and corresponding
Makefile. This library is not currently used in an Infernal build but
may be in the future.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3624 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-08-01T15:17:29Z,nawrockie
97fa7aca9e7bc01916d0a4a9ab3af8af67aff906,Sean Eddy,sean@eddylab.org,"updated Infernal configure.ac to include new HMMER configuration for
HMMER_SADIR, the liddivsufsort library.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3620 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-28T11:37:05Z,cryptogenomicon
b550b696371464272820cefe8e0e97ae8ba4b90b,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated cmscan to work in MPI mode.

Updated MPI functions in mpisupport.c to work with new CM data
structure and file format that requires exactly 1 p7 filter HMM.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3617 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-22T18:24:19Z,nawrockie
c0ea75bb97af6ac0304ead635a1f04fb348a060f,Eric Nawrocki,eric.nawrocki@gmail.com,"Simplified CM_FILE data structure by removing the P7_HMMFILE <gfp>
pointer. All P7_HMMFILE manipulation is now handled by the other
P7_HMMFILE in CM_FILE, <hfp>.

Previously, two P7_HMMFILEs were necessary to handle the two cases of
a CM file being pressed and not being pressed. If pressed, a separate
binary file of HMM filters existed (with suffix .i1h) because not all
p7 filters were necessarily written to the CM file and therefore had
to be written to a separate file since we needed the ability to read
them independently of the CM. However, with the recent change
requiring that all CMs have a single p7 filter that must be written to
the CM file, the .i1h file and <gfp> for handling it are no longer
necessary (cmpress no longer creates a .i1h file).

Most of the files listed as modified are minimally changed to be
consistent with a new cm_file_Read() function prototype. That function
now includes a <read_fp7> flag, specifying whether the p7 filter
should be read for the CM. In most cases it is TRUE, but in a scan
pipeline originating from cmscan, it is FALSE. In this case we've
previously read the p7 filter for the CM and a hit in the query
sequence has survived that filter, so we don't have to read the p7
filter again.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3616 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-22T14:26:11Z,nawrockie
849fad8035b83d2ed0269ec32b51415a56647986,Eric Nawrocki,eric.nawrocki@gmail.com,"cmscan now scans the target CM database twice for each query sequence,
once for the forward strand and once for the reverse. (Previously, on
the forward strand was searched.) 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3614 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-21T20:21:14Z,nawrockie
21edbcdce7fcd796aede921dd6e22666c925d56b,Eric Nawrocki,eric.nawrocki@gmail.com,"Adapted multi-threaded cmscan to work with recently modified
cmpress'ed files and new requirement of exactly 1 p7 filter per CM. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3613 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-21T18:05:00Z,nawrockie
7e916769dff10b8b00223c62298245d86dabee3d,Eric Nawrocki,eric.nawrocki@gmail.com,"Top-level Makefile now allows 'make tests' and 'make dev'. (I
accidentally forgot to commit this file in the previous commit.)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3612 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-21T17:47:51Z,nawrockie
301f309449b320ef01c2791c2573f8d134f01b14,Eric Nawrocki,eric.nawrocki@gmail.com,"Top-level and src/-level 'make dev' now builds benchmarks and unit
tests, and 'make check' builds unit tests for Infernal. Only one unit
test and benchmark currently exist, for cm_tophits. 

That benchmark helped uncovered a bug in how overlapping (duplicate)
hits were detected and removed, which is now fixed (hits on reverse
complement were being improperly sorted for the implemented duplicate
removal). The tophits benchmark also revealed that with the present
strategy it is not faster to sort tophits lists prior to merging them
in most cases, so a simpler method of merging those lists that simply
appends copies of all hits from one unsorted list to the other
unsorted list has been implemented.

Also, a <in_rc> parameter has been added to the CM_HIT structure, with
value TRUE if the hit is on the reverse strand, FALSE if
not. Previously, the code relied on <start> and <stop> to define
strand (forward strand if start < stop, else reverse strand), but that
doesn't work for hits that span a single residue. Such hits were
always defined as being on the reverse strand previously, and although
such hits are vanishingly rare if not impossible on normal search
conditions, the improper handling of them bothered me.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3611 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-21T17:47:06Z,nawrockie
631947ad152f247433ea2dda3451b0c7f697f876,Eric Nawrocki,eric.nawrocki@gmail.com,"Major change in search/scan pipeline:

Each CM must have a single p7 HMM filter, stored as cm->fp7. This HMM
is necessarily saved in the CM file, in HMMER format. The filter HMM
can be the ML p7 HMM (the maximum likelihood HMM built to be as
similar as possible to the CM) but this must be dictated at the
cmbuild step. By default, it is a p7 HMM built using Infernal emission
priors, HMMER transition priors and a target mean match state entropy
of 0.38 (this strategy that optimizes performance on rmark3).

This change includes a minor modification to the CM file format, which
no longer has 'NAP7' lines and doesn't include E-value statistics for
ML p7 HMMs. 

Previously, the CM file could contain 0 or 1 'additional p7 HMMs' as
well as E-value statistics for the ML p7 HMM. cmsearch and cmscan
could use the ML p7 HMM, the additional P7 HMM, or both to filter. By
default only the additional HMM was used because that strategy gave
the best rmark3 results. 

This change simplifies CM_PIPELINE functions, which now necessarily
use a single p7 HMM, instead of needing to be flexible to use either
one or two HMMs. cmsearch and cmscan code is now cleaner as
well. Also, cmbuild is now faster (about 2X) because only one HMM must
be calibrated.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3610 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-21T00:47:27Z,nawrockie
8874e7ad3424b3fd68cda65c415b4db8418d96a7,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch.c: changed default tau to 5E-6, from 1E-7 as suggested by
rmark3 performance.

cmbuild.c: window size (W) stored in CM file is now calculated by CM
in local mode (which is default search mode). Previously, it was glocal
mode. 

rmark3 results now agree with latest testing in
~/notebook/11_0513_inf_dcmsearch_thresholds_and_update/
prior to overhaul of CM file format.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3609 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-21T00:29:44Z,nawrockie
8c191af3b2b1b6583a74a4623efe92c791cdbf1b,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed error in derivation of null3 score correction, reported by
Pierre. The sigmoid function corresponded to log odds scores in units
of nats, not bits.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3608 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-19T12:41:32Z,nawrockie
734c89a7746f45c4c3546992a04bfb8da464c9ca,Eric Nawrocki,eric.nawrocki@gmail.com,"cmpress:
cmpress now creates five binary files:
  1. <cmfile>.i1m: complete CMs (and p7 filter HMMs, currently)
  2. <cmfile>.i1i: SSI index for <cmfile>.i1m file.
  3. <cmfile>.i1h: complete p7 filter HMMs.
  4. <cmfile>.i1f: MSV filter part of optimized p7 profiles.
  5. <cmfile>.i1p: remainder of optimized p7 profiles.

As of now, there can be more than one p7 filter for each CM, but I am
strongly considering enforcing a single p7 filter for each CM as this
would significantly simplify the code and multiple filters are only
used if certain command-line options are used. 

The .i1h file is identical to a HMMER3 binary file (.h3m) and Infernal
can use the HMMER input/output functions to deal with it. Similarly,
the .i1p file is identical to a .h3p file. The .i1f file is nearly
identical to the .h3f file, but includes a few pieces of
Infernal-specific data prepended to the HMMER3 format.

cmscan: 
Updated to only work on cmpress'ed CM database files. Still in
construction, currently only serial mode works and threaded code is
not even compiled. 

Given a cmpress-generated set of files, cmscan will read each 'model'
in several steps, but only as necessary, stopping and moving to the
next model when zero hits in the query sequence have survived past a
given filter stage. The model reading steps are, for a given CM:

1. MSV part of >=1 relevant optimized p7 filters from .i1f (mandatory)
2. Remainder of optimized p7 filters from .i1p (if a hit passes F1b)
3. Full p7 filters from .i1h (for generic profile, if hit passes F3b)
4. Full CM from .i1m (if a hit passes F5b)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3607 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-14T15:31:54Z,nawrockie
97a260f6591d9f0905dec248b0f075a347e7127b,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cmpress. It 'works', as in it compresses CM databases, but
cmscan is broken now, because it hasn't yet been updated to work on
pressed databases.

Changed how the HMMs filters that are embedded within CM files are
read. Previously, a P7_HMMFILE object was being created, opened and
closed for each CM read. This was wasteful, and slow. Now, a
P7_HMMFILE is part of the CM_FILE data structure, it is created/opened
once when CM_FILE is created/opened and used for all P7 filters in the
CM file. New way is cleaner and faster. Reading all 1973 Rfam 10.1 CMs
and p7 filters from a binary CM file dropped from ~0.5s to ~0.2s.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3603 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-08T12:13:11Z,nawrockie
59bb7b6b8d6c5f36c3b7f8bedb005dd5ae71b08f,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_file.c: added benchmark for reading CM files. Results of the
benchmark suggest a large fraction (at least 50%) of cmscan runtime on
random sequences is in CM file input, even for binary CM files. I'm
convinced a hmmpress-analog (cmpress) is warranted and I'm about to
start on that.

cmscan.c and ccmsearch.c: typo fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3602 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-07T17:08:07Z,nawrockie
a65ff0c9a932a0e34e9617e2fa95a290dc0f3dd7,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed problem with binary input/output, which was not properly
synchronized, and calibrated binary models were not being read
correctly. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3601 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-07T15:29:58Z,nawrockie
bdf74baf41dce7794952a39158bca43af573f704,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated x-cmsearch rmark module to be consistent with current cmsearch
--tblout format.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3599 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-06T19:17:50Z,nawrockie
850a4b953f353448df784bb64272e5fa10ea8e5f,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated cmscan so it uses threads.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3598 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-06T18:37:02Z,nawrockie
39646863cdf07588938f55c2d9ee1e9590ee65b5,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild: consolidated the --1p0matins, --e1p0df and --p56 options into
	 the single option --v1p0. This option tells cmbuild to
	 parameterize the model exactly as a version 1.0-->1.0.2
	 cmbuild would have. The --p56 option which specifies that the
	 default prior used for Infernal versions 0.56-->1.0.2 be
	 used is still available as a standalone option, but
	 --1p0matins and --e1p0df no longer exist.

cmconvert: Fixed a discrepancy between how W was calculated for CMs in
	   v1.0->v1.0.2 and how it was being calculated in cmconvert
	   for v1.0->v1.0.2 built models. Model must be in local mode
	   to calculate QDBs, but in global mode to output them to a
	   CM file. Now cmconvert reproduces the v1.0->v1.0.2 W
	   (v1.0->v1.0.2 did not store W in the CM file) and
	   writes it in the new dev format output CM file.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3597 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-01T19:37:09Z,nawrockie
7045de296d1b6dd11b6ba902f2627f75db95a8bc,Eric Nawrocki,eric.nawrocki@gmail.com,"cmconvert now calibrates a ML p7 HMM built from the CM and saves its
E-value statistics to the output CM file.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3596 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-01T19:15:29Z,nawrockie
d89887d83c8e1dba56463eea7e2d24b5c7b1cb7f,Eric Nawrocki,eric.nawrocki@gmail.com,"Crap. Forgot to actually add cmconvert.c in the previous commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3595 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-01T14:20:50Z,nawrockie
cd18e0a0466e646becbabbc2d7b11c0cfc5da2f9,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cmconvert, which can read in a CM file generated by version 1.0
--> 1.0.2 cmbuild/cmcalibrate and output a CM file in the current file
format. For the older files, cmconvert must calculate W, qdbs, and the
consensus sequence for each CM before outputting it because these
values are included in the new file format, but were missing from the
old one, and all programs now assume they are present in the CM data
structure upon reading a CM. Because of this missing info, the
1.0-1.0.2 file format is only readable by cmconvert, not by any of the
other programs. If a user tries to use an old CM file with any program
but cmconvert, an error message suggests they upgrade with cmconvert.

Most files that are modified were changed only to remain consistent
with a changed prototype for cm_file_Read(), which now takes an
argument specifying whether the v1.0-->v1.0.2 file format is
acceptable.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3594 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-07-01T14:20:18Z,nawrockie
f04b68e7806ba6ebd4f739dd00e63b454e89be1d,Eric Nawrocki,eric.nawrocki@gmail.com,"Cleaned up some problems related to MPI communication of the CM data structure
related to the new file format. cmcalibrate now works again in MPI mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3592 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-30T10:32:01Z,nawrockie
e5683b14f72ebb87ff53f23fefec1923718837c6,Eric Nawrocki,eric.nawrocki@gmail.com,"Continued revision and some small bug fixes of cmscan.
Also fixed an-off-by-one error in output of cm->rf annotation in
cmsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3591 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-29T19:09:58Z,nawrockie
5c55ce10733d9bbf0ea4f2aee4112e023720cfb9,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cmscan. It compiles and works anecdotally in serial mode (but
not in MPI nor threaded modes). It will be substantially revised in
the near future.

src/config.h.in: added CMSEQDBENV and CMDBENV #defines.

src/cmsearch.c, src/funcs.h: changed function prototype for
cm_pli_NewSeq(), a CM object is no longer necessary.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3587 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-28T15:41:38Z,nawrockie
8386bc5b09bf39ce38e5ca427c9b85f4bea222a0,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed some small problems related to the new CM file format. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3586 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-28T14:43:01Z,nawrockie
8e4082759bea8e61c8d8003fd249bd3b3e815ef7,Eric Nawrocki,eric.nawrocki@gmail.com,"Renamed my_p7_msvfilter.c to the more appropriate cm_p7_band.c because
it holds functions related to p7 HMM MSV-derived bands for CP9 HMMs
and ultimately CMs. 

Renamed p7_modelmaker.c to cm_p7_modelmaker.c to adhere to
conventions, and avoid having an identically named file in hmmer/src/
and infernal/src/.

Updated references to these .c files in Makefile.in and funcs.h.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3585 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-27T17:14:04Z,nawrockie
453d665e81f75a1a831560b1146460dfa94da4a1,Eric Nawrocki,eric.nawrocki@gmail.com,"New CM file format used by all executables. cm_file.c replaces
cm_io.c. cm_io.c has been moved to old-cm_io.c with 'svn mv cm_io.c
old-cm_io.c'. 

Some cmsearch tests still fail a 'make check'. Because cmsearch has
changed dramatically I'll have to overhaul these tests.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3584 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-27T15:23:05Z,nawrockie
03eee28c97c1626a52aab4c299d79569796f5705,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed dcmbuild and dcmsearch from the Makefiles.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3581 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-24T20:44:31Z,nawrockie
eb5fe5ce7abf90c092606441897f2fb8e9880ad5,Eric Nawrocki,eric.nawrocki@gmail.com,"Moved dcmsearch.c to cmsearch.c with 'svn mv dcmsearch.c cmsearch.c'.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3580 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-24T20:42:37Z,nawrockie
f6f6fb27eb9e132df345e59953ff8314ddc52564,Eric Nawrocki,eric.nawrocki@gmail.com,"Moved cmsearch.c to old-cmsearch.c with 'svn mv cmsearch.c
old-cmsearch.c'. 

I'm about to move dcmsearch.c to cmsearch.c. dcmsearch.c contains the
new HMMER3-based filter pipeline.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3579 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-24T20:41:57Z,nawrockie
5b8ca5abdb1cbc78e3bd52ba501ab1010931f221,Eric Nawrocki,eric.nawrocki@gmail.com,"Moved dcmbuild.c to cmbuild.c with 'svn mv dcmbuild.c cmbuild.c'


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3578 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-24T20:40:14Z,nawrockie
5dec795d71d6726c7171de16c79e6d8dd1ba8f8e,Eric Nawrocki,eric.nawrocki@gmail.com,"Moved cmbuild.c to old-cmbuild.c with 'svn mv cmbuild.c
old-cmbuild.c'. 

I'm about to move dcmbuild.c to cmbuild.c, but I wanted to do that in
a separate commit because I'm not sure how bundling those two changes
together would affect the ability to revert in the future. I think
doing two separate commits is probably safer.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3577 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-24T20:39:09Z,nawrockie
2c27106cbacd9349b3f772394da35c45a498d9db,Eric Nawrocki,eric.nawrocki@gmail.com,"Added options to allow dcmbuild to parameterize models identically to
how they were in cmbuild from Infernal version 1.0 through 1.0.2. This
will help me regenerate the Rfam 10.1 models to be used with the new
search pipeline, without the need for rerunning cmcalibrate.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3576 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-24T20:36:22Z,nawrockie
a88adbded235c91d981fba176186edf2fa9e2516,Eric Nawrocki,eric.nawrocki@gmail.com,"Crap. Forgot to 'svn add' cm_file.c before previous commit. It's added now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3575 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-23T00:15:51Z,nawrockie
c2e96900b487636cfb873681d9e3a2a1359e037e,Eric Nawrocki,eric.nawrocki@gmail.com,"Note: code is in an incomplete state, and will not pass all tests.

Complete rewrite of CM file format and input/output. New format is
modeled after HMMER3 HMM file format. Input/output functions for the
new format are in cm_file.c. The analogous functions for the old
format still exist in cm_io.c, though I'm probably going to get rid of
them soon.

dcmbuild outputs CMs in the new file format. cmbuild does not. I'm
about to replace cmbuild with dcmbuild soon.

cmstat reads CMs in the new file format. It has been drastically
simplified because the complex HMM filter thresholding scheme used by
the old cmsearch is now deprecated because dcmsearch (which will
become the new cmsearch soon) doesn't use it.

I'll integrate i/o of the new CM file format in the other programs in
upcoming commits. I would've waited to do it all at once, but I think
it makes sense to break such a large change down into separate commits
(plus I'm the only one making Infernal changes right now).

New information added to CM file that is read into the CM data
structure:

consensus: consensus sequence   
map:       alignment map        
rf:        reference annotation 
acc:       model accession
desc:      model description
checksum:  file checksum for MSA used to build model
W:         window length
dmin/dmax: QDBs for each state

Main motivation for this was the desire to get W and QDBs to be stored
within the CM file, to prevent the need to calculate them after
reading a CM, which now takes a significant amount of time relative to
the faster search times. I also wanted acc and desc and rf pulled from
the CM, and I figured I might as well update the entire format if I
was going to make so many other changes. Additionally, CM files built
with previous versions of Infernal would need to be rebuilt anyway,
because old versions don't contain the p7 H3 filters required by the
new version.

Also, HMM filter stats (HMMFilterInfo_t) are no longer stored in the
CM file, since they won't be used by the new cmsearch (currently
called dcmsearch, but I'm about to replace cmsearch with dcmsearch
soon). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3574 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-23T00:13:22Z,nawrockie
060ef74e6ad8dac8d9f6de04f60c8621186b4bfe,Eric Nawrocki,eric.nawrocki@gmail.com,"o Incorporated Travis' fix for threaded nhmmer (HMMER r3562) in
  dcmsearch. 

o Fixed inconsistency between maximum allowed matrix size in HMM
  banded CYK/Inside scanners and HMM banded optimal accuracy alignment,
  all HMM banded functions now use the same matrix size limit of 128 Mb.

o Added report of statistics on alignment timings and required matrix
  sizes to cm_tophits.c, this may only be output when a specific option
  is invoked, I'm not sure yet.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3570 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-16T18:22:57Z,nawrockie
8aa63a76ee91d80fe4adc812bedc45c984cb01d8,Eric Nawrocki,eric.nawrocki@gmail.com,"Added removal of overlapping hits found by the CM search pipeline that
can only occur because long sequences (> 100Kb) are split up into
overlapping blocks and searched independently. Overlaps can occur in
the overlapping regions. (Overlaps within a single block are not
possible, due to the way hits are reported from the Inside DP matrix.)

Overlap removal is achieved by sorting all hits in the full CM_TOPHITS
hit list by sequence index (a unique sequence identifier) as the first
key, and sequence start position as the second key, and then stepping
through the sorted list removing overlapping hits (same sequence, same
strand, sharing >= 1 residue) by keeping the hit with the higher bit
score. Removed hits are flagged by setting the CM_HIT_IS_DUPLICATE
flag in the hit->flag field. The list is then resorted based on bit
score and only hits without the CM_HIT_IS_DUPLICATE flag are
reported. 

This required deviating the CM_TOPHITS and CM_HIT objects/functions
slightly from the P7_* analogs on which they are based, by adding the
capacity to sort by score or seq_idx. The 'sortkey' field has been
removed from CM_HIT because two quicksort helper functions now exist,
one for each type of sort, each of which knows which fields in the
CM_HIT object to sort based on.

This revision also includes several minor updates that affect
dcmsearch, including:

cm_p7_domaindef.c: changed 'pvalue' field name of P7_DOMAIN to 'lnP'
		   to keep consistent with recent change in HMMER's
		   hmmer.h.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3563 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-14T13:14:51Z,nawrockie
123bd3ad038e42b23dee9244c7c72f37d2a4f51f,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug in cmsearch/dcmsearch output related to posterior
probability annotation. Gaps were not reliably being annotated as
'.' due to a bug in the display generation routines.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3561 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-09T20:26:25Z,nawrockie
f8e75f5b881c0ad4f8e88a0746c1ccef39c6ab91,Eric Nawrocki,eric.nawrocki@gmail.com,"MPI dcmsearch now works, at least anecdotally. Statistics (number of
residues surviving each filter) are slightly different from serial
and threaded mode, which needs to be understood and (probably) fixed.

MPI dcmsearch requires an SSI index file for the database to run. This
makes it possible for workers to receive a work unit that tells it
which sequence(s) and residue boundaries to search, and quickly fetch
that (sub)sequence and do the search. Without SSI, it would need to
position the sqfile at the beginning of the first desired sequence,
requiring it to chew through potentially a lot of sequence until it
gets to the desired subsequence. I could try and position it at
subsequence starts without SSI, but that's not really supported by
Easel as esl_sqio_ReadWindow() expects the caller to sequentially read
complete sequences. Or I could actually send the sequence to the
workers (which old cmsearch did!), but we don't want to be sending all
that data around. SSI is a good solution, with the only drawback being
that users now need to index their files a la BLAST.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3560 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-08T18:56:19Z,nawrockie
806738e03841be3485ef2268a91dfbdb4ed4ef26,Eric Nawrocki,eric.nawrocki@gmail.com,"Added MPI capability to dcmsearch. Currently workers must search full
sequences. Next step is to allow workers to searches only subsequences
of long sequences. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3559 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-06-06T13:03:40Z,nawrockie
dabfd457648064ee64e8a452de44122882defa4c,Eric Nawrocki,eric.nawrocki@gmail.com,"Forgot to actually add cm_alidisplay.c with previous commit...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3556 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-27T20:20:16Z,nawrockie
9a53ee5dd559c47982e48c5df26c1ded72920585,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added CM_ALIDISPLAY data structure and cm_alidisplay.c based on
  HMMER's p7_alidisplay. 

o CM_PIPELINE its are now aligned if (pli->show_alignments) using HMM
  banded optimal accuracy if possible, i.e. if combined sizes of
  required matrices is less than a maximum size (128 Mb by
  default). This should be enough for the vast majority of
  alignments. If opt acc needs too much memory, HMM banded CYK is used
  if possible. If that requires too much memory as well, then (slow)
  divide and conquer CYK is used. This should be necessary only very
  rarely, but I'll test to make sure.

o Default dcmsearch target table and hit alignment output mirror
  hmmsearch/nhmmer closely, but differ slightly where necessary. For
  example, the hit alignment output contains enough information for a
  user to determine which alignment algorithm was used, and how much
  time and memory were required for the alignment. And information on
  domains is, of course, not necessary.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3555 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-27T20:18:53Z,nawrockie
5fb13aa13d4a1cb99b8a04bc83bcbb97ef9b91d3,Eric Nawrocki,eric.nawrocki@gmail.com,"Added CM_TOPHITS data structure and cm_tophits.c file, based upon
p7_tophits.c. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3554 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-25T18:25:37Z,nawrockie
8378e98948e932a395d75a4b99903b812467aede,Eric Nawrocki,eric.nawrocki@gmail.com,"Two major changes to new cmsearch (dcmsearch):

1. Database file must be indexed with SSI prior to searching it. This
   allows dcmsearch to quickly determine the database size (without
   reading through the full file) and set filter thresholds
   accordingly. I'm not sure if this will remain a strict requirement or
   not. 

2. Threading now works (at least anecdotally).

Also:

o Added function for cloning a CM data structure, but only just after
  it's been read from a file (otherwise it's much more complicated). 
  This enables threading using the code organization/strategy
  originally written for hmmsearch.

o Changed default block size read for the CM pipeline from 1 Mb to
  100Kb, so that 8-way threading on archaea/bacteria genome makes
  sense.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3553 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-24T15:35:08Z,nawrockie
4a4e4ff7d547c3d1392422da82d8949f5f3a4bcb,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed the HybridScanInfo_t data structure and updated all affected
code to reflect that. I experimented with this data structure when
filtering with hybrid CM/HMMs a few years ago, with little success.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3552 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-24T12:37:52Z,nawrockie
bc178174e1e62f0b5408f09a465c42fc4cfcb4c1,Eric Nawrocki,eric.nawrocki@gmail.com,"Added database size dependent default filter thresholds, currently
only applied with the -Z option. See
~/notebook/11_0513_inf_dcmsearch_thresholds/00LOG and 
~/notebook/11_0514_lm/00LOG  
for details on how these were determined.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3551 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-24T10:22:39Z,nawrockie
41124c4fa971186654f1b4992a1fe67f48044d20,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated x-nhmmer to handle new tabular output format used by nhmmer.
o rmark-Rroc.pl now prints thicker lines on ROC curves.
o Minor changes to rmark-pp.sh.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3549 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-23T17:46:11Z,nawrockie
01d83d9e5475f2a9ce633abd119f47434f275e34,Eric Nawrocki,eric.nawrocki@gmail.com,"A 'make check' now passes. Fixed two issues noted by SRE in log
message for r3547:

o cmcalibrate was not being built (!), now it is.
o fixed incorrect path to input file for cmfetch sqc exercise in
  exercises.sqc. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3548 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-23T15:34:21Z,nawrockie
4b785fb6525cf3ced7b80772f2d92086a49d02e6,Sean Eddy,sean@eddylab.org,"Updated infernal to use new esl_keyhash_{Store,Lookup} calls.

Four unit tests fail in 'make check'. All three cmcalibrate's fail
because cmcalibrate isn't even built. The cmfetch:3.4.12/i1 test also
fails, on !! substitution; I think the exercise's sqc command line
might be wrong. I don't think these are due to the Easel changes. Will
talk to EPN.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3547 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-23T15:00:09Z,cryptogenomicon
6021f1f18f1e060034cc20d9b8bedf25dabd1db7,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed typo, Infernal now has 8 main programs, not 7 (with addition of
cmfetch).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3545 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-14T15:50:06Z,nawrockie
fe3507597834869793f9456cbfabc7953afc5f1d,Eric Nawrocki,eric.nawrocki@gmail.com,"Added documentation/manpages/Makefile.in.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3544 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-13T15:57:56Z,nawrockie
1545f39ed45c483c822d8cc762c1cccd927e2742,Eric Nawrocki,eric.nawrocki@gmail.com,"Overhaul of Infernal's build strategy to be consistent with the
current build strategy in HMMER. This was done by literally copying
the analogous Makefile.in and configure.ac files from HMMER and
minimally changing them to work with Infernal
(e.g. infernal/src/Makefile.in is based on hmmer/src/Makefile.in).

Thus, the Infernal build strategy is now consistent with HMMER as of
HMMER's 3540 revision.

This brings in nice-looking 'make' output stolen from Git, as well
as an overhaul of how the impl_sse code is handled (see HMMER revision
3513 for details).

As part of the overhaul, the test programs in testsuite/ were moved to
src/ to be more consistent with HMMER organization. These are now
compiled by a 'make' in infernal/src/'. The sqc files that use these
tests have been updated accordingly.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3543 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-13T14:10:59Z,nawrockie
3595b3c35a66f560cf8ca1ebd2b255ff9dbc11ff,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on cmsim. Added --ifile and --rfile options for saving
exp tail fits for various tail probabilities for important samples and
random samples. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3539 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-10T13:36:34Z,nawrockie
ee69594b7f300ec62693acdb7a983e4596297814,Sean Eddy,sean@eddylab.org,"esl_msa_Set*() functions now take an extra argument <n> for the string
or buffer length. Optional (-1) if string; mandatory if unterminated
buffer.

I couldn't test this change; I can't get Infernal to
build. Specifically, 'make clean' fails. There are (at least) two
copies of Easel in here. I think the autoconf script is only building
Makefiles for one of them, but the HMMER Makefile is trying to recurse
into the other. I think we need to revise so that HMMER configuration
is flexible about where Easel is (i.e. it can be ../easel, not easel/,
relative to H3).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3538 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-10T12:30:35Z,cryptogenomicon
5d8c2bfcf70207dd9df814b88ab201298712041b,Sean Eddy,sean@eddylab.org,"Added a 'make TAGS' target to top level Makefile.in, to facilitate
using tags searches for gauging impact of Easel API changes on
Infernal.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3536 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-05T15:40:01Z,cryptogenomicon
d7d86c4bcfbba2c20cd12c51e61cbf547b861b8e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed dcmsearch -T <x> option; it actually works now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3535 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-04T14:49:42Z,nawrockie
4cd8227cc124b4c3e6fe3904003875a86ee1212f,Eric Nawrocki,eric.nawrocki@gmail.com,"A few more modifications to the makefiles to work with new build
strategy in HMMER and Easel. These revisions complement those checked
in as r3532. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3534 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-05-02T19:12:29Z,nawrockie
cabe415e59934e3e170e67cd082c07ff64beaa89,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated Makefile's to work with Sean's overhaul of Easel/HMMER build
procedure checked in for HMMER in svn r3513. I have not yet overhauled
Infernal's build procedure in an analogous way, but I plan to soon.

Added cmsim, a new, possibly temporary, executable for investigating
importance sampling as a possible way to accelerate cmcalibrate. It
doesn't really do anything yet. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3532 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-04-29T19:03:12Z,nawrockie
5d8a2704041814e86cf33db827bbbc329c982098,Eric Nawrocki,eric.nawrocki@gmail.com,"Small typo in --rfam option. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3531 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-04-29T17:52:35Z,nawrockie
843c77b05f4ae76633489c800ef96ea43182a269,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --rfam option to dcmsearch. Results with this option on searches
of 1% of Rfamseq9 with all Rfam 10.0 CMs were reported in my talk at
Xfam, March 14, 2011. I had simply neglected to check in the change
until now. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3528 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-04-27T18:33:23Z,nawrockie
c459502133978a70a5cf19cbb84072bfd41305b5,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i24: a rare, but possible, infinite loop with
cmbuild --refine. Reported by Paul Gardner. See Bugs/BUGTRAX for
details. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3510 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-21T12:33:49Z,nawrockie
7df8e7a2ec10c8f9a9d0f765e7bb77d655f89f54,Eric Nawrocki,eric.nawrocki@gmail.com,"Fix to rmark-Rroc.pl so that it now correctly picks-up and reports MER.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3509 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-14T00:41:22Z,nawrockie
f8e4c15a6f838e7f3459bf0835a6d817c6ddc70c,Eric Nawrocki,eric.nawrocki@gmail.com,"Refined the rmark3 module for x-wublast a bit. It now specifies
cpus=1, although this doesn't seem to chagne running time. Also, the
reported time is now only the (wall) time it takes to run wu-blast,
not total run time of the script (which calls afetch and parses output
in addition to calling wu-blast).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3508 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-12T01:38:21Z,nawrockie
ddf55d8980fb4318183b5d6092c75de3bbe85e39,Eric Nawrocki,eric.nawrocki@gmail.com,"x-rfamscan: Small but crucial fix. The cmsearch options from the
            options file were not being passed to cmsearch, including
            the vital -Z option which sets database size. This
            affected E-values of all hits drastically. However,
            overall MER was not drastically altered (decreased
            E-values of positives and negatives cancelled each other
            out in MER statistic), but it did drop about 12 for
            rfamscan on rmark3 due to this fix (from ~232 to ~220).

rmark-master.pl: Added -l short=true to rmark/rmark-master.pl to try
		 to deal with sudden unavailability of cluster nodes.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3507 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-11T21:16:05Z,nawrockie
d07da132ee9e4e9a74597e0383ee5556945f1a1d,Eric Nawrocki,eric.nawrocki@gmail.com,"Small fix so rmark-Rroc.pl is consistent with current (and recently
updated) rmark-pp.sh.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3506 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-11T21:11:55Z,nawrockie
60a5247dd835ad6205c70def25e3b29dabd20985,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new cmsearch pipeline.

Renamed some filter stages:
old name --> new name
gF3  --> F4   (glocal forward)
gF3b --> F4b  (glocal forward bias)
dF3  --> F5   (domain/envelope defn)
dF3b --> F5b  (domain/envelope defn bias)
F4   --> F6   (CYK)

Also, replaced most use of the term 'domain' with 'envelope' in code
and comments. 'domain' usage was from HMMER, with RNA we I think
'envelope' is more appropriate. An 'envelope' calculated in dcmsearch
is analogous to a 'domain's envelope' in hmmer. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3505 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-11T15:26:24Z,nawrockie
3b86a836dd489337fac90718f428ed4a00affe9b,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new cmsearch pipeline.

Redefined default filter thresholds as:
F1    loc MSV          P=0.40
F1b   loc MSV bias     OFF
F2    loc Vit          P=0.15
F2b   loc Vit bias     P=0.15
F3    loc Fwd          P=0.02
F3b   loc Fwd bias     P=0.02
gF3  gloc Fwd          P=0.02
gF3b gloc Fwd bias     P=0.02
dF3  gloc dom def      P=0.02
dF3b gloc dom def bias P=0.02
F4    loc CYK          P=0.0005

Bias correction for domain def stage now calculates bias based on full
envelope. 

Made greedy hit resolution default based on small sensitivity gain on
benchmark. Previous default, optimal hit resolution is settable with
--nogreedy.

All decisions for defaults motivated by rmark3 benchmark performance
as described in:
xref: ~nawrockie/noteboook/11_0217_inf_search_thresholds_for_new_calib/00LOG

Next revision will change the names of filter stages and remove use
of 'domains' so far left in from H3 code, to be replaced with
'envelopes'.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3504 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-11T14:33:15Z,nawrockie
cb7c45a0c149b7035891a621abd34184bd815bfe,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new cmsearch pipeline.

Cleaned up/simplified code related to model building. From dcmbuild
(which will eventually become cmbuild): removed many of the options
related to building additional p7 HMMs as filters. Including all
related to clusters on the input sequences as these did not improve
performance on rmark3, while significantly increasing running times of
searches (see
~nawrockie/notebook/11_0224_inf_dcmsearch_p7s_from_clusters/00LOG for
results).

The new default strategy for model building is to build a single
additional HMM and include it in the CM file. It is built using HMMER
default transition priors for DNA/RNA HMMs and marginalized emissions
from a CM built to achieve a HMM mean match state relative entropy of
0.38 (paired positions are marginalized). Using this model in
combination with the ML p7 HMM built entirely from the CM (that is,
using two HMMs as filters) gives the best performance on the benchmark
of any combination of 2 mono-RNA HMM filters I've tried. di-RNA filters
still do very slightly better (about 2-3 MER), but the difference is
so slight that I've decided that, given their added complexity, di-RNA
filters are not worth committing to the trunk (they were implemented
in ~nawrockie/notebook/10_0901_inf_dinuc but never committed). 

Using only this model as a single filter gives the best single filter
results I've seen, and are performance is so close to the double
filters (4 MER or so) that I think I'll probably make mono-filtering
default.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3503 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-10T19:38:01Z,nawrockie
f3048784bd2c3444fb19813e3052d1868eee0c70,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new cmsearch pipeline.

Added several experimental options, most or all of which may be
removed soon. --glen, --glN, --glX, and --glstep lower the p7 glocal
forward filter P-value threshold (gF3) for long (consensus length >
200) models. By default, gF3 is halved for each 100 nt a models clen
exceeds 200, until 500. This gives about a 15% speedup on the rmark3
benchmark with no appreciable loss in sensitivity, though it must
decrease sensitivity in some 'real-life' cases.  The motivation is to
save time on larger models which take disproportiantely long in the
CM stages due to the high complexity of CYK/Inside.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3501 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-08T00:43:58Z,nawrockie
9dd394bc300911285c596e5ace8db64fb3e44ddb,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed '--enable-lfs' flag from the User Guide's example configure
command. It is no longer a valid flag. This was reported to Sean as
out of date by Christopher Bottoms at the University of Missouri.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3500 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-04T18:05:19Z,nawrockie
38d9b60b9a28a11502c28c932797ba70a1c77726,Eric Nawrocki,eric.nawrocki@gmail.com,"Update of configure.ac that is identical to the update on HMMER's
configure.ac between revisions 3496 and 3497. This adds two pieces
required for proper configuration of Easel: ESL_PIC_FLAGS macro for
compiling PIC code pand AC_PATH_PROG test for gzip.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3499 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-03-04T18:02:38Z,nawrockie
fbc32d96a0f9c385fb4f667e26f7896a4e4b3b84,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed small bug: was incorrectly renormalizing cp9 HMM's emission
distributions instead of normalizing the ML p7 HMM's during ML p7 HMM
construction. This should actually be unnecessary assuming the cp9 is
already normalized, but is done just to be safe.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3495 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-02-28T12:56:54Z,nawrockie
897597eb2b2bb240cd3b8a9fcb1825e2dfb86353,Eric Nawrocki,eric.nawrocki@gmail.com,"rmark-pp.sh: 100K bootstrap samples are now done by default. Output
	     files are now named based on the scalar multiplier for
	     E-values, so multiple rmark-pp.sh's can be run for a
	     single benchmark, but with different E-value
	     multipliers. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3492 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-02-25T15:59:30Z,nawrockie
cf4310d74ac7ea2dffead04c579307ab0463ec1c,Eric Nawrocki,eric.nawrocki@gmail.com,"Typo correction.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3491 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-02-24T21:54:54Z,nawrockie
eb1af137f3661eb5d6737c01c42c53d9fe0b1522,Eric Nawrocki,eric.nawrocki@gmail.com,"o rmark-multiply-evalues.pl: 
  New script for multiplying the E-values of all positives in a
  benchmark run by a scalar factor. E-values of decoy hits (negatives)
  are not multiplied. This allows us to simulate results of a
  benchmark in a larger database (assuming same distribution of scores
  of negatives).

o rmark-pp.sh: 
  Now calls rmark-multiply-evalues.pl with third command line variable
  prior to computing ROC plots and bootstrapped MERs. 

o rmark-rocplot.c:
  Added new option: --Ethresh <x> for outputting average number of
  false negatives and false positives at E-value threshold of <x> over
  all bootstrapped samples. This can be more informative to MER if
  we're interested in comparing the effect of different search
  parameters on sensitivity and specificity separately (MER is a
  combined measure of sensitivity and specificity and so can difficult
  to interpret in terms of one or the other).

o rmark-master.pl and x-cmsearch: 
  Added -H option for fetching P7 HMMs from a p7 HMM file for
  filtering (probably temporary).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3490 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-02-24T17:06:12Z,nawrockie
14c9c0e92bd23f62726e8eecad7662f59222bf63,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new search pipeline.

Fixed some ESL_GETOPTS options definitions for dcmsearch.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3489 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-02-23T15:29:19Z,nawrockie
6d82c5d592d21158e9d7e5abb2c9381318794703,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new dcmsearch pipeline.

o Fixed bug that subtly affected the bias score correction for the
  domain definition stage. See
  ~/notebook/11_0217_inf_search_thresholds_for_new_calib/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3488 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-02-22T15:21:39Z,nawrockie
5d997aa72439b9f13e7b45ef2300b61430c7e2cc,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified default dcmbuild behavior. Previously, p7 HMMs were, by
default, calibrated similar to how HMMs are calibrated in
Infernal-1.0. That is, on 'realistic' sequences, slowly (using many
(10K) sequences), and allowing lambda to be fit to the data. Now, p7
HMMs are calibrated much more like HMMER3. That is: on 'iid'
sequences, quickly (using few sequences (200)), and having lambda
fixed as 0.693 (with slight model-specific correction). 

Models calibrated the new way are able to achieve rmark3 performance
that rivals the old way, albeit with different search
thresholds/parameters (most notably Viterbi bias, local Forward bias,
and glocal Forward bias filters must be turned on). 

The benefit of H3 calibration is speed and consistency with HMMER. The
models can be calibrated within 'dcmbuild' in at most a few seconds
(which will eventually take the place of cmbuild). This will allow the
expensive CM calibration steps to remain separate, in cmcalibrate, and
consequently give the HMM filtering speed win to models that aren't
even calibrated with cmcalibrate.

xref: ~/notebook/10_1109_inf_cmbuild_p7_evalues/00LOG (especially on and after 01/14/11)
      ~/notebook/11_0207_inf_p7_glocal_fwd_tailfit/00LOG



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3487 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-02-17T14:27:07Z,nawrockie
1d0cd9cf642c8bbfeec9b88371862ec0806e4b55,Eric Nawrocki,eric.nawrocki@gmail.com,"cm.c:       removed unused variable to silence compiler warning
dcmbuild.c: added --p7-cml which causes per-cluster HMMs to be ML HMMs
	    derived from the per-cluster CMs, instead of HMMER3
	    parameterized HMMs. This changes the priors used and the
	    entropy weighting calculation for the HMMs. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3470 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-01-14T11:22:54Z,nawrockie
201f0beb07bc2918ce96a1d756b1d26bca289834,Eric Nawrocki,eric.nawrocki@gmail.com,"cm.c:           added 2 free calls to FreeCM()
cm_io.c:        HMMER3/d format now fully supported (again, we need a better
	        way of reading HMM files eventually).
cm_pipeline.c:  cosmetic changes to comment lines, only

dcmbuild.c:     
Added --p7-c* options for building HMMs from clusters of seed
sequences. These are analogous to the --c* options, but cause only an
HMM that will be used to filter in dcmsearch to be built from each
cluster, not a CM from each cluster. 

Also, --exp-real and --exp-fitlam are now default, and replaced with
the --exp-iid and --exp-fixlam options which turn them off. So, now by
default, realistic genome-like sequences are used for HMM calibration
(iid seqs with --exp-iid) and HMM E-value lambdas are fit by default
(approximately 0.693 is used if --exp-fixlam).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3469 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-01-14T11:06:10Z,nawrockie
a5cc66dbe27df354703c35eb5fad935a5ac74b26,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed --c* options for building models from clusters (subsets) of the
input alignment sequences. These were broken due to a change in
the esl_tree module since the infernal 1.0 branch (i.e. since the
1.0.2 release) that modified how branch lengths in single linkage and
complete linkage trees were defined. Previously, all trees were
'additive', but now linkage trees are special in that they're branch
lengths (T->ld and T->rd) are actually 'heights' and are not additive
branch lengths. This was causing serious problems.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3466 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-01-13T18:36:11Z,nawrockie
e8d00a0b8553b0a5ac9214912283b4669d8fee4e,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new cmsearch pipeline.

cmsearch.c:
Added --greedy and --hgreedy options to cmsearch to allow more
apples-to-apples benchmark comparison of the old pipeline with the new
pipeline.

cm_io.c: 
New hmmer3/d format supported, eventually we need a better way of
reading HMMs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3465 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2011-01-13T14:11:56Z,nawrockie
4ba14ff28859dcbae19b5e7a245d24574c2ed7cd,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new cmsearch pipeline. 

This commit modifies the CM data structure and CM file format to
include additional HMMs built from the input alignment to dcmbuild. A
single additional model is built using HMMER default entropy weighting
and priors with the --p7-add option to dcmbuild. This HMM is then read
and used in addition to the default maximum-likelihood (ML) HMM as
complementary filters in dcmsearch. Most changes to the code are
related to these additional p7 filters. I may eventually revert this
change (probably manually, i.e. not with an 'svn revert') after more
testing, but it was useful to commit it in the current state.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3455 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-12-28T10:17:33Z,nawrockie
022ca2cb229f55e82f071b4bcb7b8e778f1ca512,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on the new CM search pipeline. 

This commit modifies the 'domain' definition stage, which previously
took about 40% and 30% of the total run time of dcmsearch for the
rmark3 and rmark3iid benchmarks, respectively, with default
parameters. Changes to the domain defn stage, introduced in this
commit. 

1. Added a new filter, the glocal Fwd filter, which removes windows
   whose glocal scores give P values > gF3, which is 0.01 by
   default. This saves time b/c previously all windows that survived
   the MSV & Vit & (local) Fwd filters were going through the full
   domain defn stage, now we throw out many after only running glocal
   Fwd (the full domain defn stage requires a full Backward() and
   Forward() and Backward() calls on each examined domain).

2. Changed the correction made to domain scores, it is now more
   consistent with what hmmer3 uses in hmmsearch.

3. Made null2 OFF by default (previously it was ON). And changed code
   in glocal domain def functions to only do null2 related
   calculations if null2 is on. This is a big time saver because the
   generic Null2 routines necessarily used by the glocal domain def
   pipeline are slow and labelled as optimization targets by Sean in
   the code. 

4. Removed the calculation of the optimal accuracy alignment from the 
   glocal domain def functions. It is unneeded because we're just
   using the domain scores as a filter, and the final alignments will
   be made with the CM.

4. Changed default domain def P-value cutoff from 0.02 to 0.01.

These changes result in about a 5X speedup in the domain def stage of
the pipeline for both rmark3 and rmark3iid.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3447 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-12-20T14:47:45Z,nawrockie
97bd596326b0767220ab2b6e6dff29484ee8909c,Eric Nawrocki,eric.nawrocki@gmail.com,"o Still working on new dcmsearch CM search pipeline.
o Fixed a few unnecessary memory freeing bugs in dcmsearch.c and
  cm_pipeline.c that only occured when certain option combinations
  were used.

o Modified function prototype for all CYK scanners in cm_dpsearch.c()
  FastCYKScan(), RefCYKScan() and FastCYKScanHB() so they can
  optionally return <envi> and <envj> the boundaries of an envelope,
  where <envi>/<envj> are the minimum/maximum positions that exists in
  any CYK hit with scor that exceeds <env_cutoff>. 

  This is used to redefine envelopes in the search pipeline prior to
  sending them to Inside. It results in about a 2-fold speedup for the
  Inside stage of the pipeline at <env_cutoff> P values that do not
  sacrifice appreciable sensitivity (< 1 MER on rmark3 benchmark).

  Change of the CYK function prototypes necessitated changes to those
  function calls in cmstat.c, cmsearch.c, cmscore.c, dispatch.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3439 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-12-14T15:17:00Z,nawrockie
4011dd229c133bd5c2bda51ba4dee0a3105c592a,Eric Nawrocki,eric.nawrocki@gmail.com,"o Changed initial allocation and reallocation sizes for parsetrees to
  25 instead of 100.
o Renamed existing default.prior, the default prior used by cmbuild in
  versions 0.56 to 1.0.2 to v056-to-v102-default.prior.
o Updated default.prior so it is the current default prior, which will
  probably be default in the next release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3438 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-12-14T14:48:08Z,nawrockie
1b1e8f6345a05bbb08e71dd4877dcc686b10fe29,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i23 in Bugs/BUGTRAX. This bug was in
alphabet.c::PairCount(). Degenerate basepairs were incorrectly being
counted during model construction. This bug was present in the
codebase since at least Infernal 0.55, and possibly earlier. See
BUGTRAX for more information.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3423 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-12-06T18:37:50Z,nawrockie
42c991ba73924eb894401b879a1e411bef6a64df,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on dcmsearch pipeline.

Added further support for using multiple HMM filters, anything that
survives any of the HMM filter pipelines is searched with the
CM. 

Currently, the only way to use multiple HMMs is to use a single
additional HMM read from a file with --p7file option to dcmsearch, the
input HMM from this file will be used in addition to the default,
'maximum likelihood' HMM that is built from the CM. More options will
come in later revisions, including, probably, reading additional p7s
from the CM file.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3420 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-12-01T11:31:33Z,nawrockie
a8900944ca9919f37bcd1cd1508382cba7090fcd,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on dcmsearch pipeline. 

Made the pipeline more modular: cm_Pipeline() now calls three
functions: cm_pli_p7Filter(), cm_pli_p7EnvelopeDef() and
cm_pli_CMStage(). The motivation for this was to allow multiple p7
HMMs to be used as filters for a single CM.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3416 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-29T15:38:25Z,nawrockie
39f542be4d60df165ac27424e2bc755987a47083,Eric Nawrocki,eric.nawrocki@gmail.com,"o Still refining the dcmsearch pipeline:
  - reported survival fractions from each filter stage no longer
    include double counts of common residues from overlapping windows,
    previously they did.
  - experimenting with null3 corrections at each filter stage.

o dcmbuild.c:
  Introducing dcmbuild, a 'development' version of cmbuild. This
  version builds, calibrates and stores E-value parameters for P7 HMMs
  for the CM being built. This increases the run time of the program
  significantly, most of which is spent calibrating glocal forward
  which is necessary for the domain definition stage of dcmsearch.
  These simulations will probably eventually go into cmcalibrate, but
  it was presently easier to put them in cmbuild.

o rmark/x-nhmmer: we can now do a positives-only benchmark for nhmmer.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3412 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-18T14:29:47Z,nawrockie
86a56e5c34e9a0766fdd9e0b9d7e99a0763f7b3b,Eric Nawrocki,eric.nawrocki@gmail.com,"Small bug fix, with --tfile test seqs numbering was bogus.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3406 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-10T12:13:18Z,nawrockie
2eae1d309c48c8c5388a569d6a5a5022354f6d07,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on new search pipeline in dcmsearch.c.

Glocal P7 HMM exponential tail stats are now calc'ed for target
sequences generated by the genome-like 5-state HMM used by
cmcalibrate, instead of iid. 

I'm about to start developing a new cmcalibrate called 'dcmcalibrate'
that will calibrate HMMER3 P7 HMMs, abandoning calibration of CP9
HMMs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3404 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-09T10:22:01Z,nawrockie
bb582a034a4cf542112f929a90b9a245d321898c,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added --tfile <f> option to rmark-create that creates alignments
  with train/test sequences renamed and in a special order. These are
  meant to facilitate inspection of rmark3 false negatives (positives
  sequences not recognized as homologs) in their aligned context to
  hopefully identify failure modes of infernal. This feature was
  requested by Tom.

o Test sequences are now ordered differently - based now on the order
  they appear in the input alignments. Previously the order was
  dependent on the cluster the test sequences belonged to prior to
  removing redundancy from the candidate test set. It was difficult to
  reproduce the exact numbering from this scheme for the --tfile
  output alignments, so it was changed. Unfortunately, this
  modification changes where the test sequences get embedded in the
  benchmark, so it could slightly change benchmark results (albeit
  very subtly).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3403 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-08T15:08:54Z,nawrockie
e61e44a234720e6c19be1cb5143970ccc870f46c,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed extra space in makefiles that Mac OS/X can't handle.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3401 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-05T20:14:31Z,nawrockie
2bfb48492b6bdb0f1999f092d7f3aabc09dd0cac,Eric Nawrocki,eric.nawrocki@gmail.com,"o impl_sse library is now linked


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3400 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-05T20:13:04Z,nawrockie
7929839a11179ffc07a9b2b5cd1fd08e396bdf03,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on dcmsearch pipeline.  

New defaults: F1:0.30, F2,F2b:0.10, F3,F3b,dF3,dF3b: 0.02, F4:0.0005
with HMM banded Inside as default final stage with tau=5e-6 and QDB
CYK filter as default with beta=1e-9. These were all optimized based
on performance on the rmark3 benchmark, as logged in
~nawrockie/notebook/10_0924_inf_cmsearch_nhmmer/00LOG.

Minor changes to rmark scripts.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3399 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-05T19:27:46Z,nawrockie
6db60c5eb718ba0d7202a520e23d29409ba7b672,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on refining the nhmmer-accelerated pipeline in
dcmsearch. This revision introduces several options that may or may
not survive.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3394 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-11-01T19:02:41Z,nawrockie
234ca6480c4589dd4d4908f35abb1e489d0af269,Eric Nawrocki,eric.nawrocki@gmail.com,"Still developing dcmsearch:

cm_pipeline.c: fixed bug, I wasn't reconfiguring non-optimized profile
	       for length of window 
cm_mx.c, structs.h: changed <ncells> counter of DP cells in CM_HB_MX data
	            structure from int to int64_t
cm_dpsearch.c: cosmetic changes
cm_p7_domaindef.c: minor changes
dcmsearch.c: added some experimental and probably temporary options


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3390 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-10-21T15:33:36Z,nawrockie
9f8586981adf7c05b076b9f22dad82529b5450fd,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on dcmsearch development.

dcmsearch.c: CP9 HMMs are now being configured locally, prior to this
	     they were glocally configured in error.

cm_mx.c: Fixed lower bound on d when reporting banded HMM hits.

hmmband.c: Calls to CP9_Backward() in cp9_Seq2Bands() were incorrectly
	   specifying that j must be the hit endpoint (which is true
	   when bands will be used for alignment in cmalign). This bug
	   was introduced since the last release (ssu-align-0.1) and
	   is fixed here (I decided not to log it in BUGTRAX b/c it
	   doesn't exist in any released versions).

cm_dpsearch.c and cm_pipeline.c: removed debugging print statements.

	   

xref: ~nawrockie/notebook/10_0924_inf_cmsearch_nhmmer/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3385 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-10-20T14:43:01Z,nawrockie
d852492c81c6ad2aae0e1dfe6d58aacb391eff43,Eric Nawrocki,eric.nawrocki@gmail.com,"Large commit that introduces a new, temporary executable: dcmsearch,
(development cmsearch) which will probably end up replacing the
current cmsearch. dcmsearch is based on nhmmer/hmmsearch from hmmer3.

Changes to the Makefile.ins were necessary to get dcmsearch to build.

New files cm_pipeline.c and cm_p7_domaindef.c are based on
p7_pipeline.c and p7_domaindef.c, respectively. cm_p7_domaindef.c will
probably be renamed or removed (probably after moving its functions
somewhere else) in the future.

cm_pipeline.c: implements a modified version of
p7_Pipeline_LongTarget() that uses hmmer search functions as well as
CYK as filters for the final Inside scoring algorithm.

cm_p7_domaindef.c: implements a glocal version of hmmer's
p7_domaindef.c::p7_domaindef_ByPosteriorHeuristics() that can take a
glocal unihit configured HMM. The hmmer version cannot b/c it uses
optimized matrices, which can only be used with locally configured
HMMs. 

p7_modelmaker.c: CP9_to_P7.c was added, which creates a P7 HMM from a
CP9 HMM.

Other files (cm_io.c, cm.c, cm_modelconfig.c, hmmband.c and
cmsearch.c) were trivially modified, to remove defn of unused
variables, pretty-up comment formatting and fix typos. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3383 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-10-19T10:53:25Z,nawrockie
bec76cc85516a0bcb0d7f13fb869eb89b69afe66,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged in BUGTRAX, bug i22. This bug was causing the
improper calculation of the null3 penalty for hits returned from the
two HMM banded scanners: cm_dpsearch.c::FastCYKScanHB() and
cm_dpsearch.c::FastFInsideScanHB(). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3382 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-10-19T10:36:05Z,nawrockie
518b65184b57564f425532da800107f4e72f59d1,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added --mer option to rmark-rocplot.c which overrides its default
  behavior of printing an xmgrace xydydy plot of ROC curves and
  instead prints mean MER for all bootstrap samples.

o Fixed a bug in rmark-rocplot.c that allowed more than one hit
  between the same query and target to be considered positives.  This
  was skewing all results from cmsearch benchmarks: about 20 such hits
  occur in a typical cmsearch benchmark of rmark3.  (Although the extra
  20 seems to have been pretty consistent across most cmsearch
  variants, which means comparisons of different options combinations
  of cmsearch were mainly fair). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3377 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-10-01T14:34:22Z,nawrockie
a79715e5a0d48a3001265ba885cf6bf9b78abc81,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated some rmark scripts.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3376 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-30T15:12:42Z,nawrockie
a0dd802e7f52363c98b118fe4dc35dd73fef5108,Eric Nawrocki,eric.nawrocki@gmail.com,"o Changed how match/insert columns are defined in the input alignment
  to cmbuild. Columns in which >= <gapthresh> of the *weighted*
  aligned sequences are nongaps are matches, others are
  inserts. Previously, gap frequency was calculated using raw, not
  weighted, counts from the alignment. This change makes cmbuild more
  consistent with HMMER3's hmmbuild.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3375 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-29T18:05:58Z,nawrockie
a59e3514f12ea91f8f53e089a10d89322a898121,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added --nfile <f> option to rmark-create, which saves the benchmark
  database _without_ the embedded positive test sequences to file <f>.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3371 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-22T17:49:06Z,nawrockie
19c74b4c47cc60deefd4c878add3c412a05012f4,Eric Nawrocki,eric.nawrocki@gmail.com,"Two important changes:
1. Changed the default prior to the 'p33' prior, which improves
   performance on the rmark3 benchmark over the old default prior. The
   old default prior from versions 0.56 through 1.0.2 can be used with 
   the --p56 option to 'cmbuild'. 
    Xref: ~nawrockie/notebook/10_0722_inf_prior_reestimation/
          ~nawrockie/notebook/10_0830_inf_rmark3_again/
          ~nawrockie/notebook/10_0913_lm/

2. By default, the prior probability of the null3 model is now 1/65536
   (1/2^16) instead of 1/32. This lessens the severity of the null3
   correction, and achieves optimal performance over choices of prior
   probabilities for null3 on rmark3 given the new prior, a feature of
   the new prior which makes it 'better' than the old one, in my
   opinion. 
   Xref: ~nawrockie/notebook/10_0722_inf_prior_reestimation/

To achieve (2), a <null3_omega> value has been added to the CM data
structure, which is the prior probability of null3. This allows models
built with Infernal v1.0rc1->1.0.2 that use the old prior to have a
null3_omega of 1/32, and for those built with the new prior to be
1/65536. <null3_omega> is now stored in the CM file. For models built
with 1.0->1.0.2, it is absent, in which case it is set as 1/32.
Analagous changes have been made for a <null2_omega> value, the prior
probability of the null2 model, but null2 is current not used by
default.

Though the improvements on the benchmark seem to warrant the new
prior, all of these changes were structured to be easily reverted if
future experiments/observations suggests the old prior should not be
changed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3366 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-17T11:46:56Z,nawrockie
e87be2c29870c61ffc6d9d0c9627cd844a03c0a1,Eric Nawrocki,eric.nawrocki@gmail.com,"After _this_ revision, rmark code is in the exact state used to
generate the ROC curves for my 09.14.10 lab meeting. All of those ROCs
can be regenerated with the commands: 
'do-symlink.sh; sh do-all-pp.sh; sh make-rocs.sh'.
From ~nawrockie/notebook/10_0913_lm/roc_plots/.
The do-symlink.sh call symlinks rmark-2 and rmark3 results from
~nawrockie/notebook/10_0623_inf_rmark3/ and
~nawrockie/notebook/10_0830_inf_rmark3_again/. 
My intention is not to modify either of those notebook dirs any more,
to ensure potential reproduction of the ROCs.
See 00LOGs in the 3 notebook dirs above for more details.

Changes in this revision:
Modified rmark-Rroc.pl so it can handle rmark-rocplot xy output that
does not include error bars (generated with rmark-rocplot -n, for
example). 

Modified rmark-pp.sh so it prints ROC curves with default axis ranges.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3365 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-16T14:09:41Z,nawrockie
e27dbe5d1ae75ded6001d29fafbd7f4d38ea69f9,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor adjustments to behavior of these three scripts.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3363 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-13T17:11:14Z,nawrockie
3e3c53c1af40b7df4c885a2160fdfd7bd0bca92b,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated all benchmark drivers so overlapping hits are removed prior
  to definition of positives and negatives. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3362 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-13T15:15:38Z,nawrockie
eb64ca3f85f3314154fd05acfdd068f4389ffa63,Eric Nawrocki,eric.nawrocki@gmail.com,"BLAST rmark drivers now report running times.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3361 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-13T12:35:45Z,nawrockie
91c138e3a27c739d56e15847b1a5d9203b4efc29,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated several rmark scripts/drivers.

Added x-wublast, x-blastn, x-blastall, x-rfamscan: benchmark drivers
for 3 flavors of BLAST and for the specific WU-BLAST filtered cmsearch
strategy used by Rfam (at least for releases 9.0 through 10.0).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3360 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-13T12:21:15Z,nawrockie
0dd5630be5e0e12b7acfce8025dd50174cecf55d,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed rmark-create to work properly with --iid, for generating
benchmark sets with iid background sequences into which positives are
embedded.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3359 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-09-08T13:33:59Z,nawrockie
e351c623310ced2e96b0acded6bc2a649d7c71c3,Eric Nawrocki,eric.nawrocki@gmail.com,"All changes were required for the new --eset <x> and --eminseq <x>
options in cmbuild. Also, the default 'sigma' parameter for defining
the minimum total entropy for a model was revised to 45.0, and is now
consistent with the current HMMER's hmmbuild. Sean's cross-reference
for this is J5/36. 

--eset <x> defines the effective sequence number as <x>. This is
  analogous to the same option in hmmbuild.

--eminseq <x> defines the minimum effective sequence number as
  <x>. Currently, by default this is 0.1, but I may raise it. There is
  no analog in HMMER b/c as the effective sequence number approaches
  0., the mean match state relative entropy decreases (generally), but
  with CMs, a effective sequence number of 0 means the prior supplies
  all counts and the default basepair prior has quite a bit of
  information in it, favoring Watson-Cricks for example (unlike a
  marginalized primary sequence-only prior).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3358 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-31T20:00:42Z,nawrockie
1e4fd61210876b511c68be03d6034bc6ec5577a1,Eric Nawrocki,eric.nawrocki@gmail.com,"Added the default 15 state fully connected HMM used to generate the
rmark3 nonhomologous sequence. 

Updated 00README for rmark.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3357 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-31T15:11:01Z,nawrockie
8430cdad97bbfb54b60fc81df6a4f54a975d1361,Eric Nawrocki,eric.nawrocki@gmail.com,"rmark-create now reads an HMM file and uses it to generate the
background sequence for the resulting rmark benchmark. This is default
behavior, the old behavior of shuffling an input database, such as
RFAMSEQ is enabled with -S. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3356 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-30T18:28:02Z,nawrockie
7938831f4755dd195e4806ce055bef41efe95f2e,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated rmark scripts. Revisions include many minor cumulative
changes, some of which are explained in
~/notebook/10_0623_inf_rmark3/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3355 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-30T12:40:50Z,nawrockie
ae1c3dfc7950c53de52c1b9d45f903137ecb9da8,Eric Nawrocki,eric.nawrocki@gmail.com,"Renamed default.pri to default.prior and fixed its formatting. Somehow
it wasn't in the valid format and couldn't be read by cmbuild.

Added plus1.prior, a simple LaPlace plus-1 prior.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3343 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-10T15:30:48Z,nawrockie
705d8a7489095e67a639129bbd1afd595112e30f,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated sse_cmsearch_mod.c so it prints useful output for new rmark
benchmarking script.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3342 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-10T15:29:39Z,nawrockie
1dd403768d09c210b8d8128020b2adeee3411799,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor fixes: 
cmalign.c: made --banddump option incompatible with --nonbanded. 
cmsearch.sqc and cmalign.sqc no longer test the deprecated options
--sseq and --eseq.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3339 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-05T13:28:53Z,nawrockie
03f7c87a32c0ad5057a5b958ca73e1ae78793cb0,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug i21 and logged it in BUGTRAX. The bug involved converting
probabilities to scaled integer log_2 odds scores
(cp9_modelconfig.c::Prob2Score()). The minimal valid probability that
could be converted was 5e-9 (the value of eslSMALLX1); anything lower
was returned as -INFTY. This minimum was way too high and disallowed
the use of very small tau values (amount of probability mass excluded
from bands during target-dependent HMM band construction), and it is
now about 1-e44. See BUGTRAX for more details.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3338 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-05T13:27:30Z,nawrockie
373d94cfa19d463a78fa8688cff4e9351f13158e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed three bugs reported by Stefan Janssen from Robert Giegerich's
group. These were all related to the balancing of left and right
subtrees under bifurcation states during guide tree construction in
cm_modelmaker.c::HandModelmaker(). Analogous fixes apply to
cm_modelmaker.c::ConsensusModelMaker(). The first bug is i19 in
BUGTRAX. The second and third are collectively bug i20. See BUGTRAX
for more details.

xref:~nawrockie/notebook/10_0804_inf_cmmodelmaker_bug_steffen/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3337 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-08-04T19:15:35Z,nawrockie
9134b349bdf925b0a2ecda08f1cee63ac0dd5038,Eric Nawrocki,eric.nawrocki@gmail.com,"Added sse_cmsearch_mod.c with modifications by me (EPN) to make it
convenient to use with the new rmark benchmark. For example, I added
an option to abort after the first stage MSCYK filter, which will make
it possible to use as a filter for normal cmsearch inside a benchmark
driver. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3332 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-07-21T12:35:18Z,nawrockie
5e5f32cd0f3d74982b85f9e129be4d7e8800fc73,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on rmark scripts/programs.
Added x-nhmmer2cmsearch which drives a nhmmer-filtered cmsearch
benchmark.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3331 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-07-19T12:27:28Z,nawrockie
7dcebda06ef0614bec2f501f0afaea7f91f7e379,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated rmark. Added 00README by modifying H3's profmark 00README.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3330 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-07-14T14:36:38Z,nawrockie
b102379ed1af4818001050d28760987527531515,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated rmark-rocplot.c. Added rmark/00README, but it is still a work
in progress. Main purpose of commit is so I can get an up-to-date local
copy on my laptop for the Boston ISMB trip. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3328 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-07-09T15:37:44Z,nawrockie
d82234ad2fff05b4998a6c1482611c0dc9b1f143,Eric Nawrocki,eric.nawrocki@gmail.com,"Introduced rmark/ as a subdirectory within the top-level infernal/
dir. rmark is modeled after HMMER3's profmark. 

The main important difference between profmark and rmark is that
profmark is a benchmark of many protein-length sequences, either real
positives embedded in short flanking regions or decoys, and rmark is a
benchmark of several chromosome length DNA/RNA sequences which are
mostly noise with >= 0 real positives embedded within them.

Most required scripts are included here. A 00README and other
important files will follow in future revisions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3327 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-07-09T15:06:53Z,nawrockie
f86fb2e8918bc9355b8dcb97474737653fdefd49,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a typo in the esl_getopts definition of the developer (hidden)
option --fil-finE-qdb that prevented it from being set. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3326 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-07-09T14:59:38Z,nawrockie
9777efc7dc0d0e8158ce67cea11f7f17ad67bff5,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch.c and cmcalibrate.c:
Added --Wchunk <n> option (requires --mpi) which specifies the chunk
size be <n>*W. Each target sequence is split up into chunks and each
chunk is searched by a different processor. By default, the chunk size
is determined based on both W and the number of processors
running. However, since chunk size affects the final results this led
to slightly different results when different numbers of processors
were used (slightly different; because of differences in overlap
resolution that are dependent on where the sequence is split up). With
--Wchunk, cmsearch and cmcalibrate give identical results in MPI mode,
regardless of the number of processors used. However, the results will
still differ from serial (non-MPI). 

This optional behavior may become default in the future. I may also
introduce a change that makes serial and MPI reproducible. I only hold
off now because I think it requires splitting up the target into
chunks in serial mode, which is currently not done.

Bugs/BUGTRAX: updated revision number that fixes i18 bug, it was
incorrectly written as 3219. It is now correct - 3220.

cmalign.c: removed unused varible that caused a -Wall warning.

documentation/: --Wchunk option documentated.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3321 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-23T13:05:07Z,nawrockie
b55ef839d9e9c6a8c939da988509616e2e68db8f,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug i18, logged in Bugs/BUGTRAX. Description from BUGTRAX
appended at end of this log. 

cp9_dp.c: All HMM scanners (cp9_Viterbi(), cp9_Forward(),
cp9_ViterbiBackward() and cp9_Backward()) now take a new argument:
<hit_len_guess> which is a guess at the length of HMM hits found. This
is necessary b/c those scanners determine scores for only end points
(cp9_Viterbi(), cp9_Forward()) or start points (cp9_ViterbiBackward(),
cp9_Backward()) and 'guess' at the start/end point. Later a DP
algorithm running in the opposite direction is used to determine the
actual start/end point that was guessed at, but the initial guess is
important for resolving overlapping hits prior to the DP in the
opposite direction. Previous to this revision, the hit length was
guessed to be W, but now it is guessed to be avglen, the average length
of a hit to the model. In anecdotal cases, this fix allows the HMM
filter stage to allow two adjacent hits to survive whereas previously
only one would (xref: ~nawrockie/notebook/10_0614_inf_repro_mpi/00LOG).

All other functions were modified only to be consistent with the new
cp9_dp.c function prototypes.

Bugs/BUGTRAX i18 entry:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ID              i18
TITLE		HMM hit lengths
STATUS          CLOSED
XREF            See ~/nawrockie/notebook/10_0614_inf_repro_mpi/00LOG
REPORTED_BY     EPN
CLOSED_DATE     EPN, Wed Jun 23 06:40:01 2010
DESCRIPTION    

HMM scanning in Infernal consists of two rounds, a 'forward direction'
round where likely end points (j) of hits are determined, and a
'backward direction' round where likely start points (i) for each hit
ending at (j) are determined. Importantly, overlaps are removed after
the 'forward direction' stage, which requires a guess at the start
points (i_guess) for each end point j. Bug i18 is that this guess was
set as i_guess = j-W+1, which had unintended and previously
unrecognized implications on which exact hits would survive and
specifically removed one of two adjacent high-scoring hits in some
cases (when both should have been kept and survived the filter). See
~nawrockie/notebook/10_0614_inf_repro_mpi/00LOG, specifically the
Glycine riboswitch example explored on June 22, 2010 for details and
LMEN1-p22 (my lab notebook) for an example.

The fix is to change how i_guess is calculated to: iguess = j-avglen+1
where avglen is the average length of a hit generated by the model (as
calc'ed in cm.c::cm_GetAvgHitLength).

This fixes some anecdotal cases where one of two adjacent hits were
being thrown out by the HMM filter - now they are both found (again,
see ~nawrockie/notebook/10_0614_inf_repro_mpi/00LOG).

The bug fix has virtually no impact on RMARK2 benchmark performance,
but it does speed up that benchmark by about 20%.

This bug was fixed as of svn revision 3319.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3320 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-23T11:01:10Z,nawrockie
b580a704bd7ba02fc74698e4f7574914fa9d79c5,Eric Nawrocki,eric.nawrocki@gmail.com,"o Modified the prototype for cp9_dp.c::cp9_ViterbiBackward and
  cp9_dp.c::cp9_Backward(). New variable: j_is_fixed, if TRUE this
  tells the function to force parses to end at j0. This is a step
  towards making cmsearch/cmcalibrate results completely reproducible
  for different number of MPI processors.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3318 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-17T18:06:48Z,nawrockie
b56f70a55d9e22ed462ef309ce54a53540209e78,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed BUGTRAX bug i17: a NULL3 correction was not being applied by
cmalign when --viterbi was used; now it is, unless --no-null3.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3310 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-17T12:43:13Z,nawrockie
4833e7d0b8f14b8745b168f1610ebc75dd75aa3e,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed BUGTRAX bug i16, an error in the Backward Viterbi implementation
for CP9 HMMs in cp9_dp.c::cp9_ViterbiBackward(). In rare cases,
match/insert emission scores were not being added for node M, or
internal nodes when transiting to E state. The bug is logged as i16
in BUGTRAX but no simple script is included to reproduce it (partly
b/c it never causes any program to crash). An independently compilable
program for running cp9_Viterbi() and cp9_ViterbiBackward() was added
to the end of cp9_dp.c during the course of debugging, and left there.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3309 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-17T12:32:47Z,nawrockie
5188c11811e765ca05f7eab6fe2a981373c8094f,Eric Nawrocki,eric.nawrocki@gmail.com,"o SIMDFLAGS were not being used to compile testsuite programs, now
  they are in testsuite/Makefile. This was preventing compilation of
  the tste programs Linux PPC.
o MPILIBS were not being defined and used in the testsuite/Makefile.
  Now they are consistent with how src/Makefile uses them.
o Made inclusion of ""esl_config.h"", ""p7_config.h"", and ""config.h""
  at top of all testsuite/*.c files consistent that in src/*.c files.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3307 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-11T11:27:47Z,nawrockie
d670d54dcd5c79d158ff3d1607b2ec170e31e751,Eric Nawrocki,eric.nawrocki@gmail.com,"configure now checks for sys/sysctl.h and sys/endian.h, which easel
checks for, but infernal was not. This is important because the design
is for a single ./configure in Infernal to suffice for hmmer and
easel subdirs, and it was preventing compilation of easel within
infernal on PPCs running Apple OS/X.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3306 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-10T17:28:45Z,nawrockie
cea4dd0a5841f2cce4aba8819d14435e6b4741e5,Eric Nawrocki,eric.nawrocki@gmail.com,"Slight change to 'make' in hmmer/, CC and CFLAGS vars are now set on
the command line, to be consistent with the 'make' in src/ and easel/.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3305 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-10T15:10:57Z,nawrockie
01509b303c3d2f08c948f8b89bb1f10ae8d93cd8,Eric Nawrocki,eric.nawrocki@gmail.com,"o This revisions fixes a bug (thanks to Michael) related to using
  hmmer as a subdir within infernal revealed during testing on a
  PowerPC Linux (cf-ppc.int.janelia.org):

  p7_modelmaker.c: was not including 'config.h', now it is. Without
  it, HMMER was turning on large file support, but Infernal was not.
  This caused the size of off_t to be different b/t Infernal and HMMER
  and consequently the size of a P7_HMM object was different in HMMER
  functions versus Infernal functions, which was bad.

  I went through all infernal/src/*.c files that are compiled and
  made them consistently use the same first 3 include statements iun
  the same order:

  #include ""esl_config.h""
  #include ""p7_config.h""
  #include ""config.h""

  in an effort to avoid similar problems in the future.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3304 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-10T14:56:21Z,nawrockie
d23e9f45da4b8c6b6eb9039b90d967cb473aa5c2,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed unnecessary include statements for SSE-headers: xmmintrin.h
and emmintrin.h. These are appropriately included if nec by Diana's
src/impl_sse/impl_sse.h.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3303 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-10T11:03:47Z,nawrockie
bf71248602984c5eae71107ac98515dd7aa107ef,Eric Nawrocki,eric.nawrocki@gmail.com,"Added url.sty, so userguide can (hopefully) always be built from
source in a distro.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3295 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-09T13:05:44Z,nawrockie
8a070696582078438df48b49640f6c0a94418459,Eric Nawrocki,eric.nawrocki@gmail.com,"o I had missed a few htmladdnormallink{}'s in the previous
revision. These are now all converted to url{}.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3294 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-09T12:56:31Z,nawrockie
5cb757ef23d2a7a46263dc77e87634735ee8ecb9,Eric Nawrocki,eric.nawrocki@gmail.com,"Replaced htmladdnormallink{} macro with url{} so Infernal's user guide
is consistent with HMMER and Easel. This way we don't need html.sty.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3293 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-09T12:54:13Z,nawrockie
63bae2e92153cb464c4155de47bf3a93a85ae41f,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added note to COPYRIGHT explaining that infernal includes Easel and
  HMMER and that easel/ and hmmer/ both have their own COPYRIGHT and
  LICENSE information. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3292 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-09T12:06:56Z,nawrockie
275caf84b7a36f7a1936aae7ae91240c7df2416b,Eric Nawrocki,eric.nawrocki@gmail.com,"o Removed unused variables to silence compiler warnings.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3290 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-08T21:09:24Z,nawrockie
d6a5272f2ffa1ff00a11c963ffce8acfd2d48582,Eric Nawrocki,eric.nawrocki@gmail.com,"configure.ac, Makefile.in:
o Renamed PACKAGE_* variables/preprocessor symbols to INFERNAL_*,
  using HMMER as a model. This allows Infernal executables to be
  a different version than a toplevel package that bundles Infernal,
  e.g. version ""s0.1"" for SSU-ALIGN 0.1. Prior to this change,
  Infernal executables were necessarily version ""0.1"" when built
  underneath SSU-ALIGN 0.1. 

src/*:
Replaced all occurences of PACKAGE_* mentioned above with INFERNAL_*.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3289 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-08T20:49:16Z,nawrockie
af45def534304c93d854557307804b7b107bc685,Diana Kolbe,diana.kolbe@gmail.com,"Preparing a snapshot release to accompany Diana's thesis.

Bugfixes:
- memory leak in DegeneratePairScore() in alphabet.c
- unused variables in truncyk_check.c

Release prep:
- new model in testsuite for backwards compatability testing
- updated copyright dates in configure.ac and COPYRIGHT
- added sse_cmsearch and cmsearch_dual manpages to User Guide



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3288 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-08T17:57:12Z,N/A
7d29a52d45f4eaa9367552bf6b5f7bc7e0b562f3,Diana Kolbe,diana.kolbe@gmail.com,"Minor changes to silence compiler warnings.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3287 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-08T15:39:36Z,N/A
479dbaaf6924a4aaa77bab62e9d7e3b60746259c,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign.c:
Made the --p7 option only visible with a --devhelp.

my_p7_msvfilter.c:
Fixed one line in this code which was written about 18 months ago (!)
for experimental H3-based P7 banding, here's the svn diff:

-      } else if (esl_FCompare(P7XMX(i,p7G_J), P7XMX(i-1,p7G_E) + tec, tol) == eslOK) /* note: P7XMX(i-1,p7G_E) differs from Viterbi traceback, where it's P7XMX(i,p7G_E), not sure why */
+      } else if (esl_FCompare(P7XMX(i,p7G_J), P7XMX(i,p7G_E) + tec, tol) == eslOK) 

This was preventing --p7 from working at all in cmalign. This change
is largely irrelevant because --p7 is an experimental option that
isn't even listed with a -h (but it is listed with a --devhelp). For
SSU-ALIGN it is completely irrelevant because that package never uses
P7 banding. The plan is to use P7 banding in future releases of
SSU-ALIGN and possibly cmalign. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3286 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-08T10:34:00Z,nawrockie
0b40967542e80b1eaf0a99fd4b6d213dfb6ee1b4,Diana Kolbe,diana.kolbe@gmail.com,"Performance optimizations for CYKFilter_epi16()
 - inlined a few utility functions (moved definitions to header)
 - switched loop order for many loops over both dp and yoffset
 - enclosed a debug-only function with ifdef/endif

Combined changes move this 8x parallel function
from roughly 2.5x speedup over scalar (!) to
roughly 6x speedup, which is still notably worse
than the 8x observed in previous testing - some
bugfixes since then do increase computation, but
there's expected to be a fair bit of optimization
still possible.  May improve anecdotal times on
sse_cmsearch.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3285 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-07T19:56:11Z,N/A
fa8730dda39d214f6a38c0350d3204b3903631da,Eric Nawrocki,eric.nawrocki@gmail.com,"Makefile.in: removed 'ssu' build target which renamed Infernal
binraies by adding a 'ssu-' prefix when building Infernal for the
SSU-ALIGN package. This is now handled by the toplevel SSU-ALIGN
makefile, which I think is better - Infernal shouldn't need to know
about SSU-ALIGN to be used within it.

Removed testsuite/ssu-exercises.sqc which run a specific set of tests
for the SSU-ALIGN package. This file has been relocated to the
SSU-ALIGN/testsuite/.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3284 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-07T11:51:13Z,nawrockie
9c4e1f594361e134ce4fb5d8aed19ce7b09166ba,Eric Nawrocki,eric.nawrocki@gmail.com,"Added ssu-exercises.sqc which includes exercises relevant to the
SSU-ALIGN package. It only gets used during a 'make' from a toplevel
ssu-align/ dir.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3283 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-03T17:23:55Z,nawrockie
bcf13956c4dc81a0809231d9639479fd3089398c,Eric Nawrocki,eric.nawrocki@gmail.com,"o Modified only the 'ssu' target of 'make'. With a 'make ssu', which
  is called by the toplevel SSU-ALIGN directory, all infernal programs
  are now renamed (e.g. 'mv cmsearch ssu-cmsearch'), instead of only
  cmsearch and cmalign.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3282 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-02T17:26:36Z,nawrockie
710812c031442702f1f31ad1dc85daa5ee3dfdc6,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added missing variable definition for 'nseq_to_read' in
  mpi_master. This was preventing compilation in MPI mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3281 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-06-02T17:18:05Z,nawrockie
347fe6ef2625b1e5f95aa24292a1c440e6f0ca1f,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated configure.ac so it defines a new variable:
@HMMER_ESLDIR@, which is hard-coded as ""../easel"". This variable tells
HMMER (which is infernal/hmmer) where easel is (which is
infernal/easel). This differs from where easel is relative to HMMER
when it is built in its normal standalone mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3280 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-26T18:14:36Z,nawrockie
d6ae0d4d177a0289118a4a17542a1ffe649ef8be,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with insert file output (--ifile). The model name and
consensus length was being printed for each alignment chunk of 1000
seqs, instead of just once at the beginning of the file.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3278 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-25T17:01:35Z,nawrockie
e37d3edade746acb4205eca34ef514e2d59b7bb7,Diana Kolbe,diana.kolbe@gmail.com,"Minor clean-up of source code for SSE pipeline version of cmsearch



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3275 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-24T20:22:01Z,N/A
46c9fc5334f77780a1f369c32dc8c998413d1521,Diana Kolbe,diana.kolbe@gmail.com,"Man page for cmsearch_dual script



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3265 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-04T15:01:30Z,N/A
11116436bd413de5b933a1147f15e9355350aee6,Diana Kolbe,diana.kolbe@gmail.com,"Help message for cmsearch_dual pipeline combination script



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3264 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-04T14:54:07Z,N/A
9c1b493ee8d7dc1396ac4cd3b4f1be8aa1e0a924,Diana Kolbe,diana.kolbe@gmail.com,"Manpage for sse_cmsearch



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3263 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-03T20:52:34Z,N/A
abef635421d022e9c1fe3f4fe497b6822dcda7ca,Diana Kolbe,diana.kolbe@gmail.com,"Install, man, clean, and distclean targets for impl_sse



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3261 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-03T20:08:36Z,N/A
9fcdefdc2477c3d41df740524969003223eeea32,Diana Kolbe,diana.kolbe@gmail.com,"Rename on parallel pipeline script to drop the .pl suffix



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3260 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-03T20:07:41Z,N/A
b32a4aa0fe7561874b20283ce4bf1679ce68f102,Diana Kolbe,diana.kolbe@gmail.com,"Automatic configure and build support for impl_sse.
Uses SSE2 checks from HMMER3.  If SSE is found, supported,
and not explicitly disabled (--enable-sse=no),
@DO_IMPL_SSE@ in the main make file becomes
(cd src/impl_sse; make)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3259 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-05-03T19:53:18Z,N/A
bfce74d9710fc2bf3d0f97a8c96144c6db7096ef,Diana Kolbe,diana.kolbe@gmail.com,"Replaced SSE implementation Makefile
with a Makefile.in, to be processed
by configure.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3255 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-04-30T14:56:26Z,N/A
cafd7c78a87ed8c509ee1a9a829e49bb90299652,Eric Nawrocki,eric.nawrocki@gmail.com,"Manually removed the {cmalign,cmsearch} --sseq <x> and --eseq <y>
functionality introduced in revision 3240, because of a minor problem
-- it didn't work at all. Using these options with <x> and <y> would
cause {cmalign,cmsearch} to begin at the <x>th sequence and end at the
<y>th sequence in an _alphabetically sorted list_ of sequence names if
an SSI file for the target file exists, as opposed to the <x>th and
<y>th sequences in the target file (which is how I intended the
options to work). This is, of course, because SSI files sort sequences
by their name for fast retrieval given a name, not by their index in
the file.  This realization renders --sseq and --eseq useless with
SSI.

If SSI is augmented in the future to somehow store the sequences in
order, the code I reverted in this commit might be useful. See 
/groups/eddy/home/nawrockie/notebook/10_0322_ssualign_auto_merge/00LOG
for paths to backup copies before this revision. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3251 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-04-05T19:07:19Z,nawrockie
9ea1b16186302ec43521532439e6bb28736c3dde,Diana Kolbe,diana.kolbe@gmail.com,"New default (recommended) settings for sse_cmsearch
Stage 2 cutoff: p-value 1e-05
Stage 3 cutoff: e-value 1

Additionally:
- wording on options changed to be more clear on whether
  particular cutoffs are p-value or e-value based
- adjusted variable names to reflect p-value vs e-value
- commented out SearchInfo set-up, since current implementation
  doesn't use DispatchSearch()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3248 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-31T13:47:15Z,N/A
de6079a1775f946357d5740db2480042164e8425,Diana Kolbe,diana.kolbe@gmail.com,"sse_cmsearch.c: change in default setting for stage one filter,
from 1% database passing to 2%.

Initial commit of cmsearch_dual.pl, a perlscript which runs
default Infernal filters and SSE structure-based filters in
parallel, collects the union of hits from the two sets, and
re-aligns/re-scores for a unified hit list.
- accepts -Z <x> to set the effective database size in Mb
- requires cmsearch, sse_cmsearch, and esl-sfetch, either
  in the user's path or in locations specified by -P, -Q,
  and -R options respectively.

Known issues:
- default settings for sse_cmsearch are not finalized
- calibration for mscyk still done per-search
- hits are reported as coordinates within coordinates
  relative to the orginal sequences
- moderate number of temporary files are created and not
  cleaned up; these will probably be eliminated once
  development has stabilized.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3246 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-29T19:35:28Z,N/A
5e0e86c593ff13d961a16d096d0a9181dd9ffebb,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_parsetree.c: fixed a printf of a int64_t with PRId64 (was using %d).

All other files:
- Added --sseq <x> and --eseq <y> options to cmsearch and cmalign that
  specify that the first and last sequence searched/aligned is <x> and
  <y>, respectively. To do this, I had to change the GetDBInfo()
  function prototype to take a <sseq> argument, so dbsize is correctly
  determined. This prototype change necessitated most of the changes
  besides those to cmalign.c and cmsearch.c. cm_io.c now has a
  PostionSqFileByNumber() function which repositions an sequence file
  to start at <sseq>, this was necessary (instead of just using
  esl_sqfile_PositionByNumber()) b/c I wanted it to work with or
  without SSI for the ESL_SQFILE.

NOTE: The --eseq and --sseq options in MPI mode have not yet been
      tested (because I'm having difficulty building with the hmmer3
      subdir with INTELMPI).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3240 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-26T18:29:51Z,nawrockie
6617fa419a065ff3e540ac88fcf427386e6c4ebd,Diana Kolbe,diana.kolbe@gmail.com,"sse_cmsearch.c:
Adds -Z option for setting database size; sets
effective dbsize in stats based on either seqfile
length or -Z option.

impl_sse.h:
removed 'inline' keyword from function declaration
to supress warnings.

sse_cm_dpsearch.c:
extra parantheses suggested by gcc warning



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3239 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-25T15:35:42Z,N/A
70b998c4ba5498cfb099980a31515d1caa3d051e,Eric Nawrocki,eric.nawrocki@gmail.com,"- Minor fixes to cmfetch man page, sqc exercises.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3238 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-22T18:24:40Z,nawrockie
40b68297ab7dd8bc543f3a6517c1dc9dc0210d2d,Eric Nawrocki,eric.nawrocki@gmail.com,"Added the cmfetch executable based very heavily on HMMER3's hmmfetch. 

src/cm_io.c: small change to expected .ssi index file, was foo.ssi for
	     foo.cm, now foo.cm.ssi is expected (which is what cmfetch
	     generates).

documentation/: Added minimal documentation for cmfetch


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3237 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-22T18:00:55Z,nawrockie
5e13297daaa600ce4f8fcf67a2b37e6829a92e43,Diana Kolbe,diana.kolbe@gmail.com,"Applies the edge-case bug fix from r3207 (found in 8-bit version)
to corresponding 32-bit version.  Bug was never observed, but
could have resulted in a segmentation fault when searching
extremely short sequences (e.g., L ~10).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3236 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-22T17:40:42Z,N/A
804235e6d57f5b83d45202ea13f9daa8c8dee8a7,Diana Kolbe,diana.kolbe@gmail.com,"Fixed logic in checking whether stage 2 score (16-bit) is
near saturation ceiling.  Old logic passed nearly all sequences
with positive score, regardless of specified threshold.
This change should improve running time, but will search on 
threshold parameters will need to be re-done.

Also commits a change from (scalar) DispatchSearch to (SSE)
CYKScan for stage 3.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3235 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-22T17:34:21Z,N/A
e3e23a431637735da903144eac3fe6743981bbdb,Diana Kolbe,diana.kolbe@gmail.com,"Pipeline changes for SSE-accelerated cmsearch:

Stage 3 reports e-values rather than p-values.

Stage 3 currently calls DispatchSearch() rather than
SSE_CYKInside().  DispatchSearch is configured for
CYKScan with null3 correction, and CYK alignment.
CYK scores currently seem to perform marginally better in
the rmark-2 benchmark than Inside scores (which is
surprising).  This may be due to the stage 1 consensus
filter enriching for things which have good CYK scores;
this behavior is also likely subject to change when/if
hits from the two pipelines are merged.

Current performance (see also ~kolbed/20100224-rmark/run8/):
MER:        174
MER_fp:     8
MER_fn:     166
MER_thresh: 0.00585383

MER statistics summed across all 51 families:
MER    (fam sum):     165
MER_fp (fam sum):     0
MER_fn (fam sum):     165

Sensitivity overlap vs. unfiltered and filtered Infernal 1.0:
0 0 0 119     0 0 1 1     0 1 0 2     0 1 1 1     1 0 0 10     1 0 1 11     1 1 0 35     1 1 1 271
codes are: {found unfiltered, found with standard filters, found with SSE pipeline, count}



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3208 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-05T19:35:28Z,N/A
ea02dba1d863746f10112f203c6e32b7129febb7,Diana Kolbe,diana.kolbe@gmail.com,"Enormous loop unroll for calculating bifurcation-type state.
Performance gains moderate at best - had seen ~20% improvement,
but fixing an edge-case bug has negated much of that.  Likely
target for future optimization.  Old (not unrolled) version
can be compiled with -D_DONT_UNROLL_BIF



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3207 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-05T19:07:53Z,N/A
1cf476150f95fe5d5ccda1c3ca37148bf2b3a904,Diana Kolbe,diana.kolbe@gmail.com,"Prototype change for CreateGammaHitMx_epu8:
pass base of number range (offset_zero)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3206 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-05T19:03:50Z,N/A
86051557a86c7eafbf979942d26b843f886002c6,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix for GammaHitMx_epu8:
when working with scaled and offset numbers,
initialization value for mx[0] (or mx[L])
should be base of number system, not literal 0.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3205 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-03-05T19:02:42Z,N/A
3bb182bcd952144cd0707e175b71eb27398a7cd3,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified format of output file from cmalign --ifile or --elfile.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3181 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-24T17:54:14Z,nawrockie
26a2546278d52e45cbd410f1e97c85f882f37ba5,Eric Nawrocki,eric.nawrocki@gmail.com,"Small modification to format of cmalign's --ifile and --elfile
optional output files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3180 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-22T16:55:27Z,nawrockie
daade870efcb3f9f478f4e089598667bd81a9389,Diana Kolbe,diana.kolbe@gmail.com,"impl_sse.h:
 - remove ccm->r, this is now replaced by ccm->bg->p1

sse_cmcons_mscyk.c:
 - change internal format of return score from short int to float
 - when merging hits, set score to the max of those included



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3174 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-16T15:05:05Z,N/A
c62346c8fc8bdcf417c0853a4f498b5abb27c72e,Diana Kolbe,diana.kolbe@gmail.com,"Major bugfix in CYKFilter_epi16:

Check for underflow in multiply that calculates
EL self-transition.

Symptom: for some seqs longer than ~700nt, observed
very high-scoring hit from CYKFilter_epi16, higher
than equivalent score from full scalar alignment,
but no hit at all passing sse_inside().  Reported
bounds for hit generally extend fully to edges of 
window provided by earlier pipeline stage.

Test case: from rmark-2, RF00009 vs chr3.  Original
seq (AF434764.1/1-252) embeddded 374989-375240 rc.
Correct hit returns 374989-375233 rc, bugged
behavior returns 374691-375426 rc.

Solution: score for EL self loop should always be
negative.  Check for scores > 0, mask, and re-set
to WORDMIN.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3173 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-16T14:57:54Z,N/A
edef50019c464d891d183ec559659e27a6338ac7,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign.c: Updated esl_msa_RegurgitatePfam() and
esl_msa_ReadNonSeqInfoPfam() to work with recently modified function
prototypes in easel.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3165 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-11T20:16:27Z,nawrockie
5cad6d269b3b14c8ed8b1e3218368c11230490c2,Eric Nawrocki,eric.nawrocki@gmail.com,"src/cmalign.c: relocated definition of 'char tmpfile[32] =
""esltmpXXXXXX"" for esl_tmpfile_named() to within CMFileRead()
loop. Otherwise esl_tmpfile_named() won't work the second time it is
called. 

Makefile.in and cmcalibrate.sqc: fixed some syntax errors.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3164 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-10T17:54:26Z,nawrockie
e9f85f97e87ad42bc80c46dd22a477c7b3289b1b,Eric Nawrocki,eric.nawrocki@gmail.com,"Brought infernal testsuite up to date with sqc.

Makefile.in and testsuite/*sqc:
Updated usage of sqc so it is consistent with recent changes 
as of r503 in easel trunk.

dev-exercises.sqc:
Removed this file because it is no longer used during a 'make
devcheck'. Instead, a 'make devcheck' calls sqc with each of the
cm*.sqc input files. 

cmcalibrate.sqc:
In an old revision (r3006) I incorrectly put cmcalibrate.sqc in the
top-level directory instead of testsuite/ when manually merging from
the 1.0 branch
(https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3163 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-10T17:26:35Z,nawrockie
3798fc0a44fe353606bcf324668efb56092331e8,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated esl_msa_RegurgitatePfam() calls to work with recently modified
prototype in esl_msa module.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3158 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-10T14:59:42Z,nawrockie
c8dd4eb4de3d3c191177cb0725de31650ae8a02f,Diana Kolbe,diana.kolbe@gmail.com,"Convert WORDMAX score to equivalant p-value
including bias-composition correction;
check whether actual p-value is close to this
saturation point so that we can pass sequences
regardless of whether they meet the actual
p-value threshold.

(The initial check when options are set only
checks score->p-value range for 50% GC; for
biased composition seqs, required score for
same p-value might be higher and thus out of
range.)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3157 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-09T21:45:18Z,N/A
b841611937c6b9cdcc15a0b4246957cbe1f2dda1,Diana Kolbe,diana.kolbe@gmail.com,"Major accumulated changes to SSE pipeline;
changes summarized by file below.

sse_cmsearch.c:
 - Use p-value rather than score cutoffs
   for stages 2 and 3, using GC-binned CM
   calibration
 - Bias correction filter following stage 1
 - Replace references to ccm->r with
   ccm->bg->p1 (both, bg model self trans p)
 - Create composition-based secondary null
   model
 - Stage '0' output - stage 1 hits before
   bias correction and window merging
 - Keep track of stage 1 scores in hit list
 - Calculate GC content of current hit 
   window, for look-up of appropriate
   EVD parameters
 - Change stage 3 output to p-value rather
   than bit score

impl_sse.h:
 - CCM_BG structure to store null model for
   consensus-only MSCYK model CM
 - Composition vectors for model segments
   (mcompo) and overal ccm (fcompo)
 - In GammaHitMX_epu8, store look-up mx in
   standard ints rather than 8-bit values,
   store scores and cutoff as floats (8-bit
   vector vals converted back to bitscores)
 - New functions for dealing with background
   model

sse_cmcons_mscyk.c
 - MSCYK_explen() changed to ccm_explen()
   and moved to cm_optimized.c
 - In GammaHitMX_epu8, store look-up mx in
   ints; scores and cutoff as floats
 - Enable non-greedy traceback (new default)
 - ResolveMSCYK() now takes cutoff as an
   argument, to eliminate hits that no
   longer pass threshold after bias 
   correction
 - Replace references to cm->r with cm->bg->p1

cm_optimized.c
 - In ocm (16-bit model), set beginsc for
   ROOT state to 0, so complete alignments
   don't need to be checked separately from
   alignments using local begin
 - In ccm_convert(), calculate model
   composition, weighted by usage of states
   in ccm fragments (not normal CM occupancy)
 - New function ccm_explen() replaces old
   MSCYK_explen(); also corrects calculation
   to reflect differentiation between segments
   which are or aren't E-terminal
 - New function ccm_SetCompo() sets overall
   model composition
 - New function ccm_bg_CreateUniform()
 - New function ccm_bg_NullOne() calculates
   the length-only null model, which is 
   explicitly used inside MSCYK.  Need to
   be able to calculate this portion of the
   score separately to calculate the score
   with the alternative null model
 - New function ccm_bg_SetFilter() creates
   the 2-state HMM alternative background
   model matching model composition
 - New function ccm_bg_FilterScore()
   calculates the alternative null model
   score for a potential hit

sse_cm_dpsmall.c
 - Test changes to CYKFilter_epi16();
   score hit segment only, rather than
   as a score for the complete window;
   break score ties in favor of new
   values (larger d and/or larger j)
   Attempting to get more accurate hit
   boundaries from stage 2, since stage
   3 operates under a global alignment
   model

sse_cmcons_hitmx.c
 - Type changes for mx, scores, and cutoff
 - check d against j to prevent bounds
   errors




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3147 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-02-05T17:14:34Z,N/A
647fbf29c7c0667e7e26994685893175c23ac3e0,Diana Kolbe,diana.kolbe@gmail.com,"Design change:
- EVD calibration for MSCYK now fits 20% tail (instead of 10%)

Small bug fixes:
- off-by-one error in reporting coordinates of hits on reverse strand
- e-value -> score conversion for MSCYK EVD



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3142 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-28T19:50:47Z,N/A
a584e8499b5705182e908252bbcd660b7cde92c8,Diana Kolbe,diana.kolbe@gmail.com,"sse_cmsearch.c:
  - --s1-F option for setting target filter rate for
    stage 1 filter.  This option is the new default,
    with default setting of 1%.

sse_cmcons_mscyk.c:
  - bug-fix on -L option for test driver.  Used to
    select QDB-based length if -L was on but set to
    default.

sse_cm_dpsmall.c
  - added NULL coordinate argument in CYKFilter test
    driver to match new function definition.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3141 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-26T22:56:10Z,N/A
95e457a277e82191d04f74a33d99ff630a92a5f8,Eric Nawrocki,eric.nawrocki@gmail.com,"Another small bug fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3139 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-25T16:09:56Z,nawrockie
ec1bb09e3b8e6d701d01b860b3acddb21d12d87d,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug involving combination of cmalign --matchonly and --ifile or
--elfile.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3138 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-25T16:06:08Z,nawrockie
da1f784792d9f98feb0011c3dad4995d67129c15,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified the format of the cmalign insert info and EL info output
files (output if --ifile/--elfile) so they now include the unaligned
position that begins each insert for each sequence to allow simple
reinjection of inserts into an alignment given the unaligned target
sequence file and the alignment, if that were ever desired.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3137 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-22T16:46:16Z,nawrockie
045ed669dd29f29cf94cb144b8161a4ea5a8b7ea,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated calls to esl_msa_RegurgitatePfam() and
esl_msa_ReadNonSeqInfoPfam() so they comply with those functions' new
prototypes. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3136 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-22T16:07:57Z,nawrockie
70d87070fdb430e5b5da9316f09496e44d008dff,Eric Nawrocki,eric.nawrocki@gmail.com,"Revised how the 'tmpfile' name is defined so it agrees with how
easel.c::esl_tmpfile_named() wants it to be named. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3135 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-21T13:38:48Z,nawrockie
24b8d96ac677e9394990f55b2ffe0275eae04591,Eric Nawrocki,eric.nawrocki@gmail.com,"Added ""(hr:min:sec)"" to cmsearch and cmcalibrate output to clarify
meaning of ""xx:xx:xx"" formatted timings.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3134 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-21T13:10:26Z,nawrockie
3bf4a6fb4f584e228ba975a0485a83188047ac0d,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated esl_sqio* function calls so they're compatible with current
easel code.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3133 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-21T12:51:41Z,nawrockie
73fc6abc890be7e05655a1ab4090e0f60f38150d,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed unintentionally committed changes from r3127 in
cmcalibrate.c that were unstable and still being tested for making
cmcalibrate reproducible with --mpi and different numbers of
processors. 

Xref: /groups/eddy/home/nawrockie/notebook/10_0103_inf_reproducible_randomness/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3132 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-21T12:44:53Z,nawrockie
28a5e9fb0a2b574eb50ead5463be3a178d24ba87,Diana Kolbe,diana.kolbe@gmail.com,"Add in ocm->beginsc[v] when checking for
best local alignment score.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3130 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-16T00:11:02Z,N/A
a0f22204012672aa4c04207a365466e306b39aae,Diana Kolbe,diana.kolbe@gmail.com,"sse_cmsearch.c
  - return hit coordinates from CYKFilter_epi16
  - removed some extraneous output
  - restrict stage 3 to smaller windows defined by stage 2
  
impl_sse.h
  - coordinates object for returning bounds of
    local alignment

sse_cm_dpsmall.c
  - CYKInsideScore_ps(): check whether local begin
    exceeds returned score
  - CYKFilter_epi16(): return bounds of top hit

sse_util.c
  - removed sse_hmax_epi16(), this function
    already present in esl_sse
  - bugfix to sse_select_si128()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3129 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-16T00:03:54Z,N/A
c4a194c906b10ff15dd3cf3c3f732e82e7d8fae5,Diana Kolbe,diana.kolbe@gmail.com,"impl_sse/sse_cmsearch.c
  - --glbf_all option for output of all per-stage benchmark
    data to separate files
  - new S->SM transition eq to support E-terminal model fragments
  - p-value -> score conversion for stage 2 (CYK_epi16)
  - suppress output if no hits were found

impl_sse/impl_sse.h
  - p_rfrag (prob. of recursive frags) - proportion of
    model fragments which are _not_ E-terminal

impl_sse/sse_cmcons_mscyk.c
  - parameter changes for test drivers

impl_sse/cm_optimized.c
  - check for B_st before copying transition scores
  - in model conversion for CM_CONSENSUS, new (corrected)
    fragment number, expected length, and proportion
    recursive to support handling E-terminal model fragments

impl_sse/sse_cm_dpsmall.c
  - expected length for background model set to window
    length being considered, rather than the total seq length




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3128 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-15T15:35:12Z,N/A
39c4c23ea19edb04a53036b9cb99baeb7dbe6ad2,Eric Nawrocki,eric.nawrocki@gmail.com,"Commented out some debugging print statements that were
unintentionally left in the code at last revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3127 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-12T20:07:10Z,nawrockie
9799baa6218817d4cbabee6d03254b3750beef23,Diana Kolbe,diana.kolbe@gmail.com,"Options update for pipeline driver:

- now includes searching revcomp by default;
  --toponly for old behavior
- GLBF-style output for stages 2 and 3
- timing information for stage 1, and stage 1
  calibration if necessary
- new default for --S_Sa, 0.25 (old was 0.5);
  controls expected length of unaligned segments
  in MSCYK meta-model



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3126 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-08T20:52:57Z,N/A
4a9db1f9eeb22f8f42988df329d482deac5546ad,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed the definition of a filter threshold 'workunit' in cmcalibrate
to a set of sequences and their lengths. Processing a workunit now
consists of searching those sequences to obtain the results: the top
CYK, Inside, and HMM Forward score of a hit within each
sequence. Previously, a workunit consisted solely of an integer
specifying how many sequences to generate from a CM and processing it
consisted of first generating those sequences, and then searching
them. 

This change does not affect results from serial cmcalibrate but does
affect results from MPI cmcalibrate, and is the first step towards
making cmcalibrate results reproducible across different runs,
regardless of the number of processors used per run.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3125 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-08T18:52:54Z,nawrockie
28a6e8efbda721d747dfdd7de0f652ff7bbee2d3,Diana Kolbe,diana.kolbe@gmail.com,"Accumulated changes, of varying importance.

- Require minimum length of 1 for reporting hits (sse_cmcons_hitmx.c)

- New treatment of E states: consider hairpins extending
  to E at length 0 separately from those ending at previous
  match state; and don't force to cycle through M->S->e
  As part of this, adjust calculated number of possible fragments
  (cm_optimized.c, sse_cmcons_mscyk.c)
  ***** This change likely to be rolled back *****

- Changes to hit resolution and expansion between MSCYK and next stage.
  These changes also tentative (sse_cmcons_mscyk.c)

- Debugging output wrapped in #ifdef DEBUG_0 / #endif
  rather than /* */

- For match-emitting states, subtract bias before adding (biased) esc
  rather than after; should improve some scores near saturation

- MAJOR BUGFIX: Initialize vec_ntS[jp_Sv] inside the main j loop
  because this matrix is recycled every W rows.  This bug affected
  scores from sequences with length > W (W determined by QDB threshold).
  This is expected to have a relatively large effect on the scores
  of random sequences; all score distributions for MSCYK should
  be re-done.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3124 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-07T21:40:20Z,N/A
b628705d9d909d927870cf6fe9faa614b8800c53,Diana Kolbe,diana.kolbe@gmail.com,"Addition of --glbf flag for benchmark purposes:
directly output hit data formatted for glbf file.
--glbf 0 [default] indicates 'normal' output;
--glbf n indicates hit data for pipeline stage n.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3123 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-07T21:20:02Z,N/A
fe13664c408f022bea2541d1c2adb64a994b7bf4,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: wrap reference to shadow matrix to prevent memory
access error when traceback is not required.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3122 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-07T21:17:11Z,N/A
243b4b961c1edecdc3b8ebf20d34bc940054e2b2,Eric Nawrocki,eric.nawrocki@gmail.com,"Revised how random number generators are seeded in all infernal
programs. By default, the integer seed '181' is used by all programs
except cmemit and cmbuild. Previously, the number of seconds since the
Epoch was used for all programs making subsequent runs more than one
second apart return different results. The new strategy yields fixed
results by default by using a fixed seed and mimics H3's use of
RNGs. A one-time arbitrary seed (similar to the previous method, but
creating different seeds for runs initiated during the same second)
can still be used if '0' is supplied as the argument to the '-s'
option for all programs.

cmemit and cmbuild use '0' as the seed by default (and thus use an
arbitrary one each run). cmbuild only uses an RNG if --refine and
--gibbs are enabled to refine the input alignment by sampling from the
posterior distribution.

Man pages updated to reflect these changes.

cp9_modelconfig.c: fixed minor potential memory leak.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3121 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2010-01-06T13:13:20Z,nawrockie
2d93bd95a48bba0e44f16eefedcd6fed9ca54a0c,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated esl_msa_ReadNonSeqInfoPfam() calls so they match new function
prototype introduced in Easel revision 479.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3119 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-27T18:27:34Z,nawrockie
7fee21768d32932b1ea0820f6627bac965cf8611,Diana Kolbe,diana.kolbe@gmail.com,"Expansion and merging of hits from MSCYK.
Overly cautious on the padding of hits, such that
all subsequences up to window size W which include
the actually reported hit from MSCYK are included
in the candidate to be sent down the pipeline.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3114 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-22T15:55:29Z,N/A
55c4e465e6f3d9d19641d020d1281e7bb964b0ce,Diana Kolbe,diana.kolbe@gmail.com,"Score distribution estimates for combined CM/MSCYK model.
Fits 10% tail to exponential.  Currently set to 10,000
samples of 1kb each, which is far more time-intensive
than we actually want to use in practice, unless we pull
it out to a separate calibration step.

Also pulls e-val/score conversion from cm->stat for
final stage cutoff.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3113 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-21T20:29:10Z,N/A
a49d87ec53641a0ebdd9e7cd3bc3a54521de2ef0,Diana Kolbe,diana.kolbe@gmail.com,"sse_cmsearch.c:
 - set-up for distribution fitting on CM/MSCYK combined model.
   Needs work to determine whether we'll fit the whole distribution
   or just the tail.

sse_cmcons_mscyk.c:
 - reporting of top score even when not returning results list
 - removal of unused var, and extra initialization to silence warnings
 - mscyk-test driver: set ccm->r variable for background distribution.
   This has a major effect on scores of true sequences, pulling them
   back down below saturation threshold because the correction is
   applied at very end.  May need to consider moving the effective
   score range for byte-scores to allow a higher ceiling and thus more
   headroom above typical random scores.

sse_cmcons_hitmx.c:
 - removal of unused vars and labels to silence warnings



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3112 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-18T20:40:10Z,N/A
1b711f847c473d781bf3c4f6f47e4dc87ad056ce,Eric Nawrocki,eric.nawrocki@gmail.com,"The cmalign memory efficiency introduced in revision 3106 for serial
cmalign now applies to MPI cmalign as well. See the r3106 log for more
details. Added --bigmem developer option (only visible with --devhelp)
to run cmalign in non-memory efficient mode. Added --nseq-mpi <n>, to
specify that <n> seqs define a workunit that is sent to each worker
for alignment, previously this was not changeable by the user.

Xref: 
/groups/eddy/home/nawrockie/notebook/9_1211_inf_cmalign_memeff/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3111 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-17T23:04:13Z,nawrockie
fd44088bf4ed689da77a2182d2e94cc84c40ce1d,Diana Kolbe,diana.kolbe@gmail.com,"- logic set-up for pipeline filter cutoff options
- SSE_CYKFilter_epi16 now accepts an already
  converted CM_OPTIMIZED model object, rathr than
  a generic CM.  Prevents repeated model conversion
  when aligning multiple sequences.
- Reverted some changes to Makefile, to prevent
  multiple definition errors when compiling the
  small test drivers.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3110 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-16T20:13:28Z,N/A
d51d0e864e6b9c738e440025323de6d4b1ca421a,Eric Nawrocki,eric.nawrocki@gmail.com,"Small typo fixes and minor cleanings to allow compilation with
HAVE_MPI and silence icc warnings.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3109 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-16T19:53:49Z,nawrockie
dc9e816514ef05f61bfecc7eb3a651d3b5c981e1,Diana Kolbe,diana.kolbe@gmail.com,"Re-structuring expected options for sse_cmsearch pipeline.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3108 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-16T19:13:59Z,N/A
195f3da00723a05049ecf6a035519dfa1757030f,Diana Kolbe,diana.kolbe@gmail.com,"Seed of SSE pipeline version of cmsearch;
this version copied from mscyk-test (IMPL_MSCYK_TEST2)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3107 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-16T18:32:15Z,N/A
61733fffe051c099e3b486856800640808d52fef,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified cmalign so its memory requirement is much lower for
generating very large alignments. If the target sequence file contains
more than <n> sequences (by default <n> is 1000, but can be set with
--chunk <n>), it is split up into chunks of <n> seqs, each chunk is
aligned separately to the model, the <n>-deep alignment is written to
a temporary output file, and the sequence/msa/parsetree data is
freed. Once all chunks are done, cmalign opens the temporary file,
reads it (without storing full MSA objects), merges all the alignments
and outputs the final merged alignment (without storing it completely
in memory) to the standard output file (stdout or <s> from -o <s>). If
fewer than <n> sequences exist in target file, this memory saving mode
is disabled and the one and only alignment is output to the standard
output file (without creation of any temp files).

This works in global or local mode, the latter requiring significantly
more care (to correctly distinguish IL/IR insert columns from EL
insert columns), but only, currently, in serial mode. This memory
saving mode requires Pfam output format, which is default. --ileaved
to create interleaved Stockholm still works, but disables memory
saving mode and generates a single alignment once, regardless of its
size.

I decided to remove the --inside option (it was pointless, resulting
in no alignment being printed), the --fins option (which caused
inserts to be oriented flush-left and flush-right the way pre-1.0
cmalign worked), and the --resonly option (which only included
alignment columns that included at least 1 aligned residue in final
output alignment). I decided the latter two would have required too
much additional code to support in memory saving mode to be worth
keeping. Also, --resonly prohibited downstream merging with
esl-alimerge.

Man pages and cmalign.sqc were updated to reflect changes.

Xref:
/groups/eddy/home/nawrockie/notebook/9_1211_inf_cmalign_memeff/00LOG

Note: I noticed that Easel's EMBL sequence input is finicky, not
allowing numbers indicating residue indices in the sequence part of
the file (at least on my tests) although it appears they are supposed
to be there as per the EMBL format description. I commented-out tests
of EMBL sequence file reading in cmalign.sqc.
 --This line, and those below, will be ignored--

M    src/dispatch.c
M    src/cmbuild.c
M    src/cmscore.c
M    src/cm_parsetree.c
M    src/cmalign.c
M    src/funcs.h
M    testsuite/cmalign.sqc
M    testsuite/3trnas.fa
M    documentation/manpages/cmsearch.man
M    documentation/manpages/cmalign.man


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3106 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-16T15:36:48Z,nawrockie
38e2f540041b579a5ddfb9273375409824624a52,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --sfile <f> option to cmalign, which creates a file <f> and
outputs extra score information for each aligned sequence including
query start/stop, primary sequence score contribution and null3
penalty. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3100 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-11T21:29:59Z,nawrockie
5ace1ada9852ffc9d6c9d13ee64a816c8e020d0c,Eric Nawrocki,eric.nawrocki@gmail.com,"Added possibly temporary fix to problem of a top-level 'make'
compiling Easel twice, once for infernal progs and once for H3 progs
(see log r3097). A top-level 'make' now moves into 'hmmer/' and
executes 'make hmmer_lib' to only build the libhmmer.a library.
Building libhmmer.a seems to not require any compiled easel code, so
hmmer/easel/ remains unused.

Log r3097's description of how infernal was building was wrong.
Creating a symlink from infernal/hmmer/easel to infernal/easel is not
actually possible and r3097 was in fact building two separate
libeasel.a's, one in each easel dir. 

Mysteriously (to me), the ordering of '-lhmmer -leasel' in MYLIBS
definition of infernal/src/Makefile.in is still necessary (infernal
progs will not build if '-leasel -lhmmer' order is used.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3099 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-10T20:10:00Z,nawrockie
08959dc8d6760d126ab8fc73890820026e9231a3,Eric Nawrocki,eric.nawrocki@gmail.com,"Replaced svn:external 'property', the hmmer/ subdirectory, with the
HMMER3 trunk
(https://svn.janelia.org/eddylab/eddys/src/hmmer/trunk). Previously it
was the destabilizing 'hmmernal2' branch
(https://svn.janelia.org/eddylab/eddys/src/hmmer/branches/hmmernal2)
which forked in August 2008 and was not properly kept up. Note that no
changes were made in the hmmernal2 branch after its creation. Infernal
simply calls hmmer/ functions and uses its data structures, no
HMMER3-specific code was developed (though I original thought I might
and didn't want to pollute the trunk).

hmmer/ has its own easel/ subdirectory (the Easel trunk). To make it
so only one easel/ subdirectory is used during building, add a symlink
from infernal/hmmer/easel/ to infernal/easel/. This should allow a
successful build after 'configure'ing in hmmer/ and infernal/, but
currently it requires building Easel twice per 'make': once to create
the libeasel.a that hmmer/ can successfully use to build its programs,
then again to create the libeasel.a that infernal/ uses to successfully
build its programs. (They use slightly different gcc flags:
e.g. -pthread). I assume we want only one libeasel.a creation, but
I'm not sure how to do it and will consult with more knowledgable
developers (Diana, Sean, Michael...) and hopefully fix this in the
near future.  

Only change to Makefile.in is to place '-lhmmer' prior to '-leasel'
during compilation of infernal programs which is important b/c of
the situation described above (I think this is why, though I don't
have a complete understanding).

my_p7_msvfilter.c: updated b/c p7_GMSV() function prototype changed
slightly since the hmmernal2 branch forked.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3097 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-10T17:06:06Z,nawrockie
d01094ff0b4621611017ae333bc9803f58a0eaf2,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed default output format of cmalign, cmbuild and cmemit from
interleaved Stockholm to Pfam Stockholm (non-interleaved 1 line/seq). 
Interleaved is still available using the --ileaved options in all
three programs. Main motivation for this change is to set-up memory
efficient cmalign runs that don't require the entire output alignment
be saved in memory before outputting. This will be developed soon.

Also, cmalign now outputs posterior probabilities to the output
alignment by default, instead of requiring -p to do so.  



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3095 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-09T18:23:26Z,nawrockie
54a7fea0fb76a92156caf7a50364a190c1f3b9de,Eric Nawrocki,eric.nawrocki@gmail.com,"PP annotation of inserts was not being properly rejustified in final
step of Parsetrees2Alignment(), now it is.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3094 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-09T13:50:44Z,nawrockie
42d28ee86b070184aa03104814ae21055c9da8e1,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed posterior probability annotation of cmalign and cmsearch to
match easel and hmmer. Previously, two #=GR tags were used to annotate
posteriors: ""POSTX."" and ""POST.X"", which displayed the pp of each
aligned residue to two digits of precision. Now, a single #=GR tag
(""PP"") is used. This PP tag is supported by ESL_MSA, which stores it
in a special array (msa->pp). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3087 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-05T20:43:42Z,nawrockie
620ec258ec7317cf70fdac3c6b221534074b0a26,Eric Nawrocki,eric.nawrocki@gmail.com,"Merge from 1.0 branch with command:

svn merge -r 3084:3085
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This was a minor change to the cmalign --ifile format.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3086 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-04T21:39:39Z,nawrockie
af66755d67567c259fef84f25452e5c2696b558b,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed some errors with 1.0 branch merge performed for the
immediately previous revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3080 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-03T16:07:23Z,nawrockie
de8664aed023480a52976bb787515ad251c2323e,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from 1.0 branch with command:

svn merge -r 3076:3077
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Log from r3077 in 1.0 branch:
~~~~~~~~~~~~~~~~~~~~
cm_parsetree.c: Parsetrees2Alignment() can now optionally allocate and
fills each aligned sequence (and GR posterior annotation) in the
nascent MSA independently, only as each parsetree is converted to an
aligned sequence/posterior codes. After creation of an aseq and
posterior codes for a given parsetree, the parsetree is freed. This
change reduces the required amount of memory of the function to be no
more than the size of all the parsetrees and ESL_SQs, instead of that
size plus the size of the MSA (which, btw, is about the same size as
the parsetrees if the MSA has about 6*clen positions for a model of
consensus length clen).

cmalign.c's and cmemit.c's Parsetrees2Alignment() call use this more
memory efficient option, but all other calls do not as of yet. Changes
to the other files were nec to be consistent with new
Parsetrees2Alignment() function prototype.
~~~~~~~~~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3078 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-03T15:11:04Z,nawrockie
8bf3fdd26c6ffcd034e162b8b273bca48e22d519,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged changes from 1.0 branch with command:

svn merge -r 3074:3075
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

The r3074 commit added the --ifile and --elfile options to cmalign
which print per-sequence insert or EL-insert information on the
alignment to files.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3076 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-02T21:08:11Z,nawrockie
1413b9438707d3394e8ae11e5d10551c10637086,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from the 1.0 branch with the command:

svn merge -r 3071:3072
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This commit removed the --merge and --list-merge options from cmalign,
the functionality of which are now more efficiently handled by
esl-alimerge.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3074 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-02T19:17:09Z,nawrockie
06be5139c1e9c044fcf90bb27d0e76bd7dbe4cb2,Diana Kolbe,diana.kolbe@gmail.com,"(MSCYK) Score adjustment correcting for null model with
geometric length distribution.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3073 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-02T19:16:56Z,N/A
70d1ec7282341bcd59d9a31d0b2b917d7bbc2547,Eric Nawrocki,eric.nawrocki@gmail.com,"This should have been the log for r3070:

Merged revision from the 1.0 branch with command:

svn merge -r 3068:3069
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Log from r3069 revision from branch:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cmalign --matchonly (which outputs an aln with only the clen consensus
columns) now only allocates an alignment of size clen*nseq, instead of
first creating an alignment with inserts and then stripping them.

Also, the way posterior probabilities are added to an MSA by cmalign
was changed. This is now done in Parsetrees2Alignment() which is
passed ptrs to the 2 posterior code strings, allowing posterior
annotation to work with the --matchonly option.

The cmalign --onepost option was removed, which modified the aln
output to only include a single digit of posterior annotation. (This
single digit posterior annotation was not the same as HMMER3
annotation). cmalign.sqc and cmalign.man were updated to reflect
removal of --onepost.

cmalign --withali <f> now propagates Infernal posterior annotation in
<f> to the final alignment if -p is also enabled.

cmbuild.c, cmemit.c and cp9_modelmaker.c: very minor changes, only
necessary to make Parsetrees2Alignment() calls match the new function
prototype (postcode1 and postcode2 are passed as NULL).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3071 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-02T18:47:07Z,nawrockie
068cbb61b9ba3a0d08fa7a517f9f2decd857c8cf,Eric Nawrocki,eric.nawrocki@gmail.com,"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3070 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-12-02T18:37:51Z,nawrockie
aef50cb47478085f9ddc675f1c4bf3af1c0fce1c,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix (MSCYK): fixes error in calculation of
expected residue length of model fragments.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3067 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-30T20:13:42Z,N/A
8020f26f3b5293f25bc80e47eef36270ecf3103c,Diana Kolbe,diana.kolbe@gmail.com,"MSCYK_explen(), calculates expected length of
sequences under the MSCYK consensus hit model,
given the expected length of fragments from
a particular CM, as well as the parameters of
the meta-model.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3066 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-30T20:02:08Z,N/A
c3a72744dab893bfa7f7a159b3fb7e4d10ab0ff7,Diana Kolbe,diana.kolbe@gmail.com,"Removing cruft of old geometric distribution
on CM fragments (M->M transition); M->S term
now accounts for entire fragment penalty.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3065 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-30T19:37:32Z,N/A
1400d9c2b8917d5c1da8149d0c80b48aaa26cbc7,Diana Kolbe,diana.kolbe@gmail.com,"Probability distribution on which CM fragment
will be generated/aligned; uniform across CM
fragments in terms of CM states.

Also calculates expected length of CM fragments
which will be needed for expected length of sequences
generated by the model -> parameterizing length
distribution of null model.

Note behavior of --cutoff option: best score in
results list will be 0 (in bitspace -> neg. inf)
if no hits score higher than threshold.  Cutoff
defaults to zero; in current implementation nearly
all random sequences will have best score of 
small negative numbers, but these will be reported
as -inf if the cutoff is not changed (e.g. -5 or -10)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3064 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-30T15:06:40Z,N/A
4a32d344eac5982dedd586fb394ef577031d7acd,Diana Kolbe,diana.kolbe@gmail.com,"Max hit reporting out of MSCYK for test drivers.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3061 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-24T13:46:24Z,N/A
a0205f75dec4c2ef8f9e6690ae9b134e90a64c08,Diana Kolbe,diana.kolbe@gmail.com,"Moving meta-model parameters from compile-time
constants to run-time set options; store as
scaled byte costs in CONSENSUS_CM structure.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3059 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-18T16:47:22Z,N/A
8aa37d4d52c0e085b9701a67c005a7fb0c381029,Diana Kolbe,diana.kolbe@gmail.com,"Simplification of overflow correction; eliminates a max instruction.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3058 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-18T15:36:51Z,N/A
38dd46570e459ddd9801ee76275d01a157e16dcd,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with command:

svn merge -r 3054:3056
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This fixed BUGTRAX bug i15. Below is the log from the 3056 revision in
the 1.0 branch (which pertains to both r3055 and r3056):
~~~~~~~~~~~~~~~~~
o Found and fixed a bug in cmalign involving banded optimal accuracy
  alignment seg faulting in very rare cases (occurs once in the first
  800K RDP release 10.15 SSU sequences). The bug occurs when a
  optimally accurate parse includes a B state that has a left or right
  child with an IMPOSSIBLE score (summed probability of 0) and
  non-zero length parse subtree. The fix is to explicitly check during
  DP to ensure this case does not hold before assigning the B state
  value in the alpha matrix. Minor anecdotal testing shows a 0.25%
  slowdown (no, I don't mean 25%) from the fix. This bug is logged as
  i15 in BUGTRAX. See that or
  ~nawrockie/notebook/9_1116_inf_cmalign_bug/00LOG for more details.
~~~~~~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3057 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-18T00:23:30Z,nawrockie
b9b0fc1b7e802fa69478c40a6439222a65abbdde,Diana Kolbe,diana.kolbe@gmail.com,"Major correction in numerical range of byte scores:
offset alignment scores by base_b rather than bias_b.

Because base_b is generally much larger than bias_b,
this compounded a range problem in the calculation of
scores at bifurcations.  Both segments are alignments
and therefore already contain the offset term; so we
must subtract one of the offsets from the sum.  If
we sum first, overflow is very likely, and if not
corrected for limits scores to (0, 255-base_b).  If
we subtract base_b first from one of the components,
underflow is likely.

The implementation here catches the overflow events
in a mask, uses unsaturated addition to calculate the
size of the overflow, and (after subtracting the
offset and the transition cost) re-adds this remainder
with saturated math.  See notebook pgs 58-59 for
details.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3054 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-17T20:10:50Z,N/A
179a7a849f258be3a575c09805d3a394250ccec4,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from infernal 1.0 branch with command:

svn merge -r 3044:3045
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This revision added the --cm-idx and --cm-name options to cmsearch and
updated the testsuite and man page to include them as well. 

An analogous change was made to cmalign in 1.0 branch revision 3023 
and merged to trunk in r3024.
------------------------------------------------------------------------



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3046 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-12T21:42:32Z,nawrockie
9dff395648c4a1a0fe85962d7e78bc06a03de832,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes (MSCYK):

1.  Handling of A + -infty in BIF: now checks
left and right terms for 0 (-infty), produces
a mask, and re-zeroes.  This reverses the design
decision of the previous patch (r2039).

2.  Update wrap-around convenience vectors (d = -1, d = -2)
after calculating BIF.

3.  Sign of initialization on S -> e transition.

4.  Change in meta-model parameters.  Known issue:
if S -> e transition cost is larger in magnitude than
bias, all alignments will be impossible.  This arises
because bias and scaling are determined on the basis
of the CM, and don't account for the meta-model parameters.
Also, if the cost is only slightly smaller than the
bias term, it imposes a noticeable limit on the length
of non-homologous residue segments.

Remaining known issues relate to either parameterization
(as in 4 above), and whether/how to report scores directly
from model states - the requirement to cycle through
S -> SM before recording hits imposes a significant
penalty on scores.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3040 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-10T19:39:24Z,N/A
491219e98392292a23e20e45e32b73a766a23e08,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix (MSCYK)

Numerical behavior of Bifurcation state:
At BIF-type states, we need to add two values,
both of which are partial alignments and already
include a bias term.  0 represents -infty.
In general, A + -infty cannot be relied upon
to calculate to -infty (fails if A > bias).

One approach would be to convert one of the two
scores to a cost and subtract it, as is done 
for transition and emission scores.  However,
this would limit the effective range of the score
to be flipped to 2 x bias, and could severely
underestimate the score of high-scoring hits.

The solution in this patch does not fix the
underlying problem; rather, it fixes the one
known case where the behavior of A + -infty
was being relied upon.  An array of mask vectors
is applied after calculating the bifurcation,
to re-zero combinations of (j,d) which are
not possible.

This solution is sufficient only if scores of 
-infty are not expected to occur at valid
matrix cells.  Otherwise, 0 will need to be
checked and caught to produce a mask for each
summation of BIFL and BIFR terms, which is
expected to be more computationally expensive
than the current implementation.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3039 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-09T20:41:44Z,N/A
b2279441f811efeb9eb59cbb6b87c505fa041e8a,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch to trunk with command:

svn merge -r 3034:3035
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This revision made Parsetrees2Alignment() propagate sequence
accessions and descriptions to the msa it creates.

*After the above merge command*, I updated cm_parsetree.c to take
advantage of esl_msa.c's convenience functions for setting sequence
names, accessions, and descriptions, which were introduced since the
1.0 branch merge.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3036 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-04T19:18:28Z,nawrockie
9657a72970d66a52015edb2c8bccf6f9f56539b8,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix (MSCYK): send j, rather than jp, to UpdateGamma()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3031 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-02T19:28:23Z,N/A
084f05d3519af7640c09dd3fc66d8868b5750460,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix (MSCYK): corrected lookup row for 3' BIF term



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3030 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-02T18:38:11Z,N/A
6f742c7a1ba7544802ab0ccc58c5abc742fdeee9,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix (MSCYK): subtract biasv when adding bifurcation
terms (both values are already stored in biased form)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3029 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-02T13:07:09Z,N/A
8b9ad8e1f4b9d3e43296732991f089d20ec3e981,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: Initialize esc for out-of-bounds residue indices
to infinite cost rather than zero cost.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3028 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-01T15:41:36Z,N/A
7cb089d7c364529017c7369861a5de1e8b27a517,Diana Kolbe,diana.kolbe@gmail.com,"New test driver for MSCYK, examining hit list.

Additional bugfixes:
- sign error on cutoff conversion to byte
- sign error on setting meta-transition parameters



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3027 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-11-01T00:36:49Z,N/A
a51cb2d989836159dce5f1886be2f781af09a0e5,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with command:

svn merge -r 3024:3025
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This introduced the cmalign --list-merge and cmemit -i options. See
the 1.0 branch log for r3024 for more details.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3026 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-31T21:00:03Z,nawrockie
0f3031e694de39ebf6ed42632a2dc5d668de0b07,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from infernal 1.0 branch with command:

svn merge -r 3022:3023
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This revision added the --cm-idx and --cm-name options to cmalign and
updated the testsuite and man page to include them as well. 

This is the first merge from the 1.0 branch that occured after the
1.0.2 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3024 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-31T20:20:09Z,nawrockie
448d1286a0d3179409a243f6ed3e78435514a2af,Sean Eddy,sean@eddylab.org,"Infernal 1.0.2 release completed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3022 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-30T17:58:32Z,cryptogenomicon
e5c87b121d6d8b7c950fd469098a13fecd89e452,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with command:

svn merge -r 3012:3013
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

-1 now works with --merge.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3014 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-28T14:10:28Z,nawrockie
8d532d2493d13337c749927bdcae6e8972fa96cb,Diana Kolbe,diana.kolbe@gmail.com,"Pass sW to UpdateGamma; corrects an error
in de-interlacing of vectors.

Passing sW is somewhat redundant, since it can
be calculated from W, which is already in the
function arguments.  However, because this code
is still fairly plastic, this will be more robust
for possible changes in the way that sW is 
calculated.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3008 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-26T19:55:44Z,N/A
609f43dc66ba43aff1daba4a05cceecf62c197ae,Diana Kolbe,diana.kolbe@gmail.com,"Test driver now runs through hit-processing semi-HMM.

Memory initialization for non-terminal M.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3007 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-26T19:37:39Z,N/A
ea6af704e257462a5ee740f991b26ad605764357,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged 1.0 branch revision with command:

svn merge -r 3004:3005
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

*And* added the file cmcalibrate.sqc which was added to the 1.0 branch
with revision 3005, but does not get added to the trunk with the merge
call above.

These changes remove 'cmstat --devhelp' from the testsuite sqcs and
introduce cmcalibrate.sqc.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3006 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-26T19:14:02Z,nawrockie
05d7bfa8e2f0e02f3537dd6f6404aa9576006319,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with command:

svn merge -r 3002:3003
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This revision shortened a the description line of the '-1' option to
cmalign so it was legal within an esl_getopts data structure. The
.sqc files now check if all executables can exit cleanly when run with
only '-h' and '--devhelp'.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3004 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-26T17:32:03Z,nawrockie
38ee48341fddde5ee1acebb2cb1b538ade9a12fb,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from the 1.0 branch with command:

svn merge -r 3000:3001
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Revision 3000 changes were updates to the tutorial calibrated CMs and
the user guide to make it consistent with the soon-to-be 1.0.2
release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3002 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-24T16:17:07Z,nawrockie
2c67148764ce2a9b30bfebdd55f48056881ed6b4,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged 2998:2999 revision changes from 1.0 branch back to trunk with command:

svn merge -r 2998:2999 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Here is the complete log for that 2999 commit in the 1.0 trunk:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cm_mx.c, hybridsearch.c, cp9_dp.c, funcs.h:

These 4 files were revised to fix a 'bug' involving how null3
penalties are calc'ed for HMM Forward hits. Previously the length of
an HMM hit was always presumed to be W for null3 calculation -- this
resulted in inflated penalties for models where W/clen ratio was large
(like group I introns, RF00028 for which this bug was first detected
by Rfam curator Jen Daub).

The fix is to assume HMM Forward hits are always the consensus length
of the model (not W). I could have used the average length of emitted
sequence from a model but that would have required a lot of code
changes and I judged it was not worth it. See 
~nawrockie/notebook/9_0924_inf_rfam_question/00LOG and
~nawrockie/notebook/9_1019_inf_1p01_and_1p02_releases/00LOG 
for more information on how this bug was found and its fix was
evaluated. 

HMM Forward hit lengths are unknown because a scanning Forward
implementation reports only high scoring end points, which sum over
different possible starting points. In the current implementation
Backward is run beginning at each Forward end point to get a
reasonable start, but only after the null3 penalty is applied and the
resulting bit score is evaluated to see if it exceeds the HMM filter
bit score cutoff, if not, Backward is not run for the hit and it 
does not survive to the next round.

cmcalibrate.c: 
Default maximally useful HMM filter survival fraction
changed from 0.95 to 0.75.

cm_parsetree.c:
Changed verbosity level of a single ESL_DPRINTF statement from a '1'
to a '3'.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@3000 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-24T16:10:58Z,nawrockie
630d1dc739a710f6b63d3ee3d4b8f5e8cd7e6d15,Sean Eddy,sean@eddylab.org,"1.0.1 release cycle completed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2997 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-24T14:21:08Z,cryptogenomicon
75eeb710164837330ef46acb1a3ba3bdec1283fe,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch to trunk with command:

svn merge -r 2990:2991
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This fixed errors in command-line option definition in cmsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2992 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-22T22:16:32Z,nawrockie
93a2193e3bc6b8e6aae09c94a1e4943c483d0c52,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with command:

https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This revision only added updated comments, no code changes were made. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2988 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-22T19:15:05Z,nawrockie
646d1aefcad1195115784eb3a13950bfb04cbb67,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from the 1.0 branch with command:

svn merge -r 2982:2983
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

The changes in this revision were solely to silence
compiler warnings (had no effect on any infernal executables).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2984 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-22T15:47:46Z,nawrockie
66e536f02120fa4fd6b8a8e646039ec5ba9a9513,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with command:

svn merge -r 2980:2981 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

This fixed a serious bug in how --fil-Smax-hmm was processed by
cmsearch, and silenced icc compiler warnings in the other files. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2982 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-22T13:36:10Z,nawrockie
be316a0a72ea6c5376dad8f712924435367685a7,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch to trunk with command:

svn merge -r 2978:2979
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

The changes in this revision were made to silence most, but not all,
icc compiler warnings prior to the v1.01 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2980 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-22T11:41:59Z,nawrockie
0f0f443084e93b8d6d2a4e69fac46e9231770e66,Diana Kolbe,diana.kolbe@gmail.com,"Bounds checking for if jp is wrapping around
the re-used decks.

-> memcheck clean



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2975 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-21T18:36:14Z,N/A
02a2090cebf20769110ccacaf8696ca60cba7044,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with command:

svn merge -r 2972:2973 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0 

This updated the cmsearch man page to be consistent with the infernal
1.01 (and current development) cmsearch tab file output.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2974 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-21T17:29:12Z,nawrockie
111717d82f30e534731125ed3a757d6abb72e825,Diana Kolbe,diana.kolbe@gmail.com,"Correction on transition scores:
reverse sign and use unbiased rather than biased conversion
(will be subtracted, not added)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2972 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-21T14:55:28Z,N/A
c8de8c57a7c475ca90c260505e3a2e400f486f1a,Diana Kolbe,diana.kolbe@gmail.com,"Transition scores for multi-hit consensus CYK,
currently set to ad hoc values.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2971 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-21T14:50:28Z,N/A
b02e583d05f444303e26ab498ba3a8021292d077,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with the command:

svn merge -r 2966:2967
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Below is the log from revision 2967:
o Added a field to the cmsearch --tabfile output: 'model name' as per
  a request by Sam Griffiths-Jones at the 2009 Xfam meeting.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2968 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-20T22:25:28Z,nawrockie
e3bab0218e532b050512eab4197e425262518ea0,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch to the trunk, with the command:

svn merge -r 2963:2964
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Log from that commit:
o Updated user guide to go for 1.01 release:
  - fixed a few typos
  - updated filter section to include new options for filtering
  - updated tutorial to include results with 1.01 calibrated CMs
  - added sentence to intro listing additional Infernal references
  - local.bib: added bib info for additional Infernal refs in intro      


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2965 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-20T17:49:55Z,nawrockie
5f607051a9cd1309d51021ec0dfcff1aafc59c56,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged very small revision from 1.0 branch with command:

> svn merge -r 2959:2960
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Here is the log from that commit:

esl-alimanip.sqc
o Removed two esl-alimanip test exercises that involved options that
  have been deprecated and removed.
------------------------------------------------------------------------



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2961 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-19T22:15:10Z,nawrockie
c6d257e8d633f89efb4357040a79062302a0a298,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged revision from 1.0 branch with command:

> svn merge -r 2957:2958
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Most changes were due to addition of -v option to cmsearch. See the
2958 log for details. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2959 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-19T21:32:51Z,nawrockie
20c10f7412ec8bd4a73da70b6ff28bd77ee25486,Diana Kolbe,diana.kolbe@gmail.com,"Semi-hmm hit reporting for Infernal consensus filter
using __m128i (_epu8) and uint8_t variable types.
Accepts striped, vectorized input, but is currently
a scalar implementation.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2955 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-14T14:47:29Z,N/A
b996601065a91c7b3c1a0384a53797130c21d4c0,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged small revision from 1.0 branch with command:

> svn merge -r 2952:2953
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Log for the r2953 1.0 commit:
o Added -1 option to man page of cmalign.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2954 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-13T21:50:02Z,nawrockie
3513fcf6f4b4ba27240dcb6c93a4dfad946a2956,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged small revision from 1.0 branch with command:

> svn merge -r 2950:2951
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Log for the r2951 1.0 commit:
o cmalign.c: Added -1 option, which causes alignment to be output in
  non-interleaved one seq/line (Pfam) format. Required code changes
  were minimal: definition of -1 option in esl_getopts structure and
  modification of esl_msa_Write() function call.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2952 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-13T14:31:51Z,nawrockie
e72e08c7b559d3d46a349d4afc5852aaae457a6a,Eric Nawrocki,eric.nawrocki@gmail.com,"Long overdue merge of changes from infernal 1.0 branch
(https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0)
back to infernal trunk with command:

> svn merge -r 2701:2907
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

Note that there were only about 20 commits in the span between
2701:2907 that pertained to the 1.0 branch, and some of their edits
had already been merged to the branch.

I decided to do the full commit range merge since the 1.0rc5 release
(which was r2701) to ensure we didn't miss anything at all.

Most of the significant changes were due to the work I did post-1.0
release related to the filter pipeline chapter of my thesis, during
which I reevaluated what the default filtering threshold strategies
should be (this mainly changed cmsearch.c and cmcalibrate.c).

Summary of changes (for more complete details see the svn logs in the
1.0 branch):

src/Makefile.in: 
'ssu' argument added for make for building infernal within an
SSU-ALIGN distribution. In this case, executables get renamed with a
'ssu-' prefix. For example: cmbuild -> ssu-cmbuild.

src/cmsearch.c:
More options for changing filter thresholds added::
--fil-S-hmm <x>: set HMM threshold that gives predicted survival
	         threshold <x>.
--fil-Smin-hmm <x>: sets lower bound on possible HMM threshold
--fil-A-hmm: always filter with HMM threshold that gives surv fraction
             of <x> from --fil-Smax-hmm.
(These only work with calibrated models).
--fil-beta default (QDB filter beta) changed from 1E-7 to 1E-10

src/sa-Makefile.in:
To be copied over Makefile.in in an infernal directory within an
ssu-align distribution. Only change is relative position of easel
within the hierarchy (in ssu-align/infernal/src it is ../../easel/,
while in normal infernal it is ../easel/).

src/cmcalibrate.c:
Small change to how filter thresholds are determined and saved. 

src/cmalign.c:
Trivial change (removed a single comment line).

tutorial/*:
These are calibrated CMs used in the tutorial. They were recalibrated
with the new cmcalibrate.

documentation/*:
Updated to reflect changes to the code.

More details may be found by searching through:
  ~nawrockie/notebook/9_0101_inf_fst_defaults_post_1p0/00LOG
  ~nawrockie/notebook/8_0917_manuscript_filter_thresholds/00LOG



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2950 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-12T21:20:20Z,nawrockie
05fe7e2a9bde691a7298e9aa601a0d954ff779a3,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed 2 bugs with the benchmark that supplements the infernal 1.0 app
note paper. These were found by Travis Wheeler as he worked through
it.

o The .raw files should have been there all along, this prevented
  users from running the BLAST benchmark on the rmark-2-test dataset.

o The 00README had two typos; one of which was significant.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2949 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-12T18:31:53Z,nawrockie
be048d85e25d9f08574c26be60229605d7b56cee,Eric Nawrocki,eric.nawrocki@gmail.com,"filter.tex:
Typo fix.

infernal2glbf.pl:
Minor output format change.

rmark_clusterfy.pl:
Jobs are now submitted to only a fraction of the cluster.

rmark_MPI_cmsearch.pl: 
Typo fix.

rmark.pl:
Added -S option for saving temp files.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2948 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-12T18:14:49Z,nawrockie
a497373771667c00aa9a726e4d3db4da218914b2,Diana Kolbe,diana.kolbe@gmail.com,"Need a custom gamma hit matrix for low-precision scores (unfinished)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2940 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-07T19:23:32Z,N/A
15481ab1752f2bbc38bae8280a21312050ad05d6,Diana Kolbe,diana.kolbe@gmail.com,"Adding function
CMSubtreeCountNodetype()
which is needed by cm_consensus_Convert()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2919 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-02T18:21:26Z,N/A
60a3a4e07fa0441e1827981b760c0cd790971338,Diana Kolbe,diana.kolbe@gmail.com,"- Beginning test driver for mscyk
- Setting defaults for scale_b, base_b, bias_b based on HMMER - probably need to be re-examined
- Fixing memory access error and leaks related to cm_consensus_Convert()
- Switched to counting MATL/MATR nodes rather than ML/MR states, because we need to exclude
  MATP_ML and MATP_MR from the consensus-only model



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2918 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-02T18:19:56Z,N/A
a28c80dee26a770c6a6544fc148456aef87bd694,Diana Kolbe,diana.kolbe@gmail.com,"free score array to prevent memory leak



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2917 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-02T14:43:42Z,N/A
4cf8d31bcd1c75e8d54319185dd3885280965692,Diana Kolbe,diana.kolbe@gmail.com,"Important bugfix: memory allocation size for hmm->null



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2916 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-10-02T14:41:09Z,N/A
22b85fb5dd316003cb33760361e97f48ebdf2325,Sean Eddy,sean@eddylab.org,"A test commit, of the new subversion broadcasting system. If this were
a real commit, you would have been instructed where to go in your area
to find the nearest emergency shelter...



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2912 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-09-28T22:23:21Z,cryptogenomicon
c6bcc4ff36e4ea94dcc3228af1185a801966f9a4,Sean Eddy,sean@eddylab.org,"esl_msa_Read() calls now check for <eslEINVAL> returns.  

Error messages formatted after esl_msa_Read() don't use linenumber
information; this is for internal (Easel) consumption only, and may be
affected by buffering of input. (That is, the current linenumber in an
<ESL_MSAFILE> may have nothing to do with where a parse error was
detected.)

I don't understand how the configure/Makefile is dealing with the
hmmer subdirectory, and I had some problems with it. The Infernal
configure script should produce all the Makefiles in all subordinate
directories; but the toplevel Makefile is calling ""./configure"" in the
HMMER subdirectory. I'm worried this will fail to propagate some
top-level configure information into hmmer/ - this is exactly what
happened to me, but I fixed it by adding CFLAGS to the ./configure
call for hmmer. Someone knowledgable should look into Infernal's
configure steps more carefully.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2910 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-09-27T12:33:28Z,cryptogenomicon
26583ece304694b58ec7b9c45053f822e0db00e5,Diana Kolbe,diana.kolbe@gmail.com,"Initialization for non-terminal S;
temporary handling for non-emitting states (B/S/E).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2905 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-09-17T18:50:18Z,N/A
befe79252c677114abc85645c924e07d88d0169c,Diana Kolbe,diana.kolbe@gmail.com,"Skeleton of recursion.  Initializations and 
edge cases not handled.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2897 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-09-14T17:39:55Z,N/A
5ba6de351ef955921ab20fcddb7b06aaf8e5a2e7,Diana Kolbe,diana.kolbe@gmail.com,"New grammar -> new non-terminals.
S -> Sa | SM | eps.
M -> x_m S y_n

variable-wise, S is ntS; M has M_v (per model state)
and M_all (max over model states)

Very much unfinished; committing to get a record
of code which will be deleted but we might want 
to reference later.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2896 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-09-14T17:16:33Z,N/A
916e56dedbd811b318d10c092f5cff13f4b6429e,Diana Kolbe,diana.kolbe@gmail.com,"Preliminary support for uint8_t emission costs
in CM_CONSENSUS.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2888 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-08-26T17:38:15Z,N/A
00888015840073c6ffa0d14f0f894c21d2b2c74a,Sean Eddy,sean@eddylab.org,"A test commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2883 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-08-23T14:34:43Z,cryptogenomicon
ab97afef369a72bec721453d98d319e1153f70e9,Diana Kolbe,diana.kolbe@gmail.com,"Big clean-up, removing remaining references
to a pre-Easel alphabet/residue/degeneracy definition.

Additionally cplan9.h and CP9_hmmio.c are no
longer compiled (or compileable), and are being
removed from the current development revision.
If needed again in the future, they should be
pulled from the older revisions and re-added
including history.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2871 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-08-13T15:32:18Z,N/A
ade838822be1abd608a8236a1b39629f442a775e,Diana Kolbe,diana.kolbe@gmail.com,"Easel-ifying - getting rid of CP9MAXABET constant



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2870 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-08-13T15:01:12Z,N/A
ae2f609ac961f72519522754713246a93c063cba,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added the illustrator files used to make the figs in the QDB paper.
  This should have been done a while ago. It's being done now b/c I 
  want some of these in my thesis.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2868 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-08-05T20:31:15Z,nawrockie
c74972137d3bf962c0c2c08b4db5aacb93f4b677,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed small bug in definition of cmalign command-line options.
  --qdb now toggles --hbanded. A few other lines of the options
  definition were updated as well.  



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2862 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-07-22T12:53:42Z,nawrockie
e29db11fca3d93e931a1c58c002736ef53e2c655,Eric Nawrocki,eric.nawrocki@gmail.com,"o Mirrored infernal 1.0 release branch:
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0
  revision 2859. 
  I know best practice is to make fix in trunk first, then merge
  to branch. But I forgot to do that.
  This is the exact modification as what was done between
  1.0 branch revs 2858 and 2859.

Here's the log from that revision, verbatim:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  o Fixed bug with cmalign command-line processing.  

  - Bug was that '--small' required '--nonbanded', but this made D&C
    (small) QDB alignment impossible to execute.  

  - Fix is that now '--small' requires *either* --nonbanded or
    --qdb. This restriction is enforced manually; it is not part of
    the ESL_GETOPTS object definition that is used to test conflicts
    because I don't know how to do -x requires -y *or* -z in that
    context (if may not even be possible).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
------------------------------------------------------------------------



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2861 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-07-20T16:35:50Z,nawrockie
f70b23b30d7fdbd218f4006e9b2f9d0cd38b12c9,Eric Nawrocki,eric.nawrocki@gmail.com,"o Minor change, added line to display of options listing P7 HMM banded opts.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2860 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-07-20T16:29:17Z,nawrockie
5b42957db5d026b350df5bfb6e32e304f4fce28e,Diana Kolbe,diana.kolbe@gmail.com,"Non-striped implementation of scanning CYK; dead-end in codebase.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2850 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-07-07T18:16:12Z,N/A
2629f3100dd38e52b059dd5b7f15cee889471aac,Diana Kolbe,diana.kolbe@gmail.com,"An alternative implementation of dpsearch, with
'straight' instead of 'striped' vectors.  Reference-style
implmentation, and not heavily optimized, but about the
same level of polish as the striped version currently has.
Moderately well debugged and tested.  At this point, 
the straight version is sufficiently and consistently slower
than the striped version (e.g., 1.5x vs. 2x relative to scalar).
Because of this, future development will return to the
striped version, and the straight version will be deleted in the
next version commit, to keep the working 'build' copy clean.

Also: sse_cm_dpsearch.c: eliminated a union structure,
in case that was interfering with type-based optimization.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2849 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-07-07T18:15:14Z,N/A
47a31bbb11b7f6d24b0c017ddd3ca3dd43c709e8,Diana Kolbe,diana.kolbe@gmail.com,"Un-static-ed wordify, so the function can be called
from other files.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2848 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-07-07T18:07:06Z,N/A
5e9b6608fce2e6f7478c73705a985a8b90a623de,Diana Kolbe,diana.kolbe@gmail.com,"vecprint_ps() function, for debugging output
of a 4x float vector.  Does not reorder in the 
case of striped vectors.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2847 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-07-07T18:06:02Z,N/A
8fa19290b75e6616f109714bd377a7e58d40bdaf,Diana Kolbe,diana.kolbe@gmail.com,"Local mode alignments (unaligned flanking sequence)
Needs polish.  Turn off and return to inside()
compatibility/comparison with
-DLOBAL_MODE



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2835 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-06-19T16:00:43Z,N/A
e0d13aa71ba67211679fe2d8ecd0f8d4462d5381,Diana Kolbe,diana.kolbe@gmail.com,"select and hmax utilities for epi16 vectors



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2834 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-06-19T15:58:07Z,N/A
535359994e4e93877fb6b3c25444967c2873d74c,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged revisions 2826 and 2827 of the 1.0 release branch back into
  this, the main trunk. These changes were made in the release branch
  to fix the BUGTRAX i14 bug in cmalign. See BUGTRAX for more info.

o The command used to svn merge was:
 svn merge -r 2825:2827
 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2828 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-06-12T21:22:03Z,nawrockie
bb1f107f532a4627ecfed337761135e50e2b485b,Diana Kolbe,diana.kolbe@gmail.com,"Fixes two array index out-of-bounds errors (loop control),
and a memory leak in the test driver.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2820 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-06-04T13:42:39Z,N/A
34588e5793d13ccc9af99413842e7e63aa092306,Diana Kolbe,diana.kolbe@gmail.com,"Standardizing some naming conventions, and 
cleaning up some debugging code.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2817 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-06-02T19:30:14Z,N/A
b66c6b02e2d57c8c2fbd735d59fde53d7b72bb07,Diana Kolbe,diana.kolbe@gmail.com,"Adjusted test driver to provide more timings in
a single run.

Also noted a problem with current behavior of
CYKFilter, re. saturating at neginf.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2813 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-18T15:03:19Z,N/A
fea953a321da05e0a6a4750f68a3596534071136,Diana Kolbe,diana.kolbe@gmail.com,"Groundwork for a consensus-only CYK Filter;
CM_CONSENSUS structure (different and separate
from CM_OPTIMIZED).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2812 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-14T14:44:14Z,N/A
881db8413f1323cb2ca0d3a092cf5f5496817aca,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: get values from ocm, not cm.
Affected MP_st when going 8 or more residues
without seeing a particular residue.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2810 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-12T18:16:09Z,N/A
cdbc73bcb3b43411717df4f6349f1c36537e3884,Diana Kolbe,diana.kolbe@gmail.com,"Major changes:
- sse_setlw_neginfv replaces most calls to _mm_insert_epi16()
- WORDRSHIFTX replaces calls to sse_rightshift_epi16(), which
  also used _mm_insert_epi16()

This is important because there is a known gcc bug (#14631)
affecting versions 3.4.x and possibly earlier also, which
makes calls to _mm_insert_epi16() completely unreliable and
likely to fail mysteriously (and silently) with optimization
on.  

- more stable patch for an earlier bug, which could have been
  unstable with -fstrict-aliasing (which is included with -02)

Minor changes:
- variable clean-up to correct warnings raised by -Wall

sse_CYKFilter_epi16() now passes most tests for gcc 3.4.x -O2;
however there are still some cases which have unacceptably
large error.  Also not quite behaving like the filter the
name suggests - doesn't break out when values saturate; still
in 'lobal' alignment rather than local.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2809 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-12T14:27:47Z,N/A
a1fb526b94cfcde9899a93b6f6070a8c03ef19e6,Diana Kolbe,diana.kolbe@gmail.com,"Fixes a major bug in calculcation of vec_Pesc
(for MP states) in CYKFilter_epi16().



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2806 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-07T17:28:20Z,N/A
c276f44f2dd15bebb3ef073c63a7a29f20297233,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: saturating adds for B_st; prevents underflow.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2805 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-07T14:39:55Z,N/A
d085b2228bae9a0af9caf9fe46f7e4b8db075788,Diana Kolbe,diana.kolbe@gmail.com,"sse_CYKFilter_epi16: clean for memory access
and no uninitialized values running small tests
under valgrind.  (Results wrong.)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2804 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-06T19:24:44Z,N/A
6e5401b676b4410c07ffae08e894add6de1ef241,Diana Kolbe,diana.kolbe@gmail.com,"General bugfixes - initializations, memory
dimensions for ocm->oesc, and unrolling several
loops because the #bytes to shift argument for
WORDRSHIFTX must be an immediate, not a variable.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2803 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-06T18:40:58Z,N/A
4d9ec8498f2fc36c2fd3b921bb057c768f0424f5,Diana Kolbe,diana.kolbe@gmail.com,"Important fix to WORDRSHIFTX macro (now correct).
Number of 16-bit words to be shifted should be
0 < x < 8
(In theory, x=0 and x=8 should work too, but it'd
be silly to call in that case because no shifting
would be required.)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2802 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-06T12:35:40Z,N/A
1f9b4b676e45f326092c18ae7f72c050a5f53639,Diana Kolbe,diana.kolbe@gmail.com,"cm_optimized_Free()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2801 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-05T18:35:17Z,N/A
7fe1d9b862c1e9dbae185e6a5f89c987fd8fee81,Diana Kolbe,diana.kolbe@gmail.com,"Expanding the CM_OPTIMIZED model, and conversion
from cm to ocm.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2800 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-05T17:43:16Z,N/A
2154a50bc55e264753f1f0bbc1c5228fec8d325b,Diana Kolbe,diana.kolbe@gmail.com,"wordify(), for converting float to scaled int16_t



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2799 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-05T15:46:07Z,N/A
885ea96e8edfd16a5ac5a20b2b415118921a1daf,Diana Kolbe,diana.kolbe@gmail.com,"Early version of sse_CYKFilter using 16-bit ints.
Compilable, and largely converted, but needs a lot
of additional support work:
 - no conversion from CM to CM_OPTIMIZED yet
 - should support local wrt sequence, because
   we don't necessarily expect precise bounds
   from whatever filter will be before this in
   the pipeline.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2798 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-05T15:37:46Z,N/A
1b2ca7b8ca491d92a19481f1fd600b510ee0289e,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix on sse_inside(); logic in using _mm_movelh_ps
to rightshift by two.  Probably never encountered,
since it would require using MP_st with d=2 or d=3
(i.e. loop size of 0 or 1).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2797 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-01T19:09:32Z,N/A
2d6edc3f6016824068dfbd04972d4909f40be079,Diana Kolbe,diana.kolbe@gmail.com,"Reorganization: header file; breaking utility
SSE routines to a separate file; static
Makefile (to be replaced later with a Makefile.in
to be processed by configure).  Also some
clean-up of comments.

'make' only produces object files currently;
'make test' builds the test drivers, but there
are no production executables.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2796 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-05-01T18:35:13Z,N/A
f4602cd5c8f5f992143edae6638d2a4b62495d89,Diana Kolbe,diana.kolbe@gmail.com,"This a work-around for a weird bug that I still
don't understand.  The old implementation used
a setup similar to hmax() to fill vb_sc with the
best score, re-using the same mask to copy the
corresponding values for vb_v, vb_j, and vb_i/vb_d.
However, with gcc -O2, best_[v/j/i/d/] would get
values from the first position of vb_[v/j/i/d]
_before_ the shuffle and selection was complete,
although the final values in vb_[v/j/i/d] would
be correct.  Furthermore, this behavior could
be supressed by using printf to output the values
in vb_[v/j/i/d] between the two shuffle/selection
blocks.

The new implementation uses a scalar loop to look
through the vb_sc values one-by-one, and record
the corresponding values to best_[v/j/i/d].  It
seems to be stable across the cases I've looked at.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2795 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-29T14:08:31Z,N/A
f5603b5035bcc02c39996845f58bdd92ea8497e1,Diana Kolbe,diana.kolbe@gmail.com,"More bugfixes for SSE DnC.  Some of these affect
sse_inside(), generally cases in which i0 != 1.
Currently passes sample tests (including traceback),
optimization off.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2793 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-27T19:27:20Z,N/A
2185319f48dc8ed60fdf676b03156f6f20fbc037,Diana Kolbe,diana.kolbe@gmail.com,"Two important bugs in SSE DnC; lots left.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2792 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-27T17:04:13Z,N/A
b1c78b69e2a24b45088cce5492327b52b41618a9,Diana Kolbe,diana.kolbe@gmail.com,"Debugging SSE DnC

- many memory access errors fixed (test cases currently 
don't trigger valgrind mem-check errors)

- some major fixes for IL->IL path in vinside(),
outside(), and voutside() - incompletely tested

- other minor fixes (loop control, etc.)

- Status: runs stably and moderately fast,
but results are not correct (sequence dependent)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2791 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-24T18:27:30Z,N/A
4e5f771dd496f3c70e9b6e39f4841e588cc4d58e,Diana Kolbe,diana.kolbe@gmail.com,"SSE port of D&C theoretically complete.
Compiles cleanly, but otherwise untested.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2789 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-17T22:47:23Z,N/A
6a05ef8e4df2ab373b2b23df437339852f4568ce,Diana Kolbe,diana.kolbe@gmail.com,"- SSE vji_deck support
- simplified calls for sse_free_vjd_deck(), sse_free_vjd_matrix()
- supports SSE_CYKDemands(), sse_vinsideT_size()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2788 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-16T20:37:07Z,N/A
e57376afe551b5425c8b8e3b116aa55f13b569df,Diana Kolbe,diana.kolbe@gmail.com,"Compilable but incomplete conversion of D&C to SSE.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2787 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-16T15:26:35Z,N/A
78ab582424def372e8e5393a437fe91f5f76de81,Diana Kolbe,diana.kolbe@gmail.com,"Fixes over-allocation for sse vjd decks; also
provides size calculation.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2785 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-14T14:59:16Z,N/A
99cd349cdf3d4875020663f4a02f41e4ee3d4c47,Diana Kolbe,diana.kolbe@gmail.com,"SSE implementation supports traceback through
SSE_CYKInside().  Calculation of shadow matrices
is vectorized; creation of Parsetree trace is
scalar by necessity.  Debugged and leak-checked;
see IMPLSSE_SMALL_TEST for example usage.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2783 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-13T18:29:56Z,N/A
e655f7ac87dc0145c8d937e0a5130cad798ce866,Diana Kolbe,diana.kolbe@gmail.com,"Wrapper functions SSE_CYKInside() and SSE_CYKInsideScore().
Traceback hasn't been tested yet.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2782 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-10T12:47:33Z,N/A
f6bdd8078c3d54ae5e1f3b96414d2ceac066387e,Diana Kolbe,diana.kolbe@gmail.com,"Clean, pre-calc'd esc vectors for MP_st.
Just under 4x speedup with gcc -O2 on test
cases (tRNA, RNaseP).  Not heavily optimized
with profiling, although some loops are
significantly unrolled and may be difficult
to move to more elements per vector.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2780 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-04T04:53:21Z,N/A
0c8088bd91c89489c393ffd44dbbeb29b44996aa,Diana Kolbe,diana.kolbe@gmail.com,"Cleaning up escv for single-emitting states; still
need to do pair emissions.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2779 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-04-03T14:45:24Z,N/A
3a3988269bf79a3aba02563ed129c228b71dfc24,Sean Eddy,sean@eddylab.org,"Corrected proofs returned to publisher; see Proofs subdirectory.
Merged new.bib into lab master.bib.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2777 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-27T17:18:32Z,cryptogenomicon
e7f93776920b7a9040188f769b15095f6c196cfe,Diana Kolbe,diana.kolbe@gmail.com,"Long-outstanding changes in my working copy:
target-length correction for trcyk, using a 
single-hit model.  I'm committing this now
mostly because of interspersed changes that
are required for current easel/infernal library
calls, rather than for it being particularly
useful.  10-15 Sep 2008 for notes.

Does not seem to significantly affect lambda values.
Use lenCORREX = FALSE for the old behavior (as
described in the paper).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2776 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-16T18:49:30Z,N/A
f5b96a2ae56bc567625c3349b7095d1f52da806b,Diana Kolbe,diana.kolbe@gmail.com,"trcyk and truncyk_check were added as make targets
for Infernal 1.0 RC, but I apparently never
committed that change to the main branch.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2775 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-16T18:42:27Z,N/A
03cf9ab36c442572d4a24d46a7ce9203c2661bd1,Diana Kolbe,diana.kolbe@gmail.com,"- Corrected boundary checks prevent NAN values in escv
- Fixes an underflow error on el_self calculation
- Moved serialized IL->IL loop inside the dp loop,
where it should have been originally

sse_inside() now passes basic correctness tests 
(ss.cm, ds.cm, bif.cm)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2771 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-12T17:55:44Z,N/A
368f618d9cc78bc29d5c9342d8f9c6912bbdcaaa,Diana Kolbe,diana.kolbe@gmail.com,"Fixes a memory leak in the test drivers.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2770 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-12T07:55:07Z,N/A
96eb81e53f66c79b3c3a49e6f96186dfdcf63b7d,Diana Kolbe,diana.kolbe@gmail.com,"Memory leak fix: if BandCalculationEngine()
is called in a loop, FreeBandDensities() must
be called in between each time, as the former
will overwrite gamma without checking to see
if it is already allocated.

This error is likely pervasive throughout Infernal.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2769 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-12T07:49:48Z,N/A
639e9db7c3077b735fc8fe55103e0f4e3708c028,Diana Kolbe,diana.kolbe@gmail.com,"More inefficient boundary checks.
No segfaults, but incorrect, slower than scalar,
and leaks memory.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2768 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-12T07:29:28Z,N/A
505918399796fabf7d1815eaf9f5815733a49161,Diana Kolbe,diana.kolbe@gmail.com,"Ugly, hacky checks on boundary conditions to prevent segfaults.
Need to switch to pre-calculated esc vectors as soon as this
function hits correctness.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2767 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-12T06:49:14Z,N/A
23b9941d7aaac329568c680e97acc3dbe0f96783,Sean Eddy,sean@eddylab.org,"Revised paper is now submitted.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2766 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-11T21:07:34Z,cryptogenomicon
28294cb7bf35cdf8d49e1ba18f41f751e4234d26,Sean Eddy,sean@eddylab.org,"revised the response-to-reviewers.txt


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2765 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-11T19:25:38Z,cryptogenomicon
49e92e16b151c513bb3f6ff4cb56b96f33092ae1,Diana Kolbe,diana.kolbe@gmail.com,"Fixed two segfaults, identified a (major, repeated) third



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2764 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-06T23:49:50Z,N/A
d8995857574c24bee713d50375ee8c5a36c6f60f,Diana Kolbe,diana.kolbe@gmail.com,"Test driver for sse_cm_dpsmall.c
(currently segfaults)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2763 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-06T23:26:57Z,N/A
1e9357be4b328f5f49d3919ffe42d648317f383d,Diana Kolbe,diana.kolbe@gmail.com,"SSE conversion propogated to end of sse_inside()
Needs a test driver and presumably a lot of debugging



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2762 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-05T21:44:54Z,N/A
27b74b98221d44b3620ad2ce33af7d67fdac9d44,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed options processing bugs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2761 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-05T20:52:04Z,nawrockie
157209c7f67612e0e7a2a56e65e8aeda6858bdc2,Diana Kolbe,diana.kolbe@gmail.com,"SSE conversion for MR/IR states.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2759 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-04T16:45:33Z,N/A
9e13ff6549a34a9d4daa83274a42f4ee555b4a65,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed spelling typo.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2758 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-04T16:10:20Z,nawrockie
4b0a6d129e7226862b248ec586aad37a83fd93f7,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added changes.pdf, which is manuscript.pdf with changes from the
  original submitted version (r2688) highlighted in yellow.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2757 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-04T16:09:29Z,nawrockie
24ccfefb84b5aa67e02f33676d337549f07b8198,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added 'make pdfsubmit' option to make pdf version of manuscript, to
submit. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2756 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-04T15:47:37Z,nawrockie
0e1f855b91719b3a911a2c6629924e6f1032890d,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated manuscript.tex.
o Copied figs/roc-short.pdf and figs/roc-short.eps into top level dir,
  so manuscript.tex includes them at top-level (not within figs/
  subdir).
o Added EPN's draft of responses-to-reviewers.txt for Diana and Sean's
  perusal. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2755 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-04T15:29:25Z,nawrockie
1f62171cad9b0f194ff0faaeb3845e56836f23fd,Eric Nawrocki,eric.nawrocki@gmail.com,"Many changes here were performed so the bioinformatics people could
make the document in postscript format instead of pdf.

o Added manuscript.tex with all sections collapsed into one document
  (instead of included as in main.tex and bi-main.tex). This version
  will be submitted.
o Added 'make submit' to Makefile to make 'manuscript.ps'. 
o Updated roc figure to be correct size (86 mm).
o Added roc-short.eps for latex (non-pdflatex) document creation.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2754 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-04T15:22:46Z,nawrockie
7260af8de6e4fed5fe2cc6ac6653d4413bb2b92b,Diana Kolbe,diana.kolbe@gmail.com,"SSE conversion for IL_st.  IL->IL transition
is completely serialized, other transitions
should still have the same speedup as other
state types.

There's a possibility for using a lazier evaluation
strategy for the IL self-loop, but it will be
a tradeoff between fewer loop executions, and
data-independent loop conditions, which prevent
branch misprediction.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2753 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-04T15:21:31Z,N/A
aa7227ba1bad6d578db463171806e0e534ad3427,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a reference.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2752 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-04T13:55:08Z,nawrockie
bff2ba3a94850a9aba3a94d17592539f685416ec,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2751 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2009-03-03T23:10:53Z,nawrockie
bfe677ef6eb6c4cacdf906f2b7a1690f4b888ee5,Eric Nawrocki,eric.nawrocki@gmail.com,"o Finished revisions based on reviewer's comments.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2750 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-03T23:06:34Z,nawrockie
0d4c61025e787b2d1f70c09a9ab36c2a2fe0b88b,Eric Nawrocki,eric.nawrocki@gmail.com,"o In process of updating text based on reviewer 2's suggestions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2749 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-03T15:23:49Z,nawrockie
f8b3b41d2648496eb3f9098f42f8cd9c10414a11,Diana Kolbe,diana.kolbe@gmail.com,"SSE conversion for ML_st (but not IL_st, which
will need to be handled specially).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2747 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-03-02T21:25:07Z,N/A
de33f06348b57575761cffb7b3251f607186a3e2,Diana Kolbe,diana.kolbe@gmail.com,"Propogated SSE conversion through MP_st case.
This is the first case that requires calculation
of emission scores.
Currently, esc values are not being pre-calculated
and stored like they probably should be, but
are being built from scalar values whenever needed.

SSECYKScan has an example of pre-calcing esc vectors,
but because of different matrix indexing (jvd vs. vjd)
the code can't just be cut-and-pasted.  This change
will probably be put in once the function is verified
to be working, at the beginning of the optimization
process.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2743 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-27T21:08:59Z,N/A
4a1e7ea7e998b30c82f27521fddff7a6d5343007,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix on B_st, k=0



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2742 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-26T13:59:14Z,N/A
3c0f65d512775eedd6dd913a4daa1f1c357e35d2,Diana Kolbe,diana.kolbe@gmail.com,"SSE conversion propogated through B_st case.
Untested, and a lot of possibilities for breakage.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2741 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-26T13:41:57Z,N/A
5171053669e83e4e71bade41a84d2297f6756d1a,Diana Kolbe,diana.kolbe@gmail.com,"SSE changes propogated through case for D and S states.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2740 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-25T17:23:12Z,N/A
083b43740e07edbbfe4511e15cbb2e35e66efa48,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated the text to reflect the more significant changes suggested
  by reviewer 1. The previous commit only fixed minor changes (mainly
  typos) suggested by the same reviewer.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2739 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-25T16:33:33Z,nawrockie
3313da0d9ca1c5863401a5e2bf1aa2939ecdcb15,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated text to include *all* of Reviewer 1's (reviews were for
  revision 2688) ""copy-edit"" suggestions. I had no problem with all
  but one of these, which was the first it required changing the very
  first sentence of the introduction from:

  ""When searching for homologous structural RNAs in sequence
  databases,
  it is desirable to score both primary sequence and secondary
  structure conservation.""

  to:

  ""When searching for homologous structural RNAs in sequence
  databases,
  scoring secondary structure in addition to primary sequence is
  expected to improve accuracy relative to scoring primary sequence
  alone.""

  The reviewers suggestion was:
  >""it is desirable to score..."" -->
   ""it is expected to improve accuracy if both primary sequence and
    secondary structure conservation are scored"" (""desirable"" is
    somewhat vague)

  I think the new wording is clumsy, and would like to ignore this
  suggestion as 'improve accuracy' is vague as well in my opinion.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2738 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-25T12:22:25Z,nawrockie
76681b40447755e4282bccf99d2a4d7c81ea045d,Diana Kolbe,diana.kolbe@gmail.com,"Abstracting out the sse deck to it's own structure.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2737 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-24T17:57:50Z,N/A
a31cf08d2f0f2d57f0df097cd4cb0843e4120195,Diana Kolbe,diana.kolbe@gmail.com,"Deckpools and associated function converted to
vector memory management (both raw, unaligned
access, and aligned cell access).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2736 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-23T20:44:25Z,N/A
617b98af924107fa95931321df6fdcf32e4ee571,Diana Kolbe,diana.kolbe@gmail.com,"Skeleton of an SSE conversion (non-striped) for
cm_dpsmall.c.  Banding and all references to it
have been cut for the time being.  Function
names have been changed to avoid conflicts, but
very few other changes have been made so far;
changes will slowly percolate through starting
with a no-traceback version of inside.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2735 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-23T20:07:00Z,N/A
38800cbd43af65d90c014dec66c35f3258746dba,Sean Eddy,sean@eddylab.org,"Fixed #h41, replacing esl_opt_IsDefault() calls:
 when testing whether an nonboolean option is ON vs. OFF, use esl_opt_IsOn()
 when testing whether an option is ON but not in default state (for
 printing header of options that are in use), use esl_opt_IsUsed()

7 tests are failing now in test suite. These appear to be bugs in
option handling. Will commit anyway and punt the fixing over to Eric.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2733 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-14T17:40:35Z,cryptogenomicon
55b71b3a955d8101cc3cef6c35956b37b585b5d1,Diana Kolbe,diana.kolbe@gmail.com,"Dropping 'Ref' from name of SSECYKScan(),
as it is increasingly inaccurate.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2731 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-13T14:48:06Z,N/A
3c1175a5b76ef2a03c891eba24ace2d43ea6375b,Diana Kolbe,diana.kolbe@gmail.com,"Taking out some stub code for clarity; these
optimizations help only if the compiler is not
doing automatic optimization.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2728 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-06T18:17:33Z,N/A
2fee7895920b901fad1c652a73302897d01e60c6,Diana Kolbe,diana.kolbe@gmail.com,"Heavily unrolled BIF loop.
Test driver now allows explicit choice of L.

Current speed: ~1x on seqs of length <W, ~2x
on seqs of length >>W, compared to RefCYKScan.
Faster than FastCYKScan (no banding), but by
smaller margins.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2727 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-02-06T15:20:49Z,N/A
79770b1663469d64f86fe9f774e4cbca337b381b,Diana Kolbe,diana.kolbe@gmail.com,"commented concern re: potential bug



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2724 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-26T21:23:47Z,N/A
bb28810f2a5bac684e1961c5675ba5f2d8981c8c,Diana Kolbe,diana.kolbe@gmail.com,"Accumulated changes.  Approximately the same speed
as (scalar) RefCYKScan, under a range of compiler
options.

Commented out direct access vectors for the main
non-B recursion provide a very minor speedup (~5%),
and may be wanted later.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2723 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-26T21:13:18Z,N/A
df015df20802d92425f4b9cf9a26ec0d27c89bf0,Diana Kolbe,diana.kolbe@gmail.com,"Accumulated changes:
- calculation of dkindex var for B_st
- separating out IL_st from main recursion
  (this is the equiv. of the delete path for HMMER)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2722 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-26T17:53:13Z,N/A
3687a4afcc4474701691487b3ff7017faeda8093,Diana Kolbe,diana.kolbe@gmail.com,"New bifurcation loop cuts exec time by ~25%.
Still slower than scalar.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2721 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-23T16:50:59Z,N/A
330dc834e34898ab1310d3d32b8dbc7f85aaf80a,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2718 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2009-01-17T20:44:11Z,nawrockie
cf7035e79f3ca3515fc0c0314440c6a280c764fb,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added Manuscripts/filter_thresholds/ and files to make draft 0 of
  the HMM filter thresholding manuscript. 
o Original SVN repository location was:
  https://svn.janelia.org/eddylab/nawrockie/src/manuscript_filter_thresholds
  That includes all the little commits I made from scratch to draft 0.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2717 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-17T20:40:45Z,nawrockie
63d36694537e2153819b8b0fdff0c093cbbd0fad,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged userguide fix in 1.0 branch so that userguide can be built
  from src for Debian 
command: 
svn merge -r 2714:2715
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

o This was the *only* change with this commit.            



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2716 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-16T23:07:44Z,nawrockie
c159cd1c0fb08e34cd1ead4e8637cf9c4af7ee5f,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged userguide fix in 1.0 branch so that userguide can be built
  from src for Debian 
command: 
svn merge -r 2712:2713
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

o This was the *only* change with this commit.            



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2714 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-16T21:41:03Z,nawrockie
497de23d7f567c2e6319a517b3d8acb2ea7c9f41,Diana Kolbe,diana.kolbe@gmail.com,"Pass $CC to hmmer's configure.
icc and gcc don't seem to cross-link well when
using vector code.
This is a short-term fix, and I really need
to amend Infernal's configure so that hmmer
doesn't need to call it a second time.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2712 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-16T15:05:36Z,N/A
e7c301b5efb671b72230d5ab4d9499c956a2006b,Sean Eddy,sean@eddylab.org,"fixed typo in ack; then shortened a bit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2711 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-13T21:05:50Z,cryptogenomicon
50f16d167c4f91bcc85a048973fc5c800bcde328,Sean Eddy,sean@eddylab.org,"1.0 release completed (1.0rc5 promoted)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2704 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2009-01-13T20:19:57Z,cryptogenomicon
9f3cb021c2428aceb85ed1e9bca30dcab582467e,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added a missing paranthesis.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2690 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T22:49:55Z,nawrockie
5052ab9064eba2243dee2bb2d493a7be7a6a5ef9,Eric Nawrocki,eric.nawrocki@gmail.com,"o I had forgotten to add the shortened ROC curve fig to the svn
  repository. It's included here.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2689 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T22:02:05Z,nawrockie
76cae93225095486300abc2e5129a0a008d521c3,Eric Nawrocki,eric.nawrocki@gmail.com,"o Cleaned up the .tex files by removing comments to myself and
  commented out older versions of passages, etc.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2688 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T20:58:15Z,nawrockie
f9364bb57602cb27a9b061925dc565fe96433462,Eric Nawrocki,eric.nawrocki@gmail.com,"o A 'make' now successfully builds the preprint version.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2687 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T20:52:31Z,nawrockie
cf8643312c411fbf0241f3a29e5fa2ec8c3b9862,Eric Nawrocki,eric.nawrocki@gmail.com,"o The two page minimum has been achieved.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2686 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T20:45:43Z,nawrockie
467c4625ccf396f2d6d36b80156b2b9c2af0d454,Diana Kolbe,diana.kolbe@gmail.com,"Updated benchmark driver for current usage.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2685 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T16:47:51Z,N/A
e0fd0660f47e84e7b30aa128b99491ffb520c285,Diana Kolbe,diana.kolbe@gmail.com,"Stub for SSE implementation of Infernal.
File and function names are likely to change.
Currently provides:
SSERefCYKScan()
which is slower than the equivalent scalar
function, at least for short sequences.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2684 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T15:22:41Z,N/A
c1566d920690ec0f206855c3ceb0c89d0b0fa9c3,Eric Nawrocki,eric.nawrocki@gmail.com,"o Still shortening. It's still too long.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2683 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T15:06:52Z,nawrockie
c4f089488d7b9060888d01d1578a3014fd181cee,Eric Nawrocki,eric.nawrocki@gmail.com,"o Following a prompt ""desubmission"" of the app note from
  Bioinformatics due to excessive length (limit is 2 pages in the 'bi'
  format (with make bi)), cuts have been made to reduce the size. 
  Still not down to 2 pages. Current length is about 2.3 pages, with
  only references on the third page.
o Main cut was to remove the description of each of the 4 main steps:
  cmbuild, cmcalibrate, cmsearch and cmalign. A one line sentence
  describes each step now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2682 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-22T10:58:38Z,nawrockie
857ba8d6b16b52a52ff58ee2e43dbe1295c14da6,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added Gutell CRW reference for SSU/LSU alignments used in timings. 
o Can't-for-the-life-of-me figure out why font size in References
  section is small.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2681 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-18T19:21:02Z,nawrockie
7a27a4b321bf51a77f3d05ee69555f01ce8c65be,Eric Nawrocki,eric.nawrocki@gmail.com,"o Final check of 00README revealed a few typos.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2680 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-18T18:55:53Z,nawrockie
f539a8130eea87e507a00bf5e9a4e0b794814fcd,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2679 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-18T18:52:36Z,nawrockie
5b7ab02a5e91bce402af28ba01b065fef5d5af20,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2678 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-18T18:52:05Z,nawrockie
599d900d99f5aceba14580bc51f6045fd855d42f,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2677 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-18T18:46:59Z,nawrockie
08dd2bae0a4f5503d37822ac2bdcecb220cd2efa,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed names of executables in rmk files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2676 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-18T18:15:56Z,nawrockie
7e21b6e65fe054ef43b7ac0bf84261189e3b82d8,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated text (timings-caption.tex and bi-main.tex) as per Sean's
  suggestions.
o Updated timings in table (timings.tex) and ROC plot. They now
  correspond to 1.0rc5 infernal executables.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2675 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-18T18:10:57Z,nawrockie
81d47d10904828068eba9a03c644bc73312bfbec,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added benchmarks/timings-1p0-appnote dir with files to reproduce the
  timing experiments in the 1.0 applications note. The 00README
  explains how to do it. There is a big 10 MB sequence file
  (/timings-1p0-appnote/searches/10Mb.fa) included.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2674 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-18T14:54:56Z,nawrockie
bdea525fa3719be4524302186b44c0e7ecdfce4d,Sean Eddy,sean@eddylab.org,"esl_fileparser_Open has changed from 2 to 3 args; now includes <env>
environment variable arg, and if non-NULL, will look in this variable
for colon-delimited list of directories to try to find file in.

1.0rc5 release; 1.0 release notes updated/merged from 1.0 branch.




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2673 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-17T22:58:46Z,cryptogenomicon
624c6e380e7450ee4640ea01078cbabb9c528317,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed typo/bug in rmark_clusterfy.pl.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2669 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-15T14:12:30Z,nawrockie
24274ea8b5587798ca4980cbec442e9c8ed4810a,Eric Nawrocki,eric.nawrocki@gmail.com,"o The new rmark-2 CMs are calibrated with what will be 1.0rc5's
  cmcalibrate. The previous files (prior to this commit) were
  calibrated with 1.0rc4.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2668 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-15T14:00:27Z,nawrockie
aa72607c797bfafe4ef5d7e5860732a19b454d59,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged typo fix in filter.tex of userguide from 1.0 branch with
command: 
svn merge -r 2658:2659
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

o This was the *only* change with this commit.            


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2667 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-14T22:30:30Z,nawrockie
4112f67ddbc9b27e0a1e78e8293179b7002c5315,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged typo fix in filter.tex of userguide from 1.0 branch with
command: 
svn merge -r 2656:2657 
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

o This was the *only* change with this commit.            


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2665 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-14T22:26:35Z,nawrockie
3b14800df75126bd97cd62d209f13bbcd7728fe3,Sean Eddy,sean@eddylab.org,"Small changes, including:
- use scientific notation not E notation: $10^{-7}$ not 1E-7
- use \citet{Obama90} when you want the reference to come out
  as Obama et al. (1990) instead of (Obama et al., 1990);
  in numerical mode, \citet gives Obama et al. [21], whereas
  \citep just does [21].



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2663 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-13T15:19:32Z,cryptogenomicon
cca5c7e733386cda3e8dd47f4004c851b4e940e1,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor edit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2662 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-12T18:11:46Z,nawrockie
cf5084208dd6bee84c6555317dcbc212434089e8,Eric Nawrocki,eric.nawrocki@gmail.com,"o Incorporated edits and space saving text cuts from Fred and Tom. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2661 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-11T14:23:49Z,nawrockie
e6f40d39e79be5580b93a44c2b31afabd7cf6cac,Eric Nawrocki,eric.nawrocki@gmail.com,"o Edits made based on critical suggestions from Rob and Elena.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2660 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-10T19:44:02Z,nawrockie
636e9899be880922bf0b1392d0d7b9a5660dec20,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated ROC curves. One of the 1020 (51 fams * 20 chromosomes)
  non-filtered runs had crashed and was not included in the results, it
  is now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2659 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-10T02:39:22Z,nawrockie
d2cf493913baaf83a3169cda56a8e20f45d31f5d,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged typo fix in filter.tex of userguide from 1.0 branch with
  command:
  > svn merge -r 2656:2657
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0
o This was the *only* change with this commit.	


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2658 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-09T13:26:17Z,nawrockie
9df751a30972f275ea4308bc3b696bb95bb492f0,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated search timings for LSU non-filtered. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2656 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-09T12:04:04Z,nawrockie
9f867995a4ef298f6d9dda6d22adb447c4183f88,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2655 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-08T20:49:36Z,nawrockie
cd834a951737b0dd3d30015b14a658052e6d32b2,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2654 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-08T20:18:58Z,nawrockie
b2cef9899f8fee7949686c94839a9812868d6679,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2653 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-08T20:16:57Z,nawrockie
a64b403bf15f0f4900a7bc510c60f75e969808d8,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2652 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-08T20:16:05Z,nawrockie
19695878105faccaaa114e4f5e32bb10e0e3a7d0,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2651 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-08T20:14:38Z,nawrockie
0e483f6d56deea94512c332cd7cd5d6086d0da2d,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2650 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-12-08T20:11:30Z,nawrockie
b2ed3cca96c150eb245e23b8d9dcee0bcb7b54d0,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added perl scripts to the rmark-2 benchmark dir for generating
  'pseudogenomes'. (hmm_generate_embed.pl and hmm_generate_only.pl). 
o Added the real.15.hmm HMM parameter file read by the hmm_generate_*
  scripts. This HMM is a 15 state fully connected HMM trained on 30
  100 Kb chunks of real genomes (10 from archaeal genomes, 10 from
  bacterial genomes, 10 from eukaryotic genomes) via EM. This 15 state
  HMM originates from (was originally named):
  ~nawrockie/notebook/8_0326_inf_default_gc/hmmemit_dir/0507-winner-15state/0504-1.15.57.3.hmm 
  See the 00LOG in that notebook dir for more info on how it was
  created. 
o Updated the 00README to include info on how to generate
  pseudogenomes with these scripts, and with comments on how rmark-2
  differs from rmark-1 (which is in benchmarks/cmsearch-rmark/) that
  was originally published/released with the QDB paper.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2649 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-08T20:04:27Z,nawrockie
321c30a712d9e63718d2c8c8123f1640a354ff32,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added the benchmarks/cmsearch_rmark-2/rmark-2-test dir for running the
  small test instance of the benchmark as described in the rmark-2
  00README. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2648 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-08T14:00:30Z,nawrockie
0897f0d2135319649eb5eb153a4e1dc7ab4e6691,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added calibrated CMs for the rmark-2 benchmark. These are required
  for reproducing the 1.0 app note benchmark results. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2647 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-08T13:53:52Z,nawrockie
f17bd7746d950aaa33b2035d9c7bc7c484de98ae,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added the sequence files for the rmark-2 benchmark.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2646 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-08T13:46:55Z,nawrockie
db1d32a65bc90ba103abb99d965b5efc5aed9fd2,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added the rmark-2 benchmark. This is the benchmark used in the
  infernal 1.0 applications note publication. 
o The goal is to have all required files for reproducing the benchmark
  (except the infernal 1.0 binary executable files) to be included in
  this dir. 
o The 00README explains how to reproduce the benchmark that appears in
  the app note.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2645 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-08T13:43:05Z,nawrockie
3dfc32daabf785818edb2030ca7f0c864c4b5259,Eric Nawrocki,eric.nawrocki@gmail.com,"o Minor typo fixes and edits.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2644 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-08T11:22:57Z,nawrockie
db19b33e6340b7d21d42413583abf8958c756a3d,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added bi-main.tex, a tex file that creates a pdf that is formatted
  like a bioinformatics applications note.
o Added 'make bi' in Makefile to create bi-main.pdf.
o Added bioinfo.cls, natbib.sty, natbib.bst, stfloats.sty,
  chngpage.sty, and flushend.sty. These are required to build
  bi-main.tex
o Further broke down some of the sections to minimize redundancy of
  actual text of the document in main.tex and bi-main.tex. As is,
  there's almost no redundancy, but there is some, specifically the
  ""Funding section"" and the Table caption. I was unable to figure out
  how to get main.tex and bi-main.tex to input this text from one
  external file. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2643 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-07T18:38:40Z,nawrockie
43d3aacf5521ad3ecc0702873f8bc79330da61f3,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated roc plot to rmark-2, 10 Mb search in a realistic
  pseudo-genome.
o Updated table timing stats.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2642 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-07T17:09:12Z,nawrockie
29b8f875767fe46f3dbfe6ba8619e58df5320214,Eric Nawrocki,eric.nawrocki@gmail.com,"o main.tex now uses \input{} to include each section.
  Each section is now it's own .tex file. Motivation was so I can create
  a version of main.tex that uses bioinformatics formatting instead of
  the default Eddy lab preprint formatting. That bioinformatics
  formatted main.tex has not yet been created.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2641 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-07T16:39:42Z,nawrockie
8bc7c4162c0e575d370450f696cda0276ae0f856,Diana Kolbe,diana.kolbe@gmail.com,"Minor word choice changes, and consistent verb
tense for describing the benchmark.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2639 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-03T20:23:34Z,N/A
887c2a524451858d6474c3052bc5ba3acc0b0ad7,Sean Eddy,sean@eddylab.org,"Sean's revisions. 
Added new.bib, for any references that aren't in the master.bib yet;
right now it contains just one, Cole09.
I think this is ready for proofreading & comment from the lab.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2638 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-12-02T18:15:58Z,cryptogenomicon
3ab1060e5c1fc7dc2e624032fa92e7eeba4c4e2f,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged bug fix related to cmsearch --fil-T-hmm and --fil-E-hmm from
  infernal-1.0 branch with command:
  svn merge -r 2630:2631
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

o This was the only change in this commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2632 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-11-20T20:05:27Z,nawrockie
f4b1a0ee753efdcda406e404f7f5e8ea5ce9eb06,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed two minor typos in user guide. (Same typos as fixed in branch
  1.0 revision 2627).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2628 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-11-14T11:18:45Z,nawrockie
8685e9b5b1afa2cefba7ca06b4c4e9274642081c,Eric Nawrocki,eric.nawrocki@gmail.com,"o typo fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2625 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-11-11T23:55:30Z,nawrockie
87003a4f012c167d96778c055a680d9afc248294,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged MPI bug fix from infernal-1.0 branch with command:
  svn merge -r 2622:2623
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

o added --hmm-W and --hmm-cW options to cmsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2624 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-11-11T23:45:42Z,nawrockie
c1e883988f6f7fdd8d027b4b85c5aa79b9c5ee74,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged MPI bug fix from infernal-1.0 branch with command:
  svn merge -r 2620:2621
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0
o fixes bug with MPI apps hanging if a required file (such as cmfile)
  does not exist.
o see 2621 log in 1.0 branch for more details


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2622 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-11-10T13:21:15Z,nawrockie
8c4917e78d7825000f14884cd03558fd27c93d01,Eric Nawrocki,eric.nawrocki@gmail.com,"o Majority of changes made to make Infernal compatible with new
  esl_msa.c::esl_msa_ColumnSubset() function prototype.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2620 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-28T22:04:19Z,nawrockie
2b6a4d283f01c1e36266c84430b6b306ae7d773c,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged minor bug fix from infernal-1.0 branch with command:
  svn merge -r 2616:2617
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0
o see the branch log for revision 2615 for more details.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2618 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-27T12:28:54Z,nawrockie
006568e8b8d5e15d2e818c561f3eb3c3d8568ecb,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged bug fix from 1.0 branch with command:
  svn merge -r 2614:2615
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

o see the branch revision log for 2615 for more details. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2616 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-27T11:35:27Z,nawrockie
f21760eaa20a8d300e104ca199f5150a5abe6c91,Sean Eddy,sean@eddylab.org,"esl_strtok() prototype simplified, removing toklen.
esl_strtok_adv() used instead where toklen is needed.

esl_sqio_FormatCode is now esl_sqio_EncodeFormat.

Changes from 1.0rc3 release committed: includes man page construction
by sedition in Makefile.in.





git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2613 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-25T15:43:21Z,cryptogenomicon
1d68336d36eb99bbe4b1a2836e3dfe62d267f46f,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed typo in userguide; default cmsearch E-value cutoff is 1.0, not
  0.1.
o This identical fix was made in parallel (not via a svn merge) as
  revision 2612 in the 1.0 release branch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2611 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-15T10:22:49Z,nawrockie
f8fdc5df8e1847a5a9bd2c86364154584c9eedcb,Eric Nawrocki,eric.nawrocki@gmail.com,"o Bug fix: ':' now only appears in cmsearch markup for positively
  scoring basepairs. ' ' appears for negatively scoring basepairs, and
  '+' now never appears.

o cmsearch manual page updated.

o This svn commit is identical to revision 2610 in the 1.0 release
  branch of infernal. That is, these changes were made in parallel in
  the trunk (here) and in the 1.0 release branch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2609 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-13T21:58:35Z,nawrockie
f0c0ead46310b6988d53a68dbfb5f4e2647644aa,Diana Kolbe,diana.kolbe@gmail.com,"Display changes for midline on marginalized stems.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2607 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-08T14:24:18Z,N/A
43afb79448e18b63d455d3c78c2b34a21c7528fd,Eric Nawrocki,eric.nawrocki@gmail.com,"o bioinformatics_appnote_description.txt: the description of an
  application note to submit to Bioinformatics copied from their
  website. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2605 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-06T18:15:10Z,nawrockie
81bd6f35d12d17306c4b74d4280d3ba03255cebb,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added inf-1-appnote directory in Manuscripts/ to hold a short,
  bioinformatics applications note style writeup of Infernal 1.0.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2604 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-06T18:13:17Z,nawrockie
3dce5854afabfed1e6fdce03f4024dd57c88100e,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged revision 2599 of 1.0 branch into (this) the main trunk with
  command:

  svn merge -r 2598:2599
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

  This commit is ONLY the changes from that svn merge.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2600 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-10-01T13:19:23Z,nawrockie
94d317f397b9c3a3fd6a3e22b553441a1d028e74,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged revision 2597 of 1.0 branch into (this) the main trunk with
  command: 

  svn merge -r 2596:2597
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

  This commit is ONLY the changes from that svn merge.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2598 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-09-30T15:36:11Z,nawrockie
38251e96cf5365b224278229cecf63b112c3f557,Eric Nawrocki,eric.nawrocki@gmail.com,"o Really fixed the cmsearch --hbanded bug I thought I had fixed with
  the immediately previous commit. The previous solution was not a
  complete one. The real, complete solution required fixing how cp9
  bands are set in some rare cases, by setting min position as i0-1,
  not as 0. This bug only caused a problem when i0 != 1, which is
  possibly why it went undetected as long as it did.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2593 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-09-23T10:16:34Z,nawrockie
db6ea5792b7a2a89baa68fac0aa2729757e98b36,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed bug with how cmalign processed options.
o Fixed bug with very rare cmsearch --hbanded banded matrix updating
  in cm_mx.c and cm_dpsearch.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2592 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-09-23T01:39:22Z,nawrockie
8707af35df1686631acfe6f7a952798c4c41b9cd,Eric Nawrocki,eric.nawrocki@gmail.com,"o main changes:
  merged --merge option to cmalign from code in the 1.0 branch with
  command:

  svn merge -r 2568:2572 https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0

  and fixed all conflicts manually.

------------------------------------------------------------------------


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2588 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-09-18T14:48:04Z,nawrockie
82ce3d5960b6d2844f1d24dcead54b8caf0a79c9,Eric Nawrocki,eric.nawrocki@gmail.com,"o The changes described below are very nearly identical to those
  committed in the 1.0 release branch /infernal/branches/1.0/src/
  with revision 2576. However, they are NOT the result of an svn
  merge. Instead I had to be careful to copy and paste the same
  changes in both the trunk and the branch. The reason I did it this
  laborious, less safe way is b/c the functions that were modified had
  already been changed significantly in the trunk relative to the
  branch. I didn't want to deal with resolving the conflicts following
  a merge and instead trusted myself to make identical changes in the
  trunk and branch.

o dispatch.c, funcs.h, cm_dpalign.c: 'fixed' posterior labelling of
  residues from cmalign so that the posterior now shows the posterior
  probability that residue x aligns at position i of the alignment. To
  achieve this we now marginalize over possible endpoints (over i for right
  emitters, over j for left emitters), and add probability that
  MATP_MP left emissions were emitted by MATP_ML states, and that
  MATP_MP right emissions were emitted by MATP_MR states.

  Previous to this commit, posterior values were showing the
  probability mass that passed through the cell of the vjd matrix
  that corresponding to placing residue x and position i, which
  requires no marginalization over end points, but doesn't equal
  the probability that residue x aligns at position i.

  The optimal_accuracy_align* functions STILL return the parsetree
  that maximizes the sum of probability mass that goes through each
  matrix cell corresponding to a node of the parsetree, with the
  important bug fix that now MP states do not have their posterior
  value doubled during the DP recursion (which I was doing before b/c
  I thought it was correct).

o while I fixed the posteriors I made it possible to annotate cmalign
  --sample alignments with posteriors as well.

o cm_modelmaker.c was a typo fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2583 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-09-18T14:03:26Z,nawrockie
57dd6fa1969e0073cefcbd5952ebd391a0403b49,Sean Eddy,sean@eddylab.org,"Added a compile/run test to verify that SSE2 instructions actually
work on the platform, as opposed to the compiler being able to
successfuly compile SSE2 code. Athlon/Linux/gcc platforms are an
example where the compiler will generate code the platform can't run.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2577 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-09-17T21:46:36Z,cryptogenomicon
45f771a920aa079b0bfd9a364363623109878ac3,Diana Kolbe,diana.kolbe@gmail.com,"hmmernal branch of hmmer is now an external, like easel.
Makefile will configure and make infernal/hmmer
(but not autoconf it - must be done manually)

minor changes to build_sub_cm() calls in testsuite
(looks like an API change).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2573 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-09-11T16:58:18Z,N/A
7d45ede953cc4280e114aa3597f6b2a25b1994fa,Eric Nawrocki,eric.nawrocki@gmail.com,"o Moved Alignment2Parsetrees() function from cmalign.c to more
  appropriate cm_parsetree.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2566 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-09-08T13:05:19Z,nawrockie
a9062fcb83b768544da3efcf5dbd95115f1181d6,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed off-by-one error with setting CP9 transition scores in
  cp9_modlemaker:sub_build_cp9_hmm_from_mother() that causes node
  hmm->M's final node begin probability to not be set.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2563 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-25T18:09:00Z,nawrockie
d8a777d1a66ed2f31137dd2e57dd08950791587c,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed typo in cmbuild.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2562 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-25T16:34:35Z,nawrockie
8c9151a9850431db7cc3308db584f8c14095c84a,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed minor bug.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2561 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-25T14:36:51Z,nawrockie
04d3ddef06386de10b1b627ceaa5183e405244ec,Eric Nawrocki,eric.nawrocki@gmail.com,"o Big merge of files from hmmernal2 branch. Merged with command: 
  > svn merge -r 2525:2556
    https://svn.janelia.org/eddylab/eddys/src/infernal/branches/hmmernal2

o IMPORTANT: infernal now requires a subdir 'hmmer', currently this
  revision of the code works *only* with revision 2559 of
  https://svn.janelia.org/eddylab/eddys/src/hmmer/branches/hmmernal2
  which is a special branch of hmmer specifically created for
  experimenting with hmmer as a library for infernal.

  - to update an infernal working dir to include hmmer, currently you'd
    check out the hmmernal2 branch of hmmer into infernal/ with: 
  > svn checkout
    https://svn.janelia.org/eddylab/eddys/src/hmmer/branches/hmmernal2 hmmer



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2560 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-25T14:30:12Z,nawrockie
347fc536058645ce2fb312492e8fe0edae8f2bc4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged all changes from branch meta-cmalign with following
  commands. And then manually resolving conflicts:
  See ~nawrockie/notebook/8_0710_inf_meta_cmalign/00LOG for details.
  As well as 2508 and 2524 svn logs.

svn merge -r 2507:2508
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/meta-cmalign
                                                                                      
svn merge -r 2523:2524
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/meta-cmalign



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2555 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-24T00:33:46Z,nawrockie
17271b2655d5b3af6ad0cb5fe215afb1ae5596cd,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged bug fix in 1.0 branch using following command:
  svn merge -r 2551:2553 
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2554 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-23T20:00:48Z,nawrockie
6506b54e75ebedf7c588ff574876bc35666e4591,Eric Nawrocki,eric.nawrocki@gmail.com,"------------------------------------------------------------


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2551 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-23T19:08:59Z,nawrockie
d3c03cf2e09cb7e33e52f5032826d38377b8706c,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged bug fix from 1.0 branch with command 
  svn merge -r 2547:2548
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/1.0 
  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2549 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-23T18:51:54Z,nawrockie
1eceb74c98e40b281d97515464ff6b738b0d862c,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed rare but crippling bug that was checking if a seq idx was < 1
  instead of i0 in DispatchSearch(). Due to design of code this only
  caused a problem if two hits do not overlap using W calc'ed from QDB
  with beta = 1E-7 (default for QDB filter), but do overlap using W
  calc'ed from QDB with beta = 1E-15 (default for final round
  Inside). And that's very rare. Reported by Thomas Wong, notes in 
  ~nawrockie/notebook/8_0822_inf_bug_results2survfract/00LOG.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2547 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-22T16:24:06Z,nawrockie
f98a35558b0e520abab194f1ad12980c9ee9c2e3,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed explanation of the --ere option. It was stuck in v0.81
  land. James Cole from RDP reported this discrepancy.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2538 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-14T18:20:55Z,nawrockie
63c3c9b7a1c5aef3e0020c7941e0353c6d55d01d,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed bug in cm_from_guide() that checks for 0 MATL, MATR, and BIF
  nodes - in which case building a CM is illegal, b/c it's impossible
  for such a CM to emit just a single residue in local mode. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2537 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-14T18:19:25Z,nawrockie
63dfa40b5fea087be8b269c02fb4fa624b342067,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed bug reported by Steffan Moeller on Aug 12 2008 - a single
  missing semi-colon.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2536 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-08-14T17:35:04Z,nawrockie
bab48c542ba412a7c2f37b2dadb2ca235e2d8eaf,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2527 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-08-05T21:00:54Z,nawrockie
1968a90048409cc5363f5d7746807f64d7dd50b7,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed a bug in reading in BCOM, BDATE, CCOM and CDATE
  lines. This fixes a previous erroneous fix I had made to silence
  compiler warnings (see code, it's clear why the previous fix was
  wrong). The new code matches Easel code, so it should be clean. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2505 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-07-18T15:49:17Z,nawrockie
5bb96cafd1fb959fe4830570061001ed4a57b963,Eric Nawrocki,eric.nawrocki@gmail.com,"o ParsetreeScoreCorrectionNull3() bug fix. It wasn't ever called though.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2504 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-07-17T11:56:30Z,nawrockie
ac0668a52d832584c7cea0466531aa8bcbbfad5f,Sean Eddy,sean@eddylab.org,"Preparing 1.0rc2 release.
Merged bugfixes from trunk: r2496:2498


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2500 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-07-12T13:14:09Z,cryptogenomicon
1c7150d8ccde0e532c5e167caffe6d317834ea9d,Sean Eddy,sean@eddylab.org,"fixed --enable-mpi.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2498 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-07-10T14:03:07Z,cryptogenomicon
2ed83b659c8144a4cd73bc76fa57d66cb28a893a,Eric Nawrocki,eric.nawrocki@gmail.com,"o 3 1.0rc1 bugs fixed, in order of significance:
  1. cm_mx.c: 32-bit gcc's compiled but segfaulted in all
     executables b/c the optimized emission score vectors were
     incorrectly looking up scores for gaps in digitized easel
     alphabet land. This has been fixed.
  2. cmemit.c: the --hmmbuild option had been removed from cmemit, but
     was still checked for in 1 very rare case.
  3. cmbuild.c: help list was incorrectly formatted, listing a header
    for options that had been removed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2497 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-07-09T13:58:36Z,nawrockie
8531d8ada0359693d8434e42df7dfa97b1cb9282,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated 00README-MPI.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2495 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T19:10:12Z,nawrockie
3afd234446ab374394d1cae16c37ec8f7083e9fa,Sean Eddy,sean@eddylab.org,"1.0rc1 release checklist complete, and changes merged back to trunk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2494 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T17:38:37Z,cryptogenomicon
edd9207e389beb399656ac8438b90006445c3097,Sean Eddy,sean@eddylab.org,"Preparing the 1.0 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2483 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T14:55:45Z,cryptogenomicon
47df16a161d698bf99425fdfdce6305ad3227c15,Eric Nawrocki,eric.nawrocki@gmail.com,"Typo fixes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2482 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T14:55:13Z,nawrockie
bd0a0ab91af110a79c8d8ee2478da7955a92710d,Diana Kolbe,diana.kolbe@gmail.com,"ConfigCM() and ParseTreeScore() calls changed
to conform to new API.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2481 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T14:44:40Z,N/A
de86ee67b1365dc2fe886f229e0569d628edf399,Sean Eddy,sean@eddylab.org,"Working on configuration.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2480 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T14:02:14Z,cryptogenomicon
4bd15baefc354f2c95f3480063af3d9f256c8b2a,Eric Nawrocki,eric.nawrocki@gmail.com,"o Bracketed comments starting with '//' with /* and */.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2479 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T13:54:48Z,nawrockie
d17582c3aeddd1b1be3583cb9550cb63d989d2db,Eric Nawrocki,eric.nawrocki@gmail.com,"o Bracketed comments starting with '//' with /* and */.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2478 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T13:46:08Z,nawrockie
575193467ec5288239fa2ce6c21ba805747ab362,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2477 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-20T02:50:11Z,nawrockie
64fe9e25968a8fafef4b5c876f7f97db39e142d4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Minor changes to pacify compiler warnings on compile farm.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2476 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T02:48:10Z,nawrockie
a9904f512ee46717730a78ae1671d656c876ef05,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2475 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-20T01:38:43Z,nawrockie
51c4b4dcc92ba6c6ab80fcf3350a677cb1c8e406,Eric Nawrocki,eric.nawrocki@gmail.com,"o Final fixes to userguide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2474 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-20T01:30:22Z,nawrockie
ba3a10c7407c68e9e801af78bbd27698c520e2ef,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2473 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-20T00:57:53Z,nawrockie
5309fbf1bc526c335fde47a7e14be799c136e084,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2472 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-20T00:51:57Z,nawrockie
acd0589c25171f22588447835d028ee8db72186f,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2471 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-20T00:44:29Z,nawrockie
c4ed1196a2ad4015adac0ff9647f5f830094dd2e,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2470 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-20T00:38:31Z,nawrockie
fe19e60cc4add2d18e59e118977f9a7c605b87ae,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2469 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-20T00:33:54Z,nawrockie
e627c95086af134240896cc6f6f69bc3070ed9d9,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed formatting bugs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2468 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-19T22:37:09Z,nawrockie
a6f7c0eb947462246795848a2fac3dde4a1d1d06,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed minor formatting bugs in man pages. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2467 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-19T21:45:33Z,nawrockie
e926a1d915e7b9db294822fbc7a954e2f930dd5f,Eric Nawrocki,eric.nawrocki@gmail.com,"o Removed rigfilters from configure and make. Userguide now has a
  blurb telling the user to use an old version if he really wants to
  use rig filters, or use Zasha's program. This was approved by Sean.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2466 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-19T19:01:42Z,nawrockie
4a51ee404dfa671c7c0b0cba5fc5beaedc7ac618,Eric Nawrocki,eric.nawrocki@gmail.com,"o cm_multi2indi.pl: new scripts for 1.0
o cmsearch_pp.pl has been modified.
BOTH ARE UNDOCUMENTED.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2465 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-19T19:00:49Z,nawrockie
e2298fe5076967de544f56cdb656cbebb95b502d,Eric Nawrocki,eric.nawrocki@gmail.com,"o added rfam10.c.cm which is used in userguide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2464 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-19T19:00:17Z,nawrockie
55abcfbfe83d43cbd33c833af24e4261e3802b6a,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2463 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-19T18:58:19Z,nawrockie
9a6223a02825ad332813d46e2ca5737f2852a333,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed some minor bugs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2462 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-18T20:24:47Z,nawrockie
35f91da088c46968b773656c283885fddf899995,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2461 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-18T20:24:19Z,nawrockie
f4a4612ad5f97c007eda2cc6c303cf39e2a0144d,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2460 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-17T22:10:05Z,nawrockie
e19a020d53f46fa810fe7f6b894e5adcc56bc41c,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2459 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-17T21:30:16Z,nawrockie
2096bc2c05e2c8bedde74822a46fa9994eb0625d,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2458 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-17T21:20:25Z,nawrockie
be97ced36f6346eadd17d11717bb7e76d9abd94a,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added files necessary to do a 'make devcheck'.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2457 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-17T20:57:35Z,nawrockie
9d05d176c2123a36f421c2dd393a12167b947a01,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2456 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-17T19:32:20Z,nawrockie
e6531cc657b6539952d0eae05256f69784bece8a,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2455 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-17T19:32:13Z,nawrockie
f542be472d28e5f2e9545e64ef462eca832d16a4,Eric Nawrocki,eric.nawrocki@gmail.com,"o in process of 1.0-ification of the testsuite.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2454 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-17T19:28:12Z,nawrockie
521346bd0020fd4844a316b06aac1d30490eb174,Eric Nawrocki,eric.nawrocki@gmail.com,"o added 'make devcheck' to do a longer, more exhaustive set of
  exercises that test all options.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2453 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-17T19:25:32Z,nawrockie
ee20c6a0d99a18324220f0f0801e073be31efce7,Eric Nawrocki,eric.nawrocki@gmail.com,"o updated man pages and userguide to reflect current code.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2452 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-17T19:19:17Z,nawrockie
45f4cb019f6177c60d90f5b49d313fe6aca882d5,Eric Nawrocki,eric.nawrocki@gmail.com,"o minor fixes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2451 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-17T19:18:28Z,nawrockie
e8a5fda4db9e3be124830289bcab114fe704ef4b,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmsearch --addx changed to -x, and prints 'x' above deleted and half
  base pairs as well as non-compensatory ones.
o several other small changes 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2450 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-17T15:49:35Z,nawrockie
a8b53ee6a2764a520a865475d78aa73cea7d0d7b,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2448 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-11T01:05:31Z,nawrockie
4605bbc8c782e6851a13fc19e719ebf9b1f61771,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2447 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-11T01:04:35Z,nawrockie
2bdeaf9fd58def407ebeef48186a737a2277b4b4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated userguide, including code examples.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2446 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-10T23:14:48Z,nawrockie
6c8b80cdf8cc687091d0092255a6316f55090ce3,Diana Kolbe,diana.kolbe@gmail.com,"Previous bugfix was incorrect and introduced a new bug;
new bugfix replaces it (i think correctly this time).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2445 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-10T21:21:11Z,N/A
1d43768a4cb3158751d6f92ce9ed7e22d435e63a,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2444 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-10T18:26:17Z,nawrockie
4907145a9d2aafa7189fe684e97f528910d74b8d,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2443 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-06-10T18:25:24Z,nawrockie
6d61d375cff5c972c3c56f3e0ea7ae2abb879d48,Eric Nawrocki,eric.nawrocki@gmail.com,"o A simple renaming.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2442 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-10T18:11:36Z,nawrockie
94bc32e5ba8e67be516b5fac2a8ce26be182d999,Eric Nawrocki,eric.nawrocki@gmail.com,"o Models are freshly calibrated.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2441 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-10T18:11:13Z,nawrockie
223a4076685a622cc0fe2eaf499190a0b68c5af9,Eric Nawrocki,eric.nawrocki@gmail.com,"o Minor changes: options reordering etc., made during updating man
  pages. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2440 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-10T17:53:49Z,nawrockie
8423e06ee8dadd927c73679280d482fa89a6c25f,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated all man pages in anticipation of 1.0 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2439 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-10T17:35:31Z,nawrockie
86a7447cd1c49df9b729eb60b95af72864f12ae2,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added new .sqc files that were developed in
  ~/notebook/8_0517_inf-1_testing/
o They're not finalized yet, but they're close. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2438 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-10T02:25:25Z,nawrockie
58411f08cbf8677a532080c6c06d617bc33de7bf,Eric Nawrocki,eric.nawrocki@gmail.com,"o All executables that open/read sequence files now use Easel's
  updated functions for setting digital mode, which checks for illegal
  characters. 
o other changes are minor.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2437 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-09T16:56:22Z,nawrockie
6a05accd2c541af719b89cbc61f09272d6a71aac,Eric Nawrocki,eric.nawrocki@gmail.com,"o playing around with default tail fitting settings in cmcalibrate.
o small null3 related bug fixed.
o other changes are mostly cosmetic.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2434 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-04T20:58:34Z,nawrockie
df17f2a5db83913f10e87860d3f86b521d3cd90e,Sean Eddy,sean@eddylab.org,"esl_ssi_FindNumber() prototype has changed; modified call.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2431 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-04T14:18:42Z,cryptogenomicon
4dfbe3a89ca0ade62c712ed63c119727ea9be5f9,Diana Kolbe,diana.kolbe@gmail.com,"Bug fixes for DnC, dealing with marginal cases where
the true alignment boundary exactly matches up with
one of the division points in splitting a bifurcation.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2430 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-02T15:53:21Z,N/A
77a23d66e4942ed4df2e5d245ed0e62c63fb0f85,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor output changes:
o cmbuild and cmstat now report number of basepairs and bifurcations
  per model.
o cmalign no longer prints 'raw' and 'corrected' bit scores (before
  and after NULL3 correction), but only the after NULL3 corrected
  score, which is the same score reported by cmsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2429 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-06-02T14:51:33Z,nawrockie
6ee4982044caa7ce42253070a3d2e54f5e27af49,Eric Nawrocki,eric.nawrocki@gmail.com,"minor updates.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2428 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-30T20:28:37Z,nawrockie
a693e339d1fefc5f44eaba36e1154ba03d6bef68,Eric Nawrocki,eric.nawrocki@gmail.com,"Updating manpages and user guide. Still preparing for 1.0 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2427 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-30T20:27:04Z,nawrockie
20fb5fe416f3dd1fb32e8ec79671b3544c85c403,Sean Eddy,sean@eddylab.org,"Minor changes to upgrade to new Easel sqio.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2425 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-30T17:55:39Z,cryptogenomicon
e2f10c650d83ef43c4f72e4f2c5085531f627cc1,Eric Nawrocki,eric.nawrocki@gmail.com,"o made non-banded D&C default alignment strategy for post-scan
  alignment of hits in cmsearch. I thought I had done this before, but
  I hadn't.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2424 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-27T13:32:25Z,nawrockie
d101061c9ac3b99abaff3f40d98e6c62fcd8a8a0,Eric Nawrocki,eric.nawrocki@gmail.com,"o I had removed cmcalibrate from Makefile.in during debugging to avoid
  messing up currently running cmcalibrate jobs on the cluster. It's
  now added back in.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2423 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-27T11:26:23Z,nawrockie
498b2db446376ca0d65c3b9cd944c361673b7487,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate now fits 500 hits in it's histograms by default instead
  of the 1% tail. Still testing this...
o cmsearch now does NON-BANDED CYK alignment of it's hits by default
  so it doesn't screw up alignment of truncated sequences. A
  misbehavior that was pointed out by Diana on 05.26.08. (See janelia
  email on that date).
o minor cosmetic changes


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2422 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-27T11:16:51Z,nawrockie
e33a4956376f46d1e5a2fe0947e56d89d160258a,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmbuild and cmstat now determine max name length of all CMs it will
  generate/print stats for and formats the 'name' column of it's
  output to be exactly that width.  
o cmstat --lfi, --lfc, --gfi, --gfc now default to print full range of
  CM final/HMM filter E-value cutoffs, instead of a single one for
  default E-value of 0.1 for 1Mb db.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2421 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-23T13:27:59Z,nawrockie
06c29620a11183d6a1e766b23980fe512be92f47,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmalign and cmsearch --tabfile now dynamically change width of
  target sequence name column to be max of those in target sequence
  file. 
o cmalign now prints the 'raw' non-NULL3 correction inside bit score
  and the 'correctd' NULL3 bit score. Not sure if this is going to
  stay. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2420 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-22T21:29:57Z,nawrockie
b1ad8c801ffc9cfa6106f4ceca6c82f45fbd931b,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed serious bug with NULL3 corrected greedy hit reporting 
  which affected cmcalibrate, but not cmsearch so much.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2419 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-21T20:51:06Z,nawrockie
9852ca2225c4d378c4c1a2e50b3f3a5f5e85e6fc,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate now has a 5-state fully connected HMM hard-coded into
  it that can generate 'genome like' sequence. By default, cmcalibrate
  searches sequences generated by this HMM to get score histograms
  that it fits exponential tails to for E-values. I'll be testing this
  now. To generate sequences with the CM null model use
  --exp-random. To get more info on the 5 state HMM see
  ~nawrockie/notebook/8_0326_inf_default_gc/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2418 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-21T01:11:13Z,nawrockie
c69475890622d13bbb4f16d9abc8ac17713b4fd5,Eric Nawrocki,eric.nawrocki@gmail.com,"o Mostly small changes made to fix bugs encountered during sqc testing
  for cmalign, cmbuild, cmemit and cmscore. 
o One big fix in stats.c with calculating GC composition of a chunk of
  genome. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2417 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-20T21:39:40Z,nawrockie
5243b84541da6fcf0ee3ff1fb221535f84839923,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed simple but fatal bug in cmalign involving getopts.
o cmstat now includes -Z option


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2416 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-20T13:35:21Z,nawrockie
f04895cfdb11dec1860321dc3e02a42111436e1a,Eric Nawrocki,eric.nawrocki@gmail.com,"o reorganized options for all executables except cmstat: 
  - added --devopts option, when invoked undocumented options that are
    not documented in UserGuide or manual pages are listed to the
    screen. These options are invisible when -h is invoked.
  - motivation for --devhelp was the sheer number of options to each
    program. --devhelp helps a little, hiding those options that any
    non-superuser or developer would ever want to use.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2415 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-16T21:59:24Z,nawrockie
3bdf4c66edf3cb4b1b4136d504a74f2fde198617,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a few bugs with --null3 and cmsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2414 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-14T22:13:20Z,nawrockie
e23bafd9046160eb4244b2f2956bf63dfaab4019,Eric Nawrocki,eric.nawrocki@gmail.com,"o Null3 fully implemented, but not tested. The implementation likely
  still contains bugs. 
o cmcalibrate takes --null3, which causes the NULL3 correction to be
  applied to all searches, including filter threshold calculation.
o cmsearch takes --null3, which causes the NULL3 correction to take
  place at every search round.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2413 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-12T21:09:24Z,nawrockie
a7c0f6ce9bdb6eed5a43fd1504badf3eb42a5423,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign output now includes an approximation of the contribution of
structure to an Inside score. The score printed is the summed bit
score of all MATP_MP emissions minus the score of those emissions if
the MATP_MP's were marginalized, i.e. single stranded. This score is
therefore an approximation of the structural component of the
score. It's inclusion was suggested by Paul Gardner to be used to
flag pseudogenes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2412 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-10T21:46:12Z,nawrockie
20790814c3c5bf1b43f3552509037225f703d760,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch:
o added --lambda <x> option to set lambda for E-values to <x>,
  overriding lambda in a calibrated CM file.
o added -Z <x> option to set database size for E-value calculation,
  where <x> is in units of Mb.

o still working on null3 score correction in cmsearch and cmcalibrate,
  not yet finished
o other changes are cosmetic


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2411 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-09T16:58:35Z,nawrockie
d4164fcfd35af218e15ebaddc6cc58e12d1196bd,Eric Nawrocki,eric.nawrocki@gmail.com,"o Still working on --null3 incorporation. It seems to be working for
  CYK or Inside. Not yet implemented for HMM algorithms.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2410 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-08T17:54:49Z,nawrockie
fce285094aeb694a641f0c437776ce9660a6dc8e,Eric Nawrocki,eric.nawrocki@gmail.com,"1. Fixed bug in cmalign --mpi --withali in printing posterior probs
   and inside scores. 
2. Working on cmsearch --null3, not yet completed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2409 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-06T22:47:05Z,nawrockie
de50d341e3d4e2db2f4b290a1c20ecebbf26df7e,Eric Nawrocki,eric.nawrocki@gmail.com,"Experimenting with --null3 option in cmcalibrate;
not fully implemented, but default (without --null3)
runs fine.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2407 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-05T16:54:29Z,nawrockie
935500648ad6f67b4b5f65aa057358c3766a13c7,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed serious but easily fixed bug in stats.c::E2MinScore().


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2406 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-05T12:40:32Z,nawrockie
96ba606bd590f3f6a54c495fc080da5c4c586050,Eric Nawrocki,eric.nawrocki@gmail.com,"o for cmalign optimal accuracy alignments (which is default) inside
  scores are now printed for each sequence in addition to average
  posterior probablities.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2404 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-01T12:18:44Z,nawrockie
32149b62a4c0ac1d2e75a40e37e0766385d932da,Eric Nawrocki,eric.nawrocki@gmail.com,"o minor cosmetic changes


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2403 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-05-01T10:57:10Z,nawrockie
c04a1cf9f030ceb376014ab049de821164b50b23,Eric Nawrocki,eric.nawrocki@gmail.com,"In process of updating man pages.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2402 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-29T11:39:45Z,nawrockie
c553f21bbc96ea65ce5bc0c23d7daf88c9376bc6,Sean Eddy,sean@eddylab.org,"esl_random fissions into esl_randomseq; sequence sampling function
name changes. [SRE; J3/20]



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2401 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-24T20:07:30Z,cryptogenomicon
ecb70ae2c9af263c94fbee2efb7540fdfca060e6,Sean Eddy,sean@eddylab.org,"Minor edits in the user guide and man pages.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2398 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-18T18:24:27Z,cryptogenomicon
50f34043ea7324f6d8fdee457846305b05ab82ba,Eric Nawrocki,eric.nawrocki@gmail.com,"o Bug fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2394 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-04T23:08:53Z,nawrockie
0a256809391c1e060b9f2a3958fcf83b9475906f,Eric Nawrocki,eric.nawrocki@gmail.com,"o optimal accuracy alignment now default in cmalign.
o Updated userguide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2393 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-04T21:17:14Z,nawrockie
707da136eacf2aa65f5dbefe8aa47aa82576a80b,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added --tabfile to cmsearch to output hits in a simple tabular
  format, as requested by Paul Gardner.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2392 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-04T17:33:24Z,nawrockie
cf26477e428d3096c445533ca4ab9a7b2a552cda,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed a bug with how cmsearch predicted run times of CYK and Inside
  search stages.
o cmcalibrate now dumps raw filter threshold data with --fil-dfile


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2391 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-03T21:28:35Z,nawrockie
110ae4f8b1ac8fc6346e90c7690e191c7b0cfa37,Eric Nawrocki,eric.nawrocki@gmail.com,"o minor changes


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2390 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-02T20:14:14Z,nawrockie
45e0c4a5e3feb9c9ed89b0971048ab70bfbef5c6,Diana Kolbe,diana.kolbe@gmail.com,"Initialize lmesc/rmesc pointers to NULL.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2389 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-02T19:05:09Z,N/A
0632399aa35dd2fb126fac3e3b47a166cd79b9de,Diana Kolbe,diana.kolbe@gmail.com,"Reverting e-weighting change pended further
discussion/investigation.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2388 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-01T22:04:04Z,N/A
64c170a734e1b45c8bebf36f912c87ca1ebdca1e,Diana Kolbe,diana.kolbe@gmail.com,"Clean-up memory for new marginal emissions scores
when freeing CM.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2387 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-01T20:01:35Z,N/A
3b0a48c324bab5c70d50475a2dc5365fe7bbb930,Diana Kolbe,diana.kolbe@gmail.com,"Switching from calculating marginal emission scores
on the fly (inside the inner DP loop!) to pre-calculating
once.  Adds storage in CM structure, and provides
one external API function.  



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2386 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-01T19:55:58Z,N/A
d5c348baaa98dac2759a9b15d9d97deb8221d999,Diana Kolbe,diana.kolbe@gmail.com,"Added divide by 2's to entropy calculation for
MATP_MP states, since what we want is entropy
per position, rather than entropy per state.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2385 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-01T19:52:55Z,N/A
229fb8d827e298193cf7ba08c477e8b06e83619b,Eric Nawrocki,eric.nawrocki@gmail.com,"o Replaced checks for eslSQ_DIGITAL flag (which no longer exists in
  ESL_SQ) with esl->dsq == NULL checks.
o other changes are minor


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2384 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-01T19:41:37Z,nawrockie
d0c59925c9c5ccfbc9a781197475725f9bf3e520,Sean Eddy,sean@eddylab.org,"include the new esl_sq.h, where necessary.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2382 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-01T19:06:54Z,cryptogenomicon
cf33616e6e2a2e34508fe5a13d88b9fb5712815e,Sean Eddy,sean@eddylab.org,"in cmalign.c: esl_sq_Dealign() is no more; now esl_strdealign().


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2381 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-04-01T11:30:40Z,cryptogenomicon
4938a0f9ed61d199c73a99a73012dc4552647cd1,Eric Nawrocki,eric.nawrocki@gmail.com,"These are important.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2380 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-31T23:19:45Z,nawrockie
bea4dd3d8604dd3b22f1444a041c42a5b3f42785,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding Purine figs for userguide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2379 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-31T23:18:30Z,nawrockie
3bf8eca995b3283ae6436c642e21d6f8ae796f28,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added aclocal.m4 symlink a la HMMER.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2378 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-31T23:14:20Z,nawrockie
460be7dbe49b43de67b21981a30ab2e860f23cde,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated some userguide files. Removed aclocal.m4. About to create a
symlink, and then update again, not sure if that'll work.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2377 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-31T23:13:38Z,nawrockie
0d8ffe176376fc7e28720e57274e00409be8a6b0,Eric Nawrocki,eric.nawrocki@gmail.com,"Deleted files that were accidentally added in last commit.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2376 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-31T22:30:20Z,nawrockie
9e7804bdd28937244dd76b79830ca3aec6ccba49,Eric Nawrocki,eric.nawrocki@gmail.com,"src/ dir changes: minor bug fixes encountered when making the
                  tutorial.
tutorial/ directory added with files for the tutorial, should replace
                  intro/ dir
documentation/    updated some man pages and *major* changes to
                  tutorial.tex. Also added scores.tex and filter.tex,
                  which are new sections of the user guide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2375 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-31T22:24:06Z,nawrockie
1a92dd584f56424822ebff9e439984080f455595,Eric Nawrocki,eric.nawrocki@gmail.com,"o Small bug fix with cmsearch's HMM filter bit score cutoff selection 
o Cosmetic fixes 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2365 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-23T10:44:04Z,nawrockie
869a4ff1735bdffb6c0bc98dc40484341bb59d3e,Eric Nawrocki,eric.nawrocki@gmail.com,"o small bug fix with HMM banding and --sub for cmalign.
o other changes are minor/cosmetic.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2362 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-10T13:42:27Z,nawrockie
068598ef746f5295fd78b9aebe4babc2488ca71b,Eric Nawrocki,eric.nawrocki@gmail.com,"o reworked cmcalibrate output.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2361 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-06T20:53:28Z,nawrockie
fcb2e4a8df81ee9195f26a98ba85be6190550af5,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmsearch and cmcalibrate now predict timings by performing actual
  searches of short generated sequences. 
o --forecast <n> option added to cmsearch and cmcalibrate that causes
  the program to ONLY print timings, not do the actual search or
  calibration. Timings are reported as if the search/calibration were
  to be done with <n> processors.
o other changes are minor and/or cosmetic.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2360 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-06T10:01:56Z,nawrockie
499d1777062a6c5d558faa685ae867c1dd5259e7,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmsearch now requires -F to search with a model that has not been
  calibrated. Otherwise, the program dies with an error message
  politely suggesting calibration.
o cmsearch now prints determines and prints the actual filter fraction
  for each stage in a 'summary' section at the end of the function.
o cmalign and cmsearch are the only two executables with -o options,
  all others write all non-out file output to stdout


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2359 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-04T00:44:22Z,nawrockie
c809061ecdf2977d1ed85869c90c809af304430b,Eric Nawrocki,eric.nawrocki@gmail.com,"o in process of ensuring consistency of output of all seven
  executables.
o other changes are minor bug fixes or cosmetic.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2358 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-03-03T17:18:49Z,nawrockie
5b21164580390fcf2ce1748aa0885085c2d65c5d,Eric Nawrocki,eric.nawrocki@gmail.com,"o updated cmbuild default output to match cmalign, cmscore tabular
  output style.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2356 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-29T21:40:52Z,nawrockie
e1e5eb7954bd7ed632c63dc950688050c7d69346,Eric Nawrocki,eric.nawrocki@gmail.com,"o Changed default cmalign output, date and command are now printed to
  stdout as well as scores of all seqs in tabular format.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2355 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-28T21:40:45Z,nawrockie
b02c26df76715981dc717e28fea5a27750cac2c9,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed a bug with greedily reporting hits using QDBs in cm_mx.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2351 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-19T11:08:17Z,nawrockie
40ef1b5e651836df59180639fb35c76c8531b3c5,Eric Nawrocki,eric.nawrocki@gmail.com,"o Last commit (r 2348) should have had a log message, but I screwed it
  up. *That* commit (r 2348) introduced the --ehmmre <x> option to
  cmbuild which modifies entropy weighting by added a second entropy
  weighting step if the HMM entropy of the CM (that is, the average
  match emission relative entropy for the model while treating MP
  states as two single emitters, and marginalizing the pair emission
  distro to get the two singlet emission distros) is less than the
  minimum target entropy of <x>. 
o This is an experimental option motivated by the fact that many CMs
  with default entropy weighting are impossible to filter for with an
  HMM b/c the HMM has such low entropy (I've seen as low as 0.20 bits
  per match state). This just means a lot of the info content of the
  CM is coming from the pair emissions, which means a CM is really
  going to be more sensitive than an HMM (which is good), but if one
  might be more concerned with speed than sensitivity in which case
  the ability to filter with an HMM at a cost to sensivity may be
  justified. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2349 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-18T16:57:26Z,nawrockie
b44b210a7025127cd04d853dba8513c339864c4a,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2348 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-02-18T16:51:41Z,nawrockie
effdc0651aaaf95397ce070b6810d5044de7dce9,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed --mxsize option to cmcalibrate.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2343 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-17T12:57:48Z,nawrockie
adc1f1b654c1d13af5422d6703716cff7e39d09d,Eric Nawrocki,eric.nawrocki@gmail.com,"o All trace of gumbel fitting now erased and replaced with exponential
  tail fitting. 
o Preliminary results suggest method for calculating E values given
  the exponential tail parameters from cmcalibrate may be
  working. Need to do more extensive testing though.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2338 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-15T21:34:16Z,nawrockie
ef9418196b6aa91b3a9aaa9949606be93f666e71,Eric Nawrocki,eric.nawrocki@gmail.com,"o Working on correctly calculating E-values with the exponential
  distribution stats that have replaced the Gumbel stats. 
o About to replace the GumbelInfo_t data structure with an
  ExpInfo_t data structure, that will have a few different
  parameters.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2333 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-15T15:32:24Z,nawrockie
9bdecf2e214e471d2aca8c8028fee7775b7e6cd3,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed small bug with HMM->CM band implementation. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2332 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-14T19:58:07Z,nawrockie
db169f4c0898691f3184d42729a78d92087d443d,Eric Nawrocki,eric.nawrocki@gmail.com,"o CM now has 2 separate beta values, beta_W and beta_qdb. cm->beta_W
  is the beta used to calculate W (max hit size). cm->beta_qdb is the
  beta used to calculate QDBs within cmsearch, cmcalibrate, cmscore,
  cmalign, or cmstat. 
  - cm->beta_W is stored in the cmfile and can be changed with
    cmbuild with --wbeta. Default value is 1E-7 (which hasn't
    changed). 
  - the cm->beta_W used in executables (cmsearch etc.) can be modified
    from what is set in the cmfile, but can only increase (making W
    smaller). 
  - cm->beta_W is always >= cm->beta_qdb. This means that if cmsearch
    sets cm->beta_qdb as 1E-4 and cm->beta_W from the cmfile is 1E-7,
    cm->beta_W will be redefined as 1E-4, and W will be set as dmax[0]
    from the QDB calculation with beta=1E-4. This makes sense, a QDB
    banded search can't return hits > dmax[0], so W should equal
    dmax[0].
  - cm->beta_qdb may be smaller than cm->beta_W though. For example,
    if we run search with cm->beta_qdb = 1E-10 and cm->beta_W from the
    cmfile is 1E-7, we calculate cm->W as dmax[0] for QDB calc with   
    beta = cm->beta_W = 1E-7. Then we calculate QDBs with 
    beta = cm->beta_qdb = 1E-10. Any states v with dmax[v] > cm->W
    are truncated so that dmax[v] = cm->W. This means we still 
    can't get hits > cm->W, but we do allow looser bands than 
    we would with beta = beta_W = 1E-7 for many states in the model. 
  - motivation for this was I wanted the final round of cmsearch, the
    inside round to use very loose bands of beta = 1E-13 or
    such. These loose bands will sacrifice basically zero sensitivity, 
    and offer only a small speedup, *except* for big models, where
    the speedup will be significant. Also, we still want the max
    hit size cm->W to be dmax[0] calc'ed with beta=1E-7, and that's
    the max hit size when models are calibrated, so it should remain
    the max hit size in the final round of inside search with beta =
    1E-13.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2330 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-14T17:09:34Z,nawrockie
c5b4b73a9ab5023dbb13e0bfbacd70f94bd849f4,Eric Nawrocki,eric.nawrocki@gmail.com,"o Merged branch:
  https://svn.janelia.org/eddylab/eddys/src/infernal/branches/cmcalibrate-island
  back into trunk. 
  - this merge brings in exponential tail fitting to replace the
    gumbel fitting for E-values. 
  - details on the development in the cmcalibrate-island branch are in 
    ~nawrockie/notebook/7_0123_inf_cmcalibrate_island/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2329 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-13T22:40:42Z,nawrockie
041917b45410a973a695b606a1f79c4071ea2715,Eric Nawrocki,eric.nawrocki@gmail.com,"o Still tidying up the new HMM->CM band implementation, not it seems
  to work robustly for local and glocal alignment and search.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2327 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-13T22:09:06Z,nawrockie
0a572306c9cdf0109d20b8bfe10f0f1deaea943f,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2326 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-02-12T21:36:49Z,nawrockie
978041edb1853b68cec912c1239a6393dda2f48d,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2322 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2008-02-11T23:50:12Z,nawrockie
ea0b56cc7ba56eb62c2e650186622c28d25dab75,Eric Nawrocki,eric.nawrocki@gmail.com,"o About to test HMM banding with cmscore.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2321 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-11T23:43:47Z,nawrockie
87afa5b83d2ee334f7438645865c70b94707f751,Eric Nawrocki,eric.nawrocki@gmail.com,"o Revisited HMM banding for scanning CYK. 
  - old --scan2bands option is now default, meaning that a scanning
    Forward/Backward algorithm is used by default. If desired, when
    searching, non-scanning Forward/Backward (alignment version that
    necessarily emits full target sequence begin 'scanned') using the
    --aln2bands option to cmsearch or cmscore.
      


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2320 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-11T21:40:31Z,nawrockie
f2777ccc5827c69a785451ee0293cbc0a1be549a,Eric Nawrocki,eric.nawrocki@gmail.com,"o HMM banded local alignment has been overhauled, and is now more
  robust. 
o cmscore --Lmin <n> and --Lmax <x> options added to specify a range
  of sequence lengths to use with --random. Sequence lengths are drawn
  from a uniform distribution within <n>..<x> inclusive.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2319 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-11T15:43:09Z,nawrockie
c154b6a3c9ce5c53d9ba0c9f7c016a2da7757327,Eric Nawrocki,eric.nawrocki@gmail.com,"o Main chunk of HMM banding completely reworked. Specifically, the
  function that takes HMM bands and infers the CM bands. Previously,
  it was possible to get an 'impossible' CM parse. Now a valid HMM
  parse within the HMM bands is enforced, which implies a valid CM
  parse exists. I've tested global alignment on 100 different CMs with
  random sequences with very high tau tail loss probability of 0.49 to
  make sure the code is robust. 
o Not yet tested for local alignment, nor search. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2318 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-02-07T20:22:38Z,nawrockie
4d8b3b4fd27787b1477e794d51c1719f3ce97153,Eric Nawrocki,eric.nawrocki@gmail.com,"o implemented simpler way of deriving bands on i and j (imin/imax and
  jmin/jmax) from HMM bands (pn_min_m/pn_max_m, pn_min_i/pn_max_i and
  pn_min_d/pn_max_d) in hmmband.c:hmm2ij_new() (temporary name).
o currently, new method is only used if cmscore --simple is enabled. 
o about to test rigor of implementation.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2312 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-28T13:39:56Z,nawrockie
0bff6a5de0dc8d6e57e0f8dd10fb743d500e9bab,Eric Nawrocki,eric.nawrocki@gmail.com,"o added --search option to cmscore that changes algorithms being
  tested from alignment (full target to full model) to search (subseq
  of target to full model). 
o changed default output of cmscore so that it's tabular, easier to
  read and parse.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2311 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-26T14:06:44Z,nawrockie
866fd3187feafad21696bf7c649c94fa5dabf67b,Eric Nawrocki,eric.nawrocki@gmail.com,"o added cm->minbeta, which is written to the cmfile. This is the
  minimum allowed beta in post-cmbuild usage (i.e. cmcalibrate and
  cmsearch).
o reworked cmsearch options.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2306 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-23T22:08:43Z,nawrockie
1aabcda3e0a503e06ef673ef392cb9256699b2a7,Eric Nawrocki,eric.nawrocki@gmail.com,"o small adjustment: E-values are now printed in cmsearch output if
  Gumbel stats exist in the CM file, even if -T was used to specify a
  bit score reporting threshold.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2305 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-20T15:51:47Z,nawrockie
057dc066de6a4441031e80b68c32e6b104c9a157,Eric Nawrocki,eric.nawrocki@gmail.com,"o final touches to cmstat. I think it's very nearly in it's 1.0 form.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2304 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-18T22:18:03Z,nawrockie
61fe787a6486e83999c73d47289526543ea71813,Eric Nawrocki,eric.nawrocki@gmail.com,"o added cmstat options --efile, --bfile, --sfile, --xfile, --afile 
  for printing out xmgrace plots of filter threshold CM/HMM E cutoff
  points.
o added cmstat options -E, -T, --ga, --nc, --tc for specifying a CM E
  value cutoff to print HMM filter stats for.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2303 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-18T19:56:03Z,nawrockie
5c071ccdeaff23075460ff9b86b40323100c1f50,Eric Nawrocki,eric.nawrocki@gmail.com,"o Found and fixed some bugs in cmcalibrate filter threshold
  calculation. 
o cmstat {--lfc,--lfi,--gfc,--gfi} <cmfile> now print HMM filter
  threshold stats for all existing CM E/HMM fwd E cut points for all
  CMs in <cmfile> for {local cyk, local inside, glocal cyk, glocal
  inside} in tabular format, including expected speedup and <xhmm>,
  the predicted scalar factor of time required for filter + survivor
  scan relative to the filter only scan.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2302 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-18T11:56:28Z,nawrockie
df97eca0ce1d92705b2862976605bf3c9cdd2411,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate now works anecdotally in MPI mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2301 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-16T22:34:41Z,nawrockie
3545d4cff472cd6cd57d242909ea78a739804ed8,Eric Nawrocki,eric.nawrocki@gmail.com,"o CM E-value cutoff and Forward Filter E-value cutoff pairs are now
  printed to and read from CM files.
o cmsearch: with --fgiven, the appropriate Forward E-value cutoff is
  selected for the current E-value being used.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2300 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-16T21:05:20Z,nawrockie
36d5fe136055037dfe920599ce8c3a4762c5aa74,Eric Nawrocki,eric.nawrocki@gmail.com,"o Previous commit (r2298) completely overhauled how cmcalibrate does
  determines HMM filter thresholds. This commit cleans up all that
  code, including removing all the old options that are now obsolete
  with the newly organized code.  
o Still not fully functional: filter thresholds are NOT yet printed to
  the CM file.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2299 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-15T22:34:14Z,nawrockie
b46d6878dec123eec13fc4e4e7ac9c7530ad8c13,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate.c: new strategy for filter threshold calculation,
  instead of calculating a HMM filter threshold for a single cmsearch
  CM E-value cutoff, an HMM filter threshold is calculated for the
  entire relevant range of cmsearch CM E-value cutoffs.
  This feature is not fully implemented yet.
  Reference: ~/notebook/8_0111_inf_fthr_once/00LOG.

o structs.h: new HMMFilterInfo_t object created which will accomodate
  the new filter threshold strategy mentioned above.

o cmcalibrate-hybrid.c: a copy of the previous revision (2297) of
  cmcalibrate.c. In this copy, the --hybrid option still exists. This
  option will not go into version 1.0. So cmcalibrate-hybrid.c is just
  a copy of old code that may one day be helpful to reincorporate the
  --hybrid option to cmcalibrate.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2298 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-15T13:35:09Z,nawrockie
9d36056f3870d7e4e7a36f0e5c1ab0825059f23d,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed minor, exceedingly rare bug in cm_dpsearch.c, hmmband.c. 
  that only occurs if target sequence length is 1.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2296 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-11T16:04:54Z,nawrockie
d843a03a36ad5b0656c0a9d06b3eb8281def753e,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate: 
  - added --gumsfile <f> option which saves a survival plot to <f>,
    much like hmmsim does with --pfile.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2295 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-08T23:06:35Z,nawrockie
e86ce9cc8974645ca7af2e1a60f5f3c5cc4b30b9,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate: 
  - added --id option which reseeds RNG to original seed for each
    Gumbel mode. This makes the random sequences used for fitting
    local CYK identical to those used for fitting local Inside. The
    same is true between glocal CYK/glocal Inside, and local
    Viterbi/local Forward and glocal Viterbi/glocal Forward.

  - if --id is not used, the random sequences searched in each mode
    are different.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2294 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-08T21:39:05Z,nawrockie
246e2e2cef9eb5cdb1d4b390029e8a17f1a28a1c,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate:
  - changed default output format.
  - unless --hybrid is enabled, the filter threshold workunit
    searches with CP9 Viterbi and Forward.
  - if --hybrid is enabled, filter threshold workunit searches with CYK
    and HMM Viterbi and Forward, b/c it needs CYK scores to fit
    gumbels for candidate sub CM roots.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2293 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-08T21:15:11Z,nawrockie
e4ec8ed50cf2afdde536fbb32bb10ae4027996f4,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmemit:
  - changed --hmmbuild option to --shmm <f>, HMM parameters for
    sampled HMM are now printed to <f> in slightly revised format.
  - added --ahmm <f> option that prints out the parameters of the
    analytically (non-sampled) CP9 HMM to file <f>. This option was
    requested by Rfam czar Paul Gardner.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2292 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-07T22:31:10Z,nawrockie
10fe000d7986f19f085b2f4ed25d7efa524e6cac,Eric Nawrocki,eric.nawrocki@gmail.com,"o eweight.c: replaced entropy weighting functions with new ones based
  on HMMER3's entropy weighting functions. 

  - main motivation was to make sure entropy weighting worked, that
  the old functions agreed with spiffy new HMMER3 funcs, and they
  didn't. Actually they did, but HMMER3 specifies precision within
  0.001 bits of the etarget, whereas my Infernal funcs only wanted
  0.01 precision. Nevertheless, the new HMMER3-esque functions are
  cleaner, and use Easel's rootfinder, so I'm keeping them. 

  - the old functions were relocated to old_miscfuncs.c 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2291 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-07T19:21:54Z,nawrockie
26918a4d882bd73d87f6839471aac76637a6054e,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmstat sqc exercises all pass. Logged in
  ~/notebook/7_1227_inf-1_testing_and_uguide/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2290 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-07T12:14:08Z,nawrockie
249d88399e6166979d9317363fc235499fd8070d,Eric Nawrocki,eric.nawrocki@gmail.com,"- cmstat changes:
  o -a option for alignment stats was dropped b/c cmscore pretty
    much does the same thing (albeit in different way). 
  o new options for printing out gumbel stats and filter threshold
    stats.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2289 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-06T19:33:39Z,nawrockie
31a76b9b8083bf541960d89db67e7e59ce7cf2f6,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate: added --gumL <n> option, which specifies the length <L>
  of the random sequences to be searched for gumbel fitting to <n>. By
  default <L> is set as (cm->W * 2), (and cm->W can change between
  local/glocal modes). With --gumL <n> enabled, <L> is set as
  MAX(cm->W*2, <n>). That is, if <n> < cm->W*2, <L> is set as
  cm->W*2; this is done silently.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2287 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-05T12:45:57Z,nawrockie
cbcb80539602b97a73f184423b7aef396b9842f5,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed a bug in cp9_trace.c:CP9ViterbiTrace() involving D->I
  transitions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2286 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-05T12:12:24Z,nawrockie
e692ee3f7db8d627522c08bbe32d2f980e312a29,Eric Nawrocki,eric.nawrocki@gmail.com,"o Changed behavior involving the --iins option as follows:

  - Prior to this commit, the default behavior was to parameterize
  insert emissions just like singlet MATL_ML and MATR_MR emissions
  inside cmbuild and write the resulting scores to the
  cmfile. Subsequently, these scores for IL and IR emissions would be
  zeroed inside cmsearch, cmscore, cmcalibrate, cmalign and cmemit
  unless the --iins option was used in ANY of those executables.

  - the motivation for zeroed inserts is that biased composition
  sequences, say polyA tail may get a high score to a CM just b/c it
  has an insert state that has a positive score for A and a relatively
  high self transit prob. So cmsearch has historically zeroed its
  insert emissions prior to searching. cmalign, cmscore and
  cmcalibrate were changed to mirror cmsearch in this respect simply
  for consistency.

  - Realized that above behavior is problematic in conjunction with
  E-values because if a Gumbel is fitted for a CM with or without
  zeroed inserts, that Gumbel is really only 'valid' for scores from
  the CM with or without zeroed inserts (whichever way it was when the
  Gumbel was fit). Therefore, the --iins option is problematic b/c the
  user shouldn't be able to change the parameters of the CM after it
  is calibrated. 

  - With this commit, the solution is to have the --iins option
  available only within cmbuild. It is off by default, so if it is not
  enabled the resulting cmfile will always have zeroed insert bit
  scores. All other executables, cmalign, cmemit, cmcalibrate,
  cmscore, cmsearch, DO NOT have a --iins option so the insert scores
  cannot be changed. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2285 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-04T20:03:48Z,nawrockie
e39121620ab9af310a457f1436ea9ce6daa196b2,Eric Nawrocki,eric.nawrocki@gmail.com,"o Changes mainly cosmetic and due to renaming some options during
  preparation of the man pages for 1.0 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2284 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-04T19:20:48Z,nawrockie
a49a8a2e224550adef633e04e8c57444e98e5ccb,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmsearch: Added --addx option which modifies the printing of
  alignments for search hits. With --addx, an extra line appears at
  the top of the hit alignments, this top line has one character for
  each position of the alignment, the top line character is 'x' if and
  only if the aligned residue is to a MP state and is annotated with a
  ' ' in the middle line (this means it is a non-compensatory base
  pair). Otherwise the top line character is a ' '. This means high
  scoring alignments may have all ' ' in this line.  The motivation
  and idea for this top line came from Tom Jones who wanted an easier
  way to scan cmsearch results for non-canonical basepairs.

  Here's an example:

 Query = 1 - 24, Target = 7024 - 7049
 Score = 9.98, GC =  46

              x       x   x        x 
           ::<<<____>->>-<<-<.___.>>>
         1 AAgaCUUCGGAucgggCg.AcA.ccc 24      
           +A: CUUC GA : : C:  +A : :
      7024 UACUCUUCAGAGGACUCAuCAAgUGG 7049    



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2283 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-04T13:36:29Z,nawrockie
afd9063233d151b7ff27a52bfd1dc74a8006fb86,Eric Nawrocki,eric.nawrocki@gmail.com,"o for cmscore's --random option, previous behavior of generating
  sequences of a fixed length cm->clen has been changed. A length is
  chosen from the distribution of expected lengths of full sequences
  generated from the CM (the gamma[0] length distribution from the QDB
  calculation in cm_qdband.c:BandCalculationEngine().)  
o other changes are mostly cosmetic, or related to option name changes
  which seemed appropriate as the man pages are prepared for the 1.0
  release.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2282 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-04T12:12:27Z,nawrockie
b1f9c8cc9a5efe71eb74b2aafe49db3873b932fe,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed bug with cmalign --hmmviterbi -l for models whose CP9 HMMs
  have EL states that can transit directly to E. A 1-line 2 character
  fix, changed ""i"" to ""i--"".


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2281 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-02T23:05:31Z,nawrockie
df04fcc047af00062e8264303928c1ed83267b37,Eric Nawrocki,eric.nawrocki@gmail.com,"o configure.ac: added a --enable-devopts option to configure which
  allows special 'development options' to be compiled into the code.
  These are options I don't want the normal user's using for various
  reasons. Some are strictly for developer debugging, some are
  fragile, some are deprecated. But for various reasons I'm not ready
  to completely remove them from the codebase.
o most src/ files include minor cosmetic changes made while updating 
  the cmbuild and cmemit man pages.
o cmalign.c now has some options inside #IFDEF HAVE_DEVOPTS blocks
  that straddle 'development options' code as discussed above.
o testsuite/ files have been easelfied and bug checked.
o benchmark/cmsearch-rmark files have been updated to work with new
  1.0 code. Most changes were required to work with new --mpi
  behavior. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2280 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-02T22:35:00Z,nawrockie
81c69c991361af7f1191d4f4863153d29a8e6134,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmbuild sqc tests all pass as logged in
  ~/notebook/7_1227_inf-1_testing_and_uguide/00LOG.
o valgrind shows 0 memory leaks for all cmbuild tests.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2279 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2008-01-01T13:57:55Z,nawrockie
6289952d385a61a88176eacbb87f2ec5f2a5c705,Eric Nawrocki,eric.nawrocki@gmail.com,"o New ComLog_t data structure created and added as part of the CM_t data
  structure. 
o the command-line used for cmbuild and cmcalibrate calls as well as
  the dates of those calls are now included in the CM output file. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2278 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-31T20:58:10Z,nawrockie
6e1e0df025e7037ac2df90ad986333c0a57a7359,Eric Nawrocki,eric.nawrocki@gmail.com,"o working on cleaning up cmemit, cmbuild for 1.0 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2277 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-31T14:51:48Z,nawrockie
ca4f200deffe073a631210347de939ed91c74e9d,Eric Nawrocki,eric.nawrocki@gmail.com,"o all Easel function calls now respect non-eslOK status codes.
  This is the only change from the previous revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2276 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-28T16:12:19Z,nawrockie
63d97c49049c75c1cd4e6de7ca63dcac15435dd8,Eric Nawrocki,eric.nawrocki@gmail.com,"o All esl_fatal() calls replaced with cm_Fail() calls.
o other modifications are minor.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2275 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-27T21:05:49Z,nawrockie
2ebcabd8c69aada7f16c5cc7795c598b31a30d9c,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed all MPI mains so that the worker can successfully send it's
  error message back to the master, which prints it out.
o fixed bug with 'loose-end-tying' at end of hmmband.c:cp9_HMM2ijBands()


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2271 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-21T20:09:58Z,nawrockie
d2225a53174f614c2703695c8ccabb583447346f,Eric Nawrocki,eric.nawrocki@gmail.com,"Local Inside scan hits are now the highest scoring y,j,d Inside
subtrees with y equal to the internal entry state. Previously Inside
scan hits were summed over all possible y for best choice of j and d. 

This allows the cmsearch output to correctly print bounds of the
consensus positions in the 'Query' field for local Inside hits.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2270 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-19T23:33:56Z,nawrockie
58ed9158c90877c9ce5c02667709f813a65473cd,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor bug fixes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2269 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-19T20:52:47Z,nawrockie
c0b7ad3579473fe102da716b0f691c2e25e7fb53,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate.c: for filter threshold calculation:
  the HMM E-value threshold is now set differently:
  - first, if the E-value threshold yields a predicted survival
    fraction less than --starg (0.01 by default), the MAXIMUM
    of the following 2 is used to rewrite that: 
    1. E_F1: the E-value threshold that would find all observed CM
       emitted seqs (F==1.0
    2. E_Starg: the E-value threshold that gives --starg survival 
       fraction
  - if the new E-value threshold is below E_min, it is rewritten as
    E_min, E_min is the E-value for which a HMM filtered scan would
    take 9X as long as the CM scan of the survival fraction (with
    QDB).
  - --fviterbi forces that Viterbi filter be chosen as the CP9 filter
  - --fforward forces that Forward filter be chosen as the CP9 filter

o hmmband.c: fixed a bug in the way hmm2ij_bands() enforces it's
  minimum i and j bands at the end of the function. Extremely rare
  cases were crashing cmcalibrate (which uses HMM banded alignment to
  quickly determine if a CM emitted seq has a parse > cutoff). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2266 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-18T01:10:01Z,nawrockie
dd8c74d9f5472f074ab0f84ba5cceaf43ba79bb6,Eric Nawrocki,eric.nawrocki@gmail.com,"o added 2 new flags for cm->flags:
  CM_EMIT_NO_LOCAL_BEGINS and CM_EMIT_NO_LOCAL_ENDS which, when
  raised, specify that emitted parsetrees should never include local
  begins or ends, but should be sampled from a globally configured
  CM. This is achieved in cm_parsetree.c:EmitParsetree() for locally
  configured CMs *without* the need to globalize the model first. 
o dispatch.c:DispatchSearch() contract enforcement bug fixed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2265 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-17T01:38:16Z,nawrockie
95d8a4c6fff5f2f0325ac5576cc9ed63e5d0069d,Eric Nawrocki,eric.nawrocki@gmail.com,"o MPI cmcalibrate: RNG seeds are generated randomly from the master
  and sent to each worker (previously the seeds were just the
  processor number for each worker <wi>). I think it's still
  impossible to exactly reproduce cmcalibrate results if a different
  number of processors is used, but if the same number of processors
  is used with the same seed, the results should be the same.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2264 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-15T14:33:03Z,nawrockie
09f80755c0b1157c3844a0f54d6a3a5d9eb222a6,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed mpi cmsearch bug concerning how the sequence chunk sizes are
  determined. I reverted to how RSEARCH does it.
o fixed potential bug with how CMs are sent via MPI, CM probs weren't
  being zeroed after allocation, which was problematic for cm->begin
  and cm->end.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2263 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-14T14:54:59Z,nawrockie
390e3d875133f8421ffb4d8abd713d4fb2e235dd,Eric Nawrocki,eric.nawrocki@gmail.com,"o added --pbegin <x>, --pend <x>, --pebegin, --pfend <x> options to
  cmcalibrate to allow user to specify local begin/end probs. 
  This should only be temporary, just for me to test what the
  'optimal' parameters for local begin/end probs is. We wouldn't want
  user to be able to change these b/c once E-values are calc'ed for 
  a CM with certain local begin/end prob parameters, once those are
  changed the E-values become invalid. You could do this if you stored
  these values in the CM file, from cmbuild, and then did not allow
  them to be changed, but it's probably better just to hard code the
  best values. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2261 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-13T14:54:14Z,nawrockie
0ca64115ae247bca5dbbcdd5c9264dfe4ad37666,Eric Nawrocki,eric.nawrocki@gmail.com,"o added --pfend <x> option to cmsearch which forces all local end
  probs from legal states v have transition prob (v-->EL) of <x>.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2260 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-13T14:30:10Z,nawrockie
c48af61e15ae3360ac38fc0cf5b7ddab1b926285,Eric Nawrocki,eric.nawrocki@gmail.com,"o MPI cmcalibrate with HMM filter calculation now seems to be working.
o added --pebegin option to cmsearch which sets probability of all
  legal local begin points (including node 1) as equiprobable. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2259 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-13T12:16:17Z,nawrockie
87a5b81b28a095010dcde48971b4a7be451623b4,Eric Nawrocki,eric.nawrocki@gmail.com,"o MPI cmsearch with --fgiven now appears to be working with HMM
  filters.
 --This line, and those below, will be ignored--

M    src/Makefile.in
M    src/cmsearch.c
M    src/structs.h
M    src/mpisupport.c
M    src/cm_io.c
M    src/cmcalibrate.c
M    src/funcs.h
M    src/cm_dpalign.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2257 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-12T15:20:27Z,nawrockie
905f07282d8e656073720297aadae6ab8b584003,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmsearch --fgiven: predicted survival fraction is printed.
o cmcalibrate: filter thresholds stored in E-values now instead of bit
  scores to deal with multiple partitions. We store E-value of
  partition that emitted seq's GC content belongs in. Not completely
  satisfactory.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2256 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-11T23:32:08Z,nawrockie
47dc66439c5cdb9e893636175661b4f8d663f856,Eric Nawrocki,eric.nawrocki@gmail.com,"o serial cmcalibrate can now output best HMM filter to a CM file
o cmsearch can read in best HMM filters in CM file and set the filter
  with --fgiven.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2255 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-11T18:34:12Z,nawrockie
1c7ec7d95188c3698ca053c717a2117244e8757b,Eric Nawrocki,eric.nawrocki@gmail.com,"o working on 'best filter' calculation in serial cmcalibrate
o code exits cleanly on anecdotal tests, but I think hybrid scanning
  filter calculation is buggy.
o MPI cmcalibrate currently won't work for 'best filter' calculation


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2254 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-11T13:34:16Z,nawrockie
5e3d7deea2ed6b4f605e9f95f81bc216119ca5a7,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed bug in cmcalibrate.c, now only the master tries to rewrite the
  CM file.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2253 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-07T21:56:47Z,nawrockie
d6a7a16a16464122af072925a0d84f080e69114d,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmcalibrate updated: 
  - gumbel stats calculated and printed to the CM file in serial and
    MPI mode.
  - --pfile option added for 'partition files', which can be used in
    serial and MPI mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2252 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-07T21:07:53Z,nawrockie
11a050d2125435ce54c688b231f5bc766f529f0b,Eric Nawrocki,eric.nawrocki@gmail.com,"o working on cmcalibrate, it now fits gumbels for all 8 modes,
  glocal/local, cyk, inside, viterbi, forward in serial mode.
o cmsearch --pbegin and --pend options added for manipulating the
  aggregate local begin/end probabilities.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2251 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-06T14:46:27Z,nawrockie
066ce04a3603bb9e306b6feb88986ec4a353052d,Eric Nawrocki,eric.nawrocki@gmail.com,"o Made small changes so cmcalibrate will compile with newly reorg'ed
  code. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2250 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-06T10:29:57Z,nawrockie
1f29a898fe42d7b91e66b1060d22ab8e4e4b87f8,Eric Nawrocki,eric.nawrocki@gmail.com,"o Massive reorg commit 6.
o Added cp9_modelconfig.c and cp9_trace.c.
  - these files contain functions that were
    previously in cp9.c. No new funcs written.
o Added seqstoaln.c, which has funcs that used 
  to be in dispatch.c
o Either deleted or moved (to old_miscfuncs.c) 
  deprecated, uncompiled or non-used functions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2249 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-05T19:18:23Z,nawrockie
3f1b74a7ef79b332ce4371cef956156037742686,Eric Nawrocki,eric.nawrocki@gmail.com,"o Massive reorg commit 5.
o Several small .c files were 'absorbed' by other .c files, meaning
  the entire set of functions of the absorbee were moved to the
  absorber:

  absorbee       absorber
  --------       ---------
  emitmap.c      display.c
  cm_cluster.c   cmbuild.c
  emit.c         cm_parsetree.c
  cm_masks.c     cm_parsetree.c

o Several .c files were renamed in goal of making naming of .c files
  more consistent, in all cases the only change was that the prefix
  was dropped from the name: 

  old name                new name
  --------                --------
  cm_dispatch.c           dispatch.c
  cm_cp9_hybridsearch.c   hybridsearch.c
  cm_errors.c             errors.c
  cm_rnamat.c             rnamat.c
  cm_eweight.c            eweight.c
  cm_searchinfo.c         searchinfo.c

  The goal of the naming convention is to have all files with prefix 
  'cm_' be mainly (if not only) relevant only to CMs, all files with
  prefix 'cp9_' to be mainly (if not only) relevant to CP9 HMMs, and
  all other files to be relevant to both.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2248 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-05T17:09:59Z,nawrockie
56f5572d28819f765c1bc1f8dcf389e2f9f99c27,Eric Nawrocki,eric.nawrocki@gmail.com,"o Massive reorg commit 4.
o Renamed file CP9_cm2wrhmm.c as cp9_modelmaker.c
o Renamed file cp9_fastsearch.c as cp9_dp.c
o Added old_cp9_dp.c: which holds old (v0.81) versions of the CP9 DP
  functions. This is compilable but should only be compiled for the cp9_dp.c
  benchmark driver. In this driver, the new DP funcs in cp9_dp.c are
  tested against the old ones in old_cp9_dp.c.
o Added old_miscfuncs.c added with NON-COMPILABLE functions kept for solely
  for reference.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2247 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-05T16:14:39Z,nawrockie
defb2043877af6c8761b8e486e9dc9dd957e7658,Eric Nawrocki,eric.nawrocki@gmail.com,"o Massive reorg commit 3.
o Vast majority changes are simple renamings of .c files to bring
  about a reasonable level of consistency between names. More files
  will likely be renamed in (near) future commits:

  old name          new name   
  --------          --------
  cmio.c            cm_io.c
  cm_fastsearch.c   cm_dpsearch.c
  cm_fastalign.c    cm_dpalign.c
  smallcyk.c        cm_dpsmall.c
  bandcyk.c         cm_qdband.c
  modelconfig.c     cm_modelconfig.c
  modelmaker.c      cm_modelmaker.c
  parsetree.c       cm_parsetree.c
  sub_cm.c          cm_submodel.c
  rnamat.c          cm_rnamat.c
  cplan9.c          cp9.c
  cp9_fastsearch.c  cp9_dp.c

o other changes: 
  - truncyk.c minimally changed: CM_LOCAL_BEGIN was changed to
    CMH_LOCAL_BEGIN, #include ""cm_postprob.h"" removed (cm_postprob.h
    no longer exists).
o cp9_Fast*() functions in cp9_dp.c (formerly cp9_fastsearch.c) had
  'Fast' removed from the name, as there are no longer any 'slow' or
  'ref' versions of those functions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2246 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-05T15:07:42Z,nawrockie
d8618a5bafd9f1e3c1dca72a3a84d0c1ba45de60,Eric Nawrocki,eric.nawrocki@gmail.com,"o Massive reorg commit 2
  - forgot to svn delete hbandcyk.c in last commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2245 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-05T13:31:40Z,nawrockie
d43b08109595b7cd72db65620b54a04925aeb25a,Eric Nawrocki,eric.nawrocki@gmail.com,"o First in a series of commits for massive reorganization. 
  Some functions will be moved from 1 .c file to another. Some .c
  files will be renamed, others deleted (either from compilation list
  in Makefile.in, or altogether).
o This commit:
  - deleted: scancyk.c, scaninside.c, cm_postprob.c, hbandcyk.c
  - added:  
      o old_cm_dpsearch.c: contains the 'old' DP search functions from
        scancyk.c, scaninside.c, hbandcyk.c 
      o old_cm_dpalign.c: contains the 'old' DP alignment functions
        from hbandcyk.c, cm_postprob.c
      o old_funcs.h: contains list of funcs in old_cm_dpsearch.c and
        old_cm_dpalign.c
  - NOTE: old_cm_dpsearch.c and old_cm_dcm_fastsearch.c are not
    in Makefile.in's compilation list, thus they're not normally
    compiled.
  - cm_fastalign.c and cm_fastsearch.c's benchmark drivers have new
    instructions for compiling old_cm_dpalign.c and
    old_cm_dpsearch.c. The functions in the old_cm_dp*.c files are
    required for those drivers, which test new DP functions versus the
    old ones. The design goal is to only compile old_cm_dp*.c files if
    you want to test the old v0.81 DP functions versus the new 1.0
    functions through cm_fastalign.c's benchmark-fastalign or
    cm_fastsearch.c's benchmark-fastsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2244 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-05T13:22:15Z,nawrockie
b525185ce766e911cd935d068775516238280875,Eric Nawrocki,eric.nawrocki@gmail.com,"o fixed bug with multiple filters in cm_dispatch.c
o other changes minor and/or cosmetic
o about to do massive reorganization of all functions, moving
  functions from 1 .c file to another, renaming .c files and 
  removing .c files altogether


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2243 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-04T22:22:57Z,nawrockie
b6629136588d11377ab314c9bb40c9f09a985dce,Eric Nawrocki,eric.nawrocki@gmail.com,"o allocation and initialization of ScanMatrix_t's is now more efficient.
o all DP search functions no longer take W as input argument, but
  use smx->W instead (smx is an input argument to those funcs).
o other changes are mainly cosmetic and small fixes 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2242 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-04T14:52:51Z,nawrockie
a73997280f2c5d7e4e34d32eebf7f7362a049256,Eric Nawrocki,eric.nawrocki@gmail.com,"Moved cm_filterinfo.c to cm_searchinfo.c. This is because as of last
revision (r2440) I had renamed the FilterInfo_t object to
SearchInfo_t.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2241 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-04T01:56:03Z,nawrockie
eeef23cf015307925ca9e687aa98090e7929b3d5,Eric Nawrocki,eric.nawrocki@gmail.com,"o Still overhauling how cmsearch does filtering:
  o thresholds are now calculated for each 'round' of searching.
  o FilterInfo_t data structure was renamed SearchInfo_t
  o cm->cutoff, cm->cutoff_type, cm->cp9_cutoff, cm->cp9_cutoff_type
    are no longer, all cutoff info is in the SearchInfo_t object
  o cmsearch now has ability to add up to 2 filters, one an HMM
    viterbi or forward filter and one a CM CYK or inside filter, which
    can have it's own QDBs.
  o none of this has been tested thoroughly, and almost all of it
    probably doesn't work quite right yet
o Next commit I'll rename cm_filterinfo.c as cm_searchinfo.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2240 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-04T01:20:34Z,nawrockie
e2c34c33361791fc2d89480fb4ac860f219e8fe3,Eric Nawrocki,eric.nawrocki@gmail.com,"o CM DP scan functions in cm_fastsearch.c now require a ScanMatrix_t
  object passed in. Before this those functions automatically used the
  CM_t's smx object; this new way is more flexible and eases the use
  of filters.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2239 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-03T12:25:44Z,nawrockie
02fd9fb6039733bfea64479f5d68c4336f05c61b,Eric Nawrocki,eric.nawrocki@gmail.com,"- Easelfied testsuite test mains(), and made sure they are working. 
  This required fixing some problems with previous Easelfication of
  functions in /src/*.c files that are solely used by the testsuite.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2237 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-12-01T00:14:41Z,nawrockie
0aaa9fbf81fd52b2a732d5f0564c6a88aa50085e,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on cm_cp9_hybridsearch.c.
  - the HybridScanInfo_t object <hsi> now has it's own ScanMatrix_t
    object, which holds a full (valid for all states 0..M-1) scanning
    DP matrix that enforce the d bands in hsi->dmin and hsi->dmax.
  - cm_cp9_HybridScan() now uses the HybridScanInfo's alpha matrix
    when scanning, which may have d bands that differ from the CMs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2236 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-30T14:26:39Z,nawrockie
0683b0d4715bd00979844a0d75971b939740ad16,Eric Nawrocki,eric.nawrocki@gmail.com,"o working on accelerating and cleaning up cm_cp9_hybridscan.c,
  it seems to be working now at reasonable speed relative to CYK and
  Viterbi.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2235 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-29T23:56:35Z,nawrockie
8d9ce1873d6848f94f00b7d80152cf031935eee8,Eric Nawrocki,eric.nawrocki@gmail.com,"o cm_GammaHitMx_t object renamed to GammaHitMx_t, and extended to work
  for both CM scans and CP9 scans. Some new CP9 specific functions
  that manipulate the GammaHitMx_t structure were implemented.
o All cp9 DP functions in cp9_fastsearch.c were updated to use the new
  GammaHitMx_t data structure.
o cp9->otsc object was added to the CP9_t data structure, which is now
  filled in CP9Logoddsify() and used by all DP funcs in
  cp9_fastsearch.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2234 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-29T20:51:39Z,nawrockie
2c0db057a507ff27d459ffe7a16dade2820a7643,Eric Nawrocki,eric.nawrocki@gmail.com,"o removed cm_scaninfo.c:
  - ScanInfo_t object renamed to ScanMatrix_t and associated functions
    were moved to cm_mx.c
o added cp9_mx.c:
  - CP9_dpmatrix_t object was renamed CP9_MX, and functions were
    updated to allow matrix to grow in only 1 dimension, the N
    dimension, sequence length, M the number of nodes cannot change,
    meaning a matrix must be allocated specifically for a CM.
o added cm->cp9_mx and cm->cp9_bmx data structures, these are
  CP9 DP matrices that are allocated very small at first (2 rows, M
  columns) and then grown only as necessary during the life of the CM.
  - CP9 DP matrices are now allocated once in ConfigCM() and grown
    inside the CP9 DP functions, and are never freed
o all CP9 DP functions were updated to work with the new matrices


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2232 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-28T21:40:32Z,nawrockie
37767dbbe6268ae38f330d333312d48c27bb93c8,Eric Nawrocki,eric.nawrocki@gmail.com,"o currently overhauling cm_dispatch.c:ActuallySearchTarget(), the main
  change is how filtering is handled.
  - new .c file, cm_filterinfo.c houses functions for the FilterInfo_t
    object, which specifies parameters for N rounds of filtering
  - ActuallySearchTarget() now calls itself recursively for each
    filtering round. Old behavior from CP9_scan.c:CP9Scan_dispatch()
    and CP9_scan.c:RescanFilterSurvivors() was clunky and limited to a
    single round of HMM filtering
o much work left to be done, but the shell of the code is complete,
  and non-filtered runs seem to be working with the new organization.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2231 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-27T23:05:44Z,nawrockie
7d57a58007664d84c7929fdf823bbf887d887384,Eric Nawrocki,eric.nawrocki@gmail.com,"o updated CP9 search/align functions in cp9_fastsearch.c to return
  Easel error codes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2230 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-27T13:15:27Z,nawrockie
6a5f0d363e8c52a4cee799bbb98be58b4a73ada8,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed deep dp recursion off-by-one (rare) bug in cm_fastalign.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2229 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-26T21:38:52Z,nawrockie
877f5c581c5a547f2bfd3260f73ef178efb135d9,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch now has --post and --optacc options. display.c FancyAli
related functions were modified to allow cmsearch --post to annotate
the output alignments with posteriors.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2228 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-26T14:53:20Z,nawrockie
45905bb64786955bdf250fa76fd1a055c66dcdaa,Eric Nawrocki,eric.nawrocki@gmail.com,"HMM banded alignment is now default alignment strategy. Old default
was non-banded divide and conquer alignment.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2227 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-26T00:23:56Z,nawrockie
54653a77d0f8970e1ac7cb8520dc82fcc3e062c0,Eric Nawrocki,eric.nawrocki@gmail.com,"o combination of posterior calculation and local alignment now
  implemented. 
o combination of optimal accuracy alignment and local alignment now
  implemented.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2226 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-25T20:33:23Z,nawrockie
8277ff914d6c77b26d1f946b38b3adda27a0a76c,Eric Nawrocki,eric.nawrocki@gmail.com,"o Improved error handling in cmsearch and all search DP functions. 
  In theory, MPI can now have workers fail with informative error
  messages that will be sent back to master, though this has not yet
  been fully implemented. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2225 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-21T18:08:17Z,nawrockie
0fbbb0a664b29637845515228b5fa4c0275029c5,Eric Nawrocki,eric.nawrocki@gmail.com,"NOTE: The log message for revision 2223 was accidentally left blank.
      I'll include the intended log message for 2223 here.

Revision 2223 modified the following files:
Sending        src/cm_dispatch.c
Sending        src/cm_fastalign.c
Sending        src/cm_fastsearch.c
Sending        src/cm_mx.c
Sending        src/cm_postprob.c
Sending        src/cmalign.c
Sending        src/cmbuild.c
Sending        src/cmcalibrate.c
Sending        src/cmscore.c
Sending        src/cmsearch.c
Sending        src/funcs.h
Sending        src/structs.h

Main change was addition of easel error handling conventions to
cmalign. This comprised changing the prototypes of all cm_fastalign.c
functions so that the 'errbuf' error message could be propogated up to
cmalign's main. 

cmalign now checks if the DP matrix it is about to grow or create,
either HMM banded or not banded is less than a maximum size, this size
is CM_HB_MX_MB_LIMIT (currently 128 MB) for HMM banded cm_hb_mx
matrices, and CM_NB_MX_MB_LIMIT (currently 128 MB) for non-banded
float matrices. If the size is exceeded an error message is printed to
the screen as cmalign quits, except for 1 situation: HMM banded CYK
alignment: if the CM_HB_MX_MB_LIMIT is exceeded cmalign reverts to D&C
alignment with QDBs derived from the HMM bands. This only works with
CYK because D&C finds the CYK parse (can't do posteriors, optimal
accuracy, etc.)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2224 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-20T19:10:04Z,nawrockie
985a208e5c3d8dc0c879cdf7ccbffdbaaab489ce,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2223 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-11-20T18:51:40Z,nawrockie
afb969b5e2fb509a436174427a050ad2df9b6d91,Eric Nawrocki,eric.nawrocki@gmail.com,"o Extended cmalign --post functionality: 
  - precision of appended posterior probabilities extended to 2
    digits, requires 2 #=GR annotations for each residue ""POSTX."" for
    the 'tens' place ('9' for a posterior prob between [0.93..0.94))
    and ""POST.X"" for the 'ones' place ('3' for post prob b/t
    [0.93..0.94)).
  - can revert to single precision with --onepost.
  - downside: 2 digit precision is even uglier than single digit
    precision MSA output, but information is good.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2217 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-19T19:02:17Z,nawrockie
8055094e1cdfd8a28b572a894cca5f096fe6972f,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_fastalign.c:
  o implemented non-banded counterparts for all DP alignment functions
    in cm_fastalign.c, for completeness. Comparison of the banded with
    the non-banded functions should be instructive for figuring out how
    they work.
  o implemented non-banded optimal accuracy alignment 
  o ActuallyAlignTargets() now calls exclusively cm_fastalign.c's new
    DP functions for all alignments EXCEPT divide and conquer (D&C)
    small alignment, and any form of QDB alignment.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2216 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-19T16:34:02Z,nawrockie
24597c411424edcc313eff92b3b07c92a0155bda,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed some serious bugs with --optacc, a bit more convinced it
  'works' now, though more rigorous testing should/will be done.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2215 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-16T22:21:10Z,nawrockie
0bb756b2a6dd51b5955e2c78942ac7764f54120b,Eric Nawrocki,eric.nawrocki@gmail.com,"o Added support for finding the 'optimally accurate' alignment of
  Holmes/Durbin instead of CYK. Invoked using the --optacc option to
  cmalign, currently only implemented with HMM bands.
  - implementation 'seems' to work in that it doesn't seg fault, 
    but I'm pretty sure there are bugs, I just wanted to commit the
    initial, clean implementation before I start hacking away to see
    how it's broke.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2214 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-16T16:10:28Z,nawrockie
af8d4ac8b498f821705a55ec0ea2c2c3326dcc75,Eric Nawrocki,eric.nawrocki@gmail.com,"o renamed actually_align_targets() as OldActuallySearchTarget() and
  wrote a new function to replace it: ActuallyAlignTargets(). 
  - OldActuallyAlignTargets() calls v0.81 DP CM alignment functions 
    and is called using cmalign --olddp.
  - ActuallyAlignTargets() uses the new fast DP CM alignment functions
    from cm_fastalign.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2213 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-16T12:56:18Z,nawrockie
31edceec32c508e9e65cba5d29c44ffc8f3eb9e2,Eric Nawrocki,eric.nawrocki@gmail.com,"o Removed support for HMM banded integer matrices (CM_IHB_MX), 
  including two functions in cm_fastalign.c FastIInsideAlignHB() and
  FastIOutsideAlignHB(), now all HMM banded alignment functions are
  done with floats. Two main reasons for the change: (1) making
  parallel changes for floats and ints is maddening and (2) there were
  memory concerns with using int and float matrices simultaneously for
  the same sequence, now we are forced to only have 1 matrix.
o This is the only change made since the last revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2212 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-15T19:56:52Z,nawrockie
52e60d69f86bbed89fdd722455a8f4b803703d79,Eric Nawrocki,eric.nawrocki@gmail.com,"o Removed cm->sc_boost and cm->cp9_sc_boost from the CM_t data
  structure, and along with them probably the ugliest hack I've
  introduced to Infernal: an attempt lower the bit score reporting
  threshold for searching below 0. bits in cmsearch. 
  - it is still possible to lower the threshold below 0. bits, but
    only if --greedy (or --hmmgreedy for HMM score thresholds) is
    enabled. This is handled by cmsearch when setting thresholds, if
    -T <x> is enabled with <x> < 0. and --greedy is not also enabled
    the program dies.
o fixed a bug with reporting HMM banded hits in greedy mode in
  cm_scaninfo.c:cm_UpdateGammaHitMx(). 
o these are the only 2 change since the last revision. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2211 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-15T16:11:01Z,nawrockie
199ed6dc95e55a6a801d55e5ce8a86956a1a7cb2,Eric Nawrocki,eric.nawrocki@gmail.com,"o modified the CM_t data structure in structs.h
  - added ptr <cp9b> to the CP9Bands_t object for cm->cp9
  - added ptrs <fhbmx> and <ihbmx> to growable CM_FHB_MX and CM_IHB_MX
    HMM banded matrices for CM HMM banded DP functions, they stay
    'empty' unless such a function is called.
o renamed actually_search_target() as OldActuallySearchTarget() and
  wrote a new function to replace it: ActuallySearchTarget(). 
  - OldActuallySearchTarget() calls v0.81 DP CM search functions 
    and is called using cmsearch --olddp.
  - ActuallySearchTarget() uses the new fast DP CM search functions
    from cm_fastsearch.c.
o still to do: update ActuallySearchTarget to use new, fast CP9 search
  functions (for filtering and pure HMM search), this will be done
  once those functions are finalized in cp9_fastsearch.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2210 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-14T23:59:35Z,nawrockie
dddc01d63f4f5a34cc2233fc17cdf06d5366084c,Diana Kolbe,diana.kolbe@gmail.com,"Removed degeneracy check before calling marginal
score funcs.  (This case is now handled rather 
than fatal.)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2209 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-14T16:29:37Z,N/A
5a5c783b6e9d2f0bb190341a157ab50b72bfbde1,Diana Kolbe,diana.kolbe@gmail.com,"Added degeneracy handling to marginal score funcs.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2208 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-14T16:28:38Z,N/A
c6244239d198b9f9e295993b0db371ed0fab0b3e,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: off-by-one error in reporting length
covered by EL; only occurred when EL replaced
a MATL node.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2207 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-14T16:27:51Z,N/A
d84e88917dbdd6239f41fa031cf03229d8dc3af3,Eric Nawrocki,eric.nawrocki@gmail.com,"o implemented HMM banded Fast CYK scanning fuction
  cm_fastsearch.c:FastCYKScanHB()
o fixed improper allocation of cm->M deck in cm_mx.c
o other changes mainly cosmetic and memory frees 
o about to rewrite actually_align_targets() and
  actually_search_target() in cm_dispatch.c 
  to use new fast DP functions. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2206 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-14T15:19:12Z,nawrockie
1c6f710ff140d5518b1c135bc514002f98a311ed,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed memory related bugs in cm_fastsearch.c and cm_scaninfo.c
o Cleaned up code and added comments in cm_fastsearch.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2205 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-13T16:17:44Z,nawrockie
041b1153602df317164ea08d2e30baeb36a2c9f8,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor, mainly cosmetic changes. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2204 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-12T18:41:52Z,nawrockie
0310328afd49edfe10a58e6a0a7c45620165d55f,Eric Nawrocki,eric.nawrocki@gmail.com,"o cm_fastalign.c
  - optimized FastIOutsideAlignHB() 
  - added FastFInsideAlignHB() and FastFOutsideAlignHB().
  - cleaned up code and added comments
o CM_t data structure
  - added float **oesc and int **ioesc 2D arrays of
    optimized emission scores for Fast DP functions
    = they are updated in cm.c:CMLogoddisfy() so they
      should always be up to date.
    = one unusual thing: they are not alloc'ed until
      CMLogoddisfy(), b/c allocation depends on state
      topology (can't be alloc'ed before model is fully
      built).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2203 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-09T23:41:05Z,nawrockie
50fad7be5ddea19e40487a38bd2ab69040391a3c,Eric Nawrocki,eric.nawrocki@gmail.com,"I had forgotten to add the i12 perl script that reproduces the bug. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2202 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-08T20:49:14Z,nawrockie
79442f3e9b8c3a6611f021690cfd38fb59e432ab,Eric Nawrocki,eric.nawrocki@gmail.com,"Logged bug i12 that was broken as of svn revision 2199 and fixed as of
revision 2200 (the previous revision to this one). For more detail see 
~nawrockie/notebook/7_1108_inf_bug_outside_ambig_bps/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2201 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-08T20:47:06Z,nawrockie
c55bbb0c0b3f89c7dfd4f665dafa3785cb3f005a,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug i12 as logged in Bugs/BUGTRAX (that won't be committed until
revision 2201 though (and this is revision 2200)). For more details
see BUGTRAX and/or
~nawrockie/notebook/7_1108_inf_bug_outside_ambig_bps/00LOG.

This bug existed since Infernal v0.1!


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2200 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-08T20:46:10Z,nawrockie
1517063b8cd9fdc42388bef4ac3c488ab61a9053,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor changes made to make all the Bugs/ files pass with the current
1.0 code. They used some options combinations that were not yet tested
and proved buggy. Those bugs have been fixed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2199 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-08T20:12:05Z,nawrockie
3b4f5b8ebe1eeadbf652c0deca88417199e7a752,Eric Nawrocki,eric.nawrocki@gmail.com,"Many options in Infernal 1.0 have changed relative to 0.81. This
required me to change a lot of the Bugs/ files so that they conform to
the new options. In addition, 1.0 infernal excecutables cannot yet
read stockholm files as non-alignment sequences files. So I had to add
i2.fa to deal with this. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2198 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-08T20:10:49Z,nawrockie
a0096e75ab69e532d81ba3aee5629e369ff463a2,Eric Nawrocki,eric.nawrocki@gmail.com,"Made previously lame -F, -A options to cmbuild functional. They now
work as they did in version 0.81.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2197 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-08T14:43:10Z,nawrockie
697fab3d05a8176f0df92648cb32695eb906af1b,Eric Nawrocki,eric.nawrocki@gmail.com,"o added cm_scaninfo.c: an implementation of the ScanInfo_t data
 structure which holds info common to all  CYK/Inside scanners,
 including a DP matrix.

o made a ptr to a ScanInfo_t object part of the CM_t data structure, a
  new flag CMH_SCANINFO for use with cm->flags tells when it is
  valid. Any 'new' scanning function from cm_fastsearch.c requires
  this flag to be in it's contract.

o renamed many CM flags: 
  CM_LOCAL_BEGIN  --> CMH_LOCAL_BEGIN
  CM_LOCAL_END    --> CMH_LOCAL_END
  CM_GUMBEL_STATS --> CMH_GUMBEL_STATS
  CM_FTHR_STATS   --> CMH_FTHR_STATS
  CM_QDB          --> CMH_QDB
  CM_CP9          --> CMH_CP9
  CM_CP9STATS     --> CMH_CP9STATS
  - The H is for 'has' meaning this part of the CM structure is
    valid. These are now consistent with other flag names (such as
    CMH_BITS).
  - most of the files that are modified ('M') are due to this change.

o added following functions to cm_fastalign.c and started new naming
  convention for DP alignment functions:
  - fast_cyk_inside_align_hb() replaces inside_b_jd_me(), it's about 30%
    faster 
  - fast_cyk_inside_align_hbT() replaces insideT_b_jd_me()
  - FastCYKInsideAlignHB() replaces CYKInside_b_jd()
  - FastIInsideAlignHB()   replaces IInside_b_jd_me()
  - FastIOutsideAlignHB()  replaces IOutside_b_jd_me()
    (this guy has not been optimized yet).




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2196 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-08T10:48:10Z,nawrockie
bbb63fd19e54306641eb7abc07f4a9fb99043c55,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed an incredibly stupid oversight on my part. The filling of the
Float and Int lookup tables for the ILogsum and FLogsum functions was
broken. I hadn't correctly morphed the functions from their HMMER3
nat scores to Infernal bit scores. Do a svn diff for the details. This
took me hours to find...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2195 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-08T01:08:51Z,nawrockie
a292118fc45636f049fee53b3f0dde07767cd223,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_fastsearch.c now includes 6 CYK/Inside functions, 3 are optimized,
3 are 'reference' versions. 

FastCYKScan():     optimized CYK floats
FastIInsideScan(): optimized Inside ints
FastFInsideScan(): optimized Inside floats

RefCYKScan():      reference CYK floats
RefIInsideScan():  reference Inside ints
RefFInsideScan():  reference Inside floats

With gcc -g -O2 compilation: 
FastCYKScan()     seems to get about 270 Megacalcs/sec.
FastIInsideScan() ""                   80

These 6 functions completely replace the
various (non-HMM banded) CYK/Inside functions in scaninside.c,
scancyk.c, and bandcyk.c. Those functions are currently still
compiled in the code, but the plan is not compile them eventually. 

Other changes are minor/cosmetic.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2194 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-06T14:01:09Z,nawrockie
0118ef3ff3af9aa8bf4181369ae3be9a415036f3,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix in truncyk: handling EL above bifurcation in 
generic_splitter().  (Also removed misguided error
if a model chunk ending in B_st and known to use
EL gets sent to tr_vinside().)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2193 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-05T18:45:12Z,N/A
0b8c244d06e2c573525e1ac762a369d87726690a,Eric Nawrocki,eric.nawrocki@gmail.com,"o Main reason for commit: About to overhaul how CM scanning functions
  in cm_fastsearch.c are organized by using functions to
  allocate/initialize the DP matrix, gamma semi-HMM etc., so that
  code in common to all scanners is implemented only once. That code
  is written in cm_fastsearch.c, but isn't used by those scanners
  yet. I'm about to change that, but it's possible that will mess
  everything up so I wanted to be able to revert to this revision if
  nec.

o Also, worked on starting to incorporate hybrid search into
  cmcalibrate.c  but not much progress was made.

o Other changes are minor.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2192 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-05T15:27:32Z,nawrockie
02056b91f0ae64804f7221b87a501196fa2bb90e,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding cm_mx.c: support for a growable DP matrix for HMM banded CM
alignment. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2191 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-04T20:01:54Z,nawrockie
cc2219dde43cf2fd557b78115799b206ecce82e9,Eric Nawrocki,eric.nawrocki@gmail.com,"Added the following 2 vital lines to all .c executables before command
line processing starts (that's cmalign.c, cmbuild.c, cmemit.c, cmscore.c,
cmsearch.c, cmstat.c):

  /* setup logsum lookups (could do this only if nec based on options, but this is safer) */
  init_ilogsum();
  FLogsumInit();

This sets up the new logsum functionality. Stupidly, I traced a
bug with cmalign --post for an hour before realizing I just needed to
initialize the logsum lookup tables. 

Other changes are cosmetic.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2190 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-01T17:07:08Z,nawrockie
de7ef15ef9984beadc4211a23b3529654b53e8ca,Eric Nawrocki,eric.nawrocki@gmail.com,"o added cm_cp9_hybridsearch.c with functions for experimental 'hybrid' CM/HMM
  scanning of a sequence. Seems to be working anecdotally, but not
  nearly finished.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2189 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-11-01T15:33:18Z,nawrockie
5f11651d00286f260f9852314129c23d0b49b86e,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on optimizing HMM banded alignment in
cm_fastalign.c. Seems like current speedup versus v0.81 is about 30%,
but B_st recursions have yet to be optimized. Good checkpoint.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2188 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-28T15:58:35Z,nawrockie
837d1214bbd4f05c2d93bf23d4d54c5767f83c9a,Eric Nawrocki,eric.nawrocki@gmail.com,"Experimenting with a new scanning CYK function by modifying
cm_fastsearch:FastCYKScan() into cm_fastsearch.c:XFastCYKScan() 
which is tested with the -x option to benchmark-fastsearch.

It is not yet complete.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2187 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-24T21:13:51Z,nawrockie
e4e171b96585ede80c4d027bae712ae96045e676,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --withpknots option to cmalign which must be used in combination
with --withali <f>. This option adds pseudoknotted structure
annotation from any consensus columns in <f> to the output alignment.

For details and testing see
~/notebook/nawrockie/7_1017_cmalign_withali_struct/00LOG


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2186 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-18T18:06:37Z,nawrockie
f20a30009998cb40a5162e18da056a18ba4bf82d,Diana Kolbe,diana.kolbe@gmail.com,"Changes to CreateFancyAli(); should only affect
marginal alignments.  Treat marginal local ends
like EL for display, even though there isn't an
EL actually in the parsetree.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2185 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-18T14:27:10Z,N/A
bbc75c1b8f17714615086a32a988301027cb4d2a,Eric Nawrocki,eric.nawrocki@gmail.com,"o --rsearch option added to bencmark-fastsearch inside
  cm_fastsearch.c, which runs RSEARCH's scanning algorithm.
o bug fix involving setting E state decks for d>0 to IMPOSSIBLE for
  non-QDB scanning in cm_fastsearch.c::FastCYKScan(). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2184 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-18T10:43:57Z,nawrockie
43bc322b28da82868b772a2dbb2ebba50488ecf9,Eric Nawrocki,eric.nawrocki@gmail.com,"Only cosmetic changes in this revision, here's what's changed:

o changed name of fastsearch.c to cm_fastsearch.c, this required a svn
  delete and svn add.
o updated Makefile.in to reflect this name change.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2183 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-18T09:05:14Z,nawrockie
e7e7d075ec7f49b4a5d2bdd7273230d188f0c0f9,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on acclerating HMM banded alignment. All the code that
goes from sequence to i and j bands has been examined and accelerated
where it was clear how to do it.

Acceleration is about 25% for non --sub alignment, and about 50% for
--sub alignment. A testing benchmark is in cm_fastalign.c. 

This revision had undergone the following changes:

New functions, due to reorg of code for acceleration:
cp9_FB2HMMBands()
cp9_FB2HMMBandsWithSums()

Rewritten functions for speed:
hmmband.c::cp9_Seq2Bands()
hmmband.c::cp9_Seq2Posteriors()

Deleted functions:
hmmband.c::cp9_hmm_band_bounds()
CP9_scan.c::CP9ScanPosterior()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2182 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-17T21:57:27Z,nawrockie
8c7949abd14c2d8945040edb7b3069f42877fc3b,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with previous commit. This is the version tested in
~/notebook/7_1010_inf_optimize_alignment/testing_7_1017/.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2181 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-17T18:31:23Z,nawrockie
605f8eb2db31570a59be7327408c125cdb2d8f96,Eric Nawrocki,eric.nawrocki@gmail.com,"Some progress made on cm_fastalign.c for accelerating HMM banded
alignment. About to test that new code gives identical bands to old
code. For log/details on testing see
~/notebook/7_1010_inf_optimize_alignment/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2180 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-17T18:19:39Z,nawrockie
70af67c924fa8d8e0e891302182b10a4369a8747,Eric Nawrocki,eric.nawrocki@gmail.com,"Current code is broken. Reason for commit is I wanted a local copy of
current code to work offline on laptop.

Currently working on accelerating HMM banded alignment, for this
reason, cm_fastalign.c was added with experimental HMM banded
alignment related functions to test versus old 0.8 versions.
cm_fastalign.c includes a benchmark driver.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2179 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-16T11:13:59Z,nawrockie
a6f7a957db8948c38a62637c9af92969c3ae0483,Eric Nawrocki,eric.nawrocki@gmail.com,"New cp9 Forward implementations in cp9_fastsearch.c.

o cp9_FastForward(): first attempt at optimizing, became a reference
  to compare with experimental version (below).

o cp9_EXPTLFastForward(): about 20% faster than cp9_FastForward() in
  worst case (with local begins/ends and ELs on). Speedup mainly due
  to using logsum.c::ILogsumNI(sc1, sc2) instead of ILogsum(sc1,sc2)
  in the main chunk of the dp recursion loops. ILogsumNI() assumes
  neither sc1 nor sc2 is -INFTY which saves at least 2 operations.
  This assumption must be guaranteed to be true
  however. benchmark-cp9_fastsearch (a benchmark driver in
  cp9_fastsearch.c) checks to make sure this is true for the given
  sequence about to be scanned/aligned and passes a flag into
  cp9_EXPTLFastForward() telling it if it's safe to use the
  ILogsumNI() calls or not. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2178 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-12T15:36:15Z,nawrockie
b63330dfb3eaa8ac7137dd83fd5aead41adf071f,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed all code associated with optimized CP9 HMM DP matrices that
was originally stolen from HMMER3. Removed code includes the
cp9_fastsearch.c::cp9_EXPTLFastViterbi() function which implements
Viterbi using an optimized matrix. See log from revisions 2175 and
2176 for details on why this was done.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2177 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-10T13:06:56Z,nawrockie
7e4b807db818d15a9b9e2b693f57595ee24cc80f,Eric Nawrocki,eric.nawrocki@gmail.com,"o cp9_fastsearch.c::cp9_FastViterbi() has been rewritten to use the
  old DP matrix data structure instead of the optimized DP matrix data
  structure. This was done so I don't have to reimplement all
  functions that take a CP9 DP matrix and do something with it (for
  ex: CP9ViterbiTrace() and CP9Posterior(). The new cp9_FastViterbi()
  seems to be the exact same speed as the version from the previous
  subversion revision (2175), while not using the optimized matrix.
  An optimized transition vector is filled inside cp9_FastViterbi()
  which takes about as much compute as searching 12 nucleotides with
  the HMM. The old version with the optimized matrix has been renamed
  as cp9_fastsearch.c::cp9_EXPTLFastViterbi().


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2176 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-10T12:50:26Z,nawrockie
3c29a620a1943a999d4bc8e4663f4bb27dc34614,Eric Nawrocki,eric.nawrocki@gmail.com,"o fastsearch.c: includes FastCYKScan(), an optimized scanning CYK
  function that seems about 2.5X faster than version 0.8 of
  non-optimized CYK scanning function. Includes a benchmark driver. 

o cp9_fastsearch.c: includes cp9_FastViterbi(), an optmized version of
  Viterbi for scanning or alignment that seems about 2X faster than
  non-optimized versions.

For notes on the development of these 2 functions and copies of
intermediate versions (I saved a lot of backups during development),
see 00LOG in ~nawrockie/notebook/7_1004_inf_optimize_search/.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2175 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-10T09:03:41Z,nawrockie
8acf747a172efe94a05dccb99b89d90a774a5343,Diana Kolbe,diana.kolbe@gmail.com,"More thorough checking on whether local begin
is permitted: disallow begin into D,S,E,IL,IR
states.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2174 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-08T14:40:31Z,N/A
1ca7a210af82acea4310684586a6635d4abe66bd,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: prevent local hits rooted at IL/IR states



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2173 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-05T17:03:27Z,N/A
5ab442806245ff609fc5851780345ff8443e74a6,Diana Kolbe,diana.kolbe@gmail.com,"Switched trcyk to D-and-C rather than full;
only prints output from better scoring of
forward/reverse strand.

Switched both trcyk and truncyk_check to
create new seq objects for each sequence,
as recycling appeared to be bugged in some
cases.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2172 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-04T19:02:13Z,N/A
e7fb420662e78fe785d2c480ae1e6a5357c9de47,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes for truncyk.c
 Currently passes my stage 4 tests;
no further testing planned unless problems
become evident.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2171 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-10-03T14:48:03Z,N/A
b3450293c0ab95abefc026369e8b2659558003de,Diana Kolbe,diana.kolbe@gmail.com,"Removing temporary revision of truncyk.c
truncyk.c proper is now easel-ified.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2170 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-28T15:24:50Z,N/A
f9904c14945aac2efbbf000041ef8ed4b364d776,Diana Kolbe,diana.kolbe@gmail.com,"Continued (finished?) easel-ification of truncyk_check
Re-instating mode-check changes to parsetree score/dump
that apparently got clobbered.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2169 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-28T15:04:07Z,N/A
7e0db7d40a330a69a5a067a9c83e30b9055aa54b,Diana Kolbe,diana.kolbe@gmail.com,"Stopwatch converted to easel in truncyk_check.
Still needs options conversion



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2168 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-27T18:13:55Z,N/A
3aa486b06c4a429f7928b3ae62b63f4ab9d39018,Diana Kolbe,diana.kolbe@gmail.com,"Continuing easel-ification.
truncyk_check still needs option structure
and stopwatch to be converted.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2167 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-26T18:12:45Z,N/A
fe8e7ace847a6424c5ac91fff1a8b23eb670d793,Diana Kolbe,diana.kolbe@gmail.com,"Easel-ification for truncyk.  truncyk.c
passes compile, others unchecked b/c of
MPILIBS error.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2166 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-25T18:32:08Z,N/A
c6d1ea58d0aca4f819367ecc66db5e6cd351319d,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes.  Passes my stage 4 testing.

Note: changed from revision 2159; 2160
includes Easel-ification and breaks compile.
Apply these changes to 2159 to get a working
version.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2165 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-21T21:50:57Z,N/A
7c4c08877825763de33e04d80ac1c42668f6fa50,Eric Nawrocki,eric.nawrocki@gmail.com,"o cmalign: output alignments now have inserts ""regularized"", split in
  half by default. This is how HMMER does it but was not yet in
  Infernal. Should work for both CM alignment and --hmmonly alignment.
o --fins restores old default insert behavior where IL state
  insertions where flushed left and IR state insertions were
  flushed right (this even works with --hmmonly).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2164 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-21T20:35:58Z,nawrockie
98cac238f253a3cfe3d4eaceea6a57798a6a3681,Eric Nawrocki,eric.nawrocki@gmail.com,"I forgot to add cm_errors with the 1.0-dev merge.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2163 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-20T20:25:57Z,nawrockie
ac981ba12e362147a6eb5d46a8f1c1b9fb12dd23,Eric Nawrocki,eric.nawrocki@gmail.com,"Merged 1.0-dev branch changes r2056:2161 into the trunk. See log in
that branch for details. Brief summary:

o Squid is no longer needed EXCEPT in truncyk.c and testsuite/ which
  have not been Easelfied yet.
o configure.ac script updated to support new MPI strategy, but has not
  been rigorously tested/exercised.
o logsum.c ripped out of HMMER3 and added here
o mpisupport.c replaces mpifuncs.c (which should be deleted soon)
o cmstat, a new executable prints various stats on a CM file.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2162 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-20T18:35:51Z,nawrockie
84f7e4bcaaa67cfe484a9f760bc03f5632a31f7c,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes: typos; add initial state to trace
in wedge_splitter if parent is empty.

Bugfix: in vinsideT: never reach check for transition
to EL because of new loop limit on traceback to
accomodate marginal parses that just stop rather than
going to E or EL.  Solution: add check for useEL
after traceback loop finishes, and add EL state to
trace.  This is slightly cludgey, especially since
the EL check still exists in the loop, although
I think it will now never be reached.

D-and-C now passes my third stage tests.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2159 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-20T14:45:20Z,N/A
5d0cf3cd528c59f2c33f7b44c1619920aad88e4c,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: empty + joint children combination
at bifurcations in generic_splitter for DnC



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2158 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-19T18:33:00Z,N/A
f72e2a90ce44947a1ac8848319cfc0295e19a517,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes: L vs. R in local end check for outside()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2157 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-19T14:48:23Z,N/A
6cb8bc3ae3599937228e27790ec2ab140157f142,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: typo in vinsideT()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2156 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-19T14:33:58Z,N/A
b03764d96344bca437b9d74d394cbee2ca4e435e,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix for mode check in ParsetreeScore



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2155 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-19T14:12:57Z,N/A
62734aae60194d7964b724db22c0f68f22f52df4,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes: marginal mode allowed checks in
v_splitter



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2152 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-18T18:42:44Z,N/A
5f2b3ee4d8af29848bf02b02bb6f92493e11ed22,Diana Kolbe,diana.kolbe@gmail.com,"Minor change for scoring or dumping parsetree
to remove dangling transition (to undefined state)
when encountering a marginal local end (possibly
terminates at any state, rather than transitioning
to E or EL).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2151 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-18T17:45:27Z,N/A
fa43d0e3b312df1ef2e8a1ba212cdd4a25ba3315,Diana Kolbe,diana.kolbe@gmail.com,"Prevent EL from being added to parsetree in
case of marginal local end.  Cleaned up
some debugging statements.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2150 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-18T17:35:53Z,N/A
1547028d384a3a54dd0b264a2f491564fe64e674,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes, esp. dealing with marginal ends within outside



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2149 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-17T20:02:33Z,N/A
6c98fd3007f9172dad898e3082b2a0b2c4ec91a6,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes.  Passes my second round of testing.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2148 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-17T14:36:31Z,N/A
d77077966bda25ce69df1b0f4338cd0b8e3e2d2b,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes.  Changed handling for best score
calculation so that you don't get parses with
complete states but not complete sequence when
local begin isn't allowed.

Changed priority of cases for finding split in
v_splitter and wedge_splitter.  Cases where
parent or child is empty now have highest priority
in case of ties.  Prevents case of empty parent
being interpreted as alpha+marginal beta (where
the parse in beta is actually empty).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2147 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-14T19:09:59Z,N/A
a23e8e459050cd9d49ae9f7c255d6685addfbb97,Diana Kolbe,diana.kolbe@gmail.com,"- Design change for truncyk.c engines: full set
of allowed mode flags - up to 6 plus allow_begin
A little awkward for function calls, but should
give needed granularity.

- Switched tr_insideT to using tr_inside instead
of (deprecated) trinside.  Important because the
old trinside doesn't pay attention to allowed
modes.

- for truncyk_check, moved back to FATALs rather
than warnings, since we're actually passing the
test at least some of the time now.  Easier to
catch errors that you're not expecting.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2146 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-14T17:34:20Z,N/A
c7adc28b5df02be22b0147059db76d1db7644274,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixing (various - pointer casts; priority
for same score paths in traceback; etc.)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2137 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-11T14:38:09Z,N/A
61ede844edfe85e8fce7c2d9bc4f413d016cc07d,Diana Kolbe,diana.kolbe@gmail.com,"Previous commit introduced a new bug for DnC
traceback/parsetree.  Enclosed in a conditional
to fix.  Note that DnC traceback/parsetree
still has other problems.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2133 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-10T15:32:07Z,N/A
ef266622d7b0eb2e3b598b8dba5adab2e45aa492,Diana Kolbe,diana.kolbe@gmail.com,"Added trace node insertion needed for new local
setup.  TrCYKInside score now matches the score
of the parsetree it returns.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2132 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-10T15:24:34Z,N/A
880e21b5d0c11be2cd355f53e906ded7195a947f,Diana Kolbe,diana.kolbe@gmail.com,"Closed memory leaks in DnC.
truncyk_check updated to include fragment
score correction when evaluating score
based on the parsetree.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2127 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-06T14:47:22Z,N/A
526329778515b9a74b8419f07e0f6cfb99bfa417,Diana Kolbe,diana.kolbe@gmail.com,"Runnable executable for trcyk divide-and-conquer.
size calculators from smallcyk are now non-static
and prototyped in funcs.h so that truncyk.c can
access them.  



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2124 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-05T18:04:23Z,N/A
7c148bbe8098caa43cd051d1d0a7824b429635c3,Diana Kolbe,diana.kolbe@gmail.com,"Presumed typo in function name; change needed for compile.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2123 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-05T17:59:07Z,N/A
fd5fcde024e428a431172ca23e0f4cf01e973038,Diana Kolbe,diana.kolbe@gmail.com,"Fixed type and syntax errors in DnC funcs



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2117 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-09-04T04:41:20Z,N/A
efb3f41201b881daff681653220a9a3611e66428,Diana Kolbe,diana.kolbe@gmail.com,"tr_vinsideT() (preliminary)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2112 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-31T18:35:27Z,N/A
91f1586934c00e0a9d8a4003f52338ab141ca930,Diana Kolbe,diana.kolbe@gmail.com,"tr_voutside() (preliminary)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2108 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-30T18:49:38Z,N/A
951bf405fbfb612965275d0b085add07b34f9f38,Diana Kolbe,diana.kolbe@gmail.com,"Changed all occurrences of
foo != IMPOSSIBLE
to
NOT_IMPOSSIBLE(foo)

because inequality comparisons on floats are a bad idea



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2107 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-30T18:25:36Z,N/A
7681aab0a424ec21014869e59c09e7cce19d3c58,Diana Kolbe,diana.kolbe@gmail.com,"tr_vinside (preliminary version)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2104 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-28T15:16:34Z,N/A
644e6fa734d18d1c2305ded04206d6eb21ff154f,Diana Kolbe,diana.kolbe@gmail.com,"tr_outside() added



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2096 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-23T18:20:05Z,N/A
83c2feb1e96166af87d6f125baddbb19ded9c095,Diana Kolbe,diana.kolbe@gmail.com,"Replace > with < when comparing dsq[j] to
Alphabet_size in calculating emissions for MP_st
This error was pervasive through outside() and 
voutside() and their banded variants



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2095 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-23T17:29:47Z,N/A
18ed852e93fd7c4bf82543235a8bf0b98e66409e,Diana Kolbe,diana.kolbe@gmail.com,"Fixed degeneracy check:
dsq[j0] < Alphabet_size
replaces
dsq[j0] > Alphabet_size

in vroot->EL section of outside()

This was a potential seg fault for some
combinations of dsq[i0] and dsq[j0]



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2084 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-21T18:57:18Z,N/A
aad1f19b5ea37575db0b6c4f6d88c6879eb436f7,Diana Kolbe,diana.kolbe@gmail.com,"Changed tr_inside() to be able to accept & return
alphas and dpools



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2076 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-17T18:18:33Z,N/A
08bcc93593df0da15a4e243cfa3e22e2ebb0e5fe,Diana Kolbe,diana.kolbe@gmail.com,"Preliminary splitters for DnC



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2075 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-16T18:37:25Z,N/A
afc0c2e720e9bdccff00e1f8151eacd2165d1728,Diana Kolbe,diana.kolbe@gmail.com,"Minor changes to do reverse complement



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2074 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-16T18:36:52Z,N/A
b6470d665e654ed40235330e9cc21e209345b9e1,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed stray 'h' char in mpifuncs.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2073 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-16T12:43:21Z,nawrockie
373a85bf0aabcdef8378151b1393bab4905dc59d,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a MPI memory leak in cmalign.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2072 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-08-16T12:36:44Z,nawrockie
006f03291b779bd141a6a3e4b4e8f03a583194b2,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor changes. Purpose of this commit is I'm leaving for Europe and
wanted to sync up my laptop with my desktop.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2054 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-07-10T21:04:29Z,nawrockie
d857e7f123245e26469298101c7295d9f1225241,Eric Nawrocki,eric.nawrocki@gmail.com,"Implemented HMMER 3's technique for enforcing a minimum relative
entropy for a model. Infernal uses entropy, not relative entropy, and
the corresponding changes were made to the HMMER code. The mean target
entropy is still 1.46 bits, but for short models (less than ~100
consensus positions) the target entropy DECREASES from 1.46 bits,
which INCREASES the effective sequence number relative to using 1.46
bits.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2053 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-07-10T14:44:29Z,nawrockie
746655d93d4696ea3b2421e5efc282f9b1d20fa4,Eric Nawrocki,eric.nawrocki@gmail.com,"Configuration of local CP9 HMMs in Smith-Waterman mode now more
closely matches the CM local alignment.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2052 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-07-09T18:46:59Z,nawrockie
565de3784f55da32c8dbfcc73f1a25f9aab80187,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed the default probability of a local begin from 0.5 to 0.05, and
of a local end from 0.5 to 0.05. Added 'pbegin' and 'pend' floats,
which store the local begin/end probability to the CM_t data
structure.

Fixed memory leaks with cmalign --hbanded (and/or --sub) that
manifested themselves when mpi-cmalign tried to align 25K SSU
sequences (didn't have a problem with up to 10K). 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2051 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-07-09T15:58:13Z,nawrockie
5f7856e1482d4c6853fd63a557e287f98a726abb,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch with local CPs now use special CP9 EL states. cmsearch
--hmmcalcthr HMM filter calculation with --hmmlocal now correctly uses
local (not glocal) CP9s to determine filter thresholds. cmsearch
--hmmnoel reverts to old local CP9s, WITHOUT EL states, although
there's an issue with E-values for such searches, b/c they were
determined with EL states.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2049 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-06-29T15:50:22Z,nawrockie
a909f55795eb9d341196f3edbe85d2d33214b62c,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign --hmmonly now does Viterbi alignment with HMM local ends that
mimic CM EL states. EL CP9s not yet enabled for HMM searching.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2048 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-06-20T22:13:28Z,nawrockie
ce6b9458c82ec0a246e5961bfd5e4f9cf826df7c,Eric Nawrocki,eric.nawrocki@gmail.com,"--hmmFstep and --hmmSpad options added to cmsearch for use with
--hmmcalcthr. With --hmmFstep, F, the required fraction of true CM
hits found --by the HMM is increased towards 1.0 as long as the
target survival fraction is not exceeded. --hmmSpad controls where the
HMM filter cutoff is drawn in the case that F and the target
survival fraction S are both satisfied.




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2047 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-06-18T21:42:42Z,nawrockie
31345c5d4ddf6eef93cb12f583fa34ec89b8ebe4,Eric Nawrocki,eric.nawrocki@gmail.com,"Includes temporary experimental code for CP9 filter threshold
calculation. That code is incomplete, still under construction.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2046 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-06-15T13:07:54Z,nawrockie
fed6e1475d7dd8ebeedd1b33fea92cdf41963e60,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on --hmmcalcthr, new default behavior for that option
sets a min AND max E-value for accepting sampled seqs from CM to use
for HMM filter calculation. This technique works for serial, about to
implement for MPI.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2044 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-06-07T17:47:55Z,nawrockie
86789cce6c9757d73f18c6cd1a3cf0dad4d51633,Eric Nawrocki,eric.nawrocki@gmail.com,"For HMM filter threshold calculation: working on experimental
techniques, still in construction.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2043 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-06-06T12:46:20Z,nawrockie
7a30fbad720fc8326b6ff9350ae08d133cf630f9,Diana Kolbe,diana.kolbe@gmail.com,"More changes to remove ambiguities:
- no exit from joint B if a child emits no sequence
- no D->EL transitions



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2042 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-06-04T13:35:11Z,N/A
658b84eb3912382a11d24e785459ed011f6befc8,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with cmsearch --hmmcalcthr --hmmfast. Other cosmetic changes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2040 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-06-01T12:54:43Z,nawrockie
4918003cd6bd54e0cdeaa1b1343486d1a2750902,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign --hmmonly now returns an alignment (previously it just
returned a CP9 Viterbi score). cmemit implements a new experimental
option --hmmrealfast to assume the CM and it's implicit CP9 parse are
optimal when determining filter thresholds, but early results suggest
this is a very fast but very crappy technique.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2039 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-31T17:36:46Z,nawrockie
3362cb40684ac06dc2dc983296ab190292e269e5,Diana Kolbe,diana.kolbe@gmail.com,"Fixed one case that allowed exit from length = 0 alignment



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2038 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-31T14:02:49Z,N/A
99b724986d2d1faf4a335b3aa8e700cf97778a4e,Diana Kolbe,diana.kolbe@gmail.com,"More changes to remove ambiguous cases; at least one
additional case needs attention (noted in comments)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2037 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-30T17:14:34Z,N/A
715ab8d426fa4abc891fd5bb7b11b811b112da84,Eric Nawrocki,eric.nawrocki@gmail.com,"cmcalibrate.c reorg complete. There is now a single function to make
histograms in either MPI or serial mode: cm_fit_gumbel() in
cmcalibrate.c. There is now a single FindCP9FilterThreshold() function
in CP9_scan.c which works in MPI or serial mode. cmsearch uses new
FindCP9FilterThreshold() function as well as cmcalibrate.
About to test by calibrating all the RMARK CMs.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2036 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-30T01:30:22Z,nawrockie
39b0965f61a1ddd9eb26ff0c6d8c57cba412366f,Diana Kolbe,diana.kolbe@gmail.com,"Changed EL and length=0 handling for marginal modes to 
deal with ambiguities.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2035 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-29T18:16:10Z,N/A
7649d384c46f64fc057a92fc64bc2f0020f540e8,Sean Eddy,sean@eddylab.org,"Easel's API for esl_opt_GetArg changed, so now you get a command
line argument by number: esl_opt_GetArg(go, 1), for example.
Changed cmcalibrate.c accordingly.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2034 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-29T14:01:08Z,cryptogenomicon
a0f75184f39c888ec047c3c48af6b8215f5b1fca,Eric Nawrocki,eric.nawrocki@gmail.com,"In the middle of reorganizing cmcalibrate.c. First attempt was to
mimic Sean's hmmsim.c from HMMER3 development code, but proved
impractical - still found plenty to clean up though.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2033 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-25T22:11:10Z,nawrockie
1bf3071e0f9e7123286e76149d75a0931da63198,Eric Nawrocki,eric.nawrocki@gmail.com,"cmcalibrate --fastfil --gemit combo now works thanks to a
(utility-as-of-yet-unknown) hacky function
ParsetreeScore_Global2Local() that tries to 'guess' at a local optimal
parsetree score given a global parstree (it's really hacky).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2032 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-24T20:42:12Z,nawrockie
00447ecb17af835288355f031c342da234c7a307,Eric Nawrocki,eric.nawrocki@gmail.com,"Small bug fix in CP9_scan.c for mpi-cmcalibrate --fastfil.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2031 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-23T13:15:03Z,nawrockie
081d106b8bbda61907e37f245fb680a76309823d,Eric Nawrocki,eric.nawrocki@gmail.com,"emit.c's EmitParsetree() now uses ESL_RANDOMNESS instead of squid
randomness. The function prototype had to be changed.

HMM local configuration now more closely matches the CM, instead of
equiprobable start/end points, this should give better filtering
performance. 

cmemit can emulate the filter threshold calculation, though this is
probably not permanent, I did it to check my implementation in
CP9_scan.c. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2030 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-22T14:20:20Z,nawrockie
84bd1bbeb519415b8a2a9622eb1e55d5f9da48b2,Tom Jones,tajones42@gmail.com,"Created 00WISHLIST where improvements/tweaks can be logged [TAJ]

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2029 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-22T14:17:21Z,tajones42
79cfe63a07deba74c7107e87139e6c5c0790c66f,Eric Nawrocki,eric.nawrocki@gmail.com,"New cmemit functionality in process of being implemented for testing
HMM filter threshold calculation code and determining the impact of
the time-saving assumption that emitted parse tree scores are optimal
scores on the accuracy of the computed filter threshold.  Work in
progress, but good checkpoint.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2028 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-21T12:24:29Z,nawrockie
e020f1a0150f40dac62f7ff4d579d91b5a413748,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch now reports on predicted fraction of db to survive HMM filter
based on the HMM filter E value. If that prediction fraction is > 1
than HMM filtering is automatically turned off. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2026 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-18T19:51:12Z,nawrockie
99d312a816e2d992b3a0fc186086d81196014082,Eric Nawrocki,eric.nawrocki@gmail.com,"Reorg of some cmsearch.c code, and a couple bug fixes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2025 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-17T21:39:43Z,nawrockie
e6f27a846de38228e652d11e1719a1aa63b33ff9,Eric Nawrocki,eric.nawrocki@gmail.com,"cmcalibrate --gemit option added which affects filter threshold
calculation for the CM in local mode (CM_LC or CM_LI). With --gemit,
seqeunces are always emitted from the CM in global mode, and then
searched in local or glocal mode. This is a hack.

cmsearch --hmmcalcthr ---hmmgemit option does the same as --gemit for
cmcalibrate, but recalculates it based on CM cutoff for search.

cmsearch --hmmgemit and cmcalibrate --gemit are both currently
incompatible with --fastfil, but this may change.




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2024 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-17T13:10:34Z,nawrockie
18f1ca368b467eac9e46e6a2d426193678844ebf,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2023 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-05-16T19:24:15Z,nawrockie
bb411db13e3668b54822cdc650e730f0112e1afa,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --dbfile <s> to cmcalibrate, which uses the GC content distribution
in <s> instead of the default GC content distro. Also, replaced the
default GC distro with RMARK-1's which is closer to normal with a mean
of 0.5 than the previous default (which was Human chromosome 1).
Replaced default 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2022 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-16T13:56:39Z,nawrockie
2d8e960a60926b3509555a9c5284d675f518beb2,Eric Nawrocki,eric.nawrocki@gmail.com,"Worked out some bugs/kinks in mpi-cmsearch with new E-value and HMM
filtering options - testing large scale now to see if any obvious bugs
still exist.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2021 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-15T22:14:51Z,nawrockie
3278e10161fed9ffc82fd69af2a48ac858225f88,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch --hmmcalcthr now correctly recalcs HMM threshold based on db
size and CM cutoff for current search.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2020 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-15T12:09:04Z,nawrockie
d4b202340b891130eeac9222d5b9fcaf8dbae4e9,Eric Nawrocki,eric.nawrocki@gmail.com,"mpi-cmcalibrate is now working - nefarious memory bug has been fixed
(it was unexpectedly in Easel), --histfile, --qqfile options to print
histogram and Q-Q files enabled.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2019 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-14T22:21:39Z,nawrockie
81129552d0f41fbb9c07537e6d42e07ce304fe38,Eric Nawrocki,eric.nawrocki@gmail.com,"EVD K is no longer read/written from/to CM files - it can be calc'ed
from L, mu, lambda.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2018 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-11T13:35:52Z,nawrockie
0a2546ff0aee50679617470a134545221e5a5ccc,Eric Nawrocki,eric.nawrocki@gmail.com,"mpi-cmcalibrate appears to be working anecdotally. More rigorous
testing is about to happen.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2017 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-11T10:48:01Z,nawrockie
9ddc8d0429b8629cec1a879f269a10ddfc77992b,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch --hmmcalcthr recalculates the HMM filter threshold based on
the CM E-value cutoff for the current search. Seems to be working.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2016 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-09T17:08:23Z,nawrockie
be8b8106ca776f28f6a1c3083a2071f9c9fe4777,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on cmcalibrate.
Rewrote HMM filter threshold data structure so it calculates E-value
cutoffs instead of P-value cutoffs. By default, when empirically
determining HMM filter thresholds, CM scores must have an E-value of
10 or less per 1MB to be considered. This cutoff can be turned off (so
all CM scores are considered) with cmcalibrate --nocmeval.
--This line, and those below, will be ignored

M    src/stats.c
M    src/structs.h
M    src/cmsearch.c
M    src/modelconfig.c
M    src/cmcalibrate.c
M    src/bandcyk.c
M    src/cmemit.c
M    src/cmio.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2015 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-09T11:19:15Z,nawrockie
b31113d644c6fd3c72f12aeda339e8786a4c504e,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch now uses E-values stored in CM file by cmcalibrate. cmsearch
can no longer estimate EVDs by itself - this must be done by
cmcalibrate. Anecdotally, but not rigorously tested.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2014 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-08T13:26:05Z,nawrockie
a1359c973841a28e606a1ed79c9d5a1bee024c26,Eric Nawrocki,eric.nawrocki@gmail.com,"cmcalibrate works anecdotally with binary CMs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2013 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-07T19:46:04Z,nawrockie
6d7db589d823fbc1a4b1a1e198ec1fe525a88d1a,Eric Nawrocki,eric.nawrocki@gmail.com,"cmcalibrate now rewrites the CM file in a way that can be read
in, in ascii mode. Binary mode not yet implemented.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2012 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-07T18:51:19Z,nawrockie
01566029df085303d11f8e737090079c7136a403,Eric Nawrocki,eric.nawrocki@gmail.com,"cmcalibrate properly adds EVD and filter threshold params to a CM
file. These parameters are not read yet though.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2011 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-07T14:06:55Z,nawrockie
e2e599d8bed838c19871243a917378ac9356f26c,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2010 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-05-07T10:51:56Z,nawrockie
aab85e504311048326887fe4c0363f26785e9fe2,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2009 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-05-07T10:28:38Z,nawrockie
04b0924b68d962fb49dfd07a21335991f24db5f7,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on cmcalibrate.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2008 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-04T22:24:01Z,nawrockie
fa7a6f39acd0cce1d07ac632f42b648a2b4f8e78,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on getting minimal functionality in cmcalibrate.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2007 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-04T17:17:56Z,nawrockie
0f59155e330f419fc56a8387ecbd97788aa26103,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on cmcalibrate.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2006 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-03T22:47:55Z,nawrockie
ccbe42a86f2cb366ea9ffb29cc71710844032181,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on getting minimal functionality in cmcalibrate, good
commit point.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2002 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-03T09:59:45Z,nawrockie
dba3132c7c14fc076f20baab769fd3ca9c54cd2f,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cmcalibrate.c, Makefile.in now adds cmcalibrate as an
executable. cmcalibrate runs, but doesn't modify CM file at all.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2001 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-02T17:30:34Z,nawrockie
5b8eda4062ed21f869827f51b041f6b04cf0fb19,Eric Nawrocki,eric.nawrocki@gmail.com,"emit.c::EmitParsetree() can now emit parsetrees in local mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@2000 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-02T10:42:30Z,nawrockie
4a89f4a0b432af27e6f897532a84b3d5daf79de8,Eric Nawrocki,eric.nawrocki@gmail.com,"Experimenting with empirically derived  HMM filtering thresholds 
in cmemit. 
hbandcyk.c: small bug fix in Inside scanner.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1999 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-01T21:09:54Z,nawrockie
1b13af9cd15ff1dd842ec9b0aacad9003307f437,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild now reports on CM/CM plan 9 average match state entropy fraction.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1998 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-01T18:32:50Z,nawrockie
8de7a6640208cff032f2b9a0c7a6d7ccec087037,Sean Eddy,sean@eddylab.org,"Merged fixes from the 0.81 release back into the trunk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1997 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-05-01T14:58:59Z,cryptogenomicon
d6977fd02a5e90bd1fa44735f62d6e7fad7a0f8c,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on --hbanded options. Good point for commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1987 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-30T20:02:24Z,nawrockie
2eb54f1d169d36fc4d87efd2c718750c05dba8f5,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on --hmmgreedy options, about to overhaul how the CP9 scanning
functions keep track of hits.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1986 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-30T10:50:27Z,nawrockie
bde6a9c9669ef6a14e84f12ac93b1a16d8cdccdb,Sean Eddy,sean@eddylab.org,"Committed the new CHECKLIST as it stands after 0.8 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1985 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-29T16:03:30Z,cryptogenomicon
453f12542584b628e59a8fee9a7eb9ece516ecf6,Sean Eddy,sean@eddylab.org,"Remerge of 0.8 branch into the trunk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1981 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-29T15:59:49Z,cryptogenomicon
3955b1d0a1122cc37b655f97460e991fe4636f4a,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch --hbanded --inside, and cmsearch --hbanded --inside
--scan2bands combinations appear to work.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1978 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T20:11:26Z,nawrockie
1dced13eaf9232fc77d30a10e09b17f3bb7a0eeb,Eric Nawrocki,eric.nawrocki@gmail.com,"Last commit was a mistake - I somehow copied the wrong directory of
my temporary backup files over the src/ files. This one is correctl, 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1977 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T18:55:49Z,nawrockie
244bee051047967930c9159c345320b0e5fd52fb,Eric Nawrocki,eric.nawrocki@gmail.com,"This commit was postponed due to anticipation of the 0.8
release. Working on --inside in combination with --hbanded and
--scan2bands options to cmsearch.
For details see
~nawrockie/notebook/7_0410_inf_hmmfb_hbanded_scan/00LOG.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1976 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T18:32:33Z,nawrockie
fa47b3e64eb0375bba1141fe6f221d1026ff6d6e,Eric Nawrocki,eric.nawrocki@gmail.com,"This commit was postponed due to anticipation of the 0.8
release. Working on --hbanded and --scan2bands options to cmsearch.
For details see
~nawrockie/notebook/7_0410_inf_hmmfb_hbanded_scan/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1975 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T18:30:17Z,nawrockie
3db1bbd25fdd174f0130f27d5f3d3407b1945034,Eric Nawrocki,eric.nawrocki@gmail.com,"This commit was postponed due to anticipation of the 0.8
release. Still working on rewrite of CP9Forward and CP9Backward
scanners. For details see
~nawrockie/notebook/7_0410_inf_hmmfb_hbanded_scan/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1974 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T18:18:47Z,nawrockie
ebfc3d2bbd6aa2904f6c371cdd04a2304343ae2a,Eric Nawrocki,eric.nawrocki@gmail.com,"This commit was postponed due to anticipation of the 0.8
release. Working on rewrite of CP9Forward and CP9Backward
scanners. For details see
~nawrockie/notebook/7_0410_inf_hmmfb_hbanded_scan/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1973 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T18:17:19Z,nawrockie
3aebcb4dd6d1a83cf860a7307644e7b9435cd57a,Eric Nawrocki,eric.nawrocki@gmail.com,"This commit was postponed due to anticipation of the 0.8
release. Working on --hmmpad option.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1972 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T18:12:41Z,nawrockie
63a32e1c631a008cae1b9de3488cc6d547e2008d,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated changes that were made on 0.8 branch, for getting configure
--enable-mpi to correctly build MPI and serial programs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1971 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T18:05:38Z,nawrockie
1750e985613c2eabf0ba20d72b2275ef1cc5d66a,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed an incorrect statement about hmm filtering acceleration
increasing for larger databases - this is not really true now that
an E-value cutoff is used for the HMM filtering.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1965 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-27T09:37:45Z,nawrockie
fe0d9f48f5da2f36f001f9aec7971211d6d9fca0,Eric Nawrocki,eric.nawrocki@gmail.com,"Forgot to update the usage text that says default of 50 to 500 from
last commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1964 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-26T15:04:27Z,nawrockie
c06e52f646553bc04abc857e9f1d59cc7dc3a820,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed the default HMM E-value cutoff from 50 to 500 for cmsearch
--hmmfilter and cmsearch --hmmonly. 500 is a safer (better) default I
think.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1963 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-26T15:02:57Z,nawrockie
c4e93bdb50561044a9cb60595322ba92a1ee9562,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a bug in how Query start/end points are reported from
cmsearch. Updated user guide tutorial to reflect bug fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1962 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-26T13:35:13Z,nawrockie
6716e4c1b98833d3a746ee965b2c857a3ef5aa34,Eric Nawrocki,eric.nawrocki@gmail.com,"Committing Sean's aclocal.m4 with the ACX_MPI macro for autoconf
to detect MPI.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1961 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-25T21:33:29Z,nawrockie
f874a7adb06fe3a4f536216ba60ccf776afbe886,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed Makefile.in's and configure.ac so that now a 
""sh ./configure --enable-mpi; make clean; make;"" will install all
executables: cmalign, cmbuild, cmemit, cmscore, cmsearch, mpi-cmsearch
and mpi-cmalign. Changes were based on HMMER 3's code for
getting mpi-hmmsim to configure properly.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1960 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-25T21:32:41Z,nawrockie
9f0993049dd1dec9802f82860422f93751362c29,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed an off-by-one (imagine that).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1959 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-25T20:41:28Z,nawrockie
b88247ee3c98ea77af28cdbe045118f2662266d0,Diana Kolbe,diana.kolbe@gmail.com,"Minor API changes for compatibility - was broken in 0.72



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1958 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-25T20:00:05Z,N/A
49407c959c9fe47306d4d4dc4e3a2b25926be190,Diana Kolbe,diana.kolbe@gmail.com,"Added -I for easel libs in rigfilters (needs esl_dirichlet.h)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1957 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-25T19:45:44Z,N/A
0d0fa277eac8b43fea3b3b36f9a4befb1b612ab8,Eric Nawrocki,eric.nawrocki@gmail.com,"Added a new file tutorial.big.db to intro/ that's used to demonstrate
HMM filtered search.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1956 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-25T11:34:09Z,nawrockie
d67fafb12b35c56cbff1ec2eca3cac1ff454afb8,Eric Nawrocki,eric.nawrocki@gmail.com,"User Guide and man pages now updated to my (EPN) satisfaction for
release 0.8. Also small code changes that I deemed appropriate while
update User Guide were made.

The single trcyk.c change is to make the PrintFancyAli() call
consistent with the new prototype of that function and should not
affect functionality of trcyk at all.

This commit does not include most of the recent edits to the User
Guide (those were in previous commits the past several days).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1955 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-25T11:26:27Z,nawrockie
542b13f2474c1ba7c8d9368fc6b06053a7a5854a,Eric Nawrocki,eric.nawrocki@gmail.com,"Man page for cmalign now has all options described.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1954 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-23T22:45:04Z,nawrockie
cc7131d9163eddf846657f78b2d555d09083f446,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild man page now has all options described.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1953 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-23T18:29:13Z,nawrockie
a726c562ec2ca3943869c8284d3a9938aa5f563e,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor, mostly cosmetic changes to options, that were deemed necessary
or appropriate during updating of the User's Guide for the 0.8 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1952 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-23T18:28:24Z,nawrockie
a54d88a292e37552ff0d2c95e94020816795e394,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cmemit man page. Overhauled cmscore man page to reflect new
options. cmbuild man page in process of rewriting.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1951 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-23T13:11:29Z,nawrockie
c66e3d5e0c36a479af83f1789e3c90104448baa2,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on updating


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1950 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-20T16:22:11Z,nawrockie
24e712db64599e21cea0453e2b3e781c63dc9592,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor simple changes made that seemed obviously necessary during
updating of user guide.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1949 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-20T16:21:51Z,nawrockie
0bdfcc29e9232f666ebf82647757b634acff79de,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated install.tex - it's likely to be modified again, but it's a
rough draft worth committing for now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1948 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-19T21:49:33Z,nawrockie
0f9b1acf43147b54ed353ce20ea716b8ddab93be,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch output was not correctly displaying the target sequence index
for hits. It was screwed up b/c I yanked RSEARCH code for this, which
isn't the same as previous releases of Infernal b/c it has to deal
with MPI search, which chops up the database prior to searching. It
should be okay now.

trcyk.c: changed a single line to get PrintFancyAli() working with the
new function prototype (due to the reason stated above)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1947 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-19T21:48:47Z,nawrockie
21a2084c594f97b88e2994deb07d45368199c2e9,Diana Kolbe,diana.kolbe@gmail.com,"Changed handling of terminal (T) case in bifurcations
to eliminate 3rd known source of ambiguity.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1946 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-17T18:09:01Z,N/A
0f31ae66dca9ecfa16e5ab86b200daf076926f5d,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: force floating point division, instead
of integer division, when calculating begin score



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1945 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-16T19:29:52Z,N/A
39f897ef8f71eceb996368c6c05b60219c8c2374,Diana Kolbe,diana.kolbe@gmail.com,"Removing local changes to modelconfig.c that should not have been committed



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1944 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-16T18:20:29Z,N/A
416f8a0c21fae5569cf2d15a1c5bdad849b5cf74,Eric Nawrocki,eric.nawrocki@gmail.com,"-g -Wall throws 0 warnings for EPN code, except 2 static declarations
in cmsearch.c and cmalign.c of in_mpi, that I'd really rather not
change.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1943 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-13T21:46:19Z,nawrockie
9bb9992670e5142663db04421a995850ed45cc6d,Eric Nawrocki,eric.nawrocki@gmail.com,"CP9_scan.c:CP9BackwardScan(): bugs fixed initialization and
termination steps. Now it is completely analaogous to
CP9ForwardScan().

cmsearch.c: removed options --hmmpad, --hbanded, --tau, --scan2bands
and --sums b/c they're not ready to be released (they don't work).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1942 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-13T14:21:02Z,nawrockie
af6c603b5058c66c41b236ecfbe3d367338439fa,Diana Kolbe,diana.kolbe@gmail.com,"Replaced local begin scores in truncyk with
log 2/(L*(L+1)) where L is the sequence length
of the consensus path through the model...



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1941 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-12T18:20:36Z,N/A
4eba84334386203371c40d68a45eeb4e8fa0e561,Diana Kolbe,diana.kolbe@gmail.com,"New HMMER-like local model built on truncyk.  Eliminated (I think) ambiguities in
mode parse for any given sequence fragment from a given parse.  The hit may now
be a subset of the target sequence being searched.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1940 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-12T18:08:26Z,N/A
4464f6bcbb302e6d0ac491e98eea83fa0adf6968,Diana Kolbe,diana.kolbe@gmail.com,"switched from log() to sreLOG2()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1939 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-12T18:01:07Z,N/A
9b407333bc9c6b3fc43efcf5ea745268182648e2,Eric Nawrocki,eric.nawrocki@gmail.com,"Prior to this commit the cmsearch --hmmfb --hmmE option combo
incorrectly caused cmsearch to Die with an error message.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1938 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-12T16:47:09Z,nawrockie
fac382af95936757288baed848fb9e71198d7b07,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1937 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-04-12T16:31:39Z,nawrockie
6416f44318a64f1bb472f6d3e252b7b236c03b20,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed stray printf(), that uglied up mpicmalign output.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1936 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-12T16:24:27Z,nawrockie
5b47505e8b4dba9eb93f5879964e16b0345ec9e0,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with HMM E-values.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1935 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-12T16:16:06Z,nawrockie
5e958da0c5942d9c74e95637d5c959de3ac18171,Eric Nawrocki,eric.nawrocki@gmail.com,"o Updated configure for MPI. './configure --enable-mpi' now sets up
Makefile and src/Makefile to ONLY build mpicmsearch and mpicmalign. To
build all executables (serial and MPI), two configure-make cycles are
required: 

(1) ./configure; make clean; make; 
(2) ./configure --enable-mpi; make clean; make;

(in (2) the 'make clean' removes only mpicmalign and mpicmsearch
binaries from src/)

configure.ac: configure now takes --enable-mpi (not --with-mpi) as an
	      option, and sets PROGS macro and new PROGNAMES macro for
	      Makefile.in and src/Makefile.in. Prior to this, PROGS
	      was set inside the Makefiles, but now it's conditional
	      on whether --enable-mpi is used with configure.
	      Also, USE_MPI is defined by configure within config.h
	      if --enable-mpi.

o Added #include ""config.h"" to a bunch of files so they pick up the
USE_MPI definition in config.h. 

o updated install.tex in /documentation/userguide/ to include blurb on
MPI configuration and running (very brief though).

o removed rsearch_buildcm.c - it's no longer used.

o Fixed some bugs with newly organized HMM filtering code. About to
get rid of cmsearch --hmmweinberg option and cmsearch --hbanded
option. --hmmweinberg will be gone for good (as --hmmfb is 2X faster
and 99% as sensitive). --hbanded will come back - but it's not
ready for the impending release.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1934 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-12T15:00:23Z,nawrockie
d8869f2e25c173b1ec747aeed7bec42bc9f201c9,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild --rsearch now requires a <f> argument, the matrix file to
use. This eliminates need for DMATRIX_DIR definition.

Also DUSE_MPI now handled by config.h. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1933 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-11T19:36:12Z,nawrockie
0bdd889196a118af676cd979e1b1f68f51d81cbc,Eric Nawrocki,eric.nawrocki@gmail.com,"CP9_scan.c reorganized to allow --hmmfb to work analagously
to --hmmweinberg. New function RescanFilterSurvivors() now allows more
flexibility in HMM filtering.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1932 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-11T15:50:29Z,nawrockie
e6616b67e11e4f3692bfa6525127d2b42c1557d2,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --gcfile option to cmsearch to dump info on the GC content on
the target database.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1931 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-10T10:10:52Z,nawrockie
424cdc23dd27dd43c76365c0a69c2176176a39d9,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1930 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-04-09T10:36:40Z,nawrockie
01c1fffeb36810b45a72dd8ea524c11273e92efd,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1929 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-04-09T10:36:09Z,nawrockie
e3676b19c41874c8a24e3fbda12e6782684f16c9,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with naming CMs, I introduced with the --c* options.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1928 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-06T13:33:45Z,nawrockie
866b523e7435a734a6508c643a3d5c15e6dc2531,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug, now --with-mpi flag to configure seems to work fine.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1927 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-05T13:44:38Z,nawrockie
541cdfdedb2b7b7e8678a976bc8fd73b5fa28d8f,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated directions for building MPI executables.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1926 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-05T12:59:48Z,nawrockie
efd5750d23142e288c0d120a08d6d67c38d19a81,Eric Nawrocki,eric.nawrocki@gmail.com,"o src/Makefile.in & configure.ac: modified to correctly handle the
  --with-mpi option to configure.

o scripts/cmsearch_pp.pl: revamped to potentially parse cmsearch output with
  hits from multiple CMs against same target db. Options to remove overlaps.

o matrices/*: all .mat files were rewritten to include the background
  (g) distribution. see ~nawrockie/notebook/7_0201_inf_rsearch/00LOG
  for details.

o benchmarks/cmsearch-rmark/infernal2glbf.pl: can handle cmsearch
  output that includes hits from multiple CMs against same target.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1925 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-05T12:45:36Z,nawrockie
9eb81a2ab594f638920ddcb5ce66da1078576198,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --greedy option to cmsearch, that uses RSEARCH's greedy hit
resolution algorithm instead of the default semi-HMM optimal
method. Only implemented for non-inside scans so far.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1924 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-03T19:23:56Z,nawrockie
eb13907f0321c1ece7d4141c81951ad49264ee7d,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_cluster.c changes: fixed a bug with --call to cmsearch.
cmbuild.c changes: added --rsw option to set W as 2 * seq len if input
	           MSA has a single seq. A la RSEARCH.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1923 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-04-03T17:59:34Z,nawrockie
9c787cb9ea539b623a973104c4b496767b0306fd,Eric Nawrocki,eric.nawrocki@gmail.com,"Renamed cm_single.c to cm_cluster.c, which is more
appropriate, because it supports cmbuild options for clustering the
input MSA and making separate CMs for each cluster:

 * options for building multiple CMs after clustering input MSA:
   --ctarget <n>  : build (at most) <n> CMs by partitioning MSA into <n> clusters
   --cmindiff <x> : min difference b/t 2 clusters is <x>, each cluster -> CM
   --cpickone     : w/--c{target,mindiff}, build CMs from 1 seq in each clust
   --call         : build a separate CM from every seq in MSA
   --cdump <f>    : dump an MSA for each cluster (CM) to file <f>
   --corig        : build an additional CM from the original MSA

This is done by single-linkage clustering the input MSA, and then
defining clusters. The --cpickone option is not yet implemented.

Also the ability for cmsearch to take CM files with > 1 CM, and
serially search the database with each CM now works in MPI mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1922 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-28T19:50:22Z,nawrockie
be77a9402372bb9b8c570085f6a2746d99d9c78a,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_single.c should have been included in last svn commit. It will
contain support for single sequence CMs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1919 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-23T10:11:17Z,nawrockie
cf94107d8fada7cdc5febe25b653430649469d20,Eric Nawrocki,eric.nawrocki@gmail.com,"Finally merged branch:
https://svn.janelia.org/eddylab/eddys/src/infernal/branches/0.7stable/
back to main trunk, manually fixing conflicts where they arose. There
were 0 changes to src/ because I was modifying the trunk and this
0.7stable branch in parallel while I was fixing 0.71 to 0.72. 

See ~nawrockie/notebook/6_1215_inf_72_release/00LOG for details on
creating 0.72 from 0.71. For details on this merge procedure see the
entry at the end of the 00LOG for 03/22/07.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1918 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-22T21:36:11Z,nawrockie
0d09e7fdf2b2e20450d197de5894b55cff2d0dad,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch_pp.pl revamped to deal with new cmsearch output that may have
hits from multiple CMs in it. It uses the new version of infernal.pm
to parse cmsearch output and can optionally remove overlapping hits to
a specified fraction overlap.

Also, the way I was extracting subseqs from the database has changed
from my convoluted perl subroutine to calling Sean's stable sfetch. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1917 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-22T20:12:15Z,nawrockie
c2dabbcdad39ed0e1bdf3ac49f2dae04ea2d561f,Eric Nawrocki,eric.nawrocki@gmail.com,"infernal.pm now reads the new cmsearch output which potentially has
hits from multiple CMs in it, so the CM names that correspond to each
set of hits is now read and parsed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1916 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-22T20:10:22Z,nawrockie
8d5b66d6d4fe7139721de1ecfbf5e8050a90bb21,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch has new behavior: in NON-MPI mode it can read a CM file with
multiple CMs in it, and serially search the target seq with each
CM. Overlapping hits are NOT removed but may be in future
versions. The cmsearch output now names the CMs before printing the
hits to that CM. 

cmbuild now has a new option --sall (--srep is newly listed but not
functional yet). --sall will build a separate single sequence CM from
each sequence in the MSA and store them all in the output CM file. The
naming convention is <ali name>.<n> where <n> is 1..nseq, for the
nseqs in the MSA.

cm_single.c was added to hold functions related to building single
sequence CMs. 

The next commit will update infernal.pm in
~/infernal/benchmarks/cmsearch_rmark/ so it can parse the new cmsearch
output.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1915 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-22T20:08:08Z,nawrockie
2ba7b10b032fbd5ac574c6ec526cf47167b75a0e,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --rtrans option to cmsearch which overwrites transitions read
from the CM file with RSEARCH transitions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1914 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-21T13:39:53Z,nawrockie
78e8805707d2a15e9a1ff33c0ef4275c416ab1d7,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a small bug.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1913 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-16T12:48:01Z,nawrockie
3d9dd4510eef64578e06fb89d8247d0d3bf9c224,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed several bugs with cmbuild --rsearch. Added
rnamat.c:ribosum_MSA_resolve_degeneracies(), which replaces,
potentially base-paired, IUPAC ambiguity codes in the MSA with the
most likely (based on marginalized target freqs from RIBOSUM)
consistent bp or singlet residue. This is done prior to digitization
of the MSA, and is nec b/c RIBOSUM parameterization expects a single
count for a single singlet of bp for each consensus state. This
function is ugly and convoluted, but I couldn't think of a simpler way
to do it (though surely some exist).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1912 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-16T11:47:52Z,nawrockie
ffb73b97789a006603de4eb20fadecd940f793eb,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild --rsearch is now minimally functional. cmsearch -R (for running
RSEARCH searches) is known to be buggy, but I'm not worried about it
b/c it will soon be deprecated, hopefully.

cmbuild --rsearch reads the default RIBOSUM matrix (RIBOSUM85-60) in a
different format than the RSEARCH format in that the background (g)
probs are included in that file. The target freqs are back calculated
to get emission probs for the single sequence CM, and these are
logoddsified using the g vector from the RIBOSUM as the null
model. This procedure does not give log odds scores that are identical
to the RIBOSUM matrix, but that's okay. RIBOSUM/RSEARCH are emitted
two sequences, thus have joint emission probs emitting the query and
target at once, while Infernal has conditional emission probs emitting
the target dependent on the query. 

About to benchmark.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1911 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-14T21:56:31Z,nawrockie
210c947fe71f58a7d3a994ee0d328ed71f990d83,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign now takes --rf or --gapthresh but only when --withali is
enabled. If trying to include an alignment with --withali <f>, the CM
must have been built from <f> and if --rf or --gapthresh was used to
cmbuild, the same exact options must be used with cmalign.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1907 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-06T22:29:10Z,nawrockie
c195ffb497853bb60790740fb10aa1515736a5a5,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign --withali <f> cleaned up a bit. Still not easelfied, but now it
puts the seqs in <f> at the top of the output alignment, not the
bottom, it also works now with the --post option (though posteriors
are only printed for newly aligned seqs, not those in <f>).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1906 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-06T20:35:08Z,nawrockie
2a87430a937e91a3207325f7333652a3018718dc,Eric Nawrocki,eric.nawrocki@gmail.com,"Added crude but working version of the --withali option to
cmalign, which allows you to specify a fixed alignment you want as
part of the output alignment. Some obvious future improvements: 
easelification, put new seqs at beneath fixed alignment in output
(currently put above), clean code, inserts are moved around (though
I'm not sure if this worth fixing b/c it's due to
Parsetrees2Alignment()).




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1905 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-06T18:40:13Z,nawrockie
c219a21817171d520a5f8f70799e9878f7784419,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor changes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1904 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-03-05T18:31:03Z,nawrockie
8d3202863924926ee31be3d6bd2934b05cd257da,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed serious bug with E-values for searches in databases with poly-N
tracts (for example RepeatMasked genomes), ported RSEARCH code was
incorrectly calc'ing GC content of polyN tracts as 100% AU (due to bug
that was fixed), which skewed the empirical GC content distros, which
caused the random seqs used to build histograms for EVD stats to
commonly be 100% AU, this was seriously messing up EVD stats.

Additionally, I changed the code so that these 100% N DB chunks are
not counted when compiling the empirical distribution of GC content in
the database (prior to this (as in RSEARCH), Ns were replaced by a
random choice of A,C,G,U, so poly-Ns would count as a 50% GC segment
on average).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1898 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-16T14:13:19Z,nawrockie
a80418243296a60bb7bd9f9efa94d5b3daa3c6e7,Eric Nawrocki,eric.nawrocki@gmail.com,"Added new cmsearch behavior for E-values (-E) with the enforce option
(--enfseq <s> --enfstart <x>):

o modelconfig.c::ConfigCMEnforce() enforces <s> (this used to occur in
  modelconfig.c::ConfigCM())
o E-values are calculated prior to reparameterizing the model to
  enforce <s>
o search is done with the enforced CM (this hasn't changed)
o cm->enf_scdiff is calc'ed as the *approximate* score difference b/t
  a subparse of <s> through the enforced states of the model before/after
  <s> is enforced by ConfigCMEnforce()
o for each hit, E-values are determined after subtracting
  cm->enf_scdiff bits from the bit score found using the enforced CM.

To achieve this behavior I had to add a new function
modelconfig::ConfigGlobal(), which takes a CM in local mode and
reverts to global (details on motivation in code). This required I add
cm->root_trans a vector of floats that are the transitions for the
ROOT_S state (cm->t[0]). These are saved in
modelconfig.c::ConfigLocal() which zeroes them, and then reset in 
modelconfig.c::ConfigGlobal().


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1897 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-15T15:03:21Z,nawrockie
4ff34011972e0bb3d6fbd7624bd31cdf089a3bd7,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1896 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-02-14T17:55:23Z,nawrockie
a3e2b77766b2dd3922f4c326c509697ca4e95527,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a small bug with CP9 filtered scans. The --enf* default
functionality described in revision 1892 was still buggy. This commit
fixes at least 1 of those bugs. Testing the enf* default behavior that
convinces me it works now is in
~nawrockie/notebook/6_1227_inf_terc_enforce/.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1895 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-12T21:10:07Z,nawrockie
21e8c34eb7cc6f18df9ba5cf8a7ad4a21ea3860b,Eric Nawrocki,eric.nawrocki@gmail.com,"Functionality reported in revision 1892 was buggy. At least some of
those bugs have been fixed with this revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1894 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-11T19:43:38Z,nawrockie
9be39e43f27c9c2546818c546951950093965c78,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor bug fixes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1893 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-09T18:09:02Z,nawrockie
d00823f39986eb2f9d6c52ec24627eb3b7b410c8,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on --enf* options. Default --enfstart <x> --enfseq <s> 
behavior: 

o build a CP9 HMM from the CM after enforcing <s> starting at consenus
  column <x> 
o zero all CP9 emissions except for the match states in nodes
  modelling <s> 
o turn on --hmmweinberg filtering 

Idea is that now the special CP9 will allow only bits of the database
with <s> to survive the filter and be searched with the CM, and all
such bits should survive.

Also:
o --local (still not EL consisent) version of the enforced CP9 is
  implemented (although probably not really necessary)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1892 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-09T16:34:25Z,nawrockie
5db784a32db860c7010380967303c6c668d15f26,Eric Nawrocki,eric.nawrocki@gmail.com,"o Fixed a serious bug with --enf* options and MPI.  
o --enf* options now work with --hmm* options
o Renamed hbandp (tail loss prob for HMM banding) to tau


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1890 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-08T23:17:29Z,nawrockie
84d452971053bb87e0d5464e429d6e171735b783,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix for changing modes in truncyk; also changed 
priority of different traceback options in case of tie



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1889 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-08T16:18:21Z,N/A
a5a7e08b68ecbfb4b11e7c1c634712623f8dd4ab,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --matrix option to cmsearch (only works with -R) to allow
use of different RIBOSUM matrices.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1888 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-08T14:00:02Z,nawrockie
e05a1da36692081108fcc5d08aed39054fe0c600,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign --enfstart <n> now takes consensus column instead of CM node
index. Also <s> for cmsearch --enfseq and cmalign --enfseq can take
IUPAC ambiguity codes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1887 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-07T22:24:13Z,nawrockie
b682a986b39275b1844eab8c42043fb4e0e2fcf3,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch --enfstart <n> now expects <n> as a consensus column rather
than a node index (as it was before). This is more user-friendly and
goes along with the infernal/scripts/stk2rf_cc_stk.pl script added
recently (which annotates a stk file with consensus column indices).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1886 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-07T20:34:06Z,nawrockie
f08b3d8b0fdfdff968530908d197cb13dd324615,Eric Nawrocki,eric.nawrocki@gmail.com,"Added infernal/scripts/ directory, with two scripts: 

cmsearch_pp.pl:   post-processes cmsearch output, including the ability
		  to extract hit subsequences from the target database.
stk2rf_cc_stk.pl: annotates a stockholm alignment with consensus
		  columns as ""#=GC COL"" markup.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1885 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-07T19:28:21Z,nawrockie
b94611e8a0e345caf8784c53f7afb9bc955dde91,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed small bug with MPI cmsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1884 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-06T23:32:24Z,nawrockie
853529c40a99081307a8d29ff54d53f449139e13,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed some bugs and cleaned up code involved with mpi cmsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1883 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-06T22:07:55Z,nawrockie
9bb202e9583024cab49d8cd35d4ef6e0b6a06298,Eric Nawrocki,eric.nawrocki@gmail.com,"Only change: renamed cm_wrappers.* to cm_dispatch.* after Sean's
suggestion based on Jeremy Buhler's naming conventions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1882 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-06T21:04:32Z,nawrockie
6827f781df3b9a576c4050baab63a50f40cb7ad0,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch --rsearch is now functional and *nearly* reproduces RSEARCH
output. The reason it doesn't is because the CYKScan() functions from
infernal and RSEARCH are different in the way they recover hits,
infernal uses a semi-HMM to get a maximum scoring parse of start/end
points, RSEARCH uses a greedy approach. I think this is the source of
all discrepancies between 'cmsearch --rsearch' results and 'rsearch'
output. Also this difference noticeably affects the EVD stats.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1881 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-06T20:56:31Z,nawrockie
55baaea359a38a8c5daeca345be8994512e75832,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1880 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-02-06T18:12:00Z,nawrockie
30acaf3a9a5b26e88ec540a66c1460a471df0123,Eric Nawrocki,eric.nawrocki@gmail.com,"Still trying to get cmbuild --rsearch to compile with knowledge of
where the RSEARCH matrices are.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1879 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-05T12:05:38Z,nawrockie
c903a39407227c5a532623861431bba238f1b826,Eric Nawrocki,eric.nawrocki@gmail.com,"Added RSEARCH's matrices - all of them.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1878 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-05T12:02:09Z,nawrockie
dd402e6858ce336dfce702f4fcb580770c10a86d,Eric Nawrocki,eric.nawrocki@gmail.com,"Added info on matrix directory to Makefile.in.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1877 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-05T12:00:01Z,nawrockie
673b998f4c8c0203000a5dcf9b4dfb4efb9becbb,Eric Nawrocki,eric.nawrocki@gmail.com,"Added files necessary for cmbuild --rsearch option. These may
eventually be deleted, with the relevant bits swallowed up into other
.c files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1876 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-05T11:54:51Z,nawrockie
bd3077659397cca5a7f361b2a6eb41774227e127,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on cmbuild --rsearch option. Not yet functional.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1875 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-02-05T11:39:00Z,nawrockie
704ca763983b3a107f6e9eafeb298018412f2dbd,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with --hmmweinberg, retesting now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1872 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-29T23:37:05Z,nawrockie
6f41de52b3e92355e2f6e930dfec0231583d46e7,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor: removed some debugging printf()'s from HMM filtering code.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1871 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-29T20:19:52Z,nawrockie
c8cb4d47ae42430bef4308d46f8e7a5e2f218247,Eric Nawrocki,eric.nawrocki@gmail.com,"Ughh, another bug in partial-test fixed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1869 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-28T17:52:09Z,nawrockie
4ac37a361e4702ac0ec4d1b9ef185ade662d3f21,Eric Nawrocki,eric.nawrocki@gmail.com,"partial-test did not have --local on by default, it does now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1868 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-28T17:18:46Z,nawrockie
4f02bb5ff11a54377f6cd95699bea527bb0277b4,Eric Nawrocki,eric.nawrocki@gmail.com,"Small fix. 

Last log entry (1865) had a typo, it should have had the cmscore call
as :

""cmscore --hbandps 3 --hbandpe 6 trna.cm test.fa"" 

not

""cmscore --hbandps 3 --hbandp  6 trna.cm test.fa"" 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1867 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-27T21:15:22Z,nawrockie
b63a17414ed41ceee94a2c550f82907cae2a4672,Eric Nawrocki,eric.nawrocki@gmail.com,"Added new functionality to cmscore. A single cmscore run can now
compare D&C alignment to QDB or HMM banded alignment for multiple beta
(with --betas --betae options) or hbandp (with --hbandps --hbandpe
options). 

cmscore --hbandps 3 --hbandp 6 trna.cm test.fa 

Will align test.fa 5 times: 
1. D&C 
2. HMM banded cyk with hbandp = 1E-3
3. HMM banded cyk with hbandp = 1E-4
4. HMM banded cyk with hbandp = 1E-5
5. HMM banded cyk with hbandp = 1E-6

And compare the scores and optionally parse trees of D&C with stages
2-5 printing summary stats for all stage comparisons.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1866 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-27T21:04:21Z,nawrockie
a89ea00c0b4c84f03ee0a45359838969bfc525f1,Eric Nawrocki,eric.nawrocki@gmail.com,"sub_cm's were not getting the hbandp and beta's copied from the
original cm when they were built.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1864 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-27T16:10:43Z,nawrockie
5bd6055425b5a53e939e74ebe2e2fb1e100b433d,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed some recently introduced bugs/typos.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1863 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-27T16:05:45Z,nawrockie
6405cb04be10f03195d3aef1a612fe40edc0ded1,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes dealing with special case of length 0
sequences in marginal mode (traceback and also
display routines.)
Bugfix: include headers for easel, esl_vectorops



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1850 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-24T16:38:58Z,N/A
0b5e2d38bf561be2df3a4f2de5a1750c2c0211ba,Eric Nawrocki,eric.nawrocki@gmail.com,"cmscore --hmmonly now functional, but only good for
timings. Eventually, I'll probably want to make two functions: one
takes a CP9 Viterbi matrix and traces back to get a CP9 parse, the
other takes a CP9 parse and converts it to a CM parsetree. This will
be really only useful for comparing accuracy of HMM vs. CM alignments.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1846 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-23T13:53:05Z,nawrockie
56c314cb12a09a22ced6d8baacdb1114548919ad,Eric Nawrocki,eric.nawrocki@gmail.com,"Added single line to cmscore default output.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1845 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-22T12:28:55Z,nawrockie
041c27380d172378815d804be2f847d611d7ee17,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed memory leak with partial-test --distro.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1843 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-21T17:55:50Z,nawrockie
ea4533256c4e824ccfa2d11f09dd3deff9696f5f,Diana Kolbe,diana.kolbe@gmail.com,"Score output in trcyk



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1842 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-20T17:49:51Z,N/A
95d4be5dca508ee48d8d7eb5c9aed0c40d19c1a6,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix in truncyk.c; added external call for
TrCYKInside() to funcs.h



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1841 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-20T17:15:47Z,N/A
e04f2ab16d438c9b812ef8f2c6ba9f500dd0472d,Diana Kolbe,diana.kolbe@gmail.com,"Fixed expected argument for --trees option
(from float to none)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1839 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-20T16:23:15Z,N/A
8a03870547b184c36c7f5428946c3bc31951cea1,Diana Kolbe,diana.kolbe@gmail.com,"Bugfix: corrected error checking on esl_stack_IPop();
now traceback will actually pull right child off
the stack rather than failing prematurely.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1838 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-20T15:42:45Z,N/A
196ec34a5fbc9dd9d6cf5879c34af56963e4e667,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --distro option to partial-test.c, reads in a file, predicts
start/ends to get empirical distributions. Then picks truncation
points for seqs to align based on those distributions.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1833 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-19T23:38:42Z,nawrockie
4b15473bb4e4265253cb7fa986d7d31098becb72,Diana Kolbe,diana.kolbe@gmail.com,"Bugfixes, plus a stub executable for aligning
truncated sequences to a model (individually).
There's definitely still a problem with FancyAli,
and there may be additional behavior issues
within the DP and traceback.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1832 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-19T22:46:36Z,N/A
54ab05481ecbcab3df2547537bfcff024e22453d,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --hsafe option to cmalign and cmscore to be used only in
combination with --hbanded. If enabled, sequences with a banded HMM
CYK parse of < 0 bits are realigned with non-banded D&C. Info is
printed to stdout when this happens, as well as info on whether or not
the banded HMM parse ends up being the optimal parse. This takes place
within cm_wrappers:actually_align_targets().


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1831 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-18T23:11:59Z,nawrockie
ccf9083ba156a7048d6bb8cff1f42fcf12b25e43,Diana Kolbe,diana.kolbe@gmail.com,"- Fixed syntax errors in previous commit of parsetree.c
- CreateFancyAli is mode aware.  Currently using '~' for
  residues which have been treated as missing data.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1830 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-18T19:43:26Z,N/A
d41b5100b8e932470e911fa0f430c1a3f4e1675d,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --sub option to cmscore.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1829 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-18T14:37:27Z,nawrockie
cad68adf10208cbe5dc15fd5d628a73b43865dfa,Eric Nawrocki,eric.nawrocki@gmail.com,"Cosmetic changes to cmscore. Found and fixed memory leak in cm_wrappers.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1828 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-18T12:25:58Z,nawrockie
d54fd2cc552097cfac7aaca72314ad66781da942,Diana Kolbe,diana.kolbe@gmail.com,"Converted ParsetreeScore() to be mode-aware



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1827 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-17T20:20:52Z,N/A
79b93f9421496139ecfe9f725d193766f334d178,Diana Kolbe,diana.kolbe@gmail.com,"Converted ParsetreeDump() and ParsetreeCompare()
to be mode aware.  Note that ParsetreeDump()
does not explicitly print mode information, but 
it can be inferred (or added later if helpful).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1826 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-17T20:06:05Z,N/A
16cccdfcd4e6f467c40e1b80b0ccaab87c12b9b3,Diana Kolbe,diana.kolbe@gmail.com,"- Added Left/Right MarginalScore functions to alphabet.c  
- started adaptation of parsetree to be mode aware.
  Currently the create/grow/free functions and 
  InsertTraceNode handle mode information.  This should
  be sufficient to begin testing on truncyk; however, 
  many additional functions will need to be modified in 
  the future (particularly those for converting to an
  alignment)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1825 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-17T19:16:30Z,N/A
04fba3a8bd56fd4984e683e912d864f11b4e1d21,Eric Nawrocki,eric.nawrocki@gmail.com,"Overhaul of cmscore. Original functionality of testing D&C versus
standard alignment still exists as default, but new options allow
comparison of different alignment algorithms, namely HMM banded
alignment versus non-banded alignment, and QDB versus
non-banded. 

Output has been changed also (potentially problematic for regressions).
Timings, speed-ups and accuracy (relevant for banded vs. non-banded)
are printed out. Still some kinks to work out but I want to test it,
so I'm commiting.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1824 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-17T15:19:39Z,nawrockie
72288b6065e29b7a7d3174d99c1677d2df9ff1e4,Diana Kolbe,diana.kolbe@gmail.com,"Adding in preliminary implementation for CYK on 
truncated sequences.  External API should use
TrCYKInside()

Currently untested; needs modified API for 
Parsetree and output; also a driver to produce
an executable.  Also awaiting import of a few
functions from the dlk-r-what branch (which I
don't expect will merge into the trunk soon).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1823 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-16T20:57:34Z,N/A
4abf434704d1d985febc72b256c189924f0eaabc,Eric Nawrocki,eric.nawrocki@gmail.com,"Nothing major.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1820 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-16T10:59:03Z,nawrockie
d7b0fd92d4a1bbfd0276f1a0c45adf8dd2baa60a,Eric Nawrocki,eric.nawrocki@gmail.com,"partial-test was brought up to date.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1819 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-15T17:10:16Z,nawrockie
41ab5effaf0053043aa5b90cce4c7924e7da49e4,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug i11 involving detaching inserts in zero consensus length
hairpins. 

I was a little dissappointed to discover that a CP9 cannot be
built that exactly mirrors a CM for these cases (although a CP9 gets
really close to the CM). cp9-test in the testsuite is the only current
executable that actually checks CP9s, and it prints a warning in such
a case. 

The bandcyk_*_test changes are b/c I had previously changed a function
prototype used in those programs. cmsearch.c change is cosmetic, and
the rmark_MPI_cmsearch.pl change is a small fix irrelevant to bug i11.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1817 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-10T23:17:47Z,nawrockie
044050efb1cfee21c3219739c8370c5e1dcbb56d,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on CP9 filtered scans. Appears to minimally work in MPI
mode for --hmmweinberg now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1814 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-10T14:22:48Z,nawrockie
415fbd3b6ba54e1a1c9f391d3885dcf32620c5f4,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on CP9 filtered scans. --hmmweinberg minimally functional.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1813 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-10T11:29:43Z,nawrockie
68d01134765936a3b089c7567c02bc0482cf4868,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on CP9-filtered scans, not functional yet.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1812 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-09T17:53:31Z,nawrockie
a9f108f41392112b25f123ede59bc91e7cbd0f09,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch --hmmonly works again, and is now memory efficient. So large
chromosomes should be scannable. The tradeoff is that the whole matrix
cannot be kept, and to infer HMM bands for a hit, it will have to be
rescanned in matrix-saving mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1811 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-08T22:46:40Z,nawrockie
b2f1d0ec5e99e9605a891644412ae7eca855ce0f,Eric Nawrocki,eric.nawrocki@gmail.com,"Reorganized cmsearch by introducing a new function:
cm_wrappers.c::actually_search_target() which is called from
{serial,parallel}_search_database() and
{serial,parallel}_make_histogram(). About to attempt to add the
ability to scan/filter with CP9 HMMs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1810 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-08T18:21:18Z,nawrockie
9606c2865938288d1388c1eef10a60d637a8085e,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1807 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2007-01-06T16:10:39Z,nawrockie
de8cea88f83255dd8098809d2d9c0f34b68510d7,Eric Nawrocki,eric.nawrocki@gmail.com,"Mostly cosmetic changes. Fixed bug with cmsearch --inside --noqdb, was
adding float log odds in some cases instead of int log odds. About to
do rmark MPI benchmark.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1806 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-06T16:02:45Z,nawrockie
9aa598bc2c0215270bed2589d124262468e02fb0,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on cleaning up cmsearch with new organization and
ConfigCM() call.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1804 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-05T22:09:13Z,nawrockie
0a9300e42cb311c56ff6b8c9fc84da3f2e153f16,Eric Nawrocki,eric.nawrocki@gmail.com,"Making the ConfigCM() function useful for cmsearch, to ease MPI
implementation. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1803 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-05T19:00:50Z,nawrockie
74daf38790cbf4fb89c8a24fc699ed3b6874e25e,Eric Nawrocki,eric.nawrocki@gmail.com,"Moved declaration of Ideckpool_s from cm_postprob.h to a typedef'd
structure in structs.h.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1801 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-05T11:29:45Z,nawrockie
e714426c732e4c122468e4627a0b132753d8ddaa,Eric Nawrocki,eric.nawrocki@gmail.com,"Major revision. Added MPI ability to cmalign. Organization of cmalign
was overhauled to achieve this. Also the cm data structure was
modified to include a cm->align_flags integer which stores alignment
related options, and cm->dmin, cm->cdmax, cm->cp9 and cm->cp9map
objects were added to the CM data structure. A new function ConfigCM()
was added in modelconfig.c that takes a CM and based on it's
cm->align_flags options configures it for alignment. These changes
were motivated but not entirely necessary for MPI cmalign, but I think
they clean up the code a bit - for example, we don't have to pass
do_post, do_inside, do_hbanded, do_qdb... to the alignment functions,
it's all in cm->align_flags.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1800 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2007-01-05T10:57:55Z,nawrockie
fed4a7da120ae9ab37cffd83b899110681949df8,Eric Nawrocki,eric.nawrocki@gmail.com,"cm_postrob.c has a slew of new functions that use scaled integer log
odds scores instead of float log odds scores. cmalign with --inside,
--outside or --post should be about 10X faster now. Alternatively, I
could, and eventually should, have 1 function for Inside (instead of
the 2 that now exist: FInside() and IInside() that uses either floats
or ints depending on a input variable, or maybe we can get rid of
float log odds scores altogether.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1793 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-29T16:35:56Z,nawrockie
89d2c7248576e4cb4a16464fa88f728136bcc45f,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch --enfstart <n> --enfseq <s> -E <n> now embeds the subsequence
being enforced into every sampled sequence used to make the EVD. Not
sure how useful this will be.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1792 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-28T23:11:45Z,nawrockie
2dcfdc3d3cd6a735034048e3bb71722ea241f7a1,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on making cmsearch --enfstart <n> --enfseq <s> -E <n> embed
the enforced subsequence into each sampled seq used to determine an
EVD. This is wrong, but may be helpful.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1791 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-28T21:33:31Z,nawrockie
682d52d10dd0273a0a0ef6c4f8aa448abaf7f572,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1790 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-12-28T16:03:33Z,nawrockie
4930c2b121c04796d538f4046dc61030b11caad4,Eric Nawrocki,eric.nawrocki@gmail.com,"Cleaned up bug with cmsearch --inside --enfstart <n> --enfseq <s>.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1789 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-28T15:03:15Z,nawrockie
a721db033922707b94a538640cb2592af18e87a4,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1788 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-12-28T01:06:40Z,nawrockie
c12b57a4174b3bfc79936d638b3d6bdf2cb06235,Eric Nawrocki,eric.nawrocki@gmail.com,"Actually fixed the bug I said I had last revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1787 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-28T00:37:29Z,nawrockie
44f0ad536cf4c980c5f45d798ab0a6d6a34c4fdf,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed small bug with -s option to cmsearch, now the EVD histogram is
unaffected by it.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1786 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-28T00:34:57Z,nawrockie
7759728d754a17b46d65fafba886198704ef9750,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch now reports GC content of hits.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1785 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-27T21:10:45Z,nawrockie
55cef25db71c0beaee208b35abf9ee460c74bd25,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on the enforce option - now it's two options --enfstart
and --enfseq.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1784 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-27T21:02:15Z,nawrockie
752e6aaed7f560df27c7152c37c0c4bd18291234,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on --enforce option in cmsearch and cmalign.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1783 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-27T16:38:00Z,nawrockie
1a75771c0727a2d43262299269284d11e040335e,Eric Nawrocki,eric.nawrocki@gmail.com,"Last revision still had bugs for mpicmsearch. The sample length for
the statistics wasn't correctly set on the non-master nodes. Now it
is.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1782 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-22T17:52:41Z,nawrockie
3915e1e762dbea01dbbfddbd2e946c119c6ab898,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a bug with --inside on MPI, the integer log odds scores were not
being broadcast.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1781 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-22T16:47:03Z,nawrockie
4dbe60fede8e4f9dd20205d2a807cf741ce29a7a,Eric Nawrocki,eric.nawrocki@gmail.com,"The parallel cmsearch funcs now call the iInside functions, meaning
they use scaled ints instead of floats for log odds.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1780 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-22T03:49:37Z,nawrockie
60905775f659ed4a8bc693f73584c7d94940c343,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with iDegeneratePairScore() and iDegenerateSingletScore()
functions involving the new scaled int log odds scores in alphabet.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1779 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-21T19:57:31Z,nawrockie
49039abe5de0932d88d6de57f5efa2e2fb9b02f5,Eric Nawrocki,eric.nawrocki@gmail.com,"The stats.c::*_make_histogram() functions now call iInside() or
iInsideBandedScan(). Also the 'best_score' reported by the CYK and
Inside scanners is the best score returned by the semi-HMM parse of
all the hits, not just the highest bit score found overall. I think
this is more correct.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1778 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-20T01:57:11Z,nawrockie
e8e8be905a36bc32a91bb2940212dfb6b86287df,Eric Nawrocki,eric.nawrocki@gmail.com,"Implemented scancyk.c::iCYKScan() a integer version of CYKScan(), that
uses scaled ints as log odds scores instead of floats. Didn't result
in a speed-up, I'm about to delete it, purpose of this commit is to
have a record of it, for whatever reason.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1777 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-20T01:35:03Z,nawrockie
5b6520e8783f855f4f7b955755fd0cc4fd63f55a,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1776 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-12-19T18:43:33Z,nawrockie
245fa10fe02aacad1559f85e20c9ab8c08f99d56,Eric Nawrocki,eric.nawrocki@gmail.com,"The i10 bug fix that was reported as ""closed"" in revision 1767
actually introduced a new bug (!). Revision 1772 correctly fixed 
bug i10. This revision (1776) fixes BUGTRAX to reflect the new fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1775 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-19T18:40:19Z,nawrockie
244e0739f20f0533e13d595c06efc1e4a3e6a549,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified the CM data structure to include scaled int versions of the
log odds scores - implemented new scaninside.c::iInsideScan() and
iBandedInsideScan() which use these scaled ints instead of floats (a
la HMMER) resulting in a big speedup. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1774 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-19T18:28:49Z,nawrockie
b2ea0ee2f863ae651246834daa46729ca322f775,Eric Nawrocki,eric.nawrocki@gmail.com,"--read option added to partial-test to read in sequences to truncate
instead of necessarily generate seqs from the CM.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1773 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-19T12:03:18Z,nawrockie
916e5a77e5f86ad3c56ea475f00c472dce76cba1,Eric Nawrocki,eric.nawrocki@gmail.com,"--inside now works with MPI cmsearch.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1772 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-18T23:17:57Z,nawrockie
04d1c14b946d38de6f4d78c421b1138ec00cd57a,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1771 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-12-18T21:04:21Z,nawrockie
39f6342c98d66aba924f71c64b300cea4f74706c,Eric Nawrocki,eric.nawrocki@gmail.com,"Previous commit was for bug i10, but I since realized I didn't follow
the instructions in BUGTRAX/00README correctly.

Revision 1766 has the bug fix, but also has other changes since
revision 1765 unrelated to the bug. To find the changes relevant only
to the bug, do a 'svn diff -r 1765:1766' for bandcyk.c, hbandcyk.c, and
scaninside.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1767 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-15T23:09:46Z,nawrockie
1b5899ed9eb99b23ed5853252e80e8e0047db74f,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug i10, reported it in BUGTRAX and added a test case 'i10' in
Bugs/. This goes along with
~nawrockie/notebook/6_1215_inf_72_release/bug_cmsearch_segfault_121506/00LOG. 
Bug occurs with QDB when -W is set on command line.

cmalign --fsub and partial-test --fsub are still under development,
and are not reliable.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1766 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-15T23:02:05Z,nawrockie
a016986993496133b11d2bfd1f8f5c177bc4d3ff,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on partial-test.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1765 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-14T13:55:19Z,nawrockie
e65e0f13eb204a501907789e7d709cc9ecd1ade5,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1764 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-12-13T21:26:59Z,nawrockie
e89c2c6c1edaa99242b5b36346e6ead0c72890d8,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1763 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-12-13T21:25:56Z,nawrockie
443ba53f81663e58c2a837e32dee7e38dbf72e29,Eric Nawrocki,eric.nawrocki@gmail.com,"Added a README on using MPI - this will likely change as I figure out
how to properly give a --with-mpi option to configure.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1762 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-13T21:00:10Z,nawrockie
4ba7d3db887c7c027110373cd38e143e5401e313,Eric Nawrocki,eric.nawrocki@gmail.com,"Commiting a new configure.ac that partially works towards building an
MPI cmsearch when ""sh ./configure --with-mpi"" is executed. I say
partially because some manual tweaking of the inferal/Makefile is
still required following this configure call. A normal configure
(without ""--with-mpi"") should be unchanged.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1761 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-13T19:29:43Z,nawrockie
eacec4d7f452673589862262f7cb4f3dff7b2710,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1760 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-12-13T11:51:09Z,nawrockie
d61b35db7d368c1689a4da8658065d4dd411717a,Eric Nawrocki,eric.nawrocki@gmail.com,"Forgot to add new files in last few commits. The histogram.* files are
temporary, but currently needed. The mpifuncs.* files are likely here
to stay.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1759 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-13T11:44:16Z,nawrockie
3b73d7e4d877dfecc64b1ca2ac7f24c4b1aa9543,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated infernal2glbf.pl and infernal.rmm to read new cmsearch output
and pick up E values. Added rmark_MPI_cmsearch.pl to handle MPI
cluster runs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1758 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-13T11:41:39Z,nawrockie
c66b894657aaa6dfea0399c5a73fe023a1583738,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed problem with cmsearch --partition.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1757 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-13T11:38:51Z,nawrockie
86d9b8f491dd04cfac4d15593aaa905bfa19f744,Eric Nawrocki,eric.nawrocki@gmail.com,"MPI cmsearch is now functional for anecdotal examples.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1756 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-11T18:52:13Z,nawrockie
ca5ae57211c10d79ff165563ba72971b0c56d2cc,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified infernal.pm to read in cmsearch output (now RSEARCH style).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1755 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-09T14:48:17Z,nawrockie
4c7f4a2bd5b47e7486ce6dc061f053290e0baab0,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on bringing MPI to cmsearch.

Changed cmsearch output format to RSEARCH format.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1754 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-09T14:44:59Z,nawrockie
ad2f7d2580462d381137fe41d5e980a7314d93da,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign.c now calls cm_wrappers.c::AlignSeqsWrapper().


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1753 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-06T23:27:24Z,nawrockie
cf011c28dfd83211000b6445289def7cfc1d5845,Eric Nawrocki,eric.nawrocki@gmail.com,"- First attempt at porting MPI from RSEARCH - it doesn't work yet. 
- Significant progress made on partial-test.c. 
- Added cm_wrappers.c which has a single function, AlignSeqsWrapper() 
  which basically does the main part of what cmalign does, but now
  it's in a separate function so I don't have to recopy it (for 
  example, as I would need to do for partial-test.c).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1752 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-06T22:44:05Z,nawrockie
e3c1d5b77d48d69c99a3f980757fa7bfeac83b94,Eric Nawrocki,eric.nawrocki@gmail.com,"Added partial-test.c, which is eventually destined for
testsuite/. The goal is to have it evaluate infernal's various
alignment techniques at handling partial sequences. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1737 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-02T16:13:12Z,nawrockie
4d5b99cfc2d945d9a435860cfb075f5c4f658b38,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1736 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-12-02T16:11:47Z,nawrockie
0cdba2e1ad804debdb0d9b9fc92afd7ec65c69b7,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor fixes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1735 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-01T17:09:20Z,nawrockie
8a2cdbff0cf1e97dd3de7120b375e97531da46c0,Eric Nawrocki,eric.nawrocki@gmail.com,"Ported E-values from RSEARCH-1.1. Much of Robbie's original code,
including stats.c and stats.h was just copied and modified the minimal
required amount. I didn't copy histogram.c from RSEARCH though;
instead Easel handles the histogram and Gumbel fitting.

Also updated the rmark benchmark scripts so they can better handle
either bit scores or E-values.

Ref: ~nawrockie/notebook/6_1122_inf_e_values/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1734 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-01T16:52:20Z,nawrockie
d58e076c55f6037be02b6b879559fb126b4ff6f5,Eric Nawrocki,eric.nawrocki@gmail.com,"ParsetreeEmit() wasn't assigning emitl and emitr for E states with the
same convention that Parsetrees are built during CYK - now it does.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1733 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-12-01T16:27:45Z,nawrockie
678a501944a3b36b4fbd355329ee73c2cfd8a893,Sean Eddy,sean@eddylab.org,"Infernal 0.71 release checklist complete. Merged back into trunk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1729 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-30T16:42:12Z,cryptogenomicon
0657b8cd520d822328100fcb921d86df179d9bbb,Sean Eddy,sean@eddylab.org,"Added cover letter for PLoS.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1722 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-30T11:43:17Z,cryptogenomicon
745fbd75247bcbd1108955f4498372676ba43504,Eric Nawrocki,eric.nawrocki@gmail.com,"Deleted files that don't need to be released.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1720 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-29T19:11:10Z,nawrockie
b5e6cc5ecac27a12d3a74ad752fb23fc572f443a,Eric Nawrocki,eric.nawrocki@gmail.com,"Cosmetic changes. Ready for the 0.71 release from my end (really).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1719 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-29T18:56:32Z,nawrockie
098e4e3f6d233f9a2683cb78dae7c9258639a3c1,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed and logged bug i9 - a rare score discrepancy between qdb-enabled
D&C and non-D&C alignment. Turned out to be I was incorrectly
initializing alpha cells for B states - a one line (two character) fix.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1718 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-29T14:42:34Z,nawrockie
878fc0b08dde328837d71d164a2e636e7c6cc336,Eric Nawrocki,eric.nawrocki@gmail.com,"Massive clean-up prior to 0.71 release:
- HMMER directory is gone, 5 small functions were copied from
  HMMER code to cplan9.c. CM Plan 9's now use infernal's alphabet.c's
  conventions. Prior to this revision, they used HMMER's alphabet.c's
  conventions.
- An infernal/src/ make with gcc -Wall -g flags now compiles with 0
  warnings. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1717 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-29T11:36:24Z,nawrockie
bac8de84dbebccc246b2b3d4010344edd9698d7f,Eric Nawrocki,eric.nawrocki@gmail.com,"Made the blast benchmark easily reproducible.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1712 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-27T12:04:05Z,nawrockie
3bcd222a8da47b5d88f3d503c279da9348ff391e,Sean Eddy,sean@eddylab.org,"Fixed a stray TAB/space problem.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1705 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-26T16:09:49Z,cryptogenomicon
9aed2fb9c2e2d596b1a7df30b823273c28a53e27,Eric Nawrocki,eric.nawrocki@gmail.com,"Removed a single debugging printf line from cmsearch output.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1704 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-25T14:34:40Z,nawrockie
ce34363809a90b09f11bae79044363d09542a453,Eric Nawrocki,eric.nawrocki@gmail.com,"EPN signing off on a new release. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1703 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-21T22:50:11Z,nawrockie
2956e9861f0afa67b3a0f5c91f6c53c33d9ec448,Eric Nawrocki,eric.nawrocki@gmail.com,"About to clean up a bit prior to a release. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1702 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-21T16:16:09Z,nawrockie
be3619f285a8abf0782145a118c2bbe81fc2a6f7,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --elsilent option to cmalign that sets the EL self transition
score to IMPOSSIBLE, effectively disallowing emissions from the EL
state. 
Currently cmalign --fsub disallows EL emissions in this way.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1701 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-19T23:01:49Z,nawrockie
f03c90851b00a1c497c10efec3d9a8ef79a184a2,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1700 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-11-17T14:43:29Z,nawrockie
f53054167a58dedc1a1379094472007fe6059df5,Eric Nawrocki,eric.nawrocki@gmail.com,"Added main.rtf and transitions.rtf (I had some issues with getting the
transition table to rtf inline with the rest of the manuscript). Oh
the horror.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1699 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-17T00:07:09Z,nawrockie
1cc82370e72be708e0f99887a3f71225fb0104a8,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1698 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-11-16T23:42:41Z,nawrockie
c19fb8129f27b9f2c7a045bacd8ccd74b02a9064,Eric Nawrocki,eric.nawrocki@gmail.com,"As squeaky clean as I can get it. About to attempt a latex2rtf conversion.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1697 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-16T14:40:02Z,nawrockie
0aee705fac3e774565a4f5cdab1cd5343a7820a2,Eric Nawrocki,eric.nawrocki@gmail.com,"Working from home, need fresh copy.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1696 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-16T10:53:26Z,nawrockie
7524cc1674eec5a857ebaa6f946ade0aa41fa1d3,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor fix to script, to make it copy prior and null files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1694 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-15T19:16:27Z,nawrockie
da4dda0357d562aecd4b59987de10b385c9fc096,Eric Nawrocki,eric.nawrocki@gmail.com,"Added plus1.prior.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1693 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-15T19:13:39Z,nawrockie
34401f089192a9569a049e932c25ffa5c4c2f362,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed cmbuild --bfile to --bdfile. This is the option used to get
the band density plots in the banded-cyk manuscript. Added new cmbuild
option called --bfile which prints out dmin and dmax for all states to
a file to be read in by cmsearch. 

cmsearch --qdbfile <f> now reads in this band file and uses the bands
in the file instead of calculating them. 

All this was done for the specific reason of rerunning the rmark-1
benchmark in QDB mode using new model parameterization (new priors,
entropy weighting) and OLD bands (calc'ed using plus-1 priors and no
entropy weighting).

M    src/structs.h
M    src/cmsearch.c
M    src/modelconfig.c
M    src/CP9_cm2wrhmm.c
M    src/cp9-test.c
M    src/cmalign.c
M    src/cmbuild.c
M    src/funcs.h


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1691 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-15T18:59:19Z,nawrockie
a08b33de2929a8d83874850183fb1b6c2f16ccf9,Eric Nawrocki,eric.nawrocki@gmail.com,"Created cp9-test.c for testing the CP9 construction procedure.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1690 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-13T23:44:38Z,nawrockie
cc6e33b4b4a691edcf3cf9d6b739a2b46e2d5c97,Eric Nawrocki,eric.nawrocki@gmail.com,"Logged the i7 and i8 bugs originally reported by Sam
Griffith-Jones on October 4. These bugs had been both been fixed as of
revision 1675.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1689 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-10T20:31:50Z,nawrockie
f73aabc8e5d03f30b351f0fac9fc8120117f67e2,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1687 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-11-10T18:35:18Z,nawrockie
f29e5b0d74e5e692338428a7ed658d0f0d36b991,Eric Nawrocki,eric.nawrocki@gmail.com,"Forgot to add a bunch of other files as well.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1686 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-10T17:05:36Z,nawrockie
2eec70c20bbe3a001fb0efd50df051e74ee2afe9,Eric Nawrocki,eric.nawrocki@gmail.com,"Forgot to add the 00README.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1685 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-10T17:00:59Z,nawrockie
10e065f47f50c91c35a395784e8e861c741155cb,Eric Nawrocki,eric.nawrocki@gmail.com,"Added 'benchmarks' in the main infernal/ directory. Inside that is a
cmsearch-rmark directory with 'rmark-1' the specific benchmark used in
the banded-cyk manuscript and a 00README that hopefully is sufficient
(it took a while to make...)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1684 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-10T16:56:43Z,nawrockie
f6409d599b182052df6c63a14f8443c7e34968dd,Diana Kolbe,diana.kolbe@gmail.com,"Added subsection about installing rigfilters



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1683 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-09T20:02:13Z,N/A
c519450951fe2eca90336e65a43a510c689fdb01,Diana Kolbe,diana.kolbe@gmail.com,"Switched --enable-rigfilters to --with-rigfilters



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1682 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-09T19:45:19Z,N/A
c0c3d3d2b1aa733f2ee39439ff278fd7b2263ce5,Diana Kolbe,diana.kolbe@gmail.com,"Updated notes regarding the rigfilters subpackage
to reflect its current status.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1681 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-09T19:29:34Z,N/A
a6e2a0a3f0caa40f2cdbad872612b0e439e298a9,Eric Nawrocki,eric.nawrocki@gmail.com,"Added i6 info (see SVN log revision 1679 for code commit related to
this bug).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1680 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-07T14:35:37Z,nawrockie
4b0d0b358905f2566c09beded683fce67903a564,Eric Nawrocki,eric.nawrocki@gmail.com,"Found and fixed a D&C local alignment bug (i6 in
infernal/Bugs/). EL self transitions were being added incorrectly in
smallcyk::outside() and smallcyk.c::voutside(). The banded versions
of these functions was also fixed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1679 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-07T14:34:27Z,nawrockie
e1f7b34d28071b6d76274c45047331371b94ac77,Eric Nawrocki,eric.nawrocki@gmail.com,"Last minor minor changes - asking the lab to read this revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1678 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-07T11:37:49Z,nawrockie
37bb006e22883484cc44d0b6f647e4754736bb7c,Sean Eddy,sean@eddylab.org,"I'm happy with it now. Time for the lab to read it.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1677 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-06T20:11:49Z,cryptogenomicon
bad071530a9855f999b5ab39bd29aec3b137d460,Eric Nawrocki,eric.nawrocki@gmail.com,"cmscore now takes --qdb as a possible
option. smallcyk::CYKInsideScore() and smallcyk.c::CYKDemands now work
in QDB mode.

I found a bug in local divide & conquer alignment (not QDB!) that I'm
about to investigate.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1676 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-06T18:07:15Z,nawrockie
523b9301e55bf1fa1960aa38f0dc3b9b216ec2d0,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on bug 6 (i6) in BUGTRAX. I thought I had this bug fixed, but
I was wrong. Now I think I've got it again.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1675 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-05T20:37:48Z,nawrockie
2cea619af444a768a20404e06bc140953a003bb0,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign --fsub now seems to be working as expected (I wasn't
configuring the CP9 for local alignment prior to determine CP9 bands).

Changed cmbuild --eloss to --etarget (default value of --eloss was
0.54, default value of --etarget is 2.0-0.54=1.46). This makes the 
code more consistent with the banded manuscript. 

Made query-dependent banding default in cmsearch, --noqdb turns it
off.

Fixed a stupid bug in cmbuild.




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1674 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-05T17:51:25Z,nawrockie
ef6cbdb663eab50606092565a990a62be7a97b83,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed some reference labels.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1673 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-05T15:45:21Z,nawrockie
bace02b228587eef583a071001ced1d345a3ef21,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated figures and tables. Also made a couple changes to main.tex,
there's few enough that a svn diff -r 1670:? is readable.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1672 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-03T19:09:44Z,nawrockie
71ec4ef0ddd64054ba00a3a3d459322e5e8fd424,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed CMRebalance() function so that when at a BIF, it chooses to
visit the left child first if the weight of the left child is less
than OR EQUAL to the right child. Prior to this change the left child
was only chosen if it was strictly lighter than the right child, with
ties going to the right. 

Only a single character was added to the code in cm.c:
'if (wgt[w] < wgt[y])' changed to 'if (wgt[w] <= wgt[y])'. The reason
for this change is so that example in the 'cmintro' figure in the
bandcyk manuscript can be easily recreated by Infernal.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1671 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-02T02:44:41Z,nawrockie
4582267373139dd69b4b7a373a540a5326168582,Eric Nawrocki,eric.nawrocki@gmail.com,"Cleaned up and reorganized sub_cm.c. Though not beautiful, it's much
better than before. 'sub_cm-test --full --psionly --exhaust' now works
for a trna model, but the analytical HMM fails (although rarely) b/c
there are new 'impossible' cases that appear with --full. 

cmalign --fsub runs, but doesn't work as I expected for SSU;
something's wrong there...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1670 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-11-01T21:53:03Z,nawrockie
1d3ed1f7380faff58d2327ab514f85c3ee2e0546,Sean Eddy,sean@eddylab.org,"oops, an edit in speedup didn't get checked in.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1667 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-31T18:02:59Z,cryptogenomicon
73853bee48579eacfd1bd2780003ebd2daa944fb,Sean Eddy,sean@eddylab.org,"ok, the banded-cyk paper is nearly done.

figs and tables split out to files: draft vs. preprint versions should
now work from single source.

To do:

Still missing a few citations: Eric must have these in a bandedcyk.bib
that's not in svn yet.

Needs tbl:rmark: a merge of prev Tables 6+7.  

Needs some minor figure revisions.

Check that we consistently use N for query length, L for target
database length.

Check program names in \textsc for font size: use lower case in these,
usually.

Proofread.

Get in submission format for PLoS Comp Bio (or whereever).




git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1666 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-31T17:56:43Z,cryptogenomicon
934cd5fb93186050591bc1a3037a22332f819590,Eric Nawrocki,eric.nawrocki@gmail.com,"IMPORTANT CHANGE: cmio.c modified to always remove ambiguities
involving insert states 1 state prior to an END_E. These states are
'detached' from the rest of the model by setting all transitions into
them as 0.0. This is done by a function call withing read_ascii_cm()
and read_binary_cm(), and no option exists currently to NOT modify
this behavior. 

This means that it's currently impossible to identically recreate
output from previous versions of cmalign <cm> (or cmsearch, or
cmscore), if <cm> was built with a cmbuild that does not remove these
ambiguities (cmbuild 0.7 and earlier does not remove these
ambiguities).

Also since the last commit, I reorganized hmmband.c related code a
bit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1663 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-29T14:37:51Z,nawrockie
8639048218cb5e3315316b241669eed1fbd316c3,Eric Nawrocki,eric.nawrocki@gmail.com,"Reorganizing sub_cm.c and HMM banded code (hmmband.* and
CP9_cm2wrhmm.*).  Not done yet, but good commit point.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1662 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-27T15:45:08Z,nawrockie
e0fa1a0c787a99f074311481a601d0f471c6d6b4,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign --sub now runs, and seems to work correctly, though I want to
make a more serious test. If --sub is enabled, a CP9 HMM is used to
determine the most probable start and end point of each target seq,
then a sub CM is built for that start/end point, the seq is aligned to
the sub CM, and the sub_cm parsetree is converted to the orig_cm
parsetree.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1660 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-25T21:10:26Z,nawrockie
e7cd8da49814f59fc3e21b7295da530e21eb0324,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed a bug in 'cmalign -l --qdb' that sometimes gave different parses
than 'cmalign -l --qdb --nosmall', reported by Sam
Griffiths-Jones. Bug is fixed for the 2 instances he reported; but I
need to set up a more extensive benchmark. Also cleaned up smallcyk.c
a bit.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1658 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-23T10:39:01Z,nawrockie
591d3a23d6ea362e99dd4327676ea71798f957d5,Eric Nawrocki,eric.nawrocki@gmail.com,"sub_cm-psi-test* renamed to sub_cm-test*. The sub_cm-test executable
has several options; one of which, --exhaust, takes a cm and builds
every possible sub_cm from it. It then checks that the psi values are
consistent b/t the orig_cm and sub_cm, and if ML HMMs built from the
orig_cm and sub_cm have very similar transition distros (within
0.00001 for each parameter) for all HMM nodes except those that
are predicted to be different. See
~nawrockie/notebook/6_0725_inf_sub_cm/00LOG for details.

cmalign --sub still not functional. Construction of sub CM models that
only remove structure outside spos and epos has not been tested, and
I think doesn't work at all.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1657 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-20T18:58:19Z,nawrockie
3773d99152ce3ed6dc83fe4cdd9e7fabc7a9635b,Sean Eddy,sean@eddylab.org,"committing the banded cyk main.tex to move to laptop...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1656 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-15T13:56:40Z,cryptogenomicon
65c0738f64ac1f35f9ec2ad81acfe9c3f6e13aa7,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated d2roc_ai.pdf and 3fam_bands.pdf with updated versions; other 2
are new.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1655 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-13T19:10:12Z,nawrockie
6e7e88f6769722ee4015913a143d712eee228013,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch by default now has NO null2 correction and DOES set insert scores
to zero. About to benchmark for banded manuscript. 

cmalign --sub not yet fully functional.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1653 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-08T00:05:07Z,nawrockie
898dc26a2e7f4d5d280c94cb9e8011322b509712,Eric Nawrocki,eric.nawrocki@gmail.com,"About to start working on laptop, need updated files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1649 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-03T14:30:14Z,nawrockie
c97229eec976a69fd29f80927ce870a285fe3c9c,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1648 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-10-02T17:33:21Z,nawrockie
ee2c2d26688b6b5f466978a4a7e8bce1f7b19b62,Eric Nawrocki,eric.nawrocki@gmail.com,"Last log entry for revision 1646 was incorrect - that version of the
code fixes the local ends bug during band calculation, but DOES NOT
ignore local ends during band calculation, instead it correctly
incorporates local ends, with the effect being very very wide bands
(the root band for a tRNA model has dmin=1, dmax=267!). 

This revision replaces the way BandCalculationEngine() calculates
bands in local mode with a method that ignores the possibility of
local ends - which allows us to keep the speed-up of the banded
approach in local mode.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1647 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-02T17:29:21Z,nawrockie
4524f8a3bf434f6c2fdf86605ed9a882ca878fc2,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on cmalign --sub. Also a bug in a priori (query
dependent) band calculation in local mode was removed and replaced by
a method that ignores local ends when calculating bands. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1646 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-10-02T16:01:44Z,nawrockie
089d0555ad8b53254a22e103b8d484c6905d304c,Sean Eddy,sean@eddylab.org,"updated svn:externals


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1643 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-28T14:24:50Z,cryptogenomicon
c6c2a8545caf18f55c68270a0b0eed816d4aa822,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1641 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-09-28T11:55:23Z,nawrockie
c8409b44a752f338e23d52c1df56d735d8348df9,Sean Eddy,sean@eddylab.org,"Working on my revision... now up to Table 1, pg. 16.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1640 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-27T19:55:05Z,cryptogenomicon
40d2a86cae7b9cb572c876efadc8274d14e78043,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1639 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-09-27T11:14:57Z,nawrockie
1cdc17849d563b0593a3b854710c060608a3e736,Eric Nawrocki,eric.nawrocki@gmail.com,"Prior to subversion repository overhaul by Goran.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1638 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-26T21:00:20Z,nawrockie
b51160e3b1a8a634fe217c8f97431e5c05a63bae,Sean Eddy,sean@eddylab.org,"Commiting half my changes (underway) now, to switch from laptop.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1637 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-26T20:30:23Z,cryptogenomicon
6507c4c05bb3ada0be7e16aa4bb9d115f629c513,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1636 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-09-23T18:44:16Z,nawrockie
fbb7b19785969847246c8bd49d0b5a78b6750095,Eric Nawrocki,eric.nawrocki@gmail.com,"It's really ugly and not too efficient but the code for building a
sub_cm seems to be working flawlessly on the overwhelming majority of
start and end points for tRNA and SRP. There may be a very rare case
or two that it doesn't precisely handle.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1635 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-21T22:59:42Z,nawrockie
98d88ecb1dda390f177b24049f78daeb6a2647df,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on cmalign --sub. About to attempt to streamline the
code. Still doesn't correctly handle at least one rare case (see
~nawrockie/notebook/6_0725*/00LOG).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1633 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-20T12:48:44Z,nawrockie
05240bff0075dd9cd5002240b78d418d5920ba47,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on --sub.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1631 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-18T11:08:32Z,nawrockie
0e9e2be9e77d617372ce8cf7ac46d0aa54df6422,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on the --sub function.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1630 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-13T23:05:45Z,nawrockie
579d56c35fd92ef9de838f9024225ba3c3eb0905,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on the cmalign --sub option. Code still very messy, but
this is a good checkpoint. See notes in
~nawrockie/notebook/6_0725_inf_destruct/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1629 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-13T12:25:17Z,nawrockie
63da57e786c5543be7cec56f6a36e52c09ccf799,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign --hbanded --checkcp9 now performs a 'sampling check' on the
CP9 that's constructed from the CM. No changes made to the CP9
construction procedure, but now I'm much more confident it actually
works as its supposed to. A chi-squared test is performed for each
probability distribution (emissions and transitions) in the CP9 HMM,
and if any return a p-value below 0.05, it fails. Some prelim tests do
fail, but I think this is expected, but I'm not sure how/if to correct
for multiple tests...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1628 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-05T20:34:56Z,nawrockie
f3ca20138b5ee91cf25d254b9cc54fb472d376e1,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on adding --checkcp9 function to cmalign which will build a
two CM plan 9 HMMs, one using the analytical method already in use, 
and another by maximum likelihood based on samples from the CM. These
two CP9 HMMs are then tested to see if their corresponding parameters
are 'close enough' to each other. This is essentially a test of the
code already in use for analytically building a CM plan 9
HMM. Eventually we'll want to do something similar to test if our
procedure for building sub-CMs is working correctly.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1627 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-05T14:54:14Z,nawrockie
8aac85a758d3d59598fcbed0b34b393f7f4e46d2,Eric Nawrocki,eric.nawrocki@gmail.com,"Ported hmmemit.c from HMMER-2.3.2 to cmemit.c. Make now builds a
cmemit executable which appears to be working correctly.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1626 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-01T15:46:01Z,nawrockie
583f8053205d3401e950bd79f39623afd0d57000,Eric Nawrocki,eric.nawrocki@gmail.com,"Checkpoint for code for --sub option in cmalign; but still not operational.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1625 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-09-01T14:35:41Z,nawrockie
fe1f93c44ec9415418c0688f9e59d65e170c84da,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1624 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-08-31T12:14:09Z,nawrockie
5a81e3918dce036dea92854daff3d2f5132e5a96,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1623 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-08-30T10:59:58Z,nawrockie
0e518a158e3be718774a54415d0f2a4c8dbd6370,Eric Nawrocki,eric.nawrocki@gmail.com,"Renamed --destruct option --sub; as I think --destruct is confusing.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1622 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-08-30T10:59:31Z,nawrockie
2062bd968283a031bea508484cf20c799d9b080b,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1621 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-08-30T10:46:44Z,nawrockie
e7eafce1c5b7695955d1da3662baf293ed9004d7,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on --destruct option in cmalign.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1620 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-08-30T10:43:36Z,nawrockie
f50c9a96ba485f0fb36e0ba654d16ea7e208cf13,Eric Nawrocki,eric.nawrocki@gmail.com,"Revisions to text of banded-cyk manuscript. Also, added a new figure
for introducing CMs.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1619 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-08-29T19:52:39Z,nawrockie
cf6732759f275634cabefff19ec5e1cef447354a,Eric Nawrocki,eric.nawrocki@gmail.com,"Null2 model score correction code ported from HMMER into new file
cm_masks.c. This code hasn't been rigorously tested. The null2 score
correction is subtracted from hit scores post-CYK in cmsearch by
default, and can be turned off by --null2 option.

Also, started work on destruct.c for eliminating structure in the CM
in regions outside of where the HMM says the hit is. This is enabled
with the --destruct option, but is still in development.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1618 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-08-28T19:23:55Z,nawrockie
a555f071d280dacfd7f9baa7290bff06bfe554d2,Sean Eddy,sean@eddylab.org,"Changed the svn:externals to grab from Janelia's svn


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1617 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-08-22T19:31:54Z,cryptogenomicon
f341751f0ad3e458d2d8dce8475f42b8d09e094e,Sean Eddy,sean@eddylab.org,"Minor edits in the banded cyk manuscript


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1614 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-08-17T01:08:11Z,cryptogenomicon
8dfa567fe8a46dbc471d715efff89f2434c638a0,Eric Nawrocki,eric.nawrocki@gmail.com,"Benasque: HMM filtering extended by adding --hmmfb option and allowing --apbanded, --hbanded or --inside in any combination to be executed on the filtered fraction. Still working out kinks, and major bugs may still exist. See /notebook/_0531_inf_hbanded_scan/00LOG for details.

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1610 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-07-24T13:20:50Z,nawrockie
d808d7c4304a48d1d743fae1d536ee8eb7e9b38d,Eric Nawrocki,eric.nawrocki@gmail.com,"Whoops again, should've added this a while back.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1609 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-07-14T15:16:58Z,nawrockie
e014faa535b519c7efdedf7a618e410ade9f683e,Eric Nawrocki,eric.nawrocki@gmail.com,"I had been updated Makefile with new *.o files, not Makefile.in. Whoops.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1608 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-07-14T15:05:18Z,nawrockie
bf40de5a8ad4a3e99e4924fa2ce7ea50a598b622,Eric Nawrocki,eric.nawrocki@gmail.com,"Checkin prior to leaving for Benasque RNA meeting. cmsearch is known
to have bugs with the --hbanded option, I'm still working on these.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1607 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-07-13T20:13:05Z,nawrockie
2654df04f1f6982b122368a4ed1050ecb0d8053d,Eric Nawrocki,eric.nawrocki@gmail.com,"Still working on adding and experimenting with hmm banded strategies
for cmsearch. Wrote a CYKBandedScan_jd() function in hbandcyk.c which
uses HMM bands to constrain the scanning CYK algorithm. Default
behavior for 'cmsearch --hbanded' is now to get likely i and j pairs
from a scanning Forward and Backward run, and then *search* through
these subseqs using this new banded CYK scanning function. About to
benchmark some different strategies to get an idea of performance
relative to non-banded.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1606 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-06-29T12:53:23Z,nawrockie
47e024261b4043d1fc5c9ab61a1bb9002ecb52bd,Eric Nawrocki,eric.nawrocki@gmail.com,"Working on adding hmm banded functionality to cmsearch. Not nearly
finished, but this is a good checkin point. 'cmsearch --hbanded <cm> <seq>'
currently runs, and does the following: builds a CP9 HMM from the
<cm>, does a Forward and Backward scan of the full <seq> and
determines likely start points of hits (i coordinates) from the
Backward run, and likely end points of hits (j coordinates) from the
Forward run. For each hit, bands are derived a la hmm banded cmalign,
and the bands are used for CYK alignment with the ends fixed at the i
and j coords specified by the hmm scan. Only CYK alignments with
scores > the reporting threshold are printed to the screen. 



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1605 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-06-23T15:55:11Z,nawrockie
434f4d3bf1ea06177dac9cd021f0236ef09bf88f,Sean Eddy,sean@eddylab.org,"Started editing the banded cyk manuscript. moving to laptop for CSHL trip.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1604 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-05-30T21:25:52Z,cryptogenomicon
ebd5c289887cf2f360c0f13beaa1970c0ac1fffb,Eric Nawrocki,eric.nawrocki@gmail.com,"Local alignment now *works* (but has not been ""rigorously"" tested)
with cm_postprob.c. Any combination of the following options with
cmalign now appears to work:
""-l, --inside, --outside, --post, --hbanded, --p7""

Also a --checkpost option was added to enforce the execution of code
that checks the posteriors to make sure they make sense (thus ensuring
that the Inside() and Outside() runs were consistent - mainly for 
debugging).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1603 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-05-30T20:19:07Z,nawrockie
6846938124b713886d9b98b62472626fb3458dc9,Eric Nawrocki,eric.nawrocki@gmail.com,"Main functionality of cm_postprob.c appears to be working. The
following options work with GLOBAL alignment (not local) for cmalign:

cmalign --inside; cmalign --outside; cmalign --post;
cmalign --hbanded --inside; cmalign --hbanded --outside;
cmalign --hbanded --post;

The --inside calls just return a score from FInside().
The --outside calls run FInside() first, then FOutside(),
and check that the alpha and beta values are consistent
(see code) for each node of the model.
The --post calls run CYK, Inside, then Outside, and append
""postal code"" confidence estimates to the resulting alignment.

The holy valgrind was used to find and squash memory leaks 
prior to this commit. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1602 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-05-28T19:28:00Z,nawrockie
68feb35557189201b9674873f16f969d254cd8b9,Eric Nawrocki,eric.nawrocki@gmail.com,"All *Inside*() functions now use LogSum2() (which returns log_2 sum of
two log_2 probabilities) instead of previously used LogSum() (which is
uses natural log space). LogSum2() is in cm_postprob.c.

Wrote FOutside() which performs the Outside algorithm for CMs, and
seems to be working (the resulting beta matrix is checked for 
consistency with the alpha matrix from Inside by checking P(S|M)
values - see code). *HAS NOT BEEN CHECKED RIGOROUSLY FOR LOCAL
ALIGNMENT* (about to do this).

cmalign has a new --outside option which does Inside, then Outside,
and, as currently implemented, laboriously checks that the alpha
and beta matrices give consistent values for ALL nodes (see code).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1601 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-05-25T14:26:02Z,nawrockie
634b070bffbe5be75a5ef2046768844e395ed2d8,Eric Nawrocki,eric.nawrocki@gmail.com,"Wrote scaninside.c currently with 2 functions: InsideScan() (analagous
to scancyk.c::CYKScan()) and InsideBandedScan() (analagous to
bandcyk.c::CYKBandedScan()), with maxes replaced by sums in the DP
recursion. LogSum() function in HMMER's mathsupport.c is used to
handle the log space issues.

Also wrote cm_postprob.c meant to be analagous to HMMER's postprob.c
but currently has a single function: FInside() analagous to inside()
(which is really an implementation of CYKInside) from smallcyk.c.
Again summing probs handled by LogSum().

cmalign and cmsearch now have --inside options. cmalign --inside
returns only scores, not alignments. cmsearch --inside *seems* to work
with --local and/or --banded, giving the Inside score and bounds for
positive scoring hits, and then using CYK to get the optimal alignment
given the bounds.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1600 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-05-09T15:15:01Z,nawrockie
8d6b584a2bbc3495b7c5db033174306084b6b479,Eric Nawrocki,eric.nawrocki@gmail.com,"Adding main.tex and figs for banded CYK manuscript, corresponding to
EPN's personal subversion revision 388 in 
~nawrocki/notebook/6_0404_inf_banded_mscript_d3/.

Copied original main.tex which contains only an abstract (written by SRE
in 2003) to main_orig_2003.tex. Deleting old main.tex, and overwrote
it.

The references probably will not work (not sure). Also added is
main_r388_d3.pdf which has all the references for current main.tex.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1599 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-05-08T14:50:23Z,nawrockie
b8a23f0fd34078255ce2931895a7b81baaea21d7,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed --thresh option in cmsearch. Turns out to be more tricky than I
thought to have an arbitrary threshold for score reporting. See
~nawrocki/notebook/6_0427_inf_scan_neg_thresh/00LOG for some details.

If ""cmsearch --thresh <x>"" is used, only negative values close to zero
should be used for <x>, and even then with caution - maybe only if a
default cmsearch run finds nothing.

Other changes are cosmetic.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1598 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-05-08T14:21:53Z,nawrockie
206d731915600b3cb9c618c1649370f744aae0a5,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1592 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2006-04-20T17:08:55Z,nawrockie
9e349f86101212654b291d7f86164ca400387a82,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --thresh option to cmsearch, which allows the user to set a
minimum score threshold (which may be negative) that is reported. This
has not been rigorously tested, but works for anecdotal examples.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1591 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-04-19T17:29:18Z,nawrockie
036154982a4e71aec5ecf2a8582e1f394f3c7f15,Eric Nawrocki,eric.nawrocki@gmail.com,"Modified way cmalign handles --hbanded function. 

o --hbanded: builds a CM Plan 9 (CP9) HMM from the CM, and uses it to
             band alignment (it only takes about .1 sec to build a SSU
             CP9 HMM from a CM)
o --hbanded --cp9 <f>: reads and tries to use CP9 HMM in <f> for
             banding alignment, but builds a new one directly from
	     the CM if the CP9 HMM read from <f> isn't ""close enough""
	     to the CM 
o --hbanded --p7 <f>: reads and uses the Plan 7 HMM in <f> for
             banding alignment.

Also added --time option, which currently is stuck on by default. This
option prints out timings for alignment, band construction, banded
alignment, etc.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1574 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-04-07T16:39:59Z,nawrockie
d60d2ceb58a7647ca14442dcb8bf443918be24e8,Eric Nawrocki,eric.nawrocki@gmail.com,"HMM banded capability added, and working. A hmmer/ dir was added as a
subdir of the the main infernal/ directory. The files in hmmer/
started as 2.4devl code, but were mangled to solve name-space issues
with infernal by EPN. cmbuild and cmalign are the only two infernal
executables affected. Current paradigm: cmbuild can build a Plan 7 or
CM Plan 9 HMM, and cmalign can read either architecture and use it to
determine bands on glocal alignment.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1573 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-04-06T15:19:59Z,nawrockie
3fe8d2e68e13b3c0c8d7f2f40b36b0e618c39ac1,Eric Nawrocki,eric.nawrocki@gmail.com,"Minor cosmetic changes from previous checkin. Last checkin prior to
attempting to add HMM banded glocal alignment capability. Notes
corresponding to adding this functionality in
~nawrocki/notebook/6_0405_inf_hmnl_merge/00LOG.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1571 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2006-04-05T14:18:02Z,nawrockie
609936d37d9f17feb471612ed0e77f69166e71a4,Sean Eddy,sean@eddylab.org,"Infernal 0.7 release: post-merge.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1529 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-12-13T20:52:25Z,cryptogenomicon
1433bea4558743243f1a796b1536edb74d807b7b,Eric Nawrocki,eric.nawrocki@gmail.com,"W parameter set as 200 by default in cm.d::CreateCMShell(), this
*should* make all programs backwards compatible with v0.55.

Cosmetic changes to cmalign.c::debug_print_bands() and smallcyk.c.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1521 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-12-13T13:48:53Z,nawrockie
b0c8a79e13a4b1b72bb29f9eba84a63e99e311c0,Sean Eddy,sean@eddylab.org,"Fixed some innocuous gcc -Wall warnings.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1520 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-12-10T16:45:18Z,cryptogenomicon
2c8660f16803bf6936db29c4b571320188b5226d,Eric Nawrocki,eric.nawrocki@gmail.com,"Actually fixed bug from last 2 revisions. (Really).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1516 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-29T21:09:42Z,nawrockie
6121600f62c86d5d5605c75819347ea7c04a87c2,Eric Nawrocki,eric.nawrocki@gmail.com,"Actually fixed bug referred to in last revision.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1515 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-29T20:50:51Z,nawrockie
e270308feb526f1f3ad843541177f7003a252125,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed bug with setting null model. It can't be set until the alignment
has been seen, which sets the 'Alphabet_size' variable. 'Alphabet_size'
is used in CMSetNullModel() in cm.c. 


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1514 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-29T20:09:12Z,nawrockie
a29e7b92b7943c84001c7e13df9900df11ab0205,Eric Nawrocki,eric.nawrocki@gmail.com,"Default value for the EL self transition probability to 0.94. This
makes the default EL self transition score (cm->el_selfsc) -0.089267
(log_2(0.94)). This default value was optimal for empirical tests,
specifically the RMARK 1.0 bencmark *using the entropy loss target
effective sequence number calculation strategy (default) with an eloss
value of 0.54 (default)*. 

See ~nawrocki/notebook/5_1115_inf_el_trans_prob/00LOG for full
details.

Note: The optimal EL self transition probability for RMARK 1.0 using
no effective sequence calculation strategy (eff_nseq = num seed seqs)
is 0.88 (reflecting the preference for a more severe EL self
transition penalty when the expected score per column is higher). This
value of 0.88 *could* be set if the --effnone strategy is invoked at
the cmbuild command line - but it is not currently.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1512 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-28T16:50:08Z,nawrockie
17da5ca90e183e62ebd8c25980b6792cb5adc4ac,Eric Nawrocki,eric.nawrocki@gmail.com,"Entropy loss target (--effent) is now default effective sequence
number calculation method. Default --eloss value of 0.54 is
unchanged. Other changes are cosmetic.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1511 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-28T16:35:55Z,nawrockie
d53e2c6726e342380626da96a3ba54c5fa9412e8,Eric Nawrocki,eric.nawrocki@gmail.com,"Added functions to cm_eweight and cmbuild to do relative entropy
weighting. Later decided it wasn't worth pursuing right now, so the
--effrelent option has been commented out from cmbuild. I left it in
there in comments case its ever revisited.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1510 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-28T16:02:49Z,nawrockie
d7f669d6e0ea905b910792d0903cf7eead2fb671,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild --effent now has a default --eloss value: 0.54. The RMARK
benchmark shows this value is very nearly optimal (as judged by MER
statistics in HIT mode) for both local and glocal search. Its
important to remember this value is the best --eloss on average across
the 51 families in the benchmark, family by family performance
certainly varies. 

Aware of the danger that RMARK might not accurately represent the wide
range of uses for cmsearch, small benchmarks that tested different
types of scenarios from those tested in RMARK were performed. Namely, one
quick alternate benchmark tested the situation where the training
sequences are fewer and more divergent relative to RMARK where
training seqs are highly similar. Another quick alternate benchmark
tested the situation where many of the test sequences are highly
similar to the training sequences (in RMARK all test sequences are <
60% identical to all training seqs). Results from both these other
benchmarks suggest 0.54 is a safe default value. For full details see
~nawrocki/notebook/5_1107_inf_info_content/00LOG.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1507 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-23T17:19:17Z,nawrockie
300fadeaed4dd4e1b756df6855511ea6ee0e88cf,Eric Nawrocki,eric.nawrocki@gmail.com,"Added cm_eweight.o to Makefile.in


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1501 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-21T17:25:26Z,nawrockie
57ae9048b7549941ebcf3946dae5a1ee7297b857,Eric Nawrocki,eric.nawrocki@gmail.com,"Updated two BandCalculationEngine() calls in the testsuite.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1500 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-21T17:17:57Z,nawrockie
a75902ca050dafd06797189480750f8d91bc67d8,Eric Nawrocki,eric.nawrocki@gmail.com,"The score for a EL self transition (cm->el_selfsc) is now incorporated
into all versions (banded and non-banded) of cmalign, cmsearch, and
cmscore. This score is set by using the --elself <f> option in
cmbuild. <f> is the probability of a self transition in EL, and must
range be within [0..1]. Default is still a probability of 1.0 which
translates to a score of 0.0.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1497 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-18T20:36:30Z,nawrockie
b113e4225a8f3c0f9d7ffe18dcb616df64806cd0,Diana Kolbe,diana.kolbe@gmail.com,"Changed spaces to (necessary) tab in Makefile.in

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1495 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-18T20:23:34Z,N/A
2eb239c30f53cd881dc938feaa2f2b210e347684,Eric Nawrocki,eric.nawrocki@gmail.com,"Introduced a new variable to the CM_t data structure called
el_selfsc. el_selfsc is a score, the log of a probability set as an
option in cmbuild with the --elself option. This score acts as a
hackish EL state self transition score, and is enforced ONLY in a
non-banded CYK scan (in scancyk.c). By default in cmbuild this
variable is set to 0.0, and should not change the behavior of models
from versions previous to this one.

Eventually, this el_selfsc needs to be used in banded scans, as well
as in alignment. But this revision only uses it in non-banded scans.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1492 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-17T15:44:48Z,nawrockie
d789188b8eef1b72083eb5a1d904a7e5fb2d6a08,Eric Nawrocki,eric.nawrocki@gmail.com,"cmalign now uses BandCalculationEngine() instead of BandDistribution
and BandBounds(). See
~nawrocki/notebook/5_111105_inf_banded_vs_bandcalc/00LOG for details.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1490 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-14T01:19:47Z,nawrockie
e7994793f7b8623bc63ee9524e6a1c180ac55635,Eric Nawrocki,eric.nawrocki@gmail.com,"cmbuild now uses BandCalculationEngine() instead of BandDistribution
and BandBounds(). See
~nawrocki/notebook/5_111105_inf_banded_vs_bandcalc/00LOG for details.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1489 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-14T00:55:08Z,nawrockie
eeda6cfb3f2a78b5d9d3b13efbbf89c9bd7ab604,Eric Nawrocki,eric.nawrocki@gmail.com,"cmsearch now uses BandCalculationEngine() instead of
BandDistribution() and BandBounds(). See
~nawrocki/notebook/5_111105_inf_banded_vs_bandcalc/00LOG for details.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1488 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-13T22:07:42Z,nawrockie
12139f3e2e2b70ce6283884532b7a017a431e6ec,Eric Nawrocki,eric.nawrocki@gmail.com,"Cleaned up the entropy weighting code a bit, and changed bandcyk.c so
that it potentially makes the local banded speed-up more comparable
to the glocal banded speed-up. Specifically, a loop that deals with
local begins at the end of the main recursion loop in CYKBandedScan()
now enforces the bands (before bands were ignored in this block of
code). See ~nawrocki/notebook/5_1109_inf_local_banded_spd/00LOG or
comments within the code for details.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1486 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-09T16:26:09Z,nawrockie
83295cd9ab6cf0cd0a552dc6be3a62f40ae2c26b,Eric Nawrocki,eric.nawrocki@gmail.com,"Entropy weighting (--effent and --eloss command line options) to
cmbuild were ported from HMMER2.4devl, and *seem* to be working...
cm_eweight.c and cm_eweight.h files were added. As of now, there's no
default --eloss value, cmbuild requires it to be set at the command
line if --effent is enabled.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1484 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-08T02:42:28Z,nawrockie
7f03029619019426d78063e4fe96371e3c8ff60d,Sean Eddy,sean@eddylab.org,"Infernal 0.6 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1478 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-11-01T23:47:25Z,cryptogenomicon
e969e434f36ac5c8e65162d0c0aeca2484021bce,Sean Eddy,sean@eddylab.org,"Preparing and documenting the 0.6 release.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1464 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-10-31T19:53:26Z,cryptogenomicon
70174ad05d69b98121c776bd82b79430dbc79d49,Sean Eddy,sean@eddylab.org,"squid, ssdk, easel libraries are now ""svn:externals"", so they
automatically get downloaded in an svn checkout or export.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1462 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-10-31T13:32:48Z,cryptogenomicon
e1c6d2adc76fe4c5c5cd8694a198a78e7c93fc1b,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1454 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2005-10-19T15:30:37Z,nawrockie
f0617b42e4df2f2755568e3aab617663772d6ca3,Eric Nawrocki,eric.nawrocki@gmail.com,"Added the --null option to cmbuild. See example null file in rna.null.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1453 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-10-19T15:25:50Z,nawrockie
89b129259296d42653f5a5327abb55b0914e82ec,Eric Nawrocki,eric.nawrocki@gmail.com,"Banded algorithms now *work* when local option is enabled.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1452 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-10-19T13:59:36Z,nawrockie
e4c482036478b384ab2c332f13ed2de34063ff93,Diana Kolbe,diana.kolbe@gmail.com,"Delete cm2hmm Makefile on 'make distclean'



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1448 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-10-14T20:16:10Z,N/A
215879d625fade4d87c8ff60d0826f198a6951b6,Eric Nawrocki,eric.nawrocki@gmail.com,"Added some simple functions to cmbuild that allow printing information
about the bands.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1440 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-09-07T18:29:02Z,nawrockie
a68daaa8546bd66d9a6ab656962369b9e7d1cf52,Eric Nawrocki,eric.nawrocki@gmail.com,"Added --ignorant option (for stripping all bps from the input seed
alignment) to cmbuild to facilitate benchmarking against models that
ignore secondary structure.  StripWUSS() was added to cmbuild.c, it should
be added to WUSS.c in squid or easel, but I don't mess with those.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1439 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-09-07T18:21:18Z,nawrockie
916cc4069ad9e457fb026f012837e9664dde7917,Eric Nawrocki,eric.nawrocki@gmail.com,"The max size of hit (W) is now set to the maximum bound on the root
node (dmax[0]) and stored in the CM data structure (CM_t). This W is
used as the default W for cmsearch but can be reassigned on the
command line.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1437 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-18T20:09:23Z,nawrockie
434d0f8d19c72cd4abdf4c33dfc5b032451525ef,Eric Nawrocki,eric.nawrocki@gmail.com,git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1435 db3e70e4-12e1-0310-b23f-81a6e3d09ba7,2005-08-12T18:50:39Z,nawrockie
9527122f31c7029e6abc571571063c0c6cc871db,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed 'cryptic memory error' in bandcyk.c referred to in last revision
(1433).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1434 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-12T15:58:42Z,nawrockie
8b883f7feaf352f0a61d8e6616f515756e6f25ce,Eric Nawrocki,eric.nawrocki@gmail.com,"Banded cmsearch now skips targets sequences that have length <
dmin[0].  The banded scan would not be able to find glocal hits in
these sequences anyway, and if CYKBandedScan() is executed for such
sequences, it crashes due to a cryptic memory error.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1433 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-12T13:53:36Z,nawrockie
7d70dcdd72c3179f814128f57b89c236db10e733,Eric Nawrocki,eric.nawrocki@gmail.com,"Last revision was flawed, I fixed it.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1431 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-11T21:53:41Z,nawrockie
4fcec0419a825c01c1ec9f155b3663925e6a2653,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed small pseudo-bug in bandcyk.c that was confounding my
benchmarking attempts.  The change prevents W from being greater than
L in bandcyk.c, and saves time if the W used is not very appropriate. 
In practice for real use of cmsearch against long sequences, this
change shouldn't have an affect, but if the sequences being searched
are short (less than W) this can have a large affect on running time
of banded cmsearch.  


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1430 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-11T21:27:35Z,nawrockie
972bb584aacc9510439cdbcaafbe750078b05809,Eric Nawrocki,eric.nawrocki@gmail.com,"Relatively major changes made to allow banded alignment.  Small bugs
could still exist (this may always be true though...).

With the --nosmall --banded option combination to cmalign, a
memory-efficient banded, non D&C alignment is performed, which is up
to 2X faster than the D&C --banded alignment (at least for SSU).  

Another new cmalign option, the --full option, forces the alignment
outputted from cmalign to contain all consensus columns of the model,
which is useful if more than one alignment to the same model are to be
merged together.


Finally, the new --bandexpand option provides a naive, inefficient, hacky
solution to a situation that causes banded cmalign to break.  Namely, if the
the length of the sequence being aligned is outside the band range for
the root note (defined by dmin[0] and dmax[0]).  The --bandexpand
option makes cmalign change the bands by expanding them, either by
decreasing dmin[v] by the difference (dmin[0] - length(target)) for
all states v if length(target) < dmin[0], or by increasing dmax[v] by
the difference (length(target) - dmax[0]) if length(target) >
dmax[0].  This is a very experimental approach.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1428 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-11T14:31:38Z,nawrockie
68ba9c55cc88fe196c4e8c4a8a0ccc6baf9e2268,Eric Nawrocki,eric.nawrocki@gmail.com,"Fixed minor (arguable) 'bug' in bandcyk.c, now the B_st's recursion in
CYKBandedScan() is band savvy for subsequence lengths rooted at child
start states (S_st) of BEGL and BEGR.  The recursion now ignores
querying any cells that are outside of the bands for the corresponding
state (looking at the simple change in code might be more informative
than this blurb).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1427 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-10T15:41:47Z,nawrockie
16baaf73f44361b97d811474125ffab76cbff69a,Diana Kolbe,diana.kolbe@gmail.com,"Adding documentation for rigfilters installation and use



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1425 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-05T17:50:34Z,N/A
808468352077998bd6ea126c2b00557046cba8a6,Diana Kolbe,diana.kolbe@gmail.com,"Added man pages for cm2hmm, cm2hmmsearch



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1424 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-08-04T19:54:38Z,N/A
f0738eb6b686dfec145acd848e1b67fbfe9d9194,Diana Kolbe,diana.kolbe@gmail.com,"The makefile for cm2hmm has changed from Makefile.test
to just Makefile (produced via Makefile.in).
Removed references specifying use of the older file.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1407 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-06-07T18:49:23Z,N/A
a0204326479ec546744c3eec196168aa793a27b4,Diana Kolbe,diana.kolbe@gmail.com,"Large batch changes:
Fixed newline/cr
Changed vector to std::vector



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1404 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T14:16:59Z,N/A
3bc5107833314c31e7c2018b622b6a22c8ada735,Diana Kolbe,diana.kolbe@gmail.com,"Deleted static Makefile for cm2hmm.  A version
is created when configure processes Makefile.in



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1403 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T14:15:50Z,N/A
e7ac3a5a9a5bda0d9fca0578dc51944399f9df6c,Diana Kolbe,diana.kolbe@gmail.com,"Changed #include style syntax (<> to """")
Changed vector to std::vector



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1402 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T14:13:44Z,N/A
ee18d11a1a40389aa0c1720e95e75914a8a0db48,Diana Kolbe,diana.kolbe@gmail.com,"Changed vector to std::vector



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1401 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T14:12:15Z,N/A
f873a90a94912da57e6bd0aa831ff227f40ff3d2,Diana Kolbe,diana.kolbe@gmail.com,"Removed 'vector' class.  Inheritance from STL class
of same name was causing problems.  This class had
no added functionality over its parent except
out-of-bounds error checking in a debug build.  All
references to vector throughout the package have
been changed to std::vector



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1400 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T14:11:39Z,N/A
ac9a1e359977f4d0d2bab11764cf695a695beedb,Diana Kolbe,diana.kolbe@gmail.com,"Fixed #include syntax style (<> to """")
Changed reference to 'vector' to 'std::vector'



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1399 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T14:08:48Z,N/A
4572f62736dd1d3928cd6e6fa7b1ec30c5791544,Diana Kolbe,diana.kolbe@gmail.com,"Fixed #include syntax style (<> to """")
Changed references to 'vector' to 'std::vector'
Changed call to Infernal function CreateCM()
argument nnodes=0 caused a malloc 0 and crash
on some systems.  Now uses nnodes=1 (although
nodes are not used by Zasha)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1398 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T14:05:56Z,N/A
409b4371495e901272567cb924751927e5466887,Diana Kolbe,diana.kolbe@gmail.com,"Changed references to 'vector' to 'std::vector'



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1397 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T14:02:14Z,N/A
dd5f8319c29b3f83069111000ffa9e136178ebb4,Diana Kolbe,diana.kolbe@gmail.com,"Fixed #include syntax (<> to """")
Added limits on (some!) string reads in fscanf
Changed some types from size_t to int for compatibility with STL



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1396 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T13:58:57Z,N/A
ade5aa98932b47ae3b32cb16a9befe4bf1bc655f,Diana Kolbe,diana.kolbe@gmail.com,"Changed naming convention for cfsqp library (now libcfsqp.a)
to simplify linking



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1395 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T13:52:27Z,N/A
605659b3ad8ff9564b5da9e009732b45538f06be,Diana Kolbe,diana.kolbe@gmail.com,"Changed typedef to not overwrite protected system type (__int64 to cm_int64)
Changed include syntax for local C++ headers ("""" instead of <>)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1394 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T13:50:36Z,N/A
ce67fe04b9cb61545665075a36e61b96b5157070,Diana Kolbe,diana.kolbe@gmail.com,"Makefile.in for cm2hmm, to be processed by configure



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1393 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T13:48:01Z,N/A
7840c662b21f525644422debdefa6a64f3a1c8d8,Diana Kolbe,diana.kolbe@gmail.com,"Add checks for C++ compiler and alloca header
Add rigfilters/cm2hmm1.0/Makefile to list of 
Makefiles to be generated by configure



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1392 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T13:46:23Z,N/A
ee05c61b4c15663ffd3ce8b21fff19fac623262d,Diana Kolbe,diana.kolbe@gmail.com,"Merging out-of-date copy (no changes)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1391 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T13:45:07Z,N/A
f14ea807d068f8177e7424f8010e7b4ba7002420,Diana Kolbe,diana.kolbe@gmail.com,"Added configuration for alloca()



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1390 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-21T13:36:15Z,N/A
ecbc21ba1345bd124c303325457e9e915bca6218,Eric Nawrocki,eric.nawrocki@gmail.com,"Bug that reported erroneous hits with HUGE bit scores in banded
cmsearch *should* be fixed.  Imposing bands for BEGL_S states was
the only change to the code.  

See ~nawrocki/lab/rRNA/infernal_0426/banded_bug_0427/00README
for details.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1381 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-05-03T13:54:03Z,nawrockie
b4552920a9b5832eeb47b2c571646b8628b126c9,Sean Eddy,sean@eddylab.org,"Mixture Dirichlets are now default.
xref STL9/p67.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1375 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-04-15T18:14:10Z,cryptogenomicon
b65fff885459f86091460cefafb7ecb1e7656304,Sean Eddy,sean@eddylab.org,"Dirichlet priors now seem to be working.
Infernal depends on easel subdirectory for the first time.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1373 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-04-11T20:49:21Z,cryptogenomicon
78cc184ed4c3ffddf3aa6373b8ac5c2130a2321c,Sean Eddy,sean@eddylab.org,"[Non-compilable]: revisions to Dirichlet prior code in progress;
incorporating easel's Dirichlet module.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1372 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-04-11T12:52:55Z,cryptogenomicon
434c3133f46e3109e488f78ec22ccd434302b218,Sean Eddy,sean@eddylab.org,"Commit of a broken version, moving home for weekend;
in the middle of revision of Eric's mixture Dirichlet code.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1371 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-04-08T21:09:59Z,cryptogenomicon
def1eb1abe56415760c5d855ccd0ef565cec566e,Sean Eddy,sean@eddylab.org,"final reorg?

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/infernal/trunk@1364 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-26T17:37:42Z,cryptogenomicon
e9296365f6c68e8501ab47ffa4be581bd45c5c1a,Sean Eddy,sean@eddylab.org,"reorg2

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal/trunk@1166 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-25T18:51:37Z,cryptogenomicon
206553f0fcd66a3e7221246af4e29f965c5b7a1b,Sean Eddy,sean@eddylab.org,"reorg2

git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal.trunk@1162 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-25T18:51:28Z,cryptogenomicon
7872085ec292859906cacf5d88cbab5ea7f3dfb1,Sean Eddy,sean@eddylab.org,"Changed trna alignment to new WUSS; 
updated install-sh.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1039 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-25T16:55:34Z,cryptogenomicon
f0ef6fea81170de95719832dca83629444d3f998,Diana Kolbe,diana.kolbe@gmail.com,"Converted GNU-style pattern rule to more portable
suffix rule.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1034 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-14T20:43:39Z,N/A
f153185d307892859af4df721ee0d93fb7cd26db,Diana Kolbe,diana.kolbe@gmail.com,"Reformatted CR/LF; minor bugfixes.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1033 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-14T20:41:27Z,N/A
55d482d2be36df2da9570d4d962495e43e444d15,Diana Kolbe,diana.kolbe@gmail.com,"In 3-arg constructor for MultiplyArray3d, changed
Load() (non-existant function) to Init().



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1032 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-14T20:39:57Z,N/A
bad25b4adbe07a3bbd2e5d5f2114380e9ff6fb72,Diana Kolbe,diana.kolbe@gmail.com,"in safevector::assign() this.func() changed to 
this->func().  Reformatted CR/LF



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1031 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-14T20:34:09Z,N/A
111a745be01549b0cb5a5083153a64634792b261,Diana Kolbe,diana.kolbe@gmail.com,"Syntax edit to untested, unused circular array class
to allow build under strict compilers.  'first' used
instead (debug before attempting to use!)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1030 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-14T20:31:51Z,N/A
7220bee72bd220715b2335e57564d24c1eb923d4,Diana Kolbe,diana.kolbe@gmail.com,"Commented out include of malloc.h, which is now
included within stdlib.  Reformatted CR/LF.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1029 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-14T20:26:54Z,N/A
5d198ef5040b31d27b0a786c3f07f969ae6fe59d,Diana Kolbe,diana.kolbe@gmail.com,"Removed tests for packages only needed by lp_solve
(lex,yacc), and removed rule for production of
lp_solve's Makefile



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1028 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-09T20:57:52Z,N/A
d7eec7e4587bb84e024ea34119ea89d439be3c2a,Diana Kolbe,diana.kolbe@gmail.com,"Removed references to lp_solve package; and
removed the package itself from the source tree.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1027 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-09T20:55:47Z,N/A
882ada226bb6de494ee50518ad0915a2718790f7,Diana Kolbe,diana.kolbe@gmail.com,"Commented out all functions referencing lpsolve.
SolveInequalities() is replaced with a new function
that merely sets all parameters to a single value
set by #define.  Note that the title of the function
is now inappropriate, as there is no guarantee that
the inequalities are in fact solved.  The package
now compiles cleanly with no reference to lp_solve.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1026 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-09T20:45:03Z,N/A
64fbeab914c72ad6ce5ecd7dcdb04f58ec20506a,Diana Kolbe,diana.kolbe@gmail.com,"Data for examples/tests of cm2hmm, plus the
documentation.  Initial version, as received
from Zasha.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1025 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-03T20:17:49Z,N/A
c57002d7cac85102e4ead80ccb078e640c2a23b4,Diana Kolbe,diana.kolbe@gmail.com,"Adding initial versions of cm2hmm into source tree



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1024 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-03T20:14:22Z,N/A
e5fe152b2f3059da0ca9243a2dc1be0ad13baddf,Diana Kolbe,diana.kolbe@gmail.com,"- Configure now takes care of adding the -l for
  flex, if needed
- Explicitly stated the rule for .c to .o compilation
  This should be exactly the rule already used by
  make, however, including it explicitly seems to
  solve issues about the location of the output files
  (the issue was observed on wapiti - Sparc Solaris 9)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1023 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-03T19:33:24Z,N/A
5c3c5951fd0e3fc5210b00e3b645748deeff9c09,Diana Kolbe,diana.kolbe@gmail.com,"Even for 'distclean', we do not want to remove
*.c and *.h, even though the targets will not
be included in our distribution.  A user who
has obtained these files may have their only
copies of their files residing within the our
source tree.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1022 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-03T19:28:11Z,N/A
78f5a5dd3620a2d66de793051900069229592b7c,Diana Kolbe,diana.kolbe@gmail.com,"Not all versions of tar support -z option; split
into two separate commands (gunzip; tar)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1021 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-03T19:25:55Z,N/A
3fa9d522bb6d53986ff2b4319ff4e25f8f653a0f,Diana Kolbe,diana.kolbe@gmail.com,"Eliminated use of simple (rather than recursive)
variable assignments, as these only exist within
gmake, not all versions of make.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1020 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-03T19:24:27Z,N/A
1f0702e858124dd93890104e47b68d5b6993f74c,Diana Kolbe,diana.kolbe@gmail.com,"Switched to portable conditional style (= instead of ==)
Makefiles for rigfilters and subpackages are created 
  regardless of whether they will be built.  (The clean
  and distclean targets in these files are currently
  called unconditionally, which means the Makefiles must
  exist.)
Added flag -l when $LEX happens to be flex, instead of
  requiring a (non-portable) conditional in the Makefile.
  This will be eliminated soon, because only LP_SOLVE
  required (f)lex.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1019 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-03T19:22:30Z,N/A
57ad320f8a9b92bad042b6f818b0836b52891d55,Diana Kolbe,diana.kolbe@gmail.com,"In top Makefile.in:
 - eliminated conditionals, which are not portable
 - introduced additional targets to help with
   conditional installation of rigfilters (all now
   depends on 'core' and a variable target



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1018 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-03-03T19:17:10Z,N/A
0a8b1024f772c897544038fd517f2fc62284f00c,Diana Kolbe,diana.kolbe@gmail.com,"Enclosed bare (one-line) conditional body in brackets.

if ... else ...
is now
if { ... } else { ... }

This eliminates a compilation issue when compiling with
/usr/ucb/cc on the Solaris machines in the compile farm
(whipworm, walpurti)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1013 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-02-22T17:14:56Z,N/A
61a6db1a92ff722d432bf9059ce4f49ddbf550c8,Diana Kolbe,diana.kolbe@gmail.com,"Changed C++ style comments (// ...) to C-style comments (/* ... */)
The C++ type caused compilation problems on the compile farm when
using strict C compilers (e.g., /usr/ucb/cc on the Solaris machines)



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1012 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-02-22T17:12:28Z,N/A
f12a79da6fa6ef66369f1d679631bc6a6dd5ba3b,Diana Kolbe,diana.kolbe@gmail.com,"In function PriorifyTransitionVectors(), moved declaration of 
variable total to head of function.  This eliminates compile
error encountered on wonderboy (OpenBSD 3.6, 2x1.0 P3, gcc 
2.95.3).



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1011 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-02-22T16:53:17Z,N/A
c9e337273c00399bd15288e55a9a4dda6ad04c17,Eric Nawrocki,eric.nawrocki@gmail.com,"Changed save_countvectors() function in cmbuild.c so it now outputs
transition count vectors, instead of just emission count vectors. 

Erased unneededy function declaration from prior.c in funcs.h.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1008 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-02-02T17:34:47Z,nawrockie
240b24726b21650bd8d51641212b9b8bd77ea15a,Eric Nawrocki,eric.nawrocki@gmail.com,"The modifications I thought I successfully made yesterday to allow 
incoroporation of emission and transition Dirichlet priors via an
input 'prior' file were (hopefully) fixed.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1007 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-02-01T19:35:48Z,nawrockie
4ac2039fd6bc3c16e7b3308e56f8a82711c203e9,Eric Nawrocki,eric.nawrocki@gmail.com,"(EPN) First attempt to add dirichlet prior capability.  

prior.c - contains several analogs of functions found in HMMER 2.3.2's
	  prior.c.  Although PriorifyTransitionVector() is notably
	  different to allow for the many possible types of transition
	  vectors.

Makefile.in - added a single line involving prior.o as an object.

rfam_seed_I_switched.prior - prior file including transition priors 
    estimated from the RFAM seed alignments, as well as mixture
    emission priors.  This file is just a sample of a prior file, and
    is not necessarily what I feel is the 'best' possible prior file.
    
funcs.h - modifications marked by ""EPN"", now includes functions in 
	prior.c.

structs.h - now includes the prior_s structure and some prior associated
	  constant declarations.

cmbuild.c - now has the command line option of ""--prior"" followed by
	  the name of the prior file, dies if this is not in a
	  very specific format as described in comments in prior.c.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1006 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-31T20:56:25Z,nawrockie
dc39213fb3b74da6dd835ae6b08623977b97515a,Eric Nawrocki,eric.nawrocki@gmail.com,"(EPN) First attempt to add dirichlet prior capability.  

prior.c - contains several analogs of functions found in HMMER 2.3.2's
	  prior.c.  Although PriorifyTransitionVector() is notably
	  different to allow for the many possible types of transition
	  vectors.

Makefile.in - added a single line involving prior.o as an object.

rfam_seed_I_switched.prior - prior file including transition priors 
    estimated from the RFAM seed alignments, as well as mixture
    emission priors.  This file is just a sample of a prior file, and
    is not necessarily what I feel is the 'best' possible prior file.
    
funcs.h - modifications marked by ""EPN"", now includes functions in 
	prior.c.

structs.h - now includes the prior_s structure and some prior associated
	  constant declarations.

cmbuild.c - now has the command line option of ""--prior"" followed by
	  the name of the prior file, dies if this is not in a
	  very specific format as described in comments in prior.c.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1005 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-31T20:52:17Z,nawrockie
fc2532b9b697a3f076846b7a2dacf2160d7cebd6,Eric Nawrocki,eric.nawrocki@gmail.com,"(EPN) First attempt to add dirichlet prior capability.  

prior.c - contains several analogs of functions found in HMMER 2.3.2's
	  prior.c.  Although PriorifyTransitionVector() is notably
	  different to allow for the many possible types of transition
	  vectors.

Makefile.in - added a single line involving prior.o as an object.

rfam_seed_I_switched.prior - prior file including transition priors 
    estimated from the RFAM seed alignments, as well as mixture
    emission priors.  This file is just a sample of a prior file, and
    is not necessarily what I feel is the 'best' possible prior file.
    
funcs.h - modifications marked by ""EPN"", now includes functions in 
	prior.c.

structs.h - now includes the prior_s structure and some prior associated
	  constant declarations.

cmbuild.c - now has the command line option of ""--prior"" followed by
	  the name of the prior file, dies if this is not in a
	  very specific format as described in comments in prior.c.



git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@1004 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-31T20:44:09Z,nawrockie
deebe9ada893798cf5c3246f3a375e4d5e8999d0,Sean Eddy,sean@eddylab.org,"preparing for subversion conversion.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@991 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-21T16:55:12Z,cryptogenomicon
a91498e7ebd28434d361bf0a13dd6f27e65b6c3b,Diana Kolbe,diana.kolbe@gmail.com,"Updated makefile.in reflecting new organization of lp_solve directory. The
src subdirectory is created by make all and destroyed by make distclean; it
does not need to exist as part of the source distribution.  (However, these
commands should generally just be run recursively by their counterparts in
the main Infernal makefile, rather than this one corresponding just the the
rigfilters optional package.)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@986 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-19T21:54:43Z,N/A
3f503e316dc2f2fc73c922025043cbe4c379386a,Diana Kolbe,diana.kolbe@gmail.com,"Updated Makefile.in to expand lp_solve tar archive into the src subdirectory
of lp_solve (to make cleaning it up later easier).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@985 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-19T21:49:27Z,N/A
64aa50cd13a327f6cfed3d4d007da662cd1a86af,Diana Kolbe,diana.kolbe@gmail.com,"Updated 'distclean' target to remove the source files resulting from
expanding the lp_solve tarball.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@984 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-19T21:48:09Z,N/A
d2a3daf5049d3eebce64eae119b5c71a7cee56e3,Diana Kolbe,diana.kolbe@gmail.com,"Updated 'clean' target in Makefile.in
Following reorganization of lp_solve subdirectory, source and compiled
files now reside in lp_solve/src


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@983 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-19T21:45:43Z,N/A
8e8173611895b6d85041aa93b8458dffb0d174f0,Diana Kolbe,diana.kolbe@gmail.com,"Modified the LPSOLVE_PATH variable to reflect the new location of source
code and compiled library file, following reorganization of the lp_solve
subdirectory.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@982 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-19T21:41:48Z,N/A
731ebc3f2ed44808c2eafb9205537078d36b00c8,Diana Kolbe,diana.kolbe@gmail.com,"Disclaimer file explaining the versioning of subpackages that are included
within Infernal, specifically as this relates to the lp_solve package and
known incompatibilities between cm2hmm and more current versions of lpsolve
relative to the one that is currently in use.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@981 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2005-01-13T20:51:06Z,N/A
20d0f6fffc895c84660b8c8f1897a9cfa897e04a,Diana Kolbe,diana.kolbe@gmail.com,"Changed group makefile.in for rigfilters to reflect the new makefile.test
makefile for the cm2hmm package.  Added command for distclean on cm2hmm,
since that target now exists.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@980 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-12-17T17:27:07Z,N/A
5b6d57f19f3c0fb178a8bdef6595dc02c74e07c2,Diana Kolbe,diana.kolbe@gmail.com,"New makefile for rigfilters/cm2hmm
Adapted from Zasha's original makefile; edited down for clarity and
integration with the Infernal package.  This is just a makefile, not a
makefile.in type file to be processed by configure.  Currently there are no
variables that would be dependent on information from configure.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@979 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-12-17T17:24:17Z,N/A
5a436f10d9f16811aec2f747d9be50a2c56311e0,Diana Kolbe,diana.kolbe@gmail.com,"Makefile.in: removed duplicate test for branching into rigfilters directory
	on make

configure.ac: Added tests for LEX and YACC (for building lp_solve library)
	Added Makefile for lp_solve to list of files generated by configure
	Removed export variable CFSQP_PATH.  Because all source files for
	cfsqp are copied to a standard location by configure (if they are
	not already present there), the makefiles do not need to know the
	original location of these files.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@976 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-11-18T19:36:04Z,N/A
c8468bdfb4ce6fbc134073ec1679c97e6e2bf627,Diana Kolbe,diana.kolbe@gmail.com,"Minor changes to mid-level Makefile.in for rigfilters.  distclean target
now recurses into lp_solve_4.0 as well since that distclean target has been
added.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@975 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-11-18T19:28:54Z,N/A
e32444f28fdf18d521b0d66cab6c327ee11c2a8e,Diana Kolbe,diana.kolbe@gmail.com,"Makefile.in for lp_solve_4.0 (subcomponent of rigfilters)
Derived from the makefiles packaged with lp_solve but:
 - variables and flags set via infernal's top-level configure
 - build targets significantly reduced, essentially only build the
   library liblpk.a
 - added a distclean target
 - large amounts of code from original Makefile remain, but are commented
   out - these can be deleted as seems fit

Minimal set of files from the lp_solve package needed:
	lpkit.c
	solve.c
	debug.c
	read.c
	readmps.c
	hash.c
	presolve.c
	lex.l
	lp.y

	lpkit.h is the only file directly referenced by cm2HMM code


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@974 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-11-18T19:26:46Z,N/A
96b1ba81de45c07d4f3f83a4157e60674231b55f,Diana Kolbe,diana.kolbe@gmail.com,"Makefile for lp_solve removed.  Replaced with Makefile.in to be processed
by configure


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@973 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-11-18T19:00:34Z,N/A
c09f2c931718e57cb806dcdd08081596fd9a5ceb,Diana Kolbe,diana.kolbe@gmail.com,"Added Makefile.in (processed by main infernal configure) for cfsqp package.
Builds cfsqp.a library needed by cm2hmm.  Note that source is not and can
not be packaged with infernal distribution - user must copy it to this
directory or specify its location as an option to configure
(--with-cfsqp=PATH)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@968 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-10-05T21:31:07Z,N/A
f6becc163611ab7dd6541b8227c4a496b16caa40,Diana Kolbe,diana.kolbe@gmail.com,"--with-cfsqp option now parses paths requiring tilde expansion.  Added
commands for making cfsqp to the main rigfilters makefile.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@967 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-10-05T21:26:22Z,N/A
7381eccc87dcfd081d85b8a4a7ff06594d6c37b6,Diana Kolbe,diana.kolbe@gmail.com,"Added clean and distclean targets to various rigfilter Makefiles
Changed the way that conditionals are handled in main Makefile.in (relies
on output variables (AC_SUBST) rather than test for existence of files
output by make.  Also started on optional detection of CFSQP (unfinished)


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@966 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-10-01T19:51:14Z,N/A
c1e2d4dfeeeb513e7edc24be1fbbf274a2a37807,Diana Kolbe,diana.kolbe@gmail.com,"This is just a change buffer for Makefile.in, it should not have been
included in the CVS repository


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@965 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-09-29T15:26:24Z,N/A
94583e2e39dde9cbbf4a308d832b7a23ed951bfa,Sean Eddy,sean@eddylab.org,"Er. Not sure what I'm committing here - but for one, it looks like I removed rna_ops.c from the Makefile.in, and that change wasn't committed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@964 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-09-28T21:16:28Z,cryptogenomicon
556031f563cd9fc23cfbfc5870f0ff8f4b3ed16d,Diana Kolbe,diana.kolbe@gmail.com,"Removing Makefile from rigfilters/  This is a generated file, not part of
the source.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@963 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-09-27T16:20:16Z,N/A
1777d735833e711911e93d69620d960c358c877f,Diana Kolbe,diana.kolbe@gmail.com,"New makefiles for installing rigfilters.  rigfilters/Makefile.in is
processed when infernal/configure is run with the --enable-rigfilters
option.  This makefile (in combination with infernal's main makefile)
direct make to recurse into the directories for lp_solve and then cm2hmm.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@962 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-09-27T16:19:10Z,N/A
255efb69270e3a394c4ee38b516d509468483d77,Diana Kolbe,diana.kolbe@gmail.com,"Preliminary changes to makefile.in and configure.ac to allow conditional
installation of rigorous filters (as defined and implemented by Zasha
Weinberg and Walter Ruzzo).  Currently the directories for this code
infernal/rigfilters/) contain only stubs to make sure that make is
accessing them only under appropriate conditions and at the correct time.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@961 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-09-27T16:15:08Z,N/A
30b238fd4207751b43b25d6ec6ce0d49a3271fc3,Sean Eddy,sean@eddylab.org,"Deleted rna_ops.c. Moved IsCompensatory() to display.c; moved KHS2ct()
to a new rna_ops.c as part of squid.

Don't know what changes were made to cmscore.c and smallcyk.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@933 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2004-01-16T17:51:39Z,cryptogenomicon
ce1d5269344ad03cd4908df5e35db9a28902f69b,Sean Eddy,sean@eddylab.org,"Added two test exercises for bandcyk.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@930 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-27T21:33:13Z,cryptogenomicon
ee8f0c52caba43d941fa13463388bd0e4346a59e,Sean Eddy,sean@eddylab.org,"small API changes, hooking up test driving programs
in notebook/1015-infernal-bands


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@927 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-20T12:15:13Z,cryptogenomicon
565248e35e96f978535c3d2058af12f05f03e5da,Sean Eddy,sean@eddylab.org,"fixed off by one bug in EmitTraceback()


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@926 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-17T18:38:53Z,cryptogenomicon
6ee76ada003f95cddc0d3722e3dfa94465b759c8,Sean Eddy,sean@eddylab.org,"Added #=RF lines to RNaseP.sto and ssu.sto.
API improvements in bandcyk.c as I run experiments in
notebook/1015-infernal-bands


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@925 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-17T12:51:20Z,cryptogenomicon
9052f6a88135d5df35a1e802e252f9c8eb67a68f,Sean Eddy,sean@eddylab.org,"emission code working. check-emit.c written.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@924 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-15T11:50:15Z,cryptogenomicon
de737fd940f95b5f1d3137a8fe51fdf0a6aff44c,Sean Eddy,sean@eddylab.org,"emit.c's EmitParsetree() ""finished"" but not tested.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@923 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-14T04:00:14Z,cryptogenomicon
47755b74ebab30f2b6c58ebdd89579d71b73f499,Sean Eddy,sean@eddylab.org,"emit.c added: emitting parse trees/sequences from a CM.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@922 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-13T23:08:21Z,cryptogenomicon
f586cf983794cc67e94db2aba48fe5dc35c8658a,Sean Eddy,sean@eddylab.org,"Started working on Infernal's emit.c.
Added cstack to squid's sre_stack.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@921 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-13T23:07:56Z,cryptogenomicon
5c65adae9cb6b8b2d904d8be7f8a995e766fdd23,Sean Eddy,sean@eddylab.org,"Started the manuscript in banded-cyk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@920 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-12T23:06:03Z,cryptogenomicon
d4ab5afcc2448789931702a43d765f6ebe38fb90,Sean Eddy,sean@eddylab.org,"Now using sre_stack.c/.h (nstack.c/.h moved to SQUID)
working on proving my numerical stuff in band bounding.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@919 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-11T19:51:21Z,cryptogenomicon
3072507707bb180c7c67b31b0f08615e5886eefb,Sean Eddy,sean@eddylab.org,"Added Mstack_t structure support in nstack.c,
pushdown stack for managing/reusing objects.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@917 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-10T15:16:25Z,cryptogenomicon
4c729c04f860202b5f888292faa358ec2aaf58ac,Sean Eddy,sean@eddylab.org,"Revising the banding algorithms in bandcyk.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@916 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-10-09T23:33:17Z,cryptogenomicon
7e630219cd6455cd0b7b69fc681dd257c5ff5a7c,Sean Eddy,sean@eddylab.org,"Debugging and testing banded CYK.
Added BandedParsetreeDump().
xref STL7 p.119


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@908 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-09-27T22:24:46Z,cryptogenomicon
0d433e7442f9f69a93f7c136be40da006d9728e9,Sean Eddy,sean@eddylab.org,"First implementation of banded CYK scan.
Upgraded configure.in to configure.ac, and started using
an automatically configured config.h.in.
Rearranged order of header file inclusion, so config.h always
comes first.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@907 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-09-27T20:31:15Z,cryptogenomicon
6025da0f966413a052e92d67e88f40b43aac7b12,Sean Eddy,sean@eddylab.org,"0.55 release completed.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@875 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-04-03T14:18:32Z,cryptogenomicon
a71713c28b74d11d1c5e4dd326ddc4ea2744a3d7,Sean Eddy,sean@eddylab.org,"0.55 release coming together...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@873 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-04-03T00:24:30Z,cryptogenomicon
8bbcb63ed1a7ff87cc130ac096365be367f47414,Sean Eddy,sean@eddylab.org,"0.55 release


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@872 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-04-02T23:54:04Z,cryptogenomicon
626377288b2124f65491ba602f1c27e74e9934b2,Sean Eddy,sean@eddylab.org,"Preparing the 0.55 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@871 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-04-02T22:48:22Z,cryptogenomicon
7358f2e11bf2e56ff48bd04c4d08544189df9880,Sean Eddy,sean@eddylab.org,"user guide finished. working on make dist, w/ keyword replacements.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@870 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-04-02T22:37:47Z,cryptogenomicon
9495c87a38c41401049e8aeb92d1688b75e3e2d9,Sean Eddy,sean@eddylab.org,"Preparing to write some infernal man pages.
Added sedition and sedition-pp to ssdk; boilerplate.trailer to manpages.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@869 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-04-01T02:05:41Z,cryptogenomicon
01708e323e369225bf9f90532ca1329051c9fd95,Sean Eddy,sean@eddylab.org,"More work on the userguide. Most of it is now done. Need man pages next.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@868 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-03-31T23:55:24Z,cryptogenomicon
193a3162bb17a553a796236ab8bf8b25ed5f06f2,Sean Eddy,sean@eddylab.org,"Continuing work on documentation.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@867 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-03-24T15:18:12Z,cryptogenomicon
f4ba08b14b3f39feaafc498efe3a0eeb000b3fca,Sean Eddy,sean@eddylab.org,"working on the documentation.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@866 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-03-23T19:48:02Z,cryptogenomicon
28e01490058378d0073fdc4edf18f75503bc67d7,Sean Eddy,sean@eddylab.org,"Starting to work on userguide documentation.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@865 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-03-09T16:43:50Z,cryptogenomicon
05fe4e459b4ddf524e065ba024d715c57aab8de4,Sean Eddy,sean@eddylab.org,"Bug #i3 fixed: local begins starting at inserts. xref STL7 p.43.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@864 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-03-04T20:49:29Z,cryptogenomicon
3292b36b23128964b7eb4bc1f70959d2b0619c1f,Sean Eddy,sean@eddylab.org,"Fixed SS annotation in intro/, to adopt new <> style.
Hacks in bandcyk.c and cmscore.c for Project X - gathering prelim
data for NIH renewal.
xref STL7 p.35


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@862 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-02-19T17:28:12Z,cryptogenomicon
e3ad51bfa1171d4ecd1e29d539866075bb79ea2a,Sean Eddy,sean@eddylab.org,"fixed some typos in switch statements of outside(), w/ bogus states.
Added a comment about how B->EL transitions are impossible, so
even though vend might be a B, B doesn't show up in the switch statement
for local ends.
Prompted by a ""bug"" report from Robbie.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@859 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-12T17:59:09Z,cryptogenomicon
3c3e993046dfbb414ec31714133307c05c1ffacc,Sean Eddy,sean@eddylab.org,"Fixed ""make ftpdist"" to make a relative symlink.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@858 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-06T15:25:52Z,cryptogenomicon
d4ca166fabde061c3ff93ef94fb75c1cfeccbcae,Sean Eddy,sean@eddylab.org,"0.54 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@856 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-05T23:46:17Z,cryptogenomicon
1493f885a000f349fd4c79b77480827c745a7081,Sean Eddy,sean@eddylab.org,"Bug #i2 fixed: cmalign memory leak
Added test for i2 in bugs.sqc
Added -m option to sqc: memory leak checking w/ ccmalloc
fixed cmalign memory leaks
sped up exercises w/ --wnone option
xref STL7 p15


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@855 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-05T23:40:57Z,cryptogenomicon
a757788ada6557714d013c7470578cca20ff9c63,Sean Eddy,sean@eddylab.org,"Post-0.53 commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@854 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-05T01:15:06Z,cryptogenomicon
a1c976970b93b5194ce4d3c8661679f7bc913527,Sean Eddy,sean@eddylab.org,"Infernal 0.53 - minor changes - include release notes; don't include
ssdk in dist, just a copy of sqc in testsuite.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@852 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-02T21:21:57Z,cryptogenomicon
911f911aa38f9685014346388e1d5743663c6b21,Sean Eddy,sean@eddylab.org,"Infernal 0.53 bugfix release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@851 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-02T21:06:05Z,cryptogenomicon
944632dce23e0c88cf8744cf6b75953d1de3b724,Sean Eddy,sean@eddylab.org,"bug #i1 - vault, bad SS_cons.
  - Added i1 test to Bugs directory and logged.
  - Modified sqc to do path substitution on any @token@, not just first token;
    this allows passing pathnames into bug scripts (see i1 for example).
  - Changed the .sqc scripts to the new @token@ style.
  - Added ct (Zuker-style pairing partner map) to CMConsensus_t.
  - Added test to cmalign.c:Parsetrees2Alignment() for rare case where
    a pairing partner column is missing, so column's SS_cons should not pick up
    <,> annotation; use : instead.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@849 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-02T19:14:00Z,cryptogenomicon
89fb2ef90ba563d570eb05e0fd1293c4863d0673,Sean Eddy,sean@eddylab.org,"Added the Bugs/ subdir. xref STL7 p.12


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@848 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2003-01-01T00:21:33Z,cryptogenomicon
bec45b19063c6884afc556573e72b76343888515,Sean Eddy,sean@eddylab.org,"banding calculations are debugged & working.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@841 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-11-24T17:34:14Z,cryptogenomicon
c4c0c0e9edd8603b439b7016f51e0de8ff4e93e3,Sean Eddy,sean@eddylab.org,"Added bankcyk.c.
First implementations of BandDistribution() and BandBounds().
Testing code stuck into cmscore.c for now.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@838 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-11-21T15:10:13Z,cryptogenomicon
08649fe07e6b9e35951aba91d022d3af31eabff8,Sean Eddy,sean@eddylab.org,"Compaq/Alpha debugging on waterbug: silencing gcc warnings,
and one bugfix in CMRebalance(), begin[] and end[] distributions
weren't being copied.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@830 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-10-14T14:12:08Z,cryptogenomicon
100ebf4fa7329f7998b2db7e6b538fd6af5f2c65,Sean Eddy,sean@eddylab.org,"bringing up to date w/ new squid: vectorops and sre_random modules


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@823 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-10-09T15:01:22Z,cryptogenomicon
afd4476628c3080626b6e341aef3cb42f0459199,Sean Eddy,sean@eddylab.org,"bugfix rel: 0.5 wasn't really switched over to new-style
ss annotation.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@822 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-10-09T14:30:47Z,cryptogenomicon
c3da0f5b321d78634999df96d9237eff3f9191d7,Sean Eddy,sean@eddylab.org,"typo fix for 0.5 rel


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@818 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-10-06T19:20:09Z,cryptogenomicon
629ba7ec1de43d9b7778d406e245e79d1d6d9bd7,Sean Eddy,sean@eddylab.org,"0.5 freeze for Rfam.
Switch to [] format for secondary structure annotation.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@817 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-10-06T19:17:54Z,cryptogenomicon
170a87350c4b710da137f9c5a5d9414bc4501309,Sean Eddy,sean@eddylab.org,"cmalign added.
SQC tests first added.
0.4 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@811 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-08-12T18:10:12Z,cryptogenomicon
9f8ef5f4cd3a88ed38d5d777873305ea407b7586,Sean Eddy,sean@eddylab.org,"0.31 freeze -- freeze now that sqc is working, so from now
on I can do regression tests.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@809 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-08-07T17:31:36Z,cryptogenomicon
54c193e0db6c83f8dee2b0e788a2e28e494d1f6c,Sean Eddy,sean@eddylab.org,"Got sqc and some initial tests working.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@807 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-08-07T17:30:18Z,cryptogenomicon
650444eab8f042dcbe124b1295ca01942a77a7b1,Sean Eddy,sean@eddylab.org,"debugging: cmscore (finally) passes a variety of tests,
for the integrated local alignment/divide and conquer code.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@806 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-08-05T00:42:15Z,cryptogenomicon
d6e259f33cdd46a93e7c3300cc4dcb56874b2408,Sean Eddy,sean@eddylab.org,"In the midst of debugging full local alignment implementation
of d&c; also starting to implement regression testing.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@805 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-08-02T22:21:18Z,cryptogenomicon
00a7b7c476aaedb324f09ebab54ba0375933ca1a,Sean Eddy,sean@eddylab.org,"Only a little weekend work on d&c w/ local alignment, in inside()
Also, checkins of unknown minor tweaks from wren.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@804 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-07-29T13:27:09Z,cryptogenomicon
143611331ee6c27ce6c0318de423acc7806a56a4,Sean Eddy,sean@eddylab.org,"Changes to local alignment code in progress.
xref STL6 p.94-96.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@803 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-07-26T22:30:16Z,cryptogenomicon
55099cad376358487b4789e4e3cb56d01c355430,Sean Eddy,sean@eddylab.org,"CFLAGS issues in configure.in's.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@799 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-07-04T16:07:12Z,cryptogenomicon
1f505bdfde5d30ceda87043795d3859b52403be2,Sean Eddy,sean@eddylab.org,"more prep for 0.3 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@798 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-07-04T15:50:36Z,cryptogenomicon
a451f343c26c613c1d39e49d020ceffec456ccfd,Sean Eddy,sean@eddylab.org,"Working on 0.3 release.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@797 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-07-04T15:49:36Z,cryptogenomicon
f281cfaa2e904ad1a987e01aebfbe3a5abbce808,Sean Eddy,sean@eddylab.org,"created 00CHECKLIST to record distribution notes


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@796 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-07-04T15:28:37Z,cryptogenomicon
63c461d361cda8ff4c4b08e9d7370afb6143b836,Sean Eddy,sean@eddylab.org,"Release to Sanger for Rfam


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@795 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-07-04T15:26:39Z,cryptogenomicon
bab46f46c78ab87d2c9de7ccab4795c63157f2db,Sean Eddy,sean@eddylab.org,"*** empty log message ***


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@791 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-06-07T17:47:25Z,cryptogenomicon
2810c9df931652ba5d5be4a29fd217406b79523f,Sean Eddy,sean@eddylab.org,"Local alignment implemented (modelconfig.c; --local flag in
cmsearch.c; new DP code in scancyk.c; new DP code in smallcyk.c)
Alignment display implemented (display.c)
Local search benchmarks for tRNA, RNaseP, SRP/ffs included in
testsuite directory.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@790 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-05-28T14:59:09Z,cryptogenomicon
b3301b650970ce602a932e8f4eb02f16e9b9f452,Sean Eddy,sean@eddylab.org,"0.2 freeze: first timing of scanning algorithm
xref STL6 p.51


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@783 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-05-07T18:26:24Z,cryptogenomicon
f3ff24881adcd09c23a9af27e2a8010d6c17d1a8,Sean Eddy,sean@eddylab.org,"added memory/time tracking in cmsearch.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@782 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-05-07T01:11:34Z,cryptogenomicon
0beb352b43e4a4cd8fdab07e9c4cbf5269c2a3b0,Sean Eddy,sean@eddylab.org,"forgot to commit cmsearch.c.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@781 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-05-07T00:01:16Z,cryptogenomicon
e424320450e7eabbab2bab7e44387ba95c753ac1,Sean Eddy,sean@eddylab.org,"CYKScan() and cmsearch compile and work (or appear to).


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@780 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-05-06T23:40:39Z,cryptogenomicon
5a1706b97b162f779cb4ec019f9f3f04abe276e4,Sean Eddy,sean@eddylab.org,"Most of scancyk.c:CYKScan() written, for multihit local alignment
Not yet compilable.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@779 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-05-03T12:07:06Z,cryptogenomicon
eb1d5d788e6a8dbe5628aab9338fc2ef2682d60f,Sean Eddy,sean@eddylab.org,"Working on make dist


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@777 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-29T21:06:51Z,cryptogenomicon
68180af946e567f64a45262178508d7c19c47af1,Sean Eddy,sean@eddylab.org,"Ready to submit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@776 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-29T21:03:08Z,cryptogenomicon
726235a92fa8f810416f895814c9fdb24de61662,Sean Eddy,sean@eddylab.org,"This draft was handed out to the lab for comments.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@762 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-12T22:48:41Z,cryptogenomicon
9d448c7b02dd655e2914291e07eafe746312123a,Sean Eddy,sean@eddylab.org,"Jesus. A complete draft of the paper.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@761 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-10T23:08:31Z,cryptogenomicon
51c47eb25a50757d40efcbc7c8426a9e8774379d,Sean Eddy,sean@eddylab.org,"Wrote memory, time complexity sections of paper.
added --scoreonly option to cmscore;
made CMRebalance() the default in cmbuild;
added CYKInsideScore() to smallcyk.c.
Other changes must be minor.
xref STL6 p21


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@760 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-10T00:05:10Z,cryptogenomicon
7a548a85ecc7beb3e45a63430341962d55fa510e,Sean Eddy,sean@eddylab.org,"Starting to work on N^2 logN guarantee


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@759 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-08T12:17:17Z,cryptogenomicon
00e4f59b706a656354869ff5b1354301751e300c,Sean Eddy,sean@eddylab.org,"Added results table to manuscript.
Hacked modelmaker.c to use leftmost-split rule.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@758 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-07T21:36:16Z,cryptogenomicon
be728a91b7b35ccad1fb4218d36f9ed1e432a6c9,Sean Eddy,sean@eddylab.org,"modified cmscore to do both full and d&c; full can be switched
off with --smallonly option.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@757 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-06T19:09:30Z,cryptogenomicon
27e3312202c0eb963bb1ee95b90663287c089f26,Sean Eddy,sean@eddylab.org,"Small changes,
buf overflow bugfix in stockholm.c's actually_write_stockholm()


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@756 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-06T18:53:19Z,cryptogenomicon
235730da998a5b718ea9505758c253bdfdd748c4,Sean Eddy,sean@eddylab.org,"Added RNA alignment files for demo of smallcyk.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@755 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-06T18:52:17Z,cryptogenomicon
b58761f0c7b8fb14784bb772c0b4af55df5f5468,Sean Eddy,sean@eddylab.org,"minor bugfixes, getting it to compile again.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@753 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-06T15:03:00Z,cryptogenomicon
a81e66ba5340abd6bca9569b94e5de9049fd440f,Sean Eddy,sean@eddylab.org,"added config.h


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@752 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-06T14:35:52Z,cryptogenomicon
2b2f90ea4df681b002198b15593325d9b702ea82,Sean Eddy,sean@eddylab.org,"Algorithm complete!


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@751 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-05T00:09:05Z,cryptogenomicon
6b0a64cb975943ef74860b5587d5e1ada6672e9f,Sean Eddy,sean@eddylab.org,"Finished draft of algorithm section.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@750 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-03T23:12:48Z,cryptogenomicon
f61c9f24bd626d8f794864f84d9cf4c18892f16a,Sean Eddy,sean@eddylab.org,"unknown changes...


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@749 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-04-03T15:08:29Z,cryptogenomicon
d36797bf679b06001e737dda0e897b163fa24eeb,Sean Eddy,sean@eddylab.org,"struggling with inside/insideT


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@741 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-03-16T14:43:20Z,cryptogenomicon
60b71149d0ead40d0e091c59cc53655c23dadc3c,Sean Eddy,sean@eddylab.org,"ein kleine nachtmusik: put wedge_splitter into alg.sty form


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@740 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-03-14T04:49:28Z,cryptogenomicon
d7de7c03dca4077f018ea726c09c4d7e835853cd,Sean Eddy,sean@eddylab.org,"CM construction section draft finished.
Started on algorithm formatting.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@739 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-03-14T01:28:14Z,cryptogenomicon
f621b42d922afb3bd09a7581a870358a97fda803,Sean Eddy,sean@eddylab.org,"made minor revisions, on Berkeley trip - trying to
get restarted and get the ms finished!


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@738 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2002-03-13T13:10:35Z,cryptogenomicon
2a5144f2ed6c9236009d9e500c2d1d7283d22aaf,Sean Eddy,sean@eddylab.org,"just checking.
made the Figures directory.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@722 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2001-11-26T13:48:03Z,cryptogenomicon
c8ba537af3966bf34a0cd5e9291ae941bcb316e0,Sean Eddy,sean@eddylab.org,"Wrote the section of the manuscript on converting a structural alignment
to a master nodetree.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@666 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2001-06-20T14:14:32Z,cryptogenomicon
a7520cd0ebfd8194169ecc82e93cfb6074f14200,Sean Eddy,sean@eddylab.org,"Moved the manuscript under CVS control.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@665 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2001-06-18T13:21:48Z,cryptogenomicon
44107ac19fa7a825b2659c1d0916e7b80fee049a,Sean Eddy,sean@eddylab.org,"First working version... debugged and running


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@660 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2001-06-07T16:59:37Z,cryptogenomicon
c944d49e11935cab3aa56b1d62a8718f7a3eb3b6,Sean Eddy,sean@eddylab.org,"Complete implementation of smallcyk.c.
Starting debugging phase.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@659 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2001-06-04T02:11:00Z,cryptogenomicon
847a5ed5159a6e4087ff86720a3caf389f308dab,Sean Eddy,sean@eddylab.org,"Debugging memory with ccmalloc; bug fixes.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@620 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-09-05T13:47:16Z,cryptogenomicon
5df3f9b3b401c55bd56a5b9751b3be29a99126ac,Sean Eddy,sean@eddylab.org,"Milestone #8. Divide and conquer works on tRNA.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@619 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-14T14:26:21Z,cryptogenomicon
a15cb76da484f93c153b7590c26f75f2deae7ae4,Sean Eddy,sean@eddylab.org,"implementation of segment_alignment_engine() in smallcyk.c


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@618 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-10T21:35:37Z,cryptogenomicon
5b228689b337b7e310eea2819077b6a1bedffcc0,Sean Eddy,sean@eddylab.org,"milestone #7.
the first divide! but no conquer yet.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@617 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-09T22:38:01Z,cryptogenomicon
196499241d2d4be4848ba06a10ef9107d13eaed7,Sean Eddy,sean@eddylab.org,"Partially into implementing a more general CYK inside engine,
towards the first divide & conquer.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@616 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-07T21:00:28Z,cryptogenomicon
044da87512080a3b67415202de1c3cd705bd48a2,Sean Eddy,sean@eddylab.org,"weekend work.

modelmaker now deals in digitized [1..alen] alignments, so
coordinates in Parsetree's are always 1..L sense, and routines
that look at parsetree information can always expect digitized
sequences.

smallcyk.c now includes an implementation of Outside() but it
isn't hooked up to anything, and isn't tested.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@615 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-07T13:40:06Z,cryptogenomicon
603b228220f9a56d37eca5db48e90a603d7747f1,Sean Eddy,sean@eddylab.org,"Still working on getting infernal to match cove 2.4.4 output
scores on test cases.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@614 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-04T23:05:36Z,cryptogenomicon
54f615bf1784275f38e6c2555678231e0a4de7cc,Sean Eddy,sean@eddylab.org,"notebook p.15


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@613 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-03T22:24:38Z,cryptogenomicon
8087d62396ab7e7013e1310d019511836be268c6,Sean Eddy,sean@eddylab.org,"Milestone #5: CYK inside phase DP implementation.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@611 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-03T12:32:41Z,cryptogenomicon
57fbfc2cce6ac9a79d9c21109330f2e0d12b8623,Sean Eddy,sean@eddylab.org,"Now constructs a complete probabilistic model --
probability form, log-odds form.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@610 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-01T20:42:35Z,cryptogenomicon
f13e9f77ab1b16db8858a6f68725f1845a24fa57,Sean Eddy,sean@eddylab.org,"Some work at home -- partially towards collecting counts after
transmogrification.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@609 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-08-01T12:37:50Z,cryptogenomicon
cef81a7e484b1f6e92df42a9e9c5aa323ab67ec0,Sean Eddy,sean@eddylab.org,"milestone 4, notes p.13:
cmbuild now transmogrifies.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@608 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-07-31T21:43:38Z,cryptogenomicon
f3676af4d4b9b222f8b5839aeafe7b792f995358,Sean Eddy,sean@eddylab.org,"milestone #3; notebook p.12.
cmbuild now makes a complete CM from SSU alignment.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@607 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-07-29T23:08:26Z,cryptogenomicon
797691f7a0c795bb426eb968320d008ce7db9bd3,Sean Eddy,sean@eddylab.org,"Forgot to add rna_ops.c in yesterday's milestone #2 commit.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@606 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-07-29T13:17:48Z,cryptogenomicon
ae2c8a7e06732f6ca3c2bc3b3e80416f88866805,Sean Eddy,sean@eddylab.org,"Milestone #2. p.11.
cmbuild can now build a master traceback tree from a structurally
annotated alignment.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@605 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-07-28T21:23:32Z,cryptogenomicon
95b67c2cd9924d955f7c2c55f4452793c7889cb6,Sean Eddy,sean@eddylab.org,"Infernal cmbuild now compiles and reads an alignment.


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@604 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-07-27T21:49:47Z,cryptogenomicon
817032dc69d4f5aec708dcc89bbdc657f9482fce,Sean Eddy,sean@eddylab.org,"Initial revision


git-svn-id: https://svn.janelia.org/eddylab/eddys/src/trunk/infernal@601 db3e70e4-12e1-0310-b23f-81a6e3d09ba7",2000-07-27T18:47:40Z,cryptogenomicon
